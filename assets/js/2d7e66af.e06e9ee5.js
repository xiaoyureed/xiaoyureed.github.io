"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[7925],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return d}});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=s(t),d=r,g=m["".concat(p,".").concat(d)]||m[d]||u[d]||i;return t?a.createElement(g,o(o({ref:n},c),{},{components:t})):a.createElement(g,o({ref:n},c))}));function d(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=m;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},52464:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return p},default:function(){return d},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return u}});var a=t(83117),r=t(80102),i=(t(67294),t(3905)),o=["components"],l={title:"Spring Boot \u5907\u5fd8",tags:["framework","java"],date:new Date("2017-12-30T16:06:29.000Z"),toc_min_heading_level:2,toc_max_heading_level:5},p=void 0,s={unversionedId:"SpringBoot-note",id:"SpringBoot-note",title:"Spring Boot \u5907\u5fd8",description:"https://github.com/YunaiV/SpringBoot-Labs",source:"@site/docs/SpringBoot-note.md",sourceDirName:".",slug:"/SpringBoot-note",permalink:"/docs/SpringBoot-note",draft:!1,tags:[{label:"framework",permalink:"/docs/tags/framework"},{label:"java",permalink:"/docs/tags/java"}],version:"current",frontMatter:{title:"Spring Boot \u5907\u5fd8",tags:["framework","java"],date:"2017-12-30T16:06:29.000Z",toc_min_heading_level:2,toc_max_heading_level:5},sidebar:"tutorialSidebar",previous:{title:"FreeMarker Note",permalink:"/docs/FreeMarker-note"},next:{title:"\u654f\u6377\u5f00\u53d1 Intro",permalink:"/docs/agile-development-user-story-scrum"}},c={},u=[{value:"3.1. bean \u590d\u5236 \u514b\u9686",id:"31-bean-\u590d\u5236-\u514b\u9686",level:2},{value:"3.2. \u5b57\u7b26\u4e32",id:"32-\u5b57\u7b26\u4e32",level:2},{value:"3.3. \u7f16\u89e3\u7801",id:"33-\u7f16\u89e3\u7801",level:2},{value:"3.4. commons-lang3",id:"34-commons-lang3",level:2},{value:"3.5. \u6587\u4ef6\u64cd\u4f5c",id:"35-\u6587\u4ef6\u64cd\u4f5c",level:2},{value:"3.6. commons-collections4",id:"36-commons-collections4",level:2},{value:"5.1. @ConfigurationProperties \u548c @Value",id:"51-configurationproperties-\u548c-value",level:2},{value:"5.2. @EnableConfigurationProperties",id:"52-enableconfigurationproperties",level:2},{value:"5.3. @EnableAutoConfiguration",id:"53-enableautoconfiguration",level:2},{value:"5.4. @ComponentScan",id:"54-componentscan",level:2},{value:"5.5. @SpringBootApplication",id:"55-springbootapplication",level:2},{value:"5.6. @Component\u548c@Bean\u548c@Configration\u533a\u522b",id:"56-component\u548cbean\u548cconfigration\u533a\u522b",level:2},{value:"5.7. @Import\u548c@ImportResource\u548c@PropertySource\u6bd4\u8f83",id:"57-import\u548cimportresource\u548cpropertysource\u6bd4\u8f83",level:2},{value:"9.1. set\u6ce8\u5165",id:"91-set\u6ce8\u5165",level:2},{value:"9.2. @PostConstruct \u6ce8\u5165",id:"92-postconstruct-\u6ce8\u5165",level:2},{value:"9.3. \u901a\u8fc7 ApplicationContext",id:"93-\u901a\u8fc7-applicationcontext",level:2},{value:"10.1. \u52a0\u8f7d\u8fc7\u7a0bor\u539f\u7406",id:"101-\u52a0\u8f7d\u8fc7\u7a0bor\u539f\u7406",level:2},{value:"10.2. \u81ea\u52a8\u914d\u7f6e\u7c7b\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u6ce8\u89e3",id:"102-\u81ea\u52a8\u914d\u7f6e\u7c7b\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u6ce8\u89e3",level:2},{value:"10.3. \u81ea\u52a8\u914d\u7f6e\u7c7b\u7684\u5b9e\u4f8b",id:"103-\u81ea\u52a8\u914d\u7f6e\u7c7b\u7684\u5b9e\u4f8b",level:2},{value:"10.3.1. spring \u52a8\u6001\u4ee3\u7406",id:"1031-spring-\u52a8\u6001\u4ee3\u7406",level:3},{value:"10.4. @Conditional",id:"104-conditional",level:2},{value:"10.5. \u5c01\u88c5\u7ec4\u5408\u6761\u4ef6",id:"105-\u5c01\u88c5\u7ec4\u5408\u6761\u4ef6",level:2},{value:"10.6. \u521b\u5efa\u81ea\u5df1\u7684 starter",id:"106-\u521b\u5efa\u81ea\u5df1\u7684-starter",level:2},{value:"10.7. \u53cd\u722c\u866b starter",id:"107-\u53cd\u722c\u866b-starter",level:2},{value:"11.1. spring-boot-actuator \u76d1\u63a7",id:"111-spring-boot-actuator-\u76d1\u63a7",level:2},{value:"11.2. spring boot admin \u76d1\u63a7\u754c\u9762",id:"112-spring-boot-admin-\u76d1\u63a7\u754c\u9762",level:2},{value:"11.3. spring-boot-starter-security",id:"113-spring-boot-starter-security",level:2},{value:"11.3.1. security\u7ec4\u4ef6\u4ecb\u7ecd",id:"1131-security\u7ec4\u4ef6\u4ecb\u7ecd",level:3},{value:"11.3.2. \u57fa\u672c\u4f7f\u7528 \u548c \u914d\u7f6e\u7528\u6237\u540d\u5bc6\u7801",id:"1132-\u57fa\u672c\u4f7f\u7528-\u548c-\u914d\u7f6e\u7528\u6237\u540d\u5bc6\u7801",level:3},{value:"11.3.3. \u7981\u7528\u57fa\u672c\u8ba4\u8bc1",id:"1133-\u7981\u7528\u57fa\u672c\u8ba4\u8bc1",level:3},{value:"11.3.4. \u914d\u7f6e\u4e2d WebSecurity \u548c HttpSecurity \u533a\u522b",id:"1134-\u914d\u7f6e\u4e2d-websecurity-\u548c-httpsecurity-\u533a\u522b",level:3},{value:"11.3.5. \u914d\u7f6e\u8de8\u57df",id:"1135-\u914d\u7f6e\u8de8\u57df",level:3},{value:"11.4. oauth2",id:"114-oauth2",level:2},{value:"12.1. Log4j2-Marker \u5199\u5165\u5230\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6",id:"121-log4j2-marker-\u5199\u5165\u5230\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6",level:2},{value:"12.2. logback",id:"122-logback",level:2},{value:"13.1. canal \u8ba2\u9605",id:"131-canal-\u8ba2\u9605",level:2},{value:"13.2. mybatis \u81ea\u52a8\u5efa\u8868\u63d2\u4ef6",id:"132-mybatis-\u81ea\u52a8\u5efa\u8868\u63d2\u4ef6",level:2},{value:"13.3. mybatis crud \u589e\u5f3a\u63d2\u4ef6",id:"133-mybatis-crud-\u589e\u5f3a\u63d2\u4ef6",level:2},{value:"13.4. \u6570\u636e\u5e93\u8fc1\u79fb\u7248\u672c\u63a7\u5236",id:"134-\u6570\u636e\u5e93\u8fc1\u79fb\u7248\u672c\u63a7\u5236",level:2},{value:"13.4.1. liquibase",id:"1341-liquibase",level:3},{value:"13.4.2. Flyway",id:"1342-flyway",level:3},{value:"13.5. \u6570\u636e\u5e93 url \u548c\u9a71\u52a8",id:"135-\u6570\u636e\u5e93-url-\u548c\u9a71\u52a8",level:2},{value:"13.6. graphql\u96c6\u6210",id:"136-graphql\u96c6\u6210",level:2},{value:"13.7. \u542f\u52a8\u6267\u884c SQL",id:"137-\u542f\u52a8\u6267\u884c-sql",level:2},{value:"13.7.1. SQL \u5206\u9694\u7b26\u7684\u5751",id:"1371-sql-\u5206\u9694\u7b26\u7684\u5751",level:3},{value:"13.7.2. spring datasource \u81ea\u5e26",id:"1372-spring-datasource-\u81ea\u5e26",level:3},{value:"13.7.3. \u4f7f\u7528 jpa",id:"1373-\u4f7f\u7528-jpa",level:3},{value:"13.7.3.1. springboot \u63a5\u5165 jpa",id:"13731-springboot-\u63a5\u5165-jpa",level:4},{value:"13.7.3.2. jpa queryDsl \u591a\u8868\u8054\u67e5",id:"13732-jpa-querydsl-\u591a\u8868\u8054\u67e5",level:4},{value:"13.7.3.3. jpa \u652f\u6301 java8 time",id:"13733-jpa-\u652f\u6301-java8-time",level:4},{value:"13.7.4. DataSourceInitializer",id:"1374-datasourceinitializer",level:3},{value:"13.7.5. maven-antrun-pluginn",id:"1375-maven-antrun-pluginn",level:3},{value:"construct a script execution service manually",id:"construct-a-script-execution-service-manually",level:3},{value:"13.8. \u6574\u5408 spring jdbc",id:"138-\u6574\u5408-spring-jdbc",level:2},{value:"13.9. \u6574\u5408 hibernate",id:"139-\u6574\u5408-hibernate",level:2},{value:"13.9.1. jpa\u6ce8\u89e3\u603b\u7ed3",id:"1391-jpa\u6ce8\u89e3\u603b\u7ed3",level:3},{value:"13.9.2. \u5ba1\u8ba1 createdDate",id:"1392-\u5ba1\u8ba1-createddate",level:3},{value:"13.9.3. \u6267\u884c\u539f\u751f SQL",id:"1393-\u6267\u884c\u539f\u751f-sql",level:3},{value:"13.9.4. \u52a8\u6001 SQL",id:"1394-\u52a8\u6001-sql",level:3},{value:"13.9.5. spring-data-rest \u914d\u5408 spring-data-jpa",id:"1395-spring-data-rest-\u914d\u5408-spring-data-jpa",level:3},{value:"13.10. \u6574\u5408 mybatis-plus",id:"1310-\u6574\u5408-mybatis-plus",level:2},{value:"13.11. \u6574\u5408 mybatis",id:"1311-\u6574\u5408-mybatis",level:2},{value:"13.11.1. \u57fa\u672c\u914d\u7f6e",id:"13111-\u57fa\u672c\u914d\u7f6e",level:3},{value:"13.11.2. \u4f7f\u7528 \u62e6\u622a\u5668 interceptor plugins",id:"13112-\u4f7f\u7528-\u62e6\u622a\u5668-interceptor-plugins",level:3},{value:"13.11.2.1. principle of plugins",id:"131121-principle-of-plugins",level:4},{value:"13.11.2.2. use scenarios",id:"131122-use-scenarios",level:4},{value:"13.11.2.3. how to use plugins",id:"131123-how-to-use-plugins",level:4},{value:"13.11.3. typehandler",id:"13113-typehandler",level:3},{value:"13.11.4. \u5168\u6ce8\u89e3\u5f00\u53d1",id:"13114-\u5168\u6ce8\u89e3\u5f00\u53d1",level:3},{value:"13.11.5. \u52a8\u6001\u5b9a\u65f6\u5237\u65b0 SQL mapper \u5b9e\u73b0\u70ed\u52a0\u8f7d",id:"13115-\u52a8\u6001\u5b9a\u65f6\u5237\u65b0-sql-mapper-\u5b9e\u73b0\u70ed\u52a0\u8f7d",level:3},{value:"13.11.6. \u81ea\u5b9a\u4e49\u8d44\u6e90\u6587\u4ef6\u6253\u5305\u76ee\u5f55 and \u5f00\u542f\u5360\u4f4d\u7b26\u8fc7\u6ee4",id:"13116-\u81ea\u5b9a\u4e49\u8d44\u6e90\u6587\u4ef6\u6253\u5305\u76ee\u5f55-and-\u5f00\u542f\u5360\u4f4d\u7b26\u8fc7\u6ee4",level:3},{value:"13.12. springboot \u4e8b\u52a1",id:"1312-springboot-\u4e8b\u52a1",level:2},{value:"13.12.1. \u4e8b\u52a1\u57fa\u672c\u4f7f\u7528",id:"13121-\u4e8b\u52a1\u57fa\u672c\u4f7f\u7528",level:3},{value:"13.12.2. transaction not working",id:"13122-transaction-not-working",level:3},{value:"13.12.3. spring \u4e8b\u52a1\u4f20\u64ad\u5931\u6548\u7684\u5751",id:"13123-spring-\u4e8b\u52a1\u4f20\u64ad\u5931\u6548\u7684\u5751",level:3},{value:"13.12.4. Transactional \u6ce8\u89e3",id:"13124-transactional-\u6ce8\u89e3",level:3},{value:"13.13. \u7f13\u5b58",id:"1313-\u7f13\u5b58",level:2},{value:"13.13.1. springboot-starter-cache",id:"13131-springboot-starter-cache",level:3},{value:"13.13.2. caffeine",id:"13132-caffeine",level:3},{value:"13.14. \u914d\u5408 h2 \u6570\u636e\u5e93\u8fdb\u884c\u5f00\u53d1",id:"1314-\u914d\u5408-h2-\u6570\u636e\u5e93\u8fdb\u884c\u5f00\u53d1",level:2},{value:"13.14.1. h2 \u548c spring data jpa \u914d\u5408",id:"13141-h2-\u548c-spring-data-jpa-\u914d\u5408",level:3},{value:"13.14.2. \u548c mybatis-plus \u914d\u5408",id:"13142-\u548c-mybatis-plus-\u914d\u5408",level:3},{value:"13.15. \u591a\u6570\u636e\u6e90",id:"1315-\u591a\u6570\u636e\u6e90",level:2},{value:"13.15.1. \u57fa\u672c\u914d\u7f6e \u5168\u6ce8\u89e3\u5f00\u53d1",id:"13151-\u57fa\u672c\u914d\u7f6e-\u5168\u6ce8\u89e3\u5f00\u53d1",level:3},{value:"13.15.2. AbstractRoutingDataSource \u52a8\u6001\u6570\u636e\u6e90\u5207\u6362",id:"13152-abstractroutingdatasource-\u52a8\u6001\u6570\u636e\u6e90\u5207\u6362",level:3},{value:"13.16. \u591a\u6570\u636e\u5e93\u7c7b\u578b databaseIdProvider",id:"1316-\u591a\u6570\u636e\u5e93\u7c7b\u578b-databaseidprovider",level:2},{value:"13.17. spring kafka",id:"1317-spring-kafka",level:2},{value:"14.1. \u52a0\u89e3\u5bc6",id:"141-\u52a0\u89e3\u5bc6",level:2},{value:"14.2. springboot \u53d1\u9001 https \u6216\u8005 http \u5ba2\u6237\u7aef client",id:"142-springboot-\u53d1\u9001-https-\u6216\u8005-http-\u5ba2\u6237\u7aef-client",level:2},{value:"14.2.1. \u53d1\u9001 http client",id:"1421-\u53d1\u9001-http-client",level:3},{value:"14.2.2. \u53d1\u9001 https client",id:"1422-\u53d1\u9001-https-client",level:3},{value:"14.3. RequestContextHolder",id:"143-requestcontextholder",level:2},{value:"14.4. \u89e3\u51b3 api \u7248\u672c\u5171\u5b58",id:"144-\u89e3\u51b3-api-\u7248\u672c\u5171\u5b58",level:2},{value:"14.4.1. RequestMappingHandlerMapping",id:"1441-requestmappinghandlermapping",level:3},{value:"14.4.2. request matcher",id:"1442-request-matcher",level:3},{value:"14.4.3. request condition",id:"1443-request-condition",level:3},{value:"14.5. \u63a5\u6536\u53c2\u6570\u76f8\u5173\u7684\u6ce8\u89e3",id:"145-\u63a5\u6536\u53c2\u6570\u76f8\u5173\u7684\u6ce8\u89e3",level:2},{value:"14.6. \u81ea\u5b9a\u4e49\u63a5\u6536\u53c2\u6570\u7c7b\u578b",id:"146-\u81ea\u5b9a\u4e49\u63a5\u6536\u53c2\u6570\u7c7b\u578b",level:2},{value:"14.7. \u8fd4\u56de\u56fe\u7247",id:"147-\u8fd4\u56de\u56fe\u7247",level:2},{value:"14.8. rest api \u6587\u6863",id:"148-rest-api-\u6587\u6863",level:2},{value:"14.8.1. knife4j",id:"1481-knife4j",level:3},{value:"14.8.2. springdoc-openapi",id:"1482-springdoc-openapi",level:3},{value:"14.8.3. swagger3",id:"1483-swagger3",level:3},{value:"14.8.4. \u96c6\u6210swagger2",id:"1484-\u96c6\u6210swagger2",level:3},{value:"14.9. \u8fc7\u6ee4\u5668 \u548c \u62e6\u622a\u5668",id:"149-\u8fc7\u6ee4\u5668-\u548c-\u62e6\u622a\u5668",level:2},{value:"14.9.1. \u533a\u522b",id:"1491-\u533a\u522b",level:3},{value:"14.9.2. \u4f7f\u7528 filter",id:"1492-\u4f7f\u7528-filter",level:3},{value:"14.9.3. \u4f7f\u7528 interceptor",id:"1493-\u4f7f\u7528-interceptor",level:3},{value:"14.9.3.1. \u57fa\u672c\u4f7f\u7528\u62e6\u622a\u5668",id:"14931-\u57fa\u672c\u4f7f\u7528\u62e6\u622a\u5668",level:4},{value:"14.9.3.2. \u57fa\u4e8e url \u62e6\u622a",id:"14932-\u57fa\u4e8e-url-\u62e6\u622a",level:4},{value:"14.9.3.3. \u57fa\u4e8e\u6ce8\u89e3\u62e6\u622a",id:"14933-\u57fa\u4e8e\u6ce8\u89e3\u62e6\u622a",level:4},{value:"14.10. servlet Druid \u76d1\u63a7",id:"1410-servlet-druid-\u76d1\u63a7",level:2},{value:"14.11. aop \u6574\u5408\u4f7f\u7528",id:"1411-aop-\u6574\u5408\u4f7f\u7528",level:2},{value:"14.11.1. \u57fa\u672c\u4f7f\u7528",id:"14111-\u57fa\u672c\u4f7f\u7528",level:3},{value:"14.11.2. \u5207\u5165\u70b9\u8868\u8fbe\u5f0f",id:"14112-\u5207\u5165\u70b9\u8868\u8fbe\u5f0f",level:3},{value:"14.12. @controllerAdvice \u5f02\u5e38\u5904\u7406",id:"1412-controlleradvice-\u5f02\u5e38\u5904\u7406",level:2},{value:"14.13. HttpServletRequest \u7684\u8f93\u5165\u6d41\u53ea\u80fd\u8bfb\u53d6\u4e00\u6b21\u7684\u95ee\u9898",id:"1413-httpservletrequest-\u7684\u8f93\u5165\u6d41\u53ea\u80fd\u8bfb\u53d6\u4e00\u6b21\u7684\u95ee\u9898",level:2},{value:"14.14. \u8def\u7531\u5904\u7406",id:"1414-\u8def\u7531\u5904\u7406",level:2},{value:"14.14.1. \u9759\u6001\u8d44\u6e90\u6620\u5c04 \u66b4\u9732\u9759\u6001\u8d44\u6e90",id:"14141-\u9759\u6001\u8d44\u6e90\u6620\u5c04-\u66b4\u9732\u9759\u6001\u8d44\u6e90",level:3},{value:"14.14.2. \u6dfb\u52a0 view controller",id:"14142-\u6dfb\u52a0-view-controller",level:3},{value:"14.15. spring-boot-starter-thymeleaf",id:"1415-spring-boot-starter-thymeleaf",level:2},{value:"15.1. \u652f\u6301 https ssl",id:"151-\u652f\u6301-https-ssl",level:2},{value:"15.1.1. nginx \u914d\u7f6e https",id:"1511-nginx-\u914d\u7f6e-https",level:3},{value:"15.1.2. \u652f\u6301 https \u8bbf\u95ee",id:"1512-\u652f\u6301-https-\u8bbf\u95ee",level:3},{value:"15.1.3. http \u8bf7\u6c42\u81ea\u52a8\u8f6c\u4e3a https",id:"1513-http-\u8bf7\u6c42\u81ea\u52a8\u8f6c\u4e3a-https",level:3},{value:"15.1.4. \u540c\u65f6\u652f\u6301 http https",id:"1514-\u540c\u65f6\u652f\u6301-http-https",level:3},{value:"15.2. \u5bb9\u5668\u5316\u90e8\u7f72",id:"152-\u5bb9\u5668\u5316\u90e8\u7f72",level:2},{value:"15.3. nginx \u53cd\u5411\u4ee3\u7406",id:"153-nginx-\u53cd\u5411\u4ee3\u7406",level:2},{value:"15.4. \u5185\u5d4c tomcat \u8c03\u4f18",id:"154-\u5185\u5d4c-tomcat-\u8c03\u4f18",level:2},{value:"15.5. \u914d\u7f6e war \u5305\u90e8\u7f72\u5230 Tomcat",id:"155-\u914d\u7f6e-war-\u5305\u90e8\u7f72\u5230-tomcat",level:2},{value:"16.1. \u4f7f\u7528\u5f02\u6b65\u7f16\u7a0b",id:"161-\u4f7f\u7528\u5f02\u6b65\u7f16\u7a0b",level:2},{value:"16.1.1. \u914d\u7f6e\u7ebf\u7a0b\u6c60",id:"1611-\u914d\u7f6e\u7ebf\u7a0b\u6c60",level:3},{value:"16.1.2. \u6709\u8fd4\u56de\u503c \u6ca1\u6709\u8fd4\u56de\u503c",id:"1612-\u6709\u8fd4\u56de\u503c-\u6ca1\u6709\u8fd4\u56de\u503c",level:3},{value:"16.1.3. @Async\u5931\u6548",id:"1613-async\u5931\u6548",level:3},{value:"20.1. lombok notice",id:"201-lombok-notice",level:2},{value:"20.2. devtools",id:"202-devtools",level:2},{value:"20.3. maven wrapper",id:"203-maven-wrapper",level:2},{value:"21.1. \u6821\u9a8c\u914d\u7f6e\u6587\u4ef6",id:"211-\u6821\u9a8c\u914d\u7f6e\u6587\u4ef6",level:2},{value:"21.2. \u6821\u9a8c\u8bf7\u6c42\u53c2\u6570",id:"212-\u6821\u9a8c\u8bf7\u6c42\u53c2\u6570",level:2},{value:"21.3. \u81ea\u5b9a\u4e49\u6821\u9a8c",id:"213-\u81ea\u5b9a\u4e49\u6821\u9a8c",level:2},{value:"21.4. @Validated\u548c@Valid",id:"214-validated\u548cvalid",level:2},{value:"22.1. \u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570",id:"221-\u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570",level:2},{value:"22.2. <code>ApplicationRunner</code> or <code>CommandLineRunner</code>",id:"222-applicationrunner-or-commandlinerunner",level:2},{value:"25.1. \u6574\u5408 XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u5e73\u53f0",id:"251-\u6574\u5408-xxl-job-\u4efb\u52a1\u8c03\u5ea6\u5e73\u53f0",level:2},{value:"25.2. \u5f02\u6b65\u4efb\u52a1",id:"252-\u5f02\u6b65\u4efb\u52a1",level:2},{value:"25.3. \u5b9a\u65f6\u4efb\u52a1",id:"253-\u5b9a\u65f6\u4efb\u52a1",level:2},{value:"25.3.1. springboot \u5185\u7f6e",id:"2531-springboot-\u5185\u7f6e",level:3},{value:"25.3.2. \u96c6\u6210 Quartz",id:"2532-\u96c6\u6210-quartz",level:3},{value:"26.1. \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6",id:"261-\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6",level:2},{value:"26.1.1. \u51e0\u79cd\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u6cd5",id:"2611-\u51e0\u79cd\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u6cd5",level:3},{value:"26.1.2. \u6ce8\u5165\u590d\u6742\u7c7b\u578b",id:"2612-\u6ce8\u5165\u590d\u6742\u7c7b\u578b",level:3},{value:"26.2. \u914d\u7f6e\u6587\u4ef6\u4f18\u5148\u7ea7",id:"262-\u914d\u7f6e\u6587\u4ef6\u4f18\u5148\u7ea7",level:2},{value:"26.3. \u8bfb\u53d6\u73af\u5883\u4fe1\u606f",id:"263-\u8bfb\u53d6\u73af\u5883\u4fe1\u606f",level:2},{value:"26.4. \u4e24\u79cd\u5f15\u5165 springboot \u65b9\u5f0f",id:"264-\u4e24\u79cd\u5f15\u5165-springboot-\u65b9\u5f0f",level:2},{value:"27.1. \u65e5\u671f\u65f6\u95f4 json",id:"271-\u65e5\u671f\u65f6\u95f4-json",level:2},{value:"27.2. jackson \u4f7f\u7528",id:"272-jackson-\u4f7f\u7528",level:2},{value:"27.2.1. @JsonComponent",id:"2721-jsoncomponent",level:3},{value:"27.2.2. Jackson \u5728 springboot \u4e2d\u7684\u914d\u7f6e",id:"2722-jackson-\u5728-springboot-\u4e2d\u7684\u914d\u7f6e",level:3},{value:"27.2.3. jackson\u6ce8\u89e3",id:"2723-jackson\u6ce8\u89e3",level:3},{value:"27.2.4. objectmapper \u5b9a\u5236",id:"2724-objectmapper-\u5b9a\u5236",level:3},{value:"27.2.5. objectmapper \u4f7f\u7528",id:"2725-objectmapper-\u4f7f\u7528",level:3},{value:"29.1. bean \u61d2\u52a0\u8f7d",id:"291-bean-\u61d2\u52a0\u8f7d",level:2}],m={toc:u};function d(e){var n=e.components,t=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("div",{align:"center"},(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/YunaiV/SpringBoot-Labs"},"https://github.com/YunaiV/SpringBoot-Labs")),(0,i.kt)("p",null,"\u8bb0\u5f55springboot\u5b66\u4e60\u4e2d\u7684\u95ee\u9898, \u603b\u7ed3;\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/h2pl"},"https://github.com/h2pl")," web \u9879\u76ee\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/dreamhead/moco"},"https://github.com/dreamhead/moco")," mock \u6846\u67b6"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/cloudfavorites/favorites-web"},"https://github.com/cloudfavorites/favorites-web")," \u5355\u4f53\u5e94\u7528\u5b9e\u4f8b hibernate jpa"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/xkcoding/spring-boot-demo"},"https://github.com/xkcoding/spring-boot-demo")," springboot demos")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"},"1. \u5e38\u7528\u547d\u4ee4")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2-%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC"},"2. \u90e8\u7f72\u811a\u672c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#3-%E5%B7%A5%E5%85%B7%E7%B1%BB"},"3. \u5de5\u5177\u7c7b"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#31-bean-%E5%A4%8D%E5%88%B6-%E5%85%8B%E9%9A%86"},"3.1. bean \u590d\u5236 \u514b\u9686")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#32-%E5%AD%97%E7%AC%A6%E4%B8%B2"},"3.2. \u5b57\u7b26\u4e32")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#33-%E7%BC%96%E8%A7%A3%E7%A0%81"},"3.3. \u7f16\u89e3\u7801")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#34-commons-lang3"},"3.4. commons-lang3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#35-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"},"3.5. \u6587\u4ef6\u64cd\u4f5c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#36-commons-collections4"},"3.6. commons-collections4")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#4-%E5%92%8C-react-%E4%B8%80%E8%B5%B7%E6%89%93%E5%8C%85"},"4. \u548c react \u4e00\u8d77\u6253\u5305")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#5-spring-boot%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3"},"5. Spring Boot\u4e2d\u7684\u6ce8\u89e3"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#51-configurationproperties-%E5%92%8C-value"},"5.1. @ConfigurationProperties \u548c @Value")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#52-enableconfigurationproperties"},"5.2. @EnableConfigurationProperties")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#53-enableautoconfiguration"},"5.3. @EnableAutoConfiguration")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#54-componentscan"},"5.4. @ComponentScan")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#55-springbootapplication"},"5.5. @SpringBootApplication")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#56-component%E5%92%8Cbean%E5%92%8Cconfigration%E5%8C%BA%E5%88%AB"},"5.6. @Component\u548c@Bean\u548c@Configration\u533a\u522b")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#57-import%E5%92%8Cimportresource%E5%92%8Cpropertysource%E6%AF%94%E8%BE%83"},"5.7. @Import\u548c@ImportResource\u548c@PropertySource\u6bd4\u8f83")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#6-context-%E4%B8%8A%E4%B8%8B%E6%96%87-%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%86%8Cbean"},"6. context \u4e0a\u4e0b\u6587 \u624b\u52a8\u6ce8\u518cbean")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#7-%E5%AE%9E%E7%8E%B0%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8"},"7. \u5b9e\u73b0\u4e8b\u4ef6\u9a71\u52a8")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#8-%E4%BC%98%E9%9B%85%E5%81%9C%E6%9C%BA-%E5%85%B3%E6%9C%BA"},"8. \u4f18\u96c5\u505c\u673a \u5173\u673a")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#9-%E9%9D%99%E6%80%81%E6%B3%A8%E5%85%A5"},"9. \u9759\u6001\u6ce8\u5165"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#91-set%E6%B3%A8%E5%85%A5"},"9.1. set\u6ce8\u5165")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#92-postconstruct-%E6%B3%A8%E5%85%A5"},"9.2. @PostConstruct \u6ce8\u5165")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#93-%E9%80%9A%E8%BF%87-applicationcontext"},"9.3. \u901a\u8fc7 ApplicationContext")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#10-%E4%BD%BF%E7%94%A8starter"},"10. \u4f7f\u7528starter"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#101-%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8Bor%E5%8E%9F%E7%90%86"},"10.1. \u52a0\u8f7d\u8fc7\u7a0bor\u539f\u7406")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#102-%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%B1%BB%E4%BC%9A%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E6%B3%A8%E8%A7%A3"},"10.2. \u81ea\u52a8\u914d\u7f6e\u7c7b\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u6ce8\u89e3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#103-%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B"},"10.3. \u81ea\u52a8\u914d\u7f6e\u7c7b\u7684\u5b9e\u4f8b"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1031-spring-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"},"10.3.1. spring \u52a8\u6001\u4ee3\u7406")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#104-conditional"},"10.4. @Conditional")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#105-%E5%B0%81%E8%A3%85%E7%BB%84%E5%90%88%E6%9D%A1%E4%BB%B6"},"10.5. \u5c01\u88c5\u7ec4\u5408\u6761\u4ef6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#106-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84-starter"},"10.6. \u521b\u5efa\u81ea\u5df1\u7684 starter")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#107-%E5%8F%8D%E7%88%AC%E8%99%AB-starter"},"10.7. \u53cd\u722c\u866b starter")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#11-%E7%9B%91%E6%8E%A7-and-%E5%AE%89%E5%85%A8"},"11. \u76d1\u63a7 and \u5b89\u5168"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#111-spring-boot-actuator-%E7%9B%91%E6%8E%A7"},"11.1. spring-boot-actuator \u76d1\u63a7")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#112-spring-boot-admin-%E7%9B%91%E6%8E%A7%E7%95%8C%E9%9D%A2"},"11.2. spring boot admin \u76d1\u63a7\u754c\u9762")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#113-spring-boot-starter-security"},"11.3. spring-boot-starter-security"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1131-security%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D"},"11.3.1. security\u7ec4\u4ef6\u4ecb\u7ecd")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1132-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-%E5%92%8C-%E9%85%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E5%90%8D%E5%AF%86%E7%A0%81"},"11.3.2. \u57fa\u672c\u4f7f\u7528 \u548c \u914d\u7f6e\u7528\u6237\u540d\u5bc6\u7801")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1133-%E7%A6%81%E7%94%A8%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%81"},"11.3.3. \u7981\u7528\u57fa\u672c\u8ba4\u8bc1")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1134-%E9%85%8D%E7%BD%AE%E4%B8%AD-websecurity-%E5%92%8C-httpsecurity-%E5%8C%BA%E5%88%AB"},"11.3.4. \u914d\u7f6e\u4e2d WebSecurity \u548c HttpSecurity \u533a\u522b")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1135-%E9%85%8D%E7%BD%AE%E8%B7%A8%E5%9F%9F"},"11.3.5. \u914d\u7f6e\u8de8\u57df")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#114-oauth2"},"11.4. oauth2")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#12-%E6%97%A5%E5%BF%97"},"12. \u65e5\u5fd7"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#121-log4j2-marker-%E5%86%99%E5%85%A5%E5%88%B0%E6%8C%87%E5%AE%9A%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"},"12.1. Log4j2-Marker \u5199\u5165\u5230\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#122-logback"},"12.2. logback")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13-%E6%95%B0%E6%8D%AE%E5%B1%82"},"13. \u6570\u636e\u5c42"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#131-canal-%E8%AE%A2%E9%98%85"},"13.1. canal \u8ba2\u9605")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#132-mybatis-%E8%87%AA%E5%8A%A8%E5%BB%BA%E8%A1%A8%E6%8F%92%E4%BB%B6"},"13.2. mybatis \u81ea\u52a8\u5efa\u8868\u63d2\u4ef6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#133-mybatis-crud-%E5%A2%9E%E5%BC%BA%E6%8F%92%E4%BB%B6"},"13.3. mybatis crud \u589e\u5f3a\u63d2\u4ef6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#134-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6"},"13.4. \u6570\u636e\u5e93\u8fc1\u79fb\u7248\u672c\u63a7\u5236"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1341-liquibase"},"13.4.1. liquibase")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1342-flyway"},"13.4.2. Flyway")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#135-%E6%95%B0%E6%8D%AE%E5%BA%93-url-%E5%92%8C%E9%A9%B1%E5%8A%A8"},"13.5. \u6570\u636e\u5e93 url \u548c\u9a71\u52a8")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#136-graphql%E9%9B%86%E6%88%90"},"13.6. graphql\u96c6\u6210")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#137-%E5%90%AF%E5%8A%A8%E6%89%A7%E8%A1%8C-sql"},"13.7. \u542f\u52a8\u6267\u884c SQL"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1371-sql-%E5%88%86%E9%9A%94%E7%AC%A6%E7%9A%84%E5%9D%91"},"13.7.1. SQL \u5206\u9694\u7b26\u7684\u5751")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1372-spring-datasource-%E8%87%AA%E5%B8%A6"},"13.7.2. spring datasource \u81ea\u5e26")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1373-%E4%BD%BF%E7%94%A8-jpa"},"13.7.3. \u4f7f\u7528 jpa"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13731-springboot-%E6%8E%A5%E5%85%A5-jpa"},"13.7.3.1. springboot \u63a5\u5165 jpa")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13732-jpa-querydsl-%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5"},"13.7.3.2. jpa queryDsl \u591a\u8868\u8054\u67e5")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13733-jpa-%E6%94%AF%E6%8C%81-java8-time"},"13.7.3.3. jpa \u652f\u6301 java8 time")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1374-datasourceinitializer"},"13.7.4. DataSourceInitializer")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1375-maven-antrun-pluginn"},"13.7.5. maven-antrun-pluginn")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#construct-a-script-execution-service-manually"},"construct a script execution service manually")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#138-%E6%95%B4%E5%90%88-spring-jdbc"},"13.8. \u6574\u5408 spring jdbc")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#139-%E6%95%B4%E5%90%88-hibernate"},"13.9. \u6574\u5408 hibernate"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1391-jpa%E6%B3%A8%E8%A7%A3%E6%80%BB%E7%BB%93"},"13.9.1. jpa\u6ce8\u89e3\u603b\u7ed3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1392-%E5%AE%A1%E8%AE%A1-createddate"},"13.9.2. \u5ba1\u8ba1 createdDate")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1393-%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%94%9F-sql"},"13.9.3. \u6267\u884c\u539f\u751f SQL")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1394-%E5%8A%A8%E6%80%81-sql"},"13.9.4. \u52a8\u6001 SQL")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1395-spring-data-rest-%E9%85%8D%E5%90%88-spring-data-jpa"},"13.9.5. spring-data-rest \u914d\u5408 spring-data-jpa")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1310-%E6%95%B4%E5%90%88-mybatis-plus"},"13.10. \u6574\u5408 mybatis-plus")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1311-%E6%95%B4%E5%90%88-mybatis"},"13.11. \u6574\u5408 mybatis"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13111-%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"},"13.11.1. \u57fa\u672c\u914d\u7f6e")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13112-%E4%BD%BF%E7%94%A8-%E6%8B%A6%E6%88%AA%E5%99%A8-interceptor-plugins"},"13.11.2. \u4f7f\u7528 \u62e6\u622a\u5668 interceptor plugins"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#131121-principle-of-plugins"},"13.11.2.1. principle of plugins")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#131122-use-scenarios"},"13.11.2.2. use scenarios")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#131123-how-to-use-plugins"},"13.11.2.3. how to use plugins")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13113-typehandler"},"13.11.3. typehandler")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13114-%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"},"13.11.4. \u5168\u6ce8\u89e3\u5f00\u53d1")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13115-%E5%8A%A8%E6%80%81%E5%AE%9A%E6%97%B6%E5%88%B7%E6%96%B0-sql-mapper-%E5%AE%9E%E7%8E%B0%E7%83%AD%E5%8A%A0%E8%BD%BD"},"13.11.5. \u52a8\u6001\u5b9a\u65f6\u5237\u65b0 SQL mapper \u5b9e\u73b0\u70ed\u52a0\u8f7d")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13116-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E6%89%93%E5%8C%85%E7%9B%AE%E5%BD%95-and-%E5%BC%80%E5%90%AF%E5%8D%A0%E4%BD%8D%E7%AC%A6%E8%BF%87%E6%BB%A4"},"13.11.6. \u81ea\u5b9a\u4e49\u8d44\u6e90\u6587\u4ef6\u6253\u5305\u76ee\u5f55 and \u5f00\u542f\u5360\u4f4d\u7b26\u8fc7\u6ee4")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1312-springboot-%E4%BA%8B%E5%8A%A1"},"13.12. springboot \u4e8b\u52a1"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13121-%E4%BA%8B%E5%8A%A1%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"},"13.12.1. \u4e8b\u52a1\u57fa\u672c\u4f7f\u7528")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13122-transaction-not-working"},"13.12.2. transaction not working")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13123-spring-%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E5%A4%B1%E6%95%88%E7%9A%84%E5%9D%91"},"13.12.3. spring \u4e8b\u52a1\u4f20\u64ad\u5931\u6548\u7684\u5751")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13124-transactional-%E6%B3%A8%E8%A7%A3"},"13.12.4. Transactional \u6ce8\u89e3")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1313-%E7%BC%93%E5%AD%98"},"13.13. \u7f13\u5b58"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13131-springboot-starter-cache"},"13.13.1. springboot-starter-cache")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13132-caffeine"},"13.13.2. caffeine")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1314-%E9%85%8D%E5%90%88-h2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%E5%BC%80%E5%8F%91"},"13.14. \u914d\u5408 h2 \u6570\u636e\u5e93\u8fdb\u884c\u5f00\u53d1"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13141-h2-%E5%92%8C-spring-data-jpa-%E9%85%8D%E5%90%88"},"13.14.1. h2 \u548c spring data jpa \u914d\u5408")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13142-%E5%92%8C-mybatis-plus-%E9%85%8D%E5%90%88"},"13.14.2. \u548c mybatis-plus \u914d\u5408")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1315-%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90"},"13.15. \u591a\u6570\u636e\u6e90"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13151-%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE-%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"},"13.15.1. \u57fa\u672c\u914d\u7f6e \u5168\u6ce8\u89e3\u5f00\u53d1")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#13152-abstractroutingdatasource-%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E6%BA%90%E5%88%87%E6%8D%A2"},"13.15.2. AbstractRoutingDataSource \u52a8\u6001\u6570\u636e\u6e90\u5207\u6362")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1316-%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B-databaseidprovider"},"13.16. \u591a\u6570\u636e\u5e93\u7c7b\u578b databaseIdProvider")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1317-spring-kafka"},"13.17. spring kafka")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14-web-%E7%9B%B8%E5%85%B3"},"14. web \u76f8\u5173"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#141-%E5%8A%A0%E8%A7%A3%E5%AF%86"},"14.1. \u52a0\u89e3\u5bc6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#142-springboot-%E5%8F%91%E9%80%81-https-%E6%88%96%E8%80%85-http-%E5%AE%A2%E6%88%B7%E7%AB%AF-client"},"14.2. springboot \u53d1\u9001 https \u6216\u8005 http \u5ba2\u6237\u7aef client"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1421-%E5%8F%91%E9%80%81-http-client"},"14.2.1. \u53d1\u9001 http client")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1422-%E5%8F%91%E9%80%81-https-client"},"14.2.2. \u53d1\u9001 https client")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#143-requestcontextholder"},"14.3. RequestContextHolder")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#144-%E8%A7%A3%E5%86%B3-api-%E7%89%88%E6%9C%AC%E5%85%B1%E5%AD%98"},"14.4. \u89e3\u51b3 api \u7248\u672c\u5171\u5b58"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1441-requestmappinghandlermapping"},"14.4.1. RequestMappingHandlerMapping")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1442-request-matcher"},"14.4.2. request matcher")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1443-request-condition"},"14.4.3. request condition")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#145-%E6%8E%A5%E6%94%B6%E5%8F%82%E6%95%B0%E7%9B%B8%E5%85%B3%E7%9A%84%E6%B3%A8%E8%A7%A3"},"14.5. \u63a5\u6536\u53c2\u6570\u76f8\u5173\u7684\u6ce8\u89e3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#146-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A5%E6%94%B6%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B"},"14.6. \u81ea\u5b9a\u4e49\u63a5\u6536\u53c2\u6570\u7c7b\u578b")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#147-%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87"},"14.7. \u8fd4\u56de\u56fe\u7247")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#148-rest-api-%E6%96%87%E6%A1%A3"},"14.8. rest api \u6587\u6863"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1481-knife4j"},"14.8.1. knife4j")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1482-springdoc-openapi"},"14.8.2. springdoc-openapi")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1483-swagger3"},"14.8.3. swagger3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1484-%E9%9B%86%E6%88%90swagger2"},"14.8.4. \u96c6\u6210swagger2")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#149-%E8%BF%87%E6%BB%A4%E5%99%A8-%E5%92%8C-%E6%8B%A6%E6%88%AA%E5%99%A8"},"14.9. \u8fc7\u6ee4\u5668 \u548c \u62e6\u622a\u5668"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1491-%E5%8C%BA%E5%88%AB"},"14.9.1. \u533a\u522b")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1492-%E4%BD%BF%E7%94%A8-filter"},"14.9.2. \u4f7f\u7528 filter")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1493-%E4%BD%BF%E7%94%A8-interceptor"},"14.9.3. \u4f7f\u7528 interceptor"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14931-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%8B%A6%E6%88%AA%E5%99%A8"},"14.9.3.1. \u57fa\u672c\u4f7f\u7528\u62e6\u622a\u5668")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14932-%E5%9F%BA%E4%BA%8E-url-%E6%8B%A6%E6%88%AA"},"14.9.3.2. \u57fa\u4e8e url \u62e6\u622a")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14933-%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%8B%A6%E6%88%AA"},"14.9.3.3. \u57fa\u4e8e\u6ce8\u89e3\u62e6\u622a")))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1410-servlet-druid-%E7%9B%91%E6%8E%A7"},"14.10. servlet Druid \u76d1\u63a7")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1411-aop-%E6%95%B4%E5%90%88%E4%BD%BF%E7%94%A8"},"14.11. aop \u6574\u5408\u4f7f\u7528"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14111-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"},"14.11.1. \u57fa\u672c\u4f7f\u7528")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14112-%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F"},"14.11.2. \u5207\u5165\u70b9\u8868\u8fbe\u5f0f")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1412-controlleradvice-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"},"14.12. @controllerAdvice \u5f02\u5e38\u5904\u7406")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1413-httpservletrequest-%E7%9A%84%E8%BE%93%E5%85%A5%E6%B5%81%E5%8F%AA%E8%83%BD%E8%AF%BB%E5%8F%96%E4%B8%80%E6%AC%A1%E7%9A%84%E9%97%AE%E9%A2%98"},"14.13. HttpServletRequest \u7684\u8f93\u5165\u6d41\u53ea\u80fd\u8bfb\u53d6\u4e00\u6b21\u7684\u95ee\u9898")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1414-%E8%B7%AF%E7%94%B1%E5%A4%84%E7%90%86"},"14.14. \u8def\u7531\u5904\u7406"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14141-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%98%A0%E5%B0%84-%E6%9A%B4%E9%9C%B2%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"},"14.14.1. \u9759\u6001\u8d44\u6e90\u6620\u5c04 \u66b4\u9732\u9759\u6001\u8d44\u6e90")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#14142-%E6%B7%BB%E5%8A%A0-view-controller"},"14.14.2. \u6dfb\u52a0 view controller")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1415-spring-boot-starter-thymeleaf"},"14.15. spring-boot-starter-thymeleaf")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#15-%E8%BF%90%E7%BB%B4%E9%83%A8%E7%BD%B2"},"15. \u8fd0\u7ef4\u90e8\u7f72"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#151-%E6%94%AF%E6%8C%81-https-ssl"},"15.1. \u652f\u6301 https ssl"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1511-nginx-%E9%85%8D%E7%BD%AE-https"},"15.1.1. nginx \u914d\u7f6e https")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1512-%E6%94%AF%E6%8C%81-https-%E8%AE%BF%E9%97%AE"},"15.1.2. \u652f\u6301 https \u8bbf\u95ee")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1513-http-%E8%AF%B7%E6%B1%82%E8%87%AA%E5%8A%A8%E8%BD%AC%E4%B8%BA-https"},"15.1.3. http \u8bf7\u6c42\u81ea\u52a8\u8f6c\u4e3a https")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1514-%E5%90%8C%E6%97%B6%E6%94%AF%E6%8C%81-http-https"},"15.1.4. \u540c\u65f6\u652f\u6301 http https")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#152-%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2"},"15.2. \u5bb9\u5668\u5316\u90e8\u7f72")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#153-nginx-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"},"15.3. nginx \u53cd\u5411\u4ee3\u7406")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#154-%E5%86%85%E5%B5%8C-tomcat-%E8%B0%83%E4%BC%98"},"15.4. \u5185\u5d4c tomcat \u8c03\u4f18")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#155-%E9%85%8D%E7%BD%AE-war-%E5%8C%85%E9%83%A8%E7%BD%B2%E5%88%B0-tomcat"},"15.5. \u914d\u7f6e war \u5305\u90e8\u7f72\u5230 Tomcat")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#16-spring-boot-%E4%B8%AD%E7%9A%84%E5%B9%B6%E5%8F%91"},"16. spring boot \u4e2d\u7684\u5e76\u53d1"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#161-%E4%BD%BF%E7%94%A8%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B"},"16.1. \u4f7f\u7528\u5f02\u6b65\u7f16\u7a0b"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1611-%E9%85%8D%E7%BD%AE%E7%BA%BF%E7%A8%8B%E6%B1%A0"},"16.1.1. \u914d\u7f6e\u7ebf\u7a0b\u6c60")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1612-%E6%9C%89%E8%BF%94%E5%9B%9E%E5%80%BC-%E6%B2%A1%E6%9C%89%E8%BF%94%E5%9B%9E%E5%80%BC"},"16.1.2. \u6709\u8fd4\u56de\u503c \u6ca1\u6709\u8fd4\u56de\u503c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#1613-async%E5%A4%B1%E6%95%88"},"16.1.3. @Async\u5931\u6548")))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#17-%E5%AE%9E%E7%8E%B0%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81"},"17. \u5b9e\u73b0\u4e50\u89c2\u9501\u60b2\u89c2\u9501")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#18-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81"},"18. \u79fb\u52a8\u7aef\u6d88\u606f\u63a8\u9001")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#19-%E5%8D%B3%E6%97%B6%E9%80%9A%E4%BF%A1-im%E7%B3%BB%E7%BB%9F"},"19. \u5373\u65f6\u901a\u4fe1 IM\u7cfb\u7edf")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#20-%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7"},"20. \u8f85\u52a9\u5de5\u5177"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#201-lombok-notice"},"20.1. lombok notice")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#202-devtools"},"20.2. devtools")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#203-maven-wrapper"},"20.3. maven wrapper")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#21-%E6%A0%A1%E9%AA%8C"},"21. \u6821\u9a8c"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#211-%E6%A0%A1%E9%AA%8C%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"},"21.1. \u6821\u9a8c\u914d\u7f6e\u6587\u4ef6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#212-%E6%A0%A1%E9%AA%8C%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"},"21.2. \u6821\u9a8c\u8bf7\u6c42\u53c2\u6570")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#213-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%A1%E9%AA%8C"},"21.3. \u81ea\u5b9a\u4e49\u6821\u9a8c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#214-validated%E5%92%8Cvalid"},"21.4. @Validated\u548c@Valid")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#22-runner-%E8%8E%B7%E5%8F%96%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0"},"22. runner \u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#221-%E8%8E%B7%E5%8F%96%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0"},"22.1. \u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#222-applicationrunner-or-commandlinerunner"},"22.2. ",(0,i.kt)("inlineCode",{parentName:"a"},"ApplicationRunner")," or ",(0,i.kt)("inlineCode",{parentName:"a"},"CommandLineRunner"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#23-%E5%BC%80%E5%8F%91%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%BA%94%E7%94%A8"},"23. \u5f00\u53d1\u547d\u4ee4\u884c\u5e94\u7528")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#24-%E6%95%B4%E5%90%88-grpc"},"24. \u6574\u5408 grpc")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#25-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6"},"25. \u4efb\u52a1\u8c03\u5ea6"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#251-%E6%95%B4%E5%90%88-xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E5%B9%B3%E5%8F%B0"},"25.1. \u6574\u5408 XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u5e73\u53f0")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#252-%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"},"25.2. \u5f02\u6b65\u4efb\u52a1")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#253-%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"},"25.3. \u5b9a\u65f6\u4efb\u52a1"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2531-springboot-%E5%86%85%E7%BD%AE"},"25.3.1. springboot \u5185\u7f6e")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2532-%E9%9B%86%E6%88%90-quartz"},"25.3.2. \u96c6\u6210 Quartz")))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#26-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-and-%E7%8E%AF%E5%A2%83"},"26. \u914d\u7f6e\u6587\u4ef6 and \u73af\u5883"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#261-%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"},"26.1. \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2611-%E5%87%A0%E7%A7%8D%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95"},"26.1.1. \u51e0\u79cd\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u6cd5")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2612-%E6%B3%A8%E5%85%A5%E5%A4%8D%E6%9D%82%E7%B1%BB%E5%9E%8B"},"26.1.2. \u6ce8\u5165\u590d\u6742\u7c7b\u578b")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#262-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BC%98%E5%85%88%E7%BA%A7"},"26.2. \u914d\u7f6e\u6587\u4ef6\u4f18\u5148\u7ea7")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#263-%E8%AF%BB%E5%8F%96%E7%8E%AF%E5%A2%83%E4%BF%A1%E6%81%AF"},"26.3. \u8bfb\u53d6\u73af\u5883\u4fe1\u606f")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#264-%E4%B8%A4%E7%A7%8D%E5%BC%95%E5%85%A5-springboot-%E6%96%B9%E5%BC%8F"},"26.4. \u4e24\u79cd\u5f15\u5165 springboot \u65b9\u5f0f")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#27-%E5%BA%8F%E5%88%97%E5%8C%96-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"},"27. \u5e8f\u5217\u5316 \u53cd\u5e8f\u5217\u5316"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#271-%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4-json"},"27.1. \u65e5\u671f\u65f6\u95f4 json")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#272-jackson-%E4%BD%BF%E7%94%A8"},"27.2. jackson \u4f7f\u7528"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2721-jsoncomponent"},"27.2.1. @JsonComponent")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2722-jackson-%E5%9C%A8-springboot-%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE"},"27.2.2. Jackson \u5728 springboot \u4e2d\u7684\u914d\u7f6e")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2723-jackson%E6%B3%A8%E8%A7%A3"},"27.2.3. jackson\u6ce8\u89e3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2724-objectmapper-%E5%AE%9A%E5%88%B6"},"27.2.4. objectmapper \u5b9a\u5236")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#2725-objectmapper-%E4%BD%BF%E7%94%A8"},"27.2.5. objectmapper \u4f7f\u7528")))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#28-%E6%8E%A5%E5%85%A5%E7%AC%AC%E4%B8%89%E6%96%B9%E6%94%AF%E4%BB%98"},"28. \u63a5\u5165\u7b2c\u4e09\u65b9\u652f\u4ed8")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#29-%E6%8B%BE%E9%81%97"},"29. \u62fe\u9057"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#291-bean-%E6%87%92%E5%8A%A0%E8%BD%BD"},"29.1. bean \u61d2\u52a0\u8f7d"))))),(0,i.kt)("h1",{id:"1-\u5e38\u7528\u547d\u4ee4"},"1. \u5e38\u7528\u547d\u4ee4"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'du -sh *.jar # jar size\n\n# \u6253\u5305\u65f6\u6ca1\u6709\u6307\u5b9a\u4e3b\u7c7b\uff0c\u6267\u884c\u53ef\u4ee5\u7528java -cp {xxx.jar} {\u4e3b\u7c7b\u540d\u79f0\uff08\u7edd\u5bf9\u8def\u5f84\uff09}\u3002\n# -cp \u6307\u5b9a\u7c7b\u8fd0\u884c\u6240\u4f9d\u8d56\u5176\u4ed6\u7c7b\u7684\u8def\u5f84\uff0c\u901a\u5e38\u662f\u7c7b\u5e93\u548cjar\u5305, \n# \u7b49\u4ef7 -classpath\n# \u591a\u4e2ajar\u5305\u4e4b\u95f4\u8fde\u63a5\u7b26\uff1awindow\u4e0a\u5206\u53f7\u201c;\u201d.Linux\u4e0b\u4f7f\u7528\u201c:\u201d\n# \n# win\njava -cp .;d:\\work\\other.jar;d:\\work\\my.jar packname.mainclassname \n# linux\njava -cp .:/hone/myuser/work/other.jar:/hone/myuser/work/my.jar packname.mainclassname \n# \u8868\u8fbe\u5f0f\u652f\u6301\u901a\u914d\u7b26\njava -cp .;c:\\work\\my.jar;c:\\work\\*.jar packname.mainclassname \n\n\n# \u6253\u5305\u65f6\u6307\u5b9a\u4e86\u4e3b\u7c7b\uff0c\u6267\u884c\u53ef\u4ee5\u76f4\u63a5\u7528java -jar {xxx.jar}\u3002\n# \u4f1a\u7528\u5230\u76ee\u5f55META-INF\\MANIFEST.MF\u6587\u4ef6\uff0c\u5728\u8be5\u6587\u4ef6\u4e2d\uff0c\u6709\u4e00\u4e2a\u53ebMain\uff0dClass\u7684\u53c2\u6570\uff0c\u5b83\u8bf4\u660e\u4e86java -jar\u547d\u4ee4\u6267\u884c\u7684\u7c7b\n# java -jar\u65b9\u5f0f\u4e0d\u53ef\u4ee5\u6307\u5b9a\u9644\u52a0\u4f9d\u8d56jar\u5305\u3002\njava -jar *.jar\n\n# \u4f9d\u8d56\u591a\u4e2a jar \u4e0d\u4f7f\u7528\u901a\u914d\u7b26\u4e5f\u53ef\u4ee5\u8fd9\u6837\u6267\u884c\n# -D \u8bbe\u7f6e\u7cfb\u7edf\u5c5e\u6027, \u901a\u8fc7System.getProperty("conf1");\u83b7\u5f97\u8fd9\u4e2a\u503c\njava -Djava.ext.dirs=lib MyClass \n\n# \u8df3\u8fc7\u6d4b\u8bd5\n# -D \u8868\u793a maven \u4e2d\u7684 properties\nmvn -Dmaven.test.skip=true clean package # skip unit test\nmvn -DskipTests clean package\n\nmvn clean package -Pxxx # \u6307\u5b9a\u8981\u6fc0\u6d3b maven profile \u7684 id\n\njava -Dserver.port=8010 -jar xxx.jar # specific server port\njava -jar *.jar --server.port=8010 # \u540c\u4e0a\n\n# \u6307\u5b9a profile\njava -jar *.jar --spring.properties.active=dev\njava -jar -Dspring.profiles.active=dev demo-0.0.1-SNAPSHOT.jar\nmvn spring-boot:run -Drun.profiles=dev\n\n\n\n\n')),(0,i.kt)("h1",{id:"2-\u90e8\u7f72\u811a\u672c"},"2. \u90e8\u7f72\u811a\u672c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'#!/bin/bash\n#\u672c\u811a\u672c\u57fa\u672c\u65e0\u9700\u6539\u52a8\uff0c\u6ce8\u610f\u8981\u70b9\u5747\u5df2\u7528\u4e2d\u6587\u8bf4\u660e\n# 1. \u8bf7\u5c06\u672c\u811a\u672c\u653e\u5230Linux\u7cfb\u7edf\u7684path\u8def\u5f84\u4e0b\uff0c\u6700\u597d\u662f/bin\u76ee\u5f55\u4e0b\n# 2. \u8bf7\u7ed9\u672c\u811a\u672c\u8bbe\u5907\u53ef\u6267\u884c\u6743\u9650\n# 3. \u542f\u52a8\u793a\u4f8b         springboot-starter xxx.jar start\n# 4. \u91cd\u542f\u793a\u4f8b         springboot-starter xxx.jar restart\n# 5. \u505c\u6b62\u793a\u4f8b         springboot-starter xxx.jar stop\n# 6. \u67e5\u770b\u72b6\u6001\u793a\u4f8b     springboot-starter xxx.jar status\n\n## \u83b7\u53d6 java \u547d\u4ee4\u7684\u8def\u5f84\nJAVA_CMD=`which java`\n\nif [ -z "${JAVA_CMD}" ];then\n  echo "Please install the Java environment";\n  exit 1;\nfi\n\n## \u8f93\u51fa\u672c\u547d\u4ee4\u7684\u4f7f\u7528\u65b9\u6cd5 \u5e76\u9000\u51fa\nusage() {\n    echo "Usage: springboot-starter [app_name].jar [start|stop|restart|status]"\n    exit 1\n}\n\n## \u5224\u65ad\u662f\u5426\u8f93\u5165\u4e86\u4e24\u4e2a\u53c2\u6570\nif [ $# -lt 2 ]; then\n    usage\nfi\n\n\n## \u811a\u672c\u540d\u79f0\nAPP_NAME=$1;\n\n## \u64cd\u4f5c\nOPERATION=$2;\n\n## \u8fd0\u884c\u6a21\u5f0f\nMODEL=$3\n\nif [ -z "$MODEL" ]; then\n    MODEL="production"\nfi\n\n## \u5176\u5b83\u53c2\u6570\u5904\u7406\nOTHER_ARGS=""\nif [ $# -gt 3 ]; then\n    shift 3\nelse\n    shift $#\nfi\nfor ARG in $*\ndo\n  OTHER_ARGS="$OTHER_ARGS $ARG"\ndone\n\n\n## \u811a\u672c\u6240\u5728\u76ee\u5f55\uff0c\u7edd\u5bf9\u8def\u5f84\u8868\u793a\nBASE_PATH=$(cd `dirname $APP_NAME`;pwd)\n\n## \u53bb\u6389\u6240\u6709\u76ee\u5f55\u540e\u7684\u811a\u672c\u540d\nAPP_NAME=${APP_NAME##*/}\n\n## \u811a\u672c\u7684\u8def\u5f84\uff0c\u7edd\u5bf9\u8def\u5f84\u8868\u793a\nAPP_PATH=$BASE_PATH"/"$APP_NAME\n\n\n## \u5224\u65ad\u76ee\u6807\u7a0b\u5e8f\u662f\u5426\u5df2\u7ecf\u542f\u52a8\nis_running(){\n  ## \u5c1d\u8bd5\u83b7\u53d6\u5df2\u7ecf\u8fd0\u884c\u7a0b\u5e8f\u7684PID\n  PID=`ps -ef|grep ${APP_PATH}|grep -v grep|awk \'{print $2}\'`\n  if [ -z "${PID}" ]; then\n    return 0\n  else\n    return 1\n  fi\n}\n\n## \u542f\u52a8\u7a0b\u5e8f\nstart(){\n  is_running\n  if [ $? -eq "1" ]; then\n    echo "${APP_NAME} is already running. pid is ${PID} ."\n  else\n    ## \u542f\u52a8 jar \u5305\n    echo "${APP_NAME} starting ...... "\n    nohup ${JAVA_CMD} -jar ${OTHER_ARGS} -Dspring.profiles.active=${MODEL} ${APP_PATH} > /dev/null 2>&1 &\n    echo "nohup ${JAVA_CMD} -jar ${OTHER_ARGS} -Dspring.profiles.active=${MODEL} ${APP_PATH} > /dev/null 2>&1 &"\n    sleep 1\n    echo "${APP_NAME} started  completed "\n    echo ""\n  fi\n}\n\n## \u505c\u6b62\u7a0b\u5e8f\nstop(){\n  is_running\n  if [ $? -eq "1" ]; then\n    echo "PID is ${PID}, ${APP_NAME} stopping ...... "\n    kill ${PID}\n    if [ $? -ne "0" ]; then\n        echo "kill ${PID} failed\uff0cexecute kill -9 ${PID}"\n        kill -9 ${PID}\n    fi\n    sleep 1\n    echo "${APP_NAME} stopped completed "\n  else\n    echo "${APP_NAME} is not running"\n  fi\n}\n\n## \u8f93\u51fa\u7a0b\u5e8f\u8fd0\u884c\u72b6\u6001\nstatus(){\n  is_running\n  if [ $? -eq "1" ]; then\n    echo "${APP_NAME} is running. pid is ${PID}"\n  else\n    echo "${APP_NAME} is NOT running."\n  fi\n}\n\n## \u91cd\u542f\u7a0b\u5e8f\nrestart(){\n  stop\n  start\n}\n\n\ncase "$OPERATION" in\n  "start")\n    start ;;\n  "stop")\n    stop ;;\n  "status")\n    status ;;\n  "restart")\n    restart ;;\n  *)\n    usage ;;\nesac\nexit 0\n\n')),(0,i.kt)("h1",{id:"3-\u5de5\u5177\u7c7b"},"3. \u5de5\u5177\u7c7b"),(0,i.kt)("h2",{id:"31-bean-\u590d\u5236-\u514b\u9686"},"3.1. bean \u590d\u5236 \u514b\u9686"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"beancopier\n\nhttps://github.com/mapstruct/mapstruct\n")),(0,i.kt)("h2",{id:"32-\u5b57\u7b26\u4e32"},"3.2. \u5b57\u7b26\u4e32"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// >>> springboot \u81ea\u5e26\n\nRandomStringUtils \u751f\u6210\u968f\u673a\u5b57\u7b26\u4e32, \u968f\u673a\u6570\u5b57\nStringUtils.isEmpty() \u5e76\u975e\u4e25\u683c\u7684\u7a7a\n\n")),(0,i.kt)("h2",{id:"33-\u7f16\u89e3\u7801"},"3.3. \u7f16\u89e3\u7801"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// >>> springboot \u81ea\u5e26\n\npublic static String getMD5(String str) {\n        String base = str + "/" + salt;\n        String md5 = DigestUtils.md5DigestAsHex(base.getBytes());\n        return md5;\n    }\n\n')),(0,i.kt)("h2",{id:"34-commons-lang3"},"3.4. commons-lang3"),(0,i.kt)("h2",{id:"35-\u6587\u4ef6\u64cd\u4f5c"},"3.5. \u6587\u4ef6\u64cd\u4f5c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// springboot \u539f\u751f \u6587\u4ef6\u4e0b\u8f7d\n\n@GetMapping("/download")\npublic ResponseEntity<Resource> download(HttpServletResponse httpServletResponse,\n                                            @RequestParam("id") String objId) throws Exception {\n    final MongoSysFileServiceImpl.DownloadFileVo downloadFileVo = sysFileService.downloadFile(objId);\n    if (downloadFileVo == null) {\n        throw new RuntimeException("\u6307\u5b9a\u6587\u4ef6\u4e0d\u5b58\u5728, objId = " + objId);\n    }\n\n    return ResponseEntity.ok()\n            .contentType(MediaType.parseMediaType("application/octet-stream"))\n            .header(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=\\"" + downloadFileVo.getFilename() + "\\"")\n            .body(new InputStreamResource(downloadFileVo.getIs()));\n\n}\n\n//\u4e0a\u4f20\n @PostMapping(value = "upload")\npublic R<SysFile> upload(@RequestPart("file") MultipartFile file)\n{\n    try\n    {\n        // \u4e0a\u4f20\u5e76\u8fd4\u56de\u8bbf\u95ee\u5730\u5740\n        final MongoSysFileServiceImpl.UploadFileResp uploadFileResp = sysFileService.uploadFile(file);\n        SysFile sysFile = new SysFile();\n        sysFile.setObjId(uploadFileResp.getObjId());\n        sysFile.setName(uploadFileResp.getGeneratedName());\n        return R.ok(sysFile);\n    }\n    catch (Exception e)\n    {\n        log.error("\u4e0a\u4f20\u6587\u4ef6\u5931\u8d25", e);\n        return R.fail(e.getMessage());\n    }\n}\n//feign client \u8fdc\u7a0b\u8c03\u7528\n@PostMapping(value = "/upload", consumes = MediaType.MULTIPART_FORM_DATA_VALUE)\npublic R<SysFile> upload(@RequestPart(value = "file") MultipartFile file);\n\n\n\n// \u4f20\u9012 \u6587\u4ef6 , \u540c\u65f6\u4f20\u9012\u8bf7\u6c42\u53c2\u6570\n@PostMapping("/add")\n    public AjaxResult add( EstimateFile estimateFile, @RequestPart("files") MultipartFile[] files)\n    { //@RequestPart("estimateFile")\n        return toAjax(estimateFileService.insertEstimateFile(estimateFile, files));\n    }\n\n')),(0,i.kt)("h2",{id:"36-commons-collections4"},"3.6. commons-collections4"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"isSubCollection(smallColl, bigColl)\n\n\n/**\n    * 1\u3001\u9664\u975e\u5143\u7d20\u4e3anull\uff0c\u5426\u5219\u5411\u96c6\u5408\u6dfb\u52a0\u5143\u7d20\n    */\nCollectionUtils.addIgnoreNull(personList,null);\n\n\n// >>> \u5408\u5e76\n\n/**\n    * 2\u3001\u5c06\u4e24\u4e2a\u5df2\u6392\u5e8f\u7684\u96c6\u5408a\u548cb\u5408\u5e76\u4e3a\u4e00\u4e2a\u5df2\u6392\u5e8f\u7684\u5217\u8868\uff0c\u4ee5\u4fbf\u4fdd\u7559\u5143\u7d20\u7684\u81ea\u7136\u987a\u5e8f\n    */\nCollectionUtils.collate(Iterable<? extends O> a, Iterable<? extends O> b)\n/**\n    * 3\u3001\u5c06\u4e24\u4e2a\u5df2\u6392\u5e8f\u7684\u96c6\u5408a\u548cb\u5408\u5e76\u5230\u4e00\u4e2a\u5df2\u6392\u5e8f\u7684\u5217\u8868\u4e2d\uff0c\u4ee5\u4fbf\u4fdd\u7559\u6839\u636eComparator c\u7684\u5143\u7d20\u987a\u5e8f\u3002\n    */\nCollectionUtils.collate(Iterable<? extends O> a, Iterable<? extends O> b, Comparator<? super O> c)\n\n\n// >>> \u5224\u7a7a\n\n/**\n    * 5\u3001\u5982\u679c\u53c2\u6570\u662fnull\uff0c\u5219\u8fd4\u56de\u4e0d\u53ef\u53d8\u7684\u7a7a\u96c6\u5408\uff0c\u5426\u5219\u8fd4\u56de\u53c2\u6570\u672c\u8eab\u3002\uff08\u5f88\u5b9e\u7528 ,\u6700\u7ec8\u8fd4\u56deList EMPTY_LIST = new EmptyList<>()\uff09\n    */\nCollectionUtils.emptyIfNull(Collection<T> collection)\n/**\n    * 6\u3001\u7a7a\u5b89\u5168\u68c0\u67e5\u6307\u5b9a\u7684\u96c6\u5408\u662f\u5426\u4e3a\u7a7a\n    */\nCollectionUtils.isEmpty(Collection<?> coll)\n/**\n    * 7\u3001 \u7a7a\u5b89\u5168\u68c0\u67e5\u6307\u5b9a\u7684\u96c6\u5408\u662f\u5426\u4e3a\u7a7a\u3002\n    */\nCollectionUtils.isNotEmpty(Collection<?> coll)\n\n\n\n// >> \u5224\u65ad\u662f\u5426\u5305\u542b \n\n/**\n    * 4\u3001\u8fd4\u56de\u8be5\u4e2a\u96c6\u5408\u4e2d\u662f\u5426\u542b\u6709\u81f3\u5c11\u6709\u4e00\u4e2a\u5143\u7d20\n    */\nCollectionUtils.containsAny(Collection<?> coll1, T... coll2)\n\n\n// >>> \u7ffb\u8f6c\n\n/**\n    * 8\u3001\u53cd\u8f6c\u7ed9\u5b9a\u6570\u7ec4\u7684\u987a\u5e8f\u3002\n    */\nCollectionUtils.reverseArray(Object[] array);\n\n\n\n/**\n    * 9\u3001\u5dee\u96c6   or   chaList.removeAll(listB);\n    or          listA.stream().filter(item -> !listB.contains(item)).collect(toList());\n    */\nCollectionUtils.subtract(Iterable<? extends O> a, Iterable<? extends O> b)\n/**\n    * 10\u3001\u5e76\u96c6    or     \u5148 bingList.removeAll(listB), \u518dbingList.addAll(listB); ((\u5148\u505a\u5dee\u96c6\u518d\u505a\u6dfb\u52a0\u6240\u6709\uff09)\n    */\nCollectionUtils.union(Iterable<? extends O> a, Iterable<? extends O> b)\n/**\n    * 11\u3001\u4ea4\u96c6   \u4e5f\u53ef\u7528 jiaoList.retainAll(listB); \u8fd4\u56de Boolean, \u4f1a\u6539\u53d8\u539f\u6709\u96c6\u5408\n    or          listA.stream().filter(item -> listB.contains(item)).collect(toList())\n    */\nCollectionUtils.intersection(Collection a, Collection b) // \u8fd4\u56de\u65b0\u96c6\u5408\n/**\n    *12\u3001 \u4ea4\u96c6\u7684\u8865\u96c6\uff08\u6790\u53d6\uff09\n    */\nCollectionUtils.disjunction(Collection a, Collection b)\n")),(0,i.kt)("h1",{id:"4-\u548c-react-\u4e00\u8d77\u6253\u5305"},"4. \u548c react \u4e00\u8d77\u6253\u5305"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/arpan-banerjee7/demo-spring-react-maven-plugin"},"https://github.com/arpan-banerjee7/demo-spring-react-maven-plugin")),(0,i.kt)("p",null,"TODO"),(0,i.kt)("h1",{id:"5-spring-boot\u4e2d\u7684\u6ce8\u89e3"},"5. Spring Boot\u4e2d\u7684\u6ce8\u89e3"),(0,i.kt)("h2",{id:"51-configurationproperties-\u548c-value"},"5.1. @ConfigurationProperties \u548c @Value"),(0,i.kt)("p",null,"@Value \u662fcore container\u7684feature\u3002\u4e0d\u652f\u6301\u5bbd\u677e\u7ed1\u5b9a\uff0c\u4e0d\u652f\u6301Meta-data\u3002\u4f46\u652f\u6301spELl\u3002\n@ConfigurationProperties \u5219\u652f\u6301\u5bbd\u677e\u7ed1\u5b9a\uff0c\u652f\u6301Meta-data\u3002\u4f46\u4e0d\u652f\u6301spELl\u3002"),(0,i.kt)("p",null,"@ConfigurationProperties\u4e00\u822c\u53ea\u7528\u6765\u5904\u7406\u73af\u5883\u4fe1\u606f\uff0c\u4e0d\u7528\u6765\u6ce8\u5165\u81ea\u5b9a\u4e49\u5c5e\u6027\uff08\u8fd9\u6bb5\u4e0d\u77e5\u9053\u7ffb\u8bd1\u5f97\u51c6\u4e0d\u51c6\uff0c\u539f\u6587\u5982\u4e0b\uff1aEven if the configuration above will create a regular bean for FooProperties, we recommend that @ConfigurationProperties only deal with the environment and in particular does not inject other beans from the context. Having said that, The @EnableConfigurationProperties annotation is also automatically applied to your project so that any existing bean annotated with @ConfigurationProperties will be configured from the Environment.\uff09   "),(0,i.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\uff1a  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"myProps: #\u81ea\u5b9a\u4e49\u7684\u5c5e\u6027\u548c\u503c    \n  simpleProp: simplePropValue    \n  arrayProps: 1,2,3,4,5    \n  listProp1:    \n    - name: abc    \n      value: abcValue    \n    - name: efg    \n      value: efgValue    \n  listProp2:    \n    - config2Value1    \n    - config2Vavlue2    \n  mapProps:    \n    key1: value1    \n    key2: value2  \n")),(0,i.kt)("p",null,"\u521b\u5efa\u4e00\u4e2abean\u6765\u63a5\u53d7\u4fe1\u606f\uff1a(\u8fd9\u91cc\u4e0d\u63a8\u8350\u8fd9\u4e48\u7528, \u5e94\u8be5\u4f7f\u7528 @value \u8001\u8001\u5b9e\u5b9e\u5c5e\u6027\u5199\u5168)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// @Component    // \u8fd9\u4e2a\u6ce8\u89e3\u53ef\u9009\n@data\n@ConfigurationProperties(prefix="myProps") //\u63a5\u6536application.yml\u4e2d\u7684myProps\u4e0b\u9762\u7684\u5c5e\u6027   (prefix \u5fc5\u987b, \u4e0d\u53ef\u4e3a"", \u9700\u8981\u5728\u914d\u7f6e\u7c7b\u4e2d enable config props class)\n// \u6b64\u65f6 idea \u63d0\u793a spring boot config annotation processor not configured, \u662f\u56e0\u4e3a\u4ed6\u4ee5\u4e3a\u4f60\u8981\u4e3a\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\u81ea\u5b9a\u4e49\u5c5e\u6027, \u9700\u8981\u751f\u6210\u63d0\u793a \n// \u53ef\u4ee5https://docs.spring.io/spring-boot/docs/2.3.4.RELEASE/reference/html/appendix-configuration-metadata.html#configuration-metadata-annotation-processor\npublic class MyProps {    \n    private String simpleProp;    \n    private String[] arrayProps;    \n    private List<Map<String, String>> listProp1 = new ArrayList<>(); //\u63a5\u6536prop1\u91cc\u9762\u7684\u5c5e\u6027\u503c    \n    private List<String> listProp2 = new ArrayList<>(); //\u63a5\u6536prop2\u91cc\u9762\u7684\u5c5e\u6027\u503c    \n    private Map<String, String> mapProps = new HashMap<>(); //\u63a5\u6536prop1\u91cc\u9762\u7684\u5c5e\u6027\u503c    \n}\n')),(0,i.kt)("p",null,"\u9664\u4e86\u53ef\u4ee5\u4f7f\u7528@ConfigurationProperties\u6ce8\u89e3\u4e00\u4e2a\u7c7b\uff0c\u8fd8\u53ef\u4ee5\u5728@Bean\u65b9\u6cd5\u4e0a\u4f7f\u7528\uff1b\u9700\u8981\u7ed1\u5b9a\u5c5e\u6027\u5230\u4e0d\u53d7\u4f60\u63a7\u5236\u7684\u7b2c\u4e09\u65b9\u7ec4\u4ef6\u65f6\uff0c\u8fd9\u79cd\u65b9\u5f0f\u975e\u5e38\u6709\u7528\u3002  "),(0,i.kt)("p",null,"\u4e3a\u4e86\u4ece\u73af\u5883\u5c5e\u6027\u914d\u7f6e\u4e00\u4e2abean\uff0c\u5c06@ConfigurationProperties\u6dfb\u52a0\u5230\u5b83\u7684bean\u6ce8\u518c\u8fc7\u7a0b,\u4efb\u4f55\u4ee5foo\u4e3a\u524d\u7f00\u7684\u5c5e\u6027\u5b9a\u4e49\u90fd\u4f1a\u88ab\u6620\u5c04\u5230FooComponent\u4e0a\uff1a  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@ConfigurationProperties(prefix = "foo")\n@Bean\npublic FooComponent fooComponent() {\n...\n}\n')),(0,i.kt)("p",null,"\u5bf9\u4e8e\u65e0\u6cd5\u8f6c\u6362\u7684\u5c5e\u6027, \u6bd4\u5982\u672c\u6765\u662f\u4e00\u4e2a Boolean \u7c7b\u578b, \u4f46\u662f\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u7684\u662f string \u7c7b\u578b, ignoreInvalidFields \u53ef\u4ee5\u51b3\u5b9a\u662f\u5426\u629b\u51fa\u5f02\u5e38, \u9ed8\u8ba4\u4e3a false, \u8868\u793a\u8981\u629b\u51fa\u5f02\u5e38"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u914d\u7f6e\u6587\u4ef6\u4e2d\u591a\u4f59\u7684\u5c5e\u6027, ignoreUnknownFields \u51b3\u5b9a\u662f\u5426\u629b\u51fa\u5f02\u5e38, \u9ed8\u8ba4 true, \u8868\u793a\u4e0d\u629b\u51fa\u5f02\u5e38"),(0,i.kt)("h2",{id:"52-enableconfigurationproperties"},"5.2. @EnableConfigurationProperties"),(0,i.kt)("p",null,"\u914d\u7f6e\u54ea\u4e9b\u7c7b\u662f\u7528\u6765\u63a5\u53d7\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u7684bean,\u5f53@EnableConfigurationProperties\u6ce8\u89e3\u5e94\u7528\u5230\u4f60\u7684@Configuration\u65f6\uff0c\u4efb\u4f55\u88ab@ConfigurationProperties\u6ce8\u89e3\u7684beans\u5c06\u81ea\u52a8\u88abEnvironment\u5c5e\u6027\u914d\u7f6e  , configBean \u65e0\u9700 @component"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"@EnableConfigurationProperties({LiquibaseProperties.class, ApplicationProperties.class})\n")),(0,i.kt)("p",null,"\u5f53\u4e00\u4e2a @ConfigurationProperties bean \u50cf\u5982\u4e0a\u8fd9\u6837\u6ce8\u518c\uff0c\u8fd9\u4e2abean\u5c31\u6709\u4e86\u4e00\u4e2a\u540d\u5b57\uff0c\u89c4\u8303\u662f\u8fd9\u6837\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"<prefix>-<fqn>"),", \u5373\uff1a\u524d\u7f00-\u5168\u9650\u5b9a\u540d\uff0c\u5982\uff1a  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"myProps-com.xy.PropertiesBean\n")),(0,i.kt)("p",null,"enableXXX \u7c7b\u6ce8\u89e3\u539f\u7406\u5c31\u662f \u5b9a\u4e49\u4e00\u4e2a\u6ce8\u89e3, \u5728\u6ce8\u89e3\u4e0a\u901a\u8fc7 @import \u5f15\u5165\u4e00\u4e2a\u914d\u7f6e\u7c7b"),(0,i.kt)("h2",{id:"53-enableautoconfiguration"},"5.3. @EnableAutoConfiguration"),(0,i.kt)("p",null,"\u6839\u636e\u6dfb\u52a0\u7684jar\u4f9d\u8d56\u731c\u6d4b\u4f60\u60f3\u5982\u4f55\u914d\u7f6eSpring\uff0c\u5982\u679c\u53d1\u73b0\u5e94\u7528\u4e86\u4f60\u4e0d\u60f3\u8981\u7684\u7279\u5b9a\u81ea\u52a8\u914d\u7f6e\u7c7b\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 @EnableAutoConfiguration \u6ce8\u89e3\u7684exclude\u5c5e\u6027\u6765\u7981\u7528\u5b83\u4eec  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"@EnableAutoConfiguration(exclude = {MetricFilterAutoConfiguration.class, MetricRepositoryAutoConfiguration.class})\n")),(0,i.kt)("p",null,"\u4f7f\u7528\u4e00\u822c\u662f@EnableAutoConfiguration\u52a0\u5230\u4e00\u4e2a\u4e3b@configration\u7c7b\u4e0a\uff0c\u4e3b\u914d\u7f6e\u7c7b\u4e00\u822c\u5c31\u662fapp\u7684\u542f\u52a8\u7c7b  "),(0,i.kt)("h2",{id:"54-componentscan"},"5.4. @ComponentScan"),(0,i.kt)("p",null,"\u626b\u63cf\u6240\u6709Spring\u7ec4\u4ef6\uff0c\u901a\u8fc7@autowired\u6ce8\u5165\u4f7f\u7528  "),(0,i.kt)("p",null,"\u5982\u679c\u4f7f\u7528\u4e0a\u9762\u5efa\u8bae\u7684\u7ed3\u6784\u7ec4\u7ec7\u4ee3\u7801\uff08\u5c06\u5e94\u7528\u7c7b\u653e\u5230\u6839\u5305\u4e0b\uff09\uff0c\u4f60\u53ef\u4ee5\u6dfb\u52a0 @ComponentScan \u6ce8\u89e3\u800c\u4e0d\u9700\u8981\u4efb\u4f55\u53c2\u6570\u3002\u4f60\u7684\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u7ec4\u4ef6\uff08 @Component , @Service , @Repository , @Controller \u7b49\uff09\u5c06\u88ab\u81ea\u52a8\u6ce8\u518c\u4e3aSpring Beans\u3002  "),(0,i.kt)("h2",{id:"55-springbootapplication"},"5.5. @SpringBootApplication"),(0,i.kt)("p",null,"@SpringBootApplication \u6ce8\u89e3\u7b49\u4ef7\u4e8e\u4ee5\u9ed8\u8ba4\u5c5e\u6027\u4f7f\u7528 @Configuration \uff0c @EnableAutoConfiguration \u548c @ComponentScan   "),(0,i.kt)("h2",{id:"56-component\u548cbean\u548cconfigration\u533a\u522b"},"5.6. @Component\u548c@Bean\u548c@Configration\u533a\u522b"),(0,i.kt)("p",null,"@Configuration \u6ce8\u89e3\u672c\u8d28\u4e0a\u8fd8\u662f @Component, "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Component\npublic @interface Configuration {\n    @AliasFor(\n        annotation = Component.class\n    )\n    String value() default "";\n\n    boolean proxyBeanMethods() default true;// \u9ed8\u8ba4\u4e3a true, config bean \u4e2d\u7684\u65b9\u6cd5\u88ab cglib \u4ee3\u7406, \u8868\u793a \u5728\u540c\u4e2a config bean \u4e2d\u5d4c\u5957\u8c03\u7528\u65b9\u6cd5, \u8fd4\u56de\u7684\u5bf9\u8c61\u9ed8\u8ba4\u4ece ioc container \u4e2d\u83b7\u53d6, \u4e0d\u4f1a\u65b0\u521b\u5efa\u5bf9\u8c61\n}\n\n')),(0,i.kt)("p",null,"@Configuration\u4e00\u822c\u548c@bean\u5408\u7528, @component\u548c@bean\u4e0d\u80fd\u5408\u7528"),(0,i.kt)("p",null,"Spring Boot\u63d0\u5021\u57fa\u4e8eJava\u7684\u914d\u7f6e\uff0c\u901a\u5e38\u7b80\u6613\u542f\u52a8\u7c7b\u4f5c\u4e3a\u4e3b\u914d\u7f6e\u7c7b\uff0c\u5176\u4ed6\u914d\u7f6e\u7c7b\u901a\u8fc7@import\u5bfc\u5165\u5230\u4e3b\u914d\u7f6e\u7c7b\uff1b@ComponentScan\u4e5f\u4f1a\u626b\u63cf\u914d\u7f6e\u7c7b  ,\u5982\u679c\u4e0d\u5f97\u4e0d\u4f7f\u7528\u57fa\u4e8exml\u7684\u914d\u7f6e\uff0c\u4ecd\u65e7\u53ef\u4ee5\u4ece\u4e00\u4e2a@configration\u7c7b\u5f00\u59cb\uff0c\u901a\u8fc7@ImportResource \u6ce8\u89e3\u52a0\u8f7dXML\u914d\u7f6e\u6587\u4ef6\u3002  "),(0,i.kt)("p",null,"@Component\u88ab\u7528\u5728\u8981\u88ab\u81ea\u52a8\u626b\u63cf\u548c\u88c5\u914d\u7684\u7c7b\u4e0a\uff0cSpring \u6ce8\u89e3@Component\u7b49\u6548\u4e8e@Service,@Controller,@Repository\uff1b@Bean\u53ea\u80fd\u7528\u4e8e\u65b9\u6cd5(\u65b9\u6cd5\u540d\u4f5c\u4e3aioc\u5bb9\u5668\u4e2d\u7684bean name)\u548c\u6ce8\u89e3\u4e0a\u3002\u7528@Configuration\u6ce8\u89e3\u8be5\u7c7b\uff0c\u7b49\u4ef7 \u4e0eXML\u4e2d\u914d\u7f6ebeans\uff1b\u7528@Bean\u6807\u6ce8\u65b9\u6cd5\u7b49\u4ef7\u4e8eXML\u4e2d\u914d\u7f6ebean\u3002  "),(0,i.kt)("p",null,"\u5728\u9879\u76ee\u4e2d\uff0c\u672c\u5de5\u7a0b\u7684bean\u6ce8\u518c\uff0c\u4f7f\u7528@Component\uff0c\u901a\u8fc7web service\u53d6\u5f97\u7684bean\uff0c\u901a\u8fc7@Bean\u6807\u6ce8\u5728\u83b7\u53d6\u65b9\u6cd5\u4e0a\u6ce8\u518c\uff1b"),(0,i.kt)("h2",{id:"57-import\u548cimportresource\u548cpropertysource\u6bd4\u8f83"},"5.7. @Import\u548c@ImportResource\u548c@PropertySource\u6bd4\u8f83"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u524d\u4e24\u8005\u90fd\u9700\u8981\u548c@configuration\u914d\u5408\u4f7f\u7528(Both @Import @ImportResource work with @Configuration), \u8868\u793a\u5bfc\u5165\u989d\u5916\u7684\u914d\u7f6e",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"@import \u5bfc\u5165\u67d0\u4e2a\u914d\u7f6e\u7c7b, \u8fd9\u4e2a\u914d\u7f6e\u7c7b\u53ef\u4ee5\u4e0d\u7528\u6807\u6ce8 @configuration (\u4e00\u822c\u4f1a\u914d\u5408\u81ea\u5b9a\u4e49\u6ce8\u89e3\u4f7f\u7528: \u81ea\u5b9a\u4e49\u6ce8\u89e3\u4e0a\u901a\u8fc7 @import \u5bfc\u5165\u591a\u4e2a\u672a\u6807\u6ce8@configuration \u7684\u914d\u7f6e\u7c7b\u4f7f\u5f97\u8fd9\u4e9b\u914d\u7f6e\u7c7b\u751f\u6548)"))),(0,i.kt)("li",{parentName:"ul"},'@ImportResource\u7528\u6765\u5f15\u5165\u5916\u7f6e\u7684\u914d\u7f6e\u6587\u4ef6, \u5982@ImportResource({"classpath:datasource.xml"}), \u4e00\u822c\u7528\u6765\u5bfc\u5165Spring\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8ba9\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u529f\u80fd\u751f\u6548'),(0,i.kt)("li",{parentName:"ul"},"@Import\u5f15\u5165\u53e6\u5916\u7684@configuration\u7c7b"),(0,i.kt)("li",{parentName:"ul"},'@PropertySource\u7528\u4e8e\u52a0\u8f7d\u53e6\u5916\u7684\u5c5e\u6027\u914d\u7f6e\u6587\u4ef6, \u5982@PropertySource(value = {"classpath:person.properties"}), \u4e00\u822c\u548c@ConfigurationProperties(prefix = "person")\u4e00\u8d77\u7528\nspringboot\u9ed8\u8ba4\u53ea\u4f1a\u52a0\u8f7dapplication.properties\u4e2d\u7684\u5c5e\u6027,')),(0,i.kt)("p",null,"\u4f8b\u5b50:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@Configuration\n@Import(AnotherConfig.class)\n@ImportResource(\u201cclasspath:/com/acme/properties-config.xml\u201d)\n@PropertySource(\u201cclasspath:some.properties\u201d)\npublic class AppConfig\n{\n// blah\u2026\n}\n\n")),(0,i.kt)("h1",{id:"6-context-\u4e0a\u4e0b\u6587-\u624b\u52a8\u6ce8\u518cbean"},"6. context \u4e0a\u4e0b\u6587 \u624b\u52a8\u6ce8\u518cbean"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/qq_36628536/article/details/113753368"},"https://blog.csdn.net/qq_36628536/article/details/113753368")," \u4ecb\u7ecd"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// plan 1: (\u6b64\u79cd\u65b9\u5f0f\u6ce8\u518c\u7684bean\u5728\u8c03\u7528\u65f6\u5c06\u7531spring\u8fdb\u884c\u521b\u5efa\uff0c\u76f8\u5f53\u4e8e\u5ef6\u8fdf\u52a0\u8f7dbean)\n\n@Component\npublic class ApplicationContextUtil implements ApplicationContextAware {\n\n    private static ApplicationContext applicationContext;\n    @Override\n    public void setApplicationContext(ApplicationContext context) throws BeansException {\n        applicationContext=context;\n    }\n\n/**\n     *  \u52a8\u6001\u6ce8\u5165bean\n     * @param requiredType \u6ce8\u5165\u7c7b\n     * @param beanName bean\u540d\u79f0\n     */\n    public static Object registerBean(Class<?> requiredType,String beanName){\n\n        //\u5c06applicationContext\u8f6c\u6362\u4e3aConfigurableApplicationContext\n        ConfigurableApplicationContext configurableApplicationContext = (ConfigurableApplicationContext) applicationContext;\n\n        //\u83b7\u53d6BeanFactory\n        DefaultListableBeanFactory defaultListableBeanFactory = (DefaultListableBeanFactory) configurableApplicationContext.getAutowireCapableBeanFactory();\n\n        //\u521b\u5efabean\u4fe1\u606f.\n        BeanDefinitionBuilder beanDefinitionBuilder = BeanDefinitionBuilder.genericBeanDefinition(requiredType);\n\n        //\u52a8\u6001\u6ce8\u518cbean.\n        defaultListableBeanFactory.registerBeanDefinition(beanName, beanDefinitionBuilder.getBeanDefinition());\n\n        //\u83b7\u53d6\u52a8\u6001\u6ce8\u518c\u7684bean.\n        return configurableApplicationContext.getBean(requiredType);\n    }\n\uff5d\n\n\n\n// plan 2: (\u6b64\u79cd\u65b9\u5f0f\u5141\u8bb8\u624b\u52a8\u521b\u5efa\u5355\u4f8bbean\u5b9e\u4f8b\u5e76\u6ce8\u518c\uff0c\u6ce8\u610f\u5fc5\u987b\u662f\u5355\u4f8b\u7684\uff0c\u5728spring\u8c03\u7528\u65f6\uff0c\u4f1a\u5c06\u624b\u52a8\u521b\u5efa\u7684bean\u76f4\u63a5\u6ce8\u5165\u5230\u8c03\u7528\u65b9)\n\n@Component\npublic class ApplicationContextUtil implements ApplicationContextAware {\n\n    private static ApplicationContext applicationContext;\n    @Override\n    public void setApplicationContext(ApplicationContext context) throws BeansException {\n        applicationContext=context;\n    }\n\n    /**\n     *  \u52a8\u6001\u6ce8\u5165\u5355\u4f8bbean\u5b9e\u4f8b\n     * @param beanName bean\u540d\u79f0\n     * @param singletonObject \u5355\u4f8bbean\u5b9e\u4f8b\n     * @return \u6ce8\u5165\u5b9e\u4f8b\n     */\n    public static Object registerSingletonBean(String beanName,Object singletonObject){\n\n        //\u5c06applicationContext\u8f6c\u6362\u4e3aConfigurableApplicationContext\n        ConfigurableApplicationContext configurableApplicationContext = (ConfigurableApplicationContext) applicationContext;\n\n        //\u83b7\u53d6BeanFactory\n        DefaultListableBeanFactory defaultListableBeanFactory = (DefaultListableBeanFactory) configurableApplicationContext.getAutowireCapableBeanFactory();\n\n        //\u52a8\u6001\u6ce8\u518cbean.\n        defaultListableBeanFactory.registerSingleton(beanName,singletonObject);\n\n        //\u83b7\u53d6\u52a8\u6001\u6ce8\u518c\u7684bean.\n        return configurableApplicationContext.getBean(beanName);\n    }\n\uff5d\n\n\n\n")),(0,i.kt)("h1",{id:"7-\u5b9e\u73b0\u4e8b\u4ef6\u9a71\u52a8"},"7. \u5b9e\u73b0\u4e8b\u4ef6\u9a71\u52a8"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'/*\n\nApplicationEvent\uff1a\u8868\u793a\u4e8b\u4ef6\u672c\u8eab\uff0c\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u9700\u8981\u7ee7\u627f\u8be5\u7c7b\uff0c\u7528\u6765\u5b9a\u4e49\u4e8b\u4ef6\n\nApplicationEventPublisher\uff1a\u4e8b\u4ef6\u53d1\u9001\u5668\uff0c\u4e3b\u8981\u7528\u6765\u53d1\u5e03\u4e8b\u4ef6\n\nApplicationListener\uff1a\u4e8b\u4ef6\u76d1\u542c\u5668\u63a5\u53e3\uff0c\u76d1\u542c\u7c7b\u5b9e\u73b0ApplicationListener \u91cconApplicationEvent\u65b9\u6cd5\u5373\u53ef\uff0c\u4e5f\u53ef\u4ee5\u5728\u65b9\u6cd5\u4e0a\u589e\u52a0@EventListener\u4ee5\u5b9e\u73b0\u4e8b\u4ef6\u76d1\u542c\u3002\n\n*/\n\n// \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e8b\u4ef6\u662f\u540c\u6b65\u7684\u3002\u5373\u4e8b\u4ef6\u88abpublish\u540e\u4f1a\u7b49\u5f85Listener\u7684\u5904\u7406\u3002\u5982\u679c\u53d1\u5e03\u4e8b\u4ef6\u5904\u7684\u4e1a\u52a1\u5b58\u5728\u4e8b\u52a1\uff0c\u76d1\u542c\u5668\u5904\u7406\u4e5f\u4f1a\u5728\u76f8\u540c\u7684\u4e8b\u52a1\u4e2d\u3002\u5982\u679c\u9700\u8981\u5f02\u6b65\u5904\u7406\u4e8b\u4ef6\uff0c\u53ef\u4ee5onApplicationEvent\u65b9\u6cd5\u4e0a\u52a0@Aync\u652f\u6301\u5f02\u6b65\u6216\u5728\u6709@EventListener\u7684\u6ce8\u89e3\u65b9\u6cd5\u4e0a\u52a0\u4e0a@Aync\n\npublic class ProductEvent extends ApplicationEvent {\n    public ProductEvent(Product product) {\n        super(product);\n    }\n}\n@Service\npublic class ProductServiceImpl implements IproductService {\n    ...\n    @Autowired\n    private ApplicationEventPublisher publisher;\n    \n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public void saveProduct(Product product) {\n        productMapper.saveProduct(product); \n        //\u4e8b\u4ef6\u53d1\u5e03\n        publisher.publishEvent(product);\n    }\n    ...\n}\n\n@Slf4j\n@AllArgsConstructor\npublic class ProductListener {\n\n    private final NotifyService notifyServcie;\n\n    @Async // \u9700\u8981@EnableAsync\n    @Order\n    @EventListener(ProductEvent.class)\n    public void notify(ProductEvent event) {\n        Product product = (Product) event.getSource();\n        notifyServcie.notify(product, "product");\n    }\n}\n\n// \u7b49\u6548 @eventListner\n@Component\npublic class RegisterListener implements ApplicationListener<UserRegisterEvent>\n{\n    /**\n     * \u5b9e\u73b0\u76d1\u542c\n     * @param userRegisterEvent\n     */\n    @Override\n    public void onApplicationEvent(UserRegisterEvent userRegisterEvent) {\n        //\u83b7\u53d6\u6ce8\u518c\u7528\u6237\u5bf9\u8c61\n        UserBean user = userRegisterEvent.getUser();\n\n        //../\u7701\u7565\u903b\u8f91\n\n        //\u8f93\u51fa\u6ce8\u518c\u7528\u6237\u4fe1\u606f\n        System.out.println("\u6ce8\u518c\u4fe1\u606f\uff0c\u7528\u6237\u540d\uff1a"+user.getName()+"\uff0c\u5bc6\u7801\uff1a"+user.getPassword());\n    }\n}\n\n\n')),(0,i.kt)("h1",{id:"8-\u4f18\u96c5\u505c\u673a-\u5173\u673a"},"8. \u4f18\u96c5\u505c\u673a \u5173\u673a"),(0,i.kt)("p",null,"\uff0c1\u3001\u5229\u7528\u5e95\u5c42JVM Runtime.getRuntime().addShutdownHook() \u6dfb\u52a0\u81ea\u5df1\u7684\u94a9\u5b50\u51fd\u6570\u3002"),(0,i.kt)("p",null,"2\u3001\u5229\u7528Spring \u73b0\u6709\u673a\u5236\uff0cSpring\u4f1a\u5728\u5173\u673a\u65f6\u53d1\u9001ContextClosedEvent\u7ed9\u5230\u76d1\u542c\u5668\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u5173\u95ed\u51fd\u6570\u653e\u5728\u76d1\u542c\u5668\u91cc\u5373\u53ef\u3002"),(0,i.kt)("p",null,"\u4f18\u96c5\u5173\u673a\u7684\u8fc7\u7a0b\u5e94\u8be5\u662f\u901a\u77e5\u6ce8\u518c\u4e2d\u5fc3->\u6682\u505c\u63a5\u6536\u65b0\u8bf7\u6c42->\u65e7\u8bf7\u6c42\u6267\u884c\u5b8c\u6bd5->\u5176\u4f59\u7684\u6e05\u7406\u52a8\u4f5c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// \u8fd9\u91cc\u91c7\u7528\u65b9\u5f0f 2:\n\n// \u76d1\u542c\u5668\nprivate static class GracefulShutdown implements TomcatConnectorCustomizer,\n        ApplicationListener<ContextClosedEvent>, Ordered {\n\n    private static final Logger log = LoggerFactory.getLogger(GracefulShutdown.class);\n\n    private volatile Connector connector;\n\n    /**\n     * \u63a7\u5236GracefulShutdown listener\u4f18\u5148\u7ea7\u662f\u6700\u9ad8\u7684\n     */\n    private int order = Ordered.HIGHEST_PRECEDENCE;\n\n    @Override\n    public void customize(Connector connector) {\n        this.connector = connector;\n    }\n\n     @Override\n    public void onApplicationEvent(ContextClosedEvent event) {\n        logger.info("eureka client shutting down");\n        eurekaClient.shutdown();\n        logger.info("Completed shut down eureka client");\n\n        // Tomcat\u6682\u505c\u63a5\u6536request\n        this.connector.pause();\n        logger.info("connector pause");\n\n        // \u5173\u95edTomcat\u7ebf\u7a0b\u6c60        \n        Executor executor = this.connector.getProtocolHandler().getExecutor();\n        if (executor instanceof ThreadPoolExecutor) {\n            try {\n                ThreadPoolExecutor threadPoolExecutor = (ThreadPoolExecutor) executor;\n                threadPoolExecutor.shutdown();\n                logger.info("connector executor shutting down");\n                if (!threadPoolExecutor.awaitTermination(10, TimeUnit.SECONDS)) {\n                    logger.warn("Tomcat thread pool did not shut down gracefully within "\n                            + "10 seconds. Proceeding with forceful shutdown");\n                }\n                logger.info("completed shut down connector executor");\n            }\n            catch (InterruptedException ex) {\n                Thread.currentThread().interrupt();\n            }\n        }\n    }\n    @Override\n    public int getOrder() {\n        return this.order;\n    }\n\n\n}\n\n\n\n// springboot \u914d\u7f6e\n\n/**\n * \u7528\u4e8e\u4f18\u96c5\u5173\u95edtomcat\n */\n@Bean\npublic GracefulShutdown gracefulShutdown(EurekaClient eurekaClient) {\n    return new GracefulShutdown(eurekaClient);\n}\n\n/**\n * \u7528\u4e8e\u4f18\u96c5\u5173\u95edtomcat\n */\n@Bean\npublic WebServerFactoryCustomizer tomcatCustomizer(GracefulShutdown gracefulShutdown) {\n    return factory -> {\n        if (factory instanceof TomcatServletWebServerFactory) {\n            ((TomcatServletWebServerFactory) factory)\n                    .addConnectorCustomizers(gracefulShutdown);\n        }\n    };\n}\n')),(0,i.kt)("h1",{id:"9-\u9759\u6001\u6ce8\u5165"},"9. \u9759\u6001\u6ce8\u5165"),(0,i.kt)("p",null,"\u4e3a\u9759\u6001\u5c5e\u6027\u6ce8\u5165\u503c, \u4f7f\u7528\u901a\u8fc7 XXXClass.xxx \u4f7f\u7528"),(0,i.kt)("h2",{id:"91-set\u6ce8\u5165"},"9.1. set\u6ce8\u5165"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component(value = "MongoConfig")\n@ConfigurationProperties(prefix = "mongo.config")\npublic class MongoConfig {\n \n private static String chat_username;\n \n @Value("${mongo.config.username}")\n public void setChat_username(String chat_username) {\n MongoConfig.chat_username = chat_username;\n }\n}\n')),(0,i.kt)("h2",{id:"92-postconstruct-\u6ce8\u5165"},"9.2. @PostConstruct \u6ce8\u5165"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@Component\npublic class ADUserUtils {\n \n    @Resource\n    private  ADConfig adc;\n \n    private  static ADConfig adc1;\n \n    @PostConstruct\n    public void init() {\n        this.adc1 = adc;\n    }\n \n    public static List<User> getADUsers() {\n        adc1.readConf();\n} \n")),(0,i.kt)("h2",{id:"93-\u901a\u8fc7-applicationcontext"},"9.3. \u901a\u8fc7 ApplicationContext"),(0,i.kt)("p",null,"\u5f97\u5230\u9759\u6001\u7684 context, \u7136\u540e\u901a\u8fc7 getBean(xxx.class) ..."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@SpringBootApplication\n@MapperScan({"io.github.xiaoyureed.mockitomybatisplusdemo.mapper"})\npublic class MockitoDemoApplication {\n\n    private static ConfigurableApplicationContext context;\n\n    public static void main(String[] args) {\n        context = SpringApplication.run(MockitoDemoApplication.class, args);\n    }\n\n}\n')),(0,i.kt)("h1",{id:"10-\u4f7f\u7528starter"},"10. \u4f7f\u7528starter"),(0,i.kt)("p",null,"servlet request wrapper"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/weixin_43935907/article/details/98476935"},"https://blog.csdn.net/weixin_43935907/article/details/98476935"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/JAYIT/p/10943155.html"},"https://www.cnblogs.com/JAYIT/p/10943155.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/exmyth/p/10332328.html"},"https://www.cnblogs.com/exmyth/p/10332328.html")),(0,i.kt)("h2",{id:"101-\u52a0\u8f7d\u8fc7\u7a0bor\u539f\u7406"},"10.1. \u52a0\u8f7d\u8fc7\u7a0bor\u539f\u7406"),(0,i.kt)("p",null,"@SpringBootApplication\u5305\u542b\u4e86@EnableAutoConfiguration\uff0c\u8fd9\u4e2a\u6ce8\u89e3\u53c8\u5305\u542b@Import(AutoConfigurationImportSelector.class)\u3002"),(0,i.kt)("p",null,'spring boot\u542f\u52a8\u65f6\uff0c\u4f1a\u8c03\u7528AutoConfigurationImportSelector\u7684\u56de\u8c03\u51fd\u6570\uff0c\u8ba9\u5176\u89e3\u6790\u6240\u6709\u5305\u4e0b\u7684"META-INF/spring.factories" (\u4f4d\u4e8e\u9879\u76ee\u7ed3\u6784\u7684 ',(0,i.kt)("inlineCode",{parentName:"p"},"resources/META-INF/spring.factories"),' \u4e0b), \u5e76\u628akey\u4e3a"...EnableAutoConfiguration"\u5bf9\u5e94\u7684value\u91cc\u7684\u7c7b\u90fd\u52a0\u8f7d\u4e3aBean\uff0c\u800c\u90a3\u4e9b\u7c7b\u57fa\u672c\u90fd\u662f\u6ce8\u89e3\u4e86@Configuration\u7684\u914d\u7f6e\u7c7b\u3002\u8fd9\u4fbf\u662fspring boot\u80fd\u81ea\u52a8\u914d\u7f6e\u7684\u539f\u56e0\u3002'),(0,i.kt)("h2",{id:"102-\u81ea\u52a8\u914d\u7f6e\u7c7b\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u6ce8\u89e3"},"10.2. \u81ea\u52a8\u914d\u7f6e\u7c7b\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u6ce8\u89e3"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://my.oschina.net/u/566591/blog/2250290"},"https://my.oschina.net/u/566591/blog/2250290")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'@Configuration  \u8868\u660e\u662f\u4e00\u4e2a\u914d\u7f6e\u7c7b\n@EnableAutoConfiguration(exclude = {DataSourceAutoConfiguration.class}) \u4f7f\u7528starter\u7684\u65f6\u5019\u6392\u9664\u81ea\u52a8\u914d\u7f6e\n\n\n@ConditionalOnClass  \u5f53classpath\u4e0b\u53d1\u73b0\u8be5\u7c7b\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u81ea\u52a8\u914d\u7f6e (name, value \u4efb\u9009\u5176\u4e00)\n@ConditionalOnMissingClass \u6ca1\u6709\u8fd9\u4e2a\u7c7b\u65f6\u5e94\u7528\u6807\u6ce8\u7684\u914d\u7f6e\u7c7b\n\n@ConditionOnMissingBean \u5728spring\u5bb9\u5668\u4e2d\u6ca1\u627e\u5230 bean \u65f6 (\u5982\u679c\u4e0d\u6307\u5b9a, \u9ed8\u8ba4 \u65b9\u6cd5\u8fd4\u56de\u503c\u7c7b\u578b/\u5f53\u524d\u7c7b)\n@ConditionalOnBean  \u5f53\u5bb9\u5668\u4e2d\u6709\u6307\u5b9a\u7684Bean\u7684\u6761\u4ef6\u4e0b\n# \u9ed8\u8ba4\u662f\u68c0\u67e5bean\u7684\u7c7b\u578b, \u770b\u770b\u5bb9\u5668\u4e2d\u662f\u5426\u6709\u540c\u7c7b\u578b bean \u5b58\u5728, \u4e0d\u770b bean name;\n# \u5f00\u542f\u6309\u7167 bean name \u68c0\u67e5: \u5c5e\u6027 name = {xxx"}\n# @ConditionalOnBean(name = {"hah", "hoo"}): "and" \u5173\u7cfb, \u6709 hah, \u4e14\u6709 hoo, return true. \u4efb\u4f55\u4e00\u4e2a\u7f3a\u5931\u90fdreturn false\n# @ConditionalOnMissingBean(name = {"hah", "hoo"}): "and " \u5173\u7cfb, \u6ca1hah \u4e14 \u6ca1 hoo, return true. \u4efb\u4f55\u4e00\u4e2a\u51fa\u73b0, return false\n\n\n@EnableConfigurationProperties(XxxProperties.class)  \u4f7f @ConfigurationProperties(prefix="aaa.bbb") \u6ce8\u89e3\u751f\u6548\n@ConditionalOnProperty:\u6307\u5b9a\u7684\u5c5e\u6027\u6709\u6307\u5b9a\u7684\u503c\u65f6\n# ConditionalOnProperty\n    name/value (value \u7528\u4e8e\u6307\u5b9a\u67d0\u914d\u7f6e\u4e00\u5b9a\u8981\u51fa\u73b0), havingValue \u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u5c5e\u6027, \u4e3a null\u8fd4\u56de false, \u4e0d\u5339\u914d\u8fd4\u56defalse\n    matchIfMissing \u914d\u7f6e\u9879\u5982\u679c\u7f3a\u5931, \u662f\u5426\u5339\u914d, \u9ed8\u8ba4 false\n# \u4f18\u5148\u7ea7\u6bd4 onBean, onClass \u8fd9\u4e9b\u90fd\u9ad8\n@ConditionalOnProperty(prefix = "spring.aop", name = "auto", havingValue = "true", matchIfMissing = true)\n\n\n\n\n@ConditionalOnSingleCandidate: (\u548c @ConditionalOnBean \u7c7b\u4f3c)\u5f53\u6307\u5b9a\u7684Bean\u5728\u5bb9\u5668\u4e2d\u53ea\u6709\u4e00\u4e2a\uff0c\u6216\u8005\u5728\u6709\u591a\u4e2aBean\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u6765\u6307\u5b9a\u9996\u9009\u7684Bean \n@ConditionalOnExpression:\u57fa\u4e8eSpEL\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u5224\u65ad\u6761\u4ef6\n@ConditionalOnResource(resources = {"/xxx.yml"}):\u7c7b\u8def\u5f84\u4e0b\u662f\u5426\u6709\u6307\u5b9a\u7684\u8d44\u6e90\n@ConditionalOnJava(javaversion.eight):\u57fa\u4e8eJVM/Java\u7248\u672c\u4f5c\u4e3a\u5224\u65ad\u6761\u4ef6\n@ConditionalOnJndi:\u5728JNDI\u5b58\u5728\u7684\u6761\u4ef6\u4e0b\u67e5\u627e\u6307\u5b9a\u7684\u4f4d\u7f6e, \u5fc5\u987b\u5b58\u5728\u4e00\u4e2a.\u5426\u5219,\u8fd4\u56de\u4e0d\u5339\u914d\n\n@ConditionalOnNotWebApplication:\u5f53\u524d\u9879\u76ee\u4e0d\u662fWeb\u9879\u76ee\u7684\u6761\u4ef6\u4e0b\n@ConditionalOnWebApplication:\u5f53\u524d\u9879\u76ee\u662fWeb\u9879\u76ee\u7684\u6761\u4ef6\u4e0b\n\n\n@AutoConfigureAfter(A.class) \u914d\u7f6e\u7c7b\u5c06\u5728 A.class \u4e4b\u540e\u52a0\u8f7d\n@AutoConfigureBefore   ... \u4e4b\u524d\u52a0\u8f7d\n@AutoConfigureOrder\n\n')),(0,i.kt)("h2",{id:"103-\u81ea\u52a8\u914d\u7f6e\u7c7b\u7684\u5b9e\u4f8b"},"10.3. \u81ea\u52a8\u914d\u7f6e\u7c7b\u7684\u5b9e\u4f8b"),(0,i.kt)("h3",{id:"1031-spring-\u52a8\u6001\u4ee3\u7406"},"10.3.1. spring \u52a8\u6001\u4ee3\u7406"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://lolico.me/2020/05/03/SpringBoot2-AOP-uses-cglib-proxy-by-default/"},"https://lolico.me/2020/05/03/SpringBoot2-AOP-uses-cglib-proxy-by-default/")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'//SpringBoot1.5.x\u4e2d\u7684\u8fd9\u4e2a\u81ea\u52a8\u914d\u7f6e\u7c7b\u4f1a\u53d1\u73b0\u9ed8\u8ba4\u662f\u4f7f\u7528jdk\u52a8\u6001\u4ee3\u7406\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u5728SpringBoot2.x\u4e2d\u6539\u4e3a\u9ed8\u8ba4\u4f7f\u7528Cglib\u4e86\n@Configuration(proxyBeanMethods = false)\n@ConditionalOnProperty(prefix = "spring.aop", name = "auto", havingValue = "true", matchIfMissing = true)\npublic class AopAutoConfiguration {\n\n    @Configuration(proxyBeanMethods = false)\n    @ConditionalOnClass(Advice.class)\n    static class AspectJAutoProxyingConfiguration {\n\n        @Configuration(proxyBeanMethods = false)\n        @EnableAspectJAutoProxy(proxyTargetClass = false)\n        @ConditionalOnProperty(prefix = "spring.aop", name = "proxy-target-class", havingValue = "false",\n                matchIfMissing = false)\n        static class jdkDynamicAutoProxyConfiguration {\n\n        }\n\n        @Configuration(proxyBeanMethods = false)\n        @EnableAspectJAutoProxy(proxyTargetClass = true)\n        @ConditionalOnProperty(prefix = "spring.aop", name = "proxy-target-class", havingValue = "true",\n                matchIfMissing = true) // \u80fd\u591f\u770b\u51faAOP\u9ed8\u8ba4\u4f7f\u7528Cglib\u4ee3\u7406\n        static class CglibAutoProxyConfiguration {\n\n        }\n\n    }\n    // ...\n}\n')),(0,i.kt)("h2",{id:"104-conditional"},"10.4. @Conditional"),(0,i.kt)("p",null,"\u81ea\u52a8\u914d\u7f6e\u76f8\u5173\u6ce8\u89e3\u5e95\u5c42\u90fd\u662f\u901a\u8fc7 @Conditional(OnClassCondition.class) \u5b9e\u73b0\u7684"),(0,i.kt)("p",null,"\u901a\u8fc7\u5b83, \u53ef\u4ee5\u81ea\u5df1\u5b9a\u5236\u6761\u4ef6"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://my.oschina.net/u/566591/blog/2250290"},"https://my.oschina.net/u/566591/blog/2250290")),(0,i.kt)("h2",{id:"105-\u5c01\u88c5\u7ec4\u5408\u6761\u4ef6"},"10.5. \u5c01\u88c5\u7ec4\u5408\u6761\u4ef6"),(0,i.kt)("p",null,"\u7ee7\u627f AllNestedConditions \u5c01\u88c5\u591a\u6761\u4ef6 (and \u5173\u7cfb)"),(0,i.kt)("p",null,"AnyNestedCondition (or \u5173\u7cfb)"),(0,i.kt)("p",null,"NoneNestedConditions (none \u5173\u7cfb)"),(0,i.kt)("h2",{id:"106-\u521b\u5efa\u81ea\u5df1\u7684-starter"},"10.6. \u521b\u5efa\u81ea\u5df1\u7684 starter"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#boot-features-custom-starter"},"\u5b98\u65b9\u6587\u6863")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/SpringForAll/spring-boot-starter-swagger"},"spring-boot-swagger \u793a\u4f8b")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2astarter \u9879\u76ee"),(0,i.kt)("p",{parentName:"li"},'  \u547d\u540d\u89c4\u5219: spring boot \u5b98\u65b9 starter \u547d\u540d\u4e3a "spring-boot-starter-xxx", \u81ea\u5b9a\u4e49\u7684starter \u547d\u540d "xxx-spring-boot-starter";'),(0,i.kt)("p",{parentName:"li"},"  \u5f15\u5165 ",(0,i.kt)("inlineCode",{parentName:"p"},"spring-boot-configuration-processor")," (\u7f16\u8bd1\u65f6\u751f\u6210 spring-configuration-metadata.json \uff0c\u5728IDE\u4e2d\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\u65f6\uff0c\u4f1a\u51fa\u73b0\u63d0\u793a), \u6807\u6ce8\u4e3a optional: true \u907f\u514d\u4f9d\u8d56\u4f20\u9012"),(0,i.kt)("p",{parentName:"li"},"  \u5f15\u5165 ",(0,i.kt)("inlineCode",{parentName:"p"},"spring boot starter")," (\u76f8\u5173\u6ce8\u89e3\u9700\u8981), \u6807\u6ce8\u4e3a optional true,  idea \u4e2d spring boot app \u521b\u5efa\u65f6\u81ea\u52a8\u5bfc\u5165\u4e86"),(0,i.kt)("p",{parentName:"li"},"  \u7ee7\u627f ",(0,i.kt)("inlineCode",{parentName:"p"},"spring-boot-starter-parent"),", ",(0,i.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/21317006/spring-boot-parent-pom-when-you-already-have-a-parent-pom/21318359#21318359"},"\u5982\u679c\u60f3\u4e0d\u901a\u8fc7\u7ee7\u627f\u65b9\u5f0f\u4f7f\u7528, \u53ef\u4ee5 dependencyManagement ",(0,i.kt)("inlineCode",{parentName:"a"},"spring boot dependencies"),", \u53c2\u8003")),(0,i.kt)("p",{parentName:"li"},"  \u5982\u679c\u662f\u751f\u6210\u7684 spring boot \u9879\u76ee, \u5220\u9664 \u542f\u52a8\u7c7b, \u7136\u540e\u66ff\u6362 spring boot maven \u63d2\u4ef6 \u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"maven-compile-plugin")," (\u56e0\u4e3a\u6ca1\u6709\u542f\u52a8\u7c7b, repackage \u4f1a\u62a5\u9519), \u8bbe\u7f6e properties \u4e0b maven.compiler.source, maven.compiler.target, java.version")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2a @ConfigurationProperties \u7c7b\u7528\u4e8e\u4fdd\u5b58\u4f60\u7684\u914d\u7f6e\u4fe1\u606f, \u5728 @EnableConfigurationProperties(...) \u7c7b\u4e0a\u6307\u5b9a, (\u6216\u8005\u6807\u6ce8 component \u7136\u540e\u914d\u7f6ecomponentScan \u6216\u8005\u76f4\u63a5 @configurationPropertiesScan)"),(0,i.kt)("p",{parentName:"li"},"  \uff08\u5982\u679c\u4f60\u7684\u9879\u76ee\u4e0d\u4f7f\u7528\u914d\u7f6e\u4fe1\u606f\u5219\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u6b65\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u60c5\u51b5\u975e\u5e38\u5c11\u89c1\uff09")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2aAutoConfiguration\uff0c\u5f15\u7528\u5b9a\u4e49\u597d\u7684\u914d\u7f6e\u4fe1\u606f\uff1b\u5728AutoConfiguration\u4e2d\u5b9e\u73b0\u6240\u6709starter\u5e94\u8be5\u5b8c\u6210\u7684\u64cd\u4f5c\uff0c\u5e76\u4e14\u628a\u8fd9\u4e2a\u7c7b\u52a0\u5165classpath:/META-INF/spring.factories\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u58f0\u660e"),(0,i.kt)("p",{parentName:"li"},"  \u81ea\u52a8\u914d\u7f6e\u7c7b\u4e0d\u5e94\u542f\u7528\u7ec4\u4ef6\u626b\u63cf\u4ee5\u67e5\u627e\u5176\u4ed6\u7ec4\u4ef6 (\u5373 \u82e5\u751f\u6210\u7684\u662fspring boot \u9aa8\u67b6, \u5e94\u53bb\u6389\u542f\u52a8\u7c7b)\u3002\u5e94\u8be5\u4f7f\u7528 @import \u6765\u5bfc\u5165\u5176\u4ed6\u914d\u7f6e\u7c7b")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6253\u5305\u53d1\u5e03"),(0,i.kt)("p",{parentName:"li"},"  \u5982\u679c starter \u5c31\u662f\u672c\u5730\u81ea\u5df1\u4f7f\u7528, \u53ef\u4ee5\u4e0d\u6253\u5305\u4e0d\u53d1\u5e03, \u76f4\u63a5\u5728\u53e6\u5916\u7684\u9879\u76ee\u4e2d\u5f15\u5165"))),(0,i.kt)("p",null,"spring.factories \u793a\u4f8b:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"org.springframework.boot.autoconfigure.EnableAutoConfiguration = \\\ncom.mycorp.libx.autoconfigure.LibXAutoConfiguration,\\\ncom.mycorp.libx.autoconfigure.LibXWebAutoConfiguration\n")),(0,i.kt)("h2",{id:"107-\u53cd\u722c\u866b-starter"},"10.7. \u53cd\u722c\u866b starter"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/zouhao/p/12175653.html"},"https://www.cnblogs.com/zouhao/p/12175653.html")," "),(0,i.kt)("p",null,"TODO"),(0,i.kt)("h1",{id:"11-\u76d1\u63a7-and-\u5b89\u5168"},"11. \u76d1\u63a7 and \u5b89\u5168"),(0,i.kt)("p",null,"\u5bc6\u7801\u52a0\u5bc6 Argon2"),(0,i.kt)("p",null,"Spring Vault\uff0c\u5b83\u4e3aHashiCorp Vault\u6dfb\u52a0\u62bd\u8c61 -> \u5bc6\u7801\u5b58\u50a8"),(0,i.kt)("p",null,"OWASP ZAP \u6e17\u900f\u6d4b\u8bd5\u62a5\u544a"),(0,i.kt)("h2",{id:"111-spring-boot-actuator-\u76d1\u63a7"},"11.1. spring-boot-actuator \u76d1\u63a7"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/zwqh/p/11851300.html"},"https://www.cnblogs.com/zwqh/p/11851300.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/8bfac9289c7e"},"https://www.jianshu.com/p/8bfac9289c7e")),(0,i.kt)("p",null,"spring boot \u7684 sub project, \u63d0\u4f9b\u4ea7\u54c1\u7ea7\u522b\u7684\u76d1\u63a7"),(0,i.kt)("p",null,"spring cloud \u4e2d, refresh \u7684 post \u7aef\u70b9\u88ab actuator \u63a5\u7ba1, \u914d\u7f6e ",(0,i.kt)("inlineCode",{parentName:"p"},"management.endpoints.web.exposure.include=health,info")," (\u9ed8\u8ba4) \u9700\u8981\u6dfb\u52a0 'refresh', \u6700\u7ec8\u9700\u8981 ",(0,i.kt)("inlineCode",{parentName:"p"},"curl -d{} http://xxx:xxx/actuator/refresh")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/Netflix/Hystrix/issues/1566"},"hystrix.stream \u4e5f\u88ab\u63a5\u7ba1"),", \u914d\u7f6e\u6dfb\u52a0 'hystrix.stream', \u76d1\u63a7\u6d41\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"http://xxx:xxx/actuator/hystrix.stream")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/d5943e303a1f"},"actuator \u7ffb\u8bd1"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/html/production-ready-features.html#production-ready"},"actuator \u5b98\u65b9\u6587\u6863")),(0,i.kt)("p",null,"\u81ea\u5df1\u5199\u76d1\u63a7, \u53ef\u4ee5:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"ConfigurableApplicationContext context = SpringApplication.run(PaymentServiceApp.class, args);\n        ConfigurableEnvironment        env     = context.getEnvironment();\n\n// \u6216\u8005 \u76f4\u63a5 @autowired Environment env\n")),(0,i.kt)("p",null,"ui\u5c55\u793a: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/codecentric/spring-boot-admin"},"https://github.com/codecentric/spring-boot-admin")),(0,i.kt)("h2",{id:"112-spring-boot-admin-\u76d1\u63a7\u754c\u9762"},"11.2. spring boot admin \u76d1\u63a7\u754c\u9762"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/483adafc6b3a"},"https://www.jianshu.com/p/483adafc6b3a")," //todo"),(0,i.kt)("h2",{id:"113-spring-boot-starter-security"},"11.3. spring-boot-starter-security"),(0,i.kt)("h3",{id:"1131-security\u7ec4\u4ef6\u4ecb\u7ecd"},"11.3.1. security\u7ec4\u4ef6\u4ecb\u7ecd"),(0,i.kt)("p",null,"[ref]","](",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/demingblog/p/10874753.html"},"https://www.cnblogs.com/demingblog/p/10874753.html"),")"),(0,i.kt)("p",null,"spring security \u662f\u5b89\u5168\u8ba4\u8bc1\u6846\u67b6, \u57fa\u4e8e Servlet filter, \u6838\u5fc3\u5c31\u662f\u4e00\u7ec4\u8fc7\u6ee4\u5668\u94fe; \u53ef\u5728 Web \u8bf7\u6c42\u7ea7\u548c\u65b9\u6cd5\u8c03\u7528\u7ea7\u5904\u7406\u8eab\u4efd\u786e\u8ba4\u548c\u6388\u6743 "),(0,i.kt)("p",null,"\u5982\u679c\u662f \u666e\u901a\u7684 spring \u9879\u76ee, \u4f7f\u7528 shiro \u66f4\u7b80\u5355"),(0,i.kt)("p",null,"================================= \u6838\u5fc3\u7ec4\u4ef6"),(0,i.kt)("p",null,"SecurityContext - \u7528\u6237 auth \u901a\u8fc7\u540e, authentication \u4fe1\u606f\u5b58\u50a8\u5728\u8fd9\u91cc, \u53ef\u4ee5\u5728\u4efb\u610f\u5730\u65b9\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"SecurityContextHolder.getContext().set/getAuthentication")),(0,i.kt)("p",null,"SecurityContextHolder - \u5728\u4efb\u610f\u5730\u65b9\u53ef\u4ee5\u83b7\u53d6 SecurityContext "),(0,i.kt)("p",null,"Authentication - \u8ba4\u8bc1\u4fe1\u606f\u5bf9\u8c61, \u8868\u793a\u8ba4\u8bc1\u540e\u7684\u7528\u6237"),(0,i.kt)("p",null,"UserDetails - \u8ba4\u8bc1\u7528\u6237\u7684\u8be6\u7ec6\u4fe1\u606f"),(0,i.kt)("p",null,"UserDetailsService - \u53ef\u4ee5\u7528\u6765\u83b7\u53d6UserDetails\u3002\u6211\u4eec\u4f1a\u81ea\u5b9a\u4e49\u4e00\u4e2aCustomUserDetailsService\u6765\u5b9e\u73b0UserDetailsService\u63a5\u53e3, \u901a\u8fc7 username \u67e5\u8be2\u5230 userDetails, \u5982\u679c\u6ca1\u67e5\u5230 , ",(0,i.kt)("inlineCode",{parentName:"p"},"UsernameNotFoundException")),(0,i.kt)("p",null,"AuthenticationManager - \u4f5c\u7528\u5c31\u662f\u6821\u9a8cAuthentication, \u6821\u9a8c\u5931\u8d25\u629b\u51fa ",(0,i.kt)("inlineCode",{parentName:"p"},"BadCredentialsException")),(0,i.kt)("h3",{id:"1132-\u57fa\u672c\u4f7f\u7528-\u548c-\u914d\u7f6e\u7528\u6237\u540d\u5bc6\u7801"},"11.3.2. \u57fa\u672c\u4f7f\u7528 \u548c \u914d\u7f6e\u7528\u6237\u540d\u5bc6\u7801"),(0,i.kt)("p",null,"\u914d\u5408 starter  (spring-boot-starter-security), \u53ef\u4ee5\u96f6\u914d\u7f6e\u4f7f\u7528. \u5f15\u5165\u540e\u4f9d\u8d56"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-security</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.security</groupId>\n            <artifactId>spring-security-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n    </dependencies>\n\n")),(0,i.kt)("p",null,"\u5982\u4e0b\u914d\u7f6e\u5373\u53ef"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 8000\nspring:\n  application:\n    name: spring-security-demo\n\n  security:\n    user:\n      # \u5982\u679c\u4e0d\u914d\u7f6e, \u9ed8\u8ba4\u4e3a user/\u63a7\u5236\u53f0\u65e5\u5fd7\u4e2d\u770b\u5230\u9ed8\u8ba4\u5bc6\u7801\n    #   \u524d\u7aef\u8c03\u7528, \u9700\u8981 basic auth \u8ba4\u8bc1\n      name: root\n      password: root\n")),(0,i.kt)("p",null,"\u652f\u6301\u4e24\u79cd\u9a8c\u8bc1\u65b9\u5f0f:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u901a\u8fc7 form \u8868\u5355\u6765\u8ba4\u8bc1 (\u9ed8\u8ba4)"),(0,i.kt)("p",{parentName:"li"},"  \u9002\u5408\u9875\u9762\u9a8c\u8bc1")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u901a\u8fc7 HttpBasic \u6765\u8ba4\u8bc1 (basic auth)"),(0,i.kt)("p",{parentName:"li"},"  \u9002\u5408 api \u63a5\u53e3\u7684\u9a8c\u8bc1, \u5f53\u7136\u4e5f\u9002\u5408\u9875\u9762"))),(0,i.kt)("p",null,"\u7528\u6237\u540d\u5bc6\u7801\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n    @Bean\n    @Override\n    public UserDetailsService userDetailsService() {\n        UserDetails user =\n             User.withDefaultPasswordEncoder()\n                .username("user")\n                .password("password")\n                .roles("USER")\n                .build();\n\n        return new InMemoryUserDetailsManager(user);\n    }\n}\n')),(0,i.kt)("h3",{id:"1133-\u7981\u7528\u57fa\u672c\u8ba4\u8bc1"},"11.3.3. \u7981\u7528\u57fa\u672c\u8ba4\u8bc1"),(0,i.kt)("p",null,"\u5982\u679c\u65e2\u60f3\u4f7f\u7528security\u53c8\u4e0d\u60f3\u6bcf\u6b21\u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728Application\u6587\u4ef6\u4e2d\u7981\u7528\u81ea\u52a8\u914d\u7f6e (\u65b9\u6cd5 1)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@EnableAutoConfiguration(exclude = {\n    org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration.class\n})\n\n")),(0,i.kt)("p",null,"\u6216\u8005 \u5728\u4ee3\u7801\u4e2d\u914d\u7f6e (\u65b9\u6cd5 2)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n    /**\n    \u662f\u56e0\u4e3a\u8986\u76d6\u4e86\u7236\u7c7b\u65b9\u6cd5, \u7236\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5185\u5bb9\u5982\u4e0b:\n        http.authorizeRequests((requests) -> requests.anyRequest().authenticated()); // \u6240\u6709 \u8bf7\u6c42\u90fd\u9700\u8981\u8ba4\u8bc1\n        http.formLogin(); // \u652f\u6301\u8868\u5355\u8ba4\u8bc1\n        http.httpBasic(); // \u652f\u6301 basic auth \u8ba4\u8bc1\n\n    */\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        // \u8fd9\u91cc\u4e3a\u7a7a, \u8868\u793a\u65e0\u9700 \u4efb\u4f55\u8ba4\u8bc1\n//        super.configure(http);\n    }\n}\n")),(0,i.kt)("h3",{id:"1134-\u914d\u7f6e\u4e2d-websecurity-\u548c-httpsecurity-\u533a\u522b"},"11.3.4. \u914d\u7f6e\u4e2d WebSecurity \u548c HttpSecurity \u533a\u522b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n// \u5f71\u54cd\u5168\u5c40\u5b89\u5168\u6027\u7684\u914d\u7f6e\uff08\u5ffd\u7565\u8d44\u6e90\uff0c\u8bbe\u7f6e\u8c03\u8bd5\u6a21\u5f0f\uff0c\u901a\u8fc7\u5b9e\u73b0\u81ea\u5b9a\u4e49\u9632\u706b\u5899\u5b9a\u4e49\u62d2\u7edd\u8bf7\u6c42\uff09\n@Override\npublic void configure(WebSecurity web) throws Exception {\n    web\n        .ignoring()\n        .antMatchers("/resources/**") // \u5ffd\u7565\n        .antMatchers("/publics/**"); // \u5ffd\u7565\n}\n\n//\u8d44\u6e90\u7ea7\u522b \u914d\u7f6e\u57fa\u4e8eWeb\u7684\u5b89\u5168\u6027, \u7c92\u5ea6\u66f4\u7ec6\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n    http\n        .authorizeRequests()\n        .antMatchers("/", "/home").permitAll()\n        .antMatchers("/admin/**").hasRole("ADMIN")\n        .antMatchers("/publics/**").hasRole("USER") // no effect, \u56e0\u4e3a  WebSecurity \u4e2d\u914d\u7f6e\u4e86 \u5ffd\u7565 publics/** \u4e0b\u7684\u9a8c\u8bc1\n        .anyRequest().authenticated()\n        .and()\n        .formLogin().loginPage("/login").permitAll()\n        .and()\n        .logout().permitAll();\n}\n\n')),(0,i.kt)("p",null,"================================ \u5b9e\u73b0\u65b9\u6cd5\u7ea7\u522b\u7684\u6743\u9650\u63a7\u5236"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"@EnableGlobalMethodSecurity(prePostEnabled =true)")," \u4f7f\u7528\u8868\u8fbe\u5f0f\u5b9e\u73b0\u65b9\u6cd5\u7ea7\u522b\u7684\u5b89\u5168\u6027   ,  4\u4e2a\u6ce8\u89e3\u53ef\u7528"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@PreAuthorize \u5728\u65b9\u6cd5\u8c03\u7528\u4e4b\u524d,\u57fa\u4e8e\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\u6765\u9650\u5236\u5bf9\u65b9\u6cd5\u7684\u8bbf\u95ee")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@PostAuthorize \u5141\u8bb8\u65b9\u6cd5\u8c03\u7528,\u4f46\u662f\u5982\u679c\u8868\u8fbe\u5f0f\u8ba1\u7b97\u7ed3\u679c\u4e3afalse,\u5c06\u629b\u51fa\u4e00\u4e2a\u5b89\u5168\u6027\u5f02\u5e38")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@PostFilter \u5141\u8bb8\u65b9\u6cd5\u8c03\u7528,\u4f46\u5fc5\u987b\u6309\u7167\u8868\u8fbe\u5f0f\u6765\u8fc7\u6ee4\u65b9\u6cd5\u7684\u7ed3\u679c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@PreFilter \u5141\u8bb8\u65b9\u6cd5\u8c03\u7528,\u4f46\u5fc5\u987b\u5728\u8fdb\u5165\u65b9\u6cd5\u4e4b\u524d\u8fc7\u6ee4\u8f93\u5165\u503c"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'//\u8868\u793a\u5982\u679c\u7528\u6237\u5177\u6709admin\u89d2\u8272\uff0c\u5c31\u80fd\u8bbf\u95eelistAllUsers\u65b9\u6cd5\uff0c\u5982\u679c\u65b9\u6cd5\u524d\u4e0d\u52a0@preAuthorize\u6ce8\u89e3\uff0c\u610f\u5473\u7740\u6240\u6709\u7528\u6237\u90fd\u80fd\u8bbf\u95eelistAllUsers\n@PreAuthorize("hasRole(\u2018admin\u2018)")\n@RequestMapping(value = "/user/", method = RequestMethod.GET)\n@ResponseBody\npublicList listAllUsers() {\n\n    \u2026\u2026\n\n}\n')),(0,i.kt)("p",null,"\u6b64\u5916\u8fd8\u6709 :"),(0,i.kt)("p",null,"@EnableGlobalMethodSecurity(securedEnabled=true) \u5f00\u542f@Secured \u6ce8\u89e3\u8fc7\u6ee4\u6743\u9650"),(0,i.kt)("p",null,"@EnableGlobalMethodSecurity(jsr250Enabled=true)\u5f00\u542f@RolesAllowed \u6ce8\u89e3\u8fc7\u6ee4\u6743\u9650"),(0,i.kt)("h3",{id:"1135-\u914d\u7f6e\u8de8\u57df"},"11.3.5. \u914d\u7f6e\u8de8\u57df"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://lolico.me/2020/04/26/Spring-Security-CORS/"},"https://lolico.me/2020/04/26/Spring-Security-CORS/"),"\nTODO"),(0,i.kt)("h2",{id:"114-oauth2"},"11.4. oauth2"),(0,i.kt)("p",null,"spring security oauth2"),(0,i.kt)("p",null,"check outline-about-authentication-oauth2.md"),(0,i.kt)("h1",{id:"12-\u65e5\u5fd7"},"12. \u65e5\u5fd7"),(0,i.kt)("h2",{id:"121-log4j2-marker-\u5199\u5165\u5230\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6"},"12.1. Log4j2-Marker \u5199\u5165\u5230\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/1ff824bc997a?utm_campaign"},"https://www.jianshu.com/p/1ff824bc997a?utm_campaign")),(0,i.kt)("h2",{id:"122-logback"},"12.2. logback"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n\n    \x3c!--\u5e94\u7528\u540d\u79f0--\x3e\n    <property name="APPLICATION_NAME" value="roncoo-pay-app-notify"/>\n    \x3c!-- \u6587\u4ef6\u8f93\u51fa\u683c\u5f0f --\x3e\n    <property name="PATTERN" value="%-12(%d{yyyy-MM-dd HH:mm:ss.SSS}) |-%-5level [%thread] %c [%L] -| %msg%n"/>\n    \x3c!-- \u6587\u4ef6\u8def\u5f84 --\x3e\n    <property name="FILE_PATH" value="/home/roncoo/opensource/pay/logs"/>\n\n\n    \x3c!-- \u63a7\u5236\u53f0 --\x3e\n    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">\n        <encoder>\n            <pattern>${PATTERN}</pattern>\n        </encoder>\n    </appender>\n\n    \x3c!--\u65e5\u5fd7\u6587\u4ef6\u7b56\u7565--\x3e\n    <appender name="LOGGER_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">\n        <file>${FILE_PATH}/${APPLICATION_NAME}/${APPLICATION_NAME}.log</file>\n        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n            <fileNamePattern>${FILE_PATH}/${APPLICATION_NAME}/${APPLICATION_NAME}.%d{yyyy-MM-dd}.log\n            </fileNamePattern>\n            <MaxHistory>100</MaxHistory>\n        </rollingPolicy>\n        <layout class="ch.qos.logback.classic.PatternLayout">\n            <pattern>${PATTERN}</pattern>\n        </layout>\n    </appender>\n\n    <logger name="com.roncoo.pay" level="debug"/>\n\n    \x3c!-- LOG "com.baeldung*" at TRACE level --\x3e\n    <logger name="com.baeldung" level="trace" additivity="false">\n        <appender-ref ref="RollingFile" />\n        <appender-ref ref="Console" />\n    </logger>\n\n    \x3c!-- \u6240\u6709\u65e5\u5fd7\u90fd\u6253\u5370 info \u7ea7\u522b --\x3e\n    <root level="info">\n        <appender-ref ref="CONSOLE"/>\n        <appender-ref ref="LOGGER_FILE"/>\n    </root>\n\n</configuration>\n\n\n')),(0,i.kt)("h1",{id:"13-\u6570\u636e\u5c42"},"13. \u6570\u636e\u5c42"),(0,i.kt)("h2",{id:"131-canal-\u8ba2\u9605"},"13.1. canal \u8ba2\u9605"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/zendesk/maxwell"},"https://github.com/zendesk/maxwell")," \u7c7b\u4f3c"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/alibaba/otter"},"https://github.com/alibaba/otter")),(0,i.kt)("h2",{id:"132-mybatis-\u81ea\u52a8\u5efa\u8868\u63d2\u4ef6"},"13.2. mybatis \u81ea\u52a8\u5efa\u8868\u63d2\u4ef6"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/zyf970617/mybatis-auto-create-table"},"https://github.com/zyf970617/mybatis-auto-create-table")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/yuru974882032/article/details/106749299"},"https://blog.csdn.net/yuru974882032/article/details/106749299")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://gitee.com/sunchenbin/mybatis-enhance"},"https://gitee.com/sunchenbin/mybatis-enhance")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://gitee.com/baomidou/mybatis-mate-examples?_from=gitee_search"},"https://gitee.com/baomidou/mybatis-mate-examples?_from=gitee_search")),(0,i.kt)("h2",{id:"133-mybatis-crud-\u589e\u5f3a\u63d2\u4ef6"},"13.3. mybatis crud \u589e\u5f3a\u63d2\u4ef6"),(0,i.kt)("p",null,"mybatis plus"),(0,i.kt)("p",null,"tk.mybatis"),(0,i.kt)("h2",{id:"134-\u6570\u636e\u5e93\u8fc1\u79fb\u7248\u672c\u63a7\u5236"},"13.4. \u6570\u636e\u5e93\u8fc1\u79fb\u7248\u672c\u63a7\u5236"),(0,i.kt)("p",null,"\u4e24\u8005\u5dee\u522b\u4e0d\u5927\uff0c\u56e0\u529f\u80fd\u591a\uff0c\u4e2a\u4eba\u201c\u7a0d\u5fae\u201d\u503e\u5411 Liquibase; \u4e00\u822c\u6211\u7684\u503e\u5411\u662f\u5c0f\u9879\u76ee\uff0c\u6574\u4f53\u53d8\u52a8\u4e0d\u5927\u7684\u7528Flyway\uff0c\u800c\u5927\u5e94\u7528\u548c\u4f01\u4e1a\u5e94\u7528\u7528Liquibase\u66f4\u5408\u9002"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/bytebase/bytebase"},"https://github.com/bytebase/bytebase")," \u65b0\u7684\u66f4\u4e3a\u5168\u9762\u7684\u6570\u636e\u5e93 schema \u7ba1\u7406\u5de5\u5177"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("a",{parentName:"p",href:"https://fastzhong.com/posts/db-migration/"},"https://fastzhong.com/posts/db-migration/"))),(0,i.kt)("h3",{id:"1341-liquibase"},"13.4.1. liquibase"),(0,i.kt)("h3",{id:"1342-flyway"},"13.4.2. Flyway"),(0,i.kt)("h2",{id:"135-\u6570\u636e\u5e93-url-\u548c\u9a71\u52a8"},"13.5. \u6570\u636e\u5e93 url \u548c\u9a71\u52a8"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"MySQL\njdbc:mysql://122.191.199.51:60000/js_phaseii_db?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai\njdbc:mysql://localhost:3306/ry-cloud?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8\ncom.mysql.cj.jdbc.Driver\n\noracle:\n1.\u4f7f\u7528service_name,\u914d\u7f6e\u65b9\u5f0f: jdbc:oracle:thin:@//:1521/helowin\n2.\u4f7f\u7528SID\uff0c\u914d\u7f6e\u65b9\u5f0f\uff1a         jdbc:oracle:thin:@//:1521/helowin\n3.\u4f7f\u7528SID\uff0c\u914d\u7f6e\u65b9\u5f0f\uff1a         jdbc:oracle:thin:@:1521:helowin\n")),(0,i.kt)("h2",{id:"136-graphql\u96c6\u6210"},"13.6. graphql\u96c6\u6210"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.awaimai.com/2876.html"},"https://www.awaimai.com/2876.html")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://juejin.cn/post/6982083422567006245"},"https://juejin.cn/post/6982083422567006245")," \u5165\u95e8\n",(0,i.kt)("a",{parentName:"p",href:"https://graphql.cn/learn/queries/"},"https://graphql.cn/learn/queries/")," \u5b98\u7f51\u6587\u6863"),(0,i.kt)("h2",{id:"137-\u542f\u52a8\u6267\u884c-sql"},"13.7. \u542f\u52a8\u6267\u884c SQL"),(0,i.kt)("h3",{id:"1371-sql-\u5206\u9694\u7b26\u7684\u5751"},"13.7.1. SQL \u5206\u9694\u7b26\u7684\u5751"),(0,i.kt)("p",null,"\u9ed8\u8ba4\u5206\u9694\u7b26\u662f \u5206\u53f7, \u82e5SQL \u4e2d\u6709\u6267\u884c\u8fc7\u7a0b/\u51fd\u6570, \u9700\u8981 ",(0,i.kt)("inlineCode",{parentName:"p"},"spring.datasource.separator=|")," "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"drop function if exists `getChildrenProductName`;|\ncreate function `getChildrenProductName`(orgid varchar(50))\nreturns varchar(4000)\nBEGIN\nDECLARE `oTemp` VARCHAR(4000);\nDECLARE `oTempChild` VARCHAR(4000);\nDECLARE `oTempName` VARCHAR(4000);\nDECLARE `oTempChildName` VARCHAR(4000);\nDECLARE i int;\nSET oTemp = CAST(orgid AS CHAR);\nSET oTempChild = CAST(orgid AS CHAR);\nset oTempName = '$';\nset oTempChildName = '';\nset i = 0;\nWHILE oTempChild IS NOT NULL\nDO\nif i>0 then\nset oTempName = concat(oTempName,\",\",oTempChildName);\nend if;\nSET oTemp = CONCAT(oTemp,',',oTempChild);\nset i = i +1;\nSELECT GROUP_CONCAT(p.product_name,p.partnum) into oTempChildName FROM product p\nleft join bom b on b.PartID = p.PartID\n WHERE FIND_IN_SET(b.ParentPartID,oTempChild) > 0;\nSELECT GROUP_CONCAT(p.PartID) INTO oTempChild FROM product p\nleft join bom b on b.PartID = p.PartID\n WHERE FIND_IN_SET(b.ParentPartID,oTempChild) > 0;\nEND WHILE;\nRETURN oTempName;\nEND;|\n")),(0,i.kt)("h3",{id:"1372-spring-datasource-\u81ea\u5e26"},"13.7.2. spring datasource \u81ea\u5e26"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"spring:\n  datasource:\n#   \u6570\u636e\u6e90\u57fa\u672c\u914d\u7f6e\n    username: root\n    password: 123\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    url: jdbc:mysql://localhost:3306/mybatis?useUnicode=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC\n    type: com.alibaba.druid.pool.DruidDataSource\n#   \u6570\u636e\u6e90\u5176\u4ed6\u914d\u7f6e\n    initialSize: 5\n    minIdle: 5\n    maxActive: 20\n    maxWait: 60000\n    timeBetweenEvictionRunsMillis: 60000\n    minEvictableIdleTimeMillis: 300000\n    validationQuery: SELECT 1 FROM DUAL\n    testWhileIdle: true\n    testOnBorrow: false\n    testOnReturn: false\n    poolPreparedStatements: true\n#   \u914d\u7f6e\u76d1\u63a7\u7edf\u8ba1\u62e6\u622a\u7684filters\uff0c\u53bb\u6389\u540e\u76d1\u63a7\u754c\u9762sql\u65e0\u6cd5\u7edf\u8ba1\uff0c'wall'\u7528\u4e8e\u9632\u706b\u5899\n    filters: stat,wall,log4j\n    maxPoolPreparedStatementPerConnectionSize: 20\n    useGlobalDataSourceStat: true\n    connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500\n    schema:\n        - classpath:sql/department.sql\n        - classpath:sql/employee.sql\n    initialization-mode: ALWAYS\n\n")),(0,i.kt)("h3",{id:"1373-\u4f7f\u7528-jpa"},"13.7.3. \u4f7f\u7528 jpa"),(0,i.kt)("h4",{id:"13731-springboot-\u63a5\u5165-jpa"},"13.7.3.1. springboot \u63a5\u5165 jpa"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/AnghelLeonard/Hibernate-SpringBoot"},"https://github.com/AnghelLeonard/Hibernate-SpringBoot")," github demos"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/tomoyane/springboot-bestpractice"},"https://github.com/tomoyane/springboot-bestpractice")," working with spring security"),(0,i.kt)("p",null,"1\u3001SpringBoot\u6839\u636e\u811a\u672c\u521d\u59cb\u5316"),(0,i.kt)("p",null,"\u7ed3\u6784\u521d\u59cb\u5316\u811a\u672c\u6587\u4ef6\u7531spring.datasource.schema\u5c5e\u6027\u6307\u5b9a\uff0c\u6570\u636e\u521d\u59cb\u5316\u811a\u672c\u7531\u6587\u4ef6spring.datasource.data\u5c5e\u6027\u6307\u5b9a\u3002"),(0,i.kt)("p",null,"\u8fd9\u4e24\u4e2a\u811a\u672c\u662f\u5426\u6267\u884c\u7684\u5f00\u5173\u7531spring.datasource.initialization-mode\u51b3\u5b9a\uff1aalways-\u4e00\u5b9a\u6267\u884c\uff0cembedded-\u53ea\u5bf9\u5185\u5b58\u6570\u636e\u5e93\u6267\u884c(\u9ed8\u8ba4)\uff0cnever-\u4e0d\u6267\u884c\u3002"),(0,i.kt)("p",null,'spring.jpa.defer-datasource-initialization setup to true will enable the insertting sql execution, no other configuraton setup. Just need a new sql file named with "data.sql" in resources folder.'),(0,i.kt)("p",null,"2\u3001JPA\u6839\u636e\u7c7b\u7ed3\u6784\u521d\u59cb\u5316"),(0,i.kt)("p",null,"\u3000\u3000@Entity\u6ce8\u89e3\u7684\u7c7b\u5c06\u4f1a\u88ab\u521d\u59cb\u5316\u4e00\u5f20\u6570\u636e\u5e93\u8868\u3002"),(0,i.kt)("p",null,"\u3000\u3000\u662f\u5426\u6267\u884c\u7684\u5f00\u5173\u7531spring.jpa.hibernate.ddl-auto\u5c5e\u6027\u63a7\u5236\uff0c\u53ef\u4e3acreate/update/create-drop/none/validate\uff0c\u5176\u4e2dnone\u548cvalidate\u4e3a\u4e0d\u6267\u884c\u3002"),(0,i.kt)("p",null,"3\u3001\u521d\u59cb\u5316\u65f6\u5bf9\u4e8e\u53e6\u4e00\u4e2a\u5c5e\u6027spring.jpa.generate-dll\u5728\u7406\u89e3\u4e0a\u7684\u56f0\u60d1"),(0,i.kt)("p",null,"\u3000\u3000\u6309\u7167\u5b83\u7684\u63cf\u8ff0\uff0cspring.jpa.generate-dll\u662fjpa\u5c42\u9762\u5bf9\u6570\u636e\u8868\u751f\u6210\u7b56\u7565\u7684\u63a7\u5236\uff0c\u800cspring.jpa.hibernate.ddl-auto\u662fjpa\u5b9e\u73b0hibernate\u5c42\u9762\u4e0a\u5bf9\u6570\u636e\u8868\u751f\u6210\u7b56\u7565\u7684\u63a7\u5236\u3002"),(0,i.kt)("p",null,"\u3000\u3000\u5b9e\u8df5\u4e5f\u9a8c\u8bc1\u4e86\u6587\u7ae0\u91cc\u6240\u8bf4\u7684\uff0cspring.jpa.generate-dll\u6bd4spring.jpa.hibernate.ddl-auto\u6709\u66f4\u5f3a\u7684\u63a7\u5236\u529b\u5ea6\uff0c\u5373\u4f7fspring.jpa.hibernate.ddl-auto\u4e3anone\uff0c\u53ea\u8981spring.jpa.generate-dll\u4e3atrue\uff0c\u4e5f\u4f1a\u6839\u636e@Entity\u6ce8\u89e3\u7684\u5b9e\u4f53\u7c7b\u751f\u6210\u5bf9\u5e94\u6570\u636e\u8868\u3002"),(0,i.kt)("p",null,"\u3000\u3000\u6309\u7167\u6587\u7ae0\u7684\u5efa\u8bae\uff0c\u4e3a\u4e86\u907f\u514d\u6df7\u6dc6\u548c\u4e0d\u597d\u7406\u89e3\uff0c\u8fd9\u4e24\u8005\u6700\u597d\u4e0d\u8981\u6df7\u7528\uff0c\u53ea\u5bf9JPA\u5b9e\u73b0\u5c42\u9762\u7684\u63a7\u5236\u5c5e\u6027spring.jpa.hibernate.ddl-auto\u8fdb\u884c\u8bbe\u7f6e\u5373\u53ef\u3002"),(0,i.kt)("p",null,"   \u6700\u4fdd\u9669\u7684\u505a\u6cd5: \u82e5\u60f3\u81ea\u52a8\u751f\u6210\u8868, setup ",(0,i.kt)("inlineCode",{parentName:"p"},"spring.jpa.generate-dll=true"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"spring.jpa.hibernate.ddl-auto")," \u5219\u8bbe\u7f6e\u4e3a\u9700\u8981\u7684\u7b56\u7565; \u82e5\u4e0d\u60f3\u81ea\u52a8\u751f\u6210\u8868, \u8bbe\u7f6e ",(0,i.kt)("inlineCode",{parentName:"p"},"generate-ddl=false (\u9ed8\u8ba4)")," \u5373\u53ef"),(0,i.kt)("p",null,"4\u3001\u8ba9SpringBoot\u6839\u636e\u811a\u672c\u548c\u8ba9JPA\u6839\u636e\u5b9e\u4f53\u7c7b\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u4e24\u8005\u4e4b\u4e2d\u9009\u62e9\u4e00\u4e2a\u5373\u53ef\u3002"),(0,i.kt)("p",null,"5 spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect \u867d\u7136 \u4e0d\u540c\u7684\u6570\u636e\u5e93\u65b9\u8a00\u4f1a\u81ea\u52a8\u9009\u62e9, \u4f46\u662f\u82e5\u60f3\u4f7f\u7528\u7279\u5b9a\u5f15\u64ce\u7c7b\u578b\u9700\u8981\u6307\u5b9a\u65b9\u8a00, \u4e0d\u52a0\u8fd9\u53e5\u5219\u4e0d\u4f1a\u9ed8\u8ba4\u521b\u5efaMyISAM\u5f15\u64ce\u7684\u6570\u636e\u5e93"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"jpa:hibernate:ddl-auto: update\u662fhibernate\u7684\u914d\u7f6e\u5c5e\u6027\uff0c\u5176\u4e3b\u8981\u4f5c\u7528\u662f\uff1a\u81ea\u52a8\u521b\u5efa\u3001\u66f4\u65b0\u3001\u9a8c\u8bc1\u6570\u636e\u5e93\u8868\u7ed3\u6784\u3002\u8be5\u53c2\u6570\u7684\u51e0\u79cd\u914d\u7f6e\u5982\u4e0b\uff1a\n1.\xb7create\uff1a\u6bcf\u6b21\u52a0\u8f7dhibernate\u65f6\u90fd\u4f1a\u5220\u9664\u4e0a\u4e00\u6b21\u7684\u751f\u6210\u7684\u8868\uff0c\u7136\u540e\u6839\u636e\u4f60\u7684model\u7c7b\u518d\u91cd\u65b0\u6765\u751f\u6210\u65b0\u8868\uff0c\u54ea\u6015\u4e24\u6b21\u6ca1\u6709\u4efb\u4f55\u6539\u53d8\u4e5f\u8981\u8fd9\u6837\u6267\u884c\uff0c\u8fd9\u5c31\u662f\u5bfc\u81f4\u6570\u636e\u5e93\u8868\u6570\u636e\u4e22\u5931\u7684\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u3002\n2.\xb7create-drop\uff1a\u6bcf\u6b21\u52a0\u8f7dhibernate\u65f6\u6839\u636emodel\u7c7b\u751f\u6210\u8868\uff0c\u4f46\u662fsessionFactory\u4e00\u5173\u95ed,\u8868\u5c31\u81ea\u52a8\u5220\u9664\u3002\n3.\xb7update\uff1a\u6700\u5e38\u7528\u7684\u5c5e\u6027\uff0c\u7b2c\u4e00\u6b21\u52a0\u8f7dhibernate\u65f6\u6839\u636emodel\u7c7b\u4f1a\u81ea\u52a8\u5efa\u7acb\u8d77\u8868\u7684\u7ed3\u6784\uff08\u524d\u63d0\u662f\u5148\u5efa\u7acb\u597d\u6570\u636e\u5e93\uff09\uff0c\u4ee5\u540e\u52a0\u8f7dhibernate\u65f6\u6839\u636emodel\u7c7b\u81ea\u52a8\u66f4\u65b0\u8868\u7ed3\u6784\uff0c\u5373\u4f7f\u8868\u7ed3\u6784\u6539\u53d8\u4e86\u4f46\u8868\u4e2d\u7684\u884c\u4ecd\u7136\u5b58\u5728\u4e0d\u4f1a\u5220\u9664\u4ee5\u524d\u7684\u884c\u3002\u8981\u6ce8\u610f\u7684\u662f\u5f53\u90e8\u7f72\u5230\u670d\u52a1\u5668\u540e\uff0c\u8868\u7ed3\u6784\u662f\u4e0d\u4f1a\u88ab\u9a6c\u4e0a\u5efa\u7acb\u8d77\u6765\u7684\uff0c\u662f\u8981\u7b49\u5e94\u7528\u7b2c\u4e00\u6b21\u8fd0\u884c\u8d77\u6765\u540e\u624d\u4f1a\u3002\n4.\xb7validate\uff1a\u6bcf\u6b21\u52a0\u8f7dhibernate\u65f6\uff0c\u9a8c\u8bc1\u521b\u5efa\u6570\u636e\u5e93\u8868\u7ed3\u6784\uff0c\u53ea\u4f1a\u548c\u6570\u636e\u5e93\u4e2d\u7684\u8868\u8fdb\u884c\u6bd4\u8f83\uff0c\u4e0d\u4f1a\u521b\u5efa\u65b0\u8868\uff0c\u4f46\u662f\u4f1a\u63d2\u5165\u65b0\u503c\u3002\n\u6211\u5728\u521d\u6b21\u521b\u5efa\u65f6\u4f1a\u8bbe\u4e3acreate,\u521b\u5efa\u597d\u540e\u6539\u4e3avalidate.\n\n\n")),(0,i.kt)("h4",{id:"13732-jpa-querydsl-\u591a\u8868\u8054\u67e5"},"13.7.3.2. jpa queryDsl \u591a\u8868\u8054\u67e5"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://zhongpan.tech/2020/07/20/034-best-practice-of-multi-table-joint-query-in-spring-data-jpa/"},"https://zhongpan.tech/2020/07/20/034-best-practice-of-multi-table-joint-query-in-spring-data-jpa/"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.baeldung.com/querydsl-with-jpa-tutorial"},"https://www.baeldung.com/querydsl-with-jpa-tutorial")),(0,i.kt)("h4",{id:"13733-jpa-\u652f\u6301-java8-time"},"13.7.3.3. jpa \u652f\u6301 java8 time"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"https://stackoverflow.com/questions/54840769/how-to-persist-localdate-with-jpa\n\nhttps://www.baeldung.com/jpa-java-time\n")),(0,i.kt)("h3",{id:"1374-datasourceinitializer"},"13.7.4. DataSourceInitializer"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n@Configuration\npublic class CustomizeDataSourceInitializer {\n\n\n    @Value("classpath:testSql/test_farms.sql")\n    private Resource functionScriptFarms;\n    @Value("classpath:testSql/test_miners.sql")\n    private Resource functionScriptMiners;\n    @Value("classpath:testSql/test_pool_config.sql")\n    private Resource functionScriptPoolConfig;\n\n    @Bean\n    public DataSourceInitializer dataSourceInitializer(final DataSource dataSource) {\n        final DataSourceInitializer initializer = new DataSourceInitializer();\n        // \u8bbe\u7f6e\u6570\u636e\u6e90\n        initializer.setDataSource(dataSource);\n        initializer.setDatabasePopulator(databasePopulator());\n        return initializer;\n    }\n\n    private DatabasePopulator databasePopulator() {\n        final ResourceDatabasePopulator populator = new ResourceDatabasePopulator();\n        populator.addScripts(functionScriptFarms);\n        populator.addScripts(functionScriptMiners);\n        populator.addScripts(functionScriptPoolConfig);\n\n        return populator;\n    }\n\n}\n')),(0,i.kt)("h3",{id:"1375-maven-antrun-pluginn"},"13.7.5. maven-antrun-pluginn"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'\n<profile> \n    <id>refresh-db</id> \n    <build> \n        <plugins> \n            <plugin> \n               <groupId>org.apache.maven.plugins</groupId>\n               <artifactId>maven-antrun-plugin</artifactId> \n               <configuration> \n               <target> \n                   <property file="src/main/resources/application.properties" /> \n                   <sql driver="${jdbc.driver}" url="${jdbc.url}" userid="${jdbc.username}" password="${jdbc.password}" onerror="continue" encoding="${project.build.sourceEncoding}">\n                       <classpath refid="maven.test.classpath" /> \n                       <transaction src="src/main/resources/sql/h2/schema.sql"/>\n                       <transaction src="src/test/resources/data/h2/import-data.sql"/>\n                   </sql> \n              </target> \n              </configuration> \n            </plugin> \n        </plugins> \n    </build> \n</profile>\n')),(0,i.kt)("h3",{id:"construct-a-script-execution-service-manually"},"construct a script execution service manually"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://mubasil-bokhari.medium.com/execute-sql-script-in-spring-boot-30636884a932"},"https://mubasil-bokhari.medium.com/execute-sql-script-in-spring-boot-30636884a932"),"\ntodo"),(0,i.kt)("h2",{id:"138-\u6574\u5408-spring-jdbc"},"13.8. \u6574\u5408 spring jdbc"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/liyihua/p/12333967.html"},"https://www.cnblogs.com/liyihua/p/12333967.html")),(0,i.kt)("h2",{id:"139-\u6574\u5408-hibernate"},"13.9. \u6574\u5408 hibernate"),(0,i.kt)("p",null,"\u5373 spring data jpa"),(0,i.kt)("h3",{id:"1391-jpa\u6ce8\u89e3\u603b\u7ed3"},"13.9.1. jpa\u6ce8\u89e3\u603b\u7ed3"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// anno on class\n@DynamicInsert\n@DynamicUpdate\n@EntityListeners(AuditingEntityListener.class)\n\n\n\n\n//anno on field\n// uuid as primary key\n    @Id\n    @GenericGenerator(name = "generator", strategy = "uuid")\n    @GeneratedValue(generator = "generator", strategy = GenerationType.TABLE)\n    @Column(name = "id", length = 32)\n')),(0,i.kt)("h3",{id:"1392-\u5ba1\u8ba1-createddate"},"13.9.2. \u5ba1\u8ba1 createdDate"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/a972669015/article/details/104778172"},"https://blog.csdn.net/a972669015/article/details/104778172"),"\nTODO"),(0,i.kt)("h3",{id:"1393-\u6267\u884c\u539f\u751f-sql"},"13.9.3. \u6267\u884c\u539f\u751f SQL"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/cloudfavorites/favorites-web"},"https://github.com/cloudfavorites/favorites-web")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/myknow/p/9559011.html"},"https://www.cnblogs.com/myknow/p/9559011.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://segmentfault.com/a/1190000022338883"},"https://segmentfault.com/a/1190000022338883"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://liuyanzhao.com/8069.html"},"https://liuyanzhao.com/8069.html"),"\nTODO"),(0,i.kt)("h3",{id:"1394-\u52a8\u6001-sql"},"13.9.4. \u52a8\u6001 SQL"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/kongxianghai/p/7575988.html"},"https://www.cnblogs.com/kongxianghai/p/7575988.html")),(0,i.kt)("p",null,"\u63d2\u5165\u548c\u4fee\u6539\u53ef\u4ee5\u5728\u7c7b\u5b9e\u4f53\u4e0a\u6807\u6ce8\n@DynamicInsert\u548c@DynamicUpdate\n\u8fd0\u884c\u65f6\u52a8\u6001\u751f\u6210\u975e\u7a7a\u5b57\u6bb5\u7684 \u63d2\u5165\u548c \u66f4\u65b0\u8bed\u53e5"),(0,i.kt)("p",null,"\u52a8\u6001\u67e5\u8be2\u5219\u9700\u8981\u7528 Criteria API"),(0,i.kt)("h3",{id:"1395-spring-data-rest-\u914d\u5408-spring-data-jpa"},"13.9.5. spring-data-rest \u914d\u5408 spring-data-jpa"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"http://docs.jcohy.com/docs/spring-data-rest/3.2.8.RELEASE/html5/zh-cn/"},"http://docs.jcohy.com/docs/spring-data-rest/3.2.8.RELEASE/html5/zh-cn/"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-data/rest/docs/3.4.5/reference/html/#Project"},"https://docs.spring.io/spring-data/rest/docs/3.4.5/reference/html/#Project")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-data/jpa/docs/2.4.5/reference/html/#repositories"},"https://docs.spring.io/spring-data/jpa/docs/2.4.5/reference/html/#repositories")),(0,i.kt)("p",null,"spring data rest \u53ef\u4ee5\u76f4\u63a5\u5c06 repository \u53d1\u5e03\u4e3a rest service, \u548c spring data jpa (\u81ea\u52a8\u751f\u6210 crud api) \u914d\u5408"),(0,i.kt)("p",null,"\u76ee\u524d\u652f\u6301Spring Data JPA\u3001Spring Data MongoDB\u3001Spring Data Neo4j\u3001Spring Data GemFire\u3001Spring Data Cassandra\u7684 repository \u81ea\u52a8\u8f6c\u6362\u6210REST\u670d\u52a1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-jpa</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-rest</artifactId>\n        </dependency>\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@RepositoryRestResource // publish repository as rest service\ninterface ReservationRepository extends JpaRepository<Reservation, Long> {\n\n    /**\n     * customized rest service\n     *\n     * http://localhost:8080/reservations/search/by-name?name=hello\n     */\n    @RestResource(path = "by-name")\n    Optional<Reservation> findByName(String name);\n}\n\n')),(0,i.kt)("p",null,"\u5728\u5206\u5e03\u5f0f\u4e0b, \u5728 feign client \u63a5\u6536 spring data rest \u53d1\u5e03\u7684 service \u9700\u8981\u548c hateoas (spring-boot-starter-hateoas) \u914d\u5408:(",(0,i.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-hateoas/docs/current/reference/html/#migrate-to-1.0.changes"},"hateoas \u7248\u672c\u66f4\u65b0, \u63a5\u53d7\u6570\u636e\u7684\u5b9e\u4f53\u6709\u6539\u53d8"),")"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@FeignClient("reservation-service") // also support \'url\' ( outside eureka)\ninterface ReservationResources {\n\n    @RequestMapping("/reservations")\n    CollectionModel<Reservation> reservations();\n\n    @RequestMapping("/message")\n    String message();\n}\n')),(0,i.kt)("h2",{id:"1310-\u6574\u5408-mybatis-plus"},"13.10. \u6574\u5408 mybatis-plus"),(0,i.kt)("p",null,"mybatis-plus-boot-starter"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface IAccountService extends IService<Account> {\n}\n@Service\npublic class AccountService extends ServiceImpl<AccountMapper, Account> implements IAccountService {\n}\n\n\n@mapper\n// \u6216\u8005\u542f\u52a8\u7c7b @MapperScan("io.github.xiaoyureed.workflow.mapper")\npublic interface AccountMapper extends BaseMapper<Account> {\n}\n\n\n')),(0,i.kt)("p",null,"AccountMapper.xml"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="io.github.xiaoyureed.workflow.mapper.AccountMapper">\n</mapper>\n\n\n')),(0,i.kt)("h2",{id:"1311-\u6574\u5408-mybatis"},"13.11. \u6574\u5408 mybatis"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4f9d\u8d56\uff1amybatis-spring-boot-starter"),(0,i.kt)("li",{parentName:"ul"},"@Mapper\u6807\u6ce8\u521b\u5efa\u7684xxxMapper\u63a5\u53e3\uff1b\u6216\u8005 \u5728 \u542f\u52a8\u7c7b\u4e0a \u6807\u6ce8 @mapperscan(basepackage...)"),(0,i.kt)("li",{parentName:"ul"},'@Select("SELECT * FROM USER WHERE NAME = #{name}")\u6807\u6ce8\u65b9\u6cd5\uff0c\u8fd8\u6709@insert\u7b49\uff1b\u65b9\u6cd5\u53c2\u6570@Param("name")\u6807\u6ce8'),(0,i.kt)("li",{parentName:"ul"},"\u901a\u8fc7@Autowired\u6ce8\u5165\u4f7f\u7528")),(0,i.kt)("p",null,"\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5f15\u5165 mybatisplus-spring-boot-starter \u901a\u8fc7 mybatis plus \u4f7f\u7528"),(0,i.kt)("h3",{id:"13111-\u57fa\u672c\u914d\u7f6e"},"13.11.1. \u57fa\u672c\u914d\u7f6e"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},'server:\n  port: 8080\nspring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/mall?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai\n    username: root\n    password: root\nmybatis:\n  # config-location\u5c5e\u6027\u548cconfiguration\u5c5e\u6027\u4e0d\u80fd\u540c\u65f6\u6307\u5b9a\n  #config-location: classpath:mybatis.xml\n  type-aliases-package: me.zingon.pagehelper.model\n  mapper-locations: classpath:mapper/*.xml\n  #mapper-locations: {"classpath:mapper/*.xml", "classpath*:com/**/mapper/*.xml"}\n  configuration:\n    map-underscore-to-camel-case: true\n    default-fetch-size: 100\n    default-statement-timeout: 30\n\n')),(0,i.kt)("h3",{id:"13112-\u4f7f\u7528-\u62e6\u622a\u5668-interceptor-plugins"},"13.11.2. \u4f7f\u7528 \u62e6\u622a\u5668 interceptor plugins"),(0,i.kt)("h4",{id:"131121-principle-of-plugins"},"13.11.2.1. principle of plugins"),(0,i.kt)("p",null,"\u57fa\u4e8e\u63d2\u4ef6\u673a\u5236\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u63a7\u5236SQL\u6267\u884c\u7684\u5404\u4e2a\u9636\u6bb5\uff0c\u5982\u6267\u884c\u9636\u6bb5\uff0c\u53c2\u6570\u5904\u7406\u9636\u6bb5\uff0c\u8bed\u6cd5\u6784\u5efa\u9636\u6bb5\uff0c\u7ed3\u679c\u96c6\u5904\u7406\u9636\u6bb5\uff0c\u5177\u4f53\u53ef\u4ee5\u6839\u636e\u9879\u76ee\u4e1a\u52a1\u6765\u5b9e\u73b0\u5bf9\u5e94\u4e1a\u52a1\u903b\u8f91\u3002"),(0,i.kt)("p",null,"\u8bbe\u8ba1\u6a21\u5f0f\uff1a\u4ee3\u7406\u6a21\u5f0f\u3001\u8d23\u4efb\u94fe\u6a21\u5f0f"),(0,i.kt)("h4",{id:"131122-use-scenarios"},"13.11.2.2. use scenarios"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"paging \u62e6\u622aStatementHandler\u7c7b\u7684prepare\u65b9\u6cd5\uff0c\u6539\u53d8\u8981\u6267\u884c\u7684SQL\u8bed\u53e5\u4e3a\u5206\u9875\u8bed\u53e5\u5373\u53ef\uff1b"),(0,i.kt)("li",{parentName:"ul"},"Assign default values to fields before SQL execution"),(0,i.kt)("li",{parentName:"ul"},"SQL performance monitor \u901a\u8fc7\u62e6\u622aExecutor\u7c7b\u7684update, query\u7b49\u65b9\u6cd5\uff0c\u7528\u65e5\u5fd7\u8bb0\u5f55\u6bcf\u4e2a\u65b9\u6cd5\u6267\u884c\u7684\u65f6\u95f4")),(0,i.kt)("h4",{id:"131123-how-to-use-plugins"},"13.11.2.3. how to use plugins"),(0,i.kt)("p",null,"\u5b9e\u73b0 Interceptor \u63a5\u53e3, \u6807\u6ce8@Intercepts(@Signature) , \u53c2\u8003 ",(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/0a72bb1f6a21"},"https://www.jianshu.com/p/0a72bb1f6a21")),(0,i.kt)("p",null,"scenario 1: \u76f4\u63a5\u7ed9\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\u6dfb\u52a0\u4e00\u4e2a @Component\u6ce8\u89e3 , \u542f\u52a8\u65f6\u4e0d\u4f1a\u81ea\u52a8\u8c03\u7528\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\u7684setProperties\u65b9\u6cd5\nscenario 2: \u65e0\u9700 @component ,\u53ea\u9700\u8981 @bean ConfigurationCustomizer \u4e2d addInterceptor , \u4e0d\u4f1a\u81ea\u52a8\u8c03\u7528setProperties\u65b9\u6cd5 --- mybatis plus  \u4e2d\u7684\u914d\u7f6e\u65b9\u6cd5\nscenario 3: \u65e0\u9700 @component ,\u9700\u8981 @bean SqlSessionFactoryBean \u4e2d setPlugins --- (app \u542f\u52a8\u65f6, setProperties\u88ab\u81ea\u52a8\u8c03\u7528)"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/miaoxinwei/mybatis-crypt/blob/master/src/main/java/org/apache/ibatis/plugin/CryptInterceptor.java"},"https://github.com/miaoxinwei/mybatis-crypt/blob/master/src/main/java/org/apache/ibatis/plugin/CryptInterceptor.java")," \u65e5\u5fd7\u8131\u654f",(0,i.kt)("br",{parentName:"p"}),"\n","TODO"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'/**\n     * \u5728mybatis\u4e2d\u53ef\u88ab\u62e6\u622a\u7684\u7c7b\u578b\u6709\u56db\u79cd(\u6309\u7167\u62e6\u622a\u987a\u5e8f):\n     * <p>\n     * Executor\uff1a\u6267\u884c SQL \u8bed\u53e5\u3002\n     * ParameterHandler\uff1a\u5904\u7406\u53c2\u6570\n     * ResultHandler\uff1a\u5904\u7406\u7ed3\u679c\u96c6\u3002\n     * StatementHandler\uff1aSql\u8bed\u6cd5\u6784\u5efa\u3002\n     *\n     * \u6bcf\u4e2a\u7c7b\u578b\u53ef\u4ee5\u88ab\u62e6\u622a\u7684\u65b9\u6cd5:\n     *\n     \u62e6\u622a\u7684\u7c7b   \u62e6\u622a\u7684\u65b9\u6cd5\n     Executor   update, query, flushStatements, commit, rollback,getTransaction, close, isClosed\n     ParameterHandler   getParameterObject, setParameters\n     StatementHandler   prepare, parameterize, batch, update, query\n     ResultSetHandler   handleResultSets, handleOutputParameters\n     */\n    //\u6807\u8bc6\u8be5\u7c7b\u662f\u4e00\u4e2a\u62e6\u622a\u5668\uff1b\n    @Intercepts({\n            //\u6307\u660e\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\u9700\u8981\u62e6\u622a\u54ea\u4e00\u4e2a\u7c7b\u578b\uff0c\u54ea\u4e00\u4e2a\u65b9\u6cd5(\u65b9\u6cd5\u6709\u91cd\u8f7d, \u6240\u4ee5\u8fd8\u9700\u8981 \u6307\u660e args \u624d\u80fd\u786e\u5b9a\u662f\u54ea\u4e2a\u65b9\u6cd5)\n            @Signature(type = Executor.class, method = "update", args = {MappedStatement.class, Object.class}),\n            @Signature(type = Executor.class, method = "query", args = {\n                    MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class})\n    })\n    private static class SqlInterceptor implements Interceptor {\n\n        @Override\n        public Object intercept(Invocation invocation) throws Throwable {\n//            Object target = invocation.getTarget(); //\u88ab\u4ee3\u7406\u5bf9\u8c61\n//            Method method = invocation.getMethod(); //\u4ee3\u7406\u65b9\u6cd5\n//            Object[] args = invocation.getArgs(); //\u65b9\u6cd5\u53c2\u6570\n\n            Object[] args = invocation.getArgs();\n            Object param = null;\n            MappedStatement mappedStatement = (MappedStatement) args[0];\n            if (args.length > 1) {\n                param = args[1];\n            }\n            String sql = sql(mappedStatement, param);\n            return invocation.proceed();\n        }\n\n        private String sql(MappedStatement statement, Object param) {\n            BoundSql boundSql = statement.getBoundSql(param);\n            List<ParameterMapping> parameterMappings = boundSql.getParameterMappings();\n            //\u5c06\u539f\u59cbsql\u4e2d\u7684\u7a7a\u767d\u5b57\u7b26\uff08\\s\u5305\u62ec\u6362\u884c\u7b26\uff0c\u5236\u8868\u7b26\uff0c\u7a7a\u683c\u7b26\uff09\u66ff\u6362\u4e3a" "\n            String sql = boundSql.getSql().replaceAll("[\\\\s]+", " ");\n            if (param == null || parameterMappings.size() == 0) {\n                return sql;\n            }\n\n            org.apache.ibatis.session.Configuration configuration = statement.getConfiguration();\n            TypeHandlerRegistry typeHandlerRegistry = configuration.getTypeHandlerRegistry();\n            if (typeHandlerRegistry.hasTypeHandler(param.getClass())) {\n                sql = sql.replaceFirst("\\\\?", getParameterValue(param));\n            } else {\n                MetaObject metaObject = configuration.newMetaObject(param);\n                for (ParameterMapping parameterMapping : parameterMappings) {\n                    String propertyName = parameterMapping.getProperty();\n                    if (metaObject.hasGetter(propertyName)) {\n                        Object obj = metaObject.getValue(propertyName);\n                        sql = sql.replaceFirst("\\\\?", getParameterValue(obj));\n                    } else if (boundSql.hasAdditionalParameter(propertyName)) {\n                        Object obj = boundSql.getAdditionalParameter(propertyName);\n                        sql = sql.replaceFirst("\\\\?", getParameterValue(obj));\n                    }\n                }\n            }\n            return sql;\n        }\n\n        private String getParameterValue(Object obj) {\n            String value = null;\n            if (obj instanceof String) {\n                value = "\'" + obj.toString() + "\'";\n            } else if (obj instanceof Date) {\n                DateFormat formatter = DateFormat.getDateTimeInstance(DateFormat.DEFAULT, DateFormat.DEFAULT, Locale.CHINA);\n                value = "\'" + formatter.format(obj) + "\'";\n            } else {\n                if (obj != null) {\n                    value = obj.toString();\n                } else {\n                    value = "";\n                }\n            }\n            return value;\n        }\n\n        /**\n         * \u751f\u6210\u4ee3\u7406\u5bf9\u8c61\n         * \u53ef\u9009\n         * \u6211\u4eec\u53ef\u4ee5\u51b3\u5b9a\u662f\u5426\u8981\u8fdb\u884c\u62e6\u622a, \u5982\u679c\u62e6\u622a, \u5c31\u8fd4\u56de\u4ee3\u7406\u540e\u7684\u5bf9\u8c61\n         *       * \u5982\u679c\u4e0d\u62e6\u622a, \u5219\u8fd4\u56de\u539f\u59cb\u5bf9\u8c61\n         *\n         *  \u6bcf\u7ecf\u8fc7\u4e00\u4e2a\u62e6\u622a\u5668\u5bf9\u8c61\u90fd\u4f1a\u8c03\u7528\u63d2\u4ef6\u7684plugin\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8c03\u75284\u6b21\u3002\u6839\u636e@Intercepts\u6ce8\u89e3\u6765\u51b3\u5b9a\u662f\u5426\u8fdb\u884c\u62e6\u622a\u5904\u7406\n         */\n        @Override\n        public Object plugin(Object target) {\n            //\u8fd4\u56de\u56db\u5927\u63a5\u53e3\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61, \u8868\u793a\u59cb\u7ec8\u4f1a\u6267\u884c\u62e6\u622a\n            return Plugin.wrap(target, this);\n\n            // \u63a7\u5236\u662f\u5426\u62e6\u622a\n            // \u82e5\u7c7b\u4e0a\u52a0\u4e86 @Signature \u6307\u660e\u4e86 \u62e6\u622a\u7c7b\u578b, \u8fd9\u4e00\u6b65\u5c31\u7701\u4e86\n//            if (target instanceof StatementHandler) {\n//                return Plugin.wrap(target, this);\n//            }\n//            return target;\n        }\n\n        /**\n         * \u53ef\u9009\n         * \u7528\u4e8e\u5728 Mybatis \u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u4e00\u4e9b\u5c5e\u6027\u7684\u3002\u7c7b\u4f3c spring \u4e2d\u6709 @value,\n         * \u4e00\u822c\u4e0d\u7528\n         */\n        @Override\n        public void setProperties(Properties properties) {\n        }\n    }\n\n')),(0,i.kt)("h3",{id:"13113-typehandler"},"13.11.3. typehandler"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/m0_37735176/article/details/103107759"},"https://blog.csdn.net/m0_37735176/article/details/103107759"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/haoliyou/p/13743698.html"},"https://www.cnblogs.com/haoliyou/p/13743698.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/dyf-stu/p/10162301.html"},"https://www.cnblogs.com/dyf-stu/p/10162301.html")),(0,i.kt)("h3",{id:"13114-\u5168\u6ce8\u89e3\u5f00\u53d1"},"13.11.4. \u5168\u6ce8\u89e3\u5f00\u53d1"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://zhuanlan.zhihu.com/p/94554180"},"https://zhuanlan.zhihu.com/p/94554180"),"\nTODO"),(0,i.kt)("h3",{id:"13115-\u52a8\u6001\u5b9a\u65f6\u5237\u65b0-sql-mapper-\u5b9e\u73b0\u70ed\u52a0\u8f7d"},"13.11.5. \u52a8\u6001\u5b9a\u65f6\u5237\u65b0 SQL mapper \u5b9e\u73b0\u70ed\u52a0\u8f7d"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://veevv.com/2015/09/30/mybatis-mapper-xml-reloader/"},"https://veevv.com/2015/09/30/mybatis-mapper-xml-reloader/")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@component\npublic class XMLMapperReloader implements ApplicationContextAware {\n\n    private ConfigurableApplicationContext context = null;\n    private HashMap<String, Long> fileMapping = new HashMap<String, Long>();\n    private Scanner scanner = null;\n    private String packageSearchPath = "classpath:com/xx/xx/dao/*/*.xml";\n    private ScheduledExecutorService service = null;\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        this.context = (ConfigurableApplicationContext) applicationContext;\n\n    }\n\n    public XMLMapperReloader(){\n        service = Executors.newScheduledThreadPool(1);\n        service.scheduleAtFixedRate(new Task(), 5, 5, TimeUnit.SECONDS);\n    }\n\n    class Task implements Runnable {\n        @Override\n        public void run() {\n            try {\n                scanner = new Scanner();\n                scanner.refreshMapper();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n\n    }\n\n    @SuppressWarnings({ "rawtypes" })\n    class Scanner {\n        private Resource[] mapperLocations;\n\n        public void refreshMapper() {\n            try {\n                SqlSessionFactory factory = context.getBean(SqlSessionFactory.class);\n                Configuration configuration = factory.getConfiguration();\n\n                // step.1 \u626b\u63cf\u6587\u4ef6\n                try {\n                    this.scanMapperXml();\n                } catch (IOException e) {\n                    return;\n                }\n\n                // step.2 \u5224\u65ad\u662f\u5426\u6709\u6587\u4ef6\u53d1\u751f\u4e86\u53d8\u5316\n                if (this.isChanged()) {\n                    System.out.println("==============\u68c0\u6d4b\u5230mapper\u6709\u6539\u53d8, \u5f00\u59cb\u5237\u65b0...===============");\n                    // step.2.1 \u6e05\u7406\n                    this.removeConfig(configuration);\n\n                    // step.2.2 \u91cd\u65b0\u52a0\u8f7d\n                    for (Resource configLocation : mapperLocations) {\n                        try {\n                            XMLMapperBuilder xmlMapperBuilder = new XMLMapperBuilder(configLocation.getInputStream(), configuration, configLocation.toString(), configuration.getSqlFragments());\n                            xmlMapperBuilder.parse();\n                        } catch (IOException e) {\n                            continue;\n                        }\n                    }\n                    System.out.println("==============mapper\u5237\u65b0\u5b8c\u6bd5===============");\n                }\n\n\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n\n        private void scanMapperXml() throws IOException {\n            this.mapperLocations = new PathMatchingResourcePatternResolver().getResources(packageSearchPath);\n        }\n\n        private void removeConfig(Configuration configuration) throws Exception {\n            Class<?> classConfig = configuration.getClass();\n            clearMap(classConfig, configuration, "mappedStatements");\n            clearMap(classConfig, configuration, "caches");\n            clearMap(classConfig, configuration, "resultMaps");\n            clearMap(classConfig, configuration, "parameterMaps");\n            clearMap(classConfig, configuration, "keyGenerators");\n            clearMap(classConfig, configuration, "sqlFragments");\n\n            clearSet(classConfig, configuration, "loadedResources");\n\n        }\n\n        private void clearMap(Class<?> classConfig, Configuration configuration, String fieldName) throws Exception {\n            Field field = classConfig.getDeclaredField(fieldName);\n            field.setAccessible(true);\n            Map mapConfig = (Map) field.get(configuration);\n            mapConfig.clear();\n        }\n\n        private void clearSet(Class<?> classConfig, Configuration configuration, String fieldName) throws Exception {\n            Field field = classConfig.getDeclaredField(fieldName);\n            field.setAccessible(true);\n            Set setConfig = (Set) field.get(configuration);\n            setConfig.clear();\n        }\n\n        private boolean isChanged() throws IOException {\n            boolean flag = false;\n            for (Resource resource : mapperLocations) {\n                String resourceName = resource.getFilename();\n\n                boolean addFlag = !fileMapping.containsKey(resourceName);// \u6b64\u4e3a\u65b0\u589e\u6807\u8bc6\n\n                // \u4fee\u6539\u6587\u4ef6:\u5224\u65ad\u6587\u4ef6\u5185\u5bb9\u662f\u5426\u6709\u53d8\u5316\n                Long compareFrame = fileMapping.get(resourceName);\n                long lastFrame = resource.contentLength() + resource.lastModified();\n                boolean modifyFlag = null != compareFrame && compareFrame.longValue() != lastFrame;// \u6b64\u4e3a\u4fee\u6539\u6807\u8bc6\n\n                // \u65b0\u589e\u6216\u662f\u4fee\u6539\u65f6,\u5b58\u50a8\u6587\u4ef6\n                if(addFlag || modifyFlag) {\n                    fileMapping.put(resourceName, Long.valueOf(lastFrame));// \u6587\u4ef6\u5185\u5bb9\u5e27\u503c\n                    flag = true;\n                }\n            }\n            return flag;\n        }\n    }\n\n    public String getPackageSearchPath() {\n        return packageSearchPath;\n    }\n\n    public void setPackageSearchPath(String packageSearchPath) {\n        this.packageSearchPath = packageSearchPath;\n    }\n}\n\n\n')),(0,i.kt)("h3",{id:"13116-\u81ea\u5b9a\u4e49\u8d44\u6e90\u6587\u4ef6\u6253\u5305\u76ee\u5f55-and-\u5f00\u542f\u5360\u4f4d\u7b26\u8fc7\u6ee4"},"13.11.6. \u81ea\u5b9a\u4e49\u8d44\u6e90\u6587\u4ef6\u6253\u5305\u76ee\u5f55 and \u5f00\u542f\u5360\u4f4d\u7b26\u8fc7\u6ee4"),(0,i.kt)("p",null,"mapper.xml \u548c dao interface \u653e\u5728\u4e00\u8d77: (\u5f00\u542f\u8d44\u6e90\u6587\u4ef6\u8fc7\u6ee4)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n\n        \x3c!-- maven \u9ed8\u8ba4\u4ec5\u4ec5 \u5c06src/main/resources \u4e0b\u7684\u6587\u4ef6\u6253\u5305\u5230 jar\n            \u82e5 mapper.xml \u4e0d\u5728\u6807\u51c6\u76ee\u5f55\u4e0b, \u9700\u8981\u6307\u5b9a\u8d44\u6e90\u8fc7\u6ee4\u5904\u7406 --\x3e\n        <resources>\n            <resource>\n                <directory>src/main/java</directory>\n                <includes>\n                    <include>**/*.*</include>\n                </includes>\n                \x3c!-- \u6253\u5305\u5230\u54ea\u91cc? \u53ef\u7701\u7565, \u9ed8\u8ba4 jar \u6839\u76ee\u5f55 --\x3e\n                \x3c!-- <targetPath>META-INF/plexus</targetPath> --\x3e\n                \x3c!-- \u662f\u5426\u5f00\u542f\u8d44\u6e90\u6587\u4ef6\u5360\u4f4d\u7b26\u8fc7\u6ee4 (\u5982 ${project.version}), \u9ed8\u8ba4 false --\x3e\n                \x3c!-- <filtering>false</filtering> --\x3e\n            </resource>\n            \x3c!-- \u53ef\u7701\u7565 --\x3e\n            <resource>\n                <directory>src/main/resources</directory>\n                <includes>\n                    <include>**/*.*</include>\n                </includes>\n            </resource>\n            \x3c!-- \u6dfb\u52a0\u989d\u5916\u7684\u914d\u7f6e\u6587\u4ef6, \u7528\u6765\u89e3\u6790\u8d44\u6e90\u6587\u4ef6\u4e2d\u7684\u5360\u4f4d\u7b26 --\x3e\n            <filters>\n                <filter>src/main/filters/filter.properties</filter>\n            </filters>\n        </resources>\n    </build>\n\n")),(0,i.kt)("h2",{id:"1312-springboot-\u4e8b\u52a1"},"13.12. springboot \u4e8b\u52a1"),(0,i.kt)("h3",{id:"13121-\u4e8b\u52a1\u57fa\u672c\u4f7f\u7528"},"13.12.1. \u4e8b\u52a1\u57fa\u672c\u4f7f\u7528"),(0,i.kt)("p",null,"Spring boot\u662f\u9ed8\u8ba4\u542f\u52a8\u4e8b\u52a1\u7684\uff0c\u53ea\u9700\u8981\u5728\u7c7b\u6216\u8005\u65b9\u6cd5\u4e0a\u6dfb\u52a0@Transactional\u6ce8\u89e3\u5373\u53ef"),(0,i.kt)("p",null,"You can also use ",(0,i.kt)("inlineCode",{parentName:"p"},"transaction manager")," manually: ",(0,i.kt)("inlineCode",{parentName:"p"},"transactionTemplate.execute()")),(0,i.kt)("h3",{id:"13122-transaction-not-working"},"13.12.2. transaction not working"),(0,i.kt)("p",null,"\u4e8b\u52a1\u4e0d\u751f\u6548, \u53ef\u80fd\u662f:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'1\u3001\u9996\u5148\u8981\u770b\u6570\u636e\u5e93\u5f15\u64ce\u662f\u5426\u652f\u6301\u4e8b\u52a1\uff0cmysql\u9ed8\u8ba4\u5f15\u64ceINNODB\u662f\u652f\u6301\u7684\uff0c\u4f46MYISAM\u662f\u4e0d\u652f\u6301\u7684\uff1b\n\n2\u3001\u6ce8\u89e3\u53ea\u80fd\u88ab\u5e94\u7528\u5230public, none final, none static \u65b9\u6cd5\u4e0a, \u5176\u5b83\u65b9\u6cd5\u4e0a\u4e0d\u4f1a\u62a5\u9519\uff0c\u4f46\u4e0d\u751f\u6548\uff1b(as transaction is based on dynamic proxy, "public/final" method will defeat against proxy object generation;)\n\n  cglib proxy is based on "extends". jdk proxy is based on "interface", they are both need the method is not final/static\n\n3\u3001\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u4f1a\u5bf9\u8fd0\u884c\u671f\u5f02\u5e38(\u5373 java.lang.RuntimeException\u5f02\u5e38)\u548c Error \u8fdb\u884c\u56de\u6eda\uff1b\n\n  \u5982\u679c\u662f\u5176\u5b83\u5f02\u5e38, \u9700\u8981\u624b\u52a8\u6307\u5b9a`@Transactional(rollbackFor={Exception.class})` \u56de\u6eda\u6240\u6709\u5f02\u5e38;\n\n  \u8fd8\u53ef\u80fd\u5f02\u5e38\u88ab\u67d0\u4e2a aop \u5207\u9762\u6355\u83b7\u4e86, \u6ca1\u6cd5\u89e6\u53d1\u56de\u6eda\n\n4. \u540c\u4e00\u4e2a\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5d4c\u5957\u8c03\u7528: \u5982\u666e\u901a\u65b9\u6cd5 a() call annotatied method B(), the transaction for B() will not trigger (this is also easy to explain: the calling to B() can be refered to as this.B(), which means the calling is not from a proxy object)\n\n5. \u591a\u7ebf\u7a0b\u73af\u5883, \u6b64\u65f6\u6570\u636e\u5e93\u8fde\u63a5\u90fd\u4e0d\u662f\u540c\u4e00\u4e2a, \u80af\u5b9a\u4e0d\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e86\n\n// https://blog.csdn.net/laoxilaoxi_/article/details/99896738 \u4f7f\u7528 cglib or jdk \u52a8\u6001\u4ee3\u7406 `@EnableTransactionManagement(proxyTargetClass = true)// \u4f7f\u7528cglib`\n\n')),(0,i.kt)("h3",{id:"13123-spring-\u4e8b\u52a1\u4f20\u64ad\u5931\u6548\u7684\u5751"},"13.12.3. spring \u4e8b\u52a1\u4f20\u64ad\u5931\u6548\u7684\u5751"),(0,i.kt)("p",null,"\u540c\u4e00\u4e2a service bean \u4e2d\u7684 \u4e8b\u52a1\u65b9\u6cd5\u4e92\u76f8\u8c03\u7528, \u5982 a() \u8c03\u7528 b(), \u53ea\u4f1a\u4f7f\u7528 a() \u7684 \u4e8b\u52a1, b \u7684\u65e0\u6548, \u56e0\u4e3a\u4e8b\u52a1\u672c\u8d28\u662f\u57fa\u4e8e\u52a8\u6001\u4ee3\u7406, \u5728\u540c\u4e2a bean \u4e2d\u7684\u65b9\u6cd5\u4e92\u8c03, \u53d1\u751f\u5728\u4e3b\u52a8\u8c03\u7528\u65b9 a() \u7684\u4ee3\u7406\u5bf9\u8c61\u4e2d, \u6240\u4ee5\u53ea\u6709 a() \u7684\u4e8b\u52a1\u751f\u6548"),(0,i.kt)("p",null,"\u89e3\u51b3:"),(0,i.kt)("p",null,"\u5982\u679c a(), b() \u5904\u4e8e\u4e0d\u540c service bean \u4e2d, \u5219 \u4e8b\u52a1\u4f20\u64ad\u751f\u6548."),(0,i.kt)("p",null,"\u6216\u8005"),(0,i.kt)("p",null,"\u5f15\u5165 starter aop, \u4f1a\u5f15\u5165 aspectJ, @enableAspectJAutoProxy(exposeProxy=true) \u5f00\u542f aspectJ \u5e76\u66b4\u9732\u4ee3\u7406\u5bf9\u8c61, \u5728\u4e92\u8c03\u7684\u90e8\u5206, \u4f7f\u7528\u4ee3\u7406\u5bf9\u8c61\u4e92\u8c03"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public void a() {\n    // b()\n    // c()\n    OrderService thisService = (OrderService) Aopcontext.currentProxy()\n    thisService.b()\n    thisService.c()\n}\n")),(0,i.kt)("h3",{id:"13124-transactional-\u6ce8\u89e3"},"13.12.4. Transactional \u6ce8\u89e3"),(0,i.kt)("p",null,"\u4e8b\u52a1\u8d85\u65f6"),(0,i.kt)("p",null,"@transaction(timeout=...) unit: s"),(0,i.kt)("p",null,"\u9694\u79bb\u7ea7\u522b"),(0,i.kt)("p",null,"@transaction(isolation=...)"),(0,i.kt)("h2",{id:"1313-\u7f13\u5b58"},"13.13. \u7f13\u5b58"),(0,i.kt)("h3",{id:"13131-springboot-starter-cache"},"13.13.1. springboot-starter-cache"),(0,i.kt)("p",null,"\u5f15\u5165 redis starter, cache starter"),(0,i.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u7c7b\u578b\u4e3a redis"),(0,i.kt)("p",null,"\u6ce8\u89e3:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'@cacheable({"xxxCache"}, sync=true) \u7f13\u5b58\u6570\u636e, \u65b9\u6cd5\u4e0a, \u6307\u5b9a\u7f13\u5b58\u5206\u533a, sync \u52a0\u9501\u9632\u6b62\u7f13\u5b58\u51fb\u7a7f'),(0,i.kt)("li",{parentName:"ul"},'@cacheEvic(value="xxx", allEntries=true) \u5220\u9664\u7f13\u5b58, allEntries \u8868\u793a\u5220\u9664\u5206\u533a cache \u4e0b\u7684\u5168\u90e8\u7f13\u5b58\u5bf9'),(0,i.kt)("li",{parentName:"ul"},"@cacheput \u66f4\u65b0"),(0,i.kt)("li",{parentName:"ul"},"caching \u7ec4\u5408\u591a\u4e2a\u64cd\u4f5c  "),(0,i.kt)("li",{parentName:"ul"},"@cacheconfig \u5728\u7c7b\u7ea7\u522b\u5171\u4eab\u7f13\u5b58\u914d\u7f6e"),(0,i.kt)("li",{parentName:"ul"},"@enablecaching \u5f00\u542f\u7f13\u5b58")),(0,i.kt)("p",null,"\u81ea\u5b9a\u4e49\u914d\u7f6e"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// \u81ea\u5b9a\u4e49\u7f13\u5b58 key\n// \u81ea\u5b9a\u4e49 json \u5e8f\u5217\u5316, \u4e0d\u7528\u9ed8\u8ba4\u7684 jdk \u5e8f\u5217\u5316\n// \u81ea\u5b9a\u4e49\u8fc7\u671f\u65f6\u95f4, \u9ed8\u8ba4-1 \u6c38\u4e0d\u8fc7\u671f\n")),(0,i.kt)("p",null,"\u4f18\u52bf\u662f\u7b80\u5355\u65b9\u4fbf,"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u8bfb\u6a21\u5f0f:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7f13\u5b58\u7a7f\u900f (\u67e5\u8be2\u4e00\u4e2a null \u6570\u636e), \u914d\u7f6e cache-null-value=true \u7f13\u5b58 null \u6570\u636e"),(0,i.kt)("li",{parentName:"ul"},"\u7f13\u5b58\u51fb\u7a7f (\u5927\u91cf\u5e76\u53d1\u540c\u65f6\u8bf7\u6c42\u4e00\u4e2a\u5feb\u8fc7\u671f\u7684key): "),(0,i.kt)("li",{parentName:"ul"},"\u96ea\u5d29(\u5927\u91cfkey \u540c\u65f6\u8fc7\u671f), \u914d\u7f6e time-to-live \u8fc7\u671f\u65f6\u95f4, ")),(0,i.kt)("p",null,"\u5bf9\u4e8e\u5199\u6a21\u5f0f: \u6ca1\u6709\u5f88\u597d\u7684\u5185\u7f6e\u89e3\u51b3\u65b9\u6cd5, \u53ef\u4ee5\u901a\u8fc7:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8bfb\u5199\u52a0\u9501"),(0,i.kt)("li",{parentName:"ul"},"canal \u4e2d\u95f4\u4ef6")),(0,i.kt)("h3",{id:"13132-caffeine"},"13.13.2. caffeine"),(0,i.kt)("p",null,"Caffeine\u662f\u4f7f\u7528Java8\u5bf9Guava\u7f13\u5b58\u7684\u91cd\u5199\u7248\u672c\uff0c\u5728Spring Boot 2.0\u4e2d\u5c06\u53d6\u4ee3Guava"),(0,i.kt)("h2",{id:"1314-\u914d\u5408-h2-\u6570\u636e\u5e93\u8fdb\u884c\u5f00\u53d1"},"13.14. \u914d\u5408 h2 \u6570\u636e\u5e93\u8fdb\u884c\u5f00\u53d1"),(0,i.kt)("h3",{id:"13141-h2-\u548c-spring-data-jpa-\u914d\u5408"},"13.14.1. h2 \u548c spring data jpa \u914d\u5408"),(0,i.kt)("p",null,"\u65e0\u9700\u4efb\u4f55\u914d\u7f6e\u6587\u4ef6"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@SpringBootApplication\n@EnableDiscoveryClient // compared with @EnableEurekaClient, more comprehensive\npublic class ReservationServiceApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(ReservationServiceApplication.class, args);\n    }\n\n    @Bean\n    public ApplicationRunner initData(ReservationRepository reservationRepository) {\n        return args -> {\n            Stream.of("ehllo", "hello", "llhoe", "jojo", "\u7315\u7334\u6843")\n                    .forEach(name -> reservationRepository.save(new Reservation(null, name)));\n            reservationRepository.findAll().forEach(System.out::println);\n        };\n    }\n\n}\n\n@RepositoryRestResource // publish repository as rest service\n        // \u6bd4\u5982\u67e5\u8be2\u6240\u6709 /reservations, \u67e5\u67d0\u4e2a /reservations/1, \u641c\u7d22 /reservations/search ...\ninterface ReservationRepository extends JpaRepository<Reservation, Long> {\n\n    /**\n     * customized rest service\n     *\n     * http://localhost:8080/reservations/search/by-name?name=hello\n     */\n    @RestResource(path = "by-name")\n    Optional<Reservation> findByName(String name);\n}\n\n@RestController\n@RefreshScope\nclass ConfigRefreshTestController {\n\n    private final String message;\n\n    private final DiscoveryClient discoveryClient;\n\n    public ConfigRefreshTestController(@Value("${message: defaultMsg}") String message,\n                                       @Autowired DiscoveryClient discoveryClient) {\n        this.message = message;\n        this.discoveryClient = discoveryClient;\n    }\n\n    @RequestMapping(value = "/message", method = RequestMethod.GET)\n    public String readMessage() {\n        return this.message;\n    }\n\n    @RequestMapping("/eureka-services")\n    public ResponseEntity<List<String>> eurekaServices() {\n        return new ResponseEntity<>(discoveryClient.getServices(), HttpStatus.OK);\n    }\n}\n\n/**\n * entity: \u9884\u5b9a\n */\n@Entity\n@Data\n@AllArgsConstructor\n@NoArgsConstructor // if removed, jpa error may be produced\nclass Reservation {\n\n    @Id\n    @GeneratedValue\n    private Long id;\n\n    private String name;\n}\n')),(0,i.kt)("h3",{id:"13142-\u548c-mybatis-plus-\u914d\u5408"},"13.14.2. \u548c mybatis-plus \u914d\u5408"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://mp.baomidou.com/guide/quick-start.html"},"h2 \u548c mybatis-plus \u914d\u5408"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"# DataSource Config\nspring:\n  datasource:\n    driver-class-name: org.h2.Driver\n    schema: classpath:db/schema-h2.sql\n    data: classpath:db/data-h2.sql\n    url: jdbc:h2:mem:test\n    username: root\n    password: test\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'@MapperScan("mapper package")')),(0,i.kt)("p",null,"mapper extends BaseMapper"),(0,i.kt)("h2",{id:"1315-\u591a\u6570\u636e\u6e90"},"13.15. \u591a\u6570\u636e\u6e90"),(0,i.kt)("h3",{id:"13151-\u57fa\u672c\u914d\u7f6e-\u5168\u6ce8\u89e3\u5f00\u53d1"},"13.15.1. \u57fa\u672c\u914d\u7f6e \u5168\u6ce8\u89e3\u5f00\u53d1"),(0,i.kt)("p",null,"\u542f\u52a8\u7c7b\u9700\u8981\u6392\u9664\u81ea\u52a8\u914d\u7f6e@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class})"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-props"},"server.port=8335\n# \u914d\u7f6e\u7b2c\u4e00\u4e2a\u6570\u636e\u6e90\nspring.datasource.hikari.db1.jdbc-url=jdbc:mysql://127.0.0.1:3306/erp?useUnicode=true&characterEncoding=utf8&useSSL=true&serverTimezone=GMT%2B8\nspring.datasource.hikari.db1.username=root\nspring.datasource.hikari.db1.password=153963\nspring.datasource.hikari.db1.driver-class-name=com.mysql.cj.jdbc.Driver\n# \u914d\u7f6e\u7b2c\u4e8c\u4e2a\u6570\u636e\u6e90\nspring.datasource.hikari.db2.jdbc-url=jdbc:mysql://127.0.0.1:3306/erp2?useUnicode=true&characterEncoding=utf8&useSSL=true&serverTimezone=GMT%2B8\nspring.datasource.hikari.db2.username=root\nspring.datasource.hikari.db2.password=153963\nspring.datasource.hikari.db2.driver-class-name=com.mysql.cj.jdbc.Driver\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@MapperScan(basePackages = "top.snailclimb.db1.dao", sqlSessionTemplateRef = "db1SqlSessionTemplate")\npublic class DataSource1Config {\n\n    /**\n     * \u751f\u6210\u6570\u636e\u6e90.  @Primary \u6ce8\u89e3\u58f0\u660e\u4e3a\u9ed8\u8ba4\u6570\u636e\u6e90\n     */\n    @Bean(name = "db1DataSource")\n    @ConfigurationProperties(prefix = "spring.datasource.hikari.db1")\n    @Primary // \u58f0\u660e\u4e3a\u9ed8\u8ba4\u6570\u636e\u6e90, \u9632\u6b62 dao \u5c42\u7684\u7c7b\u5fd8\u8bb0\u6307\u5b9a @Qualifier("db1SqlSessionTemplate"), \u53ef\u4ee5\u4f7f\u7528\u9ed8\u8ba4\u7684\n    public DataSource testDataSource() {\n        return DataSourceBuilder.create().build();\n    }\n\n    /**\n     * \u521b\u5efa SqlSessionFactory\n     */\n    @Bean(name = "db1SqlSessionFactory")\n    @Primary\n    public SqlSessionFactory testSqlSessionFactory(@Qualifier("db1DataSource") DataSource dataSource) throws Exception {\n        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();\n        bean.setDataSource(dataSource);\n        // \u82e5\u6709 mapper.xml , \u9700\u8981\u6307\u5b9a\u4f4d\u7f6e\n        // \u82e5\u662f\u5168\u6ce8\u89e3\u5f00\u53d1, \u65e0\u9700\u6307\u5b9a\n        //  bean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources("classpath:mybatis/mapper/db1/*.xml"));\n        return bean.getObject();\n    }\n\n    /**\n     * \u914d\u7f6e\u4e8b\u52a1\u7ba1\u7406\n     */\n    @Bean(name = "db1TransactionManager")\n    @Primary\n    public DataSourceTransactionManager testTransactionManager(@Qualifier("db1DataSource") DataSource dataSource) {\n        return new DataSourceTransactionManager(dataSource);\n    }\n\n    /**\n    SqlSessionTemplate\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u53ef\u4ee5\u88ab\u591a\u4e2aDAO\u6240\u5171\u4eab\u4f7f\u7528\u3002\n    */\n    @Bean(name = "db1SqlSessionTemplate")\n    @Primary\n    public SqlSessionTemplate testSqlSessionTemplate(@Qualifier("db1SqlSessionFactory") SqlSessionFactory sqlSessionFactory) throws Exception {\n        return new SqlSessionTemplate(sqlSessionFactory);\n    }\n\n}\n\n\n\n\n@Configuration\n@MapperScan(basePackages = "top.snailclimb.db2.dao", sqlSessionTemplateRef = "db2SqlSessionTemplate")\npublic class DataSource2Config {\n\n    @Bean(name = "db2DataSource")\n    @ConfigurationProperties(prefix = "spring.datasource.hikari.db2")\n    public DataSource testDataSource() {\n        return DataSourceBuilder.create().build();\n    }\n\n    @Bean(name = "db2SqlSessionFactory")\n    public SqlSessionFactory testSqlSessionFactory(@Qualifier("db2DataSource") DataSource dataSource) throws Exception {\n        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();\n        bean.setDataSource(dataSource);\n        //bean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources("classpath:mybatis/mapper/db2/*.xml"));\n        return bean.getObject();\n    }\n\n    @Bean(name = "db2TransactionManager")\n    public DataSourceTransactionManager testTransactionManager(@Qualifier("db2DataSource") DataSource dataSource) {\n        return new DataSourceTransactionManager(dataSource);\n    }\n\n    @Bean(name = "db2SqlSessionTemplate")\n    public SqlSessionTemplate testSqlSessionTemplate(@Qualifier("db2SqlSessionFactory") SqlSessionFactory sqlSessionFactory) throws Exception {\n        return new SqlSessionTemplate(sqlSessionFactory);\n    }\n\n}\n\n\n\n\n\n\ndao \u5f00\u53d1:\n\n@Qualifier("db1SqlSessionTemplate")\npublic interface UserDao {\n    /**\n     * \u901a\u8fc7\u540d\u5b57\u67e5\u8be2\u7528\u6237\u4fe1\u606f\n\n    mybatis\u4e2d#{}\u548c${}\u7b26\u53f7\u7684\u533a\u522b \n    \u4f7f\u7528#{}\u610f\u5473\u7740\u4f7f\u7528\u7684\u9884\u7f16\u8bd1\u7684\u8bed\u53e5\uff0c\u5373 preparedStatement, \u66ff\u6362\u5360\u4f4d\u7b26\u65f6, \u4f1a\u4e3a\u53c2\u6570\u6dfb\u52a0\u5f15\u53f7\u4f5c\u4e3a string \u4f20\u5165, \u9632\u6b62\u6ce8\u5165\u653b\u51fb\n    \u4e5f\u4e0d\u662f\u8bf4${}\u4e00\u65e0\u662f\u5904\uff0c\u6bd4\u5982\u5728MyBatis\u52a8\u6001\u6392\u5e8f\u65f6\u4f7f\u7528order by +${\u52a8\u6001\u53c2\u6570}\uff0c\u4f7f\u7528${}\u800c\u4e0d\u662f#{}, \u52a8\u6001\u53c2\u6570\u53ef\u4ee5\u4f20\u5165\u4e0d\u5b9a\u4e2a\u6570\u7684\u5b57\u6bb5.\n\n\n     */\n    @Select("SELECT * FROM user WHERE name = #{name}")\n    User findUserByName(String name);\n\n}\n@Qualifier("db2SqlSessionTemplate")\npublic interface MoneyDao {\n\n    /**\n     * \u901a\u8fc7id \u67e5\u770b\u5de5\u8d44\u8be6\u60c5\n     */\n    @Select("SELECT * FROM money WHERE id = #{id}")\n    Money findMoneyById(@Param("id") int id);\n}\n\n\n')),(0,i.kt)("h3",{id:"13152-abstractroutingdatasource-\u52a8\u6001\u6570\u636e\u6e90\u5207\u6362"},"13.15.2. AbstractRoutingDataSource \u52a8\u6001\u6570\u636e\u6e90\u5207\u6362"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/qq_37502106/article/details/91044952"},"https://blog.csdn.net/qq_37502106/article/details/91044952"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/wyb628/p/7240061.html"},"https://www.cnblogs.com/wyb628/p/7240061.html")),(0,i.kt)("h2",{id:"1316-\u591a\u6570\u636e\u5e93\u7c7b\u578b-databaseidprovider"},"13.16. \u591a\u6570\u636e\u5e93\u7c7b\u578b databaseIdProvider"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/valten/p/12083128.html#"},"https://www.cnblogs.com/valten/p/12083128.html#")," \u914d\u7f6e MySQL Oracle \u5171\u540c\u4f7f\u7528"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n@Configuration\npublic class DataSourceConfig {\n    @Value("${mybatis.mapper-locations}")\n    private String mapperLocations;\n\n    @Primary\n    @Bean(name = "dataSource")\n    @ConfigurationProperties("spring.datasource.hikari")\n    public DataSource dataSource() {\n        return DataSourceBuilder.create().build();\n    }\n\n    @Bean\n    public JdbcTemplate jdbcTemplate() {\n        return new JdbcTemplate(dataSource());\n    }\n\n    //\u5982\u679c\u914d\u7f6e\u4e86 databaseIdProvider\uff0cMyBatis \u4f1a\u52a0\u8f7d\u6240\u6709\u7684\u4e0d\u5e26 databaseId \u6216\u5339\u914d\u5f53\u524d databaseId \u7684\u8bed\u53e5\uff1b\n    // databaseId \u662f mybatis \u7684\u5185\u7f6e\u53c2\u6570\n    //\u5982\u679c\u5e26\u6216\u8005\u4e0d\u5e26\u7684\u8bed\u53e5\u90fd\u6709\uff0c\u5219\u4e0d\u5e26\u7684\u4f1a\u88ab\u5ffd\u7565\u3002\u65b0\u589e\uff0c\u4fee\u6539\u548c\u5220\u9664\u90fd\u6709\u8fd9\u4e2a\u5c5e\u6027\n    /**\n    \n    \x3c!-- mybatis\u52a8\u6001sql\u7684\u4e24\u4e2a\u5185\u7f6e\u53c2\u6570 , \u53ef\u4ee5\u76f4\u63a5\u5728 mapper.xml \u4e2d\u4f7f\u7528\n           _parameter:\u4ee3\u8868\u6574\u4e2a\u53c2\u6570\n                \u5355\u4e2a\u53c2\u6570\uff1a_parameter\u5c31\u662f\u8fd9\u4e2a\u53c2\u6570\n                \u591a\u4e2a\u53c2\u6570\uff1a\u53c2\u6570\u4f1a\u88ab\u5c01\u88c5\u4e3a\u4e00\u4e2amap:_parameter\u5c31\u662f\u4ee3\u8868\u8fd9\u4e2amap             \n           _databaseId:\u5982\u679c\u914d\u7f6e\u4e86databaseIdProvider\u6807\u7b7e\n                _databaseId \u5c31\u662f\u4ee3\u8868\u5f53\u524d\u6570\u636e\u5e93\u7684\u522b\u540dOracle\n      --\x3e\n      \x3c!-- List<Employee> getEmpsTestInnerParameter(Employee employee); --\x3e\n      <select id="getEmpsTestInnerParameter" resultType="com.hand.mybatis.bean.Employee">\n          SELECT * FROM emp \n          <if test="_parameter!=null">      _parameter\u76f8\u5f53\u4e8e\u4f20\u5165\u7684\u53c2\u6570employee,\u5224\u65ademployee\u662f\u5426\u4e3a\u7a7a\uff0c\u82e5\u4e0d\u4e3a\u7a7a\u5219\u6267\u884cwhere\u6761\u4ef6 \n           where ename=#{_parameter.eName}   \n          </if>\n      </select>\n    */\n    @Bean\n    public DatabaseIdProvider databaseIdProvider() {\n        DatabaseIdProvider databaseIdProvider = new VendorDatabaseIdProvider();\n        Properties p = new Properties();\n        p.setProperty("Oracle", "oracle");\n        p.setProperty("MySQL", "mysql");\n        p.setProperty("PostgreSQL", "postgresql");\n        p.setProperty("DB2", "db2");\n        p.setProperty("SQL Server", "sqlserver");\n        databaseIdProvider.setProperties(p);\n        return databaseIdProvider;\n    }\n\n    @Primary\n    @Bean\n    public SqlSessionFactoryBean sqlSessionFactoryBean(@Qualifier("dataSource") DataSource dataSource) throws Exception {\n        SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();\n        factoryBean.setDataSource(dataSource);\n        factoryBean.setDatabaseIdProvider(databaseIdProvider());\n        factoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations));\n        return factoryBean;\n    }\n}\n\n\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"# application.yml\n# \u5207\u6362\u5bf9\u5e94\u7684\u73af\u5883 postgresql mysql\nspring:\n  profiles:\n    active: postgresql\n\n# mybatis\u914d\u7f6e\nmybatis:\n  mapper-locations: classpath:mapper/**/*.xml\n  type-aliases-package: com.valten.**.model\n\n# showSql \u63a7\u5236\u53f0\u6253\u5370sql\u65e5\u5fd7\nlogging:\n  level:\n    com:\n      valten:\n        dao: debug\n\n---\n# application-mysql.yml#\n# \u7aef\u53e3\nserver:\n  port: 8001\n\n# \u6570\u636e\u6e90\u914d\u7f6e\nspring:\n  datasource:\n    hikari:\n      jdbc-url: jdbc:mysql://127.0.0.1:3306/test?&useSSL=false\n      driver-class-name: com.mysql.jdbc.Driver\n      username: root\n      password: 123456\n\n---      \n# application-postgresql.yml#\n# \u7aef\u53e3\nserver:\n  port: 8002\n\n# \u6570\u636e\u6e90\u914d\u7f6e\nspring:\n  datasource:\n    hikari:\n      jdbc-url: jdbc:postgresql://127.0.0.1:5432/test\n      driver-class-name: org.postgresql.Driver\n      username: root\n      password: 123456\n        \n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n\x3c!--oracle--\x3e\n<dependency>\n    <groupId>com.oracle</groupId>\n    <artifactId>ojdbc6</artifactId>\n    <version>11.2.0.3</version>\n</dependency>\n\x3c!--postgresql--\x3e\n<dependency>\n    <groupId>org.postgresql</groupId>\n    <artifactId>postgresql</artifactId>\n    <version>9.4.1212</version>\n</dependency>\n\x3c!-- \u96c6\u6210mybatis --\x3e\n<dependency>\n    <groupId>org.mybatis.spring.boot</groupId>\n    <artifactId>mybatis-spring-boot-starter</artifactId>\n    <version>1.3.1</version>\n</dependency>\n\x3c!--fastjson--\x3e\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>1.2.16</version>\n</dependency>\n\x3c!-- druid\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7ec4\u4ef6 --\x3e\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>druid-spring-boot-starter</artifactId>\n    <version>1.1.10</version>\n</dependency>\n")),(0,i.kt)("h2",{id:"1317-spring-kafka"},"13.17. spring kafka"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-kafka/docs/current/reference/html/#receiving-messages"},"https://docs.spring.io/spring-kafka/docs/current/reference/html/#receiving-messages")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=SqVfCyfCJqw&t=9s"},"https://www.youtube.com/watch?v=SqVfCyfCJqw&t=9s")),(0,i.kt)("h1",{id:"14-web-\u76f8\u5173"},"14. web \u76f8\u5173"),(0,i.kt)("h2",{id:"141-\u52a0\u89e3\u5bc6"},"14.1. \u52a0\u89e3\u5bc6"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/yinjihuan/monkey-api-encrypt"},"https://github.com/yinjihuan/monkey-api-encrypt")," api \u52a0\u89e3\u5bc6 "),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.baeldung.com/java-aes-encryption-decryption"},"https://www.baeldung.com/java-aes-encryption-decryption")," \u52a0\u5bc6\u79d1\u666e"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/loong-hon/p/11225407.html"},"https://www.cnblogs.com/loong-hon/p/11225407.html")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.javatt.com/p/22814"},"https://www.javatt.com/p/22814"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/github_36086968/article/details/103424945"},"https://blog.csdn.net/github_36086968/article/details/103424945"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://jueee.github.io/2021/01/2021-01-06-SpringBoot%E5%AE%9E%E7%8E%B0API%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AEAES%E5%8A%A0%E5%AF%86/"},"https://jueee.github.io/2021/01/2021-01-06-SpringBoot%E5%AE%9E%E7%8E%B0API%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AEAES%E5%8A%A0%E5%AF%86/")),(0,i.kt)("h2",{id:"142-springboot-\u53d1\u9001-https-\u6216\u8005-http-\u5ba2\u6237\u7aef-client"},"14.2. springboot \u53d1\u9001 https \u6216\u8005 http \u5ba2\u6237\u7aef client"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/defonds/article/details/86594441"},"https://blog.csdn.net/defonds/article/details/86594441")," (",(0,i.kt)("a",{parentName:"p",href:"https://prasans.info/making-https-call-using-apache-httpclient/"},"https://prasans.info/making-https-call-using-apache-httpclient/"),")\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/lfstudy/p/13793625.html"},"https://www.cnblogs.com/lfstudy/p/13793625.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/dbei/articles/12746191.html"},"https://www.cnblogs.com/dbei/articles/12746191.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://segmentfault.com/a/1190000014456939"},"https://segmentfault.com/a/1190000014456939")," \u4f7f\u7528 resttemplate"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://square.github.io/okhttp/"},"https://square.github.io/okhttp/"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://square.github.io/okhttp/https/"},"https://square.github.io/okhttp/https/")),(0,i.kt)("p",null,"\u652f\u6301\u5f02\u6b65\u56de\u8c03 Retrofit: ",(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/4d67fe493ebf"},"https://www.jianshu.com/p/4d67fe493ebf"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.zhihu.com/question/36963964"},"https://www.zhihu.com/question/36963964"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/5bc866b9cbb9"},"https://www.jianshu.com/p/5bc866b9cbb9")),(0,i.kt)("h3",{id:"1421-\u53d1\u9001-http-client"},"14.2.1. \u53d1\u9001 http client"),(0,i.kt)("h3",{id:"1422-\u53d1\u9001-https-client"},"14.2.2. \u53d1\u9001 https client"),(0,i.kt)("p",null,"okhttp"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class JavaConfig {\n\n    @Bean(name = "myRestTemplate")\n    public RestTemplate restTemplate() throws KeyStoreException, NoSuchAlgorithmException, KeyManagementException {\n        TrustStrategy acceptingTrustStrategy = (X509Certificate[] chain, String authType) -> true;\n        SSLContext sslContext = org.apache.http.ssl.SSLContexts.custom()\n                .loadTrustMaterial(null, acceptingTrustStrategy)\n                .build();\n        SSLConnectionSocketFactory csf = new SSLConnectionSocketFactory(sslContext);\n        CloseableHttpClient httpClient = HttpClients.custom()\n                .setSSLSocketFactory(csf)\n                .build();\n        HttpComponentsClientHttpRequestFactory requestFactory =\n                new HttpComponentsClientHttpRequestFactory();\n        requestFactory.setHttpClient(httpClient);\n\n        //60s\n        requestFactory.setConnectTimeout(60 * 1000);\n        requestFactory.setReadTimeout(60 * 1000);\n        RestTemplate restTemplate = new RestTemplate(requestFactory);\n        restTemplate.getMessageConverters().set(1, new StringHttpMessageConverter(StandardCharsets.UTF_8));\n        return restTemplate;\n    }\n}\n\n')),(0,i.kt)("h2",{id:"143-requestcontextholder"},"14.3. RequestContextHolder"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder\n        .getRequestAttributes();\nHttpServletRequest request = attributes.getRequest();\n\n")),(0,i.kt)("h2",{id:"144-\u89e3\u51b3-api-\u7248\u672c\u5171\u5b58"},"14.4. \u89e3\u51b3 api \u7248\u672c\u5171\u5b58"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/j903829182/article/details/81836551"},"https://blog.csdn.net/j903829182/article/details/81836551"),", ",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/huanshilang/p/12097048.html"},"https://www.cnblogs.com/huanshilang/p/12097048.html")," \u653e\u5728 url\nTODO"),(0,i.kt)("h3",{id:"1441-requestmappinghandlermapping"},"14.4.1. RequestMappingHandlerMapping"),(0,i.kt)("h3",{id:"1442-request-matcher"},"14.4.2. request matcher"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'private RequestMatcher matcherHtml = new AntPathRequestMatcher("/**", "GET");\n\n\u628aServletRequest\u8f6c\u5316\u6210HttpServletRequest,\u5f3a\u8f6c\u5373\u53ef\n\n\u8c03\u7528matches\u65b9\u6cd5\u8fdb\u884c\u5339\u914d boolean matches(HttpServletRequest request)\n\n')),(0,i.kt)("h3",{id:"1443-request-condition"},"14.4.3. request condition"),(0,i.kt)("p",null,"\u5728 spring mvc \u4e2d\uff0c\u901a\u8fc7DispatchServlet\u63a5\u6536\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u4e00\u4e2a\u8bf7\u6c42\u4e4b\u540e\uff0c\u4f1a\u901a\u8fc7 HanderMapping \u6765\u83b7\u53d6\u5bf9\u5e94\u7684\u8bf7\u6c42\u5904\u7406\u5668\uff1b\u800c HanderMapping \u5982\u4f55\u627e\u5230\u53ef\u4ee5\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u7684\u5904\u7406\u5668\u5462\uff0c\u8fd9\u5c31\u9700\u8981 RequestCondition \u6765\u51b3\u5b9a\u4e86"),(0,i.kt)("p",null,"\u6700\u7ec8\u7684\u5b9e\u73b0\u7c7b\u53ef\u80fd\u662f\u9488\u5bf9\u4ee5\u4e0b\u60c5\u51b5\u4e4b\u4e00\uff1a\u8def\u5f84\u5339\u914d\uff0c\u5934\u90e8\u5339\u914d\uff0c\u8bf7\u6c42\u53c2\u6570\u5339\u914d\uff0c\u53ef\u4ea7\u751fMIME\u5339\u914d\uff0c\u53ef\u6d88\u8d39MIME\u5339\u914d\uff0c\u8bf7\u6c42\u65b9\u6cd5\u5339\u914d\uff0c\u6216\u8005\u662f\u4ee5\u4e0a\u5404\u79cd\u60c5\u51b5\u7684\u5339\u914d\u6761\u4ef6\u7684\u4e00\u4e2a\u7ec4\u5408"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public interface RequestCondition<T> {\n    // \u4e00\u4e2ahttp\u63a5\u53e3\u4e0a\u6709\u591a\u4e2a\u6761\u4ef6\u89c4\u5219\u65f6\uff0c\u7528\u4e8e\u5408\u5e76\n    //\u6bd4\u5982\u7c7b\u4e0a\u6307\u5b9a\u4e86@RequestMapping\u7684 url \u4e3a root - \u800c\u65b9\u6cd5\u4e0a\u6307\u5b9a\u7684@RequestMapping\u7684 url \u4e3a method - \u90a3\u4e48\u5728\u83b7\u53d6\u8fd9\u4e2a\u63a5\u53e3\u7684 url \u5339\u914d\u89c4\u5219\u65f6\uff0c\u7c7b\u4e0a\u626b\u63cf\u4e00\u6b21\uff0c\u65b9\u6cd5\u4e0a\u626b\u63cf\u4e00\u6b21\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u628a\u8fd9\u4e24\u4e2a\u5408\u5e76\u6210\u4e00\u4e2a\uff0c\u8868\u793a\u8fd9\u4e2a\u63a5\u53e3\u5339\u914droot/method\n    T combine(T other);\n\n    // \u5224\u65ad\u662f\u5426\u6210\u529f\uff0c\u5931\u8d25\u8fd4\u56de null\uff1b\u5426\u5219\uff0c\u5219\u8fd4\u56de\u5339\u914d\u6210\u529f\u7684\u6761\u4ef6\n    // \u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bb2\uff0c\u5982\u679c\u5f53\u524d\u8bf7\u6c42\u5339\u914d\u6761\u4ef6\u662f\u4e00\u4e2a\u8def\u5f84\u5339\u914d\u6761\u4ef6\uff0c\u5305\u542b\u591a\u4e2a\u8def\u5f84\u5339\u914d\u6a21\u677f\uff0c\n    // \u5e76\u4e14\u5176\u4e2d\u6709\u4e9b\u6a21\u677f\u548c\u6307\u5b9a\u8bf7\u6c42request\u5339\u914d\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u65b0\u5efa\u7684\u8bf7\u6c42\u5339\u914d\u6761\u4ef6\u5c06\u4ec5\u4ec5\n    // \u5305\u542b\u548c\u6307\u5b9a\u8bf7\u6c42request\u5339\u914d\u7684\u90a3\u4e9b\u8def\u5f84\u6a21\u677f\u3002\n    @Nullable\n    T getMatchingCondition(HttpServletRequest request);\n\n    // \u591a\u4e2a\u90fd\u6ee1\u8db3\u6761\u4ef6\u65f6\uff0c\u7528\u6765\u6307\u5b9a\u5177\u4f53\u9009\u62e9\u54ea\u4e00\u4e2a\u3002\n    int compareTo(T other, HttpServletRequest request);\n\n}\n\n\n")),(0,i.kt)("p",null,"AbstractRequestCondition \u5b9e\u73b0\u4e86equals,hashCode\u548ctoString \u901a\u7528\u65b9\u6cd5, \u8fd8\u901a\u8fc7protected\u62bd\u8c61\u65b9\u6cd5\u7ea6\u5b9a\u4e86\u5b9e\u73b0\u7c7b\u5176\u4ed6\u7684\u4e00\u4e9b\u5185\u90e8\u901a\u7528\u903b\u8f91"),(0,i.kt)("p",null,"\u5177\u4f53\u5b9e\u73b0\u7c7b:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"PatternsRequestCondition\t\u8def\u5f84\u5339\u914d\u6761\u4ef6"),(0,i.kt)("li",{parentName:"ul"},"RequestMethodsRequestCondition\t\u8bf7\u6c42\u65b9\u6cd5(get post delete..)\u5339\u914d\u6761\u4ef6"),(0,i.kt)("li",{parentName:"ul"},"ParamsRequestCondition\t\u8bf7\u6c42\u53c2\u6570\u5339\u914d\u6761\u4ef6"),(0,i.kt)("li",{parentName:"ul"},"HeadersRequestCondition\t\u5934\u90e8\u4fe1\u606f\u5339\u914d\u6761\u4ef6"),(0,i.kt)("li",{parentName:"ul"},"ConsumesRequestCondition\t\u53ef\u6d88\u8d39MIME\u5339\u914d\u6761\u4ef6"),(0,i.kt)("li",{parentName:"ul"},"ProducesRequestCondition\t\u53ef\u751f\u6210MIME\u5339\u914d\u6761\u4ef6")),(0,i.kt)("h2",{id:"145-\u63a5\u6536\u53c2\u6570\u76f8\u5173\u7684\u6ce8\u89e3"},"14.5. \u63a5\u6536\u53c2\u6570\u76f8\u5173\u7684\u6ce8\u89e3"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@RequestParam \u53ef\u4ee5\u7528\u4e8e\u4ecequery parameters, form data, \u548cparts in multipart requests\u4e2d\u83b7\u53d6\u53c2\u6570\u3002\n\n\u5373GET\u8bf7\u6c42\u548cPOST\uff08application/x-www-form-urlencoded \uff0cmultipart/form-data\uff09\u8bf7\u6c42\u7684\u53c2\u6570\u90fd\u53ef\u4ee5\u4f7f\u7528@RequestParam\n\n@RequestPart \u7528\u5728multipart/form-data\u8868\u5355\u63d0\u4ea4\u8bf7\u6c42\u7684\u65b9\u6cd5\u4e0a\uff0c\u652f\u6301\u7684\u8bf7\u6c42\u65b9\u6cd5\u7684\u65b9\u5f0fMultipartFile\uff0c\u5c5e\u4e8eSpring\u7684MultipartResolver\u7c7b\u3002\n\n// \u524d\u4e09\u79cd\u652f\u6301 application/x-www-form-urlencoded;charset=UTF-8\u2019 \u683c\u5f0f (\u8868\u5355\u63d0\u4ea4), \u662f\u6d4f\u89c8\u5668\u9ed8\u8ba4\u7684\u7f16\u7801\u683c\u5f0f\u3002\n// \n// multipart/form-data \u683c\u5f0f \u533a\u522b: \u4e0d\u4f1a\u5bf9\u53c2\u6570\u7f16\u7801\uff0c\u4f7f\u7528\u7684boundary(\u5206\u5272\u7ebf)\uff0c\u76f8\u5f53\u4e8e&\uff0cboundary\u7684\u503c\u662f----Web**AJv3\u3002 \u6587\u4ef6\u4e0a\u4f20\u5fc5\u987b\u8981\u8fd9\u79cd\u683c\u5f0f, \u4e5f\u53ef\u7528\u4e8e\u952e\u503c\u5bf9\u53c2\u6570\uff0c\u6700\u540e\u8fde\u63a5\u6210\u4e00\u4e32\u5b57\u7b26\u4f20\u8f93 (ref: https://www.jianshu.com/p/53b5bd0f1d44)\n// \n// @requestParam \u6ce8\u89e3\u65b9\u6cd5\u53c2\u6570, \u53ef\u7701\u7565, \u53ef\u4ee5\u6709\u591a\u4e2a\n@ApiOperation("\u67e5\u8be2\u7528\u6237")\n    @PostMapping("/detailByParam")\n    public void detailByParam(@RequestParam (value = "id") Integer id,@RequestParam(value = "roleName") String roleName,@RequestParam(value = "roleDes") String roleDes) {\n        System.out.println(">>>id="+id+",roleName="+roleName+",roleDes="+roleDes);\n        // >>>id=1,roleName=admin,roleDes=\u62e5\u6709admin\u6743\u9650\n    }\n\n\n@ApiOperation("\u67e5\u8be2\u7528\u6237")\n    @PostMapping("/detailByParam")\n    public void detailByParam(@RequestParam Map<String, String> params) {\n        System.out.println(">>>id="+params.get("id")+",roleName="+params.get("roleName")+",roleDes="+params.get("roleDes"));\n        // >>>id=1,roleName=admin,roleDes=\u62e5\u6709admin\u6743\u9650\n    }\n\n\n\n@ApiOperation("\u67e5\u8be2\u7528\u6237")\n    @PostMapping("/detailByParam")\n    public void detailByParam(@RequestBody String params) {\n        System.out.println(">>>"+params);\n        // >>>id=1&roleName=admin&roleDes=%E6%8B%A5%E6%9C%89admin%E6%9D%83%E9%99%90\n        // \n        // \u53c2\u6570\u7528 & \u9694\u79bb\u5f00, \u5bf9\u4e8eGet\u8bf7\u6c42\uff0c\u662f\u5c06\u53c2\u6570\u8f6c\u6362?key=value&key=value\u683c\u5f0f\uff0c\u8fde\u63a5\u5230url\u540e\n        // \u5982\u679c\u53c2\u6570\u503c\u4e2d\u9700\u8981&\uff0c\u5219\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\u3002\u7f16\u7801\u683c\u5f0f\u5c31\u662fapplication/x-www-form-urlencoded\uff08\u5c06\u952e\u503c\u5bf9\u7684\u53c2\u6570\u7528&\u8fde\u63a5\u8d77\u6765\uff0c\u5982\u679c\u6709\u7a7a\u683c\uff0c\u5c06\u7a7a\u683c\u8f6c\u6362\u4e3a+\u52a0\u53f7\uff1b\u6709\u7279\u6b8a\u7b26\u53f7\uff0c\u5c06\u7279\u6b8a\u7b26\u53f7\u8f6c\u6362\u4e3aASCII HEX\u503c\uff09\n    }\n\n\n\n\n// \u4ec5\u652f\u6301 application/json  \u683c\u5f0f, \u4e0d\u652f\u6301 application/x-www-form-urlencoded;charset=UTF-8\u2019\n@ApiOperation("\u67e5\u8be2\u7528\u6237")\n    @PostMapping("/detailByParam")\n    public void detailByParam(@RequestBody GetRoleParam getRoleParam) {// @RequestBody \u6ce8\u89e3\u53c2\u6570, \u4e0d\u53ef\u7701\u7565, \u6700\u591a\u53ea\u80fd\u4e00\u4e2a\n        System.out.println(">>>"+getRoleParam); \n    }\n')),(0,i.kt)("h2",{id:"146-\u81ea\u5b9a\u4e49\u63a5\u6536\u53c2\u6570\u7c7b\u578b"},"14.6. \u81ea\u5b9a\u4e49\u63a5\u6536\u53c2\u6570\u7c7b\u578b"),(0,i.kt)("p",null,"\u82e5\u679c\u53ea\u662f\u4e00\u4e2a\u4e24\u4e2a\u7c7b\u578b\u9700\u8981\u8f6c\u6362, \u76f4\u63a5\u5b9e\u73b0  org.springframework.core.convert.converter.Converter \u7136\u540e\u6807\u6ce8 component \u5373\u53ef (\u5305\u542b\u8fde\u4e2a\u6cdb\u578b, \u7b2c\u4e00\u4e2a\u662f\u8bf7\u6c42\u4e2d\u539f\u59cb\u7c7b\u578b\u5982 Integer, \u7b2c\u4e8c\u4e2a\u6cdb\u578b\u662f \u5e0c\u671b\u8f6c\u6362\u540e\u7684\u7c7b\u578b\u5982 enum),"),(0,i.kt)("p",null,"\u5bf9 get/post \u8bf7\u6c42\u90fd\u6709\u6548"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// \u4f8b\u5b50\n@Component\npublic class StringToDateConverter implements Converter<String, Date> {\n\n    private SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd");\n\n    @Override\n    public Date convert(String s) {\n        Date parse = null;\n        try {\n            parse = simpleDateFormat.parse(s);\n        } catch (ParseException e) {\n            e.printStackTrace();\n        }\n        return parse;\n    }\n}\n\n\n// \u5b9e\u4f8b\u6848\u4f8b: \u679a\u4e3e\u8f6c\u6362\n@Data\npublic class QueryRequest {\n    private GenderEnum gender;\n}\n@GetMapping("/get")//gender \u53ea\u80fd\u63a5\u6536\u5230 MALE \u3001FEMALE \u8fd9\u6837\u7684\u53c2\u6570\uff0c\u9664\u6b64\u4ee5\u5916\uff0c\u5747\u4f1a\u62a5\u7c7b\u578b\u4e0d\u5339\u914d\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u6b64\u65f6\u662f\u65e0\u6cd5\u5904\u7406 0 \u30011 \u8fd9\u6837\u7684\u53c2\u6570\u7684\npublic Dict testGet(QueryRequest request) {\n    log.info("\u3010get-request\u3011= {}", JSONUtil.toJsonStr(request));\n    return Dict.create().set("get-request", request);\n}\n\n@PostMapping("/post")\npublic Dict testPost(@RequestBody QueryRequest request) {\n    log.info("\u3010post-request\u3011= {}", JSONUtil.toJsonStr(request));\n    return Dict.create().set("post-request", request);\n}\n\n// \u589e\u52a0\u4e00\u4e2a\u8f6c\u6362\u5668\u5373\u53ef\n@component\npublic class IntegerCodeToGenderEnumConverter implements Converter<Integer, GenderEnum> {\n    private Map<Integer, GenderEnum> enumMap = Maps.newHashMap();\n \n    public IntegerCodeToGenderEnumConverter() {\n        for (GenderEnum genderEnum : GenderEnum.values()) {\n            enumMap.put(genderEnum.getCode(), genderEnum);\n        }\n    }\n \n    @Override\n    public GenderEnum convert(Integer source) {\n        GenderEnum genderEnum = enumMap.get(source);\n        if (ObjectUtil.isNull(genderEnum)) {\n            throw new IllegalArgumentException("\u65e0\u6cd5\u5339\u914d\u5bf9\u5e94\u7684\u679a\u4e3e\u7c7b\u578b");\n        }\n        return genderEnum;\n    }\n}\n')),(0,i.kt)("p",null,"\u5f53\u6211\u4eec\u7684\u679a\u4e3e\u7c7b\u7279\u522b\u591a\u7684\u65f6\u5019, \u4e0d\u4f7f\u7528\u4e0a\u9762\u76f4\u63a5\u4f7f\u7528 Converter \u7684\u8fd9\u79cd\u65b9\u6cd5\uff0c\u6211\u4eec\u5f15\u5165 ConverterFactory \u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'//\u901a\u7528\u679a\u4e3e\u63a5\u53e3\npublic interface BaseEnum {\n    /**\n     * \u83b7\u53d6\u679a\u4e3e\u7f16\u7801\n     *\n     * @return \u7f16\u7801\n     */\n    Integer getCode();\n}\n@Getter\npublic enum GenderEnum implements BaseEnum {\n    /**\n     * \u7537\n     */\n    MALE(0),\n    /**\n     * \u5973\n     */\n    FEMALE(1);\n \n    /**\n     * \u6027\u522b\u7f16\u7801\n     */\n    private Integer code;\n \n    GenderEnum(int code) {\n        this.code = code;\n    }\n \n}\n\npublic class IntegerToEnumConverter<T extends BaseEnum> implements Converter<Integer, T> {\n    private Map<Integer, T> enumMap = Maps.newHashMap();\n \n    public IntegerToEnumConverter(Class<T> enumType) {\n        T[] enums = enumType.getEnumConstants();\n        for (T e : enums) {\n            enumMap.put(e.getCode(), e);\n        }\n    }\n \n    @Override\n    public T convert(Integer source) {\n        T t = enumMap.get(source);\n        if (ObjectUtil.isNull(t)) {\n            throw new IllegalArgumentException("\u65e0\u6cd5\u5339\u914d\u5bf9\u5e94\u7684\u679a\u4e3e\u7c7b\u578b");\n        }\n        return t;\n    }\n}\n//\u521b\u5efa\u5bf9\u5e94\u7684\u81ea\u5b9a\u4e49 ConverterFactory \u5de5\u5382\u7c7b\npublic class IntegerCodeToEnumConverterFactory implements ConverterFactory<Integer, BaseEnum> {\n    private static final Map<Class, Converter> CONVERTERS = Maps.newHashMap();\n \n    /**\n     * \u83b7\u53d6\u4e00\u4e2a\u4ece Integer \u8f6c\u5316\u4e3a T \u7684\u8f6c\u6362\u5668\uff0cT \u662f\u4e00\u4e2a\u6cdb\u578b\uff0c\u6709\u591a\u4e2a\u5b9e\u73b0\n     *\n     * @param targetType \u8f6c\u6362\u540e\u7684\u7c7b\u578b\n     * @return \u8fd4\u56de\u4e00\u4e2a\u8f6c\u5316\u5668\n     */\n    @Override\n    public <T extends BaseEnum> Converter<Integer, T> getConverter(Class<T> targetType) {\n        Converter<Integer, T> converter = CONVERTERS.get(targetType);\n        if (converter == null) {\n            converter = new IntegerToEnumConverter<>(targetType);\n            CONVERTERS.put(targetType, converter);\n        }\n        return converter;\n    }\n}\n// \u6ce8\u518c\u5de5\u5382\n@Configuration\npublic class WebMvcConfig implements WebMvcConfigurer {\n \n    /**\n     * \u679a\u4e3e\u7c7b\u7684\u8f6c\u6362\u5668\u5de5\u5382 addConverterFactory\n     */\n    @Override\n    public void addFormatters(FormatterRegistry registry) {\n        registry.addConverterFactory(new IntegerCodeToEnumConverterFactory());\n        registry.addConverterFactory(new StringCodeToEnumConverterFactory());\n    }\n}\n')),(0,i.kt)("h2",{id:"147-\u8fd4\u56de\u56fe\u7247"},"14.7. \u8fd4\u56de\u56fe\u7247"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Controller\n@RequestMapping(value = "/image")\npublic class ImageController {\n    @RequestMapping(value = "/get")\n    @ResponseBody\n    public void getImage(HttpServletResponse response) throws IOException {\n        File file = new File("D:/test.jpg");\n        FileInputStream inputStream = new FileInputStream(file);\n        byte[] bytes = new byte[inputStream.available()];\n        \n        response.setContentType("image/jpeg");\n        OutputStream out = response.getOutputStream();\n       out.write(result);\n       out.flush();\n       //\u5173\u95ed\u54cd\u5e94\u8f93\u51fa\u6d41\n       out.close();\n       \n    }\n}\n\n\n\n \n@Controller\n@RequestMapping(value = "/image")\npublic class ImageController {\n    @RequestMapping(value = "/get",produces = MediaType.IMAGE_JPEG_VALUE) //\u5982\u679c\u662f\u7f51\u9875\u7684\u8bdd\uff0cproduces = MediaType.TEXT_HTML\n    @ResponseBody\n    public byte[] getImage() throws IOException {\n        File file = new File("D:/test.jpg");\n        FileInputStream inputStream = new FileInputStream(file);\n        byte[] bytes = new byte[inputStream.available()];\n        inputStream.read(bytes, 0, inputStream.available());\n        return bytes;\n    }\n}\n')),(0,i.kt)("h2",{id:"148-rest-api-\u6587\u6863"},"14.8. rest api \u6587\u6863"),(0,i.kt)("h3",{id:"1481-knife4j"},"14.8.1. knife4j"),(0,i.kt)("h3",{id:"1482-springdoc-openapi"},"14.8.2. springdoc-openapi"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://springdoc.org/"},"https://springdoc.org/")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.baeldung.com/spring-rest-openapi-documentation"},"https://www.baeldung.com/spring-rest-openapi-documentation")),(0,i.kt)("h3",{id:"1483-swagger3"},"14.8.3. swagger3"),(0,i.kt)("p",null,"\u8bbf\u95ee /swagger-ui.html or /swagger-ui/index.html (springdoc.swagger-ui.path=/swagger-ui.html)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n     <groupId>io.springfox</groupId>\n      <artifactId>springfox-boot-starter</artifactId>\n      <version>3.0.0</version>\n</dependency>\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@EnableOpenApi\n@SpringBootApplication\n@MapperScan(basePackages = {"cn.ruiyeclub.dao"})\npublic class Swagger3Application {\n    public static void main(String[] args) {\n        SpringApplication.run(Swagger3Application.class, args);\n    }\n}\n\n\n@Configuration\npublic class Swagger3Config {\n    @Bean\n    public Docket createRestApi() {\n        return new Docket(DocumentationType.OAS_30)\n                .apiInfo(apiInfo())\n                .select()\n                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))\n                .paths(PathSelectors.any())\n                .build()\n                // \u534f\u8bae\u4f7f\u7528 http; \u9ed8\u8ba4\u662f https\n                .protocols(Stream.of("http").collect(Collectors.toSet()));\n    }\n\n    private ApiInfo apiInfo() {\n        return new ApiInfoBuilder()\n                .title("Swagger3\u63a5\u53e3\u6587\u6863")\n                .version("1.0")\n                .build();\n    }\n}\n\n')),(0,i.kt)("h3",{id:"1484-\u96c6\u6210swagger2"},"14.8.4. \u96c6\u6210swagger2"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"http://springfox.github.io/springfox/docs/snapshot/#springfox-spring-mvc-and-spring-boot"},"http://springfox.github.io/springfox/docs/snapshot/#springfox-spring-mvc-and-spring-boot")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"swagger2\u914d\u7f6e\u7c7b\uff0c\u548cAPP\u542f\u52a8\u7c7b\u540c\u7ea7\uff0c@Configuration\uff0c@EnableSwagger2"),(0,i.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\uff1ahttp://localhost:8080/swagger-ui.html"),(0,i.kt)("li",{parentName:"ul"},"\u914d\u7f6emvc\u65f6\u5019\uff0c \u5982\u679c\u7ee7\u627f\u4e86WebMvcConfigurationSupport\uff0c \u9700\u8981\u91cd\u65b0\u6ce8\u5165\u8d44\u6e90\u6587\u4ef6\uff0c \u5426\u5219\u8bbf\u95ee\u4e0d\u5230swagger-ui.html;(",(0,i.kt)("a",{parentName:"li",href:"https://blog.csdn.net/zjcjava/article/details/78064264"},"ref"),")"),(0,i.kt)("li",{parentName:"ul"},"\u5206\u73af\u5883\u5f00\u542f ",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},'\u5728\u914d\u7f6e\u7c7b\u4e0a\u6807\u6ce8 @Profile({"dev","test"})'),(0,i.kt)("li",{parentName:"ul"},"\u6216\u8005 \u5728new Docket\u91cc\u6dfb\u52a0.Enable(true/false)\u65b9\u6cd5"))),(0,i.kt)("li",{parentName:"ul"},"springfox.documentation.swagger-ui.enabled=false \u751f\u4ea7 env \u4e0b close")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- \u4f1a\u5f15\u5165 \u8c37\u6b4c\u7684 guava --\x3e\n\x3c!-- \u7248\u672c\u53ef\u7701\u7565 --\x3e\n<dependency>\n            <groupId>io.springfox</groupId>\n            <artifactId>springfox-swagger2</artifactId>\n            <version>2.6.1</version>\n        </dependency>\n        <dependency>\n            <groupId>io.springfox</groupId>\n            <artifactId>springfox-swagger-ui</artifactId>\n            <version>2.6.1</version>\n        </dependency>\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n@Configuration\n@EnableSwagger2\npublic class Swagger2Config {\n    // \u6dfb\u52a0 swagger \u9759\u6001\u8d44\u6e90\u5904\u7406\n    // \u4e00\u822c\u6211\u4eec\u4f1a\u8bbe\u7f6e mvc \u4e2d, spring.resources.add-mappings=false, \u5bf9\u9759\u6001\u8d44\u6e90\u9ed8\u8ba4\u4e0d\u5904\u7406, \u8fd9\u662f\u9700\u8981\u4e3a swagger \u6dfb\u52a0\u4f8b\u5916 (\u8fd8\u4f1a\u8bbe\u7f6e spring.mvc.throw-exception-if-no-handler-found=true \u6ca1\u627e\u5230 Handler\u65f6\u76f4\u63a5\u629b\u51fa\u5f02\u5e38)\n//    @Bean\n//    public WebMvcConfigurer swaggerPassConfigure() {\n//        return new WebMvcConfigurer() {\n//            @Override\n//            public void addResourceHandlers(ResourceHandlerRegistry registry) {\n//                registry.addResourceHandler("swagger-ui.html")\n//                        .addResourceLocations("classpath:/META-INF/resources/", "/static", "/public");\n//\n//                registry.addResourceHandler("/webjars/**")\n//                        .addResourceLocations("classpath:/META-INF/resources/webjars/");\n//            }\n//        };\n//    }\n\n    @Bean\n    public Docket api() {\n\n        ParameterBuilder ticketPar = new ParameterBuilder();\n        List<Parameter> pars = new ArrayList<>();\n        ticketPar.name("Access-Token").description("Rest\u63a5\u53e3\u6743\u9650\u8ba4\u8bc1token,\u65e0\u9700\u9274\u6743\u53ef\u4e3a\u7a7a")\n                .modelRef(new ModelRef("string")).parameterType("header")\n                //header\u4e2d\u7684ticket\u53c2\u6570\u975e\u5fc5\u586b\uff0c\u4f20\u7a7a\u4e5f\u53ef\u4ee5\n                .required(false).build();\n        //\u6839\u636e\u6bcf\u4e2a\u65b9\u6cd5\u540d\u4e5f\u77e5\u9053\u5f53\u524d\u65b9\u6cd5\u5728\u8bbe\u7f6e\u4ec0\u4e48\u53c2\u6570\n        pars.add(ticketPar.build());\n\n\n        return new Docket(DocumentationType.SWAGGER_2)\n                .apiInfo(apiInfo())\n                .select()\n                // \u6839\u636e\u5305\u540d\u626b\u63cfcontroller\n                // \u81ea\u884c\u4fee\u6539\u4e3a\u81ea\u5df1\u7684\u5305\u8def\u5f84\n                .apis(RequestHandlerSelectors.basePackage("com.tgpms")) // \u591a\u5305\u914d\u7f6e: https://www.jianshu.com/p/78309feb5d5a\n                // \u626b\u63cf\u6240\u6709controller\n                // .apis(RequestHandlerSelectors.any()) \n                // \u6307\u5b9a\u626b\u63cf\u90e8\u5206\u6ce8\u89e3\u6807\u6ce8\u7684 controller\n                // .apis(RequestHandlerSelectors.withMethodAnnotation(Api.class/ApiOperation.class))\n\n                .paths(PathSelectors.any()) // .paths() \u8fd9\u4e2a\u662f\u5305\u8def\u5f84\u4e0b\u7684\u8def\u5f84,PathSelectors.any()\u662f\u5305\u4e0b\u6240\u6709\u8def\u5f84                \n                .build()\n                // \u5168\u5c40\u8bbe\u7f6e\u8bf7\u6c42\u53c2\u6570\n                .globalOperationParameters(pars);\n        \n\n        //\u751f\u6210\u5168\u5c40\u901a\u7528\u53c2\u6570\n    // private List<RequestParameter> getGlobalRequestParameters() {\n    //     List<RequestParameter> parameters = new ArrayList<>();\n    //     parameters.add(new RequestParameterBuilder()\n    //             .name("appid")\n    //             .description("\u5e73\u53f0id")\n    //             .required(true)\n    //             .in(ParameterType.QUERY)\n    //             .query(q -> q.model(m -> m.scalarModel(ScalarType.STRING)))\n    //             .required(false)\n    //             .build());\n    //     parameters.add(new RequestParameterBuilder()\n    //             .name("udid")\n    //             .description("\u8bbe\u5907\u7684\u552f\u4e00id")\n    //             .required(true)\n    //             .in(ParameterType.QUERY)\n    //             .query(q -> q.model(m -> m.scalarModel(ScalarType.STRING)))\n    //             .required(false)\n    //             .build());\n    //     parameters.add(new RequestParameterBuilder()\n    //             .name("version")\n    //             .description("\u5ba2\u6237\u7aef\u7684\u7248\u672c\u53f7")\n    //             .required(true)\n    //             .in(ParameterType.QUERY)\n    //             .query(q -> q.model(m -> m.scalarModel(ScalarType.STRING)))\n    //             .required(false)\n    //             .build());\n    //      return parameters;\n    // }\n\n    // //\u751f\u6210\u901a\u7528\u54cd\u5e94\u4fe1\u606f\n    // private List<Response> getGlobalResonseMessage() {\n    //     List<Response> responseList = new ArrayList<>();\n    //     responseList.add(new ResponseBuilder().code("404").description("\u627e\u4e0d\u5230\u8d44\u6e90").build());\n    //      return responseList;\n    // }\n    }\n\n    private ApiInfo apiInfo() {\n        return new ApiInfoBuilder()\n                .title("online exam by springboot")\n                .description("\u5728\u7ebf\u8003\u8bd5\u7cfb\u7edf by \u6881\u5c71\u5e7f at 2020")\n                .termsOfServiceUrl("https://github.com/19920625lsg/spring-boot-online-exam")\n                .version("1.0")\n                .contact(new Contact("liangshanguang", "https://github.com/19920625lsg/spring-boot-online-exam", "liangshanguang2@gmail.com"))\n                .build();\n    }\n}\n\n\n\n\n\n@Api("\u6d4b\u8bd5\u7528\u4f8b1") on controller class, \n\n    @ApiOperation(value = "apiOperationSwaggerTest", notes = "apiOperationSwagger\u6d4b\u8bd5") on controller class method\n\n@ApiParam(name = "id", value = "id\u5165\u53c2", required = true) on method params\n\n@ApiModel(description = "\u6d4b\u8bd5\u5b9e\u4f53\u7c7b", value = "\u6d4b\u8bd5\u5b9e\u4f53\u7c7b") on data model class\n\n    @ApiModelProperty(name = "userName", value = "\u7528\u6237\u540d", required = false, exmaple = "\u5c0f\u660e") on data module class field\n\n@ApiImplicitParams({@ApiImplicitParam(name = "id", value = "id\u5165\u53c2", required = true, dataType = "Integer", paramType = "query"),\n                        @ApiImplicitParam(name = "brand", value = "brand", required = true, dataType = "BRAND", paramType = "body")\n    }) on controller class method\n@ApiImplicitParams\uff1a\u7528\u5728\u8bf7\u6c42\u7684\u65b9\u6cd5\u4e0a\uff0c\u8868\u793a\u4e00\u7ec4\u53c2\u6570\u8bf4\u660e\n    @ApiImplicitParam\uff1a\u7528\u5728@ApiImplicitParams\u6ce8\u89e3\u4e2d\uff0c\u6307\u5b9a\u4e00\u4e2a\u8bf7\u6c42\u53c2\u6570\u7684\u5404\u4e2a\u65b9\u9762\n        name\uff1a\u53c2\u6570\u540d\n        value\uff1a\u53c2\u6570\u7684\u6c49\u5b57\u8bf4\u660e\u3001\u89e3\u91ca\n        required\uff1a\u53c2\u6570\u662f\u5426\u5fc5\u987b\u4f20\n        paramType\uff1a\u53c2\u6570\u653e\u5728\u54ea\u4e2a\u5730\u65b9\n            \xb7 header --\x3e \u8bf7\u6c42\u53c2\u6570\u7684\u83b7\u53d6\uff1a@RequestHeader\n            \xb7 query --\x3e \u8bf7\u6c42\u53c2\u6570\u7684\u83b7\u53d6\uff1a@RequestParam\n            \xb7 path\uff08\u7528\u4e8erestful\u63a5\u53e3\uff09--\x3e \u8bf7\u6c42\u53c2\u6570\u7684\u83b7\u53d6\uff1a@PathVariable\n            \xb7 body\uff08\u4e0d\u5e38\u7528\uff09\n            \xb7 form\uff08\u4e0d\u5e38\u7528\uff09    \n        dataType\uff1a\u53c2\u6570\u7c7b\u578b\uff0c\u9ed8\u8ba4String\uff0c\u5176\u5b83\u503cdataType="Integer"       \n        defaultValue\uff1a\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\n')),(0,i.kt)("h2",{id:"149-\u8fc7\u6ee4\u5668-\u548c-\u62e6\u622a\u5668"},"14.9. \u8fc7\u6ee4\u5668 \u548c \u62e6\u622a\u5668"),(0,i.kt)("h3",{id:"1491-\u533a\u522b"},"14.9.1. \u533a\u522b"),(0,i.kt)("p",null,"servlet filter\u548cspring mvc Interceptor\u533a\u522b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Filter \u662f\u57fa\u4e8e \u51fd\u6570\u56de\u8c03\u7684\uff0c\u800c Interceptor \u5219\u662f\u57fa\u4e8e Java \u53cd\u5c04 \u548c \u52a8\u6001\u4ee3\u7406\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Filter \u4f9d\u8d56\u4e8e Servlet \u5bb9\u5668, \u548cservlet\u5bb9\u5668\u9694\u7684\u8fd1\uff0c\u800c Interceptor \u4f9d\u8d56springmvc, \u548c\u5e94\u7528\u9694\u7684\u8fd1, \u5728\u6700\u91cc\u5c42\u3002\u6240\u4ee5filter \u5148\u8fdb\u5165, \u6700\u540e\u9000\u51fa")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Filter \u5bf9\u51e0\u4e4e \u6240\u6709\u7684\u8bf7\u6c42 \u8d77\u4f5c\u7528\uff0c\u800c Interceptor \u53ea\u5bf9 Controller \u8bf7\u6c42\u8d77\u4f5c\u7528\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u62e6\u622a\u5668\u53ef\u4ee5\u83b7\u53d6IOC\u5bb9\u5668\u4e2d\u7684\u5404\u4e2abean\uff0c\u800c\u8fc7\u6ee4\u5668\u5c31\u4e0d\u884c\uff0c\u8fd9\u70b9\u5f88\u91cd\u8981\uff0c\u5728\u62e6\u622a\u5668\u91cc\u6ce8\u5165\u4e00\u4e2aservice\uff0c\u53ef\u4ee5\u8c03\u7528\u4e1a\u52a1\u903b\u8f91\u3002"))),(0,i.kt)("h3",{id:"1492-\u4f7f\u7528-filter"},"14.9.2. \u4f7f\u7528 filter"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'scenario 1:\n\u76f4\u63a5\u5b9e\u73b0Filter\u63a5\u53e3\uff0c\u5e76\u4f7f\u7528@Component, \u62e6\u622a\u6240\u6709\u8def\u5f84 "/*", \u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u6ce8\u5165 bean\n\n\nscenario 2:\n\u5b9e\u73b0Filter\u63a5\u53e3\uff0c\u7528@WebFilter\u6ce8\u89e3\uff0c\u6307\u5b9a\u62e6\u622a\u8def\u5f84\u4ee5\u53ca\u4e00\u4e9b\u53c2\u6570\uff0c\u540c\u65f6\u9700\u8981\u5728\u542f\u52a8\u7c7b\u4f7f\u7528@ServletComponentScan\u626b\u63cf\u5e26@WebFilter\u3001@WebServlet\u3001@WebListener, \n\u8fd9\u79cd\u65b9\u5f0f\u65e0\u6cd5\u6ce8\u5165 bean, \u9664\u975e \u548c @component \u4e00\u8d77\u4f7f\u7528, \u4f46\u662f\u9700\u8981\u914d\u7f6e\u8986\u76d6 bean\n#\u542f\u7528\u8986\u76d6\u540c\u540dbean\nspring.main.allow-bean-definition-overriding=true\n\nscenario 3:\n@Configuration\npublic class MyFilterConfig {\n    @Autowired\n    MyFilter myFilter;\n    @Bean\n    public FilterRegistrationBean<MyFilter> thirdFilter() { // \u6cdb\u578b\u6307\u5b9a filter \u7c7b\u578b, so \u591a\u4e2a filter \u6bcf\u4e2a\u90fd\u8981\u4e00\u4e2a bean \u65b9\u6cd5\n        FilterRegistrationBean<MyFilter> filterRegistrationBean = new FilterRegistrationBean<>();\n        filterRegistrationBean.setOrder(2)\n        filterRegistrationBean.setFilter(myFilter);\n\n        filterRegistrationBean.setUrlPatterns(new ArrayList<>(Arrays.asList("/api/*")));\n\n        return filterRegistrationBean;\n    }\n}\n\n\n\u548c \u8fd9\u91cc\u7684 filter \u4e0d\u540c, \u8fd9\u91cc\u662f\u4e3a\u4e86\u8fc7\u6ee4 \u626b\u63cf\n@ComponentScan(value="com.wxj",excludeFilters= {\n        @Filter(type=FilterType.ANNOTATION,classes= {Controller.class})\n})\n')),(0,i.kt)("h3",{id:"1493-\u4f7f\u7528-interceptor"},"14.9.3. \u4f7f\u7528 interceptor"),(0,i.kt)("h4",{id:"14931-\u57fa\u672c\u4f7f\u7528\u62e6\u622a\u5668"},"14.9.3.1. \u57fa\u672c\u4f7f\u7528\u62e6\u622a\u5668"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.baeldung.com/spring-mvc-handlerinterceptor"},"https://www.baeldung.com/spring-mvc-handlerinterceptor")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\u5b9e\u73b0 HandlerInterceptor \u63a5\u53e3,\n@component\nclass InterfaceAuthCheckInterceptor implements HandlerInterceptor {\n\n        private Logger logger = LoggerFactory.getLogger(getClass());\n\n        @Autowired\n        StringRedisTemplate stringRedisTemplate;\n\n        ...\n\n\n  // \u914d\u7f6e      \n@Configuration\npublic class InterceptorConfig implements WebMvcConfigurer { // WebMvcConfigurerAdapter \u8fc7\u65f6, WebMvcConfigurationSupport, \u5bf9\u4e8e classpath:/META/resources/\uff0cclasspath:/resources/\uff0cclasspath:/static/\uff0cclasspath:/public/\uff09\u4e0d\u751f\u6548, \u6240\u4ee5\u9009\u62e9WebMvcConfigurer \u6700\u597d\n\n    @autowire\n    .... interceptor\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        // \u591a\u4e2a\u62e6\u622a\u5668\u7ec4\u6210\u4e00\u4e2a\u62e6\u622a\u5668\u94fe, \u52a0\u5165\u7684\u987a\u5e8f\u5c31\u662f\u62e6\u622a\u5668\u6267\u884c\u7684\u987a\u5e8f, \u4e5f\u53ef\u4f7f\u7528 @order(-1/0/1...)\u6307\u5b9a\n        // addPathPatterns \u7528\u4e8e\u6dfb\u52a0\u62e6\u622a\u89c4\u5219, \u9ed8\u8ba4\u62e6\u622a\u6240\u6709 \u5373 /**\n        // excludePathPatterns \u7528\u6237\u6392\u9664\u62e6\u622a\n        registry.addInterceptor(interceptor).addPathPatterns("/api/**").exclude("...");\n        \n    }\n\n')),(0,i.kt)("h4",{id:"14932-\u57fa\u4e8e-url-\u62e6\u622a"},"14.9.3.2. \u57fa\u4e8e url \u62e6\u622a"),(0,i.kt)("p",null,'\u4e00\u79cd\u65b9\u5f0f\u662f \u5728\u914d\u7f6e\u4e2d registry.addInterceptor(interceptor).addPathPatterns("/api/**").exclude("...");'),(0,i.kt)("p",null,"\u4e00\u79cd\u662f\u76f4\u63a5\u5728 prehandle() \u4e2d\u5904\u7406 String path = request.getServletPath(), path.matches(Const.NO_INTERCEPTOR_PATH \u5c31\u662f\u57fa\u4e8e\u6b63\u5219\u5339\u914d\u7684url "),(0,i.kt)("h4",{id:"14933-\u57fa\u4e8e\u6ce8\u89e3\u62e6\u622a"},"14.9.3.3. \u57fa\u4e8e\u6ce8\u89e3\u62e6\u622a"),(0,i.kt)("p",null,"interceptor \u4e5f\u5c5e\u4e8e aop, "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class AuthorityInterceptor extends HandlerInterceptorAdapter{\n    \n     @Override\n     public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        // \u5982\u679c\u4e0d\u662f\u6620\u5c04\u5230\u65b9\u6cd5\u76f4\u63a5\u901a\u8fc7\n        if (!(handler instanceof HandlerMethod)) {\n            return true;\n        }\n        // \u2460:START \u65b9\u6cd5\u6ce8\u89e3\u7ea7\u62e6\u622a\u5668\n        HandlerMethod handlerMethod = (HandlerMethod) handler;\n        Method method = handlerMethod.getMethod();\n        // \u5224\u65ad\u63a5\u53e3\u662f\u5426\u9700\u8981\u767b\u5f55\n        LoginRequired methodAnnotation = method.getAnnotation(LoginRequired.class);\n        // \u6709 @LoginRequired \u6ce8\u89e3\uff0c\u9700\u8981\u8ba4\u8bc1\n        if (methodAnnotation != null) {\n            // \u8fd9\u5199\u4f60\u62e6\u622a\u9700\u8981\u5e72\u7684\u4e8b\u513f\uff0c\u6bd4\u5982\u53d6\u7f13\u5b58\uff0cSESSION\uff0c\u6743\u9650\u5224\u65ad\u7b49\n            System.out.println("====================================");\n            return true;\n        }\n        return true;\n    }\n}\n\n')),(0,i.kt)("h2",{id:"1410-servlet-druid-\u76d1\u63a7"},"14.10. servlet Druid \u76d1\u63a7"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class DruidConfig {\n\n    @ConfigurationProperties(prefix = "spring.datasource")\n    @Bean\n    public DataSource druid(){\n        return  new DruidDataSource();\n    }\n\n    //\u914d\u7f6eDruid\u7684\u76d1\u63a7\n    //1\u3001\u914d\u7f6e\u4e00\u4e2a\u7ba1\u7406\u540e\u53f0\u7684Servlet\n    @Bean\n    public ServletRegistrationBean statViewServlet(){\n        ServletRegistrationBean bean = new ServletRegistrationBean(new StatViewServlet(), "/druid/*");\n        Map<String,String> initParams = new HashMap<>();\n\n        initParams.put("loginUsername","admin");\n        initParams.put("loginPassword","123456");\n        initParams.put("allow","");//\u9ed8\u8ba4\u5c31\u662f\u5141\u8bb8\u6240\u6709\u8bbf\u95ee\n        initParams.put("deny","192.168.15.21");\n\n        bean.setInitParameters(initParams);\n        return bean;\n    }\n\n\n    //2\u3001\u914d\u7f6e\u4e00\u4e2aweb\u76d1\u63a7\u7684filter\n    @Bean\n    public FilterRegistrationBean webStatFilter(){\n        FilterRegistrationBean bean = new FilterRegistrationBean();\n        bean.setFilter(new WebStatFilter());\n\n        Map<String,String> initParams = new HashMap<>();\n        initParams.put("exclusions","*.js,*.css,/druid/*");\n\n        bean.setInitParameters(initParams);\n\n        bean.setUrlPatterns(Arrays.asList("/*"));\n\n        return  bean;\n    }\n}\n\n')),(0,i.kt)("h2",{id:"1411-aop-\u6574\u5408\u4f7f\u7528"},"14.11. aop \u6574\u5408\u4f7f\u7528"),(0,i.kt)("h3",{id:"14111-\u57fa\u672c\u4f7f\u7528"},"14.11.1. \u57fa\u672c\u4f7f\u7528"),(0,i.kt)("p",null,"\u901a\u77e5\u6267\u884c\u987a\u5e8f: around > before > around > after > afterReturning"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// \u53ea\u9700\u8981spring-boot-starter-aop\n//@EnableAspectJAutoProxy// \u65e0\u9700, \u81ea\u52a8\u5f00\u542f,\u5f15\u5165\u4f9d\u8d56\u540e\n\n@Component //\u5fc5\u987b\n@Aspect\npublic class ReqCheckAop {\n\n    @Autowired\n    private ObjectMapper objectMapper;\n\n    @Pointcut("execution(org.springframework.http.ResponseEntity<Resp> io.github.xiaoyureed.demo..*.*(..))")\n    private void pointcut() {}\n\n    @Around("pointcut()")\n    public Object reqCheck(ProceedingJoinPoint jp) throws Throwable {\n        Object[] args = jp.getArgs();\n        System.out.println(">>> req = " + objectMapper.writeValueAsString(args[0]));\n        return jp.proceed();\n    }\n}\n')),(0,i.kt)("h3",{id:"14112-\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"},"14.11.2. \u5207\u5165\u70b9\u8868\u8fbe\u5f0f"),(0,i.kt)("p",null,"\u7528\u6765\u6307\u5b9a\u589e\u5f3a\u54ea\u4e9b\u65b9\u6cd5"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/ityangshuai/p/11923696.html"},"https://www.cnblogs.com/ityangshuai/p/11923696.html")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'1.execution(xxx)  \u7528\u4e8e\u786e\u5b9a\u65b9\u6cd5\n    \u8868\u8fbe\u5f0f\u683c\u5f0f(\u5c31\u662f\u65b9\u6cd5\u7b7e\u540d)\uff1a\u4fee\u9970\u7b26  \u8fd4\u56de\u503c  \u5305.\u7c7b.\u65b9\u6cd5(\u53c2\u6570\u5217\u8868) throws \u5f02\u5e38\n        1.1 \u4fee\u9970\u7b26 \uff08\u53ef\u9009\uff09\uff0c\u4e00\u822c\u4e0d\u4f7f\u7528 ----------- \u63a5\u7a7a\u683c\n            public        \u516c\u5171\u4fee\u9970\u7b26\n            *            \u4efb\u610f\u4fee\u9970\u7b26\n        1.2 \u8fd4\u56de\u503c\uff0c \u590d\u6742\u7c7b\u578b\u9700\u8981\u5168\u9650\u5b9a\u540d\u79f0\uff0c\u5e38\u7528 ----------- \u63a5\u7a7a\u683c\n            String        \u8fd4\u56de\u5b57\u7b26\u4e32\n            *            \u8fd4\u56de\u4efb\u610f\n        1.3 \u5305    \uff0c\u5e38\u7528\n            com.xiaoyu.spring.learn.service            \u6307\u5b9aservice\u5305\n            com.xiaoyu.spring.learn.crm.*.service                crm\u9879\u76ee\u4e0b\u7684\u4efb\u610f\u5b50\u6a21\u5757\uff08\u5b50\u6587\u4ef6\u5939\uff09\u7684service\u5305\n            com.xiaoyu.spring.learn.service..            service\u76ee\u5f55\u5305\u542b\u7684\u6240\u6709\u76ee\u5f55\uff08\u5305\u62ec\u6b21\u7ea7\u5b50\u76ee\u5f55\u7b49\u7b49\uff09\n            com.xiaoyu.spring.learn.crm.*.service..                crm\u4e0b\u6240\u6709\u7684\u5b50\u6a21\u5757\u4e2dservice\u76ee\u5f55\u5305\u542b\u7684\u6240\u6709\u76ee\u5f55\n        1.4 \u7c7b\uff0c\u5e38\u7528\n            UserService                \u6307\u5b9a\u7c7b\u540d\n            User*                    \u4ee5User\u5f00\u5934\u7c7b\n            *Service                    \u4ee5Service\u7ed3\u5c3e\u7c7b\uff08\u5e38\u7528\uff09\n            *                        \u4efb\u610f\u7c7b\n        1.5 \u65b9\u6cd5\uff0c\u5e38\u7528 \u4e0e 1.4\u7c7b\u76f8\u4f3c\n            addUser                    \u6307\u5b9a\u65b9\u6cd5\n            add*                        add\u5f00\u5934\u65b9\u6cd5\n            *User                    \u4ee5User\u7ed3\u5c3e\u65b9\u6cd5\n            *                        \u4efb\u610f\u65b9\u6cd5\n        1.6 \u53c2\u6570\u5217\u8868\uff0c\u5e38\u7528\n            ()                        \u6ca1\u6709\u53c2\u6570\n            (int)                        \u4e00\u4e2a\u53c2\u6570\n            (int,int)                    \u4e24\u4e2a\u53c2\u6570\n            (..)                        \u53c2\u6570\u4efb\u610f\n        1.7 \u5f02\u5e38 \uff0c\u5177\u4f53\u5f02\u5e38\uff08\u53ef\u9009\uff09\n\n    \u591a\u8868\u8fbe\u5f0f\uff1a\n        <aop:pointcut experssion="exection(\u8868\u8fbe\u5f0f1)  || exection(\u8868\u8fbe\u5f0f2) ">    \uff1a\u8868\u8fbe\u5f0f1\u6216 \u8868\u8fbe\u5f0f2\n    \u7efc\u5408\u6848\u4f8b\uff1aexecution(* com.xiaoyu.spring.learn.crm.*.service..*.*(..))\n        \u542b\u4e49\uff1a    \u8fd4\u56de\u503c\u4efb\u610f\uff0ccrm\u9879\u76ee\u4e0b\u7684\u4efb\u610f\u5b50\u76ee\u5f55\u4e2d\u7684\u7684service\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u76ee\u5f55\u4e2d\u7684\u4efb\u610f\u7c7b\u7684\u4efb\u610f\u65b9\u6cd5\uff0c\u53c2\u6570\u4efb\u610f\u3002\n\n- within(): \u53ea\u80fd\u6307\u5b9a \u5305.\u7c7b; \u518d\u4e0b\u9762\u7684\u7c92\u5ea6\u5c31\u6ca1\u529e\u6cd5\u4e86, \u6240\u4ee5\u76f8\u5f53\u4e8e execution() \u7684\u7b80\u5316\u7248\n    within(com.xiaoyu.spring.learn.aop..*)\u5339\u914daop \u5305/\u5b50\u5305\u4e0b\u7684\u6240\u6709\u7c7b\u7684\u6240\u6709\u65b9\u6cd5\n\n    \u6307\u5b9a\u6ce8\u89e3\u7c7b\u4ea6\u53ef\n    within(@org.springframework.web.bind.annotation.RestController *) \u5339\u914d \u88ab \u6307\u5b9a\u6ce8\u89e3\u6807\u6ce8\u7684\u6240\u6709\u7c7b\u7684\u6240\u6709\u65b9\u6cd5\n    \n- this(): \u7528\u4e8e\u5411\u901a\u77e5\u65b9\u6cd5\u4e2d\u4f20\u5165\u4ee3\u7406\u5bf9\u8c61\u7684\u5f15\u7528\n    \u5982:\n    @Before("before() && this(proxy)")\n    public void beforeAdvide(JoinPoint point, Object proxy){\n\n- target(): \u7528\u4e8e\u5411\u901a\u77e5\u65b9\u6cd5\u4e2d\u4f20\u5165\u76ee\u6807\u5bf9\u8c61\u7684\u5f15\u7528\n\n- args() \uff1a\u7528\u4e8e\u5c06\u53c2\u6570\u4f20\u5165\u5230\u901a\u77e5\u65b9\u6cd5\u4e2d\n    \u5982:\n    @Before("before() && args(age,username)")\n    public void beforeAdvide(JoinPoint point, int age, String username){\n    \u5982 \n    @Pointcut("execution(public * com.example.demo.aop.AopController.xxxMethod(int)) && args(point))") \u4f1a\u5c06\u62e6\u622a\u5230\u7684\u65b9\u6cd5\u7684 int \u7c7b\u578b\u53c2\u6570 \u4f20\u9012\u5230 aop \u65b9\u6cd5\u4e2d, \u4f7f\u7528 point \u63a5\u53d7\u5373\u53ef\n\n\n-------\n\n\n- @within \uff1a\u7528\u4e8e\u5339\u914d\u5728\u7c7b\u4e00\u7ea7\u4f7f\u7528\u4e86\u6ce8\u89e3\u7684\u7c7b\uff0c\u5176\u6240\u6709\u65b9\u6cd5\u90fd\u5c06\u88ab\u5339\u914d\n    @Pointcut("@within(com.cjm.annotation.AdviceAnnotation)") \uff0d \u6240\u6709\u88ab@AdviceAnnotation\u6807\u6ce8\u7684\u7c7b\u90fd\u5c06\u5339\u914d\n    \u5e38\u7528:\n    @Pointcut("@annotation(AopLog) || @within(AopLog)") - \u88ab aopLog \u6807\u6ce8\u7684\u7c7b or \u65b9\u6cd5\u88ab\u62e6\u622a\n\n- @target \uff1a\u548c@within\u7684\u529f\u80fd\u7c7b\u4f3c\uff0c\u4f46\u5fc5\u987b\u8981\u6307\u5b9a\u6ce8\u89e3\u7684\u4fdd\u7559\u7b56\u7565\u4e3aRUNTIME\u3002\n\n    \u5b58\u7591?@target() \u6307\u5b9a\u76ee\u6807\u7c7b\u578b, \u6240\u6709\u8fd9\u4e2a\u7c7b\u578b\u7684\u7c7b\u90fd\u4f1a\u88ab\u5339\u914d\n    @target(com.xiaoyu.spring.learn.aop.user.IUserDAO)\u5339\u914d IUserDAO \u7684\u6240\u6709\u5b9e\u73b0\u7c7b, \u7c7b\u4e2d\u7684\u65b9\u6cd5\u90fd\u4f1a\u88ab\u4ee3\u7406, \u5305\u62ec\u672a\u5728\u63a5\u53e3\u4e2d\u58f0\u660e\u7684\u65b9\u6cd5\n\n- @args() \u6307\u5b9a\u4e00\u4e2a\u6ce8\u89e3, \u8868\u793a\u8981\u62e6\u622a\u65b9\u6cd5\u7684\u53c2\u6570\u9700\u8981\u5e26\u6709\u8fd9\u4e2a\u6ce8\u89e3\n\n\n- @bean(id\u503c) \u5bf9\u6307\u5b9a\u7684\u76ee\u6807\u5bf9\u8c61\u7684\u7c7b\u8fdb\u884c\u5339\u914d\n\n- @annotation(\u53c2\u6570\u4e2d\u6ce8\u89e3\u53c2\u6570\u540d\u79f0) \u5339\u914d\u88ab\u6307\u5b9a\u6ce8\u89e3\u6807\u6ce8\u7684\u65b9\u6cd5\n\n    \u5982: \u4e0b\u9762\u8868\u793a -> \u5339\u914d web \u5305/\u5b50\u5305\u4e0b\u6240\u6709\u7c7b\u7684\u6240\u6709\u65b9\u6cd5 \u4e14\u65b9\u6cd5\u88ab @CheckReqNo \u6807\u6ce8 \n    \n    @Around("within(io.github.xiaoyureed.web..*) && @annotation(checkReqNo)")\n    public void xxx(JoinPoint jp, CheckReqNo checkReqNo)\n\n-  \u53ef\u4ee5\u4f7f\u7528 &&, ||, ! \u8fd0\u7b97\u7b26\u6765\u5b9a\u4e49\u5207\u70b9\u8868\u8fbe\u5f0f\n')),(0,i.kt)("h2",{id:"1412-controlleradvice-\u5f02\u5e38\u5904\u7406"},"14.12. @controllerAdvice \u5f02\u5e38\u5904\u7406"),(0,i.kt)("p",null,"\u5168\u5c40\u5f02\u5e38\u5904\u7406 \u5168\u5c40\u6570\u636e\u7ed1\u5b9a \u5168\u5c40\u8bf7\u6c42\u6570\u636e\u9884\u5904\u7406"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@ControllerAdvice //@ControllerAdvice\u6ce8\u89e3 \u53ef\u4ee5\u901a\u8fc7 assignableTypes \u6307\u5b9a\u7279\u5b9a\u7684\u7c7b\uff0c\u8ba9\u5f02\u5e38\u5904\u7406\u7c7b\u53ea\u5904\u7406\u7279\u5b9a\u7c7b\u629b\u51fa\u7684\u5f02\u5e38\npublic class MyGlobalExceptionHandler {\n    // \u76f4\u63a5\u8fd4\u56de web \u9875\u9762\n    @ExceptionHandler(Exception.class)\n    public ModelAndView customException(Exception e) {\n        ModelAndView mv = new ModelAndView();\n        mv.addObject("message", e.getMessage());\n        mv.setViewName("myerror");\n        return mv;\n    }\n\n    // \u8fd4\u56de json\n    @exception..\n    @respbody // \u5982\u679c\u7c7b\u4e0a\u4f7f\u7528\u7684\u662f@RestControllerAdvice, \u90a3\u4e48 \u8fd4\u56de json \u65e0\u9700 @ResponseBody, \u53ea\u9700\u8981 @ExceptionHandler\n    public respseentiyt xxx(Exception ex) {}\n\n\n    // \u7ed1\u5b9a md \u5230\u6bcf\u4e2a controler \u4e2d\u7684\u65b9\u6cd5\u53c2\u6570\u4e2d\n    @ModelAttribute(name = "md")\n    public Map<String,Object> mydata() {\n        HashMap<String, Object> map = new HashMap<>();\n        map.put("age", 99);\n        map.put("gender", "\u7537");\n        return map;\n    }\n    // controller \u4e2d\u8fd9\u4e48\u4f7f\u7528\n    @GetMapping("/hello")\n    public String hello(Model model) {// \u6216\u8005 @ModelAttribute("md") Map<String, Object> md\n        Map<String, Object> map = model.asMap();\n        System.out.println(map);\n        int i = 1 / 0;\n        return "hello controller advice";\n    }\n\n\n    // \u8bf7\u6c42\u6570\u636e\u9884\u5904\u7406\n    // \u5982\u6b64, \u8bf7\u6c42\u53c2\u6570\u5c31\u53ef\u4ee5\u4f20\u9012\u8fd9\u6837\u7684\u53c2\u6570: a.name=xxx, b.name=yyy\n    // controller \u4e2d\u8fd9\u6837\u83b7\u53d6 @ModelAttribute("b") Book book, @ModelAttribute("a") Author author\n    @InitBinder("b")\n    public void b(WebDataBinder binder) {\n        binder.setFieldDefaultPrefix("b.");\n    }\n    @InitBinder("a")\n    public void a(WebDataBinder binder) {\n        binder.setFieldDefaultPrefix("a.");\n    }\n}\n\n')),(0,i.kt)("p",null,"\u5904\u7406\u5f02\u5e38\u7684\u5176\u4ed6\u65b9\u6cd5:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@ExceptionHandler(value = Exception.class)// \u62e6\u622a\u6240\u6709\u5f02\u5e38\n    public ResponseEntity<ErrorResponse> exceptionHandler(Exception e) {\n\n        if (e instanceof IllegalArgumentException) {\n            return ResponseEntity.status(400).body(illegalArgumentResponse);\n        } else if (e instanceof ResourceNotFoundException) {\n            return ResponseEntity.status(404).body(resourseNotFoundResponse);\n        }\n        return null;\n    }\n\n\n\n@GetMapping("/resourceNotFoundException2")\n    public void throwException3() {\n        throw new ResponseStatusException(HttpStatus.NOT_FOUND, "Sorry, the resourse not found!", new ResourceNotFoundException());\n    }\n\n')),(0,i.kt)("h2",{id:"1413-httpservletrequest-\u7684\u8f93\u5165\u6d41\u53ea\u80fd\u8bfb\u53d6\u4e00\u6b21\u7684\u95ee\u9898"},"14.13. HttpServletRequest \u7684\u8f93\u5165\u6d41\u53ea\u80fd\u8bfb\u53d6\u4e00\u6b21\u7684\u95ee\u9898"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/JAYIT/p/10943155.html"},"https://www.cnblogs.com/JAYIT/p/10943155.html")),(0,i.kt)("p",null,"\u8fd8\u662f\u63a8\u8350\u4f7f\u7528 aop \u53bb\u5207 controller \u66f4\u65b9\u4fbf\u4e00\u70b9"),(0,i.kt)("h2",{id:"1414-\u8def\u7531\u5904\u7406"},"14.14. \u8def\u7531\u5904\u7406"),(0,i.kt)("h3",{id:"14141-\u9759\u6001\u8d44\u6e90\u6620\u5c04-\u66b4\u9732\u9759\u6001\u8d44\u6e90"},"14.14.1. \u9759\u6001\u8d44\u6e90\u6620\u5c04 \u66b4\u9732\u9759\u6001\u8d44\u6e90"),(0,i.kt)("p",null,"\u66b4\u9732\u56fe\u7247\u8d44\u6e90"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class ImageConfig implements WebMvcConfigure {\n\n    @Override\n    public void addResourceHandlers(ResourceHandlerRegistry registry) {\n        registry.addResourceHandler("/images/**") //addResourceLocations\u6307\u7684\u662f\u6587\u4ef6\u653e\u7f6e\u7684\u76ee\u5f55\uff0caddResoureHandler\u6307\u7684\u662f\u5bf9\u5916\u66b4\u9732\u7684\u8bbf\u95ee\u8def\u5f84\n                .addResourceLocations("file:./localdata/images/");\n    }\n}\n\n')),(0,i.kt)("p",null,"\u5206\u73af\u5883\u66b4\u9732\u914d\u7f6e\u6587\u4ef6"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n// \u914d\u7f6e\u6587\u4ef6\u8bbf\u95ee\u5730\u5740 (\u6ce8\u610f\u6bcf\u4e2a\u8bbf\u95ee\u8def\u5f84\u540e\u9762\u7684\u8def\u5f84\u52a0 / !!!)\n// ## windows\u7cfb\u7edf\u4e0b\u8bbf\u95ee\u8def\u5f84\n// uploadWindow: E:\\common\\file\\root\\\n// ## windows\u7cfb\u7edf\u4e0b\u8bbf\u95ee\u8def\u5f84\n// uploadLinux: /user/img/\n@Override\nprotected void addResourceHandlers(ResourceHandlerRegistry registry) {\n    String os = System.getProperty("os.name");\n\n    //\u5982\u679c\u662fWindows\u7cfb\u7edf\n    if (os.toLowerCase().startsWith("win")) {\n        registry.addResourceHandler("/app_file/**")\n                // /app_file/**\u8868\u793a\u5728\u78c1\u76d8filePathWindow\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u8d44\u6e90\u4f1a\u88ab\u89e3\u6790\u4e3a\u4ee5\u4e0b\u7684\u8def\u5f84\n                .addResourceLocations("file:" + filePathWindow);\n    } else {  //linux \u548cmac\n        registry.addResourceHandler("/app_file/**")\n                .addResourceLocations("file:" + filePathLinux) ;\n    }\n\n    super.addResourceHandlers(registry);\n}\n')),(0,i.kt)("p",null,"\u8fd8\u6709\u4e2a\u4f8b\u5b50, --\x3e swagger \u9759\u6001\u8d44\u6e90\u5904\u7406 (\u653e\u884c \u76f8\u5173\u7684\u9759\u6001\u9875\u9762)"),(0,i.kt)("h3",{id:"14142-\u6dfb\u52a0-view-controller"},"14.14.2. \u6dfb\u52a0 view controller"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\nclass MvcConfig implements WebMvcConfigurer {\n    /**\n     * \u6dfb\u52a0 view controller\n     * <p>\n     * \u5c06 url path \u548c template \u5bf9\u5e94, \u65e0\u9700\u6dfb\u52a0\u4efb\u4f55\u7684 controller \u4ee3\u7801\n     */\n    @Override\n    public void addViewControllers(ViewControllerRegistry registry) {\n        registry.addViewController("/home").setViewName("home");// \u7b49\u4ef7 \u8bbf\u95ee /home , controller \u8fd4\u56de "home"\n        registry.addViewController("/").setViewName("home");\n        registry.addViewController("/hello").setViewName("hello");\n        registry.addViewController("/login").setViewName("login");\n        registry.addViewController("/admin-page").setViewName("admin-page");\n    }\n}\n')),(0,i.kt)("h2",{id:"1415-spring-boot-starter-thymeleaf"},"14.15. spring-boot-starter-thymeleaf"),(0,i.kt)("p",null,"thymeleaf \u548c spring security \u914d\u5408\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"sec")," \u6807\u7b7e: ",(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/bb3a3b388c4e"},"https://www.jianshu.com/p/bb3a3b388c4e")),(0,i.kt)("p",null,"springboot\u9ed8\u8ba4  static/public \u4e2d\u653e\u9759\u6001\u9875\u9762\uff0c\u800ctemplates\u4e2d\u653e\u52a8\u6001\u9875\u9762\u5373 thymeleaf \u6a21\u677f"),(0,i.kt)("p",null,"\u9759\u6001\u9875\u9762: \u76f4\u63a5\u5728static\u653e\u4e00\u4e2ahello.html,\u7136\u540e\u76f4\u63a5\u8f93\u5165http://localhost:8080/hello.html \u4fbf\u80fd\u6210\u529f\u8bbf\u95ee (\u5173\u95ed\u8fd9\u4e2a\u7279\u6027\u9700\u8981 spring.resources.add-mappings: false), \u4e5f\u53ef\u4ee5\u901a\u8fc7controller\u8df3\u8f6c ",(0,i.kt)("inlineCode",{parentName:"p"},'return "hello.html";')),(0,i.kt)("p",null,"\u52a8\u6001\u9875\u9762: \u9700\u8981 ",(0,i.kt)("inlineCode",{parentName:"p"},"spring-boot-starter-thymeleaf"),', \u9759\u6001\u9875\u9762\u7684return\u9ed8\u8ba4\u662f\u8df3\u8f6c\u5230/static/index.html\uff0c\u5f53\u5728pom.xml\u4e2d\u5f15\u5165\u4e86thymeleaf\u7ec4\u4ef6\uff0c\u52a8\u6001\u8df3\u8f6c\u4f1a\u8986\u76d6\u9ed8\u8ba4\u7684\u9759\u6001\u8df3\u8f6c\uff0c\u9ed8\u8ba4\u5c31\u4f1a\u8df3\u8f6c\u5230/templates/index.html\uff0c\u6ce8\u610f\u770b\u4e24\u8005return\u4ee3\u7801\u4e5f\u6709\u533a\u522b\uff0c\u52a8\u6001\u6ca1\u6709html\u540e\u7f00, \u5982\u679c\u5728\u4f7f\u7528\u52a8\u6001\u9875\u9762\u65f6\u8fd8\u60f3\u8df3\u8f6c\u5230/static/index.html\uff0c\u53ef\u4ee5\u4f7f\u7528\u91cd\u5b9a\u5411return "redirect:/index.html"'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/Hi")\n    public String sayHello() {\n        return "hello";\n    }\n\n@RequestMapping("/Hi")\npublic ModelAndView sayHello() {\n    ModelAndView modelAndView = new ModelAndView();\n    modelAndView.setViewName("hello");\n    modelAndView.addObject("key", 12345);\n    //System.out.println("test");\n    return modelAndView;\n}\n\n@RequestMapping("/Hi")\npublic String sayHello(Map<String,obj> map) {\n    map.put("stu", new Stu())\n    return "hello";\n}\n')),(0,i.kt)("p",null,"\u914d\u7f6e:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"\n#spring\u914d\u7f6e\nspring:\n  mvc:\n    servlet:\n      load-on-startup: 1\n  datasource:\n    driver-class-name: com.mysql.jdbc.Driver\n    url: jdbc:mysql://localhost:3306/springbootssm?serverTimezone=GMT%2B8&useUnicode=true&characterEncoding=utf-8\n    username: root\n    password: 123456\n  thymeleaf:\n    cache: false #\u5173\u95ed\u7f13\u5b58\n    mode: HTML5 #\u8bbe\u7f6e\u6a21\u677f\u7c7b\u578b\n    encoding: utf-8  #\u8bbe\u7f6e\u7f16\u7801\n    prefix: classpath:/templates/\n    suffix: .html\n    content-type=text/html \n")),(0,i.kt)("h1",{id:"15-\u8fd0\u7ef4\u90e8\u7f72"},"15. \u8fd0\u7ef4\u90e8\u7f72"),(0,i.kt)("h2",{id:"151-\u652f\u6301-https-ssl"},"15.1. \u652f\u6301 https ssl"),(0,i.kt)("h3",{id:"1511-nginx-\u914d\u7f6e-https"},"15.1.1. nginx \u914d\u7f6e https"),(0,i.kt)("p",null,"Let's Encrypt \u6216\u8005\u963f\u91cc\u4e91, \u817e\u8baf\u4e91 \u652f\u6301 \u9762\u7c89 ssl \u8bc1\u4e66 , \u4e00\u5e74\u6709\u6548\u671f, \u8fc7\u671f\u518d\u6b21\u7533\u8bf7 "),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://segmentfault.com/a/1190000016760251"},"https://segmentfault.com/a/1190000016760251")," \u4f7f\u7528 lets encrypt \u914d\u7f6e nginx"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/to-red/p/12450616.html"},"https://www.cnblogs.com/to-red/p/12450616.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/chnmig/p/10343890.html"},"https://www.cnblogs.com/chnmig/p/10343890.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/fenglin0429/article/details/81347634"},"https://blog.csdn.net/fenglin0429/article/details/81347634"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://www.nonelonely.com/article/1584965619600"},"https://www.nonelonely.com/article/1584965619600")," nginx \u914d\u7f6e http  \u8f6chttps, \u4ee3\u7406 springboot\n",(0,i.kt)("a",{parentName:"p",href:"https://ask.csdn.net/questions/701009"},"https://ask.csdn.net/questions/701009")),(0,i.kt)("h3",{id:"1512-\u652f\u6301-https-\u8bbf\u95ee"},"15.1.2. \u652f\u6301 https \u8bbf\u95ee"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// \u5047\u8bbe\u5982\u4e0b\u7684 api, \u5e0c\u671b\u652f\u6301 https \u8bbf\u95ee, \u73b0\u5728\u4ec5\u4ec5\u53ea\u662fhttp\u8bbf\u95ee\u3002http://localhost:8080\n@RestController\n@SpringBootApplication\npublic class TestApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(TestApplication.class, args);\n    }\n    @RequestMapping(value = "/",produces = "text/plain;charset=UTF-8")\n    String index(){\n        return "Hello Spring Boot!";\n    }\n}\n\n\n//\u751f\u6210ssl\u8bc1\u4e66, \u7cfb\u7edf\u7684\u5f53\u524d\u7528\u6237\u76ee\u5f55\u4e0b\u4f1a\u751f\u6210\u4e00\u4e2akeystore.p12\u6587\u4ef6, \u5c06keystore.p12\u6587\u4ef6\u62f7\u8d1d\u5230\u6211\u4eec\u9879\u76ee\u7684\u6839\u8def\u5f84\u4e0b\n// 1.-storetype \u6307\u5b9a\u5bc6\u94a5\u4ed3\u5e93\u7c7b\u578b\n// 2.-keyalg \u751f\u8bc1\u4e66\u7684\u7b97\u6cd5\u540d\u79f0\uff0cRSA\u662f\u4e00\u79cd\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\n// 3.-keysize \u8bc1\u4e66\u5927\u5c0f\n// 4.-keystore \u751f\u6210\u7684\u8bc1\u4e66\u6587\u4ef6\u7684\u5b58\u50a8\u8def\u5f84\n// 5.-validity \u8bc1\u4e66\u7684\u6709\u6548\u671f\nkeytool -genkey -alias tomcat  -storetype PKCS12 -keyalg RSA -keysize 2048  -keystore keystore.p12 -validity 3650\n\n// \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\nserver.ssl.key-store=keystore.p12 //\u8def\u5f84\nserver.ssl.key-store-password=123456 //\u751f\u6210ssl\u8bc1\u4e66\u65f6\u8bbe\u7f6e\u7684\u5bc6\u94a5\u5e93\u7684\u53e3\u4ee4\nserver.ssl.keyStoreType=PKCS12\nserver.ssl.keyAlias = tomcat\n\n//\u6b64\u65f6\u5de5\u7a0b\u5df2\u7ecf\u652f\u6301https\u8bbf\u95ee\u3002 https://localhost:8080/\n\n')),(0,i.kt)("h3",{id:"1513-http-\u8bf7\u6c42\u81ea\u52a8\u8f6c\u4e3a-https"},"15.1.3. http \u8bf7\u6c42\u81ea\u52a8\u8f6c\u4e3a https"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// \u914d\u7f6e\u8bbf\u95eehttp  urL \u65f6\u81ea\u52a8\u8f6c\u5230https\u3002\n// \u914d\u7f6e\u540e, \u8bbf\u95ee https://localhost:8081/ \u6b63\u5e38, \u8bbf\u95ee http://localhost:8080/\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u9875\u9762\u7684url\u53d8\u6210\u4e86https://localhost:8081/\nclass Config {\n    @Bean\n    public EmbeddedServletContainerFactory servletContainer() {\n        TomcatEmbeddedServletContainerFactory tomcat = new TomcatEmbeddedServletContainerFactory() {\n            @Override\n            protected void postProcessContext(Context context) {\n                SecurityConstraint constraint = new SecurityConstraint();\n                constraint.setUserConstraint("CONFIDENTIAL");\n                SecurityCollection collection = new SecurityCollection();\n                collection.addPattern("/*");\n                constraint.addCollection(collection);\n                context.addConstraint(constraint);\n            }\n        };\n        tomcat.addAdditionalTomcatConnectors(httpConnector());\n        return tomcat;\n    }\n\n    @Bean\n    public Connector httpConnector() {\n        Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");\n        connector.setScheme("http");\n        //Connector\u76d1\u542c\u7684http\u7684\u7aef\u53e3\u53f7\n        connector.setPort(8080);\n        connector.setSecure(false);\n        //\u76d1\u542c\u5230http\u7684\u7aef\u53e3\u53f7\u540e\u8f6c\u5411\u5230\u7684https\u7684\u7aef\u53e3\u53f7\n        connector.setRedirectPort(8081); // \u9700\u8981\u8bbe\u7f6e server.port=8081\n\n        return connector;\n    }\n}\n\n\n\n')),(0,i.kt)("h3",{id:"1514-\u540c\u65f6\u652f\u6301-http-https"},"15.1.4. \u540c\u65f6\u652f\u6301 http https"),(0,i.kt)("p",null,"\u7528http\u8bf7\u6c42\u65f6\u4e0d\u518d\u8f6c\u6362\u6210https\u8bf7\u6c42"),(0,i.kt)("p",null,"\u53ea\u9700\u8981\u5c06\u4ee3\u7801\u4e2d\u7684connector.setSecure(false)\u4e2d\u7684false\u6539\u6210true\u5c31\u53ef\u4ee5\u4e86"),(0,i.kt)("h2",{id:"152-\u5bb9\u5668\u5316\u90e8\u7f72"},"15.2. \u5bb9\u5668\u5316\u90e8\u7f72"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://rovo98.github.io/posts/39885a36/"},"https://rovo98.github.io/posts/39885a36/")," SpringBoot + Docker + Nginx \u8d1f\u8f7d\u5747\u8861\u5b9e\u73b0\nTODO"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/GoogleContainerTools/jib"},"https://github.com/GoogleContainerTools/jib")," \u4e3a java \u7a0b\u5e8f\u6784\u9020 docker \u955c\u50cf (",(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/felordcn/p/13201163.html"},"https://www.cnblogs.com/felordcn/p/13201163.html"),")"),(0,i.kt)("h2",{id:"153-nginx-\u53cd\u5411\u4ee3\u7406"},"15.3. nginx \u53cd\u5411\u4ee3\u7406"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://cloud.tencent.com/developer/article/1332603"},"https://cloud.tencent.com/developer/article/1332603")),(0,i.kt)("h2",{id:"154-\u5185\u5d4c-tomcat-\u8c03\u4f18"},"15.4. \u5185\u5d4c tomcat \u8c03\u4f18"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  compression:\n    #SpringBoot \u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f gzip \u538b\u7f29\u7684\uff0c\u9700\u8981\u6211\u4eec\u624b\u52a8\u5f00\u542f\n    enabled: true\n    #optional, \u5728 spring2.0+\u7684\u7248\u672c\u4e2d\uff0c\u9ed8\u8ba4\u503c\u5df2\u7ecf\u6709\u4e86\n    mime-types: application/json,application/xml,text/html,text/plain,text/css,application/x-javascript\n    #\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ec5\u4f1a\u538b\u7f29 2048 \u5b57\u8282\u4ee5\u4e0a\u7684\u5185\u5bb9, \u6307\u5b9a\u8d85\u8fc7\u591a\u5c11\u5c31\u538b\u7f29\n    min-response-size: 1024\n\n  tomcat:\n    # \u6392\u961f\u6570, \u7b49\u5f85\u961f\u5217\u957f\u5ea6\uff1a\u961f\u5217\u505a\u7f13\u51b2\u6c60\u7528\uff0c\u4f46\u4e5f\u4e0d\u80fd\u65e0\u9650\u957f\uff0c\u6d88\u8017\u5185\u5b58\uff0c\u51fa\u5165\u961f\u5217\u4e5f\u8017cpu\n    accept-count: 1000   \n    max-connections: 10000 #\u6700\u5927\u53ef\u88ab\u8fde\u63a5\u6570\uff0c\u9ed8\u8ba4\u4e3a10000 \n    #\u6700\u5927\u5de5\u4f5c\u7ebf\u7a0b\u6570, \u9ed8\u8ba4 200\n    # 4\u68388G\u5185\u5b58\u5355\u8fdb\u7a0b\u8c03\u5ea6\u7ebf\u7a0b\u6570800-1000\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u5e76\u53d1\u6570\u4e4b\u540e\uff0c\u5c06\u4f1a\u82b1\u8d39\u5de8\u5927\u7684\u65f6\u95f4\u5728cpu\u8c03\u5ea6\u4e0a\u3002\n    max-threads: 800  \n    min-spare-threads: 100 #\u6700\u5c0f\u5de5\u4f5c\u7ebf\u7a0b\u6570, \u9ed8\u8ba4 10\n    # \u8fde\u63a5\u8d85\u65f6 30s\n    connection-timeout: 30000\n    # Maximum size, in bytes, of the HTTP message header\n    max-http-header-size:\n    # Maximum size, in bytes, of the HTTP post content.\n    max-http-post-size:\n")),(0,i.kt)("p",null,"\u901a\u8fc7 java code \u914d\u7f6e:"),(0,i.kt)("p",null,"\u4fee\u6539keepalivetimeout\u548cmaxKeepAliveRequests\u5f00\u542f\u957f\u8fde\u63a5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'//\u5f53Spring\u5bb9\u5668\u5185\u6ca1\u6709TomcatEmbeddedServletContainerFactory\u8fd9\u4e2abean\u65f6\uff0c\u4f1a\u5427\u6b64bean\u52a0\u8f7d\u8fdbspring\u5bb9\u5668\u4e2d\n@Component\npublic class  WebServerConfiguration implements WebServerFactoryCustomizer<ConfigurableWebServerFactory> {\n    @Override\n    public void customize(ConfigurableWebServerFactory configurableWebServerFactory) {\n            //\u4f7f\u7528\u5bf9\u5e94\u5de5\u5382\u7c7b\u63d0\u4f9b\u7ed9\u6211\u4eec\u7684\u63a5\u53e3\u5b9a\u5236\u5316\u6211\u4eec\u7684tomcat connector\n        ((TomcatServletWebServerFactory)configurableWebServerFactory).addConnectorCustomizers(new TomcatConnectorCustomizer() {\n            @Override\n            public void customize(Connector connector) {\n                Http11NioProtocol protocol = (Http11NioProtocol) connector.getProtocolHandler();\n\n                //\u5b9a\u5236\u5316keepalivetimeout,\u8bbe\u7f6e30\u79d2\u5185\u6ca1\u6709\u8bf7\u6c42\u5219\u670d\u52a1\u7aef\u81ea\u52a8\u65ad\u5f00keepalive\u94fe\u63a5\n                protocol.setKeepAliveTimeout(30000);\n                //\u5f53\u5ba2\u6237\u7aef\u53d1\u9001\u8d85\u8fc710000\u4e2a\u8bf7\u6c42\u5219\u81ea\u52a8\u65ad\u5f00keepalive\u94fe\u63a5\n                protocol.setMaxKeepAliveRequests(10000);\n\n                // \u8bbe\u7f6e\u5176\u4ed6....\n            }\n        });\n    }\n}\n\n// \u6216\u8005\u8fd9\u6837\u914d\u7f6e, \u6548\u679c\u7b49\u540c   \npublic class WebServerConfiguration {\n    @Bean\n    public ConfigurableServletWebServerFactory webServerFactory() {\n        TomcatServletWebServerFactory factory = new TomcatServletWebServerFactory();\n        factory.setPort(11359);//\u7aef\u53e3\u53f7\n        factory.setUriEncoding(Charset.forName("utf-8"));//\u7f16\u7801\n        factory.addConnectorCustomizers(new MyTomcatConnectorCustomizer());\n        return factory;\n    }\n    \n    class MyTomcatConnectorCustomizer implements TomcatConnectorCustomizer {\n        @Override\n        public void customize(Connector connector) {\n            // TODO Auto-generated method stub\n            Http11NioProtocol handler = (Http11NioProtocol)connector.getProtocolHandler();\n            \n            handler.setAcceptCount(2000);//\u6392\u961f\u6570\n                        \n            handler.setMaxConnections(5000);//\u6700\u5927\u8fde\u63a5\u6570\n            \n            handler.setMaxThreads(2000);//\u7ebf\u7a0b\u6c60\u7684\u6700\u5927\u7ebf\u7a0b\u6570\n            \n            handler.setMinSpareThreads(100);//\u6700\u5c0f\u7ebf\u7a0b\u6570\n                        \n            handler.setConnectionTimeout(30000);//\u8d85\u65f6\u65f6\u95f4                    \n        }\n    }\n}\n')),(0,i.kt)("h2",{id:"155-\u914d\u7f6e-war-\u5305\u90e8\u7f72\u5230-tomcat"},"15.5. \u914d\u7f6e war \u5305\u90e8\u7f72\u5230 Tomcat"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class ServletInitializer extends SpringBootServletInitializer {\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n        return application.sources(Application.class);\n    }\n\n}\n\n@Configuration\n@ComponentScan(basePackageClasses = Application.class, useDefaultFilters = true)\npublic class ServletContextConfig extends WebMvcConfigurationSupport{\n    /**\n     * \u914d\u7f6eservlet\u5904\u7406\n     */\n    @Override\n    public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {\n        configurer.enable();\n    }\n}\n\n")),(0,i.kt)("p",null,"\u6216\u8005\u76f4\u63a5\u4e00\u6b65\u5230\u4f4d:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@SpringbootApplication\npublic class Application extends SpringBootServletInitializer {\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n        return application.sources(Application.class);\n    }\n\n    ...\n}\n")),(0,i.kt)("h1",{id:"16-spring-boot-\u4e2d\u7684\u5e76\u53d1"},"16. spring boot \u4e2d\u7684\u5e76\u53d1"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.e4developer.com/2018/03/30/introduction-to-concurrency-in-spring-boot/"},"https://www.e4developer.com/2018/03/30/introduction-to-concurrency-in-spring-boot/")," //todo\n",(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/qq_40606397/article/details/104945855"},"https://blog.csdn.net/qq_40606397/article/details/104945855")),(0,i.kt)("h2",{id:"161-\u4f7f\u7528\u5f02\u6b65\u7f16\u7a0b"},"16.1. \u4f7f\u7528\u5f02\u6b65\u7f16\u7a0b"),(0,i.kt)("h3",{id:"1611-\u914d\u7f6e\u7ebf\u7a0b\u6c60"},"16.1.1. \u914d\u7f6e\u7ebf\u7a0b\u6c60"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// \u914d\u7f6e\u7ebf\u7a0b\u6c60\n@Configuration\n@EnableAsync\npublic class AsyncConfiguration {\n\n    @Bean("doSomethingExecutor")\n    public Executor doSomethingExecutor() {\n        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();\n        // \u6838\u5fc3\u7ebf\u7a0b\u6570\uff1a\u7ebf\u7a0b\u6c60\u521b\u5efa\u65f6\u5019\u521d\u59cb\u5316\u7684\u7ebf\u7a0b\u6570\n        executor.setCorePoolSize(10);\n        // \u6700\u5927\u7ebf\u7a0b\u6570\uff1a\u7ebf\u7a0b\u6c60\u6700\u5927\u7684\u7ebf\u7a0b\u6570\uff0c\u53ea\u6709\u5728\u7f13\u51b2\u961f\u5217\u6ee1\u4e86\u4e4b\u540e\u624d\u4f1a\u7533\u8bf7\u8d85\u8fc7\u6838\u5fc3\u7ebf\u7a0b\u6570\u7684\u7ebf\u7a0b\n        executor.setMaxPoolSize(20);\n        // \u7f13\u51b2\u961f\u5217\uff1a\u7528\u6765\u7f13\u51b2\u6267\u884c\u4efb\u52a1\u7684\u961f\u5217\n        executor.setQueueCapacity(500);\n        // \u5141\u8bb8\u7ebf\u7a0b\u7684\u7a7a\u95f2\u65f6\u95f460\u79d2\uff1a\u5f53\u8d85\u8fc7\u4e86\u6838\u5fc3\u7ebf\u7a0b\u4e4b\u5916\u7684\u7ebf\u7a0b\u5728\u7a7a\u95f2\u65f6\u95f4\u5230\u8fbe\u4e4b\u540e\u4f1a\u88ab\u9500\u6bc1\n        executor.setKeepAliveSeconds(60);\n        // \u7ebf\u7a0b\u6c60\u540d\u7684\u524d\u7f00\uff1a\u8bbe\u7f6e\u597d\u4e86\u4e4b\u540e\u53ef\u4ee5\u65b9\u4fbf\u6211\u4eec\u5b9a\u4f4d\u5904\u7406\u4efb\u52a1\u6240\u5728\u7684\u7ebf\u7a0b\u6c60\n        executor.setThreadNamePrefix("do-something-");\n        // \u7f13\u51b2\u961f\u5217\u6ee1\u4e86\u4e4b\u540e\u7684\u62d2\u7edd\u7b56\u7565\uff1a\u7531\u8c03\u7528\u7ebf\u7a0b\u5904\u7406\uff08\u4e00\u822c\u662f\u4e3b\u7ebf\u7a0b\uff09\n        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.DiscardPolicy());\n        executor.initialize();\n        return executor;\n    }\n    \n}\n\n')),(0,i.kt)("h3",{id:"1612-\u6709\u8fd4\u56de\u503c-\u6ca1\u6709\u8fd4\u56de\u503c"},"16.1.2. \u6709\u8fd4\u56de\u503c \u6ca1\u6709\u8fd4\u56de\u503c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n// \u4f7f\u7528 \u6ca1\u6709\u8fd4\u56de\u503c\n@Slf4j\n@Service\npublic class AsyncService {\n\n    // \u6307\u5b9a\u4f7f\u7528beanname\u4e3adoSomethingExecutor\u7684\u7ebf\u7a0b\u6c60\n    @Async("doSomethingExecutor")\n    public String doSomething(String message) {\n        log.info("do something, message={}", message);\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException e) {\n            log.error("do something error: ", e);\n        }\n        return message;\n    }\n}\n@RestController\npublic class AsyncController {\n    @Autowired\n    private AsyncService asyncService;\n    @GetMapping("/open/something")\n    public String something() {\n        int count = 10;\n        for (int i = 0; i < count; i++) {\n            asyncService.doSomething("index = " + i);\n        }\n        return "success";\n    }\n}\n\n\n\n// \u4f7f\u7528 \u6709\u8fd4\u56de\u503c\n@RestController\npublic class AsyncController {\n\n    @Autowired\n    private AsyncService asyncService;\n\n    @SneakyThrows\n    @ApiOperation("\u5f02\u6b65 \u6709\u8fd4\u56de\u503c")\n    @GetMapping("/open/somethings")\n    public String somethings() {\n        CompletableFuture<String> createOrder = asyncService.doSomething1("create order");\n        CompletableFuture<String> reduceAccount = asyncService.doSomething2("reduce account");\n        CompletableFuture<String> saveLog = asyncService.doSomething3("save log");\n        \n        // \u7b49\u5f85\u6240\u6709\u4efb\u52a1\u90fd\u6267\u884c\u5b8c\n        CompletableFuture.allOf(createOrder, reduceAccount, saveLog).join();\n        // \u83b7\u53d6\u6bcf\u4e2a\u4efb\u52a1\u7684\u8fd4\u56de\u7ed3\u679c\n        String result = createOrder.get() + reduceAccount.get() + saveLog.get();\n        return result;\n    }\n}\n@Slf4j\n@Service\npublic class AsyncService {\n\n    @Async("doSomethingExecutor")\n    public CompletableFuture<String> doSomething1(String message) throws InterruptedException {\n        log.info("do something1: {}", message);\n        Thread.sleep(1000);\n        return CompletableFuture.completedFuture("do something1: " + message);\n    }\n\n    @Async("doSomethingExecutor")\n    public CompletableFuture<String> doSomething2(String message) throws InterruptedException {\n        log.info("do something2: {}", message);\n        Thread.sleep(1000);\n        return CompletableFuture.completedFuture("; do something2: " + message);\n    }\n\n    @Async("doSomethingExecutor")\n    public CompletableFuture<String> doSomething3(String message) throws InterruptedException {\n        log.info("do something3: {}", message);\n        Thread.sleep(1000);\n        return CompletableFuture.completedFuture("; do something3: " + message);\n    }\n}\n\n\n')),(0,i.kt)("h3",{id:"1613-async\u5931\u6548"},"16.1.3. @Async\u5931\u6548"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5f02\u6b65\u65b9\u6cd5\u4f7f\u7528static\u5173\u952e\u8bcd\u4fee\u9970"),(0,i.kt)("li",{parentName:"ul"},"\u5f02\u6b65\u7c7b\u4e0d\u662f\u4e00\u4e2aSpring\u5bb9\u5668\u7684bean\uff08\u4e00\u822c\u4f7f\u7528\u6ce8\u89e3@Component\u548c@Service\uff0c\u5e76\u4e14\u80fd\u88abSpring\u626b\u63cf\u5230\uff09\uff1b"),(0,i.kt)("li",{parentName:"ul"},"SpringBoot\u5e94\u7528\u4e2d\u6ca1\u6709\u6dfb\u52a0@EnableAsync\u6ce8\u89e3\uff1b"),(0,i.kt)("li",{parentName:"ul"},"\u5728\u540c\u4e00\u4e2a\u7c7b\u4e2d\uff0c\u4e00\u4e2a\u65b9\u6cd5\u8c03\u7528\u53e6\u5916\u4e00\u4e2a\u6709@Async\u6ce8\u89e3\u7684\u65b9\u6cd5\uff0c\u6ce8\u89e3\u4e0d\u4f1a\u751f\u6548\u3002\u539f\u56e0\u662f@Async\u6ce8\u89e3\u7684\u65b9\u6cd5\uff0c\u662f\u5728\u4ee3\u7406\u7c7b\u4e2d\u6267\u884c\u7684\u3002")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u5f02\u6b65\u65b9\u6cd5\u4f7f\u7528\u6ce8\u89e3@Async\u7684\u8fd4\u56de\u503c\u53ea\u80fd\u4e3avoid\u6216\u8005Future\u53ca\u5176\u5b50\u7c7b\uff0c\u5f53\u8fd4\u56de\u7ed3\u679c\u4e3a\u5176\u4ed6\u7c7b\u578b\u65f6\uff0c\u65b9\u6cd5\u8fd8\u662f\u4f1a\u5f02\u6b65\u6267\u884c\uff0c\u4f46\u662f\u8fd4\u56de\u503c\u90fd\u662fnull")),(0,i.kt)("h1",{id:"17-\u5b9e\u73b0\u4e50\u89c2\u9501\u60b2\u89c2\u9501"},"17. \u5b9e\u73b0\u4e50\u89c2\u9501\u60b2\u89c2\u9501"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/cloudfloating/p/11461530.html"},"https://www.cnblogs.com/cloudfloating/p/11461530.html")," "),(0,i.kt)("p",null,"TODO"),(0,i.kt)("h1",{id:"18-\u79fb\u52a8\u7aef\u6d88\u606f\u63a8\u9001"},"18. \u79fb\u52a8\u7aef\u6d88\u606f\u63a8\u9001"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://juejin.im/post/6844903838495801357"},"https://juejin.im/post/6844903838495801357"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://crossoverjie.top/2018/09/25/netty/million-sms-push/"},"https://crossoverjie.top/2018/09/25/netty/million-sms-push/"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://juejin.im/post/6844903478200909837"},"https://juejin.im/post/6844903478200909837"),"\nTODO"),(0,i.kt)("h1",{id:"19-\u5373\u65f6\u901a\u4fe1-im\u7cfb\u7edf"},"19. \u5373\u65f6\u901a\u4fe1 IM\u7cfb\u7edf"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/tywo45"},"https://github.com/tywo45")),(0,i.kt)("h1",{id:"20-\u8f85\u52a9\u5de5\u5177"},"20. \u8f85\u52a9\u5de5\u5177"),(0,i.kt)("h2",{id:"201-lombok-notice"},"20.1. lombok notice"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@data <=> @Setter\u3001@Getter\u3001@RequiredArgsConstructor\u3001@ToString\u3001@EqualsAndHashCode, "),(0,i.kt)("p",{parentName:"li"},"  \u82e5\u5b58\u5728\u7ee7\u627f, \u9700\u8981\u4e3a son \u6307\u5b9a @EqualsAndHashCode(callSuper = true)"),(0,i.kt)("p",{parentName:"li"},"  @RequiredArgsConstructor \u8868\u793a\u4e3a\u4e0d\u53ef\u53d8 field \u751f\u6210 constructor, \u4e5f\u5c31\u662f\u4e3a final \u7684\u6210\u5458\u6216\u8005@notnull\u6210\u5458\u751f\u6210 constructor, \u5176\u4ed6\u666e\u901a\u7684 field \u4e0d\u4f1a\u4f5c\u4e3a\u6784\u9020\u53c2\u6570,"),(0,i.kt)("p",{parentName:"li"},'  @RequiredArgsConstructor(staticName="of"),  staticname=of \u8868\u793a\u8fd9\u4e2a\u7c7b\u4e0d\u80fd\u7528\u6784\u9020\u65b9\u6cd5\u6784\u9020\u51fa\u6765\uff0c\u5fc5\u987b\u901a\u8fc7 XxxClass.of(...)\u65b9\u6cd5\u624d\u80fd\u6784\u9020\u51fa\u6765')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u63a8\u8350\u901a\u7528\u7684\u7ec4\u5408\u662f @data, @all... , @no...")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u548c Java8 \u914d\u5408\u826f\u597d, jdk\u5347\u7ea7\u5f88\u9ebb\u70e6, \u9700\u8981 delombok")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@builder \u6784\u9020\u5bf9\u8c61\u65f6\u5e95\u5c42\u7528\u7684\u662f\u5168\u53c2\u6570\u6784\u9020\u5668, \u9700\u8981 @AllArgsConstructor\u4e00\u8d77\u7528, \u65e0\u6cd5\u5355\u72ec\u4f7f\u7528, \u82e5\u679c\u4e00\u5b9a\u8981\u7528, \u597d\u7684\u7ec4\u5408\u662f @NoArgsConstructor @AllArgsConstructor @Builder @Data")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4ee3\u66ff@AutoWired\u6ce8\u89e3: @RequiredArgsConstructor(onConstructor =@__(@Autowired))\u6807\u6ce8\u5728\u7c7b\u4e0a, \u90a3\u4e48\u6ce8\u5165\u6210\u5458\u7684\u65f6\u5019, \u53ef\u4ee5\u7701\u6389 @autowired \u6ce8\u89e3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u66ff\u4ee3@tostring\u6ce8\u89e3 \u53ef\u4ee5\u4f7f\u7528 lang3 \u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"ToStringBuilder.reflectionToString(this)")))),(0,i.kt)("h2",{id:"202-devtools"},"20.2. devtools"),(0,i.kt)("p",null,"\u5f00\u53d1\u8005\u7ec4\u4ef6, \u4fee\u6539\u4e86 thymeleaf \u540e, \u91cd\u65b0\u7f16\u8bd1\u4fee\u6539\u7684\u6587\u4ef6, \u9875\u9762\u5373\u53ef\u66f4\u65b0, \u4e0d\u5fc5\u91cd\u542f\u6574\u4e2a app, \u4f46\u662f\u82e5\u4fee\u6539\u4e86 Java config , \u8fd8\u662f\u8981\u91cd\u542f"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-props"},"spring.thymeleaf.cache=true\nspring.devtools.restart.enabled=true\n... additional-paths=src/main/java // \u76d1\u542c\u76ee\u5f55  \n")),(0,i.kt)("h2",{id:"203-maven-wrapper"},"20.3. maven wrapper"),(0,i.kt)("p",null,"wrapper\uff1amaven\u7684\u5305\u88c5\u5668\uff0c\u901a\u8fc7mvnw\u547d\u4ee4\u66ff\u4ee3mvn\uff0c\u7b80\u5316mvn\u64cd\u4f5c, \u4e0d\u9700\u8981\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u5b89\u88c5Maven"),(0,i.kt)("p",null,"\u53d7\u5230 gradle wrappe \u542f\u53d1"),(0,i.kt)("p",null,"/.mvn/wrapper/maven-wrapper.jar \u662f\u5176\u4e3b\u4f53\u7a0b\u5e8f"),(0,i.kt)("p",null,"/.mvn/wrapper/maven-wrapper.properties \u53ef\u6307\u5b9a maven \u7248\u672c\u53ca\u4e0b\u8f7d\u8def\u5f84"),(0,i.kt)("p",null,"mvnw, mvnw.cmd \u547d\u4ee4\u884c\u7a0b\u5e8f"),(0,i.kt)("p",null,"mvnw\u7b2c\u4e00\u6b21\u8fd0\u884c\u4f1a\u68c0\u6d4b$USER_HOME/.m2/wrapper/dists \u76ee\u5f55\u4e0b\u662f\u5426\u6709maven-wrapper.properties\u4e2d\u6307\u5b9a\u7684Maven\u7248\u672c\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u81ea\u52a8\u4e0b\u8f7d"),(0,i.kt)("h1",{id:"21-\u6821\u9a8c"},"21. \u6821\u9a8c"),(0,i.kt)("h2",{id:"211-\u6821\u9a8c\u914d\u7f6e\u6587\u4ef6"},"21.1. \u6821\u9a8c\u914d\u7f6e\u6587\u4ef6"),(0,i.kt)("p",null,"\u4efb\u4f55\u6dfb\u52a0@ConfigurationProperties\u7684\u7c7b\uff0cclass\u4e0a\u52a0 ",(0,i.kt)("inlineCode",{parentName:"p"},"@Validated")," annotation, app\u90fd\u4f1a\u8fdb\u884c\u5c5e\u6027\u6821\u9a8c, \u786e\u4fdd\u5f15\u5165\u4e86 JSR-303 javax.validation \u89c4\u8303\u7684\u5b9e\u73b0;\n\u4f7f\u7528\u6821\u9a8c\u89c4\u8303JSR-303 javax.validation\u4e2d\u7684\u6ce8\u89e3\u5373\u53ef\u5b9e\u73b0\u6821\u9a8c\uff08\u4ecb\u7ecd\u89c1\u8fd9\u91cc",(0,i.kt)("a",{parentName:"p",href:"https://www.ibm.com/developerworks/cn/java/j-lo-jsr303/%EF%BC%89"},"https://www.ibm.com/developerworks/cn/java/j-lo-jsr303/\uff09")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@ConfigurationProperties(prefix="connection")\n@Validated\npublic class FooProperties {\n\n    @NotNull\n    private InetAddress remoteAddress;\n\n    @Valid // \u8fd9\u91cc\u662f\u4e3a\u4e86\u6fc0\u6d3b Security\u7c7b\u4e2d\u7684\u6ce8\u89e3\u6821\u9a8c\n    private final Security security = new Security();\n\n    // ... getters and setters\n\n    public static class Security {\n\n        @NotEmpty\n        public String username;\n\n        // ... getters and setters\n\n    }\n\n}\n')),(0,i.kt)("p",null,"@Validated \u4e5f\u53ef\u4ee5\u53ef\u4ee5\u52a0\u5230 @Bean \u65b9\u6cd5\u4e0a \u6765\u89e6\u53d1\u6821\u9a8c;"),(0,i.kt)("p",null,"\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u7684Spring Validator\uff0cbean id\u662f configurationPropertiesValidator \u5373\u53ef"),(0,i.kt)("p",null,"spring-boot-actuator \u6a21\u5757\u6709\u4e00\u4e2a\u7aef\u70b9\uff0c\u5bf9\u5916\u66b4\u9732\u4e86\u6240\u6709\u7684 @ConfigurationProperties beans\u3002\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee /configprops \u5373\u53ef"),(0,i.kt)("h2",{id:"212-\u6821\u9a8c\u8bf7\u6c42\u53c2\u6570"},"21.2. \u6821\u9a8c\u8bf7\u6c42\u53c2\u6570"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/mzh_cn/article/details/80637015"},"https://blog.csdn.net/mzh_cn/article/details/80637015")),(0,i.kt)("h2",{id:"213-\u81ea\u5b9a\u4e49\u6821\u9a8c"},"21.3. \u81ea\u5b9a\u4e49\u6821\u9a8c"),(0,i.kt)("h2",{id:"214-validated\u548cvalid"},"21.4. @Validated\u548c@Valid"),(0,i.kt)("p",null,"@Valid\u662f JSR-303 \u89c4\u8303, hibernate-validation\u5b9e\u73b0\u4e86\u8fd9\u4e00\u89c4\u8303"),(0,i.kt)("p",null,'@Validated\u6765\u81ea\u4e8espring, \u662f spring \u5bf9\u4e8e @Valid \u7684\u5b9e\u73b0, \u63d0\u4f9b"validation groups"\u529f\u80fd(\u521b\u5efa\u7a7a\u63a5\u53e3\u4f5c\u4e3a\u5206\u7ec4), valid\u5219\u4e0d\u5177\u5907;(',(0,i.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/36173332/difference-between-valid-and-validated-in-spring"},"https://stackoverflow.com/questions/36173332/difference-between-valid-and-validated-in-spring"),") , \u4e00\u65e6controler \u4e2d\u4f7f\u7528 @Validated(group={...}), \u90a3\u4e48\u5b9e\u4f53\u7c7b\u5b57\u6bb5\u4e0a\u7684\u6ce8\u89e3\u82e5\u6307\u5b9a group \u5219\u7ea6\u675f\u751f\u6548, \u4e0d\u6307\u5b9a\u5206\u7ec4\u7684\u4e0d\u751f\u6548. \u53cd\u4e4b, \u82e5 @validated \u6ca1\u6709\u6307\u5b9a\u5206\u7ec4, \u5219 \u5b9e\u4f53\u7c7b\u5b57\u6bb5\u6307\u5b9a\u4e86 group \u7684\u4e0d\u751f\u6548, \u4e0d\u6307\u5b9agroup \u7684\u5b57\u6bb5\u751f\u6548"),(0,i.kt)("h1",{id:"22-runner-\u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570"},"22. runner \u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570"),(0,i.kt)("h2",{id:"221-\u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570"},"22.1. \u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570"),(0,i.kt)("p",null,"\u6ce8\u5165\u4e00\u4e2a",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.boot.ApplicationArguments "),"bean"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class MyBean {\n\n    @Autowired\n    public MyBean(ApplicationArguments args) {\n        boolean debug = args.containsOption("debug");//option\u53c2\u6570\u5373\u201c--\u201d\u5f00\u5934\u7684\u53c2\u6570\n        List<String> files = args.getNonOptionArgs();// if run with "--debug logfile.txt" \u90a3\u4e48\u7ed3\u679c\u662f debug=true, files=["logfile.txt"]\n    }\n\n}\n')),(0,i.kt)("p",null,"\u53e6\u5916\u7684\u6ce8\u5165\u65b9\u6cd5:"),(0,i.kt)("p",null,"Spring Boot will also register a ",(0,i.kt)("inlineCode",{parentName:"p"},"CommandLinePropertySource")," with the Spring ",(0,i.kt)("inlineCode",{parentName:"p"},"Environment"),". This allows you to also inject single application arguments using the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Value")," annotation."),(0,i.kt)("h2",{id:"222-applicationrunner-or-commandlinerunner"},"22.2. ",(0,i.kt)("inlineCode",{parentName:"h2"},"ApplicationRunner")," or ",(0,i.kt)("inlineCode",{parentName:"h2"},"CommandLineRunner")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ApplicationRunner")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"CommandLineRunner"),"\u63a5\u53e3\u90fd\u6709run()\u5f85\u5b9e\u73b0(\u5728SpringApplication.run(\u2026\u200b)\u5b8c\u6210\u4e4b\u524d\u8c03\u7528)\u4f46\u662f\u53c2\u6570\u4e0d\u540c, \u5177\u4f53\u5982\u4e0b:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"ApplicationRunner\u63a5\u53e3, ",(0,i.kt)("inlineCode",{parentName:"p"},"void run(ApplicationArguments args)"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"CommandLineRunner\u63a5\u53e3, ",(0,i.kt)("inlineCode",{parentName:"p"},"void run(String... args)")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class MyBean implements CommandLineRunner {\n\n    @Override\n    public void run(String... args) {//\u53ef\u4ee5\u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570, \u4f5c\u4e3aString[]\n        // \u8fd9\u91cc\u7684\u5185\u5bb9\u4f1a\u5728app\u5b8c\u5168\u542f\u52a8\u524d\u6700\u540e\u4e00\u6b65\u6267\u884c, \u5373SpringApplication.run(\u2026\u200b)\u5b8c\u6210\u4e4b\u524d, \u4e5f\u4f1a\u5728ApplicationReadyEvent\u4e4b\u524d\n    }\n\n}\n\n\n// \u53e6\u4e00\u79cd\u65b9\u6cd5:\n//java -jar commandline-app-0.0.1-SNAPSHOT.jar iamnonoption --app.name=CmdRulez --app.hosts=abc,def,ghi --app.name=2\nimplements ApplicationRunner\n    @Override\n    public void run(ApplicationArguments args) throws Exception {\n        // \u83b7\u53d6\u975e --xxx=yyy \u7684\u53c2\u6570\u96c6\u5408\n        System.out.println("# NonOptionArgs: " + args.getNonOptionArgs().size());\n        System.out.println("NonOptionArgs:");\n        args.getNonOptionArgs().forEach(System.out::println);\n\n        // \u83b7\u53d6 --xxx=yy \u7684\u53c2\u6570\u4e2d\u7684 key\n        System.out.println("# OptionArgs: " + args.getOptionNames().size());\n        System.out.println("OptionArgs:");\n\n        args.getOptionNames().forEach(optionName -> {\n            System.out.println(optionName + "=" + args.getOptionValues(optionName));// \u83b7\u53d6 value\n        });\n    }\n')),(0,i.kt)("p",null,"\u5982\u679c\u6709\u591a\u4e2aCommandLineRunner or ApplicationRunner beans \u88ab\u5b9a\u4e49, \u8fd9\u65f6\u5019\u6d89\u53ca\u5230\u8c03\u7528\u6570\u5e8f\u95ee\u9898, \u4e24\u79cd\u65b9\u5f0f:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5b9e\u73b0",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.core.Ordered"),"\u63a5\u53e3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4f7f\u7528",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.core.annotation.Order"),"\u6ce8\u89e3 eg: @Order(num), num\u4e3aInt, 0\u4f18\u5148\u7ea7\u6700\u9ad8"))),(0,i.kt)("h1",{id:"23-\u5f00\u53d1\u547d\u4ee4\u884c\u5e94\u7528"},"23. \u5f00\u53d1\u547d\u4ee4\u884c\u5e94\u7528"),(0,i.kt)("p",null,"\u52a0\u5165\u5f00\u53d1\u4e00\u4e2a\u5de5\u5177 ab.jar, \u5e0c\u671b\u8fd9\u4e48\u4f7f\u7528:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"java -jar ab.jar \u4f7f\u7528\u63d0\u793a"),(0,i.kt)("li",{parentName:"ul"},"java -jar ab.jar  --spring.profiles.active=hello-world,receiver \u6fc0\u6d3b\u4e0d\u540c\u7684 profile")),(0,i.kt)("p",null,"\u914d\u7f6e\u4e2d\u6307\u5b9a\u4e00\u4e2a\u9ed8\u8ba4 \u6fc0\u6d3b profile"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"spring:\n  profiles:\n    active: usage_message\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// \u5de5\u5177\u4f7f\u7528\u63d0\u793a\n@Profile("usage_message")\n@Bean\npublic CommandLineRunner usage() {\n    return args -> {\n        System.out.println("This app uses Spring Profiles to\n            control its behavior.\\n");\n        System.out.println("Sample usage: java -jar\n            rabbit-tutorials.jar\n            --spring.profiles.active=hello-world,sender");\n    };\n}\n\n// \u82e5\u51fa\u4f20\u9012\u4e86\u53c2\u6570, \u5219 usage_message \u5c31\u88ab\u8986\u76d6, \u8fd9\u4e2a bean \u88ab\u6ce8\u518c\n@Profile("!usage_message")\n@Bean\npublic CommandLineRunner tutorial() {\n    return new RabbitAmqpTutorialsRunner();\n}\n\n// \u4f20\u9012\u4e0d\u540c\u7684\u53c2\u6570, \u4e0d\u540c\u7684 profile \u4f1a\u6fc0\u6d3b\n@Profile("receiver")\n@Bean\npublic Tut1Receiver receiver() {\n    return new Tut1Receiver();\n}\n\n@Profile("sender")\n@Bean\npublic Tut1Sender sender() {\n    return new Tut1Sender();\n}\n\n\n// \u5177\u4f53\u64cd\u4f5c\npublic class RabbitAmqpTutorialsRunner implements CommandLineRunner {\n\n    @Value("${tutorial.client.duration:0}")\n    private int duration;\n\n    @Autowired\n    private ConfigurableApplicationContext ctx;\n\n    @Override\n    public void run(String... arg0) throws Exception {\n        System.out.println("Ready ... running for " + duration + "ms");\n        Thread.sleep(duration);\n        ctx.close();\n    }\n}\n\n\n')),(0,i.kt)("h1",{id:"24-\u6574\u5408-grpc"},"24. \u6574\u5408 grpc"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/ChinaSilence/spring-boot-starter-grpc"},"https://github.com/ChinaSilence/spring-boot-starter-grpc")),(0,i.kt)("h1",{id:"25-\u4efb\u52a1\u8c03\u5ea6"},"25. \u4efb\u52a1\u8c03\u5ea6"),(0,i.kt)("h2",{id:"251-\u6574\u5408-xxl-job-\u4efb\u52a1\u8c03\u5ea6\u5e73\u53f0"},"25.1. \u6574\u5408 XXL-JOB \u4efb\u52a1\u8c03\u5ea6\u5e73\u53f0"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.tianheyu.top/archives/springboot-xxl-job-executor"},"https://www.tianheyu.top/archives/springboot-xxl-job-executor")),(0,i.kt)("h2",{id:"252-\u5f02\u6b65\u4efb\u52a1"},"25.2. \u5f02\u6b65\u4efb\u52a1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@EnableAsync\npublic class AsyncConfig implements AsyncConfigurer {\n\n    @Override\n    public Executor getAsyncExecutor() {\n        ThreadPoolTaskExecutor taskExecutor = new ThreadPoolTaskExecutor();\n        //\u6838\u5fc3\u7ebf\u7a0b\u6570\n        taskExecutor.setCorePoolSize(8);\n        //\u6700\u5927\u7ebf\u7a0b\u6570\n        taskExecutor.setMaxPoolSize(16);\n        //\u961f\u5217\u5927\u5c0f\n        taskExecutor.setQueueCapacity(100);\n        // \u5f53\u6700\u5927\u6c60\u5df2\u6ee1\u65f6,\u6b64\u7b56\u7565\u4e3a\u6211\u4eec\u63d0\u4f9b\u53ef\u4f38\u7f29\u961f\u5217\uff0c\u6b64\u7b56\u7565\u4fdd\u8bc1\u4e0d\u4f1a\u4e22\u5931\u4efb\u52a1\u8bf7\u6c42\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u6574\u4f53\u6027\u80fd\u3002\n    executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());\n    executor.setThreadNamePrefix("My ThreadPoolTaskExecutor-");\n        taskExecutor.initialize();\n        return taskExecutor;\n    }\n}\n\n\n\n\n// \u4f7f\u7528\n@Service\npublic class FutureService {\n\n    //\u5728\u9700\u8981\u6267\u884c\u7684\u65b9\u6cd5\u4e0a\u52a0@Async\u8868\u660e\u8be5\u65b9\u6cd5\u662f\u4e2a\u5f02\u6b65\u65b9\u6cd5\uff0c\u5982\u679c\u52a0\u5728\u7c7b\u7ea7\u522b\u4e0a\uff0c\u5219\u8868\u660e\u7c7b\u6240\u6709\u7684\u65b9\u6cd5\u90fd\u662f\u5f02\u6b65\u65b9\u6cd5\n    @Async\n    public Future<String> futureTest() throws InterruptedException {\n        System.out.println("\u4efb\u52a1\u6267\u884c\u5f00\u59cb,\u9700\u8981\uff1a1000ms");\n        for (int i = 0; i < 10; i++) {\n            Thread.sleep(100);\n            System.out.println("do:" + i);\n        }\n        System.out.println("\u5b8c\u6210\u4efb\u52a1");\n        return new AsyncResult<>(Thread.currentThread().getName());\n    }\n\n\n    @Async\n    public CompletableFuture<List<String>> completableFutureTask(String start) {\n        // \u6253\u5370\u65e5\u5fd7\n        logger.warn(Thread.currentThread().getName() + "start this task!");\n        // \u627e\u5230\u7279\u5b9a\u5b57\u7b26/\u5b57\u7b26\u4e32\u5f00\u5934\u7684\u7535\u5f71\n        List<String> results =\n            movies.stream().filter(movie -> movie.startsWith(start)).collect(Collectors.toList());\n        // \u6a21\u62df\u8fd9\u662f\u4e00\u4e2a\u8017\u65f6\u7684\u4efb\u52a1\n        try {\n        Thread.sleep(1000L);\n        } catch (InterruptedException e) {\n        e.printStackTrace();\n        }\n        //\u8fd4\u56de\u4e00\u4e2a\u5df2\u7ecf\u7528\u7ed9\u5b9a\u503c\u5b8c\u6210\u7684\u65b0\u7684CompletableFuture\u3002\n        return CompletableFuture.completedFuture(results);\n    }\n}\n')),(0,i.kt)("h2",{id:"253-\u5b9a\u65f6\u4efb\u52a1"},"25.3. \u5b9a\u65f6\u4efb\u52a1"),(0,i.kt)("h3",{id:"2531-springboot-\u5185\u7f6e"},"25.3.1. springboot \u5185\u7f6e"),(0,i.kt)("p",null,"SpringBoot\u4e3a\u6211\u4eec\u5185\u7f6e\u4e86@Scheduled\u5b9a\u65f6\u4efb\u52a1 (spring task), @EnableScheduling \u5f00\u542f"),(0,i.kt)("p",null,"@Scheduled\u6ce8\u89e3\u5404\u53c2\u6570\u8be6\u89e3: (",(0,i.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/1defb0f22ed1"},"https://www.jianshu.com/p/1defb0f22ed1"),")"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"cron"),(0,i.kt)("li",{parentName:"ul"},"zone"),(0,i.kt)("li",{parentName:"ul"},"fixedDelay \u4e0a\u6b21\u5b8c\u6bd5\u5230\u4e0b\u6b21\u5f00\u59cb(ms)"),(0,i.kt)("li",{parentName:"ul"},'fixedDelayString="${time.fixedDelay}" \u540c\u4e0a'),(0,i.kt)("li",{parentName:"ul"},"fixedRate \u4e0a\u6b21\u5f00\u59cb\u5230\u4e0b\u6b21\u5f00\u59cb"),(0,i.kt)("li",{parentName:"ul"},"initialDelay \u9996\u6b21\u5ef6\u8fdf")),(0,i.kt)("p",null,"\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n//\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c@Scheduled\u4efb\u52a1\u90fd\u5728Spring\u521b\u5efa\u7684\u5927\u5c0f\u4e3a1\u7684\u9ed8\u8ba4\u7ebf\u7a0b\u6c60\u4e2d\u6267\u884c\n\n@Configuration\npublic class SchedulerConfig implements SchedulingConfigurer {\n    private final int POOL_SIZE = 10;\n\n    @Override\n    public void configureTasks(ScheduledTaskRegistrar scheduledTaskRegistrar) {\n        ThreadPoolTaskScheduler threadPoolTaskScheduler = new ThreadPoolTaskScheduler();\n\n        threadPoolTaskScheduler.setPoolSize(POOL_SIZE);\n        threadPoolTaskScheduler.setThreadNamePrefix("my-scheduled-task-pool-");\n        threadPoolTaskScheduler.initialize();\n\n        scheduledTaskRegistrar.setTaskScheduler(threadPoolTaskScheduler);\n    }\n}\n\n\n')),(0,i.kt)("h3",{id:"2532-\u96c6\u6210-quartz"},"25.3.2. \u96c6\u6210 Quartz"),(0,i.kt)("h1",{id:"26-\u914d\u7f6e\u6587\u4ef6-and-\u73af\u5883"},"26. \u914d\u7f6e\u6587\u4ef6 and \u73af\u5883"),(0,i.kt)("h2",{id:"261-\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6"},"26.1. \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6"),(0,i.kt)("h3",{id:"2611-\u51e0\u79cd\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u6cd5"},"26.1.1. \u51e0\u79cd\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u6cd5"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'\u4f7f\u7528 @Value("${property}") \u8bfb\u53d6\u6bd4\u8f83\u7b80\u5355\u7684\u914d\u7f6e\u4fe1\u606f')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'\u901a\u8fc7@ConfigurationProperties(prefix = "library")\u8bfb\u53d6\u5e76\u4e0e bean \u7ed1\u5b9a, \u9700\u8981 \u52a0 @component(\u6b64\u65f6\u65e0\u9700\u5728\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0 @EnableConfigurationProperties), \u82e5\u4e0d\u7528 @component, \u5219\u5fc5\u987b \u5728\u4efb\u610f\u4e00\u4e2a\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0 @EnableConfigurationProperties(...)')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"@ConfigurationProperties \u914d\u5408 @bean \u7528\u5728\u65b9\u6cd5\u4e0a, \u65b9\u6cd5\u8c03\u7528\u7a7a\u6784\u9020\u51fd\u6570\u8fd4\u56de\u60f3\u8981\u6784\u9020\u7684\u5bf9\u8c61")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'@PropertySource("classpath:website.properties") \u8bfb\u53d6\u6307\u5b9a properties \u6587\u4ef6'))),(0,i.kt)("h3",{id:"2612-\u6ce8\u5165\u590d\u6742\u7c7b\u578b"},"26.1.2. \u6ce8\u5165\u590d\u6742\u7c7b\u578b"),(0,i.kt)("p",null,"\u5bf9\u4e8e properties \u683c\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"# application.properties\n#\n#\u5355\u4e2a\u503c\nval=10\n\n# List\nlist=1,2,3,4\n\n#Map\nmap={'name':'chen', 'age':'12', 'sex':'\u7537'}\n\n\n\n#java\n# \u7528\u5230\u4e86spel\u8868\u8fbe\u5f0f\n@PropertySource(\"classpath:xxx\")\npublic class ConfigProps {\n    //\u5355\u4e2a\u6570\u503c\uff0c\u53ef\u6ce8\u5165\u4e3aint\u6216String\n    @Value(\"${val}\")\n    private int val;\n\n    //array \u6570\u7ec4\n    @Value(\"#{'${ips}'.split(',')}\")\n    private List<String> iplist;\n\n\n    //map\n    @Value(\"#{${map}}\")\n    private Map<String, String> map;\n}\n\n\n")),(0,i.kt)("p",null,"\u5bf9\u4e8e yml \u683c\u5f0f\u7684\u6587\u4ef6:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'custom:\n  ignored-token-path: /base/xx/login, /xx/**/, /xx/hfc/test\n\n\u7136\u548c\u914d\u7f6e\u63a5\u53d7\u7c7b\n\n@Configuration // \u4e5f\u53ef\u4ee5\u7528 @component, \u82e5\u679c\u4e0d\u60f3\u7528\u8fd9\u7c7b\u6ce8\u89e3, \u53ef\u4ee5\u53bb\u6389, \u53d6\u800c\u4ee3\u4e4b\u5728\u542f\u52a8\u7c7b\u4e0a\u6807\u6ce8 @enableConfigProperties(xxx.class), \u76f8\u5f53\u4e8e\u52a0\u4e86 @Component\n@ConfigurationProperties("custom")\npublic class Custom {\n\n    private String[] ignoredTokenPath;\n\n}\n\n\n\n\n\ncustom:\n  mail[0]:\n    username: xxx@xxx.com\n    password: axxx\n  mail[1]:\n    username: xxx@xxx.com\n    password: axxx\n\n@component\n@ConfigurationProperties("custom")\npublic class Custom {\n\n    private List<MailInfo> mail;\n\n    static class MailInfo {\n\n        private String username;\n        private String password;\n\n    }\n\n}\n\n\n\n\n\ndirectory:\n  maps:\n    11: /dciZhongShan/resourceWarn/agricultureLand\n\n@Component\n@Data\n@ConfigurationProperties(prefix = "directory")\npublic class MapConfig {\n    private Map<Integer, String> maps;\n}\n')),(0,i.kt)("h2",{id:"262-\u914d\u7f6e\u6587\u4ef6\u4f18\u5148\u7ea7"},"26.2. \u914d\u7f6e\u6587\u4ef6\u4f18\u5148\u7ea7"),(0,i.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u4f18\u5148\u7ea7: \u547d\u4ee4\u884c > ${user.dir}/config/xxx > ${user.dir}/xxx (usr.dir \u5373\u4e3a\u547d\u4ee4\u6267\u884c\u7684\u5f53\u524d\u76ee\u5f55) > classpath:config/xxx > classpath:xxx"),(0,i.kt)("p",null,"--spring.profiles.active=prod,,,, --spring.config.location=target/application.properties"),(0,i.kt)("h2",{id:"263-\u8bfb\u53d6\u73af\u5883\u4fe1\u606f"},"26.3. \u8bfb\u53d6\u73af\u5883\u4fe1\u606f"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @author xiaoyu\n * date: 2020/3/21\n */\n@SpringBootApplication\npublic class SpringbootDemoApp {\n\n    /**\n     * springboot\u5728\u542f\u52a8\u7684\u65f6\u5019\u9700\u8981\u68c0\u6d4b\u5f53\u524d\u9879\u76ee\u662f\u5426\u662f\u4e00\u4e2aweb\u9879\u76ee\uff0c\n     * \u68c0\u6d4b\u65b9\u5f0f\u4e3a\u5224\u65adclasspath\u4e2d\u662f\u5426\u6709\u4ee5\u4e0bfinal\u53d8\u91cf\u4e2d\u5b9a\u4e49\u7684\u4e24\u4e2a\u53c2\u6570\n     */\n    private static final String[] WEB_ENVIRONMENT_CLASSES =\n            new String[]{"javax.servlet.Servlet", "org.springframework.web.context.ConfigurableWebApplicationContext"};\n\n    public static void main(String[] args) {\n        ConfigurableApplicationContext context = SpringApplication.run(SpringbootDemoApp.class, args);\n        ConfigurableEnvironment        env     = context.getEnvironment();\n\n        String[] activeProfiles = env.getActiveProfiles();\n        String   port           = env.getProperty("server.port");\n\n        System.out.println("==============================");\n        System.out.println("active profiles: " + Arrays.toString(activeProfiles));\n        System.out.println("local uri: http://localhost:" + port);\n        System.out.println("local area network uri: http://" + localAreaNetwork() + ":" + port);\n        System.out.println("==============================");\n    }\n\n    private static String localAreaNetwork() {\n        try {\n            return InetAddress.getLocalHost().getHostAddress();\n        } catch (UnknownHostException e) {\n            e.printStackTrace();\n            return "get local area network error";\n        }\n    }\n\n    private boolean deduceWebEnv() {\n        //https://blog.csdn.net/txba6868/article/details/80732475\n        return true;\n    }\n}\n\n@RestController\nclass DemoController {\n\n    /**\n     * file upload \u6587\u4ef6\u4e0a\u4f20\n     */\n    @RequestMapping(value = "/upload", method = RequestMethod.POST)\n    public ResponseEntity<String> upload(HttpServletRequest request) throws IOException {\n        MultipartHttpServletRequest req = (MultipartHttpServletRequest) request;\n        MultipartFile aa = req.getFile("aa");\n        MultipartFile bb = req.getFile("bb");\n        aa.transferTo(Paths.get(System.getProperty("user.home") + "/tmp").toFile());\n\n        return ResponseEntity.ok("ok");\n    }\n}\n\n')),(0,i.kt)("h2",{id:"264-\u4e24\u79cd\u5f15\u5165-springboot-\u65b9\u5f0f"},"26.4. \u4e24\u79cd\u5f15\u5165 springboot \u65b9\u5f0f"),(0,i.kt)("p",null,"\u4e00\u79cd\u662f\u901a\u8fc7 \u8bbe\u7f6e parent \u4e3a spring boot starter parent"),(0,i.kt)("p",null,"\u4e00\u79cd\u662f\u901a\u8fc7 dependencyManagement \u52a0\u5165 spring boot dependencies (\u9700\u8981 \u8bbe\u7f6e maven  properties, ",(0,i.kt)("inlineCode",{parentName:"p"},"maven.compiler.source")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"maven.compiler.target")," \u9632\u6b62\u7f16\u8bd1\u4f7f\u7528 jdk 1.5)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n\x3c!--    <parent>--\x3e\n\x3c!--        <groupId>org.springframework.boot</groupId>--\x3e\n\x3c!--        <artifactId>spring-boot-starter-parent</artifactId>--\x3e\n\x3c!--        <version></version>--\x3e\n\x3c!--        <relativePath/> &lt;!&ndash; lookup parent from repository &ndash;&gt;--\x3e\n\x3c!--    </parent>--\x3e\n\n    <groupId>io.github.xiaoyureed</groupId>\n    <artifactId>shopee</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <packaging>pom</packaging>\n    <description>\u805a\u5408\u670d\u52a1</description>\n\n    <properties>\n        <java.version>1.8</java.version>\n        <maven.compiler.source>${java.version}</maven.compiler.source>\n        <maven.compiler.target>${java.version}</maven.compiler.target>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n        <spring-boot.version>2.3.4.RELEASE</spring-boot.version>\n        <spring-cloud.version>Hoxton.SR8</spring-cloud.version>\n        <spring-cloud-alibaba.version>2.2.1.RELEASE</spring-cloud-alibaba.version>\n        <aliyun-spring-boot.version>1.0.0</aliyun-spring-boot.version>\n    </properties>\n\n    <dependencyManagement>\n\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-dependencies</artifactId>\n                <version>${spring-boot.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>${spring-cloud.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n\n            <dependency>\n                <groupId>com.alibaba.cloud</groupId>\n                <artifactId>spring-cloud-alibaba-dependencies</artifactId>\n                <version>${spring-cloud-alibaba.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n            <dependency>\n                <groupId>com.alibaba.cloud</groupId>\n                <artifactId>aliyun-spring-boot-dependencies</artifactId>\n                <version>${aliyun-spring-boot.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n\n            <dependency>\n                <groupId>com.baomidou</groupId>\n                <artifactId>mybatis-plus-boot-starter</artifactId>\n                <version>3.4.0</version>\n            </dependency>\n\n            \x3c!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --\x3e\n            <dependency>\n                <groupId>mysql</groupId>\n                <artifactId>mysql-connector-java</artifactId>\n                <version>8.0.21</version>\n            </dependency>\n\n            <dependency>\n                <groupId>org.elasticsearch.client</groupId>\n                <artifactId>elasticsearch-rest-high-level-client</artifactId>\n                <version>7.9.2</version>\n            </dependency>\n\n\x3c!--            \u4ee3\u7801\u751f\u6210 --\x3e\n            <dependency>\n                <groupId>com.baomidou</groupId>\n                <artifactId>mybatis-plus-generator</artifactId>\n                <version>3.4.0</version>\n            </dependency>\n            \x3c!-- https://mvnrepository.com/artifact/org.apache.velocity/velocity-engine-core --\x3e\n            <dependency>\n                <groupId>org.apache.velocity</groupId>\n                <artifactId>velocity-engine-core</artifactId>\n                <version>2.2</version>\n            </dependency>\n\n            \x3c!-- https://mvnrepository.com/artifact/org.apache.httpcomponents/httpcore --\x3e\n\x3c!--            common module need this--\x3e\n            <dependency>\n                <groupId>org.apache.httpcomponents</groupId>\n                <artifactId>httpcore</artifactId>\n                <version>4.4.13</version>\n            </dependency>\n            \x3c!-- https://mvnrepository.com/artifact/org.apache.commons/commons-lang3 --\x3e\n            <dependency>\n                <groupId>org.apache.commons</groupId>\n                <artifactId>commons-lang3</artifactId>\n                <version>3.11</version>\n            </dependency>\n\n\n\n\n        </dependencies>\n    </dependencyManagement>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n            <optional>true</optional>\n        </dependency>\n    </dependencies>\n\n\n</project>\n')),(0,i.kt)("p",null,"\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f spring boot maven plugin \u53ef\u80fd\u5931\u6548, \u9700\u8981\u624b\u52a8\u914d\u7f6e"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <executions>\n                    <execution>\n                        <phase>package</phase>\n                        <goals>\n                            <goal>repackage</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n        </plugins>\n    </build>\n")),(0,i.kt)("h1",{id:"27-\u5e8f\u5217\u5316-\u53cd\u5e8f\u5217\u5316"},"27. \u5e8f\u5217\u5316 \u53cd\u5e8f\u5217\u5316"),(0,i.kt)("h2",{id:"271-\u65e5\u671f\u65f6\u95f4-json"},"27.1. \u65e5\u671f\u65f6\u95f4 json"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/carrychan/p/9883172.html"},"https://www.cnblogs.com/carrychan/p/9883172.html"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/z69183787/article/details/109356584"},"https://blog.csdn.net/z69183787/article/details/109356584")),(0,i.kt)("h2",{id:"272-jackson-\u4f7f\u7528"},"27.2. jackson \u4f7f\u7528"),(0,i.kt)("p",null,"springboot web starter \u4e2d\u5305\u542b\u4e86 Jackson-databind \u4f9d\u8d56, \u53ef\u4ee5\u76f4\u63a5\u6ce8\u5165 objectmapper, \u82e5\u81ea\u5df1\u5b9a\u5236:"),(0,i.kt)("h3",{id:"2721-jsoncomponent"},"27.2.1. @JsonComponent"),(0,i.kt)("p",null,"\u7528\u4e8e\u5bf9\u7279\u5b9a\u5c5e\u6027\u5b9a\u5236\u5e8f\u5217\u5316"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Data\n@AllArgsConstructor\npublic class User {\n    private Color favoriteColor;\n}\n\n\n@JsonComponent\npublic class UserCombinedSerializer {\n\n    public static class UserJsonSerializer // \u82e5\u53ea\u9700\u8981\u5e8f\u5217\u5316, \u4e0d\u9700\u8981\u53cd\u5e8f\u5217\u5316, \u5219\u53ea\u9700\u8981\u8fd9\u4e2a\u7c7b \u5e76\u5728\u8fd9\u4e2a\u7c7b\u6807\u6ce8 @JsonComponent. \u5916\u5c42\u7c7b\u548c\u4e0b\u9762\u7684\u5185\u90e8\u7c7b\u7c7b\u90fd\u4e0d\u9700\u8981, \n      extends JsonSerializer<User> {\n\n        @Override\n        public void serialize(User user, JsonGenerator jsonGenerator, \n          SerializerProvider serializerProvider) throws IOException, \n          JsonProcessingException {\n\n            jsonGenerator.writeStartObject();\n            jsonGenerator.writeStringField(\n              "favoriteColor", getColorAsWebColor(user.getFavoriteColor()));\n\n            // ... \u5176\u4ed6\u5c5e\u6027...\n\n            jsonGenerator.writeEndObject();\n        }\n\n        private static String getColorAsWebColor(Color color) {\n            int r = (int) Math.round(color.getRed() * 255.0);\n            int g = (int) Math.round(color.getGreen() * 255.0);\n            int b = (int) Math.round(color.getBlue() * 255.0);\n            return String.format("#%02x%02x%02x", r, g, b);\n        }\n    }\n\n    public static class UserJsonDeserializer \n      extends JsonDeserializer<User> {\n\n        @Override\n        public User deserialize(JsonParser jsonParser, \n          DeserializationContext deserializationContext)\n          throws IOException, JsonProcessingException {\n\n            TreeNode treeNode = jsonParser.getCodec().readTree(jsonParser);\n            TextNode favoriteColor = (TextNode) treeNode.get(\n              "favoriteColor");\n            return new User(Color.web(favoriteColor.asText()));\n        }\n    }\n}\n')),(0,i.kt)("h3",{id:"2722-jackson-\u5728-springboot-\u4e2d\u7684\u914d\u7f6e"},"27.2.2. Jackson \u5728 springboot \u4e2d\u7684\u914d\u7f6e"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"spring.jackson.date-format\u6307\u5b9a\u65e5\u671f\u683c\u5f0f\uff0c\u6bd4\u5982yyyy-MM-dd HH:mm:ss\uff0c\u6216\u8005\u5177\u4f53\u7684\u683c\u5f0f\u5316\u7c7b\u7684\u5168\u9650\u5b9a\u540d\n\nspring.jackson.deserialization\u662f\u5426\u5f00\u542fJackson\u7684\u53cd\u5e8f\u5217\u5316\n\nspring.jackson.generator\u662f\u5426\u5f00\u542fjson\u7684generators.\n\nspring.jackson.joda-date-time-format\u6307\u5b9aJoda date/time\u7684\u683c\u5f0f\uff0c\u6bd4\u5982yyyy-MM-ddHH:mm:ss). \u5982\u679c\u6ca1\u6709\u914d\u7f6e\u7684\u8bdd\uff0cdateformat\u4f1a\u4f5c\u4e3abackup\n\nspring.jackson.locale\u6307\u5b9ajson\u4f7f\u7528\u7684Locale.\n\nspring.jackson.mapper\u662f\u5426\u5f00\u542fJackson\u901a\u7528\u7684\u7279\u6027.\n\nspring.jackson.parser\u662f\u5426\u5f00\u542fjackson\u7684parser\u7279\u6027.\n\nspring.jackson.property-naming-strategy\u6307\u5b9aPropertyNamingStrategy(CAMEL_CASE_TO_LOWER_CASE_WITH_UNDERSCORES)\u6216\u8005\u6307\u5b9aPropertyNamingStrategy\u5b50\u7c7b\u7684\u5168\u9650\u5b9a\u7c7b\u540d.\n\nspring.jackson.serialization\u662f\u5426\u5f00\u542fjackson\u7684\u5e8f\u5217\u5316.\n\nspring.jackson.serialization-inclusion\u6307\u5b9a\u5e8f\u5217\u5316\u65f6\u5c5e\u6027\u7684inclusion\u65b9\u5f0f\uff0c\u5177\u4f53\u67e5\u770bJsonInclude.Include\u679a\u4e3e.\n\nspring.jackson.time-zone\u6307\u5b9a\u65e5\u671f\u683c\u5f0f\u5316\u65f6\u533a\uff0c\u6bd4\u5982America/Los_Angeles\u6216\u8005GMT+10\n")),(0,i.kt)("h3",{id:"2723-jackson\u6ce8\u89e3"},"27.2.3. jackson\u6ce8\u89e3"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@JsonIgnore \u6b64\u6ce8\u89e3\u7528\u4e8e\u5c5e\u6027\u4e0a\uff0c\u4f5c\u7528\u662f\u8fdb\u884cJSON\u64cd\u4f5c\u65f6\u5ffd\u7565\u8be5\u5c5e\u6027\u3002\n@JsonIgnoreProperties(value = { "intValue" }) on type, \u5ffd\u7565\u6307\u5b9a\u5c5e\u6027\n@JsonIgnoreType on type \u5ffd\u7565\u6240\u6709\u5c5e\u6027\n        //or @JsonIgnoreType on mixin type(empty type) to ignore fields of the type which we have no access to\n        //        mapper.addMixIn(String[].class, MyMixInForIgnoreType.class);//MyMixInForIgnoreType is empty\n        //Note: Since version 2.5 \u2013 it seems that we can not use this method to ignore primitive data types, but we can use it for custom data types and arrays.\n@JsonFormat \u6b64\u6ce8\u89e3\u7528\u4e8e\u5c5e\u6027\u4e0a\uff0c\u4f5c\u7528\u662f\u628aDate\u7c7b\u578b\u76f4\u63a5\u8f6c\u5316\u4e3a\u60f3\u8981\u7684\u683c\u5f0f\uff0c\u5982@JsonFormat(pattern = \u201cyyyy-MM-dd HH-mm-ss\u201d)\u3002\n@JsonProperty \u6b64\u6ce8\u89e3\u7528\u4e8e\u5c5e\u6027\u4e0a\uff0c\u4f5c\u7528\u662f\u628a\u8be5\u5c5e\u6027\u7684\u540d\u79f0\u5e8f\u5217\u5316\u4e3a\u53e6\u5916\u4e00\u4e2a\u540d\u79f0\uff0c\u5982\u628atrueName\u5c5e\u6027\u5e8f\u5217\u5316\u4e3aname\uff0c@JsonProperty(\u201cname\u201d)\u3002\n@JsonValue \u7528\u4e8e\u5c5e\u6027/get\u65b9\u6cd5\u4e0a, \u4e00\u4e2a\u7c7b\u53ea\u80fd\u7528\u4e00\u4e2a, \u76f8\u5f53\u4e8e\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316, \u5f53\u52a0\u4e0a@JsonValue\u6ce8\u89e3\uff0c\u5e8f\u5217\u5316\u662f\u53ea\u8fd4\u56de\u8fd9\u4e00\u4e2a\u5b57\u6bb5\u7684\u503c/\u65b9\u6cd5\u7684\u503c\u4f5c\u4e3a\u5f53\u524d\u5bf9\u8c61\u7684\u503c\n@JsonRawValue on json string field to serialize raw json string\n')),(0,i.kt)("h3",{id:"2724-objectmapper-\u5b9a\u5236"},"27.2.4. objectmapper \u5b9a\u5236"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.kancloud.cn/ahutchen/spring-boot-reference-guide/333370"},"https://www.kancloud.cn/ahutchen/spring-boot-reference-guide/333370")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Bean\n    public ObjectMapper objectMapper() {\n        ObjectMapper objectMapper = new ObjectMapper();\n\n        /*\n        >>> serialization config\n         */\n         //\u5e8f\u5217\u5316\u7684\u65f6\u5019\u5e8f\u5217\u5bf9\u8c61\u7684\u6240\u6709\u5c5e\u6027\n        //          JsonInclude.Include.NON_NULL \u5ffd\u7565 null \u503c\n        //          Include.NON_EMPTY \u5982\u679c\u4e3anull\u6216\u8005 \u7a7a\u5b57\u7b26\u4e32\u548c\u7a7a\u96c6\u5408\u90fd\u4e0d\u4f1a\u88ab\u5e8f\u5217\u5316\n        objectMapper.setSerializationInclusion(Include.ALWAYS);\n        \n        //\u5982\u679c\u662f\u7a7a\u5bf9\u8c61\u7684\u65f6\u5019,\u4e0d\u629b\u5f02\u5e38\n        objectMapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);\n\n        // \u683c\u5f0f\u5316\u8f93\u51fa\n        objectMapper.configure(SerializationFeature.INDENT_OUTPUT, true);\n        //or\n            mapper.enable(SerializationFeature.INDENT_OUTPUT);\n\n\n        // \u81ea\u5b9a\u4e49\u65f6\u95f4\u683c\u5f0f\n        //\u53d6\u6d88\u65f6\u95f4\u7684\u8f6c\u5316\u683c\u5f0f,\u9ed8\u8ba4\u662f\u65f6\u95f4\u6233,\u53ef\u4ee5\u53d6\u6d88,\u540c\u65f6\u9700\u8981\u8bbe\u7f6e\u8981\u8868\u73b0\u7684\u65f6\u95f4\u683c\u5f0f\n        objectMapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, false);// \u9ed8\u8ba4\u4e3atrue,\u4f1a\u663e\u793a\u65f6\u95f4\u6233\n        objectMapper.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"))\n\n        //  config filter\n        //\n//        new SimpleBeanPropertyFilter.FilterExceptFilter()\n//        objectMapper.setFilterProvider()\n\n\n\n\n\n        /*\n        >>> deserialization config\n         */\n        //\u53cd\u5e8f\u5217\u5316\u7684\u65f6\u5019\u5982\u679c\u591a\u4e86\u5176\u4ed6\u5c5e\u6027,\u4e0d\u629b\u51fa\u5f02\u5e38\n        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n\n\n\n\n\n        //@JsonValue \u53ef\u4ee5\u7528\u5728get\u65b9\u6cd5\u6216\u8005\u5c5e\u6027\u5b57\u6bb5\u4e0a\uff0c\u4e00\u4e2a\u7c7b\u53ea\u80fd\u7528\u4e00\u4e2a\uff0c\u5f53\u52a0\u4e0a@JsonValue\u6ce8\u89e3\u662f\uff0c\u5e8f\u5217\u5316\u662f\u53ea\u8fd4\u56de\u8fd9\u4e00\u4e2a\u5b57\u6bb5\u7684\u503c\n\n        //@JsonRootName(value = "user") to wrapper a root property for output json\n\n        //@JsonSerialize(using = CustomDateSerializer.class) on field to specify a customized serializer\n        // ex: class CustomDateSerializer extends StdSerializer<Date>\n\n        return objectMapper;\n    }\n\n')),(0,i.kt)("h3",{id:"2725-objectmapper-\u4f7f\u7528"},"27.2.5. objectmapper \u4f7f\u7528"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'\n// >>> \u5e8f\u5217\u5316\u6570\u7ec4\n\nPerson person1 = new Person(1, "zxc", new Date());\nPerson person2 = new Person(2, "ldh", new Date());\nList<Person> persons = new ArrayList<>();\npersons.add(person1);\npersons.add(person2);\nString personStr = objectMapper.writeValueAsString(persons);\n\n//\u53cd\u5e8f\u5217\u5316\u4e3aList<user> \u96c6\u5408,1\u9700\u8981\u901a\u8fc7 TypeReference \u6765\u5177\u4f53\u4f20\u9012\u503c\nList<Person> persons2 = objectMapper.readValue(personStr, new TypeReference<List<Person>>() {});\n//or \n//\u901a\u8fc7 JavaType \u6765\u8fdb\u884c\u5904\u7406\u8fd4\u56de\nJavaType javaType = objectMapper.getTypeFactory().constructParametricType(List.class, Person.class);\nList<Person> persons3 = objectMapper.readValue(personStr, javaType);\n')),(0,i.kt)("h1",{id:"28-\u63a5\u5165\u7b2c\u4e09\u65b9\u652f\u4ed8"},"28. \u63a5\u5165\u7b2c\u4e09\u65b9\u652f\u4ed8"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/Javen205/IJPay"},"https://github.com/Javen205/IJPay")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/egzosn/pay-java-parent"},"https://github.com/egzosn/pay-java-parent"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/egzosn/pay-spring-boot-starter-parent"},"https://github.com/egzosn/pay-spring-boot-starter-parent")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/Pay-Group/best-pay-sdk"},"https://github.com/Pay-Group/best-pay-sdk")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/iyangyuan/pay-spring-boot"},"https://github.com/iyangyuan/pay-spring-boot")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/jeequan/jeepay"},"https://github.com/jeequan/jeepay")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/roncoo/roncoo-pay"},"https://github.com/roncoo/roncoo-pay")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/Exrick/xpay"},"https://github.com/Exrick/xpay")," \u4e2a\u4eba\u6536\u6b3e"),(0,i.kt)("h1",{id:"29-\u62fe\u9057"},"29. \u62fe\u9057"),(0,i.kt)("h2",{id:"291-bean-\u61d2\u52a0\u8f7d"},"29.1. bean \u61d2\u52a0\u8f7d"),(0,i.kt)("p",null,"\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSpring\u5bb9\u5668\u5728\u542f\u52a8\u65f6\u4f1a\u521b\u5efa\u6240\u6709\u7684Bean\u5bf9\u8c61\uff0c\u4f7f\u7528@Lazy\u6ce8\u89e3 (\u548c @Component \u5171\u540c\u4f7f\u7528) \u53ef\u4ee5\u5c06Bean\u5bf9\u8c61\u7684\u521b\u5efa\u5ef6\u8fdf\u5230\u7b2c\u4e00\u6b21\u4f7f\u7528Bean\u7684\u65f6\u5019"))}d.isMDXComponent=!0}}]);