---
title: PythonğŸŒˆ
date: 2015-02-10 22:19:59
tags: [python]
toc_min_heading_level: 2
toc_max_heading_level: 5
---

https://github.com/g1879/DrissionPage

https://github.com/VinciGit00/Scrapegraph-ai åŸºäº ai çˆ¬è™«
https://blog.csdn.net/m0_51156601/article/details/126886040 playwright 

https://github.com/crazyguitar/pysheeet?tab=readme-ov-file py å®ç°çš„å°åŠŸèƒ½

https://github.com/vinta/awesome-python

https://www.pythonweekly.com/

https://python-patterns.guide/

https://github.com/faif/python-patterns?utm_source=bestxtools.com

https://github.com/qiandao-today/qiandao ç­¾åˆ°æ¡†æ¶

æŠ€æœ¯æ ˆ Flask ã€peewee ã€Celery ã€MySQL ã€Redis

https://github.com/xuanhun/PythonHackingBook1 é»‘å®¢

https://www.osgeo.cn/python-guide/scenarios/web.html#heroku
https://learnku.com/docs/python-guide/2018/structure/3260#f294d6

https://learnku.com/articles/23010/teach-you-to-read-the-python-open-source-project-code ä»£ç é˜…è¯»

https://github.com/HT524/500LineorLess_CN å®ç°ç®€å•ç³»ç»Ÿ

https://github.com/iswbm/pycharm-guide
https://github.com/iswbm

https://zhuanlan.zhihu.com/p/24132781 ç»éªŒç®€å†

https://github.com/lalor è¿ç»´å¤§ç‰›

https://github.com/jobbole/awesome-python-cn
https://github.com/vinta/awesome-python

https://python-web-guide.readthedocs.io/zh/latest/index.html å·¥ç¨‹å®è·µ ç»éªŒåˆ†äº«

https://learnku.com/docs/python-guide/2018 æŠ€æœ¯æ ˆ

https://bramblexu.com/posts/b1c0cc4f/#toc-heading-5 vscode é…ç½® 


https://www.zhihu.com/question/19827960 æŒ‡çš„å…³æ³¨çš„ç¤¾åŒº

<!--truncate-->

- [1. ä»‹ç»](#1-ä»‹ç»)
    - [1.1. python ç‰¹ç‚¹](#11-python-ç‰¹ç‚¹)
    - [1.2. python å®‰è£…](#12-python-å®‰è£…)
    - [1.3. pythonå‡çº§](#13-pythonå‡çº§)
    - [1.4. vscode ç¯å¢ƒé…ç½®](#14-vscode-ç¯å¢ƒé…ç½®)
    - [1.5. è®¾ç½®å›½å†…pipæº](#15-è®¾ç½®å›½å†…pipæº)
    - [1.6. è§£é‡Šå™¨](#16-è§£é‡Šå™¨)
    - [1.7. kite æ’ä»¶ä½¿ç”¨](#17-kite-æ’ä»¶ä½¿ç”¨)
- [2. è¯­æ³•](#2-è¯­æ³•)
    - [2.1. è¾“å…¥è¾“å‡º æ‰“å° mainé­”æ³•å˜é‡](#21-è¾“å…¥è¾“å‡º-æ‰“å°-mainé­”æ³•å˜é‡)
    - [2.2. åŸºæœ¬æ•°æ®ç±»å‹](#22-åŸºæœ¬æ•°æ®ç±»å‹)
        - [2.2.1. å­—ç¬¦ä¸²](#221-å­—ç¬¦ä¸²)
            - [2.2.1.1. å¤šè¡Œ ä¸å¯å˜ æ¯”è¾ƒ](#2211-å¤šè¡Œ-ä¸å¯å˜-æ¯”è¾ƒ)
            - [2.2.1.2. ç¼–ç  å­—ç¬¦å¤„ç†](#2212-ç¼–ç -å­—ç¬¦å¤„ç†)
            - [2.2.1.3. æ ¼å¼åŒ–](#2213-æ ¼å¼åŒ–)
            - [2.2.1.4. å­—ç¬¦ä¸²æ–¹æ³•](#2214-å­—ç¬¦ä¸²æ–¹æ³•)
        - [2.2.2. å­—èŠ‚ bytes](#222-å­—èŠ‚-bytes)
        - [2.2.3. æ•°å­—](#223-æ•°å­—)
        - [2.2.4. å¸ƒå°”å€¼ ç©ºå€¼](#224-å¸ƒå°”å€¼-ç©ºå€¼)
        - [2.2.5. é›†åˆ](#225-é›†åˆ)
            - [2.2.5.1. æœ‰åºå¯å˜ list](#2251-æœ‰åºå¯å˜-list)
            - [2.2.5.2. åˆ‡ç‰‡ slices](#2252-åˆ‡ç‰‡-slices)
            - [2.2.5.3. æœ‰åºä¸å¯å˜åˆ—è¡¨ tuple](#2253-æœ‰åºä¸å¯å˜åˆ—è¡¨-tuple)
            - [2.2.5.4. æ— åºä¸å¯é‡å¤ set](#2254-æ— åºä¸å¯é‡å¤-set)
        - [2.2.6. é”®å€¼å­˜å‚¨ å­—å…¸ dict](#226-é”®å€¼å­˜å‚¨-å­—å…¸-dict)
        - [2.2.7. åˆ—è¡¨æ¨å¯¼å¼](#227-åˆ—è¡¨æ¨å¯¼å¼)
        - [2.2.8. ç”Ÿæˆå™¨ generator](#228-ç”Ÿæˆå™¨-generator)
        - [2.2.9. è¿­ä»£å™¨](#229-è¿­ä»£å™¨)
    - [2.3. æ¡ä»¶å¾ªç¯](#23-æ¡ä»¶å¾ªç¯)
    - [2.4. æ¯”è¾ƒåˆ¤æ–­](#24-æ¯”è¾ƒåˆ¤æ–­)
    - [2.5. å‡½æ•°](#25-å‡½æ•°)
        - [2.5.1. å‚æ•°æ£€æŸ¥](#251-å‚æ•°æ£€æŸ¥)
        - [2.5.2. å¤šç§å‚æ•°](#252-å¤šç§å‚æ•°)
        - [2.5.3. é€’å½’](#253-é€’å½’)
        - [2.5.4. é«˜é˜¶å‡½æ•°](#254-é«˜é˜¶å‡½æ•°)
    - [2.6. æ–‡ä»¶å¤„ç†](#26-æ–‡ä»¶å¤„ç†)
        - [2.6.1. åˆ›å»ºæ–‡ä»¶](#261-åˆ›å»ºæ–‡ä»¶)
        - [2.6.2. è¯»å†™æ–‡ä»¶æ•°æ®](#262-è¯»å†™æ–‡ä»¶æ•°æ®)
    - [2.7. è£…é¥°å™¨](#27-è£…é¥°å™¨)
    - [2.8. æ¨¡å— ä½œç”¨åŸŸ](#28-æ¨¡å—-ä½œç”¨åŸŸ)
    - [2.9. é¢å‘å¯¹è±¡](#29-é¢å‘å¯¹è±¡)
        - [2.9.1. ç±»](#291-ç±»)
        - [2.9.2. ç»§æ‰¿ é¸­å­ç±»å‹](#292-ç»§æ‰¿-é¸­å­ç±»å‹)
        - [2.9.3. åˆ¤æ–­ç±»å‹ä¿¡æ¯](#293-åˆ¤æ–­ç±»å‹ä¿¡æ¯)
        - [2.9.4. åŠ¨æ€æ“ä½œ](#294-åŠ¨æ€æ“ä½œ)
        - [2.9.5. é­”æœ¯æ–¹æ³•](#295-é­”æœ¯æ–¹æ³•)
        - [2.9.6. æšä¸¾](#296-æšä¸¾)
        - [2.9.7. å®ä¾‹æ–¹æ³• ç±»æ–¹æ³• é™æ€æ–¹æ³•](#297-å®ä¾‹æ–¹æ³•-ç±»æ–¹æ³•-é™æ€æ–¹æ³•)
    - [2.10. é”™è¯¯å¼‚å¸¸å¤„ç†](#210-é”™è¯¯å¼‚å¸¸å¤„ç†)
- [3. å·¥ç¨‹åŒ–](#3-å·¥ç¨‹åŒ–)
    - [cookiecutter é¡¹ç›®æ¨¡æ¿](#cookiecutter-é¡¹ç›®æ¨¡æ¿)
    - [Setuptools: ç®¡ç†ä¾èµ–ã€æ„å»ºå’Œå‘å¸ƒ](#setuptools-ç®¡ç†ä¾èµ–æ„å»ºå’Œå‘å¸ƒ)
    - [è™šæ‹Ÿç¯å¢ƒ](#è™šæ‹Ÿç¯å¢ƒ)
    - [devops æ„å»ºæµæ°´çº¿](#devops-æ„å»ºæµæ°´çº¿)
    - [å‘å¸ƒè‡ªå®šä¹‰åº“](#å‘å¸ƒè‡ªå®šä¹‰åº“)
    - [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
    - [æ¨¡å—å¼•å…¥ importåŸç†](#æ¨¡å—å¼•å…¥-importåŸç†)
    - [ç±»å‹æ£€è½¦ type hints](#ç±»å‹æ£€è½¦-type-hints)
    - [linter å·¥å…·](#linter-å·¥å…·)
    - [ä¾èµ–å®‰å…¨æ€§æ£€æŸ¥](#ä¾èµ–å®‰å…¨æ€§æ£€æŸ¥)
    - [ä»£ç é£æ ¼ æ ¼å¼åŒ–](#ä»£ç é£æ ¼-æ ¼å¼åŒ–)
    - [é…ç½®æ–‡ä»¶ç®¡ç†](#é…ç½®æ–‡ä»¶ç®¡ç†)
    - [æµ‹è¯•test](#æµ‹è¯•test)
        - [å•å…ƒæµ‹è¯• unittest](#å•å…ƒæµ‹è¯•-unittest)
        - [æ€§èƒ½å‹æµ‹](#æ€§èƒ½å‹æµ‹)
        - [é›†æˆæµ‹è¯• integration test](#é›†æˆæµ‹è¯•-integration-test)
    - [3.1. åŒ…ç®¡ç†](#31-åŒ…ç®¡ç†)
        - [rye ä½¿ç”¨](#rye-ä½¿ç”¨)
        - [uv](#uv)
    - [3.2. æ—¥å¿—](#32-æ—¥å¿—)
    - [ç”Ÿæˆæ–‡æ¡£](#ç”Ÿæˆæ–‡æ¡£)
- [4. å¤šè¿›ç¨‹](#4-å¤šè¿›ç¨‹)
- [5. å¼‚æ­¥](#5-å¼‚æ­¥)
- [6. å†…å»ºæ¨¡å—](#6-å†…å»ºæ¨¡å—)
    - [6.1. æ—¥æœŸå¤„ç†](#61-æ—¥æœŸå¤„ç†)
    - [6.2. é›†åˆ](#62-é›†åˆ)
- [7. ç¼–å†™å‘½ä»¤è¡Œç¨‹åº](#7-ç¼–å†™å‘½ä»¤è¡Œç¨‹åº)
    - [7.1. å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨](#71-å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨)
- [8. ç±»å‹ç³»ç»Ÿ type-hint](#8-ç±»å‹ç³»ç»Ÿ-type-hint)
- [9. è°ƒè¯•](#9-è°ƒè¯•)
    - [9.1. æ–­è¨€](#91-æ–­è¨€)
    - [9.2. è®¾ç½®æ–­ç‚¹ pdb](#92-è®¾ç½®æ–­ç‚¹-pdb)
- [10. jinja2 æ¨¡æ¿](#10-jinja2-æ¨¡æ¿)
- [11. è·¯å¾„é—®é¢˜](#11-è·¯å¾„é—®é¢˜)
    - [11.1. æ–‡ä»¶è·¯å¾„ and ç»ˆç«¯è·¯å¾„](#111-æ–‡ä»¶è·¯å¾„-and-ç»ˆç«¯è·¯å¾„)
    - [11.2. è·å–è„šæœ¬ä½ç½®](#112-è·å–è„šæœ¬ä½ç½®)
- [12. shutil ä½¿ç”¨](#12-shutil-ä½¿ç”¨)
- [13. venv è™šæ‹Ÿç¯å¢ƒ](#13-venv-è™šæ‹Ÿç¯å¢ƒ)
- [14. web å¼€å‘](#14-web-å¼€å‘)
    - [litestar](#litestar)
    - [14.1. fastapi](#141-fastapi)
    - [14.2. Django](#142-django)
    - [14.3. flask](#143-flask)
        - [14.3.1. flaskè§£å†³è·¨åŸŸé—®é¢˜](#1431-flaskè§£å†³è·¨åŸŸé—®é¢˜)
        - [14.3.2. ä¿æŠ¤ flask api](#1432-ä¿æŠ¤-flask-api)
        - [14.3.3. å‘½ä»¤è¡Œor idea å¯åŠ¨](#1433-å‘½ä»¤è¡Œor-idea-å¯åŠ¨)
        - [14.3.4. rest api](#1434-rest-api)
        - [14.3.5. æ•°æ®åº“äº¤äº’](#1435-æ•°æ®åº“äº¤äº’)
        - [14.3.6. flask ä¸­çš„æ—¥å¿—](#1436-flask-ä¸­çš„æ—¥å¿—)
        - [14.3.7. blueprintè“å›¾ æ¨¡å—åŒ–å¼€å‘](#1437-blueprintè“å›¾-æ¨¡å—åŒ–å¼€å‘)
        - [14.3.8. ä¸Šä¸‹æ–‡å¯¹è±¡](#1438-ä¸Šä¸‹æ–‡å¯¹è±¡)
- [15. db é©±åŠ¨ é—®é¢˜](#15-db-é©±åŠ¨-é—®é¢˜)
- [16. ä»£æ›¿ shell è¿ç»´](#16-ä»£æ›¿-shell-è¿ç»´)
    - [16.1. å®ç”¨è„šæœ¬](#161-å®ç”¨è„šæœ¬)
        - [16.1.1. å‘½ä»¤è¡Œå‚æ•°è§£æ](#1611-å‘½ä»¤è¡Œå‚æ•°è§£æ)
        - [16.1.2. è·¯å¾„](#1612-è·¯å¾„)
        - [16.1.3. æ–‡ä»¶æ“ä½œ](#1613-æ–‡ä»¶æ“ä½œ)
        - [16.1.4. sh å‘½ä»¤æ‰§è¡Œ](#1614-sh-å‘½ä»¤æ‰§è¡Œ)
    - [16.2. ä¼ é€’å‘½ä»¤è¡Œå‚æ•°](#162-ä¼ é€’å‘½ä»¤è¡Œå‚æ•°)
    - [16.3. shell è°ƒç”¨ Python](#163-shell-è°ƒç”¨-python)
        - [16.3.1. shel è¯»å– Python å‡½æ•°è¿”å›å€¼](#1631-shel-è¯»å–-python-å‡½æ•°è¿”å›å€¼)
        - [16.3.2. ç»Ÿè®¡å‡ºç°æ¬¡æ•°](#1632-ç»Ÿè®¡å‡ºç°æ¬¡æ•°)
        - [16.3.3. è¯»å– csv æ–‡ä»¶](#1633-è¯»å–-csv-æ–‡ä»¶)
    - [16.4. Python è°ƒç”¨ shell](#164-python-è°ƒç”¨-shell)
        - [16.4.1. subprocess](#1641-subprocess)
        - [16.4.2. os.system](#1642-ossystem)
        - [16.4.3. os.popen](#1643-ospopen)
        - [16.4.4. system](#1644-system)
        - [16.4.5. sh](#1645-sh)
        - [16.4.6. paramiko](#1646-paramiko)
    - [16.5. éƒ¨ç½² springboot](#165-éƒ¨ç½²-springboot)
- [17. å¼€æºåº“](#17-å¼€æºåº“)
    - [æ—¥æœŸæ—¶é—´](#æ—¥æœŸæ—¶é—´)
    - [çˆ¬è™« crawler](#çˆ¬è™«-crawler)
    - [17.1. å˜å£° è¯­éŸ³åˆæˆ](#171-å˜å£°-è¯­éŸ³åˆæˆ)
    - [17.2. ç³»ç»Ÿè¿ç»´](#172-ç³»ç»Ÿè¿ç»´)
    - [17.3. å£°éŸ³](#173-å£°éŸ³)
    - [17.4. å›¾åƒ](#174-å›¾åƒ)
    - [17.5. æ•°æ®æ¨¡å‹å®šä¹‰](#175-æ•°æ®æ¨¡å‹å®šä¹‰)
    - [17.6. åºåˆ—åŒ–ååºåˆ—åŒ–](#176-åºåˆ—åŒ–ååºåˆ—åŒ–)
    - [17.7. åš web å¼€å‘](#177-åš-web-å¼€å‘)
- [è°ƒJava](#è°ƒjava)
    - [jpype](#jpype)
    - [18. jython](#18-jython)
- [19. è°ƒç”¨ rust](#19-è°ƒç”¨-rust)
- [20. cffi ç»‘å®š](#20-cffi-ç»‘å®š)
- [21. webåº”ç”¨éƒ¨ç½²](#21-webåº”ç”¨éƒ¨ç½²)
    - [21.1. ç”Ÿæˆä¾èµ–æ¸…å•](#211-ç”Ÿæˆä¾èµ–æ¸…å•)
    - [21.2. gunicorn](#212-gunicorn)
    - [21.3. supervisord ç®¡ç† daemon](#213-supervisord-ç®¡ç†-daemon)
    - [pm2](#pm2)
- [22. setup.py](#22-setuppy)
- [23. wheel](#23-wheel)
- [24. è‡ªåŠ¨æŠ¢è´­è„šæœ¬](#24-è‡ªåŠ¨æŠ¢è´­è„šæœ¬)



# 1. ä»‹ç»

## 1.1. python ç‰¹ç‚¹

python ä½œä¸ºè„šæœ¬è¯­è¨€, æ–¹æ³•å®šä¹‰è°ƒç”¨æœ‰å‰åé¡ºåº

åº“å¤š

èƒ¶æ°´è¯­è¨€, cpp äº¤äº’æ–¹ä¾¿

é¢å‘å¯¹è±¡, ç±»ä¼¼ ruby, ä½†æ˜¯æ²¡æœ‰ ruby é¢å‘å¯¹è±¡çº¯ç²¹


## 1.2. python å®‰è£…

wls é»˜è®¤è£…çš„æ˜¯ python2

```sh
# æ›´æ–°æº
apt-get update
# å®‰è£… (æˆ‘çš„wls æ˜¯ Ubuntu)
apt-get install python3
# éªŒè¯
python3 --version

```

## 1.3. pythonå‡çº§

https://www.cnblogs.com/dotnetcrazy/p/9360831.html

http://npm.taobao.org/mirrors Python å‹ç¼©åŒ…é•œåƒä¸‹è½½

```sh
wget http://npm.taobao.org/mirrors/python/3.9.4/Python-3.9.4.tgz
tar -xzvf Python-3.9.4.tgz
# è®¾ç½®ä¸€ä¸‹é…ç½®æ–‡ä»¶
cd Pythonxxx
./configure prefix=/usr/local/python3.7
# centos
# ï¼ˆyumå®‰è£…æ²¡æœ‰aptå®‰è£…æ–¹ä¾¿ï¼‰
make && make install
# è®¾ç½®è½¯é“¾æ¥ï¼š
ln -s /usr/local/python3/bin/python3 /usr/bin/python3



```

## 1.4. vscode ç¯å¢ƒé…ç½®


[wsl ä¸­ä½¿ç”¨ vscode](https://code.visualstudio.com/docs/remote/wsl#_getting-started)

[wsl install python3.7, ä¿®æ”¹å¿«æ·æ–¹å¼](https://blog.csdn.net/u014775723/article/details/85213793)

```sh
# install python
sudo apt-get install python3.7
# check py version
python3 --version
# install pip3
apt-get install python3-pip
# check pip version
pip3 --version

```

vscode å®‰è£…å®Œ python æ’ä»¶å, ä¼šæœ‰ pylint (åŒç±» flake8) æ’ä»¶å®‰è£…æç¤º, ä¹Ÿå¯èƒ½æ²¡æœ‰ pylint å®‰è£…æç¤º, é‚£ä¹ˆéœ€è¦æ‰‹åŠ¨è®¾ç½® `.vscode/settings.json`:

(pylint æ¯” flake8 æ›´ä¸¥æ ¼ï¼Œé—®é¢˜æè¿°ä¹Ÿæ›´ç²¾å‡†ï¼Œé€Ÿåº¦è¾ƒåè€…æ…¢ä¸€äº›ã€‚pylint çš„ä¸¥æ ¼ä¸å¦‚è¯´æœ‰äº›ä¸¥è‹›äº†ï¼Œç»å¸¸å•°é‡Œå•°å—¦æŠ¥å‡ºä¸€å¤§ä¸²é—®é¢˜ï¼Œæ ¹æ®åœºæ™¯ä¸åŒï¼Œå¯èƒ½éœ€è¦é…ç½®è®¸å¤šå¿½ç•¥é¡¹)

```json
"python.pythonPath": "/usr/bin/python",
  "python.linting.pylintEnabled": true,
  "python.linting.enabled": true
```

autopep8 æ ¼å¼åŒ–ä»£ç åº“, vscode ä¼šè‡ªåŠ¨æç¤º (åŒç±»æ˜¯ black, yapf)

Coverage æœ‰å¤šç§å‘ä½ æŠ¥å‘Šæµ‹è¯•è¦†ç›–ç‡çš„æ–¹å¼ï¼ŒåŒ…æ‹¬å°†ç»“æœè¾“å‡ºåˆ°æ§åˆ¶å°æˆ– HTML é¡µé¢ï¼Œå¹¶æç¤ºå“ªäº›è¡Œå·æ²¡æœ‰è¦†ç›–åˆ°ã€‚ä½ å¯ä»¥è®¾ç½®é…ç½®æ–‡ä»¶ä»¥è‡ªå®šä¹‰ Coverage æ£€æŸ¥çš„å†…å®¹å¹¶ä½¿å…¶æ›´ä¾¿äºè¿è¡Œ

## 1.5. è®¾ç½®å›½å†…pipæº

```
sudo vim ~/.pip/pip.conf  

[global] 
index-url = https://pypi.tuna.tsinghua.edu.cn/simple
[install]
trusted-host = https://pypi.tuna.tsinghua.edu.cn  # trusted-host æ­¤å‚æ•°æ˜¯ä¸ºäº†é¿å…éº»çƒ¦ï¼Œå¦åˆ™ä½¿ç”¨çš„æ—¶å€™å¯èƒ½ä¼šæç¤ºä¸å—ä¿¡ä»»

```

or

https://mirrors.tuna.tsinghua.edu.cn/help/pypi/


```
é˜¿é‡Œäº‘ http://mirrors.aliyun.com/pypi/simple/

ä¸­å›½ç§‘æŠ€å¤§å­¦ https://pypi.mirrors.ustc.edu.cn/simple/

è±†ç“£(douban) http://pypi.douban.com/simple/ æ¸…åå¤§å­¦

https://pypi.tuna.tsinghua.edu.cn/simple/ ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦

http://pypi.mirrors.ustc.edu.cn/simple/

```

## 1.6. è§£é‡Šå™¨

CPython (é»˜è®¤)

PyPy, é‡‡ç”¨ JIT æŠ€æœ¯ï¼Œå¯¹ Python ä»£ç è¿›è¡ŒåŠ¨æ€ç¼–è¯‘, PyPy å’Œ CPython æœ‰ä¸€äº›æ˜¯ä¸åŒçš„ï¼Œè¿™å°±å¯¼è‡´ç›¸åŒçš„ Python ä»£ç åœ¨ä¸¤ç§è§£é‡Šå™¨ä¸‹æ‰§è¡Œå¯èƒ½ä¼šæœ‰ä¸åŒçš„ç»“æœ

Jython, ç›´æ¥æŠŠ Python ä»£ç ç¼–è¯‘æˆ Java å­—èŠ‚ç æ‰§è¡Œ

IronPython, æŠŠ Python ä»£ç ç¼–è¯‘æˆ.Net çš„å­—èŠ‚ç ã€‚

å¦‚æœè¦å’Œ Java æˆ–.Net å¹³å°äº¤äº’ï¼Œæœ€å¥½çš„åŠæ³•ä¸æ˜¯ç”¨ Jython æˆ– IronPythonï¼Œè€Œæ˜¯é€šè¿‡ç½‘ç»œè°ƒç”¨æ¥äº¤äº’ï¼Œç¡®ä¿å„ç¨‹åºä¹‹é—´çš„ç‹¬ç«‹æ€§ã€‚

## 1.7. kite æ’ä»¶ä½¿ç”¨

# 2. è¯­æ³•

## 2.1. è¾“å…¥è¾“å‡º æ‰“å° mainé­”æ³•å˜é‡

```py
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# ä»¥ä¸Šä¸¤è¡Œè¡¨ç¤ºpython è§£é‡Šå™¨ç‰ˆæœ¬ï¼›ä»¥utf-8ç¼–ç 

# æ¨¡å—çš„æ–‡æ¡£æ³¨é‡Š
' a test module '

__author__ = 'xiaoyu'


def hello_print():
    '''æ–¹æ³•æ³¨é‡Š
    å¯ä»¥é€šè¿‡ hello_print.__doc__ è·å–, æˆ–è€… help(hello_print) è·å–æ–‡æ¡£å­—ç¬¦ä¸²
    '''
    print("Hello world!")
    print("aa", "bb", "ccc")  # ç±»ä¼¼

    # é—´éš”
    print(1, 2, 3, sep="   ")  # 1   2   3
    # ä¸æ¢è¡Œ
    print('hello', end='')
    print('æ²¡æ¢è¡Œ')  # helloæ²¡æ¢è¡Œ

    # å‘½ä»¤è¡Œè¾“å…¥
    # name = input('please enter your name: ')
    # print(name)


# 
# å‘½ä»¤è¡Œimportæ–¹å¼è°ƒ æœ¬æ–‡ä»¶ä¸­çš„æ–¹æ³•, å°†ä¸è¿›å…¥ifåˆ¤æ–­ï¼Œæ­¤æ—¶é€šè¿‡ main.xxx() è°ƒç”¨
# å¦‚æœç›´æ¥ python main.py, åˆ™è¿›å…¥ if
if __name__ == "__main__":
    hello_print()

```


## 2.2. åŸºæœ¬æ•°æ®ç±»å‹

### 2.2.1. å­—ç¬¦ä¸² 

#### 2.2.1.1. å¤šè¡Œ ä¸å¯å˜ æ¯”è¾ƒ

```py
# å­—ç¬¦ä¸²
    a='a'
    b="b"
    c="I'm xy."
    d='I\'m \"OK\"!'
    # r'' å½¢å¼çš„é»˜è®¤ä¸è½¬ä¹‰
    e=r'\\\t\\'
    f='''å¤šè¡Œå†…å®¹'''


# str æ˜¯ä¸å¯å˜å¯¹è±¡
    # ä¸å¯å˜å¯¹è±¡ä¸å¯ä¿®æ”¹ï¼Œä¸€æ—¦ä¿®æ”¹ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡, ä¹Ÿå°±æ˜¯ id(a) çš„åœ°å€ä¸åŒäº†
    # >>> a = 'abc'
    # >>> a.replace('a', 'A')
    # 'Abc'
    # >>> a
    # 'abc'


# æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒ ä½¿ç”¨ ==, è¿™ç‚¹å’Œ java ä¸åŒ
# ä¸è¦ä½¿ç”¨ is, is æ¯”è¾ƒçš„æ˜¯ å¼•ç”¨åœ°å€æ˜¯å¦ç›¸åŒ, == æ¯”è¾ƒçš„æ‰æ˜¯æ˜¯å†…å®¹
# is, is not å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªå˜é‡çš„å†…å­˜åœ°å€
# ==,!= å¯¹æ¯”çš„æ˜¯ä¸¤ä¸ªå˜é‡çš„å€¼
if 'ab' == 'ab':
    print('ab == ab')
```

#### 2.2.1.2. ç¼–ç  å­—ç¬¦å¤„ç†

```py
 ### ç¼–ç å¤„ç† å­—ç¬¦å¤„ç†
    #
    # å­—ç¬¦
    # å­—ç¬¦ç¼–ç 
    # ord:æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºASCII    bin:æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆäºŒè¿›åˆ¶
    # oct:æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆå…«è¿›åˆ¶    hex:æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆ16è¿›åˆ¶
    #>>> ord('A')
    #65
    #>>> ord('ä¸­')
    #20013
    #>>> chr(66)
    #'B'
    #>>> chr(25991)
    #'æ–‡'
    #>>> 'u4e2du6587'
    #'ä¸­æ–‡'

    # s1=uâ€™å“ˆâ€™
    # type(uâ€™å“ˆâ€™)ï¼Œåˆ™ä¼šå¾—åˆ°<type â€˜unicodeâ€™>ï¼Œä¹Ÿå°±æ˜¯åœ¨å­—ç¬¦å‰é¢åŠ uå°±è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªunicodeå¯¹è±¡ï¼Œè¿™ä¸ªå­—ä¼šä»¥unicodeæ ¼å¼å­˜åœ¨äºå†…å­˜ä¸­
    # å¦‚æœä¸åŠ uï¼Œè¡¨æ˜è¿™ä»…ä»…æ˜¯ä¸€ä¸ªä½¿ç”¨æŸç§ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œç¼–ç æ ¼å¼å–å†³äºpythonå¯¹æºç æ–‡ä»¶ç¼–ç çš„è¯†åˆ«ï¼Œå¦‚ # -*- coding: utf-8 -*-
    # https://www.cnblogs.com/yyxayz/p/4044528.html


    # å­—èŠ‚
    # å¦‚æœè¦åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œæˆ–è€…ä¿å­˜åˆ°ç£ç›˜ä¸Šï¼Œå°±éœ€è¦æŠŠstrå˜ä¸ºä»¥å­—èŠ‚ä¸ºå•ä½çš„bytesã€‚
    # Pythonå¯¹bytesç±»å‹çš„æ•°æ®ç”¨å¸¦bå‰ç¼€çš„å•å¼•å·æˆ–åŒå¼•å·è¡¨ç¤ºï¼š
    # x = b'ABC'
    # # print("hello...")
    # >>> 'ABC'.encode('ascii')
    # b'ABC'
    # >>> 'ä¸­æ–‡'.encode('utf-8')
    # b'xe4xb8xadxe6x96x87'
    # >>> b'ABC'.decode('ascii')
    # 'ABC'
    # >>>b'xe4xb8xadxe6x96x87'.decode('utf-8')
    # 'ä¸­æ–‡'
    # >>> len('ABC')
    # 3
    # >>> len('ä¸­æ–‡')
    # 2
```

#### 2.2.1.3. æ ¼å¼åŒ–

```py
# æ ¼å¼åŒ– å ä½ç¬¦
    #
    # %sè¡¨ç¤ºç”¨å­—ç¬¦ä¸²æ›¿æ¢ï¼Œ%dè¡¨ç¤ºç”¨æ•´æ•°æ›¿æ¢ï¼Œæœ‰å‡ ä¸ª%?å ä½ç¬¦ï¼Œåé¢å°±è·Ÿå‡ ä¸ªå˜é‡æˆ–è€…å€¼ï¼Œé¡ºåºè¦å¯¹åº”å¥½ã€‚å¦‚æœåªæœ‰ä¸€ä¸ª%?ï¼Œæ‹¬å·å¯ä»¥çœç•¥
    # å¦‚æœä½ ä¸å¤ªç¡®å®šåº”è¯¥ç”¨ä»€ä¹ˆï¼Œ%sæ°¸è¿œèµ·ä½œç”¨ï¼Œå®ƒä¼šæŠŠä»»ä½•æ•°æ®ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²
    print('Hi, %s, you have $%d.' % ('Michael', 1000000))
    # 'Hi, Michael, you have $1000000.'
    #
    print("{} {}".format("hello", "world"))   # ä¸è®¾ç½®æŒ‡å®šä½ç½®ï¼ŒæŒ‰é»˜è®¤é¡ºåº
    print("{0} {1}".format("hello", "world"))  # è®¾ç½®æŒ‡å®šä½ç½®
    print('hello {name}'.format(name='xiaoyu'))
    # é€šè¿‡å­—å…¸è®¾ç½®å‚æ•°
    site = {"name": "xi", "url": "xiaoyureed.github.io"}
    print("ç½‘ç«™åï¼š{name}, åœ°å€ {url}".format(**site))
    # é€šè¿‡åˆ—è¡¨ç´¢å¼•è®¾ç½®å‚æ•°
    my_list = ['hello', 'world']
    print("ç½‘ç«™åï¼š{0[0]}, åœ°å€ {0[1]}".format(my_list))  # "0" æ˜¯å¿…é¡»çš„
    # ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ 
    # my_value = {"value": "hello"}
    # print('value ä¸º: {0.value}'.format(my_value))  # "0" æ˜¯å¯é€‰çš„, my_value å¯¹è±¡éœ€è¦æœ‰ value å±æ€§

    # æ ¼å¼åŒ–æ•°å­—
    print("{:.2f}".format(3.1415926))  # 3.14
```

#### 2.2.1.4. å­—ç¬¦ä¸²æ–¹æ³•

```py

 #
    # å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•
    #
    #
    len(b'ABC')  # 3
    len(b'xe4xb8xadxe6x96x87')  # 6
    len('ä¸­æ–‡'.encode('utf-8'))
    # 6

    # count(xxx) æŸä¸ªå…ƒç´ å‡ºç°æ¬¡æ•°
    # è®¡ç®—è¡Œæ•°
    myString = '''line1
sf
sdfsf
sdfs
    '''
    print(myString)
    c = myString.count("\n")+(not myString.endswith("\n"))
    print(c)  # 5
    # or
    c1 = myString.count("\n")+[1, 0][myString.endswith("\n")]
    print(c1)  # 5

    # æŸ¥æ‰¾
    find = myString.find("sf")
    print("find = ", find)  # 6, ä» 0 å¼€å§‹, ç¬¬ 6 ä¸ªå­—ç¬¦
    find1 = myString.find("220")
    print("find1 =  ", find1)  # -1
    
    if 'world' in string:
        xxx

    # åˆ‡å‰²ä¸º list
    string = "hello\nworld xxx yyy zzz"
    print(string.split("\n"))  # ['hello', 'world xxx yyy zzz']
    # ä»¥ sep ä¸ºåˆ†éš”ç¬¦åˆ‡ç‰‡ stringï¼Œå¦‚æœ maxsplit æœ‰æŒ‡å®šå€¼ï¼Œåˆ™æœ€å¤šåˆ‡å‰²å¤šå°‘æ¬¡ (å¿…é¡»å¸¦ä¸Š maxsplit)
    print(string.split(sep='o', maxsplit=1))  # ['hell', '\nworld xxx yyy zzz']
    #æŒ‰ç…§è¡Œ('\r', '\r\n', \n')åˆ†éš”ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«å„è¡Œä½œä¸ºå…ƒç´ çš„åˆ—è¡¨ï¼Œå¦‚
    # æœå‚æ•° keepends ä¸º Falseï¼Œä¸åŒ…å«æ¢è¡Œç¬¦ï¼Œå¦‚æœä¸º Trueï¼Œåˆ™ä¿ç•™æ¢è¡Œç¬¦ã€‚é»˜è®¤ false
    print(string.splitlines(True)) # ['hello\n', 'world xxx yyy zzz']
    print(string.splitlines(False)) # ['hello', 'world xxx yyy zzz']
    print(string.splitlines()) # ['hello', 'world xxx yyy zzz']


    # åˆ‡å‰²æˆ tuple
    #
    #æœ‰ç‚¹åƒ find()å’Œ split()çš„ç»“åˆä½“,ä» str å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½®èµ·,æŠŠ å­— ç¬¦ ä¸² string åˆ†
    #æˆ ä¸€ ä¸ª 3 å…ƒ ç´  çš„ å…ƒ ç»„ (string_pre_str,str,string_post_str),å¦‚
    # æœ string ä¸­ä¸åŒ…å«str åˆ™ string_pre_str == string.
    print(string.partition('w') ) # ('hello\n', 'w', 'orld xxx yyy zzz')

    # string.rpartition(str) #ç±»ä¼¼äº partition()å‡½æ•°,ä¸è¿‡æ˜¯ä»å³è¾¹å¼€å§‹æŸ¥æ‰¾


    # # æ‹¼æ¥
    print('\n'.join(['aaa', 'bbb', 'ccc']))

    # # å°†å­—ç¬¦ä¸²è½¬ä¸º å­—ç¬¦åˆ—è¡¨
    print(list("12345")) # ['1', '2', '3', '4', '5']

    # # 
    #
    #  å¸¸ç”¨å†…å»ºå‡½æ•°
    #
    #
    # # strip() 
    # ç”¨äºç§»é™¤å­—ç¬¦ä¸²å¤´å°¾æŒ‡å®šçš„å­—ç¬¦ï¼ˆé»˜è®¤ä¸ºç©ºæ ¼æˆ–æ¢è¡Œç¬¦ï¼‰æˆ–å­—ç¬¦åºåˆ—
    str = "00000003210Runoob01230000000"
    # ç§»é™¤æŒ‡å®šå­—ç¬¦
    print(str.strip( '0' ))  # 3210Runoob0123
    str2 = "   Runoob      "   # Runoob
    # é»˜è®¤æ˜¯ç§»é™¤ç©ºæ ¼
    print(str2.strip())
    str = "123abcrunoob321"
    # æŒ‡å®šçš„å­—ç¬¦æ²¡æœ‰é¡ºåºä¹‹åˆ†
    print (str.strip( '12' ))  # 3abcrunoob3

    string = "   hello    "
    string = string.lstrip()#æˆªæ‰ string å·¦è¾¹çš„ç©ºæ ¼
    string = string.rstrip()#åˆ é™¤ string å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼.
    print("string = " + string)


    print(string.capitalize()) # æŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤§å†™
    # string.lower()#è½¬æ¢ string ä¸­æ‰€æœ‰å¤§å†™å­—ç¬¦ä¸ºå°å†™.
    # string.upper()#è½¬æ¢ string ä¸­çš„å°å†™å­—æ¯ä¸ºå¤§å†™
    # string.swapcase()#ç¿»è½¬ string ä¸­çš„å¤§å°å†™
    # string.title()#è¿”å›"æ ‡é¢˜åŒ–"çš„ string,å°±æ˜¯è¯´æ‰€æœ‰å•è¯éƒ½æ˜¯ä»¥å¤§å†™å¼€å§‹ï¼Œå…¶ä½™å­—æ¯å‡ä¸ºå°å†™(è§ istitle())

    # string.center(width) #è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å±…ä¸­,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²
    # string.ljust(width)#è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å·¦å¯¹é½,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²
    # string.rjust(width)#è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å³å¯¹é½,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²
    # string.zfill(width)#è¿”å›é•¿åº¦ä¸º width çš„å­—ç¬¦ä¸²ï¼ŒåŸå­—ç¬¦ä¸² string å³å¯¹é½ï¼Œå‰é¢å¡«å……0

    # è¿”å› str åœ¨ string é‡Œé¢å‡ºç°çš„æ¬¡æ•°ï¼Œå¦‚æœ beg æˆ–è€… end æŒ‡å®šåˆ™è¿”å›æŒ‡å®šèŒƒå›´å†… str å‡ºç°çš„æ¬¡æ•°
    string = "xsdf aa sfefaafsef"
    print(string.count("aa")) # 2
    print(string.count("aa", 7, len(string))) # 1

    #ä»¥ encoding æŒ‡å®šçš„ç¼–ç æ ¼å¼è§£ç  stringï¼Œå¦‚æœå‡ºé”™é»˜è®¤æŠ¥ä¸€ä¸ª ValueError çš„ å¼‚ å¸¸ ï¼Œ 
    # é™¤é errors æŒ‡ å®š çš„ æ˜¯ 'ignore' æˆ– è€…'replace'
    # string.decode(encoding='UTF-8', errors='strict') 
    # string.encode(encoding='UTF-8', errors='strict')


    # string.endswith(obj, beg=0, end=len(string))#æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥ obj ç»“æŸï¼Œå¦‚æœbeg æˆ–è€… end æŒ‡å®šåˆ™æ£€æŸ¥æŒ‡å®šçš„èŒƒå›´å†…æ˜¯å¦ä»¥ obj ç»“æŸï¼Œå¦‚æœæ˜¯ï¼Œè¿”å› True,å¦åˆ™è¿”å› False.
    # string.startswith(obj, beg=0,end=len(string))#æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥ obj å¼€å¤´ï¼Œæ˜¯åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚å¦‚æœbeg å’Œ end æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥.

    # string.expandtabs(tabsize=8) #æŠŠå­—ç¬¦ä¸² string ä¸­çš„ tab ç¬¦å·è½¬ä¸ºç©ºæ ¼ï¼Œtab ç¬¦å·é»˜è®¤çš„ç©ºæ ¼æ•°æ˜¯ 8ã€‚

    # string.find(str, beg=0, end=len(string)) #æ£€æµ‹ str æ˜¯å¦åŒ…å«åœ¨ string ä¸­ï¼Œå¦‚æœ beg å’Œ end æŒ‡å®šèŒƒå›´ï¼Œåˆ™æ£€æŸ¥æ˜¯å¦åŒ…å«åœ¨æŒ‡å®šèŒƒå›´å†…ï¼Œå¦‚æœæ˜¯è¿”å›å¼€å§‹çš„ç´¢å¼•å€¼ï¼Œå¦åˆ™è¿”å›-1
    # string.rfind(str, beg=0,end=len(string) )#ç±»ä¼¼äº find()å‡½æ•°ï¼Œä¸è¿‡æ˜¯ä»å³è¾¹å¼€å§‹æŸ¥æ‰¾.

    # string.index(str, beg=0, end=len(string)) #è·Ÿfind()æ–¹æ³•ä¸€æ ·ï¼Œåªä¸è¿‡å¦‚æœsträ¸åœ¨ stringä¸­ä¼šæŠ¥ä¸€ä¸ªå¼‚å¸¸.
    # string.rindex( str, beg=0,end=len(string))#ç±»ä¼¼äº index()ï¼Œä¸è¿‡æ˜¯ä»å³è¾¹å¼€å§‹.

    # string.isalnum()#å¦‚æœ string è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦å¹¶ä¸”æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯æˆ–æ•°å­—åˆ™è¿”å› True,å¦åˆ™è¿”å› False
    # string.isalpha() #å¦‚æœ string è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦å¹¶ä¸”æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯åˆ™è¿”å› True,å¦åˆ™è¿”å› False

    # string.isdecimal()#å¦‚æœ string åªåŒ…å«åè¿›åˆ¶æ•°å­—åˆ™è¿”å› True å¦åˆ™è¿”å› False.
    # string.isdigit()# å¦‚æœ string åªåŒ…å«æ•°å­—åˆ™è¿”å› True å¦åˆ™è¿”å› False.
    # string.isnumeric()#å¦‚æœ string ä¸­åªåŒ…å«æ•°å­—å­—ç¬¦ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False

    # string.islower()#å¦‚æœ string ä¸­åŒ…å«è‡³å°‘ä¸€ä¸ªåŒºåˆ†å¤§å°å†™çš„å­—ç¬¦ï¼Œå¹¶ä¸”æ‰€æœ‰è¿™äº›(åŒºåˆ†å¤§å°å†™çš„)å­—ç¬¦éƒ½æ˜¯å°å†™ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False
    # string.isupper()#å¦‚æœ string ä¸­åŒ…å«è‡³å°‘ä¸€ä¸ªåŒºåˆ†å¤§å°å†™çš„å­—ç¬¦ï¼Œå¹¶ä¸”æ‰€æœ‰è¿™äº›(åŒºåˆ†å¤§å°å†™çš„)å­—ç¬¦éƒ½æ˜¯å¤§å†™ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False

    # string.isspace()#å¦‚æœ string ä¸­åªåŒ…å«ç©ºæ ¼ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False.

    # string.istitle() #å¦‚æœ string æ˜¯æ ‡é¢˜åŒ–çš„(è§ title())åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False


    # string.join(seq)#ä»¥ string ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå°† seq ä¸­æ‰€æœ‰çš„å…ƒç´ (çš„å­—ç¬¦ä¸²è¡¨ç¤º)åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²


    # string.maketrans(intab, outtab]) #maketrans() æ–¹æ³•ç”¨äºåˆ›å»ºå­—ç¬¦æ˜ å°„çš„è½¬æ¢è¡¨ï¼Œå¯¹äºæ¥å—ä¸¤ä¸ªå‚æ•°çš„æœ€ç®€å•çš„è°ƒç”¨æ–¹å¼ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºéœ€è¦è½¬æ¢çš„å­—ç¬¦ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¹Ÿæ˜¯å­—ç¬¦ä¸²è¡¨ç¤ºè½¬æ¢çš„ç›®æ ‡ã€‚

    # max(str)#è¿”å›å­—ç¬¦ä¸² str ä¸­æœ€å¤§çš„å­—æ¯ã€‚
    # min(str)#è¿”å›å­—ç¬¦ä¸² str ä¸­æœ€å°çš„å­—æ¯ã€‚

    # string.replace(str1, str2,  num=string.count(str1)) #æŠŠ string ä¸­çš„ str1 æ›¿æ¢æˆ str2,å¦‚æœ num æŒ‡å®šï¼Œåˆ™æ›¿æ¢ä¸è¶…è¿‡ num æ¬¡.


    # string.translate(str, del="")#æ ¹æ® str ç»™å‡ºçš„è¡¨(åŒ…å« 256 ä¸ªå­—ç¬¦)è½¬æ¢ string çš„å­—ç¬¦, è¦è¿‡æ»¤æ‰çš„å­—ç¬¦æ”¾åˆ° del å‚æ•°ä¸­
```

### 2.2.2. å­—èŠ‚ bytes

ä¸å¯å˜çš„


### 2.2.3. æ•°å­—

```py
# æ•´æ•°
    c=2
    a=0xff00  # 16è¿›åˆ¶

    # æµ®ç‚¹æ•°
    #
    # é™¤æ³•è®¡ç®—ç»“æœæ˜¯æµ®ç‚¹æ•°ï¼Œå³ä½¿æ˜¯ä¸¤ä¸ªæ•´æ•°æ°å¥½æ•´é™¤ï¼Œç»“æœä¹Ÿæ˜¯æµ®ç‚¹æ•°
    a=1.24
    b=3.33
    c=1.23e9  # 1.23x10çš„9æ¬¡æ–¹
    d=1.2e-5  # 0.000012

    
    # ç‰¹æœ‰çš„è¿ç®—ç¬¦
    # 2**3 == 8 æ¬¡å¹‚
    # 9 // 2 == 4 é™¤æ³•å–æ•´, ç§°ä¸ºåœ°æ¿é™¤ï¼Œä¸¤ä¸ªæ•´æ•°çš„é™¤æ³•ä»ç„¶æ˜¯æ•´æ•°, åªå–ç»“æœçš„æ•´æ•°éƒ¨åˆ†

    # è½¬æ¢
    age_str="11"
    age_num=int(age_str)
    print(age_num)

    # åˆ¤æ–­æ˜¯å¦å¯ä»¥è½¬æ¢ä¸ºæ•´å‹
    a="1,2,3"
    print(a.isdecimal())  # False
    print(a.isdigit())  # False
    print("ä¹".isnumeric())  # True

```

### 2.2.4. å¸ƒå°”å€¼ ç©ºå€¼


```py
# å¸ƒå°”å€¼
    # åªæœ‰Trueã€Falseä¸¤ç§å€¼
    # å¯ä»¥ç”¨and or notè¿ç®—

    # ç©ºå€¼
    # ç”¨Noneè¡¨ç¤ºã€‚Noneä¸èƒ½ç†è§£ä¸º0

```

### 2.2.5. é›†åˆ


#### 2.2.5.1. æœ‰åºå¯å˜ list

```py
 #
    #
    ##### List å¯å˜æœ‰åºåˆ—è¡¨
    #
    #
    #
    classmates = ['Michael', 'Bob', 'Tracy']
    print("classmates = ", classmates) # ['Michael', 'Bob', 'Tracy']
    print (len(classmates))

    # è·å–
    # # è·å–ç¬¬ä¸€ä¸ª
    # >>> classmates[0]
    # 'Michael'
    # # æœ€åä¸€ä¸ªå…ƒç´ 
    # >>> classmates[-1] 
    # or classmates[len(classmates) - 1]
    # 'Tracy'
    # # ä»¥æ­¤ç±»æ¨ï¼Œå¯ä»¥è·å–å€’æ•°ç¬¬2ä¸ªã€å€’æ•°ç¬¬3ä¸ªï¼š
    # >>> classmates[-2]
    # 'Bob'

    # æŸ¥æ‰¾
    # index() å‡½æ•°ç”¨äºä»åˆ—è¡¨ä¸­æ‰¾å‡ºæŸä¸ªå€¼ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ç´¢å¼•ä½ç½®
        
    # # æ·»åŠ åˆ°æœ«å°¾
    # >>> classmates.append('Adam')
    # >>> classmates ['Michael', 'Bob', 'Tracy', 'Adam']
    # # æ·»åŠ åˆ°æŒ‡å®šä½ç½®
    # >>> classmates.insert(1, 'Jack')
    # >>> classmates
    # ['Michael', 'Jack', 'Bob', 'Tracy', 'Adam']
    # # åˆ é™¤æœ«å°¾å…ƒç´ 
    # >>> classmates.pop()
    # 'Adam'
    # # åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ 
    # >>> classmates.pop(1)
    # 'Jack'


    #
    # å¸¦ä¸‹æ ‡éå†
    # enumerate()å¯ä»¥å°†listå˜ä¸ºç´¢å¼•-å…ƒç´ å¯¹
    # for i, value in enumerate([1,2,'3', '4']):
    #     print(i, value)
    #
    # åˆ¤æ–­å¯¹è±¡æ˜¯å¦èƒ½è¿­ä»£
    # from collections import Iterable
    # if (isinstance("acb", Iterable)):
    #     print('ok!')


    

    #
    # åˆ—è¡¨ç”Ÿæˆå¼
    #
    l = list(range(1,11))
    print(l)
    l1 = [x*x for x in l]
    print(l1)
    l2 = [x*x for x in l if x%2 ==0]
    print(l2)

    m = [x+y for x in 'abc' for y in 'ABC']
    print(m)
    import os
    d = [d for d in os.listdir('.')]
    print(d)
```

#### 2.2.5.2. åˆ‡ç‰‡ slices

```py
# slices
    #
    #
    l = list(range(10))
    print(l)
    print(l[0:3])
    print(l[:3])
    print(l[-1])
    print(l[-1:])
    print(l[-2:-1])
    print(l[-2:])
```


#### 2.2.5.3. æœ‰åºä¸å¯å˜åˆ—è¡¨ tuple

```py
 # Tuple ä¸å¯å˜æœ‰åºåˆ—è¡¨
    #
    # å› ä¸ºtupleä¸å¯å˜ï¼Œæ‰€ä»¥ä»£ç æ›´å®‰å…¨ã€‚å¦‚æœå¯èƒ½ï¼Œèƒ½ç”¨tupleä»£æ›¿listå°±å°½é‡ç”¨tuple
    # 
    # åˆ›å»º
    # >>> classmates = ('Michael', 'Bob', 'Tracy')
    # # å®šä¹‰ç©º
    # >>> t = ()
    # # å®šä¹‰ä¸€ä¸ªå…ƒç´ çš„tuple
    # ä¸ºä»€ä¹ˆè¿™æ ·è§„å®š?
    # è¿™æ˜¯å› ä¸ºæ‹¬å·()æ—¢å¯ä»¥è¡¨ç¤ºtupleï¼Œåˆå¯ä»¥è¡¨ç¤ºæ•°å­¦å…¬å¼ä¸­çš„å°æ‹¬å·ï¼Œè¿™å°±äº§ç”Ÿäº†æ­§ä¹‰.æ‰€ä»¥ï¼Œåªæœ‰1ä¸ªå…ƒç´ çš„tupleå®šä¹‰æ—¶å¿…é¡»åŠ ä¸€ä¸ªé€—å·,ï¼Œæ¥æ¶ˆé™¤æ­§ä¹‰
    # >>> t = (1,)
    # >>> t
    # (1,)
    # # å¯å˜çš„tuple
    # >>> t = ('a', 'b', ['A', 'B'])
    # >>> t[2][0] = 'X'
    # >>> t[2][1] = 'Y'
    # >>> t
    # ('a', 'b', ['X', 'Y'])




# å‘½åçš„ tuple
# -*- coding: utf-8 -*-
# author: xiaoyu 775000738@qq.com 2021/6/11

from collections import namedtuple
from random import choice


def named_tuple_intro():
    # æ¯”æ™®é€š tuple æ›´å¥½çš„å¯è¯»æ€§, æ˜“äºç»´æŠ¤
    # æ¯”å­—å…¸æ›´åŠ è½»é‡é«˜æ•ˆ

    # æ„é€ ä¸€ä¸ªç±», ç±»å People, å±æ€§ name, age, like
    People = namedtuple('People', 'name, age, like')

    # åªè¯», å±æ€§ä¸å¯ä¿®æ”¹
    person_a = People(name='zhang san', age=11, like=['apple', 'banana'])

    print(person_a.name)
    print(person_a[0])

    # error
    # person_a.name = 'bb'


def french_deck():
    """
    æ‰‘å…‹æ¸¸æˆ
    """
    Card = namedtuple('Card', ['rank', 'suit'])

    class FrenchDeck:
        # ç‚¹æ•°
        ranks = [str(n) for n in range(2, 11) ] + list('JQKA')
        # èŠ±è‰²
        suits = 'é»‘æ¡ƒ æ–¹ç‰‡ æ¢…èŠ± çº¢æ¡ƒ'.split()

        def __init__(self):
            self._card = [Card(rank, suit) for suit in self.suits
                          for rank in self.ranks]

        def __len__(self):
            return len(self._card)

        # after this method defined, FrenchDeck will become a iterable obj
        def __getitem__(self, item_index):
            return self._card[item_index]

    deck = FrenchDeck()
    print(len(deck))
    # ç¬¬ä¸€å¼ ç‰Œ
    print(deck[0])
    # æœ€åä¸€å¼ ç‰Œ
    print(deck[-1])
    cards = []
    for card in deck:
        cards.append(card)
    print(cards)
    reversed_cards = []
    for card in reversed(deck):
        reversed_cards.append(card)
    print(reversed_cards)

    # ä» iterable obj ä¸­éšæœºé€‰å–
    random_card = choice(deck)
    print(random_card)

    # åˆ¤æ–­æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­
    print(Card('Q', 'æ–¹ç‰‡') in deck)
    print(Card('Q', 'block') in deck)

    suit_values = dict(é»‘æ¡ƒ=3, æ–¹ç‰‡=2, æ¢…èŠ±=1, çº¢æ¡ƒ=0)
    print(suit_values)


if __name__ == '__main__':
    french_deck()

```

#### 2.2.5.4. æ— åºä¸å¯é‡å¤ set

```py
  # Set æ— åºä¸å¯é‡å¤
    #
    #ä¸€ç»„ key çš„é›†åˆï¼Œä½†ä¸å­˜å‚¨ valueï¼Œæ²¡æœ‰é‡å¤çš„ keyï¼Œæ— åº
    #set å’Œ dict çš„å”¯ä¸€åŒºåˆ«ä»…åœ¨äºæ²¡æœ‰å­˜å‚¨å¯¹åº”çš„ value
    #
    # è¦åˆ›å»ºä¸€ä¸ªsetï¼Œéœ€è¦æä¾›ä¸€ä¸ªlistä½œä¸ºè¾“å…¥é›†åˆï¼š
    # >>> s = set([1, 2, 3])
    # >>> s
    # {1, 2, 3}
    # # æˆ–è€…ç›´æ¥ s = {1,2,3}åˆ›å»º
    # # é‡å¤å…ƒç´ åœ¨setä¸­è‡ªåŠ¨è¢«è¿‡æ»¤
    # >>> s = set([1, 1, 2, 2, 3, 3])
    # >>> s
    # {1, 2, 3}
    # # æ·»åŠ å…ƒç´ ï¼Œé‡å¤æ·»åŠ æ— æ•ˆ
    # >>> s.add(4)
    # >>> s
    # {1, 2, 3, 4}
    # >>> s.add(4)
    # >>> s
    # {1, 2, 3, 4}
    # # åˆ é™¤
    # >>> s.remove(4)
    # >>> s
    # {1, 2, 3}
    # # å¹¶é›†äº¤é›†
    # >>> s1 = set([1, 2, 3])
    # >>> s2 = set([2, 3, 4])
    # >>> s1 & s2
    # {2, 3}
    # >>> s1 | s2
    # {1, 2, 3, 4}

```

###  2.2.6. é”®å€¼å­˜å‚¨ å­—å…¸ dict

```py
# Dict é”®å€¼å­˜å‚¨
    #
    # å’Œ list æ¯”è¾ƒï¼Œdict æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š
    #
    # 1.  æŸ¥æ‰¾å’Œæ’å…¥çš„é€Ÿåº¦æå¿«ï¼Œä¸ä¼šéšç€ key çš„å¢åŠ è€Œå˜æ…¢ï¼›
    # 2.  éœ€è¦å ç”¨å¤§é‡çš„å†…å­˜ï¼Œå†…å­˜æµªè´¹å¤šã€‚
    # 3.  Key æ˜¯ä¸å¯å˜å¯¹è±¡ 
    #     éœ€è¦æˆ‘ä»¬è‡ªå·±åœ¨ä»£ç ä¸­ä¿è¯ , å› ä¸ºdictæ ¹æ®keyæ¥è®¡ç®—valueçš„å­˜å‚¨ä½ç½®ï¼Œå¦‚æœæ¯æ¬¡è®¡ç®—ç›¸åŒçš„keyå¾—å‡ºçš„ç»“æœä¸åŒï¼Œé‚£dictå†…éƒ¨å°±å®Œå…¨æ··ä¹±äº†
    #     åœ¨Pythonä¸­ï¼Œå­—ç¬¦ä¸²ã€æ•´æ•°ç­‰éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ï¼Œå¯ä»¥æ”¾å¿ƒåœ°ä½œä¸ºkeyã€‚è€Œlistæ˜¯å¯å˜çš„ï¼Œå°±ä¸èƒ½ä½œä¸ºkey
    #
    # è€Œ list ç›¸åï¼š
    # 1.  æŸ¥æ‰¾å’Œæ’å…¥çš„æ—¶é—´éšç€å…ƒç´ çš„å¢åŠ è€Œå¢åŠ ï¼›
    # 2.  å ç”¨ç©ºé—´å°ï¼Œæµªè´¹å†…å­˜å¾ˆå°‘ã€‚
    # æ‰€ä»¥ï¼Œdict æ˜¯ç”¨ç©ºé—´æ¥æ¢å–æ—¶é—´çš„ä¸€ç§æ–¹æ³•ã€‚
    #
    # åˆ›å»º
    # >>> d = {'Michael': 95, 'Bob': 75, 'Tracy': 85}
    # # è·å–å€¼ï¼Œå¦‚æœä¸å­˜åœ¨ä¼šæŠ¥é”™
    # >>> d['Michael']
    # 95
    # # æ·»åŠ é”®å€¼å¯¹
    # >>> d['Adam'] = 67
    # >>> d['Adam']
    # 67
    # # æ·»åŠ ç›¸åŒçš„é”®ï¼Œä¼šå†²æ‰å·²å­˜åœ¨çš„
    # >>> d['Jack'] = 90
    # >>> d['Jack']
    # 90
    # >>> d['Jack'] = 88
    # >>> d['Jack']
    # 88 # ä¸ºäº†é˜²æ­¢æŠ¥é”™ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦æœ‰è¯¥é”®
    # >>> 'Thomas' in d
    # False
    # # æˆ–è€…é€šè¿‡getæ–¹æ³•ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œæ²¡æœ‰è¿”å›
    # >>> d.get('Thomas')
    # >>> d.get('Thomas', -1)
    # -1
    # # åˆ é™¤
    # >>> d.pop('Bob')
    # 75
    # >>> d
    # {'Michael': 95, 'Tracy': 85}
    #
    # è¿­ä»£ éå† dict
    #
    d = {'a': 1, 'b': 2, 'c': 3}
    for key in d:
        print(key)
    for value in d.values():
        print(value)
    # åŒæ—¶è¿­ä»£keyå’Œvalueï¼Œè¿™ç§å¤ªéº»çƒ¦ï¼Œä¸æ¨è
    for key in d:
        print(key + ': ' + str(d.get(key)))

    for key,value in d.items():
        print(key, str(value))
    
```

### 2.2.7. åˆ—è¡¨æ¨å¯¼å¼



### 2.2.8. ç”Ÿæˆå™¨ generator

```py
# ç”Ÿæˆå™¨
    # è¿™ç§ä¸€è¾¹å¾ªç¯ä¸€è¾¹è®¡ç®—çš„æœºåˆ¶ï¼Œç§°ä¸ºç”Ÿæˆå™¨ï¼šgeneratorã€‚
    #
    # æŠŠä¸€ä¸ªåˆ—è¡¨ç”Ÿæˆå¼çš„[]æ”¹æˆ()ï¼Œå°±åˆ›å»ºäº†ä¸€ä¸ªgenerator
    #
    #æˆ–è€… -> å¦‚æœä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸­åŒ…å«yieldå…³é”®å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±ä¸å†æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªgenerator
    #
    # å‡½æ•°åŒºåˆ«:generatorå’Œå‡½æ•°çš„æ‰§è¡Œæµç¨‹ä¸ä¸€æ ·ã€‚å‡½æ•°æ˜¯é¡ºåºæ‰§è¡Œï¼Œ
    # é‡åˆ°returnè¯­å¥æˆ–è€…æœ€åä¸€è¡Œå‡½æ•°è¯­å¥å°±è¿”å›ã€‚è€Œå˜æˆ
    # generatorçš„å‡½æ•°ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨next()çš„æ—¶å€™æ‰§è¡Œ(å¦‚ next(g))ï¼Œé‡
    # åˆ°yieldè¯­å¥è¿”å›ï¼Œå†æ¬¡æ‰§è¡Œæ—¶ä»ä¸Šæ¬¡è¿”å›çš„yieldè¯­å¥å¤„ç»§ç»­æ‰§è¡Œ
    #
    l = list(range(1,11))
    g = (x*x for x in l)
    for n in g:
        print(n)

    # æ–æ³¢æ‹‰å¥‘æ•°åˆ—
    def fib(max):
        n, a, b = 0, 0, 1
        while n < max:
            yield b
            a, b = b, a + b
            n = n + 1
        return 'done' # ç”¨forå¾ªç¯è°ƒç”¨generatoræ—¶ï¼Œå‘ç°æ‹¿ä¸åˆ°generatorçš„returnè¯­å¥çš„è¿”å›å€¼ã€‚å¦‚æœæƒ³è¦æ‹¿åˆ°è¿”å›å€¼ï¼Œå¿…é¡»æ•è·StopIterationé”™è¯¯ï¼Œè¿”å›å€¼åŒ…å«åœ¨StopIterationçš„valueä¸­
    for n in fib(6):
        print(n)

```

### 2.2.9. è¿­ä»£å™¨

å®ç°äº†é­”æœ¯æ–¹æ³• `__iter__, __next__`, å³ä¸º è¿­ä»£å™¨, è‹¥ä»…ä»…å®ç°äº† iter (iter è¿”å›ä¸€ä¸ªå¯¹è±¡, è¯¥å¯¹è±¡å®ç°äº† __next), åªèƒ½è§†ä¸º å¯è¿­ä»£å¯¹è±¡. è‹¥ä¸º iterator, ä¸€å®šä¸º iterable, åä¹‹ä¸ä¸€å®š

å®ç°äº†é­”æœ¯æ–¹æ³• `__getitem__`, å³ä¸º å¯è¿­ä»£å¯¹è±¡

```
åœ¨ç”¨ for..in.. è¿­ä»£å¯¹è±¡æ—¶ï¼Œå¦‚æœå¯¹è±¡æ²¡æœ‰å®ç° __iter__ __next__ è¿­ä»£å™¨åè®®ï¼ŒPythonçš„è§£é‡Šå™¨å°±ä¼šå»å¯»æ‰¾__getitem__ æ¥è¿­ä»£å¯¹è±¡ï¼Œ

å¦‚æœè¿__getitem__ éƒ½æ²¡æœ‰å®šä¹‰ï¼Œè¿™è§£é‡Šå™¨å°±ä¼šæŠ¥å¯¹è±¡ä¸æ˜¯è¿­ä»£å™¨çš„é”™è¯¯
```


åŒºåˆ«:  å½“ä¸ºç´¢å¼•è¡Œæ•°æ®ç±»å‹ï¼ˆå¦‚ï¼šlist, tuple,str)æ—¶ï¼Œå¯ä»¥æ›¿æ¢ï¼Œå½“å­—æ®µä¸ºhashå‹ç±»å‹ï¼ˆå¦‚dict,set)æ—¶ï¼Œä¸èƒ½æ›¿æ¢



## 2.3. æ¡ä»¶å¾ªç¯

```py
def condition_loop():
    """
    æ¡ä»¶ å¾ªç¯
    """
    names = ['Michael', 'Bob', 'Tracy']
    for name in names:
        print(name)

    fruits = ['banana', 'apple',  'mango']
    for index in range(len(fruits)):
        print('å½“å‰æ°´æœ :', fruits[index])

    count = 0
    while (count < 9):
        print ('The count is:', count)
        count = count + 1
```

## 2.4. æ¯”è¾ƒåˆ¤æ–­

```py
# åœ¨pythonä¸­ None, False, ç©ºå­—ç¬¦ä¸²"", 0, ç©ºåˆ—è¡¨[], ç©ºå­—å…¸{}, ç©ºå…ƒç»„()éƒ½ç›¸å½“äºFalse
# (ob1 is ob2) ç­‰ä»·äº (id(ob1) == id(ob2))

# åˆ¤ç©º
if x is None
if x is not None


```

## 2.5. å‡½æ•°

### 2.5.1. å‚æ•°æ£€æŸ¥

```py
def function_demo():
    # å‚æ•°æ£€æŸ¥ç±»å‹
    def my_abs(x):
        if not isinstance(x, (int, float)):
            raise TypeError('bad operand type')
        if x >= 0:
            return x
        else:
            return -x

    # * æ£€æŸ¥å‚æ•°æœ‰æ•ˆæ€§
    def person(name, age, **kw):
        if 'city' in kw:
            # æœ‰cityå‚æ•°
            pass
        if 'job' in kw:
            # æœ‰jobå‚æ•°
            pass
        print('name:', name, 'age:', age, 'other:', kw)

```

### 2.5.2. å¤šç§å‚æ•°

```py

    # å‚æ•°é¡ºåº
    #
    #å¿…é€‰å‚æ•°ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å‘½åå…³é”®å­—å‚æ•°ã€å…³é”®å­—å‚æ•°
    #
    # å®šä¹‰
    # c ä¸ºé»˜è®¤å‚æ•°
    # *args ä¸º å¯å˜å‚æ•°, ä¸ªæ•°å¯å˜, å‡½æ•°å†…éƒ¨è‡ªåŠ¨ç»„è£…ä¸º tuple
    # **kw  å…³é”®å­—å‚æ•°, å†…éƒ¨è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ª dict
    #
    # æ‰€ä»¥ï¼Œå¯¹äºä»»æ„å‡½æ•°ï¼Œéƒ½å¯ä»¥é€šè¿‡ç±»ä¼¼func(*args, **kw)çš„å½¢å¼è°ƒç”¨å®ƒï¼Œæ— è®ºå®ƒçš„å‚æ•°æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚
    #
    def f1(a, b, c=0, *args, **kw):
        print('a =', a, 'b =', b, 'c =', c, 'args =', args, 'kw =', kw)

    def f2(a, b, c=0, *, d, **kw):
        print('a =', a, 'b =', b, 'c =', c, 'd =', d, 'kw =', kw)
    # è°ƒç”¨
    # >>> f1(1, 2)
    # a = 1 b = 2 c = 0 args = () kw = {}
    # >>> f1(1, 2, c=3)
    # a = 1 b = 2 c = 3 args = () kw = {}
    # >>> f1(1, 2, 3, 'a', 'b')
    # a = 1 b = 2 c = 3 args = ('a', 'b') kw = {}
    # >>> f1(1, 2, 3, 'a', 'b', x=99)
    # a = 1 b = 2 c = 3 args = ('a', 'b') kw = {'x': 99}
    # >>> f2(1, 2, d=99, ext=None)
    # a = 1 b = 2 c = 0 d = 99 kw = {'ext': None}

    # é€šè¿‡ä¸€ä¸ªtupleå’Œdictï¼Œä½ ä¹Ÿå¯ä»¥è°ƒç”¨ä¸Šè¿°å‡½æ•°ï¼š
    # >>> args = (1, 2, 3, 4)
    # >>> kw = {'d': 99, 'x': '#'}
    # >>> f1(*args, **kw)
    # a = 1 b = 2 c = 3 args = (4,) kw = {'d': 99, 'x': '#'}
    # >>> args = (1, 2, 3)
    # >>> kw = {'d': 88, 'x': '#'}
    # >>> f2(*args, **kw)
    # a = 1 b = 2 c = 3 d = 88 kw = {'x': '#'}

    #
    # å‘½åå…³é”®å­—å‚æ•°
    #å¯ä»¥é™åˆ¶ä¼ å…¥çš„å‚æ•°çš„é”®
    #ä¾‹å¦‚ï¼Œåªæ¥æ”¶ city å’Œ job ä½œä¸ºå…³é”®å­—å‚æ•°ã€‚è¿™ç§æ–¹å¼å®šä¹‰çš„å‡½æ•°å¦‚ä¸‹ï¼š
    #
    def person1(name, age, *, city, job):# * ä½œä¸ºåˆ†éš”ç¬¦
        print(name, age, city, job)

    # # è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š
    # # å¿…éœ€è¦æœ‰å‚æ•°åï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¼šè§†ä¸ºæœ‰å››ä¸ªä½ç½®å‚æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°åªæœ‰ä¸¤ä¸ªä½ç½®å‚æ•°ï¼ŒæŠ¥é”™
    # >>> person1('Jack', 24, city='Beijing', job='Engineer')
    # Jack 24 Beijing Engineer
    #
    # å¦‚æœå‡½æ•°å®šä¹‰ä¸­å·²ç»æœ‰äº†ä¸€ä¸ªå¯å˜å‚æ•°ï¼Œåé¢è·Ÿç€çš„å‘½åå…³é”®å­—å‚æ•°å°±ä¸å†éœ€è¦ä¸€ä¸ªç‰¹æ®Šåˆ†éš”ç¬¦*äº†ï¼š
    #
    def person2(name, age, *args, city, job):
        print(name, age, args, city, job)

```

### 2.5.3. é€’å½’

```py

    ###
    ##
    ## é€’å½’
    # å°¾é€’å½’ä¼˜åŒ–: ä½¿å¾— è¿”å›å€¼ä¸å«æœ‰è¡¨è¾¾å¼
    #
    # é˜¶ä¹˜
    def recu(n):
        if n == 1:
            return 1
        return n*recu(n-1) # è¿”å›å€¼å¸¦æœ‰è¡¨è¾¾å¼, ä¸å¥½
    # ä¼˜åŒ–å
    def fact(n):
        return fact_iter(n, 1)

    def fact_iter(num, product):
        if num == 1:
            return product
        return fact_iter(num - 1, num * product)

```


### 2.5.4. é«˜é˜¶å‡½æ•°


```py
def map_reduce_closure_lambda():
    l = list(range(1,11))
    def f(x):
        return x*x
    r = map(f, l) # <map object at 0x10298b2d0>
    print("r = ", list(r))# r =  [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
    r1 = map(str, l)
    print(list(r1)) # ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10']

    from functools import reduce
    l = [1, 2, 3]
    def add(x, y):
        return x+y
    r2 = reduce(add, l)
    print("r2 = ", r2) # 6


    n = sorted([36, 5, -12, 9, -21])
    print(n) # [-21, -12, 5, 9, 36]
    n1 = sorted(['bob', 'about', 'Zoo', 'Credit'],reverse=True, key=str.lower)
    print(n1) # ['Zoo', 'Credit', 'bob', 'about']

    def lazy_sum(*args):
        def sum():
            ax = 0
            for n in args:
                ax = ax + n
            return ax
        return sum
    f = lazy_sum(1, 3, 5, 7, 9)
    print("f() = ", f()) # 25

    lambda x: x*x


```

## 2.6. æ–‡ä»¶å¤„ç†

### 2.6.1. åˆ›å»ºæ–‡ä»¶

```py
def file_dir_demo():
    import os
    import sys
    print(os.name) # æ“ä½œç³»ç»Ÿç±»å‹, å¦‚æœæ˜¯posixï¼Œè¯´æ˜ç³»ç»Ÿæ˜¯Linuxã€Unixæˆ–Mac OS Xï¼Œå¦‚æœæ˜¯ntï¼Œå°±æ˜¯Windowsç³»ç»Ÿ
    print(os.environ.get('PATH', ['default Value'])) # åœ¨æ“ä½œç³»ç»Ÿä¸­å®šä¹‰çš„ç¯å¢ƒå˜é‡
    # æŸ¥çœ‹å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„:
    print(os.path.abspath('.')) # /Users/xiaoyu/repo/code/back_end/python-demos

    # è·¯å¾„æ‹¼æ¥
    #
    # æŠŠä¸¤ä¸ªè·¯å¾„åˆæˆä¸€ä¸ªæ—¶ï¼Œä¸è¦ç›´æ¥æ‹¼å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.join()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æ­£ç¡®å¤„ç†ä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦
    #os.path.join('/Users/michael', 'testdir')
    #'/Users/michael/testdir'
    #
    # æ‹†åˆ†
    #
    # è¦æ‹†åˆ†è·¯å¾„æ—¶ï¼Œä¹Ÿä¸è¦ç›´æ¥å»æ‹†å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.split()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æŠŠä¸€ä¸ªè·¯å¾„æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåä¸€éƒ¨åˆ†æ€»æ˜¯æœ€åçº§åˆ«çš„ç›®å½•æˆ–æ–‡ä»¶å
    #>>> os.path.split('/Users/michael/testdir/file.txt')
    #('/Users/michael/testdir', 'file.txt')

    # åˆ›å»ºä¸€ä¸ªç›®å½•:
    #>>> os.mkdir('/Users/michael/testdir')
    # åˆ æ‰ä¸€ä¸ªç›®å½•:
    #>>> os.rmdir('/Users/michael/testdir')

    # æ–‡ä»¶æ‹“å±•å
    #
    # os.path.splitext()å¯ä»¥ç›´æ¥è®©ä½ å¾—åˆ°æ–‡ä»¶æ‰©å±•å
    # >>> os.path.splitext('/path/to/file.txt')
    # ('/path/to/file', '.txt')

    #  å¯¹æ–‡ä»¶é‡å‘½å:
    # >>> os.rename('test.txt', 'test.py')
    # åˆ æ‰æ–‡ä»¶:
    # >>> os.remove('test.py')

    # å¤åˆ¶æ–‡ä»¶
    #
    # shutilæ¨¡å—æä¾›äº†copyfile()çš„å‡½æ•°ï¼Œä½ è¿˜å¯ä»¥åœ¨shutilæ¨¡å—ä¸­æ‰¾åˆ°å¾ˆå¤šå®ç”¨å‡½æ•°ï¼Œå®ƒä»¬å¯ä»¥çœ‹åšæ˜¯osæ¨¡å—çš„è¡¥å……

    # åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•
    # os.listdir('.')
    #
    # >>> [x for x in os.listdir('.') if os.path.isdir(x)]
    # ['.lein', '.local', '.m2', '.npm', '.ssh', '.Trash', '.vim', 'Applications', 'Desktop', ...]

    # åˆ—å‡ºæ‰€æœ‰çš„.pyæ–‡ä»¶
    # >>> [x for x in os.listdir('.') if os.path.isfile(x) and os.path.splitext(x)[1]=='.py']
    # ['apis.py', 'config.py', 'models.py', 'pymonitor.py', 'test_db.py', 'urls.py', 'wsgiapp.py']

    # path è·¯å¾„ å¯¹æ¯”    
    #
    print(__file__)  # D:/repo/repo_github/shared_already/python-demos/module_test.py
    print(os.path.dirname(__file__))  # D:/repo/repo_github/shared_already/python-demos
    curPath = os.path.abspath(os.path.dirname(__file__))
    print(curPath)  # D:\repo\repo_github\shared_already\python-demos
    rootPath = os.path.split(curPath)[0]
    print(rootPath)  # D:\repo\repo_github\shared_already
    # sys.path.append(curPath)
    sys.path.append(rootPath)
    print(sys.path)


```

### 2.6.2. è¯»å†™æ–‡ä»¶æ•°æ®

```py
def read_write_file():
    """
    open(file, mode='r', buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)
        file: å¿…éœ€ï¼Œæ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹æˆ–è€…ç»å¯¹è·¯å¾„ï¼‰ã€‚
        mode: å¯é€‰ï¼Œæ–‡ä»¶æ‰“å¼€æ¨¡å¼
            r ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶çš„æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ã€‚
            x å†™æ¨¡å¼ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™ä¼šæŠ¥é”™ã€‚
            b äºŒè¿›åˆ¶æ¨¡å¼ã€‚
            w æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚
            a æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚
            t æ–‡æœ¬æ¨¡å¼(é»˜è®¤)
            + æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ›´æ–°(å¯è¯»å¯å†™)ã€‚
        buffering: è®¾ç½®ç¼“å†²
            é€šè¿‡0ä»¥å…³é—­ç¼“å†²ï¼ˆä»…åœ¨äºŒè¿›åˆ¶æ¨¡å¼ä¸‹å…è®¸ï¼‰
            1 é€‰æ‹©è¡Œç¼“å†²ï¼ˆä»…åœ¨æ–‡æœ¬æ¨¡å¼ä¸‹å¯ç”¨ï¼‰
            å½“æœªç»™å‡ºbufferså‚æ•°æ—¶ï¼Œé»˜è®¤ç¼“å†²ç­–ç•¥å·¥ä½œå¦‚ä¸‹:
                
        encoding: ä¸€èˆ¬ä½¿ç”¨utf8
            å¦‚æœæœªæŒ‡å®šencodingï¼Œåˆ™ä½¿ç”¨çš„ç¼–ç å–å†³äºå¹³å°: locale.getpreferredencodingï¼ˆFalseï¼‰
        errors: æŠ¥é”™çº§åˆ«, å¸¸ç”¨ 'ignore'
        newline: åŒºåˆ†æ¢è¡Œç¬¦
            å¯ä»¥æ˜¯Noneã€''ã€'\n'ã€'\r'ã€'\r\n'
            è¯»å–æ•°æ®æ—¶, 
                å¦‚æœnewlineå‚æ•°ä¸ºNone, æ–‡ä»¶ä¸­çš„'\n'ï¼Œ'\r\n'ï¼Œ'\r'ï¼Œåœ¨è¿”è¿˜ç»™è°ƒç”¨è€…çš„æ—¶å€™éƒ½ä¼šè¢«è½¬åŒ–ä¸º'\n'
                å¦‚æœnewline = '', ä½†æ˜¯è¡Œçš„ç»“å°¾ç¬¦å·å¹¶ä¸ä¼šè¢«è½¬åŒ–
                å¦‚æœå®ƒå…·æœ‰ä»»ä½•å…¶å®ƒåˆæ³•å€¼ï¼Œåˆ™è¾“å…¥è¡Œä»…ç”±ç»™å®šå­—ç¬¦ä¸²ç»ˆæ­¢ï¼Œ
            å†™å…¥æ—¶
                å¦‚æœä¸è®¾ç½®newlineå‚æ•°, å³ä¸º None æ—¶, ä»»ä½•'\n'éƒ½ä¼šè¢«ç¿»è¯‘æˆå½“å‰ç³»ç»Ÿçš„line separatorï¼ˆä¹Ÿå°±æ˜¯os.linesep)
                å¦‚æœå‚æ•°ä¸º''æˆ–è€…'\n'ï¼Œä¸ä¼šæœ‰ä»»ä½•ç¿»è¯‘ã€‚
        closefd: ä¼ å…¥çš„fileå‚æ•°ç±»å‹
        opener:
    """
    f=None
    try:
        # read()ä¼šä¸€æ¬¡æ€§è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶æœ‰10Gï¼Œå†…å­˜å°±çˆ†äº†ï¼Œ
        #æ‰€ä»¥ï¼Œè¦ä¿é™©èµ·è§ï¼Œå¯ä»¥åå¤è°ƒç”¨read(size)æ–¹æ³•ï¼Œæ¯æ¬¡æœ€å¤šè¯»å–sizeä¸ªå­—èŠ‚çš„å†…å®¹ã€‚
        # r è¡¨ç¤º æ¨¡å¼ä¸º åªè¯», è¿˜æœ‰ w å†™, rw è¯»å†™, rb/wb äºŒè¿›åˆ¶
        f = open('./readme.md', 'r')
        print(f.read())
    finally:
        if f:
            f.close()

    # å¦‚æœæ–‡ä»¶å¾ˆå°ï¼Œread()ä¸€æ¬¡æ€§è¯»å–æœ€æ–¹ä¾¿ï¼›å¦‚æœä¸èƒ½ç¡®å®šæ–‡ä»¶å¤§å°ï¼Œåå¤è°ƒç”¨read(size)æ¯”è¾ƒä¿é™©ï¼›å¦‚æœæ˜¯é…ç½®æ–‡ä»¶ï¼Œè°ƒç”¨readlines()æœ€æ–¹ä¾¿ï¼š
    # è¯»å–é…ç½®æ–‡ä»¶
    for line in f.readlines():
        print(line.strip()) # æŠŠæœ«å°¾çš„'\n'åˆ æ‰

    # æ›´å¥½çš„æ–¹æ³• ---- è‡ªåŠ¨å…³é—­ f
    #
    # ä½†æ˜¯æ¯æ¬¡éƒ½è¿™ä¹ˆå†™å®åœ¨å¤ªç¹çï¼Œæ‰€ä»¥ï¼ŒPythonå¼•å…¥äº†withè¯­å¥æ¥è‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨close()
    with open('./readme.md', 'r') as f:
        print(f.read())


    #è¦è¯»å–éUTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ï¼Œéœ€è¦ç»™open()å‡½æ•°ä¼ å…¥encodingå‚æ•°
    # >>> f = open('/Users/michael/gbk.txt', 'r', encoding='gbk')
    # >>> f.read()
    # 'æµ‹è¯•'

    # é”™è¯¯å¤„ç†
    #ç›´æ¥å¿½ç•¥
    f = open('/Users/michael/gbk.txt', 'r', encoding='gbk', errors='ignore')

    # è¯»äºŒè¿›åˆ¶æ–‡ä»¶
    f = open('/Users/michael/test.jpg', 'rb')
    f.read()
    # b'\xff\xd8\xff\xe1\x00\x18Exif\x00\x00...' # åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—èŠ‚

    # å†™äºŒè¿›åˆ¶
    # å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œä¼šç›´æ¥è¦†ç›–, å¯ä»¥ä¼ å…¥'a'ä»¥è¿½åŠ ï¼ˆappendï¼‰æ¨¡å¼å†™å…¥
    f = open('/Users/michael/test.txt', 'w')
    # å¯ä»¥åå¤è°ƒç”¨write()æ¥å†™å…¥æ–‡ä»¶
    f.write('Hello, world!')
    # å†™æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¾€å¾€ä¸ä¼šç«‹åˆ»æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯æ”¾åˆ°å†…å­˜ç¼“å­˜èµ·æ¥ï¼Œç©ºé—²çš„æ—¶å€™å†æ…¢æ…¢å†™å…¥ã€‚
    #åªæœ‰è°ƒç”¨close()æ–¹æ³•æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¿è¯æŠŠæ²¡æœ‰å†™å…¥çš„æ•°æ®å…¨éƒ¨å†™å…¥ç£ç›˜
    f.close()
    # æ‰€ä»¥ï¼Œè¿˜æ˜¯ç”¨withè¯­å¥æ–¹ä¾¿

    #
    # åœ¨å†…å­˜è¯»å†™ stringIO
    # è¦æŠŠstrå†™å…¥StringIOï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªStringIOï¼Œç„¶åï¼Œåƒæ–‡ä»¶ä¸€æ ·å†™å…¥
    # >>> from io import StringIO
    # >>> f = StringIO() # å¯ä»¥åœ¨è¿™é‡Œç›´æ¥åˆå§‹åŒ–, ç±»æ¯” StringBuffer
    # >>> f.write('hello')
    # 5
    # >>> f.write(' ')
    # 1
    # >>> f.write('world!')
    # 6
    # >>> print(f.getvalue())
    # hello world!


    # # è¦æ“ä½œäºŒè¿›åˆ¶æ•°æ®ï¼Œå°±éœ€è¦ä½¿ç”¨BytesIO
    # >>> from io import BytesIO
    # >>> f = BytesIO()
    # >>> f.write('ä¸­æ–‡'.encode('utf-8'))
    # 6
    # >>> print(f.getvalue())
    # b'\xe4\xb8\xad\xe6\x96\x87'

    # åºåˆ—åŒ–
    #
    # dumps()æ–¹æ³•è¿”å›ä¸€ä¸ªstrï¼Œå†…å®¹å°±æ˜¯æ ‡å‡†çš„JSONã€‚ç±»ä¼¼çš„ï¼Œdump()æ–¹æ³•å¯ä»¥ç›´æ¥æŠŠJSONå†™å…¥ä¸€ä¸ªfile-like Objectã€‚
    # >>> import json
    # >>> d = dict(name='Bob', age=20, score=88)
    # >>> json.dumps(d)
    # '{"age": 20, "score": 88, "name": "Bob"}'


```


## 2.7. è£…é¥°å™¨


```py

def wrapper_decorator():
    """
    è£…é¥°å™¨
    """
    def now():
        print('2015-1-1')
    now()
    print(now.__name__)
    f = now
    f()
    print(f.__name__)

    print('---------------')

    import functools
    # æœ¬è´¨ä¸Š, decoratorå°±æ˜¯ä¸€ä¸ªè¿”å›å‡½æ•°çš„é«˜é˜¶å‡½æ•°, æ¥å—ä¸€ä¸ªå‡½æ•°, è¿”å›åŒ…è£…åçš„å‡½æ•°
    def log(func):
        @functools.wraps(func) # ä½œç”¨æ˜¯ä¿®æ”¹è£…é¥°åçš„å‡½æ•° __name__ å±æ€§å€¼, å¦‚æœä¸åŠ , è£…é¥°å™¨è¿˜æ˜¯å·¥ä½œçš„, ä½†æ˜¯ __name__ ä¼šå˜ä¸º "wrapper", æ˜¾ç„¶ä¸è¡Œ
        def wrapper(*args, **kw):
            print('call %s(): ' % func.__name__)
            return func(*args, **kw)
        return wrapper
    # æŠŠ@logæ”¾åˆ°new()å‡½æ•°çš„å®šä¹‰å¤„ï¼Œç›¸å½“äºæ‰§è¡Œäº† new = log(new)
    @log
    def new():
        print('111-111-111')
    new() # æ‰§è¡Œçš„æ˜¯åŒ…è£…åçš„å‡½æ•°

    # å¦‚æœdecoratoræœ¬èº«éœ€è¦ä¼ å…¥å‚æ•°ï¼Œé‚£å°±éœ€è¦ç¼–å†™ä¸€ä¸ªè¿”å›decoratorçš„é«˜é˜¶å‡½æ•°
    def log1(text):
        def decorator(func):
            @functools.wraps(func)
            def wrapper(*args, **kw):
                print('%s %s():' % (text, func.__name__))
                return func(*args, **kw)
            return wrapper
        return decorator
    @log1('è‡ªå®šä¹‰execute') # ç›¸å½“äº yyy =  log1('execute')(yyy)
    def yyy():
        print('zzz')
    yyy()





def cost_count(func):
    @wraps(func)
    def wraper(*args, **kwargs):
        start = time.time()
        t = func(*args, **kwargs)
        logging.info("%s tooks time: %f", func.__name__, time.time()-start)
        return t
    return wraper
```


## 2.8. æ¨¡å— ä½œç”¨åŸŸ

```py

hehe=6

def var_demo():
    # ä½œç”¨åŸŸå
    # å‡½æ•°å®šä¹‰äº†æœ¬åœ°ä½œç”¨åŸŸï¼Œè€Œæ¨¡å—å®šä¹‰çš„æ˜¯å…¨å±€ä½œç”¨åŸŸ, å¦‚æœæƒ³è¦åœ¨å‡½æ•°å†…å®šä¹‰/ä¿®æ”¹å…¨å±€ä½œç”¨åŸŸï¼Œéœ€è¦åŠ ä¸Šglobalä¿®é¥°ç¬¦
    global hehe
    print(hehe) # 6
    hehe=3 # ä¿®æ”¹
    pass




def module_demo():
    """
    -   åº“ å°±æ˜¯ä¸€ä¸ªé¡¹ç›®, åˆ†ä¸ºæ ‡å‡†åº“, ç¬¬ä¸‰æ–¹åº“(https://pypi.org/)
    -   åŒ… å°±æ˜¯åŒ…å« `__init__.py` çš„ç›®å½•, å¯èƒ½æœ‰å¤šä¸ªå­åŒ…, ä¹Ÿå¿…é¡»åŒ…å« init æ–‡ä»¶
    -   æ¯ä¸ª `*py` å°±æ˜¯ä¸€ä¸ª æ¨¡å—
    python æœ‰è‡ªå·±çš„æ¨¡å—æœç´¢è·¯å¾„, ä½†æ˜¯æ€ä¹ˆå¼•å…¥è‡ªå®šä¹‰çš„æ¨¡å—æœç´¢è·¯å¾„å‘¢?
    # æŸ¥çœ‹é»˜è®¤è·¯å¾„
    # æŸ¥æ‰¾é¡ºåºä¸º:
    # 1. ç¨‹åºæ‰€åœ¨ç›®å½•
    # 2. python å®‰è£…æ ‡å‡†åº“ç›®å½•(lib)
    # 3. ç¬¬ä¸‰æ–¹åº“ç›®å½• (site-package)
    import sys
    print(sys.path)
    # ä¸€æ¬¡æ€§è‡ªå®šä¹‰
    sys.path.append('/Users/michael/my_py_scripts')
    # æ°¸ä¹…
    è®¾ç½®ç¯å¢ƒå˜é‡PYTHONPATHï¼ŒPythonè‡ªèº«æœç´¢è·¯å¾„ä¸å—å½±å“
    """
    # æ–¹å¼ 1:
    # from xx.yy import hello
    # hello()

    # æ–¹å¼ 2:
    import xx.yy as yy
    yy.hello()

```

## 2.9. é¢å‘å¯¹è±¡

### 2.9.1. ç±»

```py
def oop():
    class Student(object):

        name__xx = "Student" # ç±»å±æ€§, å®ä¾‹å±æ€§ ç±»å±æ€§åƒä¸‡ä¸è¦åŒå, å› ä¸ºæŸ¥æ‰¾å®ä¾‹å±æ€§è‹¥æ²¡æ‰¾åˆ°, ä¼šè¿”å›ç±»å±æ€§

        __slots__ = ('name', '__score', '_age') # ç”¨tupleå®šä¹‰å…è®¸ç»‘å®šçš„å±æ€§åç§°
        # `__slots__`å®šä¹‰çš„å±æ€§ä»…å¯¹å½“å‰ç±»å®ä¾‹èµ·ä½œç”¨ï¼Œå¯¹ç»§æ‰¿çš„å­ç±»æ˜¯æ— é™åˆ¶çš„ 
        #é™¤éåœ¨å­ç±»ä¸­ä¹Ÿå®šä¹‰**slots**ï¼Œè¿™æ ·ï¼Œå­ç±»å®ä¾‹å…è®¸å®šä¹‰çš„å±æ€§å°±æ˜¯è‡ªèº«çš„**slots**åŠ ä¸Šçˆ¶ç±»çš„**slots**

        # æ„é€ æ–¹æ³•
        # > **init**æœ‰ä¸¤ä¸ªä¸‹åˆ’çº¿
        # > å®šä¹‰å¯¹è±¡æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ selfï¼Œè°ƒç”¨æ—¶ä¸ç”¨ä¼ å…¥ self
        #
        # `__len__()`:len(obj)å®é™…è°ƒç”¨ obj çš„`__len__()` 
        #
        # `__iter__() & __next__()`:å¦‚æœä¸€ä¸ªç±»æƒ³è¢«ç”¨äº for ... in å¾ªç¯,åˆ™å¿…é¡»å®ç°`__iter__()`ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å¯¹è±¡,`__next__()`æ–¹æ³•æ‹¿åˆ°å¾ªç¯çš„ä¸‹ä¸€ä¸ªå€¼
        #
        # `__getitem__ & __setitem__() & __delitem__()`:å®ç° list æŒ‰ä¸‹æ ‡å–å…ƒç´ çš„åŠŸèƒ½ï¼Œåˆ™å¿…é¡»å®ç°  
        #
        # `__getattr__ï¼ˆï¼‰`:åŠ¨æ€è¿”å›å±æ€§
        #
        def __init__(self, name, score):
            self.name = name
            self.__score = score

        def display(self):
            print('%s: %s' % (self.name, self.__score))

        # å¢åŠ getterå’Œsetter
        def get_score(self):
            return self.__score

        def set_score(self, score):
            self.__score = score

        @property # è´Ÿè´£æŠŠä¸€ä¸ªæ–¹æ³•å˜æˆå±æ€§è°ƒç”¨
        def age(self):
            return self._age
        @age.setter # @propertyæœ¬èº«åˆåˆ›å»ºäº†å¦ä¸€ä¸ªè£…é¥°å™¨@score.setter,æŠŠä¸€ä¸ªsetteræ–¹æ³•å˜æˆå±æ€§èµ‹å€¼
        def age(self, v):
            if not isinstance(v, int):
                raise ValueError('score must be an integer!')
            if v < 0 or v > 100:
                raise ValueError('score must between 0 ~ 100!')
            self._age = v

        def __str__(self): # `__str__()`:print(obj)å®é™…è°ƒç”¨ obj çš„`__str__()`  
            return 'Student object (name=%s)' % self.name
        __repr__ = __str__# `__repr__()`:ç›´æ¥ obj è°ƒç”¨ obj çš„`__repr__()`,é€šå¸¸å’Œ `__str__()`ä¸€æ ·

    s1 = Student('s1', 10)
    s1.display()
    print(s1)
    
    # åŠ äº† `__slot__`, ä¸å…è®¸åœ¨å¤–éƒ¨ç»‘å®šä»»ä½•å˜é‡
    # s1.sex = 'male'
    # print(s1.sex)

     # æ— æ³•è®¿é—®ç§æœ‰çš„
    # ä¸èƒ½ç›´æ¥è®¿é—®__nameæ˜¯å› ä¸ºPythonè§£é‡Šå™¨å¯¹å¤–æŠŠ__nameå˜é‡æ”¹æˆäº†_Student__nameï¼Œæ‰€ä»¥ï¼Œä»ç„¶å¯ä»¥é€šè¿‡_Student__nameæ¥è®¿é—®__nameå˜é‡
    #print(s1.__score)
    print(s1.get_score())
    s1.set_score(11) # ok
    # s1.__score =11 # error

    s1.age = 10
    print("age = ", s1.age)

```



### 2.9.2. ç»§æ‰¿ é¸­å­ç±»å‹


```py

 # 
    # ç»§æ‰¿
    #
    class People(object):
        def say(self):
            print("hello people")
        def run(self):
            print("run people")

    class Student(People):  # ç»§æ‰¿
        def run(self): # é‡å†™
            print("run students")

    stu = Student()
    stu.say() # hello people
    stu.run() # run students

    print(isinstance(stu, People)) # true
    print(isinstance(stu, Student))# true

    #
    # é¸­å­ç±»å‹
    #
    class Animal(object):
        def eat(self):
            print("animal eat")
        def run(self):
            print("run animal")
    class Bird(object):
        def eat(self):
            print("eat bird")
    print(isinstance(Bird(), Animal))# false
    def demo(p):
        p.run()
    demo(stu)
    demo(People())
    demo(Animal()) # animal æ²¡æœ‰ç»§æ‰¿ People, ä¹Ÿå¯ä½œä¸ºå‚æ•°ä¼ å…¥ demo(), é¸­å­ç±»å‹


```

### 2.9.3. åˆ¤æ–­ç±»å‹ä¿¡æ¯


```py
#
    # ç±»å‹ä¿¡æ¯
    #
    #>>> type(123)==type(456)
    # True
    # >>> type(123)==int
    # True
    # >>> type('abc')==type('123')
    # True
    # >>> type('abc')==str
    # True
    # >>> type('abc')==type(123)
    # False

    # # å…¶ä»–ç±»å‹
    # >>> import types
    # >>> def fn():
    # ...     pass
    # ...
    # >>> type(fn)==types.FunctionType
    # True
    # >>> type(abs)==types.BuiltinFunctionType
    # True
    # >>> type(lambda x: x)==types.LambdaType
    # True
    # >>> type((x for x in range(10)))==types.GeneratorType
    # True

    # # isinstance()
    # # åŸºæœ¬ç±»å‹
    # >>> isinstance('a', str)
    # True
    # >>> isinstance(123, int)
    # True
    # >>> isinstance(b'a', bytes)
    # True
    # # ç»§æ‰¿ä½“ç³»
    # >>> isinstance(h, Dog)
    # True
    # >>> isinstance(h, Animal)
    # True
    # >>> isinstance(d, Dog) and isinstance(d, Animal)
    # True
    # # åˆ¤æ–­æ˜¯å‡ ç§ä¸­ä¹‹ä¸€ç§
    # >>> isinstance([1, 2, 3], (list, tuple))
    # True
    # >>> isinstance((1, 2, 3), (list, tuple))
    # True

```

### 2.9.4. åŠ¨æ€æ“ä½œ


```py
# 
    # åŠ¨æ€æ“ä½œ object å±æ€§
    #
    # dir(obj)---------è·å– obj çš„æ‰€æœ‰å¯¹è±¡ã€å±æ€§ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² list  
    # é…åˆ getattr()ã€setattr()ä»¥åŠ hasattr()ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€
    #
    # >>> class MyObject(object):
    # ...     def __init__(self):
    # ...         self.x = 9
    # ...     def power(self):
    # ...         return self.x * self.x
    # ...
    # >>> obj = MyObject()
    # >>> hasattr(obj, 'x') # æœ‰å±æ€§'x'å—ï¼Ÿ
    # True
    # >>> obj.x
    # 9
    # >>> hasattr(obj, 'y') # æœ‰å±æ€§'y'å—ï¼Ÿ
    # False
    # >>> setattr(obj, 'y', 19) # è®¾ç½®ä¸€ä¸ªå±æ€§'y'
    # >>> hasattr(obj, 'y') # æœ‰å±æ€§'y'å—ï¼Ÿ
    # True
    # >>> getattr(obj, 'y', 404) # è·å–å±æ€§'y',å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤å€¼404
    # 19
    # >>> obj.y # è·å–å±æ€§'y'
    # 19
    # # è·å–å¯¹è±¡
    # >>> hasattr(obj, 'power') # æœ‰å±æ€§'power'å—ï¼Ÿ
    # True
    # >>> getattr(obj, 'power') # è·å–å±æ€§'power'
    # <bound method MyObject.power of <__main__.MyObject object at 0x10077a6a0>>
    # >>> fn = getattr(obj, 'power') # è·å–å±æ€§'power'å¹¶èµ‹å€¼åˆ°å˜é‡fn
    # >>> fn # fnæŒ‡å‘obj.power
    # <bound method MyObject.power of <__main__.MyObject object at 0x10077a6a0>>
    # >>> fn() # è°ƒç”¨fn()ä¸è°ƒç”¨obj.power()æ˜¯ä¸€æ ·çš„
    # 81



 #
    # åŠ¨æ€åˆ›å»ºç±», å…ƒç±», metaClass
    #
    # åˆ›å»ºclass
    class Hello(object):
        def hello(self, name='world'):
            print('Hello, %s.' % name)

    h = Hello()
    print(type(h))# <class '__main__.Hello'> hçš„ç±»å‹æ˜¯Hello
    print(type(Hello))# <class 'type'> Helloçš„ç±»å‹æ˜¯type

    # åŠ¨æ€åˆ›å»ºclass
    def fn(self, name='world'):
        print('Hello, %s.' % name)
    Hello1 = type('Hello1', (object,), dict(hello=fn))
    h1 = Hello1()
    print(h1) # <__main__.Hello1 object at 0x7faef9cd5c90>
    h1.hello() # Hello, world.

```



### 2.9.5. é­”æœ¯æ–¹æ³•

```py

__repr__ å’Œ __str__: ç”¨äº print(xx) è¢«è°ƒç”¨, è‹¥ __str__å­˜åœ¨, åˆ™ä¼˜å…ˆä½¿ç”¨ __str__, ä¸€èˆ¬ä¼šä»¤ __repr__ = __str__




    import math

    class Vector:

        def __init__(self, x=0, y=0):
            self.x = x
            self.y = y

        # ä¸ºäº†ä½¿ç”¨ str(xxx)
        def __repr__(self):
            return f'Vector({self.x!r}, {self.y!r})'

        # ç­‰æ•ˆ sqart(a**2 + b**2)
        def __abs__(self):
            return math.hypot(self.x, self.y)

        # ä¸ºäº†ä½¿ç”¨ bool()
        def __bool__(self):
            return bool(abs(self))
        # ä¸ºäº†ä½¿ç”¨ +
        def __add__(self, other):
            x = self.x + other.x
            y = self.y + other.y
            return Vector(x, y)
        # for ä¹˜æ³•
        def __mul__(self, scalar):
            return Vector(self.x * scalar, self.y * scalar)




#
    #
    # åº”ç”¨ï¼šREST APIçš„é“¾å¼è°ƒç”¨
    class Chain(object):

        def __init__(self, path=''):
            self._path = path

        def __getattr__(self, path):
            return Chain('%s/%s' % (self._path, path))

        def __str__(self):
            return self._path

        __repr__ = __str__

    # >>> Chain().status.user.timeline.list
    # '/status/user/timeline/list'

    # `__call__ï¼ˆï¼‰`:é€šè¿‡å®ä¾‹æœ¬èº«è°ƒç”¨çš„æ–¹æ³•-------------æŠŠå¯¹è±¡çœ‹æˆå‡½æ•°  
    # å¸¦æœ‰`__call__ï¼ˆï¼‰`çš„å¯¹è±¡æ˜¯`Callable`å¯¹è±¡ï¼Œå¦‚ä½•åˆ¤æ–­ï¼Ÿ  
    # é€šè¿‡ callable(obj)ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­ä¸€ä¸ª obj æ˜¯å¦æ˜¯â€œå¯è°ƒç”¨â€å¯¹è±¡
    #
    class Student(object):
        def __init__(self, name):
            self.name = name

        def __call__(self):
            print('My name is %s.' % self.name)
    # >>> s = Student('Michael')
    # >>> s() # selfå‚æ•°ä¸è¦ä¼ å…¥
    # My name is Michael.



```


### 2.9.6. æšä¸¾


```py


 #
    # æšä¸¾ç±»
    #
    #    
    # æšä¸¾æˆå‘˜å¯è¿›è¡ŒåŒä¸€æ€§æ¯”è¾ƒ  
    # Color.red is Color.red  
    # ã€€ã€€è¾“å‡ºç»“æœæ˜¯ï¼šTrue  
    # Color.red is not Color.blue  
    # ã€€ã€€è¾“å‡ºç»“æœæ˜¯ï¼šTrue  
    # æšä¸¾æˆå‘˜å¯è¿›ç­‰å€¼æ¯”è¾ƒ  
    # Color.blue == Color.red  
    # ã€€ã€€è¾“å‡ºç»“æœæ˜¯ï¼šFalse  
    # Color.blue != Color.red  
    # ã€€ã€€è¾“å‡ºç»“æœæ˜¯ï¼šTrue
    from enum import Enum, unique
    # simple way to define, é»˜è®¤èµ‹å€¼1ï¼Œ2ï¼Œ3ï¼Œ4...
    Month = Enum('Month', ('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'))
    print(Month.Jan.value) # 1
    print(Month.Jan.name) #Jan
    print(Month.Jan)#Month.Jan
    print(Month['Jan'])# é€šè¿‡åç§°è·å–æˆå‘˜,  # Month.Jan
    print(Month(1))# é€šè¿‡å€¼è·å–æˆå‘˜ # Month.Jan
    print('----------------')
    for month in Month:
        print(month)
    print('----------------')
    for month in Month.__members__.items():
        print(month[0], month[1])
    print('----------------')
    for name, value in Month.__members__.items():
        print(name, value)

print("------------------------------")
    # customize class,å¯è‡ªå·±èµ‹å€¼
    @unique
    class Weekday(Enum):
        Sun = 0
        Mon = 1
        Tue = 2
        Wed = 3
        Thu = 4
        Fri = 5
        Sat = 6
    for name, value in Weekday.__members__.items():
        print(name, value)

```

### 2.9.7. å®ä¾‹æ–¹æ³• ç±»æ–¹æ³• é™æ€æ–¹æ³•

https://zhuanlan.zhihu.com/p/21101992

## 2.10. é”™è¯¯å¼‚å¸¸å¤„ç†


```py
def error_handling():
    """
    BaseException
    +-- SystemExit
    +-- KeyboardInterrupt
    +-- GeneratorExit
    +-- Exception
        +-- StopIteration
        +-- StopAsyncIteration
        +-- ArithmeticError
        |    +-- FloatingPointError
        |    +-- OverflowError
        |    +-- ZeroDivisionError
        +-- AssertionError
        +-- AttributeError
        +-- BufferError
        +-- EOFError
        +-- ImportError
            +-- ModuleNotFoundError
        +-- LookupError
        |    +-- IndexError
        |    +-- KeyError
        +-- MemoryError
        +-- NameError
        |    +-- UnboundLocalError
        +-- OSError
        |    +-- BlockingIOError
        |    +-- ChildProcessError
        |    +-- ConnectionError
        |    |    +-- BrokenPipeError
        |    |    +-- ConnectionAbortedError
        |    |    +-- ConnectionRefusedError
        |    |    +-- ConnectionResetError
        |    +-- FileExistsError
        |    +-- FileNotFoundError
        |    +-- InterruptedError
        |    +-- IsADirectoryError
        |    +-- NotADirectoryError
        |    +-- PermissionError
        |    +-- ProcessLookupError
        |    +-- TimeoutError
        +-- ReferenceError
        +-- RuntimeError
        |    +-- NotImplementedError
        |    +-- RecursionError
        +-- SyntaxError
        |    +-- IndentationError
        |         +-- TabError
        +-- SystemError
        +-- TypeError
        +-- ValueError # int() å¯èƒ½å‘ç”Ÿ
        |    +-- UnicodeError
        |         +-- UnicodeDecodeError
        |         +-- UnicodeEncodeError
        |         +-- UnicodeTranslateError
        +-- Warning
            +-- DeprecationWarning
            +-- PendingDeprecationWarning
            +-- RuntimeWarning
            +-- SyntaxWarning
            +-- UserWarning
            +-- FutureWarning
            +-- ImportWarning
            +-- UnicodeWarning
            +-- BytesWarning
            +-- ResourceWarning
    """
    # é€šè¿‡é…ç½®ï¼Œloggingè¿˜å¯ä»¥æŠŠé”™è¯¯è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶é‡Œï¼Œæ–¹ä¾¿äº‹åæ’æŸ¥
    import logging

    try:
        print('try...')
        r = 10 / int('2')
        print('result:', r)
    except ValueError as e:
        print('ValueError:', e)
        logging.exception(e)
    except ZeroDivisionError as e:
        print('ZeroDivisionError:', e)
    # æ²¡æœ‰é”™è¯¯å‘ç”Ÿå°±æ‰§è¡Œ
    else:
        print('no error!')
    finally:
        print('finally...')
    print('END')


    # æ•è·ç„¶ååŸæ ·æŠ›å‡º
    # raiseè¯­å¥å¦‚æœä¸å¸¦å‚æ•°ï¼Œå°±ä¼šæŠŠå½“å‰é”™è¯¯åŸæ ·æŠ›å‡º
    def foo(s):
        n = int(s)
        if n==0:
            print("can not be 0")
            raise ValueError('invalid value: %s' % s)
        return 10 / n

    def bar():
        try:
            foo('0')
        except ValueError as e:
            print('ValueError!--------------------')
            raise

    try:
        bar()
    except Exception as e:
        print("handling<<<<<<<<<<<<<")

    # è‡ªå®šä¹‰é”™è¯¯
    #
    # 
    class FooError(ValueError):
        pass

    def foo(s):
        n = int(s)
        if n==0:
            raise FooError('invalid value: %s' % s)
        return 10 / n

    # foo('0')

```

# 3. å·¥ç¨‹åŒ–

https://zhuanlan.zhihu.com/p/509167266
https://pythonguidecn.readthedocs.io/zh/latest/writing/structure.html
https://www.qin.news/python/


## cookiecutter é¡¹ç›®æ¨¡æ¿

https://github.com/cookiecutter/cookiecutter

```sh

pip3 install -U cookiecutter

cookiecutter https://github.com/pyloong/cookiecutter-pythonic-project

```

## Setuptools: ç®¡ç†ä¾èµ–ã€æ„å»ºå’Œå‘å¸ƒ

## è™šæ‹Ÿç¯å¢ƒ

```sh
docker åº”ç”¨çº§åˆ«çš„éš”ç¦» (é€‚åˆç”Ÿäº§)

virtualenv ä¼šåœ¨é¡¹ç›®è·¯å¾„ä¸‹æ–°å»ºä¸€ä¸ªvenvç›®å½•ç”¨äºå­˜å‚¨ç‹¬ç«‹çš„pythonè§£é‡Šå™¨åŠå…¶ç¬¬ä¸‰æ–¹ä¾èµ–åº“ï¼Œä½†é¡¹ç›®ä¹‹é—´ä¼šå…±äº«æ“ä½œç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ã€æ–‡ä»¶ç³»ç»Ÿç­‰ã€‚

conda éš”ç¦»èƒ½åŠ›æœ€å¼±ï¼Œæä¾›ç³»ç»Ÿç¯å¢ƒçº§åˆ«çš„éš”ç¦»ã€‚Condaå¯ä»¥åˆ›å»ºå¤šä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œæ¯ä¸ªç¯å¢ƒéƒ½å¯ä»¥ç”±å¤šä¸ªé¡¹ç›®å…±äº«ã€‚(é€‚åˆå¼€å‘)
    å› ä¸ºæ‰‹ä¸Šçš„é¡¹ç›®ä¹‹å‰å½¼æ­¤ä¾èµ–ã€ä¸”åŒæ—¶åœ¨è¿­ä»£å¼€å‘ï¼Œå°†å¤šä¸ªé¡¹ç›®å®‰è£…åœ¨åŒä¸€ç¯å¢ƒä¸­ï¼Œå¯ä»¥å‡å°‘é…ç½®ã€æµ‹è¯•ã€ç¼–è¯‘æ‰€éœ€çš„æ—¶é—´ã€‚
```

## devops æ„å»ºæµæ°´çº¿

```sh

Fabric+Invoke

```

## å‘å¸ƒè‡ªå®šä¹‰åº“

https://github.com/pypa/twine Twine is a utility for publishing Python packages on PyPI.

## é¡¹ç›®ç»“æ„

```sh
Dockerfile
docs
pyproject.toml åŸºäº PEP518 è§„èŒƒçš„é…ç½®æ–‡ä»¶ï¼Œä¿å­˜äº†é¡¹ç›®ä»‹ç»ã€ä½œè€…è”ç³»æ–¹å¼ã€æ‰€ä¾èµ–çš„åŒ…ã€ä½¿ç”¨çš„æ„å»ºå·¥å…·
{project_name} æ”¾å®é™…é¡¹ç›®ä»£ç çš„æ–‡ä»¶å¤¹ ä¹‹æ‰€ä»¥ä¸ç”¨ src æ˜¯å› ä¸ºä½ åœ¨ç¼–å†™æµ‹è¯•ç”¨ä¾‹ã€æˆ–è€…æŠŠå®ƒä½œä¸º python çš„åŒ…ç»™å…¶å®ƒé¡¹ç›®ç”¨æ—¶ä¼šæ›´æ–¹ä¾¿
{project_name}-stubs å­˜æ”¾ mypy ç”Ÿæˆçš„ç±»å‹æè¿°æ–‡ä»¶ã€‚mypy ä¼šè‡ªåŠ¨è¯»å–è¿™ä¸ªé¡¹ç›®ä¸­çš„ç±»å‹æè¿°ï¼Œæ–¹ä¾¿åšç±»å‹åˆ¤æ–­ã€‚
tests
tox.ini tox çš„é…ç½®æ–‡ä»¶ã€‚


```

## æ¨¡å—å¼•å…¥ importåŸç†

```sh

ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—

æ¨¡å—åç§°è¦çŸ­ã€ä½¿ç”¨å°å†™ï¼Œå¹¶é¿å…ä½¿ç”¨ç‰¹æ®Šç¬¦å·, å¦‚".", "?"... (å°± my.spam.py æ¥è¯´ï¼ŒPython è®¤ä¸ºéœ€è¦åœ¨ my æ–‡ä»¶å¤¹ ä¸­æ‰¾åˆ° spam.py æ–‡ä»¶ï¼Œå®é™…å¹¶ä¸æ˜¯è¿™æ ·), å¯ä½¿ç”¨"_" ä½†ä¸æ¨è

import modu è¯­å¥å°† å¯»æ‰¾åˆé€‚çš„æ–‡ä»¶ï¼Œå³è°ƒç”¨ç›®å½•ä¸‹çš„ modu.py æ–‡ä»¶ï¼ˆå¦‚æœè¯¥æ–‡ä»¶å­˜åœ¨ï¼‰ã€‚å¦‚æœæ²¡æœ‰ æ‰¾åˆ°è¿™ä»½æ–‡ä»¶ï¼ŒPython è§£é‡Šå™¨é€’å½’åœ°åœ¨ "PYTHONPATH" ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶ï¼Œå¦‚æœä»æ²¡ æœ‰æ‰¾åˆ°ï¼Œå°†æŠ›å‡º ImportError å¼‚å¸¸
    ä¸€æ—¦æ‰¾åˆ° modu.pyï¼ŒPython è§£é‡Šå™¨å°†åœ¨éš”ç¦»çš„ä½œç”¨åŸŸå†…æ‰§è¡Œè¿™ä¸ªæ¨¡å—ã€‚æ‰€æœ‰é¡¶å±‚ è¯­å¥éƒ½ä¼šè¢«æ‰§è¡Œï¼ŒåŒ…æ‹¬å…¶ä»–çš„å¼•ç”¨ã€‚æ–¹æ³•ä¸ç±»çš„å®šä¹‰å°†ä¼šå­˜å‚¨åˆ°æ¨¡å—çš„å­—å…¸ä¸­ã€‚ç„¶åï¼Œè¿™ä¸ª æ¨¡å—çš„å˜é‡ã€æ–¹æ³•å’Œç±»é€šè¿‡å‘½åç©ºé—´æš´éœ²ç»™è°ƒç”¨æ–¹ï¼Œ

å¦‚æœå¼•ç”¨è‡ªå·±é¡¹ç›®çš„çš„æ¨¡å—æ—¶ï¼Œä½ çš„é¡¹ç›®å« myï¼Œæ¨¡å—å« moduï¼Œé‚£ä¹ˆä¸å»ºè®®ä½¿ç”¨ from my import moduæ¥å¼•ç”¨ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ from . import moduã€‚

æ–‡ä»¶å¤¹ä¹Ÿå¯è¢«æ˜¯ä¸ºä¸€ä¸ªæ¨¡å—, éœ€è¦åŠ å…¥ __init__.py æ–‡ä»¶
```

## ç±»å‹æ£€è½¦ type hints

```sh

è‡ª python3.5 å¼€å§‹ï¼ŒPEP484 ä¸º python å¼•å…¥äº†ç±»å‹æ³¨è§£ (type hints) ----------   Mypy æ˜¯ Python ä¸­çš„é™æ€ç±»å‹æ£€æŸ¥å™¨

åœ¨ vscode ä¸­ä½ å¯ä»¥å®‰è£… mypy çš„æ’ä»¶

```


## linter å·¥å…·

```sh


å…³æ³¨è¿™ä¸ªå…¬å¸ https://astral.sh/

    https://github.com/astral-sh/ruff å¯ä»¥æŒ‡å‡ºæ— ç”¨çš„å¼•å…¥, è‡ªåŠ¨ä¿®å¤, æœ‰ vscode æ’ä»¶ (https://github.com/astral-sh/ruff-vscode)

https://www.pylint.org/


```

## ä¾èµ–å®‰å…¨æ€§æ£€æŸ¥

```sh
https://github.com/pyupio/safety
https://github.com/PyCQA/bandit

```

## ä»£ç é£æ ¼ æ ¼å¼åŒ–

```sh

Python å®˜æ–¹åŒæ—¶æ¨å‡ºäº†ä¸€ä¸ªæ£€æŸ¥ä»£ç é£æ ¼æ˜¯å¦ç¬¦åˆ PEP8 çš„å·¥å…·ï¼Œåå­—ä¹Ÿå« pep8ã€‚ä¸æ¨èäº†

æ›´æ¨è
Black è‡ªç§°â€œé›¶å¦¥åä»£ç æ ¼å¼åŒ–å·¥å…·ï¼ˆThe uncompromising code formatterï¼‰â€ã€‚ä¹‹æ‰€ä»¥æˆä¸ºâ€œä¸å¦¥åâ€æ˜¯å› ä¸ºå®ƒæ£€æµ‹åˆ°ä¸ç¬¦åˆè§„èŒƒçš„ä»£ç é£æ ¼ç›´æ¥å°±å¸®ä½ å…¨éƒ¨æ ¼å¼åŒ–å¥½ï¼Œæ ¹æœ¬ä¸éœ€è¦ä½ ç¡®å®šï¼Œç›´æ¥æ›¿ä½ åšå¥½å†³å®š
    é€Ÿåº¦æ›´å¿«
    æ›´å°‘çš„å¯é…ç½®é¡¹


https://pycqa.github.io/isort/ sort imports

https://github.com/asottile/pyupgrade å‡çº§è¯­æ³•

Flake8: ä½¿ç”¨Flake8æ£€æŸ¥ä»£ç æ˜¯å¦å·²æ ¼å¼åŒ–

```

## é…ç½®æ–‡ä»¶ç®¡ç†

```sh
https://github.com/dynaconf/dynaconf Dynaconf åŠ¨æ€é…ç½®ä½“ç³» 


```


## æµ‹è¯•test

### å•å…ƒæµ‹è¯• unittest

```sh
Pytest 
    åœ¨ unittest çš„åŸºç¡€ä¸Š å¢åŠ äº†å¤§é‡è¯­æ³•ç³–ï¼Œè®©æµ‹è¯•æ›´åŠ ç®€ä¾¿å’Œçµæ´»ã€‚å¹¶ä¸”å¸¦æœ‰æ’ä»¶åŠŸèƒ½ï¼Œæ–¹ä¾¿é›†æˆå…¶ä»–åŠŸèƒ½ã€‚
    èƒ½å…¼å®¹å…¶ä»–å¤§å¤šæ•°æµ‹è¯•æ¡†æ¶

tox æ˜¯é€šç”¨çš„è™šæ‹Ÿç¯å¢ƒç®¡ç†å’Œæµ‹è¯•å‘½ä»¤è¡Œå·¥å…·ã€‚tox èƒ½å¤Ÿè®©æˆ‘ä»¬åœ¨åŒä¸€ä¸ª Host ä¸Šè‡ªå®šä¹‰å‡ºå¤šå¥—ç›¸äº’ç‹¬ç«‹ä¸”éš”ç¦»çš„ python ç¯å¢ƒï¼Œå¦‚æœä½ çš„é¡¹ç›®éœ€è¦å…¼å®¹å¤šä¸ª python ç‰ˆæœ¬çš„è¯å¼ºçƒˆæ¨èä½¿ç”¨å®ƒ



https://github.com/pytest-dev/pytest-cov è¦†ç›–ç‡

https://www.cnblogs.com/wxcx/p/13709570.html
https://www.osgeo.cn/pytest/contents.html



```

### æ€§èƒ½å‹æµ‹

https://github.com/locustio/locust

### é›†æˆæµ‹è¯• integration test

```sh

Seleniumã€Pytest-Seleniumã€Robot Framework

```

    


## 3.1. åŒ…ç®¡ç†

https://zhuanlan.zhihu.com/p/683701953 å¯¹æ¯”

```sh

https://github.com/python-poetry/poetry ç±»ä¼¼ Pipevn, åŸºäºè™šæ‹Ÿç¯å¢ƒ, ä¸»è¦æ˜¯ä¸ºäº†éš”ç¦»é¡¹ç›®å¼€å‘ç¯å¢ƒï¼Œä½†å¦‚æœæ¶‰åŠåˆ°è™šæ‹Ÿ ç¯å¢ƒåµŒå¥—è™šæ‹Ÿç¯å¢ƒï¼Œé—®é¢˜å°±éš¾æäº†ï¼Œç»å¸¸ä¼šå‡ºç°é—®é¢˜
    # å®‰è£…æœ€æ–°ç‰ˆ pip
    # -m pip: ä½¿ç”¨Pythonæ¨¡å—çš„æ–¹å¼æ¥è°ƒç”¨pipï¼Œå³é€šè¿‡pipæ¨¡å—æ¥æ‰§è¡Œæ“ä½œã€‚
    # -U: é€‰é¡¹è¡¨ç¤ºè¦æ›´æ–°å·²å®‰è£…çš„åŒ…ã€‚å¦‚æœå·²ç»å®‰è£…äº†pipï¼Œä½¿ç”¨-Ué€‰é¡¹å¯ä»¥å°†å…¶å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚
    python3 -m pip install -U pip
    pip install -U poetry

https://github.com/pdm-project/pdm ä¸éœ€è¦è™šæ‹Ÿç¯å¢ƒ , åƒ pnpm ä¸€æ ·çš„ä¸­å¿ƒåŒ–å®‰è£…ç¼“å­˜ï¼ŒèŠ‚çœç£ç›˜ç©ºé—´
    https://zhuanlan.zhihu.com/p/468445226
    å›½äººä½œè€…https://github.com/frostming - https://frostming.com/2020/02-28/pdm-introduction/

https://github.com/mitsuhiko/rye
    https://github.com/astral-sh/uv ä»£æ›¿ pip, å¯ä»¥é›†æˆè¿›å…¥ rye (uv he ruff éƒ½å±äºä¸€ä¸ªå…¬å¸, ç°åœ¨ rye ä¹Ÿè¢«è¿™ä¸ªå…¬å¸æ¥æ”¶äº†)



```

### rye ä½¿ç”¨

```sh
# ä¸ç”Ÿæˆ src ç›®å½•, ç”¨äºå’Œ Django è¿™æ€»æ¡†æ¶åˆä½œ
rye init --virtual

rye init [--script] <proj name>
# å°†å½“å‰æ–‡ä»¶å¤¹ä½œä¸ºé¡¹ç›®æ ¹ç›®å½•
rye init 

# å…¨å±€å®‰è£…
rye install <lib name>
rye uninstall <xxx>

# å®‰è£…åˆ°å½“å‰é¡¹ç›®çš„è™šæ‹Ÿç¯å¢ƒä¸­
rye add <lib name>
rye remove <xxx>
rye sync
rye run <proj name>

rye run <executable name>
# eg. 
rye run black

# list the libs installed in this proj
rye list
# or
# é¡¹ç›®åŸºæœ¬ä¿¡æ¯ (åˆ—å‡ºå®‰è£…çš„ä¾èµ–)
rye show [--installed-deps]



# ä¸‹è½½ æ–°ç‰ˆPython
rye fetch <py version>
# eg
rye fetch 3.10

# æ·»åŠ  Python å‘è¡Œç‰ˆåˆ° rye, å¹¶ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬
rye +3.10

# åˆ—å‡º rye ç®¡ç†çš„æ‰€æœ‰å‘è¡Œç‰ˆ (ä¹Ÿå¯ä»¥åˆ—å‡ºå¯ä¾› ä¸‹è½½çš„ç‰ˆæœ¬)
rye toolchain list [--include-downloadable]
```


### uv





## 3.2. æ—¥å¿—



```py
def log_handling():
    import logging
    # æœ‰debugï¼Œinfoï¼Œwarningï¼Œerrorç­‰å‡ ä¸ªçº§åˆ«ï¼Œç­‰çº§ç”±ä½åˆ°é«˜
    # è®¾å®šä¸ºæŸä¸ªçº§åˆ«, ä½äºè¿™ä¸ªçº§åˆ«çš„ä¸ä¼šè¾“å‡º
    logging.basicConfig(level=logging.INFO)
    s = '0'
    n = int(s)
    logging.info('n = %d' % n)
    # print(10 / n)

```


## ç”Ÿæˆæ–‡æ¡£

Mkdocs: ä»¥ Markdown é£æ ¼ç¼–å†™æ–‡æ¡£

https://www.mkdocs.org/

https://squidfunk.github.io/mkdocs-material/ ä¸»é¢˜



# 4. å¤šè¿›ç¨‹

https://jeremyxu2010.github.io/2020/09/python%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%AE%9E%E6%88%98/ è‡ªå¸¦æ–¹å¼

gevent


https://stackoverflow.com/questions/42680357/increment-counter-for-every-access-to-a-flask-view é€šè¿‡å…¨å±€å˜é‡åŠ é”, ç»Ÿè®¡ api è°ƒç”¨æ¬¡æ•°

```py
def multi_processing():
    """
    åœ¨Unix/Linuxä¸‹ï¼Œå¯ä»¥ä½¿ç”¨fork()è°ƒç”¨å®ç°å¤šè¿›ç¨‹ã€‚
    è¦å®ç°è·¨å¹³å°çš„å¤šè¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨multiprocessingæ¨¡å—ã€‚
    è¿›ç¨‹é—´é€šä¿¡æ˜¯é€šè¿‡Queueã€Pipesç­‰å®ç°çš„ã€‚
    subprocessæ¨¡å—å¯ä»¥è®©æˆ‘ä»¬éå¸¸æ–¹ä¾¿åœ°å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åæ§åˆ¶å…¶è¾“å…¥å’Œè¾“å‡ºã€‚é€šè¿‡communicate()æ–¹æ³•è¾“å…¥
    
    """

    import os
    print("ä¸»è¿›ç¨‹ pid = ", os.getpid())
    # fork()è°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›ä¸¤æ¬¡ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿè‡ªåŠ¨æŠŠå½“å‰
    # è¿›ç¨‹ï¼ˆç§°ä¸ºçˆ¶è¿›ç¨‹ï¼‰å¤åˆ¶äº†ä¸€ä»½ï¼ˆç§°ä¸ºå­è¿›ç¨‹ï¼‰ï¼Œç„¶åï¼Œåˆ†åˆ«åœ¨çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å†…è¿”å› process id
    # å­è¿›ç¨‹æ°¸è¿œè¿”å›0ï¼Œè€Œçˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„ID
    pid = os.fork()
    if pid ==0:
        print("å­è¿›ç¨‹, id = {}, ppid = {}".format(os.getpid(), os.getppid()))
    else:
        print("çˆ¶è¿›ç¨‹, id = {}, son pid = {}".format(os.getpid(), pid))


def multi_processing_windows():
    """è·¨å¹³å°çš„å¤šè¿›ç¨‹"""
    from multiprocessing import Process
    import os

    # å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç 
    def run_proc(name):
        print('Run child process %s (%s)...' % (name, os.getpid()))

    print('Parent process %s.' % os.getpid())
    p = Process(target=run_proc, args=('test',))
    p.start()

    p.join() # main process 
    print('Child process end.')

    # è¿›ç¨‹æ± 
    #
    from multiprocessing import Pool
    import os, time, random

    def long_time_task(name):
        print('Run task %s (%s)...' % (name, os.getpid()))
        start = time.time()
        time.sleep(random.random() * 3)
        end = time.time()
        print('Task %s runs %0.2f seconds.' % (name, (end - start)))

    if __name__=='__main__':
        print('Parent process %s.' % os.getpid())
        p = Pool(4) # Poolçš„é»˜è®¤å¤§å°æ˜¯CPUçš„æ ¸æ•°
        for i in range(5):
            p.apply_async(long_time_task, args=(i,))
        print('Waiting for all subprocesses done...')
        p.close()
        p.join()
        print('All subprocesses done.')


def process_comunicate():
    """è¿›ç¨‹é€šä¿¡"""
    from multiprocessing import Process, Queue
    import os, time, random

    # å†™æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :
    def write(q):
        print('Process to write: %s' % os.getpid())
        for value in ['A', 'B', 'C']:
            print('Put %s to queue...' % value)
            q.put(value)
            time.sleep(random.random())

    # è¯»æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :
    def read(q):
        print('Process to read: %s' % os.getpid())
        while True:
            value = q.get(True)
            print('Get %s from queue.' % value)

    # çˆ¶è¿›ç¨‹åˆ›å»ºQueueï¼Œå¹¶ä¼ ç»™å„ä¸ªå­è¿›ç¨‹ï¼š
    q = Queue()
    pw = Process(target=write, args=(q,))
    pr = Process(target=read, args=(q,))
    # å¯åŠ¨å­è¿›ç¨‹pwï¼Œå†™å…¥:
    pw.start()
    # å¯åŠ¨å­è¿›ç¨‹prï¼Œè¯»å–:
    pr.start()
    # ç­‰å¾…pwç»“æŸ:
    pw.join()
    # prè¿›ç¨‹é‡Œæ˜¯æ­»å¾ªç¯ï¼Œæ— æ³•ç­‰å¾…å…¶ç»“æŸï¼Œåªèƒ½å¼ºè¡Œç»ˆæ­¢:
    pr.terminate()


def muti_thread():
    """
    lock = threading.Lock() åˆ›å»ºé”
    lock.acquire() è·å–é”
    lock.release() é‡Šæ”¾é”, ä¸€èˆ¬åœ¨ finallyä¸­
    å¤šæ ¸ä»»åŠ¡åªèƒ½ç”¨è¿›ç¨‹, 
    å› ä¸º:Pythonçš„çº¿ç¨‹è™½ç„¶æ˜¯çœŸæ­£çš„çº¿ç¨‹ï¼Œä½†è§£é‡Šå™¨æ‰§è¡Œä»£ç æ—¶ï¼Œæœ‰ä¸€ä¸ªGILé”ï¼šGlobal Interpreter Lockï¼Œ
    ä»»ä½•Pythonçº¿ç¨‹æ‰§è¡Œå‰ï¼Œå¿…é¡»å…ˆè·å¾—GILé”ï¼Œç„¶åï¼Œæ¯æ‰§è¡Œ100æ¡å­—èŠ‚ç ï¼Œè§£é‡Šå™¨å°±è‡ªåŠ¨é‡Šæ”¾GILé”ï¼Œè®©
    åˆ«çš„çº¿ç¨‹æœ‰æœºä¼šæ‰§è¡Œã€‚è¿™ä¸ªGILå…¨å±€é”å®é™…ä¸ŠæŠŠæ‰€æœ‰çº¿ç¨‹çš„æ‰§è¡Œä»£ç éƒ½ç»™ä¸Šäº†é”ï¼Œæ‰€ä»¥ï¼Œå¤šçº¿ç¨‹åœ¨Python
    ä¸­åªèƒ½äº¤æ›¿æ‰§è¡Œï¼Œå³ä½¿100ä¸ªçº¿ç¨‹è·‘åœ¨100æ ¸CPUä¸Šï¼Œä¹Ÿåªèƒ½ç”¨åˆ°1ä¸ªæ ¸
    """

    import time, threading

    def loop():
        print('thread %s is running...' % threading.current_thread().name)
        n = 0
        while n < 5:
            n = n + 1
            print('thread %s >>> %s' % (threading.current_thread().name, n))
            time.sleep(1)
        print('thread %s ended.' % threading.current_thread().name)

    print('thread %s is running...' % threading.current_thread().name)
    # ä¸»çº¿ç¨‹å®ä¾‹çš„åå­—å«MainThreadï¼Œå­çº¿ç¨‹çš„åå­—åœ¨åˆ›å»ºæ—¶æŒ‡å®šï¼Œæˆ‘ä»¬ç”¨LoopThreadå‘½åå­çº¿ç¨‹
    t = threading.Thread(target=loop, name='LoopThread')
    t.start()
    t.join()
    print('thread %s ended.' % threading.current_thread().name)



```


# 5. å¼‚æ­¥

```py

def async_io():
    """
    åç¨‹åŸç†:
    åœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­, ä¸»çº¿ç¨‹ä¸æ–­è½®è¯¢å¤„ç†é˜Ÿåˆ—ä¸­çš„äº‹ä»¶, 
    å½“é‡åˆ°IOæ“ä½œæ—¶ï¼Œä»£ç åªè´Ÿè´£å‘å‡ºIOè¯·æ±‚ï¼Œä¸ç­‰å¾…IOç»“æœï¼Œç„¶åç›´æ¥ç»“æŸæœ¬è½®æ¶ˆæ¯å¤„ç†ï¼Œè¿›å…¥ä¸‹ä¸€è½®æ¶ˆæ¯å¤„ç†è¿‡ç¨‹
    å½“io å®Œæˆ, ä¼šäº§ç”Ÿé€šçŸ¥è¿›å…¥é˜Ÿåˆ—, åˆ«çº¿ç¨‹å¤„ç†
    æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯åç¨‹æé«˜çš„æ‰§è¡Œæ•ˆç‡ã€‚å› ä¸ºå­ç¨‹åºåˆ‡æ¢ä¸æ˜¯çº¿ç¨‹åˆ‡æ¢
    ç¬¬äºŒå¤§ä¼˜åŠ¿å°±æ˜¯ä¸éœ€è¦å¤šçº¿ç¨‹çš„é”æœºåˆ¶ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿä¸å­˜åœ¨åŒæ—¶å†™å˜é‡å†²çªï¼Œåœ¨åç¨‹ä¸­æ§åˆ¶å…±äº«èµ„æºä¸åŠ é”ï¼Œåªéœ€è¦åˆ¤æ–­çŠ¶æ€å°±å¥½äº†
    å› ä¸ºåç¨‹æ˜¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œé‚£æ€ä¹ˆåˆ©ç”¨å¤šæ ¸CPUå‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹æ³•æ˜¯å¤šè¿›ç¨‹+åç¨‹ï¼Œæ—¢å……åˆ†åˆ©ç”¨å¤šæ ¸ï¼Œåˆå……åˆ†å‘æŒ¥åç¨‹çš„é«˜æ•ˆç‡
    """
    def consumer():
        r = ''
        while True:
            n = yield r # consumeré€šè¿‡yieldæ‹¿åˆ°æ¶ˆæ¯ï¼Œå¤„ç†ï¼Œåˆé€šè¿‡yieldæŠŠç»“æœä¼ å›
            if not n:
                return
            print('[CONSUMER] Consuming %s...' % n)
            r = '200 OK'

    def produce(c):
        c.send(None) # å¯åŠ¨ç”Ÿæˆå™¨
        n = 0
        while n < 5:
            n = n + 1
            print('[PRODUCER] Producing %s...' % n)
            # ä¸€æ—¦ç”Ÿäº§äº†ä¸œè¥¿ï¼Œé€šè¿‡c.send(n)åˆ‡æ¢åˆ°consumeræ‰§è¡Œ
            r = c.send(n)
            print('[PRODUCER] Consumer return: %s' % r)
        # é€šè¿‡c.close()å…³é—­consumerï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸ
        c.close()

    c = consumer()
    produce(c)


    # 
    #
    # å¼‚æ­¥æ“ä½œéœ€è¦åœ¨coroutineä¸­é€šè¿‡yield fromå®Œæˆï¼›
    # 
    # å¤šä¸ªcoroutineå¯ä»¥å°è£…æˆä¸€ç»„Taskç„¶åå¹¶å‘æ‰§è¡Œã€‚
    #
    import asyncio # asyncioæ˜¯Python 3.4ç‰ˆæœ¬å¼•å…¥çš„æ ‡å‡†åº“ï¼Œç›´æ¥å†…ç½®äº†å¯¹å¼‚æ­¥IOçš„æ”¯æŒã€‚
    # https://github.com/dabeaz/curio æ›¿ä»£è€…

    @asyncio.coroutine # æŠŠä¸€ä¸ªgeneratoræ ‡è®°ä¸ºcoroutineç±»å‹
                        # ç„¶ååœ¨coroutineå†…éƒ¨ç”¨yield fromè°ƒç”¨å¦ä¸€ä¸ªcoroutineå®ç°å¼‚æ­¥æ“ä½œ
    def hello():
        print("Hello world!")
        # å¼‚æ­¥è°ƒç”¨asyncio.sleep(1), è™½ç„¶ç¡çœ 1s, ä½†æ˜¯ä¸»çº¿ç¨‹å¹¶æœªç­‰å¾…ï¼Œè€Œæ˜¯å»æ‰§è¡ŒEventLoopä¸­å…¶ä»–å¯ä»¥æ‰§è¡Œçš„coroutineäº†
        # asyncio.sleep()ä¹Ÿæ˜¯ä¸€ä¸ªcoroutine
        r = yield from asyncio.sleep(1)
        print("Hello again!")

    # è·å–EventLoop:
    loop = asyncio.get_event_loop()
    # æ‰§è¡Œcoroutine
    loop.run_until_complete(hello())

    # å°è£…ä¸¤ä¸ªcoroutine
    # ä¸¤ä¸ªcoroutineæ˜¯ç”±åŒä¸€ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„
    tasks = [hello(), hello()]
    loop.run_until_complete(asyncio.wait(tasks))

    loop.close()

    #asyncå’Œawaitæ˜¯é’ˆå¯¹coroutineçš„æ–°è¯­æ³•
    #
    #æŠŠ@asyncio.coroutineæ›¿æ¢ä¸ºasyncï¼›
    #æŠŠyield fromæ›¿æ¢ä¸ºawaitã€‚
    #
    async def hello1():
        print("Hello world!")
        r = await asyncio.sleep(1)
        print("Hello again!")

    # asyncioå¯ä»¥å®ç°å•çº¿ç¨‹å¹¶å‘IOæ“ä½œã€‚å¦‚æœä»…ç”¨åœ¨å®¢æˆ·ç«¯ï¼Œå‘æŒ¥çš„å¨åŠ›ä¸å¤§ã€‚
    # å¦‚æœæŠŠasyncioç”¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œä¾‹å¦‚WebæœåŠ¡å™¨ï¼Œç”±äºHTTPè¿æ¥å°±æ˜¯IOæ“ä½œï¼Œå› æ­¤å¯ä»¥ç”¨å•çº¿ç¨‹+coroutineå®ç°å¤šç”¨æˆ·çš„é«˜å¹¶å‘æ”¯æŒ
    # aiohttpåˆ™æ˜¯åŸºäºasyncioå®ç°çš„HTTPæ¡†æ¶
    #
    # ç¼–å†™ä¸€ä¸ªHTTPæœåŠ¡å™¨:
    #
    # import asyncio

    # from aiohttp import web

    # async def index(request):
    #     await asyncio.sleep(0.5)
    #     return web.Response(body=b'<h1>Index</h1>')

    # async def hello(request):
    #     await asyncio.sleep(0.5)
    #     text = '<h1>hello, %s!</h1>' % request.match_info['name']
    #     return web.Response(body=text.encode('utf-8'))

    # async def init(loop):
    #     app = web.Application(loop=loop)
    #     app.router.add_route('GET', '/', index)
    #     app.router.add_route('GET', '/hello/{name}', hello)
    #     srv = await loop.create_server(app.make_handler(), '127.0.0.1', 8000)
    #     print('Server started at http://127.0.0.1:8000...')
    #     return srv

    # loop = asyncio.get_event_loop()
    # loop.run_until_complete(init(loop))
    # loop.run_forever()

```


# 6. å†…å»ºæ¨¡å—

## 6.1. æ—¥æœŸå¤„ç†

```py
def builtin_module():
    from datetime import datetime, timedelta

    now = datetime.now()
    print(now) # 2019-06-05 23:06:46.171270

    time = datetime(2019, 4, 19, 1, 30)
    print(time) # 2019-04-19 01:30:00

    timestamp = time.timestamp()
    print(timestamp)  # 1555608600.0
    print(datetime.fromtimestamp(timestamp))  # 2019-04-19 01:30:00

    cday = datetime.strptime('2015-6-1 18:19:59', '%Y-%m-%d %H:%M:%S')
    print(cday)  # 2015-06-01 18:19:59

    strftime = now.strftime('%Y-%m-%d %H:%M:%S')
    print(strftime)  # 2019-06-05 23:06:46

    result = now + timedelta(days=1, hours=1)
    print(result)  # 2019-06-07 00:11:36.912231

```

## 6.2. é›†åˆ


```py
# å‘½åçš„ tuple 
from collections import namedtuple
    # namedtupleæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨æ¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„tupleå¯¹è±¡ï¼Œå¹¶ä¸”è§„å®šäº†tupleå…ƒç´ çš„ä¸ªæ•°ï¼Œå¹¶å¯ä»¥ç”¨å±æ€§è€Œä¸æ˜¯ç´¢å¼•æ¥å¼•ç”¨tupleçš„æŸä¸ªå…ƒç´ 
    Point = namedtuple('Point', ['x', 'y'])  # ç›¸å½“äºtype(), æ„é€ äº†ä¸€ä¸ªç±»
    p = Point(1, 2)
    print(p.x) # 1
    print(p.y) # 2




from collections import  deque

    # dequeæ˜¯ä¸ºäº†é«˜æ•ˆå®ç°æ’å…¥å’Œåˆ é™¤æ“ä½œçš„åŒå‘åˆ—è¡¨
    #  æ˜¯ä¸ºäº†å¼¥è¡¥ list  æ’å…¥å’Œåˆ é™¤æ•ˆç‡å¾ˆä½ çš„ç¼ºç‚¹
    q = deque(['a', 'b', 'c'])
    q.append('d')
    q.appendleft('e')
    print(q)  # deque(['e', 'a', 'b', 'c', 'd'])





from collections import defaultdict
    # ä½¿ç”¨dictæ—¶ï¼Œå¦‚æœå¼•ç”¨çš„Keyä¸å­˜åœ¨ï¼Œå°±ä¼šæŠ›å‡ºKeyErrorã€‚å¦‚æœå¸Œæœ›keyä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå°±å¯ä»¥ç”¨defaultdict
    # å¦‚æœè¦ä¿æŒKeyçš„é¡ºåºï¼Œå¯ä»¥ç”¨OrderedDict
    # ChainMapå¯ä»¥æŠŠä¸€ç»„dictä¸²èµ·æ¥å¹¶ç»„æˆä¸€ä¸ªé€»è¾‘ä¸Šçš„dict

    ################

    from  collections import  Counter

    # Counteræ˜¯ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨
    c = Counter()
    for ch in 'programming':
        c[ch] = c[ch] + 1

    print(c)  # Counter({'r': 2, 'g': 2, 'm': 2, 'p': 1, 'o': 1, 'a': 1, 'i': 1, 'n': 1})

```



# 7. ç¼–å†™å‘½ä»¤è¡Œç¨‹åº

https://www.jianshu.com/p/005ecf9cf8aa TODO

## 7.1. å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨

https://www.cnblogs.com/lgh344902118/p/8521437.html

 TODO



# 8. ç±»å‹ç³»ç»Ÿ type-hint

https://www.zhihu.com/question/265003581/answer/461562594
https://zhuanlan.zhihu.com/p/56863684

https://github.com/python/mypy

https://github.com/google/pytype

https://docs.python.org/zh-cn/3/library/typing.html

å¾®è½¯äº7æœˆ1æ—¥å‘å¸ƒä¸€æ¬¾æ–°çš„VS Codeæ’ä»¶ï¼Œåä¸º Pylance


```py
# è‡ªpython3.5å¼€å§‹ï¼ŒPEP484ä¸ºpythonå¼•å…¥äº†ç±»å‹æ³¨è§£(type hints)
    # typingæ¨¡å—
    #
    # https://www.cnblogs.com/linkenpark/p/11676297.html
    # int,long,float: æ•´å‹,é•¿æ•´å½¢,æµ®ç‚¹å‹
    # bool,str: å¸ƒå°”å‹ï¼Œå­—ç¬¦ä¸²ç±»å‹
    # List, Tuple, Dict, Set:åˆ—è¡¨ï¼Œå…ƒç»„ï¼Œå­—å…¸, é›†åˆ
    # Iterable,Iterator:å¯è¿­ä»£ç±»å‹ï¼Œè¿­ä»£å™¨ç±»å‹
    # Generatorï¼šç”Ÿæˆå™¨ç±»å‹
    #
    # ":" åé¢æ˜¯å‚æ•°ç±»å‹
    # "->" æ˜¯è¿”å›å€¼çš„æ³¨é‡Šï¼Œ-> str æ„æ€å³æ˜¯æé†’å‡½æ•°ä½¿ç”¨è€…è¿”å›å€¼ä¼šæ˜¯ä¸€ä¸ªstrå‹
    def f(ham: "ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²", eggs: str = 'eggs') -> str :
        print("Annotations:", f.__annotations__)
        print("Arguments:", ham, eggs)
        return ham + ' and ' + eggs

    print(f("est", 123))
```


# 9. è°ƒè¯•

## 9.1. æ–­è¨€

ç±»ä¼¼ print, 

ç¨‹åºä¸­å¦‚æœåˆ°å¤„å……æ–¥ç€assertï¼Œå’Œprint()ç›¸æ¯”ä¹Ÿå¥½ä¸åˆ°å“ªå»ã€‚ä¸è¿‡ï¼Œå¯åŠ¨Pythonè§£é‡Šå™¨æ—¶å¯ä»¥ç”¨-Oå‚æ•°æ¥å…³é—­assert: `python -O err.py`, å…³é—­åï¼Œå¯ä»¥æŠŠæ‰€æœ‰çš„assertè¯­å¥å½“æˆpassæ¥çœ‹

```python
def foo(s):
    n = int(s)
    # åªèƒ½æ–­è¨€ true or false
    # å¦‚æœæ–­è¨€å¤±è´¥ï¼Œassertè¯­å¥æœ¬èº«å°±ä¼šæŠ›å‡ºAssertionError
    assert n != 0, 'n is zero!'
    return 10 / n

def main():
    foo('0')

# è¿è¡Œæ—¶ï¼Œå…³é—­assert
$ python3 -O err.py
Traceback (most recent call last):
  ...
ZeroDivisionError: division by zero
```

## 9.2. è®¾ç½®æ–­ç‚¹ pdb

å¯åŠ¨Pythonçš„è°ƒè¯•å™¨pdb `python -m pdb err.py`, è¾“å…¥å‘½ä»¤læ¥æŸ¥çœ‹ä»£ç , è¾“å…¥å‘½ä»¤nå¯ä»¥å•æ­¥æ‰§è¡Œä»£ç , ä½•æ—¶å€™éƒ½å¯ä»¥è¾“å…¥å‘½ä»¤p å˜é‡åæ¥æŸ¥çœ‹å˜é‡, è¾“å…¥å‘½ä»¤qç»“æŸè°ƒè¯•ï¼Œé€€å‡ºç¨‹åº

pdb.set_trace() è®¾ç½®æ–­ç‚¹

```python
# err.py
import pdb

s = '0'
n = int(s)
pdb.set_trace() # è¿è¡Œåˆ°è¿™é‡Œä¼šè‡ªåŠ¨æš‚åœ
print(10 / n)

$ python3 err.py
> /Users/michael/Github/learn-python3/samples/debug/err.py(7)<module>()
-> print(10 / n)# æ­¤æ—¶è¿›å…¥è°ƒè¯•æ¨¡å¼
(Pdb) p n # pæŸ¥çœ‹å˜é‡
0
(Pdb) c # c ç»§ç»­è¿è¡Œ
Traceback (most recent call last):
  File "err.py", line 7, in <module>
    print(10 / n)
ZeroDivisionError: division by zero

```



# 10. jinja2 æ¨¡æ¿

æ¸²æŸ“ä½¿ç”¨ï¼š

```py
# FileSystemLoaderï¼šæ–‡ä»¶ç³»ç»ŸåŠ è½½å™¨
# ä¸éœ€è¦æ¨¡æ¿æ–‡ä»¶å­˜åœ¨æŸä¸ªPythonåŒ…ä¸‹ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç³»ç»Ÿä¸­çš„æ–‡ä»¶

# PackageLoaderï¼šåŒ…åŠ è½½å™¨
from jinja2 import PackageLoader,Environment
# ä¸¤ä¸ªå‚æ•°ä¸ºï¼špythonåŒ…çš„åç§°ï¼Œä»¥åŠæ¨¡æ¿ç›®å½•åç§°
env = Environment(loader=PackageLoader('python_project','templates'))    # åˆ›å»ºä¸€ä¸ªåŒ…åŠ è½½å™¨å¯¹è±¡
template = env.get_template('bast.html')    # è·å–ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶
template.render(name='daxin',age=18)   # æ¸²æŸ“


```

æ¨¡æ¿è¯­æ³•ï¼š

```py
# ä¸‰ç§è¯­æ³•
# æ§åˆ¶ç»“æ„ {% %}
# å˜é‡å–å€¼{{}}
# æ³¨é‡Š {# #}

# å¾ªç¯
# è¿­ä»£åˆ—è¡¨
<ul>
{% for user in users %}
<li>{{ user.username|title }}</li>
{% endfor %}
</ul>
# è¿­ä»£å­—å…¸
<dl>
{% for key, value in my_dict.iteritems() %}
<dt>{{ key }}</dt>
<dd>{{ value}}</dd>
{% endfor %}
</dl>

# è¿‡æ»¤å™¨ å°±æ˜¯å†…ç½®å‡½æ•°
# safe: æ¸²æŸ“æ—¶å€¼ä¸è½¬ä¹‰
# capitialize: æŠŠå€¼çš„é¦–å­—æ¯è½¬æ¢æˆå¤§å†™ï¼Œå…¶ä»–å­æ¯è½¬æ¢ä¸ºå°å†™
# lower: æŠŠå€¼è½¬æ¢æˆå°å†™å½¢å¼
# upper: æŠŠå€¼è½¬æ¢æˆå¤§å†™å½¢å¼
# title: æŠŠå€¼ä¸­æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æ¢æˆå¤§å†™
# trim: æŠŠå€¼çš„é¦–å°¾ç©ºæ ¼å»æ‰
# striptags: æ¸²æŸ“ä¹‹å‰æŠŠå€¼ä¸­æ‰€æœ‰çš„HTMLæ ‡ç­¾éƒ½åˆ æ‰
# join: æ‹¼æ¥å¤šä¸ªå€¼ä¸ºå­—ç¬¦ä¸²
# replace: æ›¿æ¢å­—ç¬¦ä¸²çš„å€¼
# round: é»˜è®¤å¯¹æ•°å­—è¿›è¡Œå››èˆäº”å…¥ï¼Œä¹Ÿå¯ä»¥ç”¨å‚æ•°è¿›è¡Œæ§åˆ¶
# int: æŠŠå€¼è½¬æ¢æˆæ•´å‹

{{ 'abc' | captialize  }}
# Abc

{{ 'abc' | upper  }}
# ABC

{{ 'hello world' | title  }}
# Hello World

{{ "hello world" | replace('world','daxin') | upper }}
# HELLO DAXIN

{{ 18.18 | round | int }}
# 18


# å®ç±»ä¼¼äºPythonä¸­çš„å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨å®ä¸­å®šä¹‰è¡Œä¸ºï¼Œè¿˜å¯ä»¥è¿›è¡Œä¼ é€’å‚æ•°ï¼Œå°±åƒPythonä¸­çš„å‡½æ•°
# å®šä¹‰
{% macro input(name,age=18) %}   # å‚æ•°ageçš„é»˜è®¤å€¼ä¸º18
 <input type='text' name="{{ name }}" value="{{ age }}" >
{% endmacro %}
# è°ƒç”¨
<p>{{ input('daxin') }} </p>
<p>{{ input('daxin',age=20) }} </p>

# ç»§æ‰¿å’Œsuperå‡½æ•°
# æ¨¡æ¿ç»§æ‰¿ã€‚æ¨¡æ¿ç»§æ‰¿å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŸºæœ¬(éª¨æ¶)æ–‡ä»¶ï¼Œå…¶ä»–æ–‡ä»¶ä»è¯¥éª¨æ¶æ–‡ä»¶ç»§æ‰¿ï¼Œç„¶åé’ˆå¯¹è‡ªå·±éœ€è¦çš„åœ°æ–¹è¿›è¡Œä¿®æ”¹

# éª¨æ¶
# å®šä¹‰äº†å››å¤„ blockï¼Œå³ï¼šheadï¼Œtitleï¼Œcontentï¼Œfooter
<!DOCTYPE html>
<html lang="en">
<head>
    {% block head %}
    <link rel="stylesheet" href="style.css"/>
    <title>{% block title %}{% endblock %} - My Webpage</title>
    {% endblock %}
</head>
<body>
<div id="content">{% block content %}{% endblock %}</div>
<div id="footer">
    {% block  footer %}
    <script>This is javascript code </script>
    {% endblock %}
</div>
</body>
</html>

# æ–°å»ºæ–‡ä»¶ç»§æ‰¿
{% extend "base.html" %}       # ç»§æ‰¿base.htmlæ–‡ä»¶

{% block title %} Dachenzi {% endblock %}   # å®šåˆ¶titleéƒ¨åˆ†çš„å†…å®¹

{% block head %}
    {{  super()  }}        # ç”¨äºè·å–åŸæœ‰çš„ä¿¡æ¯
    <style type='text/css'>
    .important { color: #FFFFFF }
    </style>
{% endblock %}

# å…¶ä»–ä¸ä¿®æ”¹çš„åŸå°ä¸åŠ¨çš„ç»§æ‰¿

```

# 11. è·¯å¾„é—®é¢˜

## 11.1. æ–‡ä»¶è·¯å¾„ and ç»ˆç«¯è·¯å¾„

éœ€è¦ç”¨å‘½ä»¤è¡Œæ“ä½œçš„æ—¶å€™ï¼Œä¹Ÿå°±æœ‰å‚æ•° argvçš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦æ±‚ç»ˆç«¯è·¯å¾„å’ŒPythonæ–‡ä»¶è·¯å¾„ä¸€è‡´ã€‚å‘½ä»¤è¡Œè¿è¡Œç¨‹åºçš„æ ¼å¼æ˜¯ï¼špython+Pythonæ–‡ä»¶å+å‚æ•°

## 11.2. è·å–è„šæœ¬ä½ç½®

```py
if __name__ == '__main__':
    import sys
    import os

    # ä¸é€‚ç”¨äº å‘½ä»¤è¡Œç¨‹åº,
    print(sys.argv)    # ['D:/repo/repo_github/shared_already/rest-api-generator/test_jinja.py']
    # è·å¾—çš„æ˜¯å½“å‰æ‰§è¡Œè„šæœ¬çš„ä½ç½®
    # è‹¥åœ¨å‘½ä»¤è¡Œ, æ‰“å°çš„æ˜¯ 'py xxx'å‘½ä»¤ä¸­çš„ xxx
    print(sys.argv[0])    # D:/repo/repo_github/shared_already/rest-api-generator/test_jinja.py

    # python æŸ¥æ‰¾åº“çš„è·¯å¾„, ç¬¬ä¸€ä¸ªæ˜¯å½“å‰é¡¹ç›®è·¯å¾„
    print(sys.path)
    print(sys.path[0])  # D:\repo\repo_github\shared_already\rest-api-generator

    # åˆ¤æ–­ä¸ºè„šæœ¬æ–‡ä»¶è¿˜æ˜¯py2exeç¼–è¯‘åçš„æ–‡ä»¶ï¼Œå¦‚æœæ˜¯è„šæœ¬æ–‡ä»¶ï¼Œ
    # åˆ™è¿”å›çš„æ˜¯è„šæœ¬çš„ç›®å½•ï¼Œå¦‚æœæ˜¯py2exeç¼–è¯‘åçš„æ–‡ä»¶ï¼Œåˆ™è¿”å›çš„æ˜¯ç¼–è¯‘åçš„æ–‡ä»¶è·¯å¾„
    cur_path = sys.path[0]
    if os.path.isdir(cur_path):
        print('current project dir: [{}]'.format(cur_path))
    elif os.path.isfile(cur_path):
        dirname = os.path.dirname(cur_path)
        print('current project dir: [{}]'.format(dirname))

    # å½“å‰å·¥ä½œç›®å½•
    # è‹¥è¦æ”¹å˜å½“å‰å·¥ä½œè·¯å¾„ï¼Œå¯ä»¥ç”¨ï¼šos.chdir(path)
    print(os.getcwd())
    print(os.path.abspath(os.curdir))
    print(os.curdir)  # ç›¸å¯¹è·¯å¾„
    print(os.path.abspath('.'))
    # çˆ¶ç›®å½•
    print(os.path.abspath('..'))


```

# 12. shutil ä½¿ç”¨

TODO

```py
# é€’å½’åˆ é™¤ç›®å½•

import shutil  
shutil.rmtree('è¦æ¸…ç©ºçš„æ–‡ä»¶å¤¹å')  # å…ˆåˆ é™¤
os.mkdir('è¦æ¸…ç©ºçš„æ–‡ä»¶å¤¹å')  # å†é‡å»º

import os
for root, dirs, files in os.walk(top, topdown=False):
    for name in files:
        os.remove(os.path.join(root, name))
    for name in dirs:
        os.rmdir(os.path.join(root, name))

# ç§»åŠ¨æ–‡ä»¶å¤¹
shutil.move('åŸæ–‡ä»¶å¤¹/åŸæ–‡ä»¶å','ç›®æ ‡æ–‡ä»¶å¤¹/ç›®æ ‡æ–‡ä»¶å') 

```

# 13. venv è™šæ‹Ÿç¯å¢ƒ

æ¨è venv (virtualenv è¿‡æ—¶äº†):

```sh
python -m venv venv_dir  # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒvenv_dirï¼Œ ä¼šè‡ªåŠ¨ç”Ÿæˆvenv_diræ–‡ä»¶å¤¹

# æ¿€æ´»
# æ¿€æ´»ç¯å¢ƒåæ‰€æœ‰çš„æ“ä½œéƒ½åœ¨è¯¥è™šæ‹Ÿç¯å¢ƒä¸­è¿›è¡Œï¼Œä¸ä¼šåˆ°å…¨å±€çš„pythonç¯å¢ƒå’Œå…¶å®ƒpythonè™šæ‹Ÿç¯å¢ƒ
$ cd venv_dir/
$ source ./bin/activate

# éªŒè¯æ˜¯å¦æ¿€æ´»
echo $VIRTUAL_ENV

# é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
deactivate

# åˆ é™¤ç¯å¢ƒ
rm -rf venv_dir


# ä½¿ç”¨anacondaçš„conda
$ conda create -n env_name python=version package_names(é»˜è®¤åœ¨æ­¤ç¯å¢ƒä¸­å®‰è£…çš„pythonåŒ…)
# ä¾‹
$ conda create --name django_venv python=3.8 django

$ conda env list # æŸ¥çœ‹æ‰€æœ‰condaåˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒ

$ conda activate env_name
# ä¾‹
$ conda activate django_venv

$ conda deactivate  # ç›´æ¥æ‰§è¡Œconda deactivateå³å¯é€€å‡ºå½“å‰è™šæ‹Ÿç¯å¢ƒ

$ conda remove -n ven_name --all

```


ä½¿ç”¨ pycharm: https://blog.csdn.net/pfm685757/article/details/108590680

inherit global site-packages:å‹¾é€‰ä¸Šçš„è¯ä»£è¡¨åˆ›å»ºçš„æ–°é¡¹ç›®éœ€è¦copyä¸€ä»½å…¨å±€åŒ…åˆ°è™šæ‹Ÿç¯å¢ƒã€‚

Make available to all projects:å‹¾é€‰ä¸Šï¼Œè¡¨ç¤ºï¼Œå½“åœ¨è™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…åŒ…çš„æ—¶å€™ï¼Œcopyä¸€ä»½åˆ°å…¨å±€ã€‚


```sh
 pip3 install virtualenv
# è™šæ‹Ÿç¯å¢ƒ
# --no-site-packagesï¼Œå·²ç»å®‰è£…åˆ°ç³»ç»ŸPythonç¯å¢ƒä¸­çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹åŒ…éƒ½ä¸ä¼šå¤åˆ¶è¿‡æ¥ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªä¸å¸¦ä»»ä½•ç¬¬ä¸‰æ–¹åŒ…çš„â€œå¹²å‡€â€çš„Pythonè¿è¡Œç¯å¢ƒã€‚
#               æ›´æ–° , ç‰ˆæœ¬ >=20 å, é»˜è®¤å°±åŠ ä¸Šäº†è¿™ä¸ªé€‰é¡¹, ä¸å¿…æ‰‹åŠ¨æŒ‡å®š
# -p æŒ‡å®šè§£é‡Šå™¨
virtualenv -p python3.6 venv  
# ä½¿ç”¨é»˜è®¤è§£é‡Šå™¨
virtualenv  venv
# æœ‰äº†venvè¿™ä¸ªPythonç¯å¢ƒï¼Œå¯ä»¥ç”¨sourceè¿›å…¥è¯¥ç¯å¢ƒ
source ./venv/bin/activate
# é€€å‡º venv
deactivate

#å¯¹å½“å‰å·²ç»åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒæ›´æ”¹ä¸ºå¯è¿ç§», ç”Ÿæˆå‹ç¼©åŒ…è§£å‹åç›´æ¥ä½¿ç”¨
virtualenv --relocatable ./

# å®‰è£…åº“ä¾èµ– åˆ° venv
pip install -r requirements.txt
# ç”Ÿæˆä¾èµ–æ–‡ä»¶
pip freeze > requirements.txt 
# å½“å‰å®‰è£…ç‰ˆæœ¬
pip freeze





# virtualenvwrapper,æ˜¯å¯¹ virtualenv çš„ä¸€ä¸ªå°è£…ï¼Œç›®çš„æ˜¯ä½¿åè€…æ›´å¥½ç”¨ã€‚


# venv , Python ä»3.3 ç‰ˆæœ¬å¼€å§‹ï¼Œè‡ªå¸¦äº†ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒ venv
# ä»…ä»…æ”¯æŒ python 3.3 å’Œä»¥åç‰ˆæœ¬ã€‚æ‰€ä»¥ï¼Œè¦åœ¨ python2 ä¸Šä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œä¾ç„¶è¦åˆ©ç”¨ virtualenv 
python3 -m venv <venv_name> # ä¸€èˆ¬å‘½åä¸º .venv

.venv\Scripts\activate.bat
# or
source .venv/bin/activate



```

ä½¿ç”¨ pycharm çš„ venv

è®¾ç½® interpretor, æ¨è venv è™šæ‹Ÿç¯å¢ƒ

"inherit global site packages" å‹¾é€‰è¡¨ç¤º project å†…æ‰¾ä¸åˆ°éœ€è¦çš„åº“, å°±æ‰©å¤§èŒƒå›´, åˆ°å…¨å±€ base interpretor çš„åº“å»æ‰¾, ä½†æ˜¯å®‰è£…çš„åº“ä¼šä½¿ç”¨ å…¨å±€ pip å®‰è£…, ä¼šå®‰è£…åˆ° base interpretor ä¸­, æ±¡æŸ“å…¨å±€. å»ºè®®ä¸è¦å‹¾é€‰

æ­¤æ—¶ä¼šåœ¨ project root ä¸‹ç”Ÿæˆ venv



# 14. web å¼€å‘

https://www.zhihu.com/question/20706333/answer/24927602 æœ‰å“ªäº›æ¡†æ¶
https://www.zhihu.com/question/41564604/answer/660256963 å¯¹æ¯”

- Flask: å°è€Œç¾, é€‚åˆå°ç«™ç‚¹, å¼€å‘webæœåŠ¡çš„API, å’Œ nosqlé…åˆè‰¯å¥½

- Django: å¤§è€Œå…¨, è‡ªå¸¦ template, orm, é€‚åˆå¼€å‘ä¼ä¸šçº§ç½‘ç«™, é€‚åˆ sql, æ— æ³•é…åˆnosqlæ•°æ®åº“

- Torando: åŸç”Ÿå¼‚æ­¥éé˜»å¡ï¼Œåœ¨IOå¯†é›†å‹åº”ç”¨å’Œå¤šä»»åŠ¡å¤„ç†ä¸Šå æ®ç»å¯¹æ€§çš„ä¼˜åŠ¿ï¼Œå±äºä¸“æ³¨å‹æ¡†æ¶

    websockets é•¿è¿æ¥;

    å†…åµŒäº†HTTPæœåŠ¡å™¨


## litestar

https://github.com/litestar-org/litestar  å’Œ fastapi ç±»ä¼¼çš„å®šä½å’ŒåŠŸèƒ½ï¼Œä½†æä¾›æ›´å¤šçš„æ—¥å¸¸å¼€å‘ç»„ä»¶ï¼Œæ›´å¥åº·çš„ç¤¾åŒºè´¡çŒ®æ„æˆï¼Œé•¿æœŸçœ‹å¥½


## 14.1. fastapi


å¼€å‘ rest api éå¸¸æ–¹ä¾¿ https://juejin.cn/post/6844904051327369224

https://github.com/nsidnev/fastapi-realworld-example-app

## 14.2. Django

```sh
# å‡çº§ pip åˆ° v21
python -m pip install --upgrade pip

pip install Django

# åˆ›å»ºæ¨¡æ¿ä»£ç 
# æœ«å°¾ . è¡¨ç¤ºå½“å‰ç›®å½•, å¯é€‰
# django_demo ä¸ºé¡¹ç›®å, ä¸€èˆ¬å’Œå½“å‰æ–‡ä»¶å¤¹åä¿æŒä¸€è‡´
django-admin startproject django_demo .

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
python manage.py runserver [[0:]8080]

# åˆ›å»º demo app: polls çš„æ¨¡æ¿ä»£ç 
python manage.py startapp polls

# æ£€æŸ¥ INSTALLED_APPS è®¾ç½®ï¼Œä¸ºå…¶ä¸­çš„æ¯ä¸ªåº”ç”¨åˆ›å»ºéœ€è¦çš„æ•°æ®è¡¨/æ›´æ–°è¡¨ç»“æ„
python manage.py migrate

# ä¸ºæŒ‡å®š app åˆ›å»º è¿ç§»æ–‡ä»¶(æ¨¡å‹æ•°æ®, ç”¨äºç”Ÿæˆ SQL), polls æ˜¯è‡ªå®šä¹‰ app name
python manage.py makemigrations polls

#  æŸ¥çœ‹ SQL
python manage.py sqlmigrate polls 0001


# é€šè¿‡æ¨¡å‹ api æ“ä½œæ•°æ®åº“
python manage.py shell
```


## 14.3. flask


https://github.com/humiaozuzu/awesome-flask

https://github.com/yangyuexiong/Flask_BestPractices ä¸­æ–‡

### 14.3.1. flaskè§£å†³è·¨åŸŸé—®é¢˜

https://blog.csdn.net/h18208975507/article/details/102551339

### 14.3.2. ä¿æŠ¤ flask api

https://blog.miguelgrinberg.com/post/restful-authentication-with-flask
https://geekflare.com/securing-flask-api-with-jwt/


### 14.3.3. å‘½ä»¤è¡Œor idea å¯åŠ¨


```sh
export FLASK_APP=hello.py

# optional, enable debug mode
export FLASK_ENV=development

# default port -> 5000
flask run [--host=0.0.0.0]


```

é€šè¿‡  idea å¯åŠ¨, é»˜è®¤æ˜¯åŸºäº flask æ¡†æ¶å¯åŠ¨ (å³å³é”®è¿è¡Œé»˜è®¤æ˜¯Flaskæ‰§è¡Œé¡¹ç›®), ä¸ä¼šèµ° main æ–¹æ³•

è‹¥å¸Œæœ›èµ° main æ–¹æ³•, éœ€è¦æ‰‹åŠ¨é…ç½® å¯åŠ¨ configuration

### 14.3.4. rest api

https://www.jianshu.com/p/a25357f2d930 jsonify ç›¸æ¯”ç›´æ¥è¿”å› dict/json.dump({}) çš„å¥½å¤„


è§£æè¯·æ±‚å‚æ•°
```python
def request_parse(req_data):
	'''è§£æè¯·æ±‚æ•°æ®å¹¶ä»¥jsonå½¢å¼è¿”å›'''
    if req_data.method == 'POST':
        data = req_data.json
    elif req_data.method == 'GET':
        data = req_data.args
    return data
   
@app.route('/', methods = ["GET","POST"])   # GET å’Œ POST éƒ½å¯ä»¥
def get_data():
	data = request_parse(request)
	# å‡è®¾æœ‰å¦‚ä¸‹ URL
    # http://10.8.54.48:5000/index?name=john&age=20
    name = data.get("name")
    age = data.get("age")

```


https://blog.csdn.net/pineapple_C/article/details/113339718 æ‹¦æˆªå™¨

### 14.3.5. æ•°æ®åº“äº¤äº’



https://www.jianshu.com/p/f7ba338016b8 orm æ¡†æ¶ SQLAlchemy


https://xieyugui.wordpress.com/2015/04/17/sqlalchemy-%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81model%E5%92%8C%E5%8A%A8%E6%80%81%E5%88%9B%E5%BB%BA%E8%A1%A8/ ä½¿ç”¨åŠ¨æ€modelå’ŒåŠ¨æ€åˆ›å»ºè¡¨

```py
# åŸç”Ÿsqlè¯­å¥æ“ä½œ
sql = 'select * from user'
result = db.session.execute(sql)

# æŸ¥è¯¢å…¨éƒ¨
User.query.all()
# ä¸»é”®æŸ¥è¯¢
User.query.get(1)

# æ¡ä»¶æŸ¥è¯¢
User.query.filter_by(username='name').all() # or first()
#                                 ><ï¼ˆå¤§äºå’Œå°äºï¼‰æŸ¥è¯¢    and_å’Œor_æŸ¥è¯¢, in_
# filter_by()	ç›´æ¥ç”¨å±æ€§åï¼Œæ¯”è¾ƒç”¨=	ä¸æ”¯æŒ	ä¸æ”¯æŒ
# filter()	ç”¨ç±»å.å±æ€§åï¼Œæ¯”è¾ƒç”¨==	    æ”¯æŒ	æ”¯æŒ

# å¤šæ¡ä»¶æŸ¥è¯¢
from sqlalchemy import and_
User.query.filter_by(and_(User.username =='name',User.password=='passwd'))
# æ¯”è¾ƒæŸ¥è¯¢
User.query.filter(User.id.__lt__(5)) # å°äº5
User.query.filter(User.id.__le__(5)) # å°äºç­‰äº5
User.query.filter(User.id.__gt__(5)) # å¤§äº5
User.query.filter(User.id.__ge__(5)) # å¤§äºç­‰äº5
# inæŸ¥è¯¢
User.query.filter(User.username.in_('A','B','C','D'))
# æ’åº
User.query.order_by('age') # æŒ‰å¹´é¾„æ’åºï¼Œé»˜è®¤å‡åºï¼Œåœ¨å‰é¢åŠ -å·ä¸ºé™åº'-age'
# é™åˆ¶æŸ¥è¯¢
User.query.filter(age=18).offset(2).limit(3)  # è·³è¿‡äºŒæ¡å¼€å§‹æŸ¥è¯¢ï¼Œé™åˆ¶è¾“å‡º3æ¡

https://blog.csdn.net/qq_41856814/article/details/101226416 åˆ†é¡µæŸ¥è¯¢

# å¢åŠ 
use = User(id,username,password)
db.session.add(use)
db.session.commit() 

# åˆ é™¤
User.query.filter_by(User.username='name').delete()

# ä¿®æ”¹
User.query.filter_by(User.username='name').update({'password':'newdata'})


```


https://github.com/miguelgrinberg/Flask-Migrate Flask-Migrate æ•°æ®è¿ç§», æ ¹æ® model åˆ›å»º table
https://blog.csdn.net/feit2417/article/details/86592319

```sh
# db æ˜¯ä»£ç ä¸­çš„ migration command name

# ç”Ÿæˆ migrations æ–‡ä»¶å¤¹
python3 manage.py db init

python3 manage.py db migrate
python3 manage.py db upgrade
# åç»­å¯¹è„šæœ¬æœ‰ä»»ä½•çš„ä¿®æ”¹ï¼Œåªè¦é‡å¤æ‰§è¡Œåä¸¤å¥å°±å¯ä»¥äº†

# å…¶ä»–æŒ‡ä»¤
manage.py db: error: invalid choice: 'migration' (choose from 'init', 'revision', 'migrate', 'edit', 'merge', 'upgrade', 'downgrade', 'show', 'history', 'heads', 'branches', 'current', 'stamp')


```


https://www.jianshu.com/p/a681f6490c3c Flask-script
https://zhuanlan.zhihu.com/p/269820011



https://stackoverflow.com/questions/17972020/how-to-execute-raw-sql-in-flask-sqlalchemy-app?rq=1 æ‰§è¡ŒåŸç”Ÿ SQL



### 14.3.6. flask ä¸­çš„æ—¥å¿—

https://www.jianshu.com/p/daf5c9e57c65

```py
app.logger.info('')
# æ‰“å°å †æ ˆ
app.logger.exception('')
app.logger.debug('A value for debugging')
app.logger.warning('A warning occurred (%d apples)', 42)
app.logger.error('An error occurred')

```


æ—¥å¿—åˆ‡åˆ†:

- æŒ‰ç…§å¤§å°


```py
from logging.handlers import RotatingFileHandler 
# backupCount å°±æ˜¯ä¿ç•™çš„æ—¥å¿—ä¸ªæ•°ã€‚ æ¯”å¦‚flask.log å†™æ»¡äº†ï¼Œ å°±ä¼šè¢«é‡å‘½åæˆflask.log.1, ç¨‹åºç»§ç»­å‘flask.logå†™å…¥ã€‚
handler = RotatingFileHandler("flask.log", maxBytes=1024000, backupCount=10)
```



- æŒ‰ç…§æ—¥æœŸ


```py
from logging.handlers import TimedRotatingFileHandler
handler = TimedRotatingFileHandler(
        "flask.log", when="D", # when=Dï¼š è¡¨ç¤ºæŒ‰å¤©è¿›è¡Œåˆ‡åˆ†
        interval=1,  # æ¯å¤©éƒ½åˆ‡åˆ†ã€‚ æ¯”å¦‚interval=2å°±è¡¨ç¤ºä¸¤å¤©åˆ‡åˆ†ä¸€ä¸‹
         backupCount=15 , # ä¿ç•™15å¤©çš„æ—¥å¿—
        encoding="UTF-8", # ä½¿ç”¨UTC+0çš„æ—¶é—´æ¥è®°å½• ï¼ˆä¸€èˆ¬dockeré•œåƒé»˜è®¤ä¹Ÿæ˜¯UTC+0)
        delay=False, utc=True)
```


`# [%(asctime)s][%(filename)s:%(lineno)d][%(levelname)s][%(thread)d] - %(message)s` æ ¼å¼é…ç½®

```py

if __name__ == '__main__':
    formatter = logging.Formatter(
        "[%(asctime)s][%(filename)s:%(lineno)d][%(levelname)s][%(thread)d] - %(message)s")
        # (%(hostname)s)[%(asctime)s][%(filename)s:%(lineno)d][%(levelname)s][%(thread)d] - %(message)s å¢åŠ äº† hostname
    handler = TimedRotatingFileHandler(
        "flask.log", when="D", interval=1, backupCount=15,
        encoding="UTF-8", delay=False, utc=True)
    handler.setFormatter(formatter)
    app.logger.addHandler(handler)
    app.run(host='0.0.0.0', port=5001, debug=True)



# ä¹Ÿå¯é€šè¿‡ è‡ªå®šä¹‰ log filter å®šåˆ¶ æ—¥å¿—
# é¦–å…ˆè‡ªå®šä¹‰ä¸€ä¸ªLogFilter
class ContextFilter(logging.Filter):
    '''Enhances log messages with contextual information'''
    def filter(self, record):
        record.hostname = "my-windows-10"
        return True

# åœ¨mainå‡½æ•°ä¹‹ä¸­ï¼Œ å¢åŠ åŠ è½½è¿™ä¸ªfilterå³å¯
handler.addFilter(ContextFilter())

```



SMTPHandlerè·ŸHTTPHandler å‘é€é‚®ä»¶ æˆ–è€… http


```py

if __name__ == '__main__':
    app.debug = True

    # File and Console handler &amp; formtter
    formatter = logging.Formatter(
        "[%(asctime)s][%(module)s:%(lineno)d][%(levelname)s][%(thread)d] - %(message)s")
    handler = TimedRotatingFileHandler(
        "flask.log", when="D", interval=1, backupCount=15,
        encoding="UTF-8", delay=False, utc=True)
    app.logger.addHandler(handler)
    handler.setFormatter(formatter)

    # Email Handler
    mail_handler = SMTPHandler(
        mailhost='10.64.1.85',
        fromaddr='flask-admin@trendmicro.com',
        toaddrs=['wenjun_yang@trendmicro.com'],
        subject='Flask Application Error'
    )
    mail_handler.setLevel(logging.ERROR)
    mail_handler.setFormatter(logging.Formatter(
        "[%(asctime)s][%(module)s:%(lineno)d][%(levelname)s][%(thread)d] - %(message)s"
    ))
    app.logger.addHandler(mail_handler)

    app.run()
```

### 14.3.7. blueprintè“å›¾ æ¨¡å—åŒ–å¼€å‘

https://realpython.com/flask-blueprint/

### 14.3.8. ä¸Šä¸‹æ–‡å¯¹è±¡

https://sentry.io/answers/working-outside-of-application-context/ current_app ä½¿ç”¨ (`RuntimeError: working outside of application context`æŠ¥é”™)

https://github.com/tiangolo/fastapi/issues/81 ä½¿ç”¨ app ä¸Šä¸‹æ–‡å­˜å‚¨æ•°æ®


æ¯æ¬¡ è¯·æ±‚éƒ½æ˜¯æ–°çš„(è•¾è¥¿ java çš„ threadlocal), app æ˜¯çœŸä¸ªåº”ç”¨å…¨å±€ç”Ÿå‘½å‘¨æœŸçš„

https://zhuanlan.zhihu.com/p/26097310
https://www.zhihu.com/question/33970027



# 15. db é©±åŠ¨ é—®é¢˜

mac æ— æ³•å®‰è£… postgres é©±åŠ¨

é©±åŠ¨åœ¨è¿™: https://pypi.org/project/psycopg2/, éœ€è¦é¦–å…ˆå®‰è£… postgres  `brew install postgres`, è®¾ç½® path, ç„¶åå®‰è£… ([å‚è€ƒ](https://www.psycopg.org/docs/install.html#install-from-source))

å¦‚æœè¿˜æ˜¯ä¸è¡Œ `pip install psycopg2-binary==2.8.3` ([å‚è€ƒ](https://stackoverflow.com/questions/34304833/failed-building-wheel-for-psycopg2-macosx-using-virtualenv-and-pip))


# 16. ä»£æ›¿ shell è¿ç»´

https://www.oschina.net/translate/python-scripts-replacement-bash-utility-scripts
https://blog.51cto.com/dashui/2334754
https://www.cnblogs.com/jacktian-it/articles/10222930.html

https://github.com/lalor/python_for_linux_system_administration ä¹¦ç±


## 16.1. å®ç”¨è„šæœ¬

https://zhuanlan.zhihu.com/p/85728888
TODO

### 16.1.1. å‘½ä»¤è¡Œå‚æ•°è§£æ

```py
# $# å–å‚æ•°æ•°é‡
len(sys.argv)

# $0 å–ç¬¬0ä¸ªå‚æ•°
sys.argv[0]



```

### 16.1.2. è·¯å¾„

```py
# è·å–è„šæœ¬æ‰€åœ¨è·¯å¾„
import os
script_dir = os.path.split(os.path.realpath(__file__))[0]
os.chdir(script_dir)

# å±•å¼€ç”¨æˆ·è·¯å¾„ï¼Œæ–¹ä¾¿è·¨å¹³å°
print(os.path.expanduser('~/.config'))


# åŒ¹é…æ–‡ä»¶å
import glob
for name in glob.glob('dir/*'):
    print (name)
```

### 16.1.3. æ–‡ä»¶æ“ä½œ

æ¨è shutil æ¨¡å—, ä»£æ›¿å¾ˆå¤šshellçš„æ–‡ä»¶æ“ä½œå‘½ä»¤ï¼Œå¯ä»¥é¿å…ç‰¹æ®Šæƒ…å†µå­—ç¬¦è½¬ä¹‰å¸¦æ¥çš„å›°æ‰°

```py
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
os.path.exists(file)

# rm -rf
os.system("rm -rf foo/")
shutil.rmtree("foo", ignore_errors=True)

# æ‰“å¼€æ–‡ä»¶è¯»å‡ºæ¯è¡Œå†…å®¹
with open("./xxx.log") as file_obj:
    xxx_list = file_obj.read().splitlines()

# åˆ—å‡ºç›®å½•ä¸‹æ–‡ä»¶
os.listdir()
['pkgsync', 'hosts', 'pkglist-aur.json', 'apply-pkgsync.sh', 'pkglist.json', 'rootfs', 'private', '.vscode', '.git', 'home', 'stow_all.sh', '.gitignore', 'local_rootfs', 'rime', 'i3', '.gitmodules', 'README.md']

# è‡ªé¡¶å‘ä¸‹ï¼Œéå†æ–‡ä»¶å¤¹ï¼Œpathæ˜¯è·¯å¾„ï¼Œdir_listæ˜¯ç›®å½•åˆ—è¡¨ï¼Œfile_listæ˜¯æ–‡ä»¶åˆ—è¡¨
g = os.walk(script_dir)
for path,dir_list,file_list in g:
    for dir in dir_list:
        print(os.path.join(path, file_name))        
```

### 16.1.4. sh å‘½ä»¤æ‰§è¡Œ

```py
# systemå‘½ä»¤åŒæ­¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿”å›å€¼ä¸ºç¨‹åºé€€å‡ºç 
if os.system("echo abc") != 0:
    print("error: execute")
    exit(1)

# subprocessæ‰§è¡Œå‘½ä»¤
import subprocess
res = subprocess.Popen('uptime', shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, close_fds=True)
result = res.stdout.readlines()

# check_call()ä¾‹å­ï¼Œç¼–è¯‘æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œå½“shellæ¥ç”¨ï¼Œcheck_call()ä¼šåœ¨æ‰§è¡Œè¿”å›é”™è¯¯æ—¶æŠ›å‡ºé”™è¯¯
for test in tests:
    os.chdir(os.path.join(script_dir, test))
    output = subprocess.check_call(f"make", shell=True)
    output = subprocess.check_call(f"./test_case", shell=True)

# éœ€è¦è·å–æ‰“å°å‡ºçš„æ•°æ®æ—¶ï¼Œè¿˜å¯ä»¥ç”¨check_output()ï¼Œæ¯”å¦‚è¿™é‡Œè·å–æ–‡ä»¶åˆ—è¡¨
res = subprocess.check_output('find . -maxdepth 2 -name rootfs', shell=True).decode()
rootfs_dirs = res.strip().split('\n')

# todo: ä½¿ç”¨ç¬¬ä¸‰æ–¹shæ¨¡å— http://amoffat.github.io/sh/
```

## 16.2. ä¼ é€’å‘½ä»¤è¡Œå‚æ•°

é€šè¿‡ sys.stdin, sys.stdout

å‚æ•°å¤„ç†åº“: optparse.OptionParser, argparse, click

```py
if __name__ == "__main__":
    # åˆå§‹åŒ–ä¸€ä¸ªnamesçš„å­—å…¸ï¼Œå†…å®¹ä¸ºç©º
    # å­—å…¸ä¸­ä¸ºnameå’Œå‡ºç°æ•°é‡çš„é”®å€¼å¯¹
    names = {}
    # sys.stdinæ˜¯ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ã€‚ æ‰€æœ‰å¼•ç”¨äºfileå¯¹è±¡çš„æ–¹æ³•ï¼Œ
    # éƒ½å¯ä»¥åº”ç”¨äºsys.stdin.
    for name in sys.stdin.readlines():
            # æ¯ä¸€è¡Œéƒ½æœ‰ä¸€ä¸ªnewlineå­—ç¬¦åšç»“å°¾
            # æˆ‘ä»¬éœ€è¦åˆ é™¤å®ƒ
            name = name.strip()
            if name in names:
                    names[name] += 1
            else:
                    names[name] = 1

    # è¿­ä»£å­—å…¸,
    # è¾“å‡ºåå­—ï¼Œç©ºæ ¼ï¼Œæ¥ç€æ˜¯è¯¥åå­—å‡ºç°çš„æ•°é‡
    for name, count in names.iteritems():
            sys.stdout.write("%d\t%s\n" % (count, name))

```

`cat names.log | python namescount.py | sort -rn`

## 16.3. shell è°ƒç”¨ Python 

### 16.3.1. shel è¯»å– Python å‡½æ•°è¿”å›å€¼

```py


```

```sh


```

### 16.3.2. ç»Ÿè®¡å‡ºç°æ¬¡æ•°

```py
#!/usr/bin/env python
import sys

if __name__ == "__main__":
    # åˆå§‹åŒ–ä¸€ä¸ªnamesçš„å­—å…¸ï¼Œå†…å®¹ä¸ºç©º
    # å­—å…¸ä¸­ä¸ºnameå’Œå‡ºç°æ•°é‡çš„é”®å€¼å¯¹
    names = {}
    for name in sys.stdin.readlines():
            # æ¯ä¸€è¡Œéƒ½æœ‰ä¸€ä¸ªnewlineå­—ç¬¦åšç»“å°¾
            # æˆ‘ä»¬éœ€è¦åˆ é™¤å®ƒ
            name = name.strip()
            if name in names:
                    names[name] += 1
            else:
                    names[name] = 1

    # è¿­ä»£å­—å…¸,
    # è¾“å‡ºåå­—ï¼Œç©ºæ ¼ï¼Œæ¥ç€æ˜¯è¯¥åå­—å‡ºç°çš„æ•°é‡
    for name, count in names.iteritems():
            sys.stdout.write("%d\t%s\n" % (count, name))
```

`cat names.log | ./xxx.py`


### 16.3.3. è¯»å– csv æ–‡ä»¶

è·å–æŒ‡å®šåˆ—

`cat xxx.csv | ./xxx.py 2`

```py
#!/usr/bin/env python
# CSV module that comes with the Python standard library
import csv
import sys


if __name__ == "__main__":
    # CSVæ¨¡å—ä½¿ç”¨ä¸€ä¸ªreaderå¯¹è±¡ä½œä¸ºè¾“å…¥
    # åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯ sys.stdin.
    csvfile = csv.reader(sys.stdin)

    # è¿™ä¸ªè„šæœ¬å¿…é¡»æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼ŒæŒ‡å®šåˆ—çš„åºå·
    # ä½¿ç”¨sys.argvè·å–å‚æ•°.
    column_number = 0
    if len(sys.argv) > 1:
            column_number = int(sys.argv[1])

    # CSVæ–‡ä»¶çš„æ¯ä¸€è¡Œéƒ½æ˜¯ç”¨é€—å·ä½œä¸ºå­—æ®µçš„åˆ†éš”ç¬¦
    for row in csvfile:
            print row[column_number]

```


## 16.4. Python è°ƒç”¨ shell


### 16.4.1. subprocess 

æ¨è

python 3.0 ä¹‹åä½¿ç”¨ subprocessä»£æ›¿ commands (commands ä»…ä»…é€‚ç”¨äº Linux, python 3.0 ä¹‹åç§»é™¤æ­¤å‘½ä»¤ï¼Œä½¿ç”¨ subprocess ä»£æ›¿)

python 3.x ä½¿ç”¨ subprocess åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹, å…è®¸åˆ›å»ºå¾ˆå¤šå­è¿›ç¨‹ï¼Œåˆ›å»ºçš„æ—¶å€™èƒ½æŒ‡å®šå­è¿›ç¨‹å’Œå­è¿›ç¨‹çš„è¾“å…¥ã€è¾“å‡ºã€é”™è¯¯è¾“å‡ºç®¡é“ï¼Œæ‰§è¡Œåèƒ½è·å–è¾“å‡ºç»“æœå’Œæ‰§è¡ŒçŠ¶æ€ã€‚

```py
#!/usr/bin/python3


subprocess.run()	Python 3.5ä¸­æ–°å¢çš„å‡½æ•°ã€‚æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œç­‰å¾…å‘½ä»¤æ‰§è¡Œå®Œæˆåè¿”å›ä¸€ä¸ªåŒ…å«æ‰§è¡Œç»“æœçš„CompletedProcessç±»çš„å®ä¾‹ã€‚
subprocess.call()	æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œè¿”å›å‘½ä»¤æ‰§è¡ŒçŠ¶æ€ï¼Œå…¶åŠŸèƒ½ç±»ä¼¼äºos.system(cmd)ã€‚
subprocess.check_call()	Python 2.5ä¸­æ–°å¢çš„å‡½æ•°ã€‚ æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸåˆ™è¿”å›çŠ¶æ€ç ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚å…¶åŠŸèƒ½ç­‰ä»·äºsubprocess.run(..., check=True)ã€‚
subprocess.check_output()	Python 2.7ä¸­æ–°å¢çš„çš„å‡½æ•°ã€‚æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œå¦‚æœæ‰§è¡ŒçŠ¶æ€ç ä¸º0åˆ™è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚
subprocess.getoutput(cmd)	æ¥æ”¶å­—ç¬¦ä¸²æ ¼å¼çš„å‘½ä»¤ï¼Œæ‰§è¡Œå‘½ä»¤å¹¶è¿”å›æ‰§è¡Œç»“æœï¼Œå…¶åŠŸèƒ½ç±»ä¼¼äºos.popen(cmd).read()å’Œcommands.getoutput(cmd)ã€‚
subprocess.getstatusoutput(cmd)	æ‰§è¡Œcmdå‘½ä»¤ï¼Œè¿”å›ä¸€ä¸ªå…ƒç»„(å‘½ä»¤æ‰§è¡ŒçŠ¶æ€, å‘½ä»¤æ‰§è¡Œç»“æœè¾“å‡º)ï¼Œå…¶åŠŸèƒ½ç±»ä¼¼äºcommands.getstatusoutput()ã€‚




import subprocess as sp


# subprocess.run()ï¼špython3.5ä¸­æ–°å¢çš„å‡½æ•°ï¼Œ æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œ ç­‰å¾…å‘½ä»¤æ‰§è¡Œå®Œæˆåè¿”å›ä¸€ä¸ªåŒ…å«æ‰§è¡Œç»“æœçš„CompletedProcessç±»çš„å®ä¾‹
# Popen çš„ç®€åŒ–ç‰ˆæœ¬
#æ‰§è¡Œls -l /dev/null å‘½ä»¤
>>> subprocess.run(["ls", "-l", "/dev/null"])
# crw-rw-rw-  1 root  wheel    3,   2  5  4 13:34 /dev/null
# CompletedProcess(args=['ls', '-l', '/dev/null'], returncode=0)


# æ‰§è¡Œ shell å‘½ä»¤, æ‰“å°è¾“å‡ºåˆ° stdout, ç±»ä¼¼ os.system
# shell=Trueæ„æ€æ˜¯shellä¸‹æ‰§è¡Œcommand, å¦‚æœcommandä¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œshell=Trueæ˜¯ä¸å¯çœç•¥çš„ã€‚
code = sp.call("ls -al", shell=True)
# <=> sp.call(["ls", "-al"])
print(code) # 0

# å¼‚æ­¥æ‰§è¡Œ, æ‰“å°åˆ° stdout
# 0ï¼Œ1ï¼Œ2ã€‚å…¶ä¸­0ä»£è¡¨æ­£ç¡®æ‰§è¡Œï¼Œ1å’Œ2éƒ½æ˜¯é”™è¯¯æ‰§è¡Œï¼Œ2é€šå¸¸æ˜¯æ²¡æœ‰è¯»å–åˆ°æ–‡ä»¶
result = sp.Popen("ls -al", shell=True) # å¼‚æ­¥æ‰§è¡Œ
print(result.returncode) # None è¿™æ­¥ä¸ä¼šé˜»å¡
print(result.wait()) # 0 é˜»å¡

# è·å–è¾“å‡º
# è®¾ç½®è¾“å‡ºåˆ°ç®¡é“
proc = sp.Popen("ls -al", stdout=sp.PIPE, shell=True)
print(proc.stdout.readline())

proc1 = sp.Popen("ls -al", stdout=sp.PIPE, shell=True)
(stdout, stderr) = proc1.communicate("..")
print(stdout)


# ##############




```

### 16.4.2. os.system


```py

# è¿™ä¸ªè°ƒç”¨ç›¸å½“ç›´æ¥ï¼Œä¸”æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œç¨‹åºéœ€è¦é˜»å¡å¹¶ç­‰å¾…è¿”å› ( os.system() è¿™ä¸ªæ–¹æ³•æ˜¯é˜»å¡å½“å‰ä¸»è¿›ç¨‹æ‰§è¡Œçš„ï¼Œåªæœ‰è¯¥å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œä¸»è¿›ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œ)


#!/usr/bin/python3

import os

# output to stdout
# 0è¡¨ç¤ºshellæŒ‡ä»¤æˆåŠŸæ‰§è¡Œï¼Œ256è¡¨ç¤ºæœªæ‰¾åˆ°ï¼Œè¯¥æ–¹æ³•é€‚ç”¨äºshellå‘½ä»¤ä¸éœ€è¦è¾“å‡ºå†…å®¹çš„åœºæ™¯ã€‚
#       æ²¡æœ‰æ‰¾åˆ°æ—¶ï¼Œsh å‘½ä»¤è¿”å›çš„çŠ¶æ€ç æ˜¯1ï¼Œè€Œpythonè°ƒç”¨ï¼Œè¿”å›çš„æ˜¯ï¼š256 , è¿™æ˜¯ä¸€ç‚¹åŒºåˆ«
status = os.system("ls -al")
print(status) # 0 

os.system('ping -c 2 www.baidu.com &>/dev/null')
print("block until ping finished")

ret = os.system('cat hello.sh | grep "ooo"')
print(ret) # 256, 
ret1 = os.system('cat hello.sh | grep "c 1"')
print(ret1) # 0



# æ‰§è¡Œ shell è„šæœ¬
os.system("./hello.sh")

# æ”¹å˜å½“å‰å·¥ä½œç›®å½•åˆ°æŒ‡å®šçš„è·¯å¾„
# <=> cd ..
access = os.chdir("..") # å¦‚æœå…è®¸è®¿é—®è¿”å› True , å¦åˆ™è¿”å›False

# æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•
retval = os.getcwd()

# æƒé™
# ä¸å¦‚ç›´æ¥ os.system("chmod ...")
# import stat
# os.chmod("./hello.sh", stat.S_IRWXU)

# æ›´æ”¹æ‰€å±ç”¨æˆ·, éœ€è¦ root æƒé™æ‰§è¡Œ
# os.chown()

# æ›´æ”¹å½“å‰è¿›ç¨‹çš„æ ¹ç›®å½•ä¸ºæŒ‡å®šçš„ç›®å½•ï¼Œä½¿ç”¨è¯¥å‡½æ•°éœ€è¦ç®¡ç†å‘˜æƒé™
# os.chroot()

```

### 16.4.3. os.popen


```py
# å¼‚æ­¥æ‰§è¡Œå‘½ä»¤, 
# æ‹¿åˆ°å‘½ä»¤æ‰§è¡Œè¾“å‡º
#  os.popen() è¿”å›çš„æ˜¯ file read çš„å¯¹è±¡ï¼Œå¯¹å…¶è¿›è¡Œè¯»å– read() çš„æ“ä½œå¯ä»¥çœ‹åˆ°æ‰§è¡Œçš„è¾“å‡ºã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åå°æ‰§è¡Œï¼Œä¸å½±å“åç»­è„šæœ¬è¿è¡Œ
output = os.popen("ping -c1 www.baidu.com &>/dev/null")
print("popen -- nonblock")
# readlines() ä¹Ÿå¯
print(output.read()) # è·å–ç»ˆç«¯è¾“å‡º
print("popen -- block until output.read() end")

# popenéœ€è¦å…³é—­close().å½“æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œclose()ä¸è¿”å›ä»»ä½•å€¼ï¼Œå¤±è´¥æ—¶ï¼Œclose()è¿”å›ç³»ç»Ÿè¿”å›å€¼
output.close()

```

### 16.4.4. system

```py
def cd(dir): system.command('cd {}'.format(dir))

```



### 16.4.5. sh

```py
# ä½¿ç”¨ sh åŒ…
```

### 16.4.6. paramiko

https://github.com/paramiko/paramiko
https://www.cnblogs.com/xiao-apple36/p/9144092.html

https://www.yisu.com/zixun/12641.html
https://www.cnblogs.com/liangyy09/p/13921693.html

pip3 install paramiko


```py
# paramikoåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šSSHClientå’ŒSFTPClientã€‚

å¸¸ç”¨å‚æ•°
hostname è¿æ¥çš„ç›®æ ‡ä¸»æœº
port=SSH_PORT æŒ‡å®šç«¯å£
username=None éªŒè¯çš„ç”¨æˆ·å
password=None éªŒè¯çš„ç”¨æˆ·å¯†ç 
pkey=None ç§é’¥æ–¹å¼ç”¨äºèº«ä»½éªŒè¯
key_filename=None ä¸€ä¸ªæ–‡ä»¶åæˆ–æ–‡ä»¶åˆ—è¡¨ï¼ŒæŒ‡å®šç§é’¥æ–‡ä»¶
timeout=None å¯é€‰çš„tcpè¿æ¥è¶…æ—¶æ—¶é—´
allow_agent=True, æ˜¯å¦å…è®¸è¿æ¥åˆ°sshä»£ç†ï¼Œé»˜è®¤ä¸ºTrue å…è®¸
look_for_keys=True æ˜¯å¦åœ¨~/.sshä¸­æœç´¢ç§é’¥æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºTrue å…è®¸
compress=False, æ˜¯å¦æ‰“å¼€å‹ç¼©


set_missing_host_key_policy()ï¼šè®¾ç½®è¿œç¨‹æœåŠ¡å™¨æ²¡æœ‰åœ¨know_hostsæ–‡ä»¶ä¸­è®°å½•æ—¶ (è¿æ¥çš„è¿œç¨‹ä¸»æœºæ²¡æœ‰æœ¬åœ°ä¸»æœºå¯†é’¥æˆ–HostKeyså¯¹è±¡) çš„åº”å¯¹ç­–ç•¥ã€‚ç›®å‰æ”¯æŒä¸‰ç§ç­–ç•¥ï¼š

    AutoAddPolicy è‡ªåŠ¨æ·»åŠ ä¸»æœºååŠä¸»æœºå¯†é’¥åˆ°æœ¬åœ°HostKeyså¯¹è±¡ï¼Œä¸ä¾èµ–load_system_host_keyçš„é…ç½®ã€‚å³æ–°å»ºç«‹sshè¿æ¥æ—¶ä¸éœ€è¦å†è¾“å…¥yesæˆ–noè¿›è¡Œç¡®è®¤
    WarningPolicy ç”¨äºè®°å½•ä¸€ä¸ªæœªçŸ¥çš„ä¸»æœºå¯†é’¥çš„pythonè­¦å‘Šã€‚å¹¶æ¥å—ï¼ŒåŠŸèƒ½ä¸Šå’ŒAutoAddPolicyç±»ä¼¼ï¼Œä½†æ˜¯ä¼šæç¤ºæ˜¯æ–°è¿æ¥
    RejectPolicy è‡ªåŠ¨æ‹’ç»æœªçŸ¥çš„ä¸»æœºåå’Œå¯†é’¥ï¼Œä¾èµ–load_system_host_keyçš„é…ç½®ã€‚æ­¤ä¸ºé»˜è®¤é€‰é¡¹

exec_command()ï¼šåœ¨è¿œç¨‹æœåŠ¡å™¨æ‰§è¡ŒLinuxå‘½ä»¤çš„æ–¹æ³•ã€‚

# 
# 
# 
# 
# 


# åˆ©ç”¨SSHClientå¯¹è±¡çš„open_sftp()æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªåŸºäºå½“å‰è¿æ¥çš„sftpå¯¹è±¡ï¼Œå¯ä»¥è¿›è¡Œæ–‡ä»¶çš„ä¸Šä¼ ç­‰æ“ä½œ
open_sftp()ï¼šåœ¨å½“å‰sshä¼šè¯çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªsftpä¼šè¯ã€‚è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªSFTPClientå¯¹è±¡ã€‚
sftp = client.open_sftp()
sftp.put('test.txt','text.txt')

from_transport(cls,t) åˆ›å»ºä¸€ä¸ªå·²è¿é€šçš„SFTPå®¢æˆ·ç«¯é€šé“
put(localpath, remotepath, callback=None, confirm=True) å°†æœ¬åœ°æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ å‚æ•°confirmï¼šæ˜¯å¦è°ƒç”¨stat()æ–¹æ³•æ£€æŸ¥æ–‡ä»¶çŠ¶æ€ï¼Œè¿”å›ls -lçš„ç»“æœ
get(remotepath, localpath, callback=None) ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°
mkdir() åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºç›®å½•
remove() åœ¨æœåŠ¡å™¨ä¸Šåˆ é™¤ç›®å½•
rename() åœ¨æœåŠ¡å™¨ä¸Šé‡å‘½åç›®å½•
stat() æŸ¥çœ‹æœåŠ¡å™¨æ–‡ä»¶çŠ¶æ€
listdir() åˆ—å‡ºæœåŠ¡å™¨ç›®å½•ä¸‹çš„æ–‡ä»¶

# 
# 
# 
# 

import paramiko
 
   # å®ä¾‹åŒ–SSHClient
   client = paramiko.SSHClient()
 
   # è‡ªåŠ¨æ·»åŠ ç­–ç•¥ï¼Œä¿å­˜æœåŠ¡å™¨çš„ä¸»æœºåå’Œå¯†é’¥ä¿¡æ¯ï¼Œå¦‚æœä¸æ·»åŠ ï¼Œé‚£ä¹ˆä¸å†æœ¬åœ°know_hostsæ–‡ä»¶ä¸­è®°å½•çš„ä¸»æœºå°†æ— æ³•è¿æ¥
   client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
 
   # è¿æ¥SSHæœåŠ¡ç«¯ï¼Œä»¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œè®¤è¯
   client.connect(hostname='192.168.1.105', port=22, username='root', password='123456')
 
   # æ‰“å¼€ä¸€ä¸ªChannelå¹¶æ‰§è¡Œå‘½ä»¤
   stdin, stdout, stderr = client.exec_command('df -h ')  # stdout ä¸ºæ­£ç¡®è¾“å‡ºï¼Œstderrä¸ºé”™è¯¯è¾“å‡ºï¼ŒåŒæ—¶æ˜¯æœ‰1ä¸ªå˜é‡æœ‰å€¼
 
   # æ‰“å°æ‰§è¡Œç»“æœ
   print(stdout.read().decode('utf-8'))
 
   # å…³é—­SSHClient
   client.close()


# ###########################


# é…ç½®ç§äººå¯†é’¥æ–‡ä»¶ä½ç½®
private = paramiko.RSAKey.from_private_key_file('/Users/ch/.ssh/id_rsa')
 
#å®ä¾‹åŒ–SSHClient
client = paramiko.SSHClient()
 
#è‡ªåŠ¨æ·»åŠ ç­–ç•¥ï¼Œä¿å­˜æœåŠ¡å™¨çš„ä¸»æœºåå’Œå¯†é’¥ä¿¡æ¯ï¼Œå¦‚æœä¸æ·»åŠ ï¼Œé‚£ä¹ˆä¸å†æœ¬åœ°know_hostsæ–‡ä»¶ä¸­è®°å½•çš„ä¸»æœºå°†æ— æ³•è¿æ¥
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
 
#è¿æ¥SSHæœåŠ¡ç«¯ï¼Œä»¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œè®¤è¯
client.connect(hostname='10.0.0.1',port=22,username='root',pkey=private)


#############################

# SSHClient å°è£… Transport
# åˆ›å»ºä¸€ä¸ªé€šé“
   transport = paramiko.Transport(('hostname', 22))
   transport.connect(username='root', password='123')
 
   ssh = paramiko.SSHClient()
   ssh._transport = transport
 
   stdin, stdout, stderr = ssh.exec_command('df -h')
   print(stdout.read().decode('utf-8'))
 
   transport.close()

################################################################

# è·å–Transportå®ä¾‹
tran = paramiko.Transport(('10.0.0.3', 22))
 
# è¿æ¥SSHæœåŠ¡ç«¯ï¼Œä½¿ç”¨password
tran.connect(username="root", password='123456')
# æˆ–ä½¿ç”¨
# é…ç½®ç§äººå¯†é’¥æ–‡ä»¶ä½ç½®
private = paramiko.RSAKey.from_private_key_file('/Users/root/.ssh/id_rsa')
# è¿æ¥SSHæœåŠ¡ç«¯ï¼Œä½¿ç”¨pkeyæŒ‡å®šç§é’¥
tran.connect(username="root", pkey=private)
 
# è·å–SFTPå®ä¾‹
sftp = paramiko.SFTPClient.from_transport(tran)
 
# è®¾ç½®ä¸Šä¼ çš„æœ¬åœ°/è¿œç¨‹æ–‡ä»¶è·¯å¾„
localpath = "/Users/root/Downloads/1.txt"
remotepath = "/tmp/1.txt"
 
# æ‰§è¡Œä¸Šä¼ åŠ¨ä½œ
sftp.put(localpath, remotepath)
# æ‰§è¡Œä¸‹è½½åŠ¨ä½œ
sftp.get(remotepath, localpath)
 
tran.close()
```

## 16.5. éƒ¨ç½² springboot

```py
#!/usr/bin/python
# -*- coding:utf-8 -*-
import os,sys,time,commands
from sys import argv
 
times = time.strftime('%Yå¹´%mæœˆ%dæ—¥%H:%M:%S')
_jdkpath_ = 'å¡«å†™ä½ çš„JDKè·¯å¾„'
_processpath_ = 'jaråŒ…åå­—'
_fileDir_ = 'jaråŒ…æ‰€åœ¨è·¯å¾„'
_jarpath_ = _fileDir_ + _processpath_
_logpath_ = _fileDir_ + 'æ—¥å¿—è·¯å¾„'
_gclog_   = _fileDir_ + 'gcæ—¥å¿—è·¯å¾„'
_jarvar_ = '-Xms256m -Xmx640m -Xss256K -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=256m -XX:+UseAdaptiveSizePolicy'
 
def getpid():
    pid = commands.getoutput("ps aux | grep %s | grep -v grep | awk '{print $2}'" % _processpath_)
    return pid
 
def _status_():
    j_pid = getpid()
    if j_pid == '':
        print("%sæ²¡æœ‰è¿è¡Œ" % _processpath_)
    else :
        print("%sè¿›ç¨‹pidå€¼:" % _processpath_ + getpid())
 
def _start_():
    j_pid = getpid()
    if j_pid != '':
        print("%så·²ç»åœ¨è¿è¡Œ..." % _processpath_)
    else :
        print("å¯åŠ¨%s......" % _processpath_)
        time.sleep(4)
        if os.system('%s -jar -XX:+PrintGCDetails -Xloggc:%s %s %s > %s 2>&1 &' % (_jdkpath_,_gclog_,_jarvar_,_jarpath_,_logpath_)) == 0:
            print("å¯åŠ¨%sæˆåŠŸ,è¿›ç¨‹pidå€¼:" % _processpath_ + getpid())
 
def _stop_():
    s_pid = getpid()
    if s_pid == '':
        print("%sæ²¡æœ‰è¿è¡Œ" % _processpath_)
    else :
        print("å…³é—­%s......" % _processpath_)
        os.system('kill -9 ' + s_pid)
	os.system('echo "">%s && echo "">%s' % (_gclog_,_logpath_))
        time.sleep(2)
        if s_pid != '0':
            print("å…³é—­%sæˆåŠŸ" % _processpath_)
        else :
            print("å…³é—­%så¤±è´¥" % _processpath_)
 
def _restart_():
    _stop_()
    time.sleep(2)
    _start_()
 
if argv == "-h" or argv == "--help" or len(argv)==1:
    print "â˜»â˜»â˜»è¯·åˆ«å®³æ€•,è¿™åªæ˜¯ä¸ªç®€å•çš„è„šæœ¬,å¯¹åº”ç”¨å’Œç³»ç»Ÿéƒ½æ˜¯æ— æŸçš„â˜»â˜»â˜»\n%s,æ¸©é¦¨æç¤ºç”¨æ³•:%s {start|stop|restart|status}" % (times,argv[0])
 
elif argv[1] == 'start':
    _start_()
elif argv[1] == 'stop':
    _stop_()
elif argv[1] == 'restart':
    _restart_()
elif argv[1] == 'status':
    _status_()
else: 
    print "â˜»â˜»â˜»è¯·åˆ«å®³æ€•,è¿™åªæ˜¯ä¸ªç®€å•çš„è„šæœ¬,å¯¹åº”ç”¨å’Œç³»ç»Ÿéƒ½æ˜¯æ— æŸçš„â˜»â˜»â˜»\n%s,æ¸©é¦¨æç¤ºç”¨æ³•:%s {start|stop|restart|status}" % (times,argv[0])
```



# 17. å¼€æºåº“

https://www.zhihu.com/question/24590883
TODO

https://pypi.org/


## æ—¥æœŸæ—¶é—´

https://github.com/ariebovenberg/whenever


## çˆ¬è™« crawler

https://github.com/ultrafunkamsterdam/undetected-chromedriver ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„ Selenium WebDriver è¡¥ä¸ï¼Œä¸“é—¨ç”¨äºé˜²æ­¢æµè§ˆå™¨è‡ªåŠ¨åŒ–è¿‡ç¨‹ä¸­ï¼Œè§¦å‘åæœºå™¨äººæœºåˆ¶ã€‚å®ƒèƒ½å¤Ÿéšè—æµè§ˆå™¨ç‰¹å¾ï¼ˆæŒ‡çº¹ï¼‰ï¼Œä½¿ç”¨èµ·æ¥ååˆ†æ–¹ä¾¿ï¼Œå°±åƒä¸€ä¸ª Python çš„ç¬¬ä¸‰æ–¹åº“ä¸€æ ·

## 17.1. å˜å£° è¯­éŸ³åˆæˆ

https://github.com/RVC-Project/Retrieval-based-Voice-Conversion-WebUI

## 17.2. ç³»ç»Ÿè¿ç»´

```
https://github.com/giampaolo/psutil è·å–ç³»ç»Ÿä¿¡æ¯, ç¡¬ç›˜, å†…å­˜ ...
```

## 17.3. å£°éŸ³

https://github.com/CorentinJ/Real-Time-Voice-Cloning å…‹éš†å£°éŸ³

## 17.4. å›¾åƒ

- Matplotlib å¯è§†åŒ–åº“ï¼Œå¯ä»¥ç”¨æ¥ç»˜åˆ¶é«˜è´¨é‡çš„ 2D æŠ˜çº¿å›¾ã€æ•£ç‚¹å›¾ã€æŸ±çŠ¶å›¾ï¼Œæˆ–è€…ç”¨æ¥æ˜¾ç¤ºå›¾åƒ
- pil å›¾åƒå¤„ç†åº“, é€‚ç”¨äº Python2, py3 åˆ™å®‰è£… pillow
- opencv-python `import cv2`
- Removebg æŠ å›¾

## 17.5. æ•°æ®æ¨¡å‹å®šä¹‰

https://github.com/samuelcolvin/pydantic/ ä½¿å¾—å®ä¾‹åŒ–æ•°æ® model å¯¹è±¡æ›´æ–¹ä¾¿

https://blog.csdn.net/codename_cys/article/details/107675748
https://blog.csdn.net/swinfans/article/details/89629641

> valideeråº“ã€marshmallowåº“ã€trafaretåº“ä»¥åŠcerberusåº“ç­‰éƒ½å¯ä»¥å®Œæˆç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç›¸è¾ƒä¹‹ä¸‹ï¼Œpydanticåº“çš„æ‰§è¡Œæ•ˆç‡ä¼šæ›´åŠ ä¼˜ç§€ä¸€äº›


https://www.kevin7.net/post_detail/pydantic-with-flask
https://github.com/bauerji/flask_pydantic æ ¡éªŒè¯·æ±‚å‚æ•°
https://medium.com/swlh/parsing-rest-api-payload-and-query-parameters-with-flask-better-than-marshmallow-aa79c889e3ca


## 17.6. åºåˆ—åŒ–ååºåˆ—åŒ–

pickle

https://github.com/ICRAR/ijson é«˜æ€§èƒ½è§£æ json

## 17.7. åš web å¼€å‘

https://github.com/pydantic/FastUI ç”Ÿæˆ åŸºäº react çš„é¡µé¢

Django å¤§ä¸€ç»Ÿè§£å†³æ–¹æ¡ˆ

flask  rest api

https://github.com/pynecone-io/pynecone çº¯ py å®ç° web

https://streamlit.io/       ä¸ºè„šæœ¬åˆ¶ä½œ ui ç•Œé¢

# è°ƒJava

## jpype

https://github.com/jpype-project/jpype

## 18. jython

ç›¸äº’è°ƒç”¨

https://www.py4j.org/getting_started.html run java lib in py


run py script in java

```xml
<dependency>
            <groupId>org.python</groupId>
            <artifactId>jython</artifactId>
            <version>2.7.2</version>
        </dependency>

```

```java
public class App {

    /**
     * åˆå§‹åŒ–
     */
    static void initInterpreter() {
        Properties props = new Properties();
        props.put("python.home", pyPath() + "py_lib");
        props.put("python.console.encoding", "UTF-8");
        props.put("python.security.respectJavaAccessibility", "false");
        props.put("python.import.site", "false");

        Properties preprops = System.getProperties();
        PythonInterpreter.initialize(preprops, props, new String[0]);

    }

    static String pyPath() {
        return Thread.currentThread().getContextClassLoader().getResource(".").getPath();
    }



    public static void main(String[] args) throws FileNotFoundException {
        initInterpreter();
        final PythonInterpreter interpreter = new PythonInterpreter();

        interpreter.execfile(new FileInputStream(pyPath() + "test.py"));
        final PyFunction addFunc = interpreter.get("add", PyFunction.class);
        int a = 1;
        int b = 2;
        final PyObject result = addFunc.__call__(new PyInteger(a), new PyInteger(b));
        System.out.println(result);


//        interpreter.execfile(new FileInputStream(pyPath() + "face_recog.py"));
//        final PyFunction face_verification = interpreter.get("face_verification", PyFunction.class);
//        final PyObject pyObject = face_verification.__call__();
//        System.out.println(pyObject);
    }
}

```


# 19. è°ƒç”¨ rust 

https://www.v2ex.com/t/757216

https://blog.csdn.net/m0_37696990/article/details/96876692

https://blog.csdn.net/muzico425/article/details/103331676


# 20. cffi ç»‘å®š

https://github.com/yifeikong/curl_cffi ä¾‹å­

# 21. webåº”ç”¨éƒ¨ç½²

https://www.zhihu.com/question/21888077

## 21.1. ç”Ÿæˆä¾èµ–æ¸…å•

```sh
# ç”Ÿæˆä¾èµ–æ–‡ä»¶
# https://blog.csdn.net/guolindonggld/article/details/87786032
pip3 freeze > requirements.txt

pip install -r requirements.txt

```

## 21.2. gunicorn

gunicornæ˜¯ä¸€ä¸ªwsgi http server

ç”¨ celery å’Œ gunicorn æ³¨å†Œæˆå®ˆæŠ¤è¿›ç¨‹æ¥è·‘

ä¸è¿‡åœ¨productionç¯å¢ƒï¼Œèµ·åœå’ŒçŠ¶æ€çš„ç›‘æ§æœ€å¥½ç”¨supervisiorä¹‹ç±»çš„ç›‘æ§å·¥å…·ï¼Œç„¶ååœ¨gunicornçš„å‰ç«¯æ”¾ç½®ä¸€ä¸ªhttp proxy server, è­¬å¦‚nginx

https://www.jianshu.com/p/69e75fc3e08e

flask_app.py

```py
from flask import Flask

app = Flask(__name__)


@app.route('/demo', methods=['GET'])
def demo():
    return "gunicorn and flask demo."
```

gunicorn.conf.py 

```py
# coding:utf-8
import multiprocessing

bind = "0.0.0.0:5000"   #ç»‘å®šçš„ipä¸ç«¯å£
workers = multiprocessing.cpu_count() * 2 + 1    #è¿›ç¨‹æ•°
errorlog = './log/gunicorn.error.log' #å‘ç”Ÿé”™è¯¯æ—¶logçš„è·¯å¾„
accesslog = './log/gunicorn.access.log' #æ­£å¸¸æ—¶çš„logè·¯å¾„
backlog = 512                #ç›‘å¬é˜Ÿåˆ—
proc_name = 'gunicorn_pre_project'   #è¿›ç¨‹å
timeout = 30      # è®¾ç½®è¶…æ—¶æ—¶é—´120sï¼Œé»˜è®¤ä¸º30sã€‚æŒ‰è‡ªå·±çš„éœ€æ±‚è¿›è¡Œè®¾ç½®timeout = 120
worker_class = 'gevent' #ä½¿ç”¨geventæ¨¡å¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨sync æ¨¡å¼ï¼Œé»˜è®¤çš„æ˜¯syncæ¨¡å¼

threads = 3  #æŒ‡å®šæ¯ä¸ªè¿›ç¨‹å¼€å¯çš„çº¿ç¨‹æ•°
loglevel = 'info' #æ—¥å¿—çº§åˆ«ï¼Œè¿™ä¸ªæ—¥å¿—çº§åˆ«æŒ‡çš„æ˜¯é”™è¯¯æ—¥å¿—çš„çº§åˆ«ï¼Œè€Œè®¿é—®æ—¥å¿—çš„çº§åˆ«æ— æ³•è®¾ç½®

#è®¾ç½®gunicornè®¿é—®æ—¥å¿—æ ¼å¼ï¼Œé”™è¯¯æ—¥å¿—æ— æ³•è®¾ç½®
access_log_format = '%(t)s %(p)s %(h)s "%(r)s" %(s)s %(L)s %(b)s %(f)s" "%(a)s"'

```


```sh
# å¯åŠ¨å‘½ä»¤
# 
# flask_app æ¥è‡ªflask_app.py
# app æ¥è‡ª app = Flask(__name__)
# -c æŒ‡å®š é…ç½®æ–‡ä»¶
gunicorn flask_app:app -c gunicorn.conf.py 

# ä¸ä½¿ç”¨é…ç½®æ–‡ä»¶
gunicorn -w 4 -b 0.0.0.0:5000 -D  flask_app:app


# æ‰¾åˆ° çˆ¶è¿›ç¨‹çš„ pid (masterpid)
pstree -ap | grep gunicorn 

# æˆ–è€… æ‰¾åˆ°æ‰€æœ‰è¿›ç¨‹ pid, ç„¶å kill -9 æ‰€æœ‰ç›¸å…³è¿›ç¨‹
pgrep gunicorn

# åœæ­¢
kill -9 <çˆ¶è¿›ç¨‹pid>
# é‡å¯
kill -HUP <parent pid>
```

## 21.3. supervisord ç®¡ç† daemon

supervisord.org

## pm2

æ˜¯ nodejs çš„éƒ¨ç½²ç®¡ç†å·¥å…·, ä½†æ˜¯åªè¦æ˜¯å‘½ä»¤è¡Œç¨‹åº, éƒ½èƒ½ç”¨å®ƒ

# 22. setup.py

# 23. wheel

python å¯ä»¥ç”¨ wheel æ‰“åŒ…æˆ whl, ç„¶åä½¿ç”¨ ssh æ‰§è¡Œ pip install package.whl, ç„¶åé‡å¯ä¸€ä¸‹ python å°±å¥½äº†


# 24. è‡ªåŠ¨æŠ¢è´­è„šæœ¬

å¯¹äºè‡ªåŠ¨æŠ¢è´­æ¥è¯´ï¼Œ
å¯¹äºç½‘é¡µï¼Œselenium å’Œ puppeteer æ¯”è¾ƒé€‚åˆï¼ŒåŸºæœ¬æµç¨‹å°±æ˜¯åŠ è½½ä¸€ä¸ª webdriverï¼Œè®¿é—®ä¸€ä¸ªé“¾æ¥ï¼Œç­‰å¾… javascript åŠ è½½å®Œï¼Œé€‰æ‹©ä¸€ä¸ªå…ƒç´ ï¼Œæ‰§è¡Œæ“ä½œã€‚
