<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-redis-note">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">RedisğŸŒˆ - Xiaoyureed çš„ç½‘ç»œ Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xiaoyureed.github.io/img/logo.webp"><meta data-rh="true" name="twitter:image" content="https://xiaoyureed.github.io/img/logo.webp"><meta data-rh="true" property="og:url" content="https://xiaoyureed.github.io/docs/redis-note"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="keywords" content="xiaoyureed"><meta data-rh="true" name="keywords" content="blog, java, spring, microservice, python, rust, typescript, react, web"><meta data-rh="true" name="keywords" content=" åŠè·¯è½¬è¡Œçš„ç¼–ç¨‹çˆ±å¥½è€…, å†™è¿‡ Python, Rust, ç°åœ¨ä¸»æ”» Java åˆ†å¸ƒå¼ç³»ç»Ÿ"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="RedisğŸŒˆ - Xiaoyureed çš„ç½‘ç»œ Wiki"><meta data-rh="true" name="description" content="reference: redisåŸºç¡€, redisé›†ç¾¤åŸç†åŠæ­å»ºä¸ä½¿ç”¨"><meta data-rh="true" property="og:description" content="reference: redisåŸºç¡€, redisé›†ç¾¤åŸç†åŠæ­å»ºä¸ä½¿ç”¨"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xiaoyureed.github.io/docs/redis-note"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/en/docs/redis-note" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/redis-note" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/redis-note" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5SAMPKXTP9-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Xiaoyureed çš„ç½‘ç»œ Wiki" href="/opensearch.xml">


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f6da56a47f5085d1e0fedae39b8de00a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="xiaoyureed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="xiaoyureed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="xiaoyureed JSON Feed">

<link rel="icon" href="/img/logo.webp">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)">
<meta name="description" content="Xiaoyureed çš„ä¸ªäººåšå®¢"><link rel="stylesheet" href="/assets/css/styles.261d8673.css">
<link rel="preload" href="/assets/js/runtime~main.f9c95488.js" as="script">
<link rel="preload" href="/assets/js/main.2a982140.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><a href="/docs/rust-note" target="_blank">Rust æŒ‡åŒ—, æ¬¢è¿æŸ¥çœ‹...</a></div><button type="button" aria-label="å…³é—­" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="ä¸»å¯¼èˆª" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">èœå•</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/archive">åšå®¢</a></li><li><a class="dropdown__link" href="/docs/intro">æ•™ç¨‹</a></li><li><a class="dropdown__link" href="/resource">å¯¼èˆª</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"><b></b></a><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/SpringBoot-note">Spring Boot å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/autohotkey">Autohotkey è„šæœ¬</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/blockchain">blockchainåŒºå—é“¾</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/c-sharp-and-dot-net">C# &amp; .NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/chatgpt">Chatgpt Usage Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cpp">CPP and C å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cross-gfw">Cross The GFW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cs-note">Computer Science Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/css-pre-processor">å‡ ç§CSSé¢„å¤„ç†å™¨æ¯”è¾ƒé€‰å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/data-structure-and-algorithm">Data Structure and Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/design-pattern-note">Design Pattern ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-resources">å¼€å‘è€…èµ„æº</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/distributed-system">Distributed System åˆ†å¸ƒå¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/docker-note-virtual-dev-env">Docker Note &amp; Other Virtual Develop Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/effective-java-reading-note">Effective Java é˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/elk-elastic-log">Distributed log collectionåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/english-note">è‹±è¯­å­¦ä¹ ğŸ”¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/extjs-note">Extjs ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/git-note">Git å¤‡å¿˜ ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/golang-note">Golang ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/gps-gis-tracing">åŸºäºåœ°ç†ä½ç½®å¼€å‘æŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/gradle">Gradle note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/greasy-monkey">æ²¹çŒ´æ’ä»¶&amp;ç¼–å†™è„šæœ¬ğŸ’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/groovy-note">groovy note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/health">Health å…³çˆ±ç¨‹åºå‘˜å¥åº·ğŸ¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/how-to-test-java-app">How to Test Java App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/interview-system-design">ç³»ç»Ÿè®¾è®¡ System design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/iot">Iot ç‰©è”ç½‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-code-clean">Java Clean Code Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-concurrent">Java ConcurrentğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-memory-model-jmm-jvm">JMM and GCğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-note">Java Core ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/js-tutorial">JavaScript tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/kotlin">kotlin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/kubernetes-k8s">kubernetes-k8s â˜ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux-note">é¸Ÿå“¥çš„ Linux ç§æˆ¿èœé˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/low-code-platform">å…³äºä½ä»£ç å¹³å°çš„è°ƒç ”</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mac">Mac å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/machine-learning-ml">machine-learning-ml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/marketing-seo">Marketing SEO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/maven-note">Maven NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/message-queue">Message QueueğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/money">Investment Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mongodb-note">MongoDB NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/monitor-system-grafana-prometheus-influxdb-hbase-time-serials-database">monitor-system-grafana-prometheusç›‘æ§ğŸ–¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mvc-mvvm">MVC to MVVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mybatis-note">MyBatis Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/netty-note">netty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nlp-natural-language-processing">nlp-natural-language-processingğŸ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nodejs-yarn-npm">Nodejs, Yarn, Npm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/oracle">Oracle å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-audio-video">Audio and Video development Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-big-data-introduce">å¤§æ•°æ®å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-cache">Cache ç¼“å­˜ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-computational-ad">è®¡ç®—å¹¿å‘Š Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-crawler-spider">ç½‘ç»œçˆ¬è™« Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-db-design-note">å…³ç³»å‹æ•°æ®åº“è¡¨è®¾è®¡ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-desktop-develop">æ¡Œé¢åº”ç”¨å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-http-restful">HTTP protocol Intro &amp; RESTful</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-reactive-programming">å“åº”å¼ç¼–ç¨‹ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-rpc">RPC Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-rule-engine-note">è§„åˆ™å¼•æ“ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/php-note">PHP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/postgres-note">Postgres noteğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/process-workflow-bpm-engine">å·¥ä½œæµå¼•æ“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/protect-your-app-authentication-oauth2-jwt-https">Protect Your App å®‰å…¨ä¿æŠ¤è®¤è¯é‰´æƒğŸ”‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/psychology">psychology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/python-note">PythonğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quant-money">é‡åŒ–äº¤æ˜“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quarkus">Quarkus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/react-note">ReactğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/real-time-communication-protocol">å®æ—¶é€šä¿¡ Real-time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/redis-note">RedisğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/regex">Regular Expression æ­£åˆ™ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/rust-note">Rust ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/scala-akka-play-framework">Scala è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/serverless">Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/service-mesh">service mesh æœåŠ¡ç½‘æ ¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/servlet">Servlet Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/shell-bash-note">shell-bashè„šæœ¬æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/spring-note">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/springcloud-note">Spring Cloud ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/springmvc-note">Spring MVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/task-schedule-note">Task Schedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tcp-ip-note-p2p">TCP IP, p2p</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tomcat-jetty-nginx">Tomcat Jetty Nginx ç­‰ web å®¹å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/vertx">Vertx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/video-creator">æ‹æ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/vue">Vue Brief Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webassembly">webassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webpack-esbuild-vite-rollup">å‰ç«¯æ‰“åŒ…æ„å»ºå·¥å…·</a></li></ul></nav><button type="button" title="æ”¶èµ·ä¾§è¾¹æ " aria-label="æ”¶èµ·ä¾§è¾¹æ " class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">RedisğŸŒˆ</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>RedisğŸŒˆ</h1></header><div align="center">reference: [redisåŸºç¡€](https://juejin.im/post/5ad6e4066fb9a028d82c4b66), [redisé›†ç¾¤åŸç†åŠæ­å»ºä¸ä½¿ç”¨](https://juejin.im/post/5ad54d76f265da23970759d3) ã€Šrediså¼€å‘å’Œè¿ç»´ã€‹</div><ul><li><a href="#1-redis%E4%BB%8B%E7%BB%8D">1. redisä»‹ç»</a><ul><li><a href="#11-redis-%E7%89%B9%E6%80%A7">1.1. redis ç‰¹æ€§</a></li><li><a href="#12-install">1.2. install</a></li><li><a href="#13-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">1.3. ä½¿ç”¨åœºæ™¯</a></li></ul></li><li><a href="#2-redis%E5%91%BD%E4%BB%A4">2. rediså‘½ä»¤</a><ul><li><a href="#21-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4">2.1. ç³»ç»Ÿç®¡ç†å‘½ä»¤</a></li><li><a href="#22-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4">2.2. æ•°æ®æ“ä½œå‘½ä»¤</a></li><li><a href="#23-%E9%94%AE%E7%AE%A1%E7%90%86">2.3. é”®ç®¡ç†</a></li></ul></li><li><a href="#3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">3. æ•°æ®ç±»å‹</a><ul><li><a href="#31-streaming-%E7%B1%BB%E5%9E%8B">3.1. streaming ç±»å‹</a></li><li><a href="#32-string-%E5%AD%97%E7%AC%A6%E4%B8%B2">3.2. String-å­—ç¬¦ä¸²</a></li><li><a href="#33-list-%E5%88%97%E8%A1%A8">3.3. List-åˆ—è¡¨</a></li><li><a href="#34-set-%E9%9B%86%E5%90%88">3.4. Set-é›†åˆ</a></li><li><a href="#35-hash-%E5%93%88%E5%B8%8C">3.5. Hash-å“ˆå¸Œ</a></li><li><a href="#36-zset-%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88">3.6. ZSet-æœ‰åºé›†åˆ</a></li></ul></li><li><a href="#4-lua%E8%84%9A%E6%9C%AC">4. luaè„šæœ¬</a></li><li><a href="#5-%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%9E%B6%E6%9E%84-lua%E5%AE%9E%E7%8E%B0%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C">5. å•çº¿ç¨‹æ¶æ„ luaå®ç°åŸå­æ“ä½œ</a></li><li><a href="#6-%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E6%9C%BA%E5%88%B6">6. å†…å­˜æ·˜æ±°æœºåˆ¶</a><ul><li><a href="#61-%E4%B8%89%E9%81%93%E4%BF%9D%E9%99%A9%E4%BF%9D%E8%AF%81-key-%E8%BF%87%E6%9C%9F%E5%A4%84%E7%90%86">6.1. ä¸‰é“ä¿é™©ä¿è¯ key è¿‡æœŸå¤„ç†</a></li><li><a href="#62-%E6%9C%89%E5%93%AA%E4%BA%9B%E6%B7%98%E6%B1%B0%E6%9C%BA%E5%88%B6">6.2. æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶</a></li><li><a href="#63-%E5%86%85%E5%AD%98%E5%9B%9E%E6%94%B6%E7%AE%97%E6%B3%95">6.3. å†…å­˜å›æ”¶ç®—æ³•</a></li><li><a href="#64-%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5">6.4. å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥</a><ul><li><a href="#641-%E9%80%9A%E8%BF%87%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">6.4.1. é€šè¿‡é…ç½®æ–‡ä»¶</a></li><li><a href="#642-%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%BF%90%E8%A1%8C%E6%97%B6%E4%BF%AE%E6%94%B9">6.4.2. é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹</a></li></ul></li></ul></li><li><a href="#7-%E6%8C%81%E4%B9%85%E5%8C%96">7. æŒä¹…åŒ–</a><ul><li><a href="#71-%E5%A4%87%E4%BB%BD%E9%80%89%E5%9E%8B">7.1. å¤‡ä»½é€‰å‹</a></li><li><a href="#72-rdb-%E5%BF%AB%E7%85%A7%E6%8C%81%E4%B9%85%E5%8C%96">7.2. RDB-å¿«ç…§æŒä¹…åŒ–</a><ul><li><a href="#721-rdb%E6%8C%81%E4%B9%85%E5%8C%96%E6%A6%82%E5%BF%B5">7.2.1. RDBæŒä¹…åŒ–æ¦‚å¿µ</a></li><li><a href="#722-%E8%A7%A6%E5%8F%91%E6%9C%BA%E5%88%B6-%E5%A6%82%E4%BD%95%E5%BC%80%E5%90%AF">7.2.2. è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯</a></li><li><a href="#723-rdb%E6%96%87%E4%BB%B6">7.2.3. RDBæ–‡ä»¶</a></li></ul></li><li><a href="#73-aof-%E6%97%A5%E5%BF%97%E6%8C%81%E4%B9%85%E5%8C%96">7.3. AOF-æ—¥å¿—æŒä¹…åŒ–</a><ul><li><a href="#731-aof%E6%A6%82%E5%BF%B5">7.3.1. aofæ¦‚å¿µ</a></li><li><a href="#732-%E5%86%99%E5%85%A5%E5%8E%9F%E7%90%86">7.3.2. å†™å…¥åŸç†</a></li><li><a href="#733-%E6%96%87%E4%BB%B6%E5%90%8C%E6%AD%A5">7.3.3. æ–‡ä»¶åŒæ­¥</a></li><li><a href="#734-%E9%87%8D%E5%86%99%E6%9C%BA%E5%88%B6">7.3.4. é‡å†™æœºåˆ¶</a></li><li><a href="#735-aof-%E6%8D%9F%E5%9D%8F">7.3.5. aof æŸå</a></li></ul></li></ul></li><li><a href="#8-%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%85">8. å‘å¸ƒä¸è®¢é˜…</a></li><li><a href="#9-%E4%BA%8B%E5%8A%A1">9. äº‹åŠ¡</a></li><li><a href="#10-%E4%BA%8B%E4%BB%B6">10. äº‹ä»¶</a><ul><li><a href="#101-%E6%96%87%E4%BB%B6%E4%BA%8B%E4%BB%B6">10.1. æ–‡ä»¶äº‹ä»¶</a></li><li><a href="#102-%E6%97%B6%E9%97%B4%E4%BA%8B%E4%BB%B6">10.2. æ—¶é—´äº‹ä»¶</a></li><li><a href="#103-%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%B0%83%E5%BA%A6%E6%89%A7%E8%A1%8C">10.3. äº‹ä»¶çš„è°ƒåº¦&amp;æ‰§è¡Œ</a></li></ul></li><li><a href="#11-redis%E9%9B%86%E7%BE%A4">11. redisé›†ç¾¤</a><ul><li><a href="#111-%E8%BF%9E%E6%8E%A5%E8%BF%87%E7%A8%8B">11.1. è¿æ¥è¿‡ç¨‹</a></li><li><a href="#112-%E4%B8%BB%E4%BB%8E%E9%93%BE">11.2. ä¸»ä»é“¾</a></li></ul></li><li><a href="#12-%E5%93%A8%E5%85%B5-sentinel">12. å“¨å…µ Sentinel</a></li><li><a href="#13-%E5%88%86%E7%89%87">13. åˆ†ç‰‡</a></li><li><a href="#14-%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F">14. ä¸€ä¸ªç®€å•çš„è®ºå›ç³»ç»Ÿ</a><ul><li><a href="#141-%E6%96%87%E7%AB%A0%E4%BF%A1%E6%81%AF">14.1. æ–‡ç« ä¿¡æ¯</a></li><li><a href="#142-%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD">14.2. ç‚¹èµåŠŸèƒ½</a></li><li><a href="#143-%E5%AF%B9%E6%96%87%E7%AB%A0%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F">14.3. å¯¹æ–‡ç« è¿›è¡Œæ’åº</a></li></ul></li><li><a href="#15-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C">15. ä¸€è‡´æ€§å“ˆå¸Œ</a></li><li><a href="#16-%E6%95%B4%E5%90%88-spring-boot2">16. æ•´åˆ spring boot2</a><ul><li><a href="#161-jedis">16.1. jedis</a></li><li><a href="#162-lettuce">16.2. lettuce</a></li><li><a href="#163-%E5%AE%9A%E4%B9%89%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8">16.3. å®šä¹‰åºåˆ—åŒ–å™¨</a></li></ul></li><li><a href="#17-%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98">17. é¢è¯•é—®é¢˜</a></li><li><a href="#18-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81">18. åˆ†å¸ƒå¼é”</a><ul><li><a href="#181-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86">18.1. å®ç°åŸç†</a><ul><li><a href="#1811-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E9%9C%80%E8%A6%81%E6%BB%A1%E8%B6%B3%E7%9A%84%E8%A6%81%E6%B1%82">18.1.1. åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚</a></li><li><a href="#1812-%E5%8A%A0%E9%94%81%E6%9C%BA%E5%88%B6">18.1.2. åŠ é”æœºåˆ¶</a></li><li><a href="#1813-watch-dog-%E8%87%AA%E5%8A%A8%E5%BB%B6%E6%97%B6%E6%9C%BA%E5%88%B6">18.1.3. watch dog è‡ªåŠ¨å»¶æ—¶æœºåˆ¶</a></li><li><a href="#1814-redisson-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81">18.1.4. redisson å¦‚ä½•å®ç°å¯é‡å…¥é”</a></li></ul></li><li><a href="#182-redis-%E5%AE%9E%E7%8E%B0-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81">18.2. redis å®ç° åˆ†å¸ƒå¼é”</a></li><li><a href="#183-redisson-%E5%AE%9E%E7%8E%B0">18.3. redisson å®ç°</a></li></ul></li></ul><h1>redisä»‹ç»</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redis-ç‰¹æ€§">redis ç‰¹æ€§<a href="#redis-ç‰¹æ€§" class="hash-link" aria-label="redis ç‰¹æ€§çš„ç›´æ¥é“¾æ¥" title="redis ç‰¹æ€§çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å…¨ç§°: remote dictionary server</p><ul><li><p>é€Ÿåº¦å¿«</p><ul><li>å› ä¸ºæ˜¯åœ¨å†…å­˜ä¸­è¿è¡Œ</li><li>c å®ç°</li><li>å•çº¿ç¨‹æ¶æ„, æ²¡æœ‰èµ„æºç«äº‰. - å­˜å‚¨çš„é”®å¾ˆå¤šçš„redis, ä¸è¦æ‰§è¡Œ <code>keys*</code> æ“ä½œ</li></ul></li><li><p>åŸºæœ¬æ•°æ®ç»“æ„æ˜¯é”®å€¼å¯¹, ä½†æ˜¯ å€¼å¯ä»¥æ”¯æŒå¤šç§æ•°æ®ç±»å‹</p><ul><li>string, åœ¨ string åŸºç¡€ä¸Šæ¼”å˜å‡º bitmaps(ä½å›¾), HyperLogLog</li><li>hash</li><li>é›†åˆ</li><li>æœ‰åºé›†åˆ</li><li>åˆ—è¡¨</li></ul></li><li><p>æä¾›å¤šç§åŠŸèƒ½</p><ul><li>é”®å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ - å¯ä»¥ç”¨æ¥å®ç°ç¼“å­˜</li><li>å‘å¸ƒè®¢é˜…åŠŸèƒ½ - å¯ä»¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—</li><li>æ”¯æŒ lua è„šæœ¬ - å¯ä»¥åˆ©ç”¨ lua åˆ›å»ºæ–°çš„ redis å‘½ä»¤</li><li>ç®€å•çš„äº‹åŠ¡æ”¯æŒ</li><li>æä¾›äº† pipeline (æµæ°´çº¿) åŠŸèƒ½ - è¿™æ ·å®¢æˆ·ç«¯èƒ½å¤Ÿå°†ä¸€æ‰¹å‘½ä»¤ä¸€æ¬¡æ€§ä¼ åˆ° redis, å‡å°‘äº†ç½‘ç»œå¼€é”€</li></ul></li><li><p>æŒä¹…åŒ–æ”¯æŒ</p><ul><li>RDB</li><li>AOF</li></ul></li><li><p>ä¸»ä»å¤åˆ¶ - æ˜¯åˆ†å¸ƒå¼ redis çš„åŸºç¡€</p></li><li><p>é«˜å¯ç”¨andåˆ†å¸ƒå¼</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="install">install<a href="#install" class="hash-link" aria-label="installçš„ç›´æ¥é“¾æ¥" title="installçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Windows</p><p>cmdå¯åŠ¨serverç«¯: <code>redis-server.exe redis.windows.conf </code>, redis.windows.confä¸æ˜¯å¿…é¡», å¦‚æœçœç•¥åˆ™ä½¿ç”¨é»˜è®¤é…ç½®</p><p>cmdå¯åŠ¨clientç«¯: <code>redis-cli.exe -h 127.0.0.1 -p 6379 </code>, ç„¶åå³å¯åœ¨è¿™ä¸ªç«¯å£è¿›è¡Œåç»­æ“ä½œ.</p><p>ubuntuä¸‹å¸è½½</p><p>rm -rf var/lib/redis/</p><p>rm -rf /var/log/redis</p><p>rm -rf /etc/redis/</p><p>rm -rf /usr/bin/redis-*</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">apt-get remove redis # åˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">apt-get remove --purge redis # åŒæ—¶åˆ é™¤é…ç½®æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">find / -name redis # æ‰¾åˆ°æ®‹ä½™æ–‡ä»¶ åˆ é™¤ä¹‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ubuntuä¸‹å®‰è£…</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$sudo apt-get update</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$sudo apt-get install redis-server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ redis-server # å¯åŠ¨server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ redis-cli # å¯åŠ¨client(redis 127.0.0.1:6379)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ£€æµ‹redis serveræ˜¯å¦å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">127.0.0.1:6379&gt; ping</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PONG</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>é€šè¿‡æºç å®‰è£…</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">wget http://download.redis.io/releases/redis-5.0.2.tar.gz # ä¸‹è½½ redis </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tar -zxv -f xxx.tar.gz # è§£å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ln -s redis-x.x.x &lt;link_name&gt; # å»ºç«‹å¿«æ·è½¯é“¾æ¥ # æœ€ä½³å®è·µï¼Œ åˆ©äºæœªæ¥ç‰ˆæœ¬å‡çº§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cd redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">make # ç¼–è¯‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">make install # å®‰è£… # å®‰è£…åˆ°äº† /usr/local/bin, è¿™æ ·å°±å¯ä»¥åœ¨ä»»ä½•ç›®å½•ä¸‹ä½¿ç”¨redis å‘½ä»¤äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯<a href="#ä½¿ç”¨åœºæ™¯" class="hash-link" aria-label="ä½¿ç”¨åœºæ™¯çš„ç›´æ¥é“¾æ¥" title="ä½¿ç”¨åœºæ™¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ul><li><p>è®¡æ•°å™¨</p><ul><li>å¯ä»¥å¯¹ String è¿›è¡Œè‡ªå¢è‡ªå‡è¿ç®—ï¼Œä»è€Œå®ç°è®¡æ•°å™¨åŠŸèƒ½</li><li>ä¾‹å¦‚å¯¹äºç½‘ç«™è®¿é—®é‡ï¼Œå¦‚æœä½¿ç”¨ MySQL æ•°æ®åº“è¿›è¡Œå­˜å‚¨ï¼Œé‚£ä¹ˆæ¯è®¿é—®ä¸€æ¬¡ç½‘ç«™å°±è¦å¯¹ç£ç›˜è¿›è¡Œè¯»å†™æ“ä½œã€‚è€Œå¯¹ Redis è¿™ç§å†…å­˜å‹æ•°æ®åº“çš„è¯»å†™æ€§èƒ½éå¸¸é«˜ï¼Œå¾ˆé€‚åˆå­˜å‚¨è¿™ç§é¢‘ç¹è¯»å†™çš„è®¡æ•°é‡ã€‚</li></ul></li><li><p>ç¼“å­˜</p><p>å°†çƒ­ç‚¹æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Œè®¾ç½®å†…å­˜çš„æœ€å¤§ä½¿ç”¨é‡ä»¥åŠæ·˜æ±°ç­–ç•¥æ¥ä¿è¯ç¼“å­˜çš„å‘½ä¸­ç‡ã€‚</p></li><li><p>åˆ†å¸ƒå¼ session</p><p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹å…·æœ‰å¤šä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ Redis æ¥ç»Ÿä¸€å­˜å‚¨è¿™äº›åº”ç”¨æœåŠ¡å™¨çš„ä¼šè¯ä¿¡æ¯ï¼Œä½¿å¾—æŸä¸ªåº”ç”¨æœåŠ¡å™¨å®•æœºæ—¶ä¸ä¼šä¸¢å¤±ä¼šè¯ä¿¡æ¯ï¼Œä»è€Œä¿è¯é«˜å¯ç”¨ã€‚</p></li><li><p>åˆ†å¸ƒå¼é”å®ç°:  SETNX å‘½ä»¤, è¿˜å¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ RedLock åˆ†å¸ƒå¼é”å®ç°</p><p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œæ— æ³•ä½¿ç”¨å•æœºç¯å¢ƒä¸‹çš„é”å®ç°ã€‚å½“å¤šä¸ªèŠ‚ç‚¹ä¸Šçš„è¿›ç¨‹éƒ½éœ€è¦è·å–åŒä¸€ä¸ªé”æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥è¿›è¡ŒåŒæ­¥ã€‚</p><p>setnx key valueï¼Œå½“keyä¸å­˜åœ¨æ—¶ï¼Œå°† key çš„å€¼è®¾ä¸º value ï¼Œè¿”å›1ã€‚è‹¥ç»™å®šçš„ key å·²ç»å­˜åœ¨ï¼Œåˆ™setnxä¸åšä»»ä½•åŠ¨ä½œï¼Œè¿”å›0ã€‚å½“setnxè¿”å›1æ—¶ï¼Œè¡¨ç¤ºè·å–é”ï¼Œåšå®Œæ“ä½œä»¥ådel keyï¼Œè¡¨ç¤ºé‡Šæ”¾é”ï¼Œå¦‚æœsetnxè¿”å›0è¡¨ç¤ºè·å–é”å¤±è´¥</p></li><li><p>åˆ†å¸ƒå¼idç”Ÿæˆ</p><p>å› ä¸º redis å•çº¿ç¨‹çš„æ’ä»–æ€§, ä¿è¯çš„ç”Ÿæˆid çš„å”¯ä¸€, æ¯æ¬¡å…ˆ+1å†è·å–</p><p>æ”¹è¿›: æ¯æ¬¡å…ˆ+1000å†è·å–, æ‹¿åˆ°æœ¬åœ°å, 0~1000 æ…¢æ…¢ç”¨, ç”¨å®Œäº†å†è·å– 1001~2000, ä¸€ä¸ªç”¨æˆ·æœåŠ¡å®•æœºäº†ï¼Œä¹Ÿé¡¶å¤šä¸€å°æ®µuserIdæ²¡æœ‰ç”¨åˆ°</p></li><li><p>æ¶ˆæ¯é˜Ÿåˆ—</p><p>List æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œå¯ä»¥é€šè¿‡ lpop å’Œ lpush å†™å…¥å’Œè¯»å–æ¶ˆæ¯ã€‚</p><p>ä¸è¿‡ä¸è§„å»ºä½¿ç”¨, æœ€å¥½ä½¿ç”¨ Kafkaã€RabbitMQ ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ã€‚ä¸“ä¸šçš„äººåšä¸“ä¸šçš„äº‹</p></li><li><p>feed æµ</p><p>ä½¿ç”¨çš„æ˜¯ list ç±»å‹(æœ‰åºæ€§)</p></li><li><p>ç‚¹èµ/likeåŠŸèƒ½</p><p>åˆ©ç”¨ zet çš„å»é‡</p></li><li><p>å…±åŒå¥½å‹/å…±åŒå…³æ³¨</p><p>Set å¯ä»¥å®ç°äº¤é›†ã€å¹¶é›†ç­‰æ“ä½œ</p></li><li><p>æ’è¡Œæ¦œ</p><p>ZSet å¯ä»¥å®ç°æ›´å…·score æ’å, è€Œä¸”å¤©ç„¶å»é‡</p></li></ul><h1>rediså‘½ä»¤</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç³»ç»Ÿç®¡ç†å‘½ä»¤">ç³»ç»Ÿç®¡ç†å‘½ä»¤<a href="#ç³»ç»Ÿç®¡ç†å‘½ä»¤" class="hash-link" aria-label="ç³»ç»Ÿç®¡ç†å‘½ä»¤çš„ç›´æ¥é“¾æ¥" title="ç³»ç»Ÿç®¡ç†å‘½ä»¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ä½äº <code>/usr/local/bin</code></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#         å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">redis-server # é»˜è®¤æ–¹å¼å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">redis-server --port 6379 [...] # æŒ‡å®šé…ç½®é¡¹å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">redis-server &lt;path_to_redis.conf&gt; # æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨ï¼Œ ä¸€èˆ¬å­˜åˆ° /opt/redis/redis.conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#         è¿æ¥ åœæ­¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">redis-cli -h &lt;host&gt; -p &lt;port&gt; # é»˜è®¤ 127.0.0.1ï¼š6379</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">redis-cli shutdown [nosave|save] # å…³é—­ï¼Œ æ˜¯å¦æŒä¹…åŒ–</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>é…ç½®æ–‡ä»¶ç±»ä¼¼å¦‚ä¸‹ï¼š</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">bind 127.0.0.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">port 6379</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">logfile xxx # æ—¥å¿—æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">dir xxx # redis å·¥ä½œç›®å½•ï¼Œ å­˜æ”¾æŒä¹…åŒ–æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">daemonize xxx # æ˜¯å¦ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ•°æ®æ“ä½œå‘½ä»¤">æ•°æ®æ“ä½œå‘½ä»¤<a href="#æ•°æ®æ“ä½œå‘½ä»¤" class="hash-link" aria-label="æ•°æ®æ“ä½œå‘½ä»¤çš„ç›´æ¥é“¾æ¥" title="æ•°æ®æ“ä½œå‘½ä»¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å‘½ä»¤æŸ¥è¯¢: <a href="http://redisdoc.com" target="_blank" rel="noopener noreferrer">http://redisdoc.com</a></p><p>è®°å¿†æ–¹å¼: <a href="https://my.oschina.net/u/3025423/blog/793649" target="_blank" rel="noopener noreferrer">https://my.oschina.net/u/3025423/blog/793649</a></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#        å…¨å±€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">keys * # æ‰€æœ‰é”®ï¼Œ è€—æ—¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">dbsize # é”®æ€»æ•°ï¼Œ ä¸è€—æ—¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">exist &lt;key&gt; # æ˜¯å¦å­˜åœ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">del key [key ...] # åˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">expire &lt;key&gt; &lt;seconds&gt; # é”®è¿‡æœŸåˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ttl &lt;key&gt; # å‰©ä½™è¿‡æœŸæ—¶é—´ï¼Œ 0ï¼Œ -1ï¼Œ -2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">type &lt;key&gt; # å€¼çš„ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//åˆ é™¤å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰Key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">flushdb</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">flushall</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é”®ç®¡ç†">é”®ç®¡ç†<a href="#é”®ç®¡ç†" class="hash-link" aria-label="é”®ç®¡ç†çš„ç›´æ¥é“¾æ¥" title="é”®ç®¡ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># é”®é‡å‘½å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># rename key newKey é”®é‡å‘½å, å¦‚æœ newkey å·²ç»å­˜åœ¨, ä¼šè¢«è¦†ç›–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸ºäº†é˜²æ­¢è¢«è¦†ç›–, renamenx å‘½ä»¤ : è¡¨ç¤ºå¦‚æœ newKey ä¸å­˜åœ¨æ‰å¯rename æˆåŠŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># éšæœºæŒ‘é€‰ä¸€ä¸ª é”® randomkey</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é”®çš„è¿‡æœŸæ—¶é—´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯¹äºæ•£åˆ—è¡¨è¿™ç§å®¹å™¨ï¼Œåªèƒ½ä¸ºæ•´ä¸ªé”®è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆæ•´ä¸ªæ•£åˆ—è¡¨ï¼‰ï¼Œè€Œä¸èƒ½ä¸ºé”®é‡Œé¢çš„å•ä¸ªå…ƒç´ è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é€šè¿‡ set åœ¨åˆå§‹åŒ–æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ or é€šè¿‡ setex</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">set key value [ex seconds] [px milliseconds] [nx|xx]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># expire key seconds ç§’çº§åˆ«è¿‡æœŸ; key ä¸å­˜åœ¨, è¿”å›0; è®¾ç½®è¿‡æœŸä¸ºè´Ÿå€¼, ç­‰åŒäº del (ç«‹å³åˆ é™¤)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># expireat key timestamp ç§’çº§åˆ«æ—¶é—´æˆ³åè¿‡æœŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># pexpire key milliseconds æ¯«ç§’çº§åˆ«è¿‡æœŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># pexpireat key milliseconds-timestamp æ¯«ç§’æ—¶é—´æˆ³ ----- æœ€ç»ˆåº•å±‚éƒ½æ˜¯è°ƒç”¨è¿™ä¸ªå‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ttl key è§‚å¯Ÿå‰©ä½™æ—¶é—´; pttl æ›´ç²¾ç¡®(æ¯«ç§’çº§åˆ«)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># persist key å–æ¶ˆè¿‡æœŸæ—¶é—´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é”®çš„è¿ç§» </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å°†éƒ¨åˆ†æ•°æ®ä»ä¸€ä¸ªredisè¿ç§»åˆ°å¦ä¸€ä¸ª redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ–¹æ³•æœ‰ä¸‰: move; dump+restore; migrate</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># `move key db` </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># `dump key`åœ¨æºredisä¸Šå°†æ•°æ®åºåˆ—åŒ–æˆ RDBæ ¼å¼ + `restore key ttl value`åœ¨ç›®æ ‡redisä¸Šå°†æ•°æ®å¤åŸ, ttl è¡¨ç¤ºè¿‡æœŸæ—¶é—´, tto=0è¡¨ç¤ºæ²¡æœ‰è¿‡æœŸæ—¶é—´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># migrate host port key|&quot;&quot; target-db timeout [copy] [replace] [key key...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># éå†é”®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># `keys pattern` æ”¯æŒglobé€šé…ç¬¦ - è€—æ—¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ¸è¿›å¼éå† `scan cursor [match pattern] [count number]` </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¤šæ•°æ®åº“ç®¡ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># `select dbIndex` åˆ‡æ¢æ•°æ®åº“, ä»0å¼€å§‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># flushdb/flushall æ¸…é™¤/æ¸…é™¤å…¨éƒ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>æ•°æ®ç±»å‹</h1><p><a href="https://www.cnblogs.com/javazhiyin/p/11063944.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/javazhiyin/p/11063944.html</a></p><p>é”®çš„ç±»å‹åªèƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œå€¼æ”¯æŒçš„ <code>äº”ç§æ•°æ®ç±»å‹</code>ä¸ºï¼šå­—ç¬¦ä¸²(string)ã€åˆ—è¡¨(list)ã€é›†åˆ(set)ã€æœ‰åºé›†åˆ(zset)ã€æ•£åˆ—è¡¨(hash)ã€‚</p><p>æ¯ç§æ•°æ®ç±»å‹åœ¨redis å†…éƒ¨æœ‰è‡ªå·±çš„ç¼–ç å®ç°, å†…éƒ¨çš„ç¼–ç å®ç°æœ‰æ”¹è¿›ä¸ä¼šå¯¹å¤–éƒ¨æœ‰ä»€ä¹ˆå½±å“, å¤šç§å†…éƒ¨ç¼–ç å®ç°å¯ä»¥å¯¹åº”ä¸åŒåº”ç”¨åœºæ™¯</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="streaming-ç±»å‹">streaming ç±»å‹<a href="#streaming-ç±»å‹" class="hash-link" aria-label="streaming ç±»å‹çš„ç›´æ¥é“¾æ¥" title="streaming ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://lolico.me/2020/06/28/Using-stream-to-implement-message-queue-in-springboot/" target="_blank" rel="noopener noreferrer">https://lolico.me/2020/06/28/Using-stream-to-implement-message-queue-in-springboot/</a>
TODO</p><p>Redis5æ–°å¢äº†ä¸€ä¸ªStreamçš„æ•°æ®ç±»å‹ï¼Œè¿™ä¸ªç±»å‹ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—æ¥ä½¿ç”¨æ—¶å¼¥è¡¥äº†Listå’ŒPub/Subçš„ä¸è¶³å¹¶ä¸”æä¾›äº†æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ackæœºåˆ¶ä»¥åŠæ¶ˆè´¹è€…ç»„ç­‰æ¦‚å¿µ</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="string-å­—ç¬¦ä¸²">String-å­—ç¬¦ä¸²<a href="#string-å­—ç¬¦ä¸²" class="hash-link" aria-label="String-å­—ç¬¦ä¸²çš„ç›´æ¥é“¾æ¥" title="String-å­—ç¬¦ä¸²çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Stringæ•°æ®ç»“æ„æ˜¯ç®€å•çš„key-valueç±»å‹ï¼Œvalueå…¶å®ä¸ä»…å¯ä»¥æ˜¯Stringï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°å­—ã€‚ å¸¸è§„key-valueç¼“å­˜åº”ç”¨ï¼› å¸¸è§„è®¡æ•°ï¼šå¾®åšæ•°ï¼Œç²‰ä¸æ•°ç­‰ã€‚</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¸¸ç”¨å‘½ä»¤: set,get,decr,incr,mget ç­‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è®¾ç½®å€¼ , è¿‡æœŸæ—¶é—´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## `set key value [ex seconds] [px milliseconds] [nx|xx]`</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è®¾ç½®ç§’/æ¯«ç§’çº§åˆ«è¿‡æœŸæ—¶é—´, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## é”®å¿…é¡»å­˜åœ¨/ä¸å­˜åœ¨ æ‰èƒ½è®¾ç½®æˆåŠŸ, ç”¨äºæ·»åŠ /æ›´æ–° (ç­‰ä»· setnx setxx)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## setnx å®ç° åˆ†å¸ƒå¼é” (åŸç†: redisçš„å•çº¿ç¨‹æ¨¡å‹, setnx åªæœ‰ä¸€ä¸ªclient ä¼šè®¾ç½®æˆåŠŸ)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; set hello world</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è·å–å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## getset key value è®¾ç½®è·å–åŸå€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; get hello</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;world&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰¹é‡è®¾ç½®, è·å–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">127.0.0.1:6379&gt; mset a 1 b 2 c 3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">127.0.0.1:6379&gt; mget a b c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;1&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;2&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3) &quot;3&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è®¡æ•° </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è‡ªå¢ `incr key`, å€¼ä¸æ˜¯æ•´æ•°, è¿”å›é”™è¯¯, å€¼æ˜¯æ•´æ•°åˆ™è¿”å›è‡ªå¢åçš„ç»“æœ, å€¼ä¸å­˜åœ¨è§†ä½œ0,è‡ªå¢åè¿”å›1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è‡ªå‡ `decr key`</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## incrby å’Œ decrby è‡ªå¢è‡ªå‡æŒ‡å®šæ•°å­—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; del hello</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; get hello</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(null)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">###########################################</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸å¸¸ç”¨çš„å‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è¿½åŠ  `append key value` å‘ string å°¾éƒ¨è¿½åŠ å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## é•¿åº¦ `strlen key` æ¯ä¸ªè‹±æ–‡å­—ç¬¦ 1 byte, ä¸­æ–‡ 3 byte</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è®¾ç½® æŒ‡å®šä½ç½®çš„ å­—ç¬¦ `setrange key offset value` åç§»é‡ä»0å¼€å§‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## è·å¾— éƒ¨åˆ†å­—ç¬¦ä¸² `getrange key start end`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å‘½ä»¤çš„æ—¶é—´å¤æ‚åº¦</p><p>åœºæ™¯:</p><ul><li>ç¼“å­˜ - ä¸šåŠ¡å¯¹è±¡(å¦‚: User) éœ€è¦åºåˆ—åŒ–</li><li>è®¡æ•° - ç»Ÿè®¡æ’­æ”¾é‡ (çœŸå®çš„è®¡æ•°ç³»ç»Ÿéœ€è¦è€ƒè™‘: é˜²ä½œå¼Š, æ•°æ®æŒä¹…åŒ–)</li><li>å…±äº«session - åˆ†å¸ƒå¼åº”ç”¨</li><li>é™æµ - ä¾‹å¦‚æ¯åˆ†é’Ÿä¸èƒ½è®¿é—®è¶…è¿‡10æ¬¡, åŒä¸€ä¸ªipåœ°å€ä¸èƒ½åœ¨1ç§’å†…è®¿é—®è¶…è¿‡næ¬¡</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="list-åˆ—è¡¨">List-åˆ—è¡¨<a href="#list-åˆ—è¡¨" class="hash-link" aria-label="List-åˆ—è¡¨çš„ç›´æ¥é“¾æ¥" title="List-åˆ—è¡¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å…è®¸é‡å¤;</p><p>Redis listçš„å®ç°ä¸ºä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œå³å¯ä»¥æ”¯æŒåå‘æŸ¥æ‰¾å’Œéå†;</p><p>åœºæ™¯:</p><ul><li><p>æ¶ˆæ¯é˜Ÿåˆ—; lpush å’Œ brpop ç»“åˆå¯å®ç°é˜»å¡é˜Ÿåˆ—</p></li><li><p>æ–‡ç« åˆ—è¡¨</p><p>æ¯ç¯‡æ–‡ç« ä½¿ç”¨ hash ç±»å‹å­˜å‚¨; ç”¨æˆ·æ–‡ç« åˆ—è¡¨ä½¿ç”¨ list ç±»å‹å­˜å‚¨</p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¸¸ç”¨å‘½ä»¤: lpush,rpush,lpop,rpop,lrangeç­‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">######## æ·»åŠ  lpush rpush linsert ##########</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># rpush rå³right, åœ¨Listä¸­ä»å³å‘å·¦æ’å…¥å…ƒç´  (ä¸€æ—¦ä½¿ç”¨è¯¥å‘½ä»¤ï¼ŒListå°±ä»£è¡¨æ˜¯ä¸€ä¸ªåˆ—è¡¨è€Œä¸æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå¯¹å…¶ä½¿ç”¨getæ–¹æ³•ä¼šæŠ¥é”™)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; rpush list-key item</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; rpush list-key item2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; rpush list-key item # å…è®¸é‡å¤å…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">127.0.0.1:6379&gt; rpush list c b a</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">127.0.0.1:6379&gt; lrange list 0 -1 # éå†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;c&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;b&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3) &quot;a&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># linsert key before|after pivot value åœ¨ pivot å‰/å æ’å…¥ value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">############# æŸ¥æ‰¾ lrange lindex llen ###########################</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># lrange key start end å·¦å³é—­åŒºé—´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç´¢å¼•ä»å·¦åˆ°å³ 0 ~ (N-1) ; ä»å³åˆ°å·¦ -1 ~ -N</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; lrange list-key 0 -1     # indexä» 0 å¼€å§‹, -1 è¡¨ç¤ºç›´åˆ°æœ«å°¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;item&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;item2&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3) &quot;item&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># lindex key index è·å– index å¤„çš„å…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">127.0.0.1:6379&gt; lindex list -1 # æœ€åä¸€ä¸ªå…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;a&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># llen key åˆ—è¡¨é•¿åº¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">########## åˆ é™¤ lpop rpop lrem ltrim ################</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># lpop lè¡¨ç¤ºleft, è¿”å›å¹¶åˆ é™¤keyListä¸­çš„ç¬¬ä¸€ä¸ªvalueå€¼ (åˆ é™¤å·¦è¾¹ç¬¬ä¸€ä¸ª)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># rpop key ä»å³è¾¹å¼¹å‡ºä¸€ä¸ª</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; lpop list-key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;item&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># lrem key count value åˆ é™¤å€¼ä¸º value çš„ å…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># count &gt; 0, ä»å·¦åˆ°æœ‰åˆ é™¤æœ€å¤š countä¸ª; count &lt; 0, ä»å³åˆ°å·¦åˆ é™¤æœ€å¤š |count| ä¸ª; count = 0, åˆ é™¤æ‰€æœ‰.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ltrim key start end å–å­åˆ—è¡¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">###############ä¿®æ”¹ lset##################</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># lset key index value ä¿®æ”¹index å¤„çš„å…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">################## é˜»å¡å¼å¼¹å‡º blpop brpop ###################</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># blpop key [key...] timeout ç­‰å¾…ç›´åˆ°æœ‰å…ƒç´ è¿”å›, å•ä½ s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ—è¡¨ä¸º nil, ç­‰å¾… timeoutç§’åè¿”å›, å¦‚æœtimeout=0, ä¸€ç›´ç­‰å¾…ä¸‹å»; å¦‚æœåœ¨æ­¤æœŸé—´æœ‰æ–°çš„å…ƒç´ æ·»åŠ , ç«‹å³è¿”å›è¿™ä¸ªæ–°å…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ—è¡¨ä¸ä¸ºnil, ç«‹å³è¿”å›ç»“æœ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="set-é›†åˆ">Set-é›†åˆ<a href="#set-é›†åˆ" class="hash-link" aria-label="Set-é›†åˆçš„ç›´æ¥é“¾æ¥" title="Set-é›†åˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ— åºä¸å¯é‡å¤</p><p>setæä¾›äº†åˆ¤æ–­æŸä¸ªæˆå‘˜æ˜¯å¦åœ¨ä¸€ä¸ªseté›†åˆå†…çš„é‡è¦æ¥å£ï¼Œè¿™ä¸ªä¹Ÿæ˜¯listæ‰€ä¸èƒ½æä¾›çš„</p><p>å–äº¤é›†, å¹¶é›†</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ·»åŠ  sadd key element [element...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># sadd så³ä¸ºSetï¼ŒSet add valueçš„æ„æ€, ç»™keySetæ’å…¥valueï¼ŒSeté›†åˆæ˜¯æ— åºçš„ï¼Œæ²¡æœ‰å¤´éƒ¨å’Œå°¾éƒ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; sadd set-key item</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; sadd set-key item2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; sadd set-key item3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; sadd set-key item         # é‡å¤, ä¸å¯æ’å…¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># smembers key é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># s=Setï¼Œmemberså³åœ¨Seté›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ,  è¿”å›keysetä¸­æ‰€æœ‰çš„valueå€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; smembers set-key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;item&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;item2&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3) &quot;item3&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ¤æ–­æ˜¯å¦å­˜åœ¨ sismember key element</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># s=Setï¼Œismemberå³æŸä¸ªå…ƒç´ æ˜¯å¦åœ¨Seté›†åˆçš„å†…å­˜ä¸­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; sismember set-key item4</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 0     # ä¸å­˜åœ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; sismember set-key item</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1     # å­˜åœ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># srandmember key [count] éšæœºè¿”å›countä¸ªæ•°çš„å…ƒç´ , é»˜è®¤è¿”å›1ä¸ª</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç§»é™¤ srem key element [element...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># srem å³Set remove, åˆ é™¤keySetä¸­æŒ‡å®šçš„valueå€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; srem set-key item2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; srem set-key item2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; smembers set-key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;item&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;item3&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…ƒç´ ä¸ªæ•° scard key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># spop key [count] éšæœºå¼¹å‡ºä¸€ä¸ªå…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">############ é›†åˆé—´çš„æ“ä½œ #############################</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># äº¤é›† sinter key [key...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¹¶é›† sunion key [key...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å·®é›† sdiff key [key...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>åœºæ™¯:</p><ul><li><p>æ ‡ç­¾ - sadd</p><p>ç»™ç”¨æˆ·æ·»åŠ æ ‡ç­¾ ; ç»™æ ‡ç­¾æ·»åŠ ç”¨æˆ·</p><p>æ·»åŠ è¿‡ç¨‹åº”è¯¥åœ¨åŒä¸ªäº‹åŠ¡ä¸­å®Œæˆ, è‡³äºå¦‚ä½•å®ç°, å¯é€šè¿‡ redis äº‹åŠ¡, or é€šè¿‡ lua è„šæœ¬</p></li><li><p>ç”Ÿæˆéšæœºæ•°, å¦‚æŠ½å¥– - spop/srandmember</p></li><li><p>ç¤¾äº¤éœ€æ±‚ - sadd + sinter</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hash-å“ˆå¸Œ">Hash-å“ˆå¸Œ<a href="#hash-å“ˆå¸Œ" class="hash-link" aria-label="Hash-å“ˆå¸Œçš„ç›´æ¥é“¾æ¥" title="Hash-å“ˆå¸Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡; ä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼š ä¸€ä¸ªç”µå•†ç½‘ç«™é¡¹ç›®çš„é¦–é¡µå°±ä½¿ç”¨äº†redisçš„hashæ•°æ®ç»“æ„è¿›è¡Œç¼“å­˜</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¸¸ç”¨å‘½ä»¤ï¼š hget,hset,hgetall ç­‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># HSET key field value å°†å“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼è®¾ä¸º value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hset hash-key sub-key1 value1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hset hash-key sub-key2 value2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hset hash-key sub-key1 value1     # å¦‚æœåŸŸ field å·²ç»å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œæ—§å€¼å°†è¢«è¦†ç›–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hgetall å³ hash get all, æ ¹æ®hashçš„key, è·å– fieldå’Œfield_value, è¿”å›list, é•¿åº¦ä¸ºhashçš„2å€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hgetall hash-key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;sub-key1&quot;     # field</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;value1&quot;       # filed value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3) &quot;sub-key2&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">4) &quot;value2&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hdel hash-key sub-key2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1 # è¿”å›ç»“æœä¸º æˆåŠŸåˆ é™¤çš„ field ä¸ªæ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hdel hash-key sub-key2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hget è·å–æŒ‡å®šfiledçš„å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hget hash-key sub-key1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;value1&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; hgetall hash-key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;sub-key1&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;value1&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hlen key è®¡ç®—field ä¸ªæ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰¹é‡è®¾ç½® æ‰¹é‡è·å– field value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hmget key field [field...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hmset key field value [field value]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hexists key field åˆ¤æ–­fieldæ˜¯å¦å­˜åœ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hkeys key è¿”å›æ‰€æœ‰ field</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hvals key è¿”å›æ‰€æœ‰ value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hgetall key è¿”å› æ‰€æœ‰ field-value</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># hstrlen key field  è®¡ç®— field é•¿åº¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>hash è¿™ç§ç±»å‹å’Œç»“æ„åŒ–æ•°æ®åº“çš„è¡¨æœ€ç±»ä¼¼, key è®°å½•ä¸º id, valueå°±æ˜¯ä¸€è¡Œæ•°æ®. ä¹Ÿæœ‰ä¸åŒä¹‹å¤„: hash æ¯ä¸ª key å¯ä»¥æœ‰ä¸åŒçš„ field. è€Œå…³ç³»å‹æ•°æ®åº“ä¸€æ—¦æ·»åŠ æ–°çš„ &quot;åˆ—&quot;, æ¯è¡Œæ•°æ®éƒ½è¦èµ‹å€¼, å³ä½¿æ˜¯ null; å…³ç³»å‹æ•°æ®åº“æ–¹ä¾¿è¿›è¡Œå…³ç³»æŸ¥è¯¢, è€Œ redis ä¸­çš„ hash æ¨¡æ‹Ÿ å¤æ‚æŸ¥è¯¢å°±å¾ˆéº»çƒ¦</p><p>åœºæ™¯: ç¼“å­˜. ç›¸å¯¹äºç›´æ¥ä½¿ç”¨String ç±»å‹ä½¿ä¸šåŠ¡å¯¹è±¡ç³»åˆ—åŒ–æ„å»ºç¼“å­˜, ä½¿ç”¨ hash æ„é€ ç¼“å­˜æ›´ç›´è§‚, æ›´æ–°æ“ä½œæ›´ä¾¿æ·</p><p>è‡³æ­¤, å¯¹äº ç¼“å­˜åœºæ™¯, æœ‰ 3ç§æ–¹æ¡ˆ:</p><ul><li><p>ä½¿ç”¨ string ç±»å‹, æ¯ä¸ª key-value å°±æ˜¯ä¸€ä¸ªå±æ€§ eg: <code>set usre:1:name xy</code>, <code>set user:1:age 18</code> ...</p><p>è¿™ç§æœ€ç®€å•, å†…å­˜å ç”¨æœ€å¤§, å› ä¸º key çš„å†—ä½™å†…å®¹è¾ƒå¤š</p></li><li><p>ä½¿ç”¨ string ç±»å‹, å°†ä¸€ä¸ªä¸šåŠ¡å¯¹è±¡åºåˆ—åŒ–ç„¶åç”¨ä¸€ä¸ª é”®å€¼å¯¹ä¿å­˜</p><p>å†…å­˜å ç”¨ä¸å¤š, ä½†æ˜¯åºåˆ—åŒ–ååºåˆ—åŒ–æœ‰æ—¶é—´å¼€é”€, å°¤å…¶ æ›´æ–° æ“ä½œçš„æ—¶å€™, å¾ˆéº»çƒ¦</p></li><li><p>ä½¿ç”¨ hash ç±»å‹, æ¯ä¸ª é”®å€¼å¯¹ä¿å­˜ä¸€ä¸ªä¸šåŠ¡å¯¹è±¡,  å±æ€§ é€šè¿‡ field-value å¯¹ä¿å­˜</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="zset-æœ‰åºé›†åˆ">ZSet-æœ‰åºé›†åˆ<a href="#zset-æœ‰åºé›†åˆ" class="hash-link" aria-label="ZSet-æœ‰åºé›†åˆçš„ç›´æ¥é“¾æ¥" title="ZSet-æœ‰åºé›†åˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ç±»ä¼¼ set , <code>å…ƒç´ ä¸å¯é‡å¤</code> (åˆ†æ•°å¯ä»¥é‡å¤); æ­¤å¤–, sorted setå¢åŠ äº†ä¸€ä¸ªæƒé‡å‚æ•°scoreï¼Œä½¿å¾—é›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰scoreè¿›è¡Œ <code>æœ‰åºæ’åˆ—</code></p><p>åœºæ™¯: åœ¨ç›´æ’­ç³»ç»Ÿä¸­ï¼Œå®æ—¶æ’è¡Œä¿¡æ¯åŒ…å«ç›´æ’­é—´åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ï¼Œå„ç§ç¤¼ç‰©æ’è¡Œæ¦œ</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ·»åŠ  zadd key score member [score member ...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å››ä¸ªé€‰é¡¹: nx: memberå¿…é¡»ä¸å­˜åœ¨æ‰å¯æˆåŠŸ, ç”¨äº æ·»åŠ ; xx: memberå¿…é¡»å­˜åœ¨æ‰å¯æˆåŠŸ, ç”¨äº ä¿®æ”¹; ch: å…ƒç´ å‘ç”Ÿå˜åŒ–çš„ä¸ªæ•° ; incr: å¯¹ score è‡ªå¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># 728 æ˜¯åˆ†æ•°, score å€¼å¯ä»¥æ˜¯æ•´æ•°å€¼æˆ–åŒç²¾åº¦æµ®ç‚¹æ•°(å¦‚æœæŸä¸ª member å·²ç»æ˜¯æœ‰åºé›†çš„æˆå‘˜ï¼Œé‚£ä¹ˆæ›´æ–°è¿™ä¸ª member çš„ score å€¼)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; zadd zset-key 728 member1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; zadd zset-key 982 member0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; zadd zset-key 982 member0     # memberä¸€æ ·, scoreä¹Ÿä¸€æ ·, æ— æ³•æ’å…¥, æ— æ³•æ›´æ–°score</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…ƒç´ ä¸ªæ•° zcard key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è®¡ç®—æŸä¸ªå…ƒç´ çš„åˆ†æ•° zscore key member </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è®¡ç®—æŸä¸ªæˆå‘˜æ’å zrank/zrevrank key member æ­£æ•°/å€’æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># zrem key member [member...]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¢åŠ åˆ†æ•° zincrby key increment member åˆ†æ•°å¢åŠ increment</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è·å–æŒ‡å®šæ’åèŒƒå›´çš„å…ƒç´  zrange/zrevrange key start end [withscores] ä»ä½åˆ°é«˜/ä»é«˜åˆ°ä½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; zrange zset-key 0 -1 withscores # å…¨èŒƒå›´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;member1&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;728&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3) &quot;member0&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">4) &quot;982&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è·å–æŒ‡å®šåˆ†æ•°èŒƒå›´çš„å…ƒç´  zrangbyscore/zrevrangebyscore key min max [withscores] [limit offset count]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># min max æ”¯æŒ å¼€é—­åŒºé—´ (å°æ‹¬å·, ä¸­æ‹¬å·), æ­£è´Ÿæ— ç©· (+-inf)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; zrangebyscore zset-key 0 800 withscores</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1) &quot;member1&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2) &quot;728&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤ zrem key member</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤æŒ‡å®šæ’åèŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´  (å‡åº) zremrangebyrank key start end</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„å…ƒç´  (å‡åº) zremrangebyscore key min max</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; zrem zset-key member1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; zrem zset-key member1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(integer) 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿”å›æŒ‡å®šåˆ†æ•°èŒƒå›´å…ƒç´ ä¸ªæ•° zcount key min max</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">############## é›†åˆé—´æ“ä½œ ################################</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#äº¤é›† zinterstore</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#å¹¶é›† zunionstore</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>luaè„šæœ¬</h1><h1>å•çº¿ç¨‹æ¶æ„ luaå®ç°åŸå­æ“ä½œ</h1><p>ä¸å­˜åœ¨å¹¶å‘æ‰§è¡Œå‘½ä»¤</p><ul><li>çº¯å†…å­˜è®¿é—®</li><li>éé˜»å¡io - epoll å®ç°ioå¤šè·¯å¤ç”¨</li><li>å•çº¿ç¨‹æ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul><p>Redisåªç”¨ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚æ‰€ä»¥åœ¨æ‰§è¡Œluaè„šæœ¬çš„æ—¶å€™ï¼Œæ²¡æœ‰å…¶ä»–å®¢æˆ·ç«¯çš„è¯·æ±‚åœ¨å¤„ç†ã€‚æ‰€ä»¥åœ¨luaè„šæœ¬ä¸­çš„å¯¹redisæ•°æ®çš„ä¿®æ”¹æ“ä½œå°±æ˜¯åŸå­çš„ã€‚</p><h1>å†…å­˜æ·˜æ±°æœºåˆ¶</h1><p>å¯ä»¥è®¾ç½®å†…å­˜æœ€å¤§ä½¿ç”¨é‡ï¼Œå½“å†…å­˜ä½¿ç”¨é‡è¶…è¿‡æ—¶æ–½è¡Œæ·˜æ±°ç­–ç•¥ï¼Œå…·ä½“æœ‰ 6 ç§æ·˜æ±°ç­–ç•¥ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä¸‰é“ä¿é™©ä¿è¯-key-è¿‡æœŸå¤„ç†">ä¸‰é“ä¿é™©ä¿è¯ key è¿‡æœŸå¤„ç†<a href="#ä¸‰é“ä¿é™©ä¿è¯-key-è¿‡æœŸå¤„ç†" class="hash-link" aria-label="ä¸‰é“ä¿é™©ä¿è¯ key è¿‡æœŸå¤„ç†çš„ç›´æ¥é“¾æ¥" title="ä¸‰é“ä¿é™©ä¿è¯ key è¿‡æœŸå¤„ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤</p><p>å®šæœŸåˆ é™¤: redisæ˜¯æ¯éš”100mséšæœºæŠ½å–ä¸€äº›keyæ¥æ£€æŸ¥å’Œåˆ é™¤</p><p>æƒ°æ€§åˆ é™¤: è·å–æŸä¸ªkeyçš„æ—¶å€™ï¼Œredisä¼šæ£€æŸ¥ä¸€ä¸‹ ï¼Œè¿™ä¸ªkeyå¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´é‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸäº†æ­¤æ—¶å°±ä¼šåˆ é™¤</p><p>é€šè¿‡ä¸Šè¿°ä¸¤ç§æ‰‹æ®µç»“åˆèµ·æ¥ï¼Œä¿è¯è¿‡æœŸçš„keyä¸€å®šä¼šè¢«å¹²æ‰</p><p>ä½†æ˜¯å®é™…ä¸Šè¿™è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ¼æ‰äº†å¾ˆå¤šè¿‡æœŸkeyï¼Œç„¶åä½ ä¹Ÿæ²¡åŠæ—¶å»æŸ¥ï¼Œä¹Ÿå°±æ²¡èµ°æƒ°æ€§åˆ é™¤; æ­¤æ—¶ä¼šèµ°å†…å­˜æ·˜æ±°æœºåˆ¶</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶">æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶<a href="#æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶" class="hash-link" aria-label="æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶çš„ç›´æ¥é“¾æ¥" title="æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ul><li>noeviction(é»˜è®¤ç­–ç•¥)ï¼šå†…å­˜æ»¡äº†, å¯¹äºå†™è¯·æ±‚ä¸å†æä¾›æœåŠ¡ï¼Œç›´æ¥è¿”å›é”™è¯¯, æ²¡äººç”¨</li><li>allkeys-lruï¼šä»æ‰€æœ‰keyä¸­ä½¿ç”¨LRUç®—æ³•è¿›è¡Œæ·˜æ±° (å¸¸ç”¨)</li><li>allkeys-randomï¼šä»æ‰€æœ‰keyä¸­éšæœºæ·˜æ±°æ•°æ® (æ²¡äººç”¨)</li><li>volatile-lruï¼šä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyä¸­ä½¿ç”¨LRUç®—æ³•è¿›è¡Œæ·˜æ±°</li><li>volatile-randomï¼šä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyä¸­éšæœºæ·˜æ±°</li><li>volatile-ttlï¼šåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyä¸­ï¼Œæ ¹æ®keyçš„è¿‡æœŸæ—¶é—´è¿›è¡Œæ·˜æ±°ï¼Œæœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„keyä¼˜å…ˆç§»é™¤</li></ul><p>volatile-xx çš„ä¸€èˆ¬ä¸ç”¨</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å†…å­˜å›æ”¶ç®—æ³•">å†…å­˜å›æ”¶ç®—æ³•<a href="#å†…å­˜å›æ”¶ç®—æ³•" class="hash-link" aria-label="å†…å­˜å›æ”¶ç®—æ³•çš„ç›´æ¥é“¾æ¥" title="å†…å­˜å›æ”¶ç®—æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Redisä¸­é‡‡ç”¨ä¸¤ç§ç®—æ³•è¿›è¡Œå†…å­˜å›æ”¶ï¼Œå¼•ç”¨è®¡æ•°ç®—æ³•ä»¥åŠLRUç®—æ³•;</p><p>å¦‚æœä½¿ç”¨ Redis æ¥ç¼“å­˜æ•°æ®æ—¶ï¼Œè¦ä¿è¯æ‰€æœ‰æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œå¯ä»¥å°†å†…å­˜æœ€å¤§ä½¿ç”¨é‡è®¾ç½®ä¸ºçƒ­ç‚¹æ•°æ®å ç”¨çš„å†…å­˜é‡ï¼Œç„¶åå¯ç”¨ allkeys-lru æ·˜æ±°ç­–ç•¥ï¼Œå°†æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®æ·˜æ±°ã€‚</p><p>ä½œä¸ºå†…å­˜æ•°æ®åº“ï¼Œå‡ºäºå¯¹æ€§èƒ½å’Œå†…å­˜æ¶ˆè€—çš„è€ƒè™‘ï¼ŒRedis çš„æ·˜æ±°ç®—æ³•ï¼ˆLRUã€TTLï¼‰å®é™…å®ç°ä¸Šå¹¶éé’ˆå¯¹æ‰€æœ‰ keyï¼Œè€Œæ˜¯æŠ½æ ·ä¸€å°éƒ¨åˆ† key ä»ä¸­é€‰å‡ºè¢«æ·˜æ±° key.</p><p>LRU(Least Recently Used)ï¼Œå³æœ€è¿‘æœ€å°‘ä½¿ç”¨, æ ¹æ®keyçš„æœ€è¿‘è¢«è®¿é—®çš„é¢‘ç‡è¿›è¡Œæ·˜æ±°ï¼Œå¾ˆå°‘è¢«è®¿é—®çš„ä¼˜å…ˆè¢«æ·˜æ±°ï¼Œè¢«è®¿é—®çš„å¤šçš„åˆ™è¢«ç•™ä¸‹æ¥ã€‚ <a href="https://www.cnblogs.com/lzrabbit/p/3734850.html" target="_blank" rel="noopener noreferrer">Java æä¾›çš„ LinkedHashMap å¯ä»¥å®ç°</a> //todo</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥">å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥<a href="#å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥" class="hash-link" aria-label="å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥çš„ç›´æ¥é“¾æ¥" title="å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é€šè¿‡é…ç½®æ–‡ä»¶">é€šè¿‡é…ç½®æ–‡ä»¶<a href="#é€šè¿‡é…ç½®æ–‡ä»¶" class="hash-link" aria-label="é€šè¿‡é…ç½®æ–‡ä»¶çš„ç›´æ¥é“¾æ¥" title="é€šè¿‡é…ç½®æ–‡ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>é€šè¿‡åœ¨Rediså®‰è£…ç›®å½•ä¸‹é¢çš„redis.conf</p><p>redisçš„é…ç½®æ–‡ä»¶ä¸ä¸€å®šä½¿ç”¨çš„æ˜¯å®‰è£…ç›®å½•ä¸‹é¢çš„redis.confæ–‡ä»¶ï¼Œå¯åŠ¨redisæœåŠ¡çš„æ—¶å€™æ˜¯å¯ä»¥ä¼ ä¸€ä¸ªå‚æ•°æŒ‡å®šredisçš„é…ç½®æ–‡ä»¶çš„</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">//è®¾ç½®Redisæœ€å¤§å ç”¨å†…å­˜å¤§å°ä¸º100M</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">maxmemory 100mb</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ·˜æ±°ç­–ç•¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">maxmemory</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">policy allkeys</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">lru</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Redisä½¿ç”¨çš„æ˜¯è¿‘ä¼¼LRUç®—æ³•ï¼Œå®ƒè·Ÿå¸¸è§„çš„LRUç®—æ³•è¿˜ä¸å¤ªä¸€æ ·ã€‚è¿‘ä¼¼LRUç®—æ³•é€šè¿‡éšæœºé‡‡æ ·æ³•æ·˜æ±°æ•°æ®ï¼Œæ¯æ¬¡éšæœºå‡º5ï¼ˆé»˜è®¤ï¼‰ä¸ªkeyï¼Œä»é‡Œé¢æ·˜æ±°æ‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ä¿®æ”¹é‡‡æ ·æ•°é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">maxmemory</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">samples </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹">é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹<a href="#é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹" class="hash-link" aria-label="é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹çš„ç›´æ¥é“¾æ¥" title="é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Redisæ”¯æŒè¿è¡Œæ—¶é€šè¿‡å‘½ä»¤åŠ¨æ€ä¿®æ”¹å†…å­˜å¤§å°</p><p>æœä¸è®¾ç½®æœ€å¤§å†…å­˜å¤§å°æˆ–è€…è®¾ç½®æœ€å¤§å†…å­˜å¤§å°ä¸º0ï¼Œåœ¨64ä½æ“ä½œç³»ç»Ÿä¸‹ä¸é™åˆ¶å†…å­˜å¤§å°</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">//è®¾ç½®Redisæœ€å¤§å ç”¨å†…å­˜å¤§å°ä¸º100M</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">127.0</span><span class="token number" style="color:rgb(9, 134, 88)">.0</span><span class="token number" style="color:rgb(9, 134, 88)">.1</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token number" style="color:rgb(9, 134, 88)">6379</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> config </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> maxmemory 100mb</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//è·å–è®¾ç½®çš„Redisèƒ½ä½¿ç”¨çš„æœ€å¤§å†…å­˜å¤§å°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">127.0</span><span class="token number" style="color:rgb(9, 134, 88)">.0</span><span class="token number" style="color:rgb(9, 134, 88)">.1</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token number" style="color:rgb(9, 134, 88)">6379</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> config </span><span class="token keyword" style="color:rgb(0, 0, 255)">get</span><span class="token plain"> maxmemory</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config </span><span class="token keyword" style="color:rgb(0, 0, 255)">get</span><span class="token plain"> maxmemory</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">policy</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token plain"> maxmemory</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">policy allkeys</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">lru</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>æŒä¹…åŒ–</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¤‡ä»½é€‰å‹">å¤‡ä»½é€‰å‹<a href="#å¤‡ä»½é€‰å‹" class="hash-link" aria-label="å¤‡ä»½é€‰å‹çš„ç›´æ¥é“¾æ¥" title="å¤‡ä»½é€‰å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Redis çš„æŒä¹…åŒ–æœºåˆ¶æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯å¿«ç…§ï¼ˆRDBï¼‰ï¼Œç¬¬äºŒç§æ˜¯ AOF æ—¥å¿—ã€‚</p><p>å¿«ç…§æ˜¯ä¸€æ¬¡å…¨é‡å¤‡ä»½ï¼ŒAOF æ—¥å¿—æ˜¯è¿ç»­çš„å¢é‡å¤‡ä»½ã€‚å¿«ç…§æ˜¯å†…å­˜æ•°æ®çš„äºŒè¿›åˆ¶åºåˆ—åŒ–å½¢å¼ï¼Œåœ¨å­˜å‚¨ä¸Šéå¸¸ç´§å‡‘ï¼Œè€Œ AOF æ—¥å¿—è®°å½•çš„æ˜¯æ•°æ®ä¿®æ”¹çš„æŒ‡ä»¤æ–‡æœ¬, æœ‰å†—ä½™ã€‚</p><p>RDBæ˜¯é€šè¿‡Redisä¸»è¿›ç¨‹forkå­è¿›ç¨‹ï¼Œè®©å­è¿›ç¨‹æ‰§è¡Œç£ç›˜ IO æ“ä½œæ¥è¿›è¡Œ RDB æŒä¹…åŒ–ï¼ŒAOF æ—¥å¿—å­˜å‚¨çš„æ˜¯ Redis æœåŠ¡å™¨çš„é¡ºåºæŒ‡ä»¤åºåˆ—ï¼ŒAOF æ—¥å¿—åªè®°å½•å¯¹å†…å­˜è¿›è¡Œä¿®æ”¹çš„æŒ‡ä»¤è®°å½•ã€‚å³RDBè®°å½•çš„æ˜¯æ•°æ®ï¼ŒAOFè®°å½•çš„æ˜¯æŒ‡ä»¤</p><p>ä¸è¦ä»…ä»…ä½¿ç”¨ RDBï¼Œå› ä¸ºé‚£æ ·ä¼šå¯¼è‡´ä½ ä¸¢å¤±å¾ˆå¤šæ•°æ®ï¼Œå› ä¸ºRDBæ˜¯éš”ä¸€æ®µæ—¶é—´æ¥å¤‡ä»½æ•°æ®</p><p>ä¹Ÿä¸è¦ä»…ä»…ä½¿ç”¨ AOFï¼Œå› ä¸ºé‚£æ ·æœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ï¼Œé€Ÿåº¦æ…¢; ç¬¬äºŒï¼Œaofæ—¥å¿—æ–‡ä»¶å‡ºbug çš„å‡ ç‡å¤§äº rdbå¿«ç…§çš„äºŒè¿›åˆ¶æ–‡ä»¶</p><p>ç”¨RDBæ¢å¤å†…å­˜çŠ¶æ€ä¼šä¸¢å¤±å¾ˆå¤šæ•°æ®ï¼Œé‡æ”¾AOPæ—¥å¿—åˆå¾ˆæ…¢ã€‚Redis4.0æ¨å‡ºäº†æ··åˆæŒä¹…åŒ–æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å°† rdb æ–‡ä»¶çš„å†…å®¹å’Œå¢é‡çš„ AOF æ—¥å¿—æ–‡ä»¶å­˜åœ¨ä¸€èµ·ã€‚è¿™é‡Œçš„ AOF æ—¥å¿—ä¸å†æ˜¯å…¨é‡çš„æ—¥å¿—ï¼Œè€Œæ˜¯è‡ªæŒä¹…åŒ–å¼€å§‹åˆ°æŒä¹…åŒ–ç»“æŸçš„è¿™æ®µæ—¶é—´å‘ç”Ÿçš„å¢é‡ AOF æ—¥å¿—ï¼Œé€šå¸¸è¿™éƒ¨åˆ† AOF æ—¥å¿—å¾ˆå°ã€‚äºæ˜¯åœ¨ Redis é‡å¯çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆåŠ è½½ rdb çš„å†…å®¹ï¼Œç„¶åå†é‡æ”¾å¢é‡ AOF æ—¥å¿—å°±å¯ä»¥å®Œå…¨æ›¿ä»£ä¹‹å‰çš„ AOF å…¨é‡æ–‡ä»¶é‡æ”¾</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rdb-å¿«ç…§æŒä¹…åŒ–">RDB-å¿«ç…§æŒä¹…åŒ–<a href="#rdb-å¿«ç…§æŒä¹…åŒ–" class="hash-link" aria-label="RDB-å¿«ç…§æŒä¹…åŒ–çš„ç›´æ¥é“¾æ¥" title="RDB-å¿«ç…§æŒä¹…åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rdbæŒä¹…åŒ–æ¦‚å¿µ">RDBæŒä¹…åŒ–æ¦‚å¿µ<a href="#rdbæŒä¹…åŒ–æ¦‚å¿µ" class="hash-link" aria-label="RDBæŒä¹…åŒ–æ¦‚å¿µçš„ç›´æ¥é“¾æ¥" title="RDBæŒä¹…åŒ–æ¦‚å¿µçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å†™æ“ä½œåˆ°è¾¾ä¸€å®šå¯†åº¦, è§¦å‘å¿«ç…§, é¢‘ç‡å¯é…ç½®</p><p>ä¼˜:</p><ul><li>rdbæ–‡ä»¶æ˜¯ç»è¿‡å‹ç¼©çš„äºŒè¿›åˆ¶æ–‡ä»¶, ä½“ç§¯å°</li><li>redisåŠ è½½ rdbæ–‡ä»¶é€Ÿåº¦å¿«äº aof çš„æ–¹å¼</li></ul><p>ç¼ºç‚¹:</p><ul><li><p>rdb æŒä¹…åŒ–æ— æ³•åšåˆ°å®æ—¶æŒä¹…åŒ–</p><p>åˆ©ç”¨å¿«ç…§è¿›è¡Œå¤‡ä»½ã€‚å¦‚æœç³»ç»Ÿå‘ç”Ÿæ•…éšœï¼Œå°†ä¼šä¸¢å¤±æœ€åä¸€æ¬¡åˆ›å»ºå¿«ç…§ä¹‹åçš„æ•°æ®</p></li><li><p>rdb æ–‡ä»¶æ ¼å¼åœ¨ä¸åŒç‰ˆæœ¬redisä¸­æœ‰ä¸åŒ, å…¼å®¹æ€§ä¸å¥½</p></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯">è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯<a href="#è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯" class="hash-link" aria-label="è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯çš„ç›´æ¥é“¾æ¥" title="è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>è‡ªåŠ¨è§¦å‘, æ‰‹åŠ¨è§¦å‘</p><p>å¯¹äºæ‰‹åŠ¨è§¦å‘: <code>save</code> é˜»å¡ redis ç›´åˆ° rdb è¿‡ç¨‹å®Œæˆ, ä¸€èˆ¬ä¸ç”¨;  <code>bgsave</code> ä½¿å¾—redisè¿›ç¨‹åˆ›å»ºæ–°çš„è¿›ç¨‹æ‰§è¡Œ rdbè¿‡ç¨‹, åŸºæœ¬æ²¡æœ‰é˜»å¡</p><p>å¯¹äºè‡ªåŠ¨è§¦å‘: ğŸ“Œ <code>save m n</code> åœ¨ m ç§’å†…, æ•°æ®é›†æœ‰äº† n æ¬¡ä¿®æ”¹, è‡ªåŠ¨è§¦å‘ bgsave; ğŸ“Œ <code>debug reload</code> é‡æ–°åŠ è½½ redis; ğŸ“Œ <code>shutdown</code></p><p>bgsave æµç¨‹ç¤ºæ„å›¾:</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rdbæ–‡ä»¶">RDBæ–‡ä»¶<a href="#rdbæ–‡ä»¶" class="hash-link" aria-label="RDBæ–‡ä»¶çš„ç›´æ¥é“¾æ¥" title="RDBæ–‡ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>rdbæ–‡ä»¶å­˜å‚¨åœ¨ dir é…ç½®æŒ‡å®šçš„ç›®å½•ä¸‹,æ–‡ä»¶åé€šè¿‡ dbfilename é…ç½®æŒ‡å®š</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="aof-æ—¥å¿—æŒä¹…åŒ–">AOF-æ—¥å¿—æŒä¹…åŒ–<a href="#aof-æ—¥å¿—æŒä¹…åŒ–" class="hash-link" aria-label="AOF-æ—¥å¿—æŒä¹…åŒ–çš„ç›´æ¥é“¾æ¥" title="AOF-æ—¥å¿—æŒä¹…åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="aofæ¦‚å¿µ">aofæ¦‚å¿µ<a href="#aofæ¦‚å¿µ" class="hash-link" aria-label="aofæ¦‚å¿µçš„ç›´æ¥é“¾æ¥" title="aofæ¦‚å¿µçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>redisçš„æ¯ä¸ªå†™æ“ä½œéƒ½ä¼šè¢«è¿½åŠ åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­</p><p>å°†å†™å‘½ä»¤æ·»åŠ åˆ° AOF æ–‡ä»¶ï¼ˆAppend Only Fileï¼‰çš„æœ«å°¾ã€‚ --------- ä»¥ç‹¬ç«‹æ—¥å¿—æ–‡ä»¶çš„æ–¹å¼è®°å½•æ¯æ¬¡å†™å‘½ä»¤, è§£å†³äº† RDBæ–¹å¼ä¸èƒ½å®æ—¶æŒä¹…åŒ–çš„é—®é¢˜</p><p>rdb, aofåŒæ—¶å­˜åœ¨æ—¶, redisé‡å¯æ—¶ä¼˜å…ˆè½½å…¥ aof æ–‡ä»¶æ¥æ¢å¤æ•°æ® (aof æ¯” rdb è®°å½•çš„æ•°æ®æ›´å…¨)</p><p>é€šè¿‡ <code>appendonly yes</code> é…ç½® å¼€å¯ aof, aofæ–‡ä»¶åé€šè¿‡ appendfilename é…ç½®è®¾ç½®, é»˜è®¤ä¸º appendonly.aof, ä¿å­˜è·¯å¾„åŒrdbä¸­çš„diré…ç½®</p><p>ç¼–è¾‘ /etc/redis/redis.conf,</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">appendonly yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å†™å…¥åŸç†">å†™å…¥åŸç†<a href="#å†™å…¥åŸç†" class="hash-link" aria-label="å†™å…¥åŸç†çš„ç›´æ¥é“¾æ¥" title="å†™å…¥åŸç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ä»¥ <code>æ–‡æœ¬æ–¹å¼</code>å†™å…¥ <code>aofç¼“å­˜åŒº</code> , ç„¶åç”±æ“ä½œç³»ç»Ÿå†³å®šä»€ä¹ˆæ—¶å€™å°†è¯¥å†…å®¹åŒæ­¥åˆ°ç¡¬ç›˜ï¼Œç”¨æˆ·å¯ä»¥è°ƒç”¨ file.flush() æ–¹æ³•è¯·æ±‚æ“ä½œç³»ç»Ÿå°½å¿«å°†ç¼“å†²åŒºå­˜å‚¨çš„æ•°æ®åŒæ­¥åˆ°ç¡¬ç›˜ã€‚å¯ä»¥çœ‹å‡º <code>å†™å…¥æ–‡ä»¶çš„æ•°æ®ä¸ä¼šç«‹å³åŒæ­¥åˆ°ç¡¬ç›˜</code>ä¸Šï¼Œåœ¨å°†å†™å‘½ä»¤æ·»åŠ åˆ° AOF æ–‡ä»¶æ—¶ï¼Œè¦æ ¹æ®éœ€æ±‚æ¥ä¿è¯ä½•æ—¶åŒæ­¥åˆ°ç¡¬ç›˜ä¸Šã€‚</p><ul><li>ä¸ºä»€ä¹ˆä½¿ç”¨æ–‡æœ¬æ ¼å¼? ğŸ“Œ æ–‡æœ¬æ ¼å¼å…·æœ‰å¾ˆå¥½çš„å…¼å®¹æ€§; ğŸ“Œ æ–‡æœ¬æ ¼å¼å¾ˆå®¹æ˜“å¤„ç†è¿½åŠ æ“ä½œ; ğŸ“Œ å¯è¯»æ€§, ç›´æ¥ä¿®æ”¹å¤„ç†;</li><li>ä¸ºä»€ä¹ˆå‘½ä»¤å†™å…¥éœ€è¦å…ˆåŠ å…¥&quot;aofç¼“å­˜åŒº&quot;? ğŸ“Œ redisæ˜¯å•çº¿ç¨‹æ‰§è¡Œå‘½ä»¤, å¦‚æœä¸ä½¿ç”¨&quot;ç¼“å­˜åŒº&quot;, è€Œæ˜¯ç›´æ¥å†™å…¥åˆ°ç¡¬ç›˜, åˆ™ç¡¬ç›˜è¯»å†™é€Ÿåº¦ä¼šæˆä¸ºç“¶é¢ˆ; ğŸ“Œ redis å¯ä½¿ç”¨å¤šç§ä¸é€šè¿‡çš„ ç¼“å­˜åŒº-ç¡¬ç›˜ åŒæ­¥ç­–ç•¥, åœ¨æ€§èƒ½å’Œå®‰å…¨ä¸­åšå‡ºå¹³è¡¡.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ–‡ä»¶åŒæ­¥">æ–‡ä»¶åŒæ­¥<a href="#æ–‡ä»¶åŒæ­¥" class="hash-link" aria-label="æ–‡ä»¶åŒæ­¥çš„ç›´æ¥é“¾æ¥" title="æ–‡ä»¶åŒæ­¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æœ‰ä¸‰ä¸ªåŒæ­¥é€‰é¡¹:</p><ul><li>always æ¯ä¸ªå†™å‘½ä»¤éƒ½åŒæ­¥ (always é€‰é¡¹ä¼šä¸¥é‡å‡ä½æœåŠ¡å™¨çš„æ€§èƒ½)</li><li>everysec æ¯ç§’åŒæ­¥ä¸€æ¬¡ (everysec é€‰é¡¹æ¯”è¾ƒåˆé€‚ï¼Œå¯ä»¥ä¿è¯ç³»ç»Ÿå¥”æºƒæ—¶åªä¼šä¸¢å¤±ä¸€ç§’å·¦å³çš„æ•°æ®ï¼Œå¹¶ä¸” Redis æ¯ç§’æ‰§è¡Œä¸€æ¬¡åŒæ­¥å¯¹æœåŠ¡å™¨æ€§èƒ½å‡ ä¹æ²¡æœ‰ä»»ä½•å½±å“)</li><li>no è®©æ“ä½œç³»ç»Ÿæ¥å†³å®šä½•æ—¶åŒæ­¥ (no é€‰é¡¹å¹¶ä¸èƒ½ç»™æœåŠ¡å™¨æ€§èƒ½å¸¦æ¥å¤šå¤§çš„æå‡ï¼Œè€Œä¸”ä¹Ÿä¼šå¢åŠ ç³»ç»Ÿå¥”æºƒæ—¶æ•°æ®ä¸¢å¤±çš„æ•°é‡)</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é‡å†™æœºåˆ¶">é‡å†™æœºåˆ¶<a href="#é‡å†™æœºåˆ¶" class="hash-link" aria-label="é‡å†™æœºåˆ¶çš„ç›´æ¥é“¾æ¥" title="é‡å†™æœºåˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>éšç€æœåŠ¡å™¨å†™è¯·æ±‚çš„å¢å¤šï¼ŒAOF æ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ã€‚Redis æä¾›äº†ä¸€ç§å°† AOF é‡å†™çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿå»é™¤ AOF æ–‡ä»¶ä¸­çš„å†—ä½™å†™å‘½ä»¤ã€‚å‹ç¼©æ–‡ä»¶ä½“ç§¯.</p><p>é‡å†™çš„æ„ä¹‰:</p><ul><li>è¿›ç¨‹å†…è¶…æ—¶å‘½ä»¤ä¸ä¼šå†å†™å…¥</li><li>æ— æ•ˆå‘½ä»¤ä¸å†å†™å…¥, åªå†™å…¥ç”Ÿæˆæœ€ç»ˆæ•°æ®çš„å‘½ä»¤</li><li>å¤šæ¡å†™å‘½ä»¤å¯ä»¥åˆå¹¶</li></ul><p>å¦‚ä½•è§¦å‘é‡å†™:</p><ul><li>æ‰‹åŠ¨è§¦å‘: <code>bgrewriteaof</code></li><li>è‡ªåŠ¨è§¦å‘:</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="aof-æŸå">aof æŸå<a href="#aof-æŸå" class="hash-link" aria-label="aof æŸåçš„ç›´æ¥é“¾æ¥" title="aof æŸåçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>åŠ è½½æŸåçš„aof æ–‡ä»¶ä¼šå¯åŠ¨å¤±è´¥; è¿™æ˜¯å¯ä»¥å…ˆå¤‡ä»½è¿™ä¸ªæ–‡ä»¶ç„¶åå°è¯•é€šè¿‡ <code>redis-check-aof-fix</code> ä¿®å¤</p><h1>å‘å¸ƒä¸è®¢é˜…</h1><p>è®¢é˜…è€…è®¢é˜…äº†é¢‘é“ä¹‹åï¼Œå‘å¸ƒè€…å‘é¢‘é“å‘é€å­—ç¬¦ä¸²æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰è®¢é˜…è€…æ¥æ”¶åˆ° (æŸä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ SUBSCRIBE è®¢é˜…ä¸€ä¸ªé¢‘é“ï¼Œå…¶å®ƒå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ PUBLISH å‘è¿™ä¸ªé¢‘é“å‘é€æ¶ˆæ¯ã€‚)</p><p>å‘å¸ƒä¸è®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼æœ‰ä»¥ä¸‹ä¸åŒ:</p><ul><li>è§‚å¯Ÿè€…æ¨¡å¼ä¸­ï¼Œè§‚å¯Ÿè€…å’Œä¸»é¢˜éƒ½çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼›è€Œåœ¨å‘å¸ƒä¸è®¢é˜…æ¨¡å¼ä¸­ï¼Œå‘å¸ƒè€…ä¸è®¢é˜…è€…ä¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡é¢‘é“è¿›è¡Œé€šä¿¡ã€‚</li><li>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯åŒæ­¥çš„ï¼Œå½“äº‹ä»¶è§¦å‘æ—¶ï¼Œä¸»é¢˜ä¼šå»è°ƒç”¨è§‚å¯Ÿè€…çš„æ–¹æ³•ï¼Œç„¶åç­‰å¾…æ–¹æ³•è¿”å›ï¼›è€Œå‘å¸ƒä¸è®¢é˜…æ¨¡å¼æ˜¯å¼‚æ­¥çš„ï¼Œå‘å¸ƒè€…å‘é¢‘é“å‘é€ä¸€ä¸ªæ¶ˆæ¯ä¹‹åï¼Œå°±ä¸éœ€è¦å…³å¿ƒè®¢é˜…è€…ä½•æ—¶å»è®¢é˜…è¿™ä¸ªæ¶ˆæ¯ã€‚</li></ul><h1>äº‹åŠ¡</h1><p>Redis æœ€ç®€å•çš„äº‹åŠ¡å®ç°æ–¹å¼æ˜¯ä½¿ç”¨ MULTI å’Œ EXEC å‘½ä»¤å°†äº‹åŠ¡æ“ä½œåŒ…å›´èµ·æ¥ã€‚</p><p>redisäº‹åŠ¡åœ¨æ‰§è¡Œçš„ä¸­é€”é‡åˆ°é”™è¯¯ï¼Œä¸ä¼šå›æ»šè€Œæ˜¯ç»§ç»­æ‰§è¡Œåç»­å‘½ä»¤ï¼›ï¼ˆè¿ååŸå­æ€§ï¼‰ .é‚£ä¹ˆredisä¸ºä»€ä¹ˆè¿˜è¦äº‹åŠ¡å‘¢? - äº‹åŠ¡ä¸­çš„å¤šä¸ªå‘½ä»¤è¢«ä¸€æ¬¡æ€§å‘é€ç»™æœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯ä¸€æ¡ä¸€æ¡å‘é€ï¼Œè¿™ç§æ–¹å¼è¢«ç§°ä¸ºæµæ°´çº¿ï¼Œå®ƒå¯ä»¥å‡å°‘å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œé€šä¿¡æ¬¡æ•°ä»è€Œæå‡æ€§èƒ½ã€‚</p><p>redisäº‹åŠ¡ä¸­çš„å‘½ä»¤åœ¨æ‰§è¡Œexecå‘½ä»¤å‰ä¼šè¢«æ”¾å…¥é˜Ÿåˆ—, å¹¶ä¸ä¼šå®é™…æ‰§è¡Œ, ä¹Ÿå°±ä¸å­˜åœ¨éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</p><p>watch key1 key2... : ç±»ä¼¼äºä¹è§‚é”, å¦‚æœæŸä¸ªäº‹åŠ¡æäº¤æ—¶, æœ‰å…¶ä»–client æ”¹å˜äº†ä»»æ„ä¸€ä¸ª key, åˆ™ä½¿ç”¨ exec æ‰§è¡Œäº‹åŠ¡æ—¶, äº‹åŠ¡é˜Ÿåˆ—ä¸ä¼šè¢«æ‰§è¡Œ;</p><h1>äº‹ä»¶</h1><p>Redis æœåŠ¡å™¨æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ç¨‹åºã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ–‡ä»¶äº‹ä»¶">æ–‡ä»¶äº‹ä»¶<a href="#æ–‡ä»¶äº‹ä»¶" class="hash-link" aria-label="æ–‡ä»¶äº‹ä»¶çš„ç›´æ¥é“¾æ¥" title="æ–‡ä»¶äº‹ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æœåŠ¡å™¨é€šè¿‡å¥—æ¥å­—ä¸å®¢æˆ·ç«¯æˆ–è€…å…¶å®ƒæœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œæ–‡ä»¶äº‹ä»¶å°±æ˜¯å¯¹å¥—æ¥å­—æ“ä½œçš„æŠ½è±¡ã€‚</p><p>Redis åŸºäº Reactor æ¨¡å¼å¼€å‘äº†è‡ªå·±çš„ç½‘ç»œäº‹ä»¶å¤„ç†å™¨ï¼Œä½¿ç”¨ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œå¹¶å°†åˆ°è¾¾çš„äº‹ä»¶ä¼ é€ç»™æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ï¼Œåˆ†æ´¾å™¨ä¼šæ ¹æ®å¥—æ¥å­—äº§ç”Ÿçš„äº‹ä»¶ç±»å‹è°ƒç”¨ç›¸åº”çš„äº‹ä»¶å¤„ç†å™¨ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ—¶é—´äº‹ä»¶">æ—¶é—´äº‹ä»¶<a href="#æ—¶é—´äº‹ä»¶" class="hash-link" aria-label="æ—¶é—´äº‹ä»¶çš„ç›´æ¥é“¾æ¥" title="æ—¶é—´äº‹ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æœåŠ¡å™¨æœ‰ä¸€äº›æ“ä½œéœ€è¦åœ¨ç»™å®šçš„æ—¶é—´ç‚¹æ‰§è¡Œï¼Œæ—¶é—´äº‹ä»¶æ˜¯å¯¹è¿™ç±»å®šæ—¶æ“ä½œçš„æŠ½è±¡ã€‚</p><p>æ—¶é—´äº‹ä»¶åˆåˆ†ä¸ºï¼šå®šæ—¶äº‹ä»¶, å‘¨æœŸäº‹ä»¶</p><p>Redis å°†æ‰€æœ‰æ—¶é—´äº‹ä»¶éƒ½æ”¾åœ¨ä¸€ä¸ªæ— åºé“¾è¡¨ä¸­ï¼Œé€šè¿‡éå†æ•´ä¸ªé“¾è¡¨æŸ¥æ‰¾å‡ºå·²åˆ°è¾¾çš„æ—¶é—´äº‹ä»¶ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„äº‹ä»¶å¤„ç†å™¨ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="äº‹ä»¶çš„è°ƒåº¦æ‰§è¡Œ">äº‹ä»¶çš„è°ƒåº¦&amp;æ‰§è¡Œ<a href="#äº‹ä»¶çš„è°ƒåº¦æ‰§è¡Œ" class="hash-link" aria-label="äº‹ä»¶çš„è°ƒåº¦&amp;æ‰§è¡Œçš„ç›´æ¥é“¾æ¥" title="äº‹ä»¶çš„è°ƒåº¦&amp;æ‰§è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h1>redisé›†ç¾¤</h1><p>é€šè¿‡ä½¿ç”¨ slaveof host port å‘½ä»¤æ¥è®©ä¸€ä¸ªæœåŠ¡å™¨æˆä¸ºå¦ä¸€ä¸ªæœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ã€‚</p><p>ä¸€ä¸ªä»æœåŠ¡å™¨åªèƒ½æœ‰ä¸€ä¸ªä¸»æœåŠ¡å™¨ï¼Œå¹¶ä¸”ä¸æ”¯æŒä¸»ä¸»å¤åˆ¶ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="è¿æ¥è¿‡ç¨‹">è¿æ¥è¿‡ç¨‹<a href="#è¿æ¥è¿‡ç¨‹" class="hash-link" aria-label="è¿æ¥è¿‡ç¨‹çš„ç›´æ¥é“¾æ¥" title="è¿æ¥è¿‡ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ol><li>ä¸»æœåŠ¡å™¨åˆ›å»ºå¿«ç…§æ–‡ä»¶ï¼Œå‘é€ç»™ä»æœåŠ¡å™¨ï¼Œå¹¶åœ¨å‘é€æœŸé—´ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ‰§è¡Œçš„å†™å‘½ä»¤ã€‚å¿«ç…§æ–‡ä»¶å‘é€å®Œæ¯•ä¹‹åï¼Œå¼€å§‹å‘ä»æœåŠ¡å™¨å‘é€å­˜å‚¨åœ¨ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ï¼›</li><li>ä»æœåŠ¡å™¨ä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥ä¸»æœåŠ¡å™¨å‘æ¥çš„å¿«ç…§æ–‡ä»¶ï¼Œä¹‹åä»æœåŠ¡å™¨å¼€å§‹æ¥å—ä¸»æœåŠ¡å™¨å‘æ¥çš„å†™å‘½ä»¤ï¼›</li><li>ä¸»æœåŠ¡å™¨æ¯æ‰§è¡Œä¸€æ¬¡å†™å‘½ä»¤ï¼Œå°±å‘ä»æœåŠ¡å™¨å‘é€ç›¸åŒçš„å†™å‘½ä»¤ã€‚</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä¸»ä»é“¾">ä¸»ä»é“¾<a href="#ä¸»ä»é“¾" class="hash-link" aria-label="ä¸»ä»é“¾çš„ç›´æ¥é“¾æ¥" title="ä¸»ä»é“¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>éšç€è´Ÿè½½ä¸æ–­ä¸Šå‡ï¼Œä¸»æœåŠ¡å™¨å¯èƒ½æ— æ³•å¾ˆå¿«åœ°æ›´æ–°æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œæˆ–è€…é‡æ–°è¿æ¥å’Œé‡æ–°åŒæ­¥ä»æœåŠ¡å™¨å°†å¯¼è‡´ç³»ç»Ÿè¶…è½½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªä¸­é—´å±‚æ¥åˆ†æ‹…ä¸»æœåŠ¡å™¨çš„å¤åˆ¶å·¥ä½œã€‚ä¸­é—´å±‚çš„æœåŠ¡å™¨æ˜¯æœ€ä¸Šå±‚æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ï¼Œåˆæ˜¯æœ€ä¸‹å±‚æœåŠ¡å™¨çš„ä¸»æœåŠ¡å™¨ã€‚</p><h1>å“¨å…µ Sentinel</h1><p>ä¸‹çº¿æ¨ä¸¾</p><p>Sentinelï¼ˆå“¨å…µï¼‰å¯ä»¥ç›‘å¬ä¸»æœåŠ¡å™¨ï¼Œå¹¶åœ¨ä¸»æœåŠ¡å™¨è¿›å…¥ä¸‹çº¿çŠ¶æ€æ—¶ï¼Œè‡ªåŠ¨ä»ä»æœåŠ¡å™¨ä¸­é€‰ä¸¾å‡ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</p><p><a href="https://blog.csdn.net/m0_37635053/article/details/114196390" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/m0_37635053/article/details/114196390</a></p><p><a href="http://c.biancheng.net/view/4567.html" target="_blank" rel="noopener noreferrer">http://c.biancheng.net/view/4567.html</a></p><p><a href="https://juejin.cn/post/6995794821805768718" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6995794821805768718</a></p><h1>åˆ†ç‰‡</h1><p>åˆ†ç‰‡æ˜¯å°†æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†çš„æ–¹æ³•ï¼Œå¯ä»¥å°†æ•°æ®å­˜å‚¨åˆ°å¤šå°æœºå™¨é‡Œé¢ï¼Œä¹Ÿå¯ä»¥ä»å¤šå°æœºå™¨é‡Œé¢è·å–æ•°æ®ï¼Œ</p><blockquote><p>å‡è®¾æœ‰ 4 ä¸ª Reids å®ä¾‹ R0ï¼ŒR1ï¼ŒR2ï¼ŒR3ï¼Œè¿˜æœ‰å¾ˆå¤šè¡¨ç¤ºç”¨æˆ·çš„é”® user:1ï¼Œuser:2ï¼Œ... ç­‰ç­‰ï¼Œæœ‰ä¸åŒçš„æ–¹å¼æ¥é€‰æ‹©ä¸€ä¸ªæŒ‡å®šçš„é”®å­˜å‚¨åœ¨å“ªä¸ªå®ä¾‹ä¸­ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯èŒƒå›´åˆ†ç‰‡ï¼Œä¾‹å¦‚ç”¨æˆ· id ä» 0~1000 çš„å­˜å‚¨åˆ°å®ä¾‹ R0 ä¸­ï¼Œç”¨æˆ· id ä» 1001~2000 çš„å­˜å‚¨åˆ°å®ä¾‹ R1 ä¸­ï¼Œç­‰ç­‰ã€‚ä½†æ˜¯è¿™æ ·éœ€è¦ç»´æŠ¤ä¸€å¼ æ˜ å°„èŒƒå›´è¡¨ï¼Œç»´æŠ¤æ“ä½œä»£ä»·å¾ˆé«˜ã€‚è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯å“ˆå¸Œåˆ†ç‰‡ï¼Œä½¿ç”¨ CRC32 å“ˆå¸Œå‡½æ•°å°†é”®è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå†å¯¹å®ä¾‹æ•°é‡æ±‚æ¨¡å°±èƒ½çŸ¥é“åº”è¯¥å­˜å‚¨çš„å®ä¾‹ã€‚</p></blockquote><p>æ ¹æ®æ‰§è¡Œåˆ†ç‰‡çš„ä½ç½®ï¼Œå¯ä»¥åˆ†ä¸ºä¸‰ç§åˆ†ç‰‡æ–¹å¼ï¼š</p><ul><li>å®¢æˆ·ç«¯åˆ†ç‰‡ï¼šå®¢æˆ·ç«¯ä½¿ç”¨ <a href="#%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C">#ä¸€è‡´æ€§å“ˆå¸Œ</a> ç­‰ç®—æ³•å†³å®šé”®åº”å½“åˆ†å¸ƒåˆ°å“ªä¸ªèŠ‚ç‚¹ã€‚</li><li>ä»£ç†åˆ†ç‰‡ï¼šå°†å®¢æˆ·ç«¯è¯·æ±‚å‘é€åˆ°ä»£ç†ä¸Šï¼Œç”±ä»£ç†è½¬å‘è¯·æ±‚åˆ°æ­£ç¡®çš„èŠ‚ç‚¹ä¸Šã€‚</li><li>æœåŠ¡å™¨åˆ†ç‰‡ï¼šRedis Clusterã€‚</li></ul><h1>ä¸€ä¸ªç®€å•çš„è®ºå›ç³»ç»Ÿ</h1><p>è¯¥è®ºå›ç³»ç»ŸåŠŸèƒ½å¦‚ä¸‹:</p><ul><li>å¯ä»¥å‘å¸ƒæ–‡ç« ï¼›</li><li>å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œç‚¹èµï¼›</li><li>åœ¨é¦–é¡µå¯ä»¥æŒ‰æ–‡ç« çš„å‘å¸ƒæ—¶é—´æˆ–è€…æ–‡ç« çš„ç‚¹èµæ•°è¿›è¡Œæ’åºæ˜¾ç¤ºã€‚</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ–‡ç« ä¿¡æ¯">æ–‡ç« ä¿¡æ¯<a href="#æ–‡ç« ä¿¡æ¯" class="hash-link" aria-label="æ–‡ç« ä¿¡æ¯çš„ç›´æ¥é“¾æ¥" title="æ–‡ç« ä¿¡æ¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ–‡ç« åŒ…æ‹¬æ ‡é¢˜ã€ä½œè€…ã€èµæ•°ç­‰ä¿¡æ¯ï¼Œåœ¨å…³ç³»å‹æ•°æ®åº“ä¸­å¾ˆå®¹æ˜“æ„å»ºä¸€å¼ è¡¨æ¥å­˜å‚¨è¿™äº›ä¿¡æ¯ï¼Œåœ¨ Redis ä¸­å¯ä»¥ä½¿ç”¨ HASH æ¥å­˜å‚¨æ¯ç§ä¿¡æ¯ä»¥åŠå…¶å¯¹åº”çš„å€¼çš„æ˜ å°„ã€‚</p><p>Redis æ²¡æœ‰å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨è¿™ä¸€æ¦‚å¿µæ¥å°†åŒç§ç±»å‹çš„æ•°æ®å­˜æ”¾åœ¨ä¸€èµ·ï¼Œè€Œæ˜¯ä½¿ç”¨å‘½åç©ºé—´çš„æ–¹å¼æ¥å®ç°è¿™ä¸€åŠŸèƒ½ã€‚é”®åçš„å‰é¢éƒ¨åˆ†å­˜å‚¨å‘½åç©ºé—´ï¼Œåé¢éƒ¨åˆ†çš„å†…å®¹å­˜å‚¨ IDï¼Œé€šå¸¸ä½¿ç”¨ : æ¥è¿›è¡Œåˆ†éš”ã€‚ä¾‹å¦‚ä¸‹é¢çš„ HASH çš„é”®åä¸º article:92617ï¼Œå…¶ä¸­ article ä¸ºå‘½åç©ºé—´ï¼ŒID ä¸º 92617ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç‚¹èµåŠŸèƒ½">ç‚¹èµåŠŸèƒ½<a href="#ç‚¹èµåŠŸèƒ½" class="hash-link" aria-label="ç‚¹èµåŠŸèƒ½çš„ç›´æ¥é“¾æ¥" title="ç‚¹èµåŠŸèƒ½çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ç‚¹èµã€å–æ¶ˆç‚¹èµæ˜¯é«˜é¢‘æ¬¡çš„æ“ä½œï¼Œè‹¥æ¯æ¬¡éƒ½è¯»å†™æ•°æ®åº“ï¼Œå¤§é‡çš„æ“ä½œä¼šå½±å“æ•°æ®åº“æ€§èƒ½ï¼Œæ‰€ä»¥éœ€è¦åšç¼“å­˜</p><p>å®šæ—¶ä» redis ä¸­å–å‡ºç‚¹èµæ•°æ®æŒä¹…åŒ–å­˜å…¥ db, æ¯”å¦‚ 2h</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¯¹æ–‡ç« è¿›è¡Œæ’åº">å¯¹æ–‡ç« è¿›è¡Œæ’åº<a href="#å¯¹æ–‡ç« è¿›è¡Œæ’åº" class="hash-link" aria-label="å¯¹æ–‡ç« è¿›è¡Œæ’åºçš„ç›´æ¥é“¾æ¥" title="å¯¹æ–‡ç« è¿›è¡Œæ’åºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h1>ä¸€è‡´æ€§å“ˆå¸Œ</h1><p>//todo</p><h1>æ•´åˆ spring boot2</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jedis">jedis<a href="#jedis" class="hash-link" aria-label="jedisçš„ç›´æ¥é“¾æ¥" title="jedisçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>é¡¹ç›®åœ°å€: <a href="https://github.com/xetorthio/jedis" target="_blank" rel="noopener noreferrer">https://github.com/xetorthio/jedis</a></p><p>Jedis å®ä¾‹æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„, ä¸ºä»€ä¹ˆ?</p><ul><li>Jedisç±»ä¸­æœ‰RedisInputStreamå’ŒRedisOutputStreamä¸¤ä¸ªå±æ€§ï¼Œè€Œå‘é€å‘½ä»¤å’Œè·å–è¿”å›å€¼éƒ½æ˜¯ä½¿ç”¨è¿™ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼Œæ˜¾ç„¶ï¼Œè¿™å¾ˆå®¹æ˜“å¼•å‘å¤šçº¿ç¨‹é—®é¢˜ã€‚</li></ul><p>å¯ä»¥é€šè¿‡JedisPoolè¿æ¥æ± å»ç®¡ç†å®ä¾‹ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹è®©æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„jediså®ä¾‹ æ¥å®ç°çº¿ç¨‹å®‰å…¨</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="lettuce">lettuce<a href="#lettuce" class="hash-link" aria-label="lettuceçš„ç›´æ¥é“¾æ¥" title="lettuceçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://www.cnblogs.com/throwable/p/11601538.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/throwable/p/11601538.html</a> - ä½¿ç”¨</p><p>spring boot2 é»˜è®¤ä½¿ç”¨</p><p>Lettuce åŸºäº netty, çº¿ç¨‹å®‰å…¨, å¤§ååé‡,</p><p>éœ€è¦æ·»åŠ ä¾èµ– <code>common-pool2</code>, ç”¨äºæä¾›è¿æ¥æ± , <a href="https://blog.csdn.net/qq447995687/article/details/80233621" target="_blank" rel="noopener noreferrer">è‡ªå®šä¹‰å¯¹è±¡è¿æ¥æ± </a> //todo</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">spring</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">application</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">demo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">cache</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># å•ç‹¬ä¸ºä¸åŒçš„ç¼“å­˜å¯ä»¥é…ç½®ä¸åŒçš„è¶…æ—¶æ—¶é—´</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">time-to-live</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20000</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">#é»˜è®¤ç¼“å­˜è¶…æ—¶æ—¶é—´, ms</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">cache-null-values</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">#æ˜¯å¦ç¼“å­˜ç©ºå€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6379</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> localhost</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">lettuce</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">pool</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">max-active</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">max-wait</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">-1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">max-idle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">min-idle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">timeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10000</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">#redis è¿æ¥è¶…æ—¶æ—¶é—´ms</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä½†æ˜¯æœ‰ä¸ªbug, å¯¼è‡´åœ¨é«˜å¹¶å‘ä¸‹,  netty äº§ç”Ÿå †å¤–å†…å­˜æº¢å‡º OutOfDirectMemoryError; è¿™ä¸ª bug æ˜¯: è‹¥ä¸æŒ‡å®š nettyå †å¤–å†…å­˜ç”¨é‡, é»˜è®¤ä¼šé‡‡ç”¨ -Xmx çš„å€¼, è¿™ä¸ªå€¼æ˜¯ä¸€å®šçš„, ä½†æ˜¯å †å¤–å†…å­˜ä¸ä¼šåŠæ—¶é‡Šæ”¾, æ‰€ä»¥ä¸ç®¡ -Xmx è®¾ç½®å¤šå¤§, æ€»æ˜¯ä¼šç”¨å®Œ, OutOfDirectMemoryError, æ¨è jedis æ›¿ä»£ (<a href="https://github.com/seata/seata/issues/2164" target="_blank" rel="noopener noreferrer">https://github.com/seata/seata/issues/2164</a>)</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">spring-boot-starter-data-redis</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">exclusions</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">exclusion</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">io.lettuce</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">lettuce-core</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">exclusion</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">exclusions</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">redis.clients</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">jedis</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å®šä¹‰åºåˆ—åŒ–å™¨">å®šä¹‰åºåˆ—åŒ–å™¨<a href="#å®šä¹‰åºåˆ—åŒ–å™¨" class="hash-link" aria-label="å®šä¹‰åºåˆ—åŒ–å™¨çš„ç›´æ¥é“¾æ¥" title="å®šä¹‰åºåˆ—åŒ–å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://blog.csdn.net/bai_bug/article/details/81222519" target="_blank" rel="noopener noreferrer">GenericJackson2JsonRedisSerializer Jackson2JsonRedisSerializer åŒºåˆ«</a> - å‰è€…å¯ä»¥ç›´æ¥ä»redis ååºåˆ—åŒ–æˆå¯¹è±¡, ä½†æ˜¯å ç”¨å†…å­˜é«˜ (ä½¿ç”¨GenericJackson2JsonRedisSerializeråºåˆ—åŒ–æ—¶ï¼Œä¼šä¿å­˜åºåˆ—åŒ–çš„å¯¹è±¡çš„åŒ…åå’Œç±»åï¼Œååºåˆ—åŒ–æ—¶ä»¥è¿™ä¸ªä½œä¸ºæ ‡ç¤ºå°±å¯ä»¥ååºåˆ—åŒ–æˆæŒ‡å®šçš„å¯¹è±¡)</p><h1>é¢è¯•é—®é¢˜</h1><p><a href="https://blog.csdn.net/varyall/article/details/81205183" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/varyall/article/details/81205183</a> //todo</p><h1>åˆ†å¸ƒå¼é”</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å®ç°åŸç†">å®ç°åŸç†<a href="#å®ç°åŸç†" class="hash-link" aria-label="å®ç°åŸç†çš„ç›´æ¥é“¾æ¥" title="å®ç°åŸç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚">åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚<a href="#åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚" class="hash-link" aria-label="åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚çš„ç›´æ¥é“¾æ¥" title="åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><p>äº’æ–¥</p><p>åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—é”</p></li><li><p>é˜²æ­¢æ­»é” (å³è¦èƒ½å¤Ÿè®¾ç½®é”æœ‰æ•ˆæ—¶é—´)</p><p>æ¯”å¦‚æœ‰ä¸ªçº¿ç¨‹è·å¾—é”çš„åŒæ—¶ï¼Œè¿˜æ²¡æœ‰æ¥å¾—åŠå»é‡Šæ”¾é”ï¼Œå°±å› ä¸ºç³»ç»Ÿæ•…éšœæˆ–è€…å…¶å®ƒåŸå› ä½¿å®ƒæ— æ³•æ‰§è¡Œé‡Šæ”¾é”çš„å‘½ä»¤,å¯¼è‡´å…¶å®ƒçº¿ç¨‹éƒ½æ— æ³•è·å¾—é”</p></li><li><p>é”æœ€å¥½æ»¡è¶³å¯é‡å…¥</p><p>åŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥é‡å¤æ‹¿åˆ°åŒä¸€ä¸ªèµ„æºçš„é”ã€‚é‡å…¥é”éå¸¸æœ‰åˆ©äºèµ„æºçš„é«˜æ•ˆåˆ©ç”¨</p></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åŠ é”æœºåˆ¶">åŠ é”æœºåˆ¶<a href="#åŠ é”æœºåˆ¶" class="hash-link" aria-label="åŠ é”æœºåˆ¶çš„ç›´æ¥é“¾æ¥" title="åŠ é”æœºåˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>çº¿ç¨‹å»è·å–é”ï¼Œè·å–æˆåŠŸ: æ‰§è¡Œluaè„šæœ¬ï¼Œä¿å­˜æ•°æ®åˆ°redisæ•°æ®åº“ã€‚ä¿å­˜æˆåŠŸåˆ™è¡¨ç¤ºè·å–é”æˆåŠŸ</p><p>çº¿ç¨‹å»è·å–é”ï¼Œè·å–å¤±è´¥: ä¸€ç›´é€šè¿‡whileå¾ªç¯å°è¯•è·å–é”ï¼Œè·å–æˆåŠŸåï¼Œæ‰§è¡Œluaè„šæœ¬ï¼Œä¿å­˜æ•°æ®åˆ°redisæ•°æ®åº“ã€‚</p><p>ä¸ºä»€ä¹ˆä½¿ç”¨ lua:
å¦‚æœä½ çš„ä¸šåŠ¡é€»è¾‘å¤æ‚çš„è¯ï¼Œé€šè¿‡å°è£…åœ¨luaè„šæœ¬ä¸­å‘é€ç»™redisï¼Œè€Œä¸”redisæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™æ ·å°±ä¿è¯è¿™æ®µå¤æ‚ä¸šåŠ¡é€»è¾‘æ‰§è¡Œçš„åŸå­æ€§</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="watch-dog-è‡ªåŠ¨å»¶æ—¶æœºåˆ¶">watch dog è‡ªåŠ¨å»¶æ—¶æœºåˆ¶<a href="#watch-dog-è‡ªåŠ¨å»¶æ—¶æœºåˆ¶" class="hash-link" aria-label="watch dog è‡ªåŠ¨å»¶æ—¶æœºåˆ¶çš„ç›´æ¥é“¾æ¥" title="watch dog è‡ªåŠ¨å»¶æ—¶æœºåˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>&quot;çœ‹é—¨ç‹—&quot; ç”¨äºè¿™æ ·çš„åœºæ™¯: çº¿ç¨‹1 è·å¾—é”, è¿‡äº†æ®µæ—¶é—´, ä¸šåŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œé”çš„è¿‡æœŸæ—¶é—´å°±åˆ°äº†ï¼Œçº¿ç¨‹1 è¿˜æƒ³æŒæœ‰é”çš„è¯ï¼Œå°±ä¼šå¯åŠ¨ä¸€ä¸ªwatch dogåå°çº¿ç¨‹ï¼Œä¸æ–­çš„å»¶é•¿é”keyçš„ç”Ÿå­˜æ—¶é—´</p><p>é»˜è®¤è¿™ä¸ªçœ‹é—¨ç‹—çº¿ç¨‹æ˜¯ä¸å¯åŠ¨çš„ï¼Œè¿˜æœ‰å°±æ˜¯è¿™ä¸ªçœ‹é—¨ç‹—å¯åŠ¨åå¯¹æ•´ä½“æ€§èƒ½ä¹Ÿä¼šæœ‰ä¸€å®šå½±å“ï¼Œæ‰€ä»¥ä¸å»ºè®®å¼€å¯çœ‹é—¨ç‹—ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redisson-å¦‚ä½•å®ç°å¯é‡å…¥é”">redisson å¦‚ä½•å®ç°å¯é‡å…¥é”<a href="#redisson-å¦‚ä½•å®ç°å¯é‡å…¥é”" class="hash-link" aria-label="redisson å¦‚ä½•å®ç°å¯é‡å…¥é”çš„ç›´æ¥é“¾æ¥" title="redisson å¦‚ä½•å®ç°å¯é‡å…¥é”çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Rediså­˜å‚¨é”çš„æ•°æ®ç±»å‹æ˜¯ Hashç±»å‹, Hashæ•°æ®ç±»å‹çš„ item å€¼åŒ…å«äº†å½“å‰çº¿ç¨‹ä¿¡æ¯</p><p><code>key: {item1: value1, item2: value2}</code>, key ä¸ºå›ºå®šå€¼ &quot;redisson&quot;, item æ„æˆä¸º uuid + &quot;:&quot; + current thread id, value1 ä¸º å½“å‰é”è·å–æ¬¡æ•°</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redis-å®ç°-åˆ†å¸ƒå¼é”">redis å®ç° åˆ†å¸ƒå¼é”<a href="#redis-å®ç°-åˆ†å¸ƒå¼é”" class="hash-link" aria-label="redis å®ç° åˆ†å¸ƒå¼é”çš„ç›´æ¥é“¾æ¥" title="redis å®ç° åˆ†å¸ƒå¼é”çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>è¦æ±‚:</p><ul><li>set ex 300 nx ... è®¾ç½®è¿‡æœŸæ—¶é—´å’Œå ä½è¦æ˜¯åŸå­æ“ä½œ</li><li>æ‰§è¡Œå®Œä¸šåŠ¡è¦åˆ é™¤é”</li><li>è¦åˆ é™¤è‡ªå·±çš„é”, è€Œä¸è¦åˆ é™¤åˆ«äººçš„é” (å€¼å­˜ä¸º uuid or thread id)</li></ul><p>ä¼ªä»£ç </p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">Resp</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">withRedisLock</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uuid </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">new</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">uuid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">tostring</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sucess </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setNx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;lock&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">success</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> biz</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">exec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">withRedisLock</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">// è‡ªæ—‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">finally</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŸ¥æ‰¾, åˆ é™¤å¿…é¡»æ˜¯åŸå­æ“ä½œ, ä¸€ä¸‹ä¸ç¬¦åˆ, å¿…é¡»ç”¨ lua è„šæœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// lockValue = redis.get(&quot;lock&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// if (lockValue == uuid) {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//     redis.delete(&quot;lock&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        deleteScript </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;if redis.call(&#x27;get&#x27;, KEYS[1]) == ARGV[1] then return redis.call(&#x27;del&#x27;, KEYS[1]) else return 0 end&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">exec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">deleteScript</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redisson-å®ç°">redisson å®ç°<a href="#redisson-å®ç°" class="hash-link" aria-label="redisson å®ç°çš„ç›´æ¥é“¾æ¥" title="redisson å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/redisson/redisson" target="_blank" rel="noopener noreferrer">https://github.com/redisson/redisson</a></p><p>redis åˆ†å¸ƒå¼é”çš„å®˜æ–¹æ¨è</p><p>watch dog (key è‡ªåŠ¨ç»­æœŸ, é˜²æ­¢ä¸šåŠ¡è¶…æ—¶é”è¢«åˆ é™¤äº†)</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">spring-boot-starter-data-redis</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">&lt;!-- æ¨èä½¿ç”¨ redisson starter --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">org.redisson</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">groupId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">redisson</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">artifactId</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">3.8.2</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">version</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">optional</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">optional</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">dependency</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">   </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>springboot ä¸­é…ç½®</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token annotation punctuation" style="color:rgb(4, 81, 165)">@Bean</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">destroyMethod </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;shutdown&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">public</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">RedissonClient</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">redisson</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token annotation punctuation" style="color:rgb(4, 81, 165)">@Value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;classpath:/redisson-config.yml&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Resource</span><span class="token plain"> configFile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">throws</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Config</span><span class="token plain"> config </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">fromYAML</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">configFile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">getInputStream</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Redisson</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">create</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/redis">redis</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/nosql">nosql</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡ä»¶é€‰é¡¹å¡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/real-time-communication-protocol"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">å®æ—¶é€šä¿¡ Real-time</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/regex"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">Regular Expression æ­£åˆ™ğŸŒˆ</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#redis-ç‰¹æ€§" class="table-of-contents__link toc-highlight">redis ç‰¹æ€§</a></li><li><a href="#install" class="table-of-contents__link toc-highlight">install</a></li><li><a href="#ä½¿ç”¨åœºæ™¯" class="table-of-contents__link toc-highlight">ä½¿ç”¨åœºæ™¯</a></li><li><a href="#ç³»ç»Ÿç®¡ç†å‘½ä»¤" class="table-of-contents__link toc-highlight">ç³»ç»Ÿç®¡ç†å‘½ä»¤</a></li><li><a href="#æ•°æ®æ“ä½œå‘½ä»¤" class="table-of-contents__link toc-highlight">æ•°æ®æ“ä½œå‘½ä»¤</a></li><li><a href="#é”®ç®¡ç†" class="table-of-contents__link toc-highlight">é”®ç®¡ç†</a></li><li><a href="#streaming-ç±»å‹" class="table-of-contents__link toc-highlight">streaming ç±»å‹</a></li><li><a href="#string-å­—ç¬¦ä¸²" class="table-of-contents__link toc-highlight">String-å­—ç¬¦ä¸²</a></li><li><a href="#list-åˆ—è¡¨" class="table-of-contents__link toc-highlight">List-åˆ—è¡¨</a></li><li><a href="#set-é›†åˆ" class="table-of-contents__link toc-highlight">Set-é›†åˆ</a></li><li><a href="#hash-å“ˆå¸Œ" class="table-of-contents__link toc-highlight">Hash-å“ˆå¸Œ</a></li><li><a href="#zset-æœ‰åºé›†åˆ" class="table-of-contents__link toc-highlight">ZSet-æœ‰åºé›†åˆ</a></li><li><a href="#ä¸‰é“ä¿é™©ä¿è¯-key-è¿‡æœŸå¤„ç†" class="table-of-contents__link toc-highlight">ä¸‰é“ä¿é™©ä¿è¯ key è¿‡æœŸå¤„ç†</a></li><li><a href="#æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶" class="table-of-contents__link toc-highlight">æœ‰å“ªäº›æ·˜æ±°æœºåˆ¶</a></li><li><a href="#å†…å­˜å›æ”¶ç®—æ³•" class="table-of-contents__link toc-highlight">å†…å­˜å›æ”¶ç®—æ³•</a></li><li><a href="#å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥" class="table-of-contents__link toc-highlight">å¦‚ä½•é…ç½®æ·˜æ±°ç­–ç•¥</a><ul><li><a href="#é€šè¿‡é…ç½®æ–‡ä»¶" class="table-of-contents__link toc-highlight">é€šè¿‡é…ç½®æ–‡ä»¶</a></li><li><a href="#é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹" class="table-of-contents__link toc-highlight">é€šè¿‡å‘½ä»¤è¿è¡Œæ—¶ä¿®æ”¹</a></li></ul></li><li><a href="#å¤‡ä»½é€‰å‹" class="table-of-contents__link toc-highlight">å¤‡ä»½é€‰å‹</a></li><li><a href="#rdb-å¿«ç…§æŒä¹…åŒ–" class="table-of-contents__link toc-highlight">RDB-å¿«ç…§æŒä¹…åŒ–</a><ul><li><a href="#rdbæŒä¹…åŒ–æ¦‚å¿µ" class="table-of-contents__link toc-highlight">RDBæŒä¹…åŒ–æ¦‚å¿µ</a></li><li><a href="#è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯" class="table-of-contents__link toc-highlight">è§¦å‘æœºåˆ¶-å¦‚ä½•å¼€å¯</a></li><li><a href="#rdbæ–‡ä»¶" class="table-of-contents__link toc-highlight">RDBæ–‡ä»¶</a></li></ul></li><li><a href="#aof-æ—¥å¿—æŒä¹…åŒ–" class="table-of-contents__link toc-highlight">AOF-æ—¥å¿—æŒä¹…åŒ–</a><ul><li><a href="#aofæ¦‚å¿µ" class="table-of-contents__link toc-highlight">aofæ¦‚å¿µ</a></li><li><a href="#å†™å…¥åŸç†" class="table-of-contents__link toc-highlight">å†™å…¥åŸç†</a></li><li><a href="#æ–‡ä»¶åŒæ­¥" class="table-of-contents__link toc-highlight">æ–‡ä»¶åŒæ­¥</a></li><li><a href="#é‡å†™æœºåˆ¶" class="table-of-contents__link toc-highlight">é‡å†™æœºåˆ¶</a></li><li><a href="#aof-æŸå" class="table-of-contents__link toc-highlight">aof æŸå</a></li></ul></li><li><a href="#æ–‡ä»¶äº‹ä»¶" class="table-of-contents__link toc-highlight">æ–‡ä»¶äº‹ä»¶</a></li><li><a href="#æ—¶é—´äº‹ä»¶" class="table-of-contents__link toc-highlight">æ—¶é—´äº‹ä»¶</a></li><li><a href="#äº‹ä»¶çš„è°ƒåº¦æ‰§è¡Œ" class="table-of-contents__link toc-highlight">äº‹ä»¶çš„è°ƒåº¦&amp;æ‰§è¡Œ</a></li><li><a href="#è¿æ¥è¿‡ç¨‹" class="table-of-contents__link toc-highlight">è¿æ¥è¿‡ç¨‹</a></li><li><a href="#ä¸»ä»é“¾" class="table-of-contents__link toc-highlight">ä¸»ä»é“¾</a></li><li><a href="#æ–‡ç« ä¿¡æ¯" class="table-of-contents__link toc-highlight">æ–‡ç« ä¿¡æ¯</a></li><li><a href="#ç‚¹èµåŠŸèƒ½" class="table-of-contents__link toc-highlight">ç‚¹èµåŠŸèƒ½</a></li><li><a href="#å¯¹æ–‡ç« è¿›è¡Œæ’åº" class="table-of-contents__link toc-highlight">å¯¹æ–‡ç« è¿›è¡Œæ’åº</a></li><li><a href="#jedis" class="table-of-contents__link toc-highlight">jedis</a></li><li><a href="#lettuce" class="table-of-contents__link toc-highlight">lettuce</a></li><li><a href="#å®šä¹‰åºåˆ—åŒ–å™¨" class="table-of-contents__link toc-highlight">å®šä¹‰åºåˆ—åŒ–å™¨</a></li><li><a href="#å®ç°åŸç†" class="table-of-contents__link toc-highlight">å®ç°åŸç†</a><ul><li><a href="#åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚" class="table-of-contents__link toc-highlight">åˆ†å¸ƒå¼é”éœ€è¦æ»¡è¶³çš„è¦æ±‚</a></li><li><a href="#åŠ é”æœºåˆ¶" class="table-of-contents__link toc-highlight">åŠ é”æœºåˆ¶</a></li><li><a href="#watch-dog-è‡ªåŠ¨å»¶æ—¶æœºåˆ¶" class="table-of-contents__link toc-highlight">watch dog è‡ªåŠ¨å»¶æ—¶æœºåˆ¶</a></li><li><a href="#redisson-å¦‚ä½•å®ç°å¯é‡å…¥é”" class="table-of-contents__link toc-highlight">redisson å¦‚ä½•å®ç°å¯é‡å…¥é”</a></li></ul></li><li><a href="#redis-å®ç°-åˆ†å¸ƒå¼é”" class="table-of-contents__link toc-highlight">redis å®ç° åˆ†å¸ƒå¼é”</a></li><li><a href="#redisson-å®ç°" class="table-of-contents__link toc-highlight">redisson å®ç°</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">å†å²</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tags">æ ‡ç­¾</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">å½’æ¡£</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾äº¤åª’ä½“</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">å…³äºæˆ‘</a></li><li class="footer__item"><a href="https://github.com/xiaoyureed" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/xiaoyuhfq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/3fPgwd3naN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/friends">å‹é“¾</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/resource">å¯¼èˆª</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Xiaoyureed, Inc. Built with â¤ï¸ by xiaoyu.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f9c95488.js"></script>
<script src="/assets/js/main.2a982140.js"></script>
</body>
</html>