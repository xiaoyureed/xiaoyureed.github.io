---
title: Iot 物联网平台
tags: [iot]
date: 2020-06-06
toc_min_heading_level: 2
toc_max_heading_level: 5
---

<<图解物联网>>

https://github.com/IoT-Technology/IoT-Technical-Guide

https://github.com/microsoft/IoT-For-Beginners
https://iot-book.github.io/1_%E7%89%A9%E8%81%94%E7%BD%91%E6%A6%82%E8%BF%B0/
https://pdf.dfcfw.com/pdf/H3_AP202202071545436398_1.pdf 2022 行业报告

https://github.com/imKeYan/IoTPlatform 国内外物联网平台列表

2、熟悉视频编解码及图像处理原理，了解RTPRTCP、rtmp、rtsp等协议
3、熟悉TCP/IP，HTTP/HTTPS、MQTT，WebSocket，CoAP等一种或多种网络协议；
4、熟悉嵌入式操作系统、IoT相关协议(mqtt/opc-da/opc-ua/modbus等)
5、有基于开源 IoT平台相关二次开发使用经验;
6、有边缘-云互通编程开发经验，熟悉AWS greengrass、Service mesh 等开发框架;
7、有openTSDB 和influxDB等时序数据库实际开发经验;


熟悉消费级物联网的技术生态， 能独立完成物联网系统的设备选型、方案设计、硬件调试和控制软件开发。
精通主流的物联通讯协议 WiFi/BlueTooth/NFC/RS485/……， 熟练使用 Java/C#/C++ 等语言进行开发集成。
具备芯片级集成开发经验 STM32/ESP8266/HX711/ATGM336H/74HC595/……

- [iot brief intro](#iot-brief-intro)
    - [定义](#定义)
    - [场景-行业-厂商](#场景-行业-厂商)
    - [基本概念](#基本概念)
- [设备连接协议](#设备连接协议)
    - [HTTPS](#https)
    - [CoAP](#coap)
    - [mqtt](#mqtt)
        - [mqtt broker 服务端选型](#mqtt-broker-服务端选型)
    - [硬件设备协议](#硬件设备协议)
- [网络接入选型](#网络接入选型)
- [基于 Java 生态的物联网系统](#基于-java-生态的物联网系统)
    - [功能划分](#功能划分)
    - [集成mqtt](#集成mqtt)
- [八卦谈资](#八卦谈资)



https://github.com/Amazingwujun/mqttx

<!-- truncate -->

- [iot brief intro](#iot-brief-intro)
    - [定义](#定义)
    - [场景-行业-厂商](#场景-行业-厂商)
    - [基本概念](#基本概念)
- [设备连接协议](#设备连接协议)
    - [HTTPS](#https)
    - [CoAP](#coap)
    - [mqtt](#mqtt)
        - [mqtt broker 服务端选型](#mqtt-broker-服务端选型)
    - [硬件设备协议](#硬件设备协议)
- [网络接入选型](#网络接入选型)
- [基于 Java 生态的物联网系统](#基于-java-生态的物联网系统)
    - [功能划分](#功能划分)
    - [集成mqtt](#集成mqtt)
- [八卦谈资](#八卦谈资)



## iot brief intro

### 定义


```sh



IoT: 各种传感器设备联网组成的网络, 各种数据汇聚上传到云端

物联网（ IoT ）平台: 是连接设备、传感器、网络和软件应用程序的基础设施，以便收集、存储、分析和交换数据
    - 设备接入、
    - 设备管理、
    - 数据安全通信、
    - 消息订阅、消息转发
    - 数据服务 (收集、存储、分析和交换数据)

    向下支持连接海量设备，采集设备数据上云；向上提供云端API，服务端可通过云端SDK调用云端API将指令下发至设备端，实现远程控制。

物联网应用: 基于 iot 平台, 可以构建各种应用，不限于家居、矿山、电力、智慧城市、环境、交通等。






边缘计算：边缘计算是一种分布式计算范式，将数据处理和分析从云端移到设备附近的边缘节点。这可以减少数据传输延迟，提高实时性能，降低带宽成本，并增强数据安全性。边缘计算正在成为物联网领域的重要趋势。

低功耗广域网络（ LPWAN ）：LPWAN 技术（如 LoRaWAN 、Sigfox 和 NB-IoT ）为物联网设备提供了低功耗、长距离和低成本的无线连接。这使得大量分布式设备能够在广泛的地理范围内进行通信，从而推动了智能城市、智能农业和远程监控等领域的发展。

5G 技术：5G 是下一代无线通信技术，具有更高的数据速率、更低的延迟和更高的连接密度。5G 技术将为物联网应用带来更快的数据传输、更好的实时性能和更广泛的覆盖范围，从而推动自动驾驶汽车、远程医疗和智能工厂等领域的创新。

人工智能（ AI ）和机器学习：AI 和机器学习技术正在与物联网平台紧密结合，以实现更智能的数据分析和决策。通过使用 AI 算法，物联网设备可以自动识别模式、预测故障、优化资源利用和提高能效。

区块链技术：区块链技术为物联网提供了一种去中心化、安全和可靠的数据存储和交换机制。通过使用区块链，物联网设备可以实现安全的设备身份认证、数据完整性保护和智能合约自动执行等功能。

数字孪生技术：数字孪生是一种将物理设备和虚拟模型相互关联的技术。通过使用数字孪生，物联网平台可以实时监控设备状态、预测设备性能、优化设备维护和提高设备寿命。

无人机和自主机器人：无人机和自主机器人正在与物联网技术相结合，以实现自动巡检、远程监控、物流配送和灾害救援等应用。这些自主设备可以与物联网平台进行实时通信，以实现智能调度和协同作业

```

### 场景-行业-厂商

```sh

工业物联网

    https://www.neuseer.com/ 寄云科技

智慧物流
    京东物流, 菜鸟网络, G7, 易流科技

能源
    国家电网, 远景能源

地产/物业
    云智易, 德立云

社区/园区
    特斯联

智能家居
    涂鸦智能, 小米AIot平台

车联网

智慧零售

智慧医疗

农业养殖
    极飞科技, 托普云农

    自动灌溉, ai自动培育草莓

安全
    奇虎科技, 青莲云, 梆梆安全,
```

### 基本概念

refer to https://help.aliyun.com/zh/iot/product-overview/terms

```sh

产品 设备的集合，通常指一组具有相同功能的设备。物联网平台为每个产品颁发全局唯一的ProductKey。
    ProductSecret 通常与ProductKey成对出现，可用于一型一密的认证方案。

设备 归属于某个产品下的具体设备。物联网平台为设备颁发产品内唯一的证书DeviceName。设备可以直接连接物联网平台，也可以作为子设备通过网关连接物联网平台。

分组 物联网平台支持建立设备分组，分组中可包含不同产品下的设备。通过设备组来进行跨产品管理设备。

网关 能够直接连接物联网平台的设备，且具有子设备管理功能，能够代理子设备连接云端。

子设备 本质上也是设备。子设备不能直接连接物联网平台，只能通过网关连接。

设备证书 指ProductKey (为产品颁发的全局唯一标识)、DeviceName (为设备颁发的标识, 具备产品维度内的唯一性)、DeviceSecret(和DeviceName成对出现)的组合

设备X.509证书 支持设备使用X.509数字证书进行身份验证。您创建认证方式为X.509证书的设备后，物联网平台为设备颁发对应的X.509证书，证书信息包括：X.509数字证书（Certificate）、X.509证书ID（CertSN）和X.509证书密钥（PrivateKey）。

标签 标签分为产品标签、设备标签和分组标签。

    产品标签：描述同一个产品下，所有设备所具有的共性信息。

    设备标签：通常根据设备的特性为设备添加的特有标记，您可以自定义标签内容。

    分组标签：描述同一个分组下，所有设备所具有的共性信息。

物模型 是对设备在云端的功能描述，包括设备的属性、服务和事件。物联网平台通过定义一种物的描述语言来描述物模型，称之为TSL（即 Thing Specification Language），采用JSON格式，您可以根据TSL组装上报设备的数据。
    - 属性 设备的功能模型之一，一般用于描述设备运行时的状态，如环境监测设备所读取的当前环境温度等。属性支持GET和SET请求方式。应用系统可发起对属性的读取和设置请求。
    - 服务 设备的功能模型之一，设备可被外部调用的能力或方法，可设置输入参数和输出参数。相比于属性，服务可通过一条指令实现更复杂的业务逻辑，如执行某项特定的任务。
    - 事件 设备的功能模型之一，设备运行时的事件。事件一般包含需要被外部感知和处理的通知信息，可包含多个输出参数。例如，某项任务完成的信息，或者设备发生故障或告警时的温度等，事件可以被订阅和推送。

设备影子 是一个JSON文档，用于存储设备或者应用的当前状态信息。每个设备都会在云端有唯一的设备影子。无论该设备是否连接到Internet，您都可以使用设备影子通过MQTT协议或HTTP协议获取和设置设备的状态。

数据解析脚本 针对采用透传格式/自定义数据格式的设备，需要在云端编写数据解析脚本，将设备上报的二进制数据或自定义的JSON数据，转换为物联网平台支持的Alink JSON数据格式；将平台下发的Alink JSON格式数据，转换为设备支持的格式。




一机一密 每个设备烧录其唯一的设备证书（ProductKey、DeviceName和DeviceSecret）

一型一密 同一产品下所有设备可以烧录相同产品证书（即ProductKey和ProductSecret）
```

## 设备连接协议

### HTTPS

### CoAP

### mqtt

MQTT 3.1.1/5.0

MQTT（Message Queuing Telemetry Transport，消息队列遥测传输协议），是一种基于发布/订阅（publish/subscribe）模式的“轻量级”即时通讯协议，该协议构建于TCP/IP协议上

低开销、低带宽占用等优点, 特别适合用来当做物联网的通信协议

场景:

-（1）消息推送： 如PC端的推送公告，比如安卓的推送服务，还有一些即时通信软件如微信、易信等也是采用的推送技术。
-（2）智能点餐： 通过MQTT消息队列产品，消费者可在餐桌上扫码点餐，并与商家后端系统连接实现自助下单、支付。
-（3）信息更新： 实现商场超市等场所的电子标签、公共场所的多媒体屏幕的显示更新管理。
-（4）扫码出站： 最常见的停车场扫码缴费，自动起竿；地铁闸口扫码进出站。


```sh

MQTT Client

MQTT Broker

MQTT Connection
    参数:
    - ClientId
    - Clean Session
    - Username/Password
    - Will Message
    - KeepAlive
    - QOS 此数字表示消息的服务质量 (QoS)。有三个级别：0、1 和 2
        QoS 0（最多一次）：消息发布完全依赖底层 TCP/IP 网络。会发生消息丢失或重复。这个级别可用于如下情况，环境传感器数据，丢失一次数据无所谓，因为不久后还会有第二次发送。
        QoS 1（至少一次）：确保消息到达，但消息重复可能会发生。
        QoS 2（只有一次）：确保消息到达一次。这个级别可用于如下情况，在计费系统中，消息重复或丢失会导致不正确的结果。
    - Payload 每条消息的实际内容。MQTT 是数据无关性的。可以发送任何文本、图像、加密数据以及二进制数据。
    - timeout：MQTT会尝试接收数据，直到timeout时间到后才会退出。

```

#### mqtt broker 服务端选型

https://blog.csdn.net/emqx_broker/article/details/120017095

```sh

https://www.emqx.com/zh emqx

https://learnku.com/articles/46174 rabbitmq

```

桌面客户端 https://github.com/emqx/MQTTX

### 硬件设备协议

ModbusTcp，PLC，TCP/ip, opcServer

M2M协议、工业协议

熟悉无线传感网络、以太网、现场总线等通讯技术，了解RFID、ZigBee、Wi-Fi、WIA-PA、蓝牙4.0、UWB等技术，掌握主流传感器应用方案

## 网络接入选型

```sh

- 运营商网络：(适用于室外移动场景)
NB-IoT：电信布网最好，但是强制走电信云平台；联通下一线城市布网率还行，其他基本够呛。适用非快速移动设备的数据上报场景，下发较麻烦。
2G：成熟稳定，但退网是必然趋势
4G：价高功耗高
eMTC：起步阶段


- 通过局域网网关接入广域网：(适用于室内场景)
WiFi：这个不解释，很常见, 一般室内家用才会选择
LoRa：低功耗上报场景为主，需自组网，NB-IoT 的直接竞争者 (LoRaWAN 类似于 Wi-Fi，可以自己组网需要搭建物联网关)
BLE：一般智能家居场景
Zigbee：一般智能家居
网关/蓝牙: 适用于室内商用如商场 ( WIFI 扛不住那么多节点接入)


```

## 基于 Java 生态的物联网系统

### 功能划分

```sh

通用底座功能:
    多协议支持 (如：MQTT 、HTTP 、TCP 、Modbus 、GB28181 视频协议、萤石云视频协议等)
    设备接入/管理
        创建项目、按照分组添加管理设备、查看设备推送状态
    数据采集, 告警与可视化
        通知功能：短信、邮件、电话、webhook 多种通知方式
        时序数据库
    系统日志：IP 访问路径、设备操作记录
    集群部署
    多租户 (超级管理员, 租户公司账户, 租户用户账户)
    自动化(规则引擎)：场景联动、场景日志、定时触发、设备触发、多种触发

产品管理：创建产品、批量管理、二维码数据、手动激活
固件升级：为产品添加固件、创建升级任务、固件升级报表
```


### 集成mqtt

https://developer.aliyun.com/article/1150694
https://blog.csdn.net/beibei3321/article/details/124187758

```xml

<dependency>
  <groupId>org.springframework.integration</groupId>
  <artifactId>spring-integration-mqtt</artifactId>
</dependency>

```


## 八卦谈资

```sh

"智慧园区，智慧城市，各种智慧，其实技术上不会有很大难度，重要的是有资源不是，先得有渠道有人采购再做才对，哪个细分领域基本都没有空白市场了，偏传统的行业并不在意差异化和创新，拼的还是人脉资源"

"既然是小城市，就做好地头蛇, 比如细分行业细分场景, 地方产业地方特色, 小地方人脉和客户群比做什么做怎样更重要"

"独一无二的硬件 + 基于硬件构建的全家桶解决方案"

"物联网最大的问题是找不到合适的应用场景，目前在用的物联网场景，大多不是刚需, 大多数也就是个监测，整个数据大屏看看曲线而已，但是这些监测数据 99%都是垃圾，没有人关心, 所以物联网做到最后，基本上就变成了 toG 的生意，甲方主要是 zf 和国企，他们才有预算去做这些面子工程"

做平价智能家居然后协议兼容米家和 homekit 

```