<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-rust-note">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Rust ç¬”è®°ğŸŒˆ - Xiaoyureed çš„ç½‘ç»œ Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xiaoyureed.github.io/img/logo.webp"><meta data-rh="true" name="twitter:image" content="https://xiaoyureed.github.io/img/logo.webp"><meta data-rh="true" property="og:url" content="https://xiaoyureed.github.io/docs/rust-note"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="keywords" content="xiaoyureed"><meta data-rh="true" name="keywords" content="blog, java, spring, microservice, python, rust, typescript, react, web"><meta data-rh="true" name="keywords" content=" åŠè·¯è½¬è¡Œçš„ç¼–ç¨‹çˆ±å¥½è€…, å†™è¿‡ Python, Rust, ç°åœ¨ä¸»æ”» Java åˆ†å¸ƒå¼ç³»ç»Ÿ"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rust ç¬”è®°ğŸŒˆ - Xiaoyureed çš„ç½‘ç»œ Wiki"><meta data-rh="true" name="description" content="- 1. ç®€å•ä»‹ç»"><meta data-rh="true" property="og:description" content="- 1. ç®€å•ä»‹ç»"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xiaoyureed.github.io/docs/rust-note"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/en/docs/rust-note" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/rust-note" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/rust-note" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5SAMPKXTP9-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Xiaoyureed çš„ç½‘ç»œ Wiki" href="/opensearch.xml">


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f6da56a47f5085d1e0fedae39b8de00a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="xiaoyureed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="xiaoyureed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="xiaoyureed JSON Feed">

<link rel="icon" href="/img/logo.webp">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)">
<meta name="description" content="Xiaoyureed çš„ä¸ªäººåšå®¢"><link rel="stylesheet" href="/assets/css/styles.d08d09a2.css">
<link rel="preload" href="/assets/js/runtime~main.93472f92.js" as="script">
<link rel="preload" href="/assets/js/main.c24d32c9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><a href="/docs/rust-note" target="_blank">Rust æŒ‡åŒ—, æ¬¢è¿æŸ¥çœ‹...</a></div><button type="button" aria-label="å…³é—­" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="ä¸»å¯¼èˆª" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">èœå•</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/archive">åšå®¢</a></li><li><a class="dropdown__link" href="/docs/intro">æ•™ç¨‹</a></li><li><a class="dropdown__link" href="/resource">å¯¼èˆª</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"><b></b></a><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/FreeMarker-note">FreeMarker Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/SpringBoot-note">Spring Boot å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/agile-development-user-story-scrum">æ•æ·å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/android">Android å¼€å‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/autohotkey">Autohotkey è„šæœ¬</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/blockchain">blockchainåŒºå—é“¾</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/c-sharp-and-dot-net">C# &amp; .NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/chatgpt">Chatgpt Usage Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cloud-native-platform">äº‘æœåŠ¡å¹³å°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cpp">CPP and C å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cross-gfw">Cross The GFW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cs-note">Computer Science Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/css-pre-processor">å‡ ç§CSSé¢„å¤„ç†å™¨æ¯”è¾ƒé€‰å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/data-structure-and-algorithm">Data Structure and Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/design-pattern-note">Design Pattern ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-resources">å¼€å‘è€…èµ„æº</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/devops">DevOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/distributed-system">Distributed System åˆ†å¸ƒå¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/docker-note-virtual-dev-env">Docker Note &amp; Other Virtual Develop Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/effective-java-reading-note">Effective Java é˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/elk-elastic-log">Distributed log collectionåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/english-note">è‹±è¯­å­¦ä¹ ğŸ”¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/extjs-note">Extjs ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/flutter">flutter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/games-development-introduce">æ¸¸æˆå¼€å‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/git-note">Git å¤‡å¿˜ ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/github-starts">Github æ˜Ÿæ ‡â­ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/golang-note">Golang ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/gps-gis-tracing">åŸºäºåœ°ç†ä½ç½®å¼€å‘æŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/gradle">gradle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/greasy-monkey">æ²¹çŒ´æ’ä»¶&amp;ç¼–å†™è„šæœ¬ğŸ’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/groovy-note">groovy note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/health">Health å…³çˆ±ç¨‹åºå‘˜å¥åº·ğŸ¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/how-to-test-java-app">How to Test Java App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/html-note">HTML å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/idea-note">InteliJ idea tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/interview-system-design">ç»å…¸çš„ç³»ç»Ÿè®¾è®¡æ€è·¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/iot">Iot ç‰©è”ç½‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-code-clean">Java Clean Code Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-concurrent">Java ConcurrentğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-memory-model-jmm-jvm">JMM and GCğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-note">Java Core ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/jquery-note">JQuery notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/js-tutorial">JavaScript tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/kotlin">kotlin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/kubernetes-k8s">kubernetes-k8s â˜ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux-note">é¸Ÿå“¥çš„ Linux ç§æˆ¿èœé˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mac">Mac å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/machine-learning-ml">machine-learning-ml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/maven-note">Maven NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/message-queue">Message QueueğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/money">Investment Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mongodb-note">MongoDB NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/monitor-system-grafana-prometheus-influxdb-hbase">monitor-system-grafana-prometheusç›‘æ§ğŸ–¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mvc-mvvm">MVC to MVVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mybatis-note">MyBatis Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/netty-note">netty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nlp-natural-language-processing">nlp-natural-language-processingğŸ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nodejs-yarn-npm">Nodejs, Yarn, Npm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/oracle">Oracle å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-audio-video">Audio and Video development Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-big-data-introduce">å¤§æ•°æ®å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-cache">Cache ç¼“å­˜ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-computational-ad">è®¡ç®—å¹¿å‘Š Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-crawler-spider">ç½‘ç»œçˆ¬è™« Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-db-design-note">å…³ç³»å‹æ•°æ®åº“è¡¨è®¾è®¡ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-desktop-develop">æ¡Œé¢åº”ç”¨å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-http-restful">HTTP protocol Intro &amp; RESTful</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-reactive-programming">å“åº”å¼ç¼–ç¨‹ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-rpc">RPC Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-rule-engine-note">è§„åˆ™å¼•æ“ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/php-note">PHP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/play-framework">Playæ¡†æ¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/postgres-note">Postgres noteğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/process-workflow-bpm-engine">å·¥ä½œæµå¼•æ“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/protect-your-app-authentication-oauth2-jwt-https">Protect Your App å®‰å…¨ä¿æŠ¤è®¤è¯é‰´æƒğŸ”‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/python-note">PythonğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quant-money">é‡åŒ–äº¤æ˜“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quarkus">Quarkus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/react-note">ReactğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/real-time-communication-protocol">å®æ—¶é€šä¿¡ Real-time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/redis-note">RedisğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/regex">Regular Expression æ­£åˆ™ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/rust-note">Rust ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/saas-paas-iaas-as-a-service">SaaS Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/serverless">Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/service-mesh">service mesh æœåŠ¡ç½‘æ ¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/servlet">Servlet Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/shell-bash-note">shell-bashè„šæœ¬æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/spring-note">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/springcloud-note">Spring Cloud ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/springmvc-note">Spring MVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/task-schedule-note">Task Schedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tcp-ip-note">TCP IP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tomcat-jetty-nginx">Tomcat Jetty Nginx ç­‰ web å®¹å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/vertx">Vertx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/video-creator">æ‹æ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webassembly">webassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webpack-esbuild-vite-rollup">å‰ç«¯æ‰“åŒ…æ„å»ºå·¥å…·</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/windows-sub-system-on-linux">WSL ä½¿ç”¨</a></li></ul></nav><button type="button" title="æ”¶èµ·ä¾§è¾¹æ " aria-label="æ”¶èµ·ä¾§è¾¹æ " class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Rust ç¬”è®°ğŸŒˆ</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>Rust ç¬”è®°ğŸŒˆ</h1></header><ul><li><a href="#1-%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D">1. ç®€å•ä»‹ç»</a><ul><li><a href="#11-pros-and-cons">1.1. Pros and Cons</a></li><li><a href="#12-%E6%9E%B6%E6%9E%84">1.2. æ¶æ„</a></li><li><a href="#13-%E4%BC%98%E7%82%B9-%E5%AF%B9%E6%AF%94">1.3. ä¼˜ç‚¹ å¯¹æ¯”</a></li><li><a href="#14-%E6%80%9D%E6%83%B3">1.4. æ€æƒ³</a></li><li><a href="#15-%E8%AF%AD%E4%B9%89-%E6%A6%82%E5%BF%B5">1.5. è¯­ä¹‰ æ¦‚å¿µ</a></li></ul></li><li><a href="#2-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">2. å¼€å‘ç¯å¢ƒé…ç½®</a><ul><li><a href="#21-install">2.1. install</a></li><li><a href="#22-%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8">2.2. å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨</a></li><li><a href="#23-ide">2.3. IDE</a></li><li><a href="#24-%E9%85%8D%E7%BD%AE%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F">2.4. é…ç½®å›½å†…é•œåƒ</a></li></ul></li><li><a href="#3-%E6%A0%87%E5%87%86%E5%BA%93">3. æ ‡å‡†åº“</a><ul><li><a href="#31-path-%E8%B7%AF%E5%BE%84">3.1. path è·¯å¾„</a></li><li><a href="#32-%E6%97%B6%E9%97%B4">3.2. æ—¶é—´</a></li></ul></li><li><a href="#4-%E5%AF%B9%E6%AF%94-2018">4. å¯¹æ¯” 2018</a><ul><li><a href="#41-nll">4.1. nll</a></li><li><a href="#42-raw-identifier">4.2. Raw identifier</a></li><li><a href="#43-%E7%AE%80%E5%8C%96%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D">4.3. ç®€åŒ–æ¨¡å¼åŒ¹é…</a></li><li><a href="#44-main-%E5%87%BD%E6%95%B0%E5%8F%AF%E4%BB%A5%E8%BF%94%E5%9B%9E-result">4.4. main å‡½æ•°å¯ä»¥è¿”å› Result</a></li><li><a href="#45-impl-trait-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%9E%8B">4.5. impl trait æŠ½è±¡ç±»å‹</a></li></ul></li><li><a href="#5-%E8%AF%AD%E6%B3%95">5. è¯­æ³•</a><ul><li><a href="#51-%E6%B3%A8%E9%87%8A">5.1. æ³¨é‡Š</a></li><li><a href="#52-%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC">5.2. å˜é‡èµ‹å€¼</a><ul><li><a href="#521-%E9%BB%98%E8%AE%A4%E6%98%AF%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84">5.2.1. é»˜è®¤æ˜¯ä¸å¯å˜çš„</a></li><li><a href="#522-%E5%AD%97%E9%9D%A2%E9%87%8F">5.2.2. å­—é¢é‡</a></li></ul></li><li><a href="#53-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">5.3. åŸºæœ¬æ•°æ®ç±»å‹</a><ul><li><a href="#531-convert">5.3.1. convert</a></li><li><a href="#532-%E5%80%BC%E7%B1%BB%E5%9E%8B-and-%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B">5.3.2. å€¼ç±»å‹ and å¼•ç”¨ç±»å‹</a></li><li><a href="#533-%E5%B8%B8%E9%87%8F-%E9%9D%99%E6%80%81%E5%8F%98%E9%87%8F">5.3.3. å¸¸é‡ é™æ€å˜é‡</a></li><li><a href="#534-%E6%95%B0%E5%AD%97">5.3.4. æ•°å­—</a></li><li><a href="#535-%E5%B8%83%E5%B0%94%E5%80%BC-%E5%AD%97%E7%AC%A6-%E5%AD%97%E8%8A%82">5.3.5. å¸ƒå°”å€¼ å­—ç¬¦ å­—èŠ‚</a></li><li><a href="#536-%E6%95%B0%E7%BB%84">5.3.6. æ•°ç»„</a></li><li><a href="#537-range-%E8%8C%83%E5%9B%B4">5.3.7. Range èŒƒå›´</a></li><li><a href="#538-%E5%88%87%E7%89%87">5.3.8. åˆ‡ç‰‡</a></li><li><a href="#539-str-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87">5.3.9. str å­—ç¬¦ä¸²åˆ‡ç‰‡</a></li><li><a href="#5310-%E5%8E%9F%E7%94%9F%E6%8C%87%E9%92%88-raw-pointer">5.3.10. åŸç”ŸæŒ‡é’ˆ raw pointer</a></li><li><a href="#5311-never-%E7%B1%BB%E5%9E%8B-%E6%84%9F%E5%8F%B9%E5%8F%B7">5.3.11. never ç±»å‹ æ„Ÿå¹å·</a></li></ul></li><li><a href="#54-%E5%AD%97%E7%AC%A6%E4%B8%B2">5.4. å­—ç¬¦ä¸²</a><ul><li><a href="#541-%E5%87%A0%E7%A7%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%BA%E5%88%AB">5.4.1. å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«</a></li><li><a href="#542-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95">5.4.2. å¸¸ç”¨æ–¹æ³•</a></li><li><a href="#543-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2">5.4.3. å­—ç¬¦ä¸²è½¬æ¢</a></li><li><a href="#544-%E6%A0%BC%E5%BC%8F%E5%8C%96">5.4.4. æ ¼å¼åŒ–</a></li><li><a href="#545-%E8%B0%83%E8%AF%95%E6%89%93%E5%8D%B0%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B-debug-display">5.4.5. è°ƒè¯•æ‰“å°å¤åˆç±»å‹ Debug Display</a></li><li><a href="#546-%E9%97%AE%E5%8F%B7%E6%93%8D%E4%BD%9C%E7%AC%A6-%E5%A4%9A%E6%AC%A1%E5%86%99">5.4.6. é—®å·æ“ä½œç¬¦ å¤šæ¬¡å†™</a></li></ul></li><li><a href="#55-%E9%9B%86%E5%90%88">5.5. é›†åˆ</a><ul><li><a href="#551-vec-%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84">5.5.1. Vec åŠ¨æ€æ•°ç»„</a></li><li><a href="#552-%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97-vecdeque">5.5.2. åŒç«¯é˜Ÿåˆ— VecDeque</a></li><li><a href="#553-%E9%93%BE%E8%A1%A8-linkedlist">5.5.3. é“¾è¡¨ Linkedlist</a></li><li><a href="#554-hashmap-%E6%97%A0%E5%BA%8F%E5%93%88%E5%B8%8C%E8%A1%A8">5.5.4. hashmap æ— åºå“ˆå¸Œè¡¨</a><ul><li><a href="#5541-%E5%93%88%E5%B8%8C%E8%A1%A8%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">5.5.4.1. å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5542-%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B%E4%BD%9C%E4%B8%BA-key">5.5.4.2. å¤åˆç±»å‹ä½œä¸º key</a></li><li><a href="#5543-%E5%93%88%E5%B8%8C%E7%A2%B0%E6%92%9E%E6%94%BB%E5%87%BB">5.5.4.3. å“ˆå¸Œç¢°æ’æ”»å‡»</a></li></ul></li><li><a href="#555-btreemap-%E6%9C%89%E5%BA%8F%E5%93%88%E5%B8%8C%E8%A1%A8">5.5.5. BTreeMap æœ‰åºå“ˆå¸Œè¡¨</a></li><li><a href="#556-hashset-%E6%97%A0%E5%BA%8F%E9%9B%86%E5%90%88">5.5.6. hashset æ— åºé›†åˆ</a></li><li><a href="#557-btreeset-%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88">5.5.7. BTreeSet æœ‰åºé›†åˆ</a></li><li><a href="#558-%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97-binaryheap">5.5.8. ä¼˜å…ˆé˜Ÿåˆ— BinaryHeap</a></li></ul></li><li><a href="#56-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">5.6. ç±»å‹è½¬æ¢</a><ul><li><a href="#561-%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">5.6.1. åŸºæœ¬çš„ç±»å‹è½¬æ¢</a></li><li><a href="#562-%E8%BD%AC%E6%8D%A2%E7%9B%B8%E5%85%B3%E7%9A%84-trait">5.6.2. è½¬æ¢ç›¸å…³çš„ trait</a></li></ul></li><li><a href="#57-%E6%89%80%E6%9C%89%E6%9D%83">5.7. æ‰€æœ‰æƒ</a><ul><li><a href="#571-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%89%80%E6%9C%89%E6%9D%83-raii%E6%9C%BA%E5%88%B6">5.7.1. ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ RAIIæœºåˆ¶</a></li><li><a href="#572-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99">5.7.2. åŸºæœ¬åŸåˆ™</a></li><li><a href="#573-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%B5%8B%E5%80%BC%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83">5.7.3. å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒ</a></li><li><a href="#574-%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83">5.7.4. å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒ</a></li><li><a href="#575-%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E6%89%80%E6%9C%89%E6%9D%83">5.7.5. å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒ</a></li><li><a href="#576-%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83">5.7.6. å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒ</a></li><li><a href="#577-%E5%A4%9A%E6%89%80%E6%9C%89%E6%9D%83">5.7.7. å¤šæ‰€æœ‰æƒ</a></li></ul></li><li><a href="#58-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%8F%82%E6%95%B0">5.8. ç”Ÿå‘½å‘¨æœŸå‚æ•°</a><ul><li><a href="#581-%E4%BB%80%E4%B9%88%E6%98%AF%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">5.8.1. ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="#582-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%AD%98%E5%9C%A8%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%B3%A8%E9%87%8A">5.8.2. ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š</a></li><li><a href="#583-%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%8F%82%E6%95%B0">5.8.3. å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°</a></li><li><a href="#584-%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%AD%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-%E7%9C%81%E7%95%A5%E7%9A%84%E8%A7%84%E5%88%99">5.8.4. ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ çœç•¥çš„è§„åˆ™</a></li><li><a href="#585-%E9%9D%99%E6%80%81%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%B3%A8%E9%87%8A">5.8.5. é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š</a></li><li><a href="#586-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%BA%A6%E6%9D%9F">5.8.6. ç”Ÿå‘½å‘¨æœŸçº¦æŸ</a></li></ul></li><li><a href="#59-%E5%BC%95%E7%94%A8">5.9. å¼•ç”¨</a><ul><li><a href="#591-%E5%BC%95%E7%94%A8%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D">5.9.1. å¼•ç”¨åŸºæœ¬ä»‹ç»</a></li><li><a href="#592-%E4%B8%8D%E5%8F%AF%E5%8F%98%E5%BC%95%E7%94%A8">5.9.2. ä¸å¯å˜å¼•ç”¨</a></li><li><a href="#593-%E5%8F%AF%E5%8F%98%E5%BC%95%E7%94%A8">5.9.3. å¯å˜å¼•ç”¨</a></li><li><a href="#594-%E5%9E%82%E6%82%AC%E5%BC%95%E7%94%A8%E9%97%AE%E9%A2%98dangling-references">5.9.4. å‚æ‚¬å¼•ç”¨é—®é¢˜ï¼ˆDangling References)</a></li></ul></li><li><a href="#510-%E8%A3%B8%E6%8C%87%E9%92%88">5.10. è£¸æŒ‡é’ˆ</a></li><li><a href="#511-%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88">5.11. æ™ºèƒ½æŒ‡é’ˆ</a><ul><li><a href="#5111-%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88%E4%BB%8B%E7%BB%8D-%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6">5.11.1. æ™ºèƒ½æŒ‡é’ˆä»‹ç» å·¥ä½œæœºåˆ¶</a></li><li><a href="#5112-raii%E6%9C%BA%E5%88%B6-%E5%AE%9E%E7%8E%B0%E5%86%85%E5%AD%98%E5%9B%9E%E6%94%B6">5.11.2. RAIIæœºåˆ¶ å®ç°å†…å­˜å›æ”¶</a></li><li><a href="#5113-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88-%E8%87%AA%E5%8A%A8%E8%A7%A3%E5%BC%95%E7%94%A8-deref-%E5%92%8C-drop">5.11.3. è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ è‡ªåŠ¨è§£å¼•ç”¨ Deref å’Œ Drop</a></li><li><a href="#5114-box-%E6%97%A0%E7%97%9B%E4%BD%BF%E7%94%A8%E5%A0%86%E5%86%85%E5%AD%98">5.11.4. Box æ— ç—›ä½¿ç”¨å †å†…å­˜</a><ul><li><a href="#51141-box%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">5.11.4.1. BoxåŸºæœ¬ä½¿ç”¨</a></li><li><a href="#51142-%E5%8C%85%E8%A3%85%E5%8A%A8%E6%80%81%E5%A4%A7%E5%B0%8F%E7%B1%BB%E5%9E%8B-dst">5.11.4.2. åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹ DST</a></li></ul></li><li><a href="#5115-rc-%E5%92%8C-weak-%E5%85%B1%E4%BA%AB%E5%A0%86%E5%86%85%E5%AD%98">5.11.5. Rc å’Œ Weak å…±äº«å †å†…å­˜</a><ul><li><a href="#51151-rc-%E5%BC%BA%E5%BC%95%E7%94%A8">5.11.5.1. Rc å¼ºå¼•ç”¨</a></li><li><a href="#51152-%E6%9E%84%E9%80%A0%E9%93%BE%E8%A1%A8">5.11.5.2. æ„é€ é“¾è¡¨</a></li><li><a href="#51153-weak-%E5%BC%B1%E5%BC%95%E7%94%A8">5.11.5.3. Weak å¼±å¼•ç”¨</a></li></ul></li><li><a href="#5116-refcell-%E5%92%8C-cell-%E6%8F%90%E4%BE%9B%E5%86%85%E9%83%A8%E5%8F%AF%E5%8F%98%E6%80%A7">5.11.6. RefCell å’Œ Cell æä¾›å†…éƒ¨å¯å˜æ€§</a><ul><li><a href="#51161-cell">5.11.6.1. Cell</a></li><li><a href="#51162-refcell">5.11.6.2. RefCell</a></li></ul></li><li><a href="#5117-rc-box-refcell-cell-%E5%87%A0%E7%A7%8D%E6%8C%87%E9%92%88%E7%9A%84%E5%8C%BA%E5%88%AB%E5%AF%B9%E6%AF%94-%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8">5.11.7. Rc Box RefCell Cell å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯” ç»„åˆä½¿ç”¨</a></li><li><a href="#5118-pin-%E5%92%8C-unpin">5.11.8. Pin å’Œ Unpin</a></li><li><a href="#5119-cow-%E5%86%99%E6%97%B6%E5%A4%8D%E5%88%B6">5.11.9. Cow å†™æ—¶å¤åˆ¶</a></li></ul></li><li><a href="#512-%E5%87%BD%E6%95%B0">5.12. å‡½æ•°</a><ul><li><a href="#5121-%E5%87%BD%E6%95%B0%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95">5.12.1. å‡½æ•°åŸºæœ¬è¯­æ³•</a></li><li><a href="#5122-%E5%87%BD%E6%95%B0%E4%BD%93%E8%A1%A8%E8%BE%BE%E5%BC%8F">5.12.2. å‡½æ•°ä½“è¡¨è¾¾å¼</a></li><li><a href="#5123-%E5%87%BD%E6%95%B0%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0">5.12.3. å‡½æ•°ä½œä¸ºå‚æ•°</a></li><li><a href="#5124-result-%E8%BF%94%E5%9B%9E%E5%80%BC">5.12.4. Result è¿”å›å€¼</a></li><li><a href="#5125-%E7%BC%96%E8%AF%91%E6%9C%9F%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C-cfe">5.12.5. ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ cfe</a></li><li><a href="#5126-%E5%8F%91%E6%95%A3%E5%87%BD%E6%95%B0">5.12.6. å‘æ•£å‡½æ•°</a></li><li><a href="#5127-%E6%B3%9B%E5%9E%8B%E5%87%BD%E6%95%B0">5.12.7. æ³›å‹å‡½æ•°</a></li><li><a href="#5128-%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0">5.12.8. é«˜é˜¶å‡½æ•°</a><ul><li><a href="#51281-%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88">5.12.8.1. å‡½æ•°æŒ‡é’ˆ</a></li><li><a href="#51282-%E7%A6%81%E6%AD%A2%E5%87%BD%E6%95%B0%E6%8D%95%E8%8E%B7%E5%A4%96%E9%83%A8%E7%8E%AF%E5%A2%83%E4%B8%AD%E5%8F%98%E9%87%8F">5.12.8.2. ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡</a></li></ul></li></ul></li><li><a href="#513-%E9%97%AD%E5%8C%85">5.13. é—­åŒ…</a><ul><li><a href="#5131-%E9%97%AD%E5%8C%85%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">5.13.1. é—­åŒ…åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5132-rust-%E5%AE%9E%E7%8E%B0%E9%97%AD%E5%8C%85%E7%9A%84%E5%8E%9F%E7%90%86">5.13.2. rust å®ç°é—­åŒ…çš„åŸç†</a></li><li><a href="#5133-%E6%8D%95%E8%8E%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-and-%E4%B8%89%E7%A7%8D%E9%97%AD%E5%8C%85%E7%B1%BB%E5%9E%8B">5.13.3. æ•è·ç¯å¢ƒå˜é‡ and ä¸‰ç§é—­åŒ…ç±»å‹</a></li><li><a href="#5134-%E9%97%AD%E5%8C%85%E4%BD%9C%E4%B8%BA%E8%BF%94%E5%9B%9E%E5%80%BC-or-%E5%8F%82%E6%95%B0">5.13.4. é—­åŒ…ä½œä¸ºè¿”å›å€¼ or å‚æ•°</a><ul><li><a href="#51341-%E9%80%83%E9%80%B8%E9%97%AD%E5%8C%85-%E9%9D%9E%E9%80%83%E9%80%B8%E9%97%AD%E5%8C%85">5.13.4.1. é€ƒé€¸é—­åŒ… éé€ƒé€¸é—­åŒ…</a></li><li><a href="#51342-%E9%97%AD%E5%8C%85%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0">5.13.4.2. é—­åŒ…ä½œä¸ºå‚æ•°</a></li><li><a href="#51343-%E9%97%AD%E5%8C%85%E4%BD%9C%E4%B8%BA%E8%BF%94%E5%9B%9E%E5%80%BC">5.13.4.3. é—­åŒ…ä½œä¸ºè¿”å›å€¼</a></li><li><a href="#51344-%E9%97%AD%E5%8C%85%E5%8F%82%E6%95%B0%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">5.13.4.4. é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</a></li></ul></li><li><a href="#5135-%E8%BF%AD%E4%BB%A3%E5%99%A8">5.13.5. è¿­ä»£å™¨</a><ul><li><a href="#51351-%E4%BB%80%E4%B9%88%E6%98%AF%E8%BF%AD%E4%BB%A3%E5%99%A8">5.13.5.1. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨</a></li><li><a href="#51352-iterator-trait">5.13.5.2. Iterator trait</a></li><li><a href="#51353-%E8%BF%AD%E4%BB%A3%E5%99%A8%E9%80%82%E9%85%8D%E5%99%A8-%E6%94%B6%E9%9B%86%E5%99%A8-%E5%87%BD%E6%95%B0%E5%BC%8F%E9%A3%8E%E6%A0%BC">5.13.5.3. è¿­ä»£å™¨é€‚é…å™¨ æ”¶é›†å™¨ å‡½æ•°å¼é£æ ¼</a></li><li><a href="#51354-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%AD%E4%BB%A3%E5%99%A8">5.13.5.4. è‡ªå®šä¹‰è¿­ä»£å™¨</a></li><li><a href="#51355-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%80%82%E9%85%8D%E5%99%A8-%E6%94%B6%E9%9B%86%E5%99%A8">5.13.5.5. è‡ªå®šä¹‰é€‚é…å™¨ æ”¶é›†å™¨</a></li></ul></li></ul></li><li><a href="#514-%E6%9D%A1%E4%BB%B6%E5%BE%AA%E7%8E%AF">5.14. æ¡ä»¶å¾ªç¯</a></li><li><a href="#515-%E6%B3%9B%E5%9E%8B">5.15. æ³›å‹</a><ul><li><a href="#5151-%E5%8D%95%E6%80%81%E5%8C%96">5.15.1. å•æ€åŒ–</a></li><li><a href="#5152-%E5%A4%9A%E9%87%8D%E7%BA%A6%E6%9D%9F-%E5%8A%A0%E5%8F%B7">5.15.2. å¤šé‡çº¦æŸ åŠ å·</a></li><li><a href="#5153-%E9%BB%98%E8%AE%A4%E6%B3%9B%E5%9E%8B%E5%8F%82%E6%95%B0-and-%E5%85%B3%E8%81%94%E7%B1%BB%E5%9E%8B">5.15.3. é»˜è®¤æ³›å‹å‚æ•° and å…³è”ç±»å‹</a></li><li><a href="#5154-%E7%A9%BA%E7%BA%A6%E6%9D%9F">5.15.4. ç©ºçº¦æŸ</a></li><li><a href="#5155-turbofish-%E6%93%8D%E4%BD%9C%E7%AC%A6-and-%E8%BF%94%E5%9B%9E%E5%80%BC%E8%87%AA%E5%8A%A8%E6%8E%A8%E5%AF%BC">5.15.5. turbofish æ“ä½œç¬¦ and è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼</a></li></ul></li><li><a href="#516-trait">5.16. trait</a><ul><li><a href="#5161-trait-%E6%A6%82%E5%BF%B5">5.16.1. trait æ¦‚å¿µ</a><ul><li><a href="#51611-trait-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">5.16.1.1. trait åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#51612-%E5%AD%A4%E5%84%BF%E8%A7%84%E5%88%99-%E9%80%9A%E8%BF%87fundamental%E8%A7%84%E9%81%BF">5.16.1.2. å­¤å„¿è§„åˆ™ é€šè¿‡fundamentalè§„é¿</a></li><li><a href="#51613-%E7%89%B9%E5%8C%96-specialization">5.16.1.3. ç‰¹åŒ– Specialization</a></li><li><a href="#51614-trait-%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0-%E9%9C%80%E8%A6%81-impl-%E5%89%8D%E7%BC%80">5.16.1.4. trait ä½œä¸ºå‚æ•° éœ€è¦ impl å‰ç¼€</a></li><li><a href="#51615-trait-%E4%BD%9C%E4%B8%BA-%E8%BF%94%E5%9B%9E%E5%80%BC-%E8%BF%94%E5%9B%9E%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B">5.16.1.5. trait ä½œä¸º è¿”å›å€¼ è¿”å›åŠ¨æ€ç±»å‹</a></li><li><a href="#51616-trait-%E7%BB%A7%E6%89%BF">5.16.1.6. trait ç»§æ‰¿</a></li><li><a href="#51617-%E9%9D%99%E6%80%81%E5%88%86%E5%8F%91-%E5%8A%A8%E6%80%81%E5%88%86%E5%8F%91">5.16.1.7. é™æ€åˆ†å‘ åŠ¨æ€åˆ†å‘</a></li><li><a href="#51618-%E4%BD%BF%E7%94%A8%E6%8A%BD%E8%B1%A1%E7%B1%BB%E5%9E%8B">5.16.1.8. ä½¿ç”¨æŠ½è±¡ç±»å‹</a><ul><li><a href="#516181-trait%E5%AF%B9%E8%B1%A1">5.16.1.8.1. traitå¯¹è±¡</a></li><li><a href="#516182-trait%E5%AF%B9%E8%B1%A1%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98-sized-trait">5.16.1.8.2. traitå¯¹è±¡å®‰å…¨é—®é¢˜ Sized trait</a></li><li><a href="#516183-impl-trait">5.16.1.8.3. impl trait</a></li></ul></li><li><a href="#51619-trait%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">5.16.1.9. traitçš„ç±»å‹è½¬æ¢</a></li></ul></li><li><a href="#5162-%E5%8F%AF%E8%87%AA%E5%8A%A8%E6%8E%A8%E5%AF%BC%E7%9A%84trait">5.16.2. å¯è‡ªåŠ¨æ¨å¯¼çš„trait</a></li><li><a href="#5163-%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD%E7%9B%B8%E5%85%B3%E7%9A%84trait">5.16.3. è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„trait</a></li><li><a href="#5164-from-%E5%92%8C-into">5.16.4. From å’Œ Into</a></li><li><a href="#5165-derefmut-%E5%92%8C-deref">5.16.5. DerefMut å’Œ Deref</a></li><li><a href="#5166-asref-asmut">5.16.6. AsRef AsMut</a></li><li><a href="#5167-borrow-trait">5.16.7. Borrow trait</a></li><li><a href="#5168-drop-%E8%B5%84%E6%BA%90%E9%87%8A%E6%94%BE">5.16.8. Drop èµ„æºé‡Šæ”¾</a></li><li><a href="#5169-%E6%A0%87%E7%AD%BE-trait">5.16.9. æ ‡ç­¾ trait</a><ul><li><a href="#51691-send-%E5%92%8C-sync">5.16.9.1. Send å’Œ Sync</a></li><li><a href="#51692-copy-trait">5.16.9.2. Copy trait</a></li><li><a href="#51693-sized-trait--%E5%92%8C-%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8Bdst">5.16.9.3. Sized trait  å’Œ åŠ¨æ€ç±»å‹DST</a></li></ul></li><li><a href="#51610-default-trait">5.16.10. Default trait</a></li><li><a href="#51611-extend-trait">5.16.11. Extend trait</a></li><li><a href="#51612-any-trait">5.16.12. Any trait</a></li><li><a href="#51613-%E5%92%8C%E6%AF%94%E8%BE%83%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%85%B3%E7%9A%84trait">5.16.13. å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„trait</a></li></ul></li><li><a href="#517-%E5%85%83%E7%BB%84">5.17. å…ƒç»„</a></li><li><a href="#518-%E7%BB%93%E6%9E%84%E4%BD%93">5.18. ç»“æ„ä½“</a><ul><li><a href="#5181-%E7%BB%93%E6%9E%84%E4%BD%93%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">5.18.1. ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5182-%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E4%BD%93-and-%E5%8D%95%E5%85%83%E7%BB%93%E6%9E%84%E4%BD%93">5.18.2. å…ƒç»„ç»“æ„ä½“ and å•å…ƒç»“æ„ä½“</a></li><li><a href="#5183-%E7%BB%93%E6%9E%84%E4%BD%93%E6%96%B9%E6%B3%95">5.18.3. ç»“æ„ä½“æ–¹æ³•</a></li><li><a href="#5184-new-type-%E6%A8%A1%E5%BC%8F-%E5%92%8C-%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D-self%E5%88%AB%E5%90%8D">5.18.4. new type æ¨¡å¼ å’Œ ç±»å‹åˆ«å Selfåˆ«å</a></li><li><a href="#5185-%E6%A1%88%E4%BE%8B-%E5%BD%A9%E8%89%B2%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%BE%93%E5%87%BA">5.18.5. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡º</a></li></ul></li><li><a href="#519-%E6%9E%9A%E4%B8%BE">5.19. æšä¸¾</a><ul><li><a href="#5191-%E6%9E%9A%E4%B8%BE%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">5.19.1. æšä¸¾åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5192-option">5.19.2. Option</a></li><li><a href="#5193-c-%E9%A3%8E%E6%A0%BC%E7%9A%84%E6%9E%9A%E4%B8%BE">5.19.3. c é£æ ¼çš„æšä¸¾</a></li><li><a href="#5194-%E6%A1%88%E4%BE%8B-%E5%BD%A9%E8%89%B2%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96">5.19.4. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–</a></li><li><a href="#5195-%E5%AE%9E%E4%BE%8B-%E5%88%9B%E5%BB%BA%E9%93%BE%E8%A1%A8">5.19.5. å®ä¾‹ åˆ›å»ºé“¾è¡¨</a></li></ul></li><li><a href="#520-match-%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D">5.20. match æ¨¡å¼åŒ¹é…</a><ul><li><a href="#5201-%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8">5.20.1. æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨</a></li><li><a href="#5202-if-lef-while-let-%E8%AF%AD%E6%B3%95%E7%B3%96">5.20.2. if lef while let è¯­æ³•ç³–</a></li></ul></li><li><a href="#521-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">5.21. é”™è¯¯å¤„ç†</a><ul><li><a href="#5211-%E6%96%AD%E8%A8%80">5.21.1. æ–­è¨€</a></li><li><a href="#5212-panic-%E5%92%8C-abort">5.21.2. panic å’Œ Abort</a></li><li><a href="#5213-result--%E5%92%8C-%E9%97%AE%E5%8F%B7%E6%93%8D%E4%BD%9C%E7%AC%A6">5.21.3. Result  å’Œ é—®å·æ“ä½œç¬¦</a></li><li><a href="#5214-%E9%94%99%E8%AF%AF%E8%A3%85%E7%AE%B1-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8">5.21.4. é”™è¯¯è£…ç®± è‡ªå®šä¹‰å¼‚å¸¸</a></li><li><a href="#5215-%E6%8D%95%E8%8E%B7%E5%BC%82%E5%B8%B8">5.21.5. æ•è·å¼‚å¸¸</a></li><li><a href="#5216-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E8%BF%9B%E5%8C%96%E8%BF%87%E7%A8%8B">5.21.6. é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹</a></li><li><a href="#5217-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8">5.21.7. ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸</a></li></ul></li><li><a href="#522-io">5.22. io</a><ul><li><a href="#5221-%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0">5.22.1. å‘½ä»¤è¡Œå‚æ•°</a></li><li><a href="#5222-%E6%96%87%E4%BB%B6-io">5.22.2. æ–‡ä»¶ io</a></li></ul></li><li><a href="#523-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-oop">5.23. é¢å‘å¯¹è±¡ oop</a><ul><li><a href="#5231-%E5%8F%AF%E8%A7%81%E6%80%A7">5.23.1. å¯è§æ€§</a></li><li><a href="#5232-%E5%A4%9A%E6%80%81">5.23.2. å¤šæ€</a></li><li><a href="#5233-%E5%90%91%E4%B8%8B%E8%BD%AC%E5%9E%8B">5.23.3. å‘ä¸‹è½¬å‹</a></li><li><a href="#5234-%E5%90%84%E7%A7%8Dself%E5%8C%BA%E5%88%86%E4%BD%BF%E7%94%A8">5.23.4. å„ç§selfåŒºåˆ†ä½¿ç”¨</a></li><li><a href="#5235-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">5.23.5. è®¾è®¡æ¨¡å¼</a><ul><li><a href="#52351-%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F">5.23.5.1. å»ºé€ è€…æ¨¡å¼</a></li><li><a href="#52352-%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F">5.23.5.2. è®¿é—®è€…æ¨¡å¼</a></li><li><a href="#52353-raii%E6%A8%A1%E5%BC%8F">5.23.5.3. raiiæ¨¡å¼</a></li></ul></li></ul></li><li><a href="#524-%E5%AD%90%E8%BF%9B%E7%A8%8B">5.24. å­è¿›ç¨‹</a></li><li><a href="#525-%E5%8F%8D%E5%B0%84">5.25. åå°„</a></li><li><a href="#526-%E5%AE%8F">5.26. å®</a><ul><li><a href="#5261-%E5%AE%8F%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D">5.26.1. å®åŸºæœ¬ä»‹ç»</a></li><li><a href="#5262-%E5%A3%B0%E6%98%8E%E5%AE%8F">5.26.2. å£°æ˜å®</a><ul><li><a href="#52621-%E5%88%9B%E5%BB%BA%E5%AE%8F">5.26.2.1. åˆ›å»ºå®</a></li><li><a href="#52622-%E9%87%8D%E5%A4%8D%E5%BE%AA%E7%8E%AF%E5%8C%B9%E9%85%8D">5.26.2.2. é‡å¤å¾ªç¯åŒ¹é…</a></li><li><a href="#52623-%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B">5.26.2.3. å®é™…æ¡ˆä¾‹</a></li></ul></li><li><a href="#5263-%E5%AE%8F%E8%B0%83%E8%AF%95">5.26.3. å®è°ƒè¯•</a></li><li><a href="#5264-%E8%BF%87%E7%A8%8B%E5%AE%8F">5.26.4. è¿‡ç¨‹å®</a><ul><li><a href="#52641-%E8%BF%87%E7%A8%8B%E5%AE%8F%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99">5.26.4.1. è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™</a></li><li><a href="#52642-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%AE%8F">5.26.4.2. è‡ªå®šä¹‰å±æ€§å®</a></li><li><a href="#52643-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E5%AE%8F">5.26.4.3. å‡½æ•°è°ƒç”¨å®</a></li><li><a href="#52644-derive-%E5%AE%8F">5.26.4.4. derive å®</a></li></ul></li><li><a href="#5265-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8C%85">5.26.5. ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…</a></li><li><a href="#5266-%E7%BC%96%E8%AF%91%E5%99%A8%E6%8F%92%E4%BB%B6">5.26.6. ç¼–è¯‘å™¨æ’ä»¶</a></li></ul></li></ul></li><li><a href="#6-unsafe-%E5%B1%8F%E8%94%BD%E5%86%85%E5%AD%98%E5%AE%89%E5%85%A8%E6%A3%80%E6%9F%A5">6. unsafe å±è”½å†…å­˜å®‰å…¨æ£€æŸ¥</a><ul><li><a href="#61-unsafe-%E5%9F%BA%E6%9C%AC%E5%9C%BA%E6%99%AF">6.1. unsafe åŸºæœ¬åœºæ™¯</a></li><li><a href="#62-%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91">6.2. äº¤å‰ç¼–è¯‘</a></li><li><a href="#63-ffi-%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%E6%8E%A5%E5%8F%A3">6.3. ffi å¤–éƒ¨å‡½æ•°æ¥å£</a><ul><li><a href="#631-ffi-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D">6.3.1. ffi åŸºæœ¬ä»‹ç»</a></li><li><a href="#632-%E5%92%8C-elixir-%E4%BA%A4%E4%BA%92">6.3.2. å’Œ elixir äº¤äº’</a></li><li><a href="#633-%E5%92%8Cc-cpp-%E4%BA%A4%E4%BA%92">6.3.3. å’Œc cpp äº¤äº’</a><ul><li><a href="#6331-%E5%9C%A8-rust-%E4%B8%AD%E8%B0%83%E7%94%A8-c-%E5%87%BD%E6%95%B0">6.3.3.1. åœ¨ rust ä¸­è°ƒç”¨ C å‡½æ•°</a></li><li><a href="#6332-%E5%9C%A8-rust%E8%B0%83%E7%94%A8-cpp">6.3.3.2. åœ¨ rustè°ƒç”¨ cpp</a></li><li><a href="#6333-%E5%9C%A8-c-%E4%B8%AD%E8%B0%83%E7%94%A8-rust">6.3.3.3. åœ¨ c ä¸­è°ƒç”¨ rust</a></li></ul></li><li><a href="#634-%E5%92%8C-python-%E4%BA%A4%E4%BA%92">6.3.4. å’Œ Python äº¤äº’</a></li><li><a href="#635-%E5%92%8C-swift">6.3.5. å’Œ Swift</a></li><li><a href="#636-%E5%92%8C-js-javascript-nodejs-%E4%BA%A4%E4%BA%92">6.3.6. å’Œ js JavaScript nodejs äº¤äº’</a></li><li><a href="#637-%E5%92%8C-java-%E4%BA%A4%E4%BA%92">6.3.7. å’Œ java äº¤äº’</a><ul><li><a href="#6371-java-%E8%B0%83%E7%94%A8-rust">6.3.7.1. java è°ƒç”¨ rust</a></li><li><a href="#6372-rust-%E8%B0%83%E7%94%A8-java">6.3.7.2. rust è°ƒç”¨ java</a></li></ul></li></ul></li></ul></li><li><a href="#7-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86">7. å†…å­˜ç®¡ç†</a><ul><li><a href="#71-%E5%A0%86-%E5%92%8C-%E6%A0%88">7.1. å † å’Œ æ ˆ</a></li><li><a href="#72-%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90">7.2. å†…å­˜å¯¹é½</a></li><li><a href="#73-%E6%89%8B%E5%8A%A8%E5%A0%86%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D">7.3. æ‰‹åŠ¨å †å†…å­˜åˆ†é…</a></li></ul></li><li><a href="#8-%E5%B7%A5%E7%A8%8B%E7%AE%A1%E7%90%86-%E6%A8%A1%E5%9D%97">8. å·¥ç¨‹ç®¡ç† æ¨¡å—</a><ul><li><a href="#81-%E6%A6%82%E5%BF%B5%E7%AE%80%E5%8D%95%E8%A7%A3%E9%87%8A">8.1. æ¦‚å¿µç®€å•è§£é‡Š</a></li><li><a href="#82-%E5%8F%AF%E8%A7%81%E6%80%A7%E7%AE%A1%E7%90%86">8.2. å¯è§æ€§ç®¡ç†</a></li><li><a href="#83-%E7%BC%96%E8%AF%91%E5%99%A8%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86">8.3. ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†</a></li><li><a href="#84-%E4%B8%BA%E9%A1%B9%E7%9B%AE%E5%8D%95%E7%8B%AC%E6%8C%87%E5%AE%9Aconfig-%E9%85%8D%E7%BD%AE">8.4. ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig é…ç½®</a></li><li><a href="#85-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86-cargo">8.5. ä¾èµ–ç®¡ç† cargo</a><ul><li><a href="#851-cargo-%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4">8.5.1. cargo åŸºæœ¬å‘½ä»¤</a></li><li><a href="#852-%E6%96%87%E4%BB%B6%E5%B8%83%E5%B1%80%E7%BB%93%E6%9E%84">8.5.2. æ–‡ä»¶å¸ƒå±€ç»“æ„</a></li><li><a href="#853-cargotoml">8.5.3. Cargo.toml</a></li><li><a href="#854-cargolock">8.5.4. cargo.lock</a></li><li><a href="#855-workspace">8.5.5. workspace</a></li><li><a href="#856-%E4%BE%9D%E8%B5%96%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7%E8%A7%84%E5%88%99">8.5.6. ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™</a></li></ul></li><li><a href="#86-buildrs">8.6. build.rs</a></li><li><a href="#87-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E6%A1%88%E4%BE%8B">8.7. é¡¹ç›®ç®¡ç†æ¡ˆä¾‹</a><ul><li><a href="#871-%E5%AF%BC%E5%87%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%8F">8.7.1. å¯¼å‡ºè‡ªå®šä¹‰å®</a></li><li><a href="#872-%E5%AF%BC%E5%85%A5%E8%87%AA%E5%AE%9A%E4%B9%89-crate">8.7.2. å¯¼å…¥è‡ªå®šä¹‰ crate</a></li><li><a href="#873-%E6%89%A7%E8%A1%8C%E5%AD%90%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84-module">8.7.3. æ‰§è¡Œå­ç›®å½•ä¸­çš„ module</a></li><li><a href="#874-%E5%AF%BC%E5%85%A5%E8%87%AA%E5%AE%9A%E4%B9%89-module">8.7.4. å¯¼å…¥è‡ªå®šä¹‰ module</a></li><li><a href="#875-%E5%AF%BC%E5%85%A5%E7%AC%AC%E4%B8%89%E6%96%B9-crate">8.7.5. å¯¼å…¥ç¬¬ä¸‰æ–¹ crate</a></li></ul></li></ul></li><li><a href="#9-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">9. å•å…ƒæµ‹è¯•</a></li><li><a href="#10-%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91-and-%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91">10. äº¤å‰ç¼–è¯‘ and æ¡ä»¶ç¼–è¯‘</a></li><li><a href="#11-%E5%B9%B6%E5%8F%91">11. å¹¶å‘</a><ul><li><a href="#111-%E9%80%9A%E7%94%A8%E6%A6%82%E5%BF%B5">11.1. é€šç”¨æ¦‚å¿µ</a><ul><li><a href="#1111-%E8%BF%9B%E7%A8%8B-and-%E7%BA%BF%E7%A8%8B">11.1.1. è¿›ç¨‹ and çº¿ç¨‹</a></li><li><a href="#1112-%E4%BA%8B%E4%BB%B6%E5%9B%9E%E8%B0%83%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%BC%82%E6%AD%A5%E5%B9%B6%E5%8F%91">11.1.2. äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘</a></li></ul></li><li><a href="#112-%E7%BA%BF%E7%A8%8B%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">11.2. çº¿ç¨‹åŸºæœ¬ä½¿ç”¨</a><ul><li><a href="#1121-%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B">11.2.1. åˆ›å»ºçº¿ç¨‹</a></li><li><a href="#1122-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E7%BA%BF%E7%A8%8B">11.2.2. è‡ªå®šä¹‰é…ç½®çº¿ç¨‹</a></li><li><a href="#1123-%E7%BA%BF%E7%A8%8B%E6%9C%AC%E5%9C%B0%E5%8F%98%E9%87%8F">11.2.3. çº¿ç¨‹æœ¬åœ°å˜é‡</a></li><li><a href="#1124-%E6%89%8B%E5%8A%A8%E9%98%BB%E5%A1%9E%E5%94%A4%E9%86%92">11.2.4. æ‰‹åŠ¨é˜»å¡å”¤é†’</a></li></ul></li><li><a href="#113-%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5">11.3. çº¿ç¨‹åŒæ­¥</a><ul><li><a href="#1131-%E9%94%99%E8%AF%AF%E7%A4%BA%E4%BE%8B">11.3.1. é”™è¯¯ç¤ºä¾‹</a></li><li><a href="#1132-%E9%94%81">11.3.2. é”</a></li><li><a href="#1133-%E5%8E%9F%E5%AD%90%E7%B1%BB%E5%9E%8B">11.3.3. åŸå­ç±»å‹</a></li><li><a href="#1134-channel">11.3.4. channel</a></li><li><a href="#1135-tokio-%E4%B8%AD%E7%9A%84%E5%90%84%E7%A7%8D-channel-%E5%AE%9E%E7%8E%B0">11.3.5. tokio ä¸­çš„å„ç§ channel å®ç°</a></li></ul></li><li><a href="#114-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B0%8F%E4%BE%8B%E5%AD%90">11.4. å¤šçº¿ç¨‹å°ä¾‹å­</a><ul><li><a href="#1141-%E5%AE%9E%E7%8E%B0%E7%BA%BF%E7%A8%8B%E6%B1%A0">11.4.1. å®ç°çº¿ç¨‹æ± </a></li><li><a href="#1142-%E5%AE%9E%E7%8E%B0-map-reduce-%E7%AE%97%E6%B3%95">11.4.2. å®ç° map-reduce ç®—æ³•</a></li><li><a href="#1143-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BB%9F%E8%AE%A1%E5%92%8C">11.4.3. å¤šçº¿ç¨‹ç»Ÿè®¡å’Œ</a></li><li><a href="#1144-%E5%B8%A6%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84-webserver">11.4.4. å¸¦çº¿ç¨‹æ± çš„ webserver</a></li></ul></li><li><a href="#115-rayon-%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1">11.5. rayon å¹¶è¡Œæ‰§è¡Œä»»åŠ¡</a></li><li><a href="#116-crossbeam-%E6%97%A0%E9%94%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">11.6. CrossBeam æ— é”çš„æ•°æ®ç»“æ„</a></li><li><a href="#117-rwlock-%E5%92%8C-refcell">11.7. RwLock å’Œ RefCell</a></li><li><a href="#118-mutex">11.8. Mutex</a></li><li><a href="#119-atomicptr-%E5%92%8C-cell">11.9. AtomicPtr å’Œ Cell</a></li><li><a href="#1110-send-%E5%92%8C-sync-trait">11.10. Send å’Œ Sync trait</a></li></ul></li><li><a href="#12-%E5%BC%82%E6%AD%A5%E5%B9%B6%E5%8F%91">12. å¼‚æ­¥å¹¶å‘</a><ul><li><a href="#121-%E5%BC%82%E6%AD%A5%E6%A6%82%E5%BF%B5">12.1. å¼‚æ­¥æ¦‚å¿µ</a><ul><li><a href="#1211-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E5%BC%82%E6%AD%A5">12.1.1. ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥</a></li><li><a href="#1212-%E6%99%AE%E9%80%9A%E5%A4%9A%E7%BA%BF%E7%A8%8B-webserver">12.1.2. æ™®é€šå¤šçº¿ç¨‹ webserver</a></li><li><a href="#1213-%E6%94%B9%E8%BF%9B%E5%90%8E%E7%9A%84%E5%BC%82%E6%AD%A5%E7%89%88%E6%9C%AC">12.1.3. æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬</a></li></ul></li><li><a href="#122-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">12.2. åŸºæœ¬ä½¿ç”¨</a><ul><li><a href="#1221-block_on">12.2.1. block<!-- -->_<!-- -->on</a></li><li><a href="#1222-await">12.2.2. await</a></li><li><a href="#1223-joinn">12.2.3. joinn</a></li></ul></li><li><a href="#123-future%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%BC%8F">12.3. futureå¹¶å‘æ¨¡å¼</a><ul><li><a href="#1231-future%E5%BA%95%E5%B1%82%E6%98%AF%E7%94%9F%E6%88%90%E5%99%A8">12.3.1. futureåº•å±‚æ˜¯ç”Ÿæˆå™¨</a></li><li><a href="#1232-future%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E7%94%A8">12.3.2. futureåŸºæœ¬ä½¿ç”¨ç”¨</a></li><li><a href="#1233-%E5%8A%A8%E6%89%8B%E5%AE%9E%E7%8E%B0-future-%E7%B1%BB%E5%9E%8B">12.3.3. åŠ¨æ‰‹å®ç° Future ç±»å‹</a></li><li><a href="#1234-%E5%8A%A8%E6%89%8B%E5%AE%9E%E7%8E%B0-%E5%BC%82%E6%AD%A5-sleep">12.3.4. åŠ¨æ‰‹å®ç° å¼‚æ­¥ sleep</a></li></ul></li><li><a href="#124-async-std">12.4. async-std</a></li><li><a href="#125-tokio">12.5. tokio</a></li></ul></li><li><a href="#13-%E7%AE%80%E5%8D%95%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">13. ç®€å•æ–‡ä»¶ç³»ç»Ÿ</a></li><li><a href="#14-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B">14. ç½‘ç»œç¼–ç¨‹</a><ul><li><a href="#141-tcp">14.1. tcp</a></li><li><a href="#142-udp">14.2. udp</a></li></ul></li><li><a href="#15-%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6">15. æ¶ˆæ¯ä¸­é—´ä»¶</a></li><li><a href="#16-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91">16. æ¸¸æˆå¼€å‘</a></li><li><a href="#17-%E7%88%AC%E8%99%AB">17. çˆ¬è™«</a></li><li><a href="#18-rpc-%E6%A1%86%E6%9E%B6">18. rpc æ¡†æ¶</a></li><li><a href="#19-%E7%BC%96%E5%86%99%E4%BB%A3%E7%90%86">19. ç¼–å†™ä»£ç†</a><ul><li><a href="#191-http-%E4%BB%A3%E7%90%86">19.1. http ä»£ç†</a></li><li><a href="#192-socket-%E4%BB%A3%E7%90%86">19.2. socket ä»£ç†</a></li></ul></li><li><a href="#20-%E5%BC%80%E5%8F%91%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F-web-%E6%B8%B8%E6%88%8F">20. å¼€å‘å¾®ä¿¡å°ç¨‹åº-web æ¸¸æˆ</a></li><li><a href="#21-%E7%AC%AC%E4%B8%89%E6%96%B9-crates">21. ç¬¬ä¸‰æ–¹ crates</a><ul><li><a href="#211-%E4%BA%8B%E5%AE%9E%E4%B8%8A%E7%9A%84%E6%A0%87%E5%87%86%E5%BA%93">21.1. äº‹å®ä¸Šçš„æ ‡å‡†åº“</a></li><li><a href="#212-markdown">21.2. markdown</a></li><li><a href="#213-%E6%A1%8C%E9%9D%A2%E5%BC%80%E5%8F%91">21.3. æ¡Œé¢å¼€å‘</a></li><li><a href="#214-%E8%A7%86%E9%A2%91%E5%A4%84%E7%90%86">21.4. è§†é¢‘å¤„ç†</a></li><li><a href="#215-%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86">21.5. å›¾ç‰‡å¤„ç†</a></li><li><a href="#216-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91%E4%B8%89%E6%96%B9%E5%BA%93">21.6. æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“</a></li><li><a href="#217-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF">21.7. ç³»ç»Ÿä¿¡æ¯</a></li><li><a href="#218-web-%E5%BC%80%E5%8F%91%E5%8F%91">21.8. web å¼€å‘å‘</a><ul><li><a href="#2181-swagger-openapi-%E7%94%9F%E6%88%90">21.8.1. swagger openapi ç”Ÿæˆ</a></li><li><a href="#2182-web%E6%A1%86%E6%9E%B6">21.8.2. webæ¡†æ¶</a></li><li><a href="#2183-orm">21.8.3. orm</a></li><li><a href="#2184-http-client">21.8.4. http client</a></li></ul></li><li><a href="#219-%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96">21.9. åºåˆ—åŒ–ååºåˆ—åŒ–</a><ul><li><a href="#2191-toml">21.9.1. toml</a></li><li><a href="#2192-json">21.9.2. json</a></li></ul></li><li><a href="#2110-%E8%AF%BB%E5%86%99%E6%95%B0%E6%8D%AE">21.10. è¯»å†™æ•°æ®</a></li><li><a href="#2111-%E5%A2%9E%E5%BC%BA%E5%B7%A5%E5%85%B7">21.11. å¢å¼ºå·¥å…·</a></li><li><a href="#2112-%E6%8E%88%E6%9D%83-authorization">21.12. æˆæƒ Authorization</a></li><li><a href="#2113-%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F">21.13. æ—¥å¿—ç³»ç»Ÿ</a><ul><li><a href="#21131-tracing">21.13.1. tracing</a></li><li><a href="#21132-env_logger">21.13.2. env<!-- -->_<!-- -->logger</a></li><li><a href="#21133-log4rs-and-log">21.13.3. log4rs and log</a></li></ul></li><li><a href="#2114-%E6%96%87%E6%9C%AC%E8%A7%A3%E6%9E%90%E5%99%A8-parser">21.14. æ–‡æœ¬è§£æå™¨ parser</a></li><li><a href="#2115-lazy-static-%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96">21.15. lazy static å»¶è¿Ÿåˆå§‹åŒ–</a></li><li><a href="#2116-%E7%94%B5%E5%AD%90%E4%B9%A6">21.16. ç”µå­ä¹¦</a></li><li><a href="#2117-%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%A8%8B%E5%BA%8F">21.17. å‘½ä»¤è¡Œç¨‹åº</a><ul><li><a href="#21171-structopt">21.17.1. structopt</a></li><li><a href="#21172-clap">21.17.2. clap</a></li></ul></li><li><a href="#2118-%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B">21.18. å¼‚æ­¥ç¼–ç¨‹</a></li><li><a href="#2119-websocket">21.19. websocket</a></li><li><a href="#2120-%E7%BC%A9%E5%B0%8F%E4%BD%93%E7%A7%AF">21.20. ç¼©å°ä½“ç§¯</a></li><li><a href="#2121-http-client">21.21. http client</a></li><li><a href="#2122-%E5%AE%B9%E9%94%99%E8%BF%90%E8%A1%8C%E6%97%B6">21.22. å®¹é”™è¿è¡Œæ—¶</a></li><li><a href="#2123-%E7%9B%91%E6%8E%A7">21.23. ç›‘æ§</a></li><li><a href="#2124-%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6">21.24. ç”µå­é‚®ä»¶</a></li><li><a href="#2125-%E5%88%86%E5%8F%91%E5%B7%A5%E5%85%B7">21.25. åˆ†å‘å·¥å…·</a></li><li><a href="#2126-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B">21.26. å¹¶å‘ç¼–ç¨‹</a></li><li><a href="#2127-gui-%E5%9B%BE%E5%BD%A2%E5%BA%93">21.27. gui å›¾å½¢åº“</a></li><li><a href="#2128-%E5%BA%95%E5%B1%82%E7%BD%91%E7%BB%9C-api">21.28. åº•å±‚ç½‘ç»œ api</a></li><li><a href="#2129-%E6%AD%A3%E5%88%99">21.29. æ­£åˆ™</a></li><li><a href="#2130-%E9%9A%8F%E6%9C%BA">21.30. éšæœº</a><ul><li><a href="#21301-rand-%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%AD%97">21.30.1. rand éšæœºæ•°å­—</a></li></ul></li><li><a href="#2131-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E">21.31. æœç´¢å¼•æ“</a></li><li><a href="#2132-%E5%BC%80%E6%BA%90%E9%9B%86%E5%90%88%E5%AE%B9%E5%99%A8">21.32. å¼€æºé›†åˆå®¹å™¨</a></li></ul></li><li><a href="#22-%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE">22. å¼€æºé¡¹ç›®</a></li><li><a href="#23-%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">23. å‚è€ƒé“¾æ¥</a></li></ul><h1>1. ç®€å•ä»‹ç»</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-pros-and-cons">1.1. Pros and Cons<a href="#11-pros-and-cons" class="hash-link" aria-label="1.1. Pros and Consçš„ç›´æ¥é“¾æ¥" title="1.1. Pros and Consçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Pros</p><ul><li>åœ¨æ²¡æœ‰ GC çš„åŠ æŒä¸‹, ä»è¯­è¨€å±‚é¢å®ç°äº†å†…å­˜å®‰å…¨ (å½“ç„¶äº†, ä»£ä»·å°±æ˜¯å¼•å…¥äº†ç”Ÿå‘½å‘¨æœŸ, æ‰€æœ‰æƒæœºåˆ¶...)</li><li>è¯ç”Ÿçš„æ™š, è¯­è¨€ç‰¹æ€§åšé‡‡ä¼—é•¿, è¯­æ³•ä¼˜ç¾å¯Œæœ‰è¡¨ç°åŠ› (æˆ‘æƒ³è¿™æ˜¯å¾ˆå¸å¼•äººçš„ä¸€ç‚¹)<ul><li>å¦‚å¸æ”¶äº† scalaä¸­çš„Optionï¼ŒSomeï¼ŒNone; </li><li>golangä¸­çš„åˆå§‹åŒ–è¯­æ³•ï¼Œchannel</li><li>jsçš„async await</li></ul></li><li>åŒæ—¶å’Œå…¶ä»–è¯­è¨€çš„äº¤äº’æ›´æ–¹ä¾¿, ffi æ›´å®¹æ˜“ä½¿ç”¨....</li></ul><p>Cons</p><ul><li>ç¼–è¯‘ç‰¹åˆ«æ…¢, å°¤å…¶å’Œè€å¯¹æ‰‹ go æ¯”è¾ƒ</li><li>è¯­æ³•å¤æ‚, ç‰¹åˆ«æ˜¯å¤¹æ‚äº†ç”Ÿå‘½å‘¨æœŸçš„è¯­æ³•å, ä»£ç ç‰¹åˆ«éš¾è¯»</li><li>å®çš„è¯­æ³•å¾ˆå¥‡æ€ª, æ¯”å¦‚ <code>#[cfg(all(not(baremetal), any(feature = â€œhazmatâ€, feature = â€œdebug_printâ€)))]</code>, ä½¿ç”¨â€˜=â€™æ¥è¡¨ç¤ºç­‰ä»·è€Œä¸æ˜¯èµ‹å€¼</li><li>å…è®¸å˜é‡é‡å¤å®šä¹‰(å°±æ˜¯å˜é‡åç›¸åŒ, ä½†æ˜¯ç±»å‹ä¸åŒ)<blockquote><p>æˆ‘è§‰å¾—æ˜¯ä¸å¥½çš„è®¾è®¡; å®˜æ–¹è¯´æ³•æ˜¯è¯´ä¸ºäº†å¯ä»¥åœ¨ç±»å‹è½¬æ¢çš„æ—¶å€™æ–¹ä¾¿åœ°å‘½åå˜é‡, ä½†æ˜¯è¿™æ ·çœŸçš„å¢åŠ äº†é˜…è¯»ä»£ç çš„å¿ƒæ™ºè´Ÿæ‹…</p><p>è¿™ä¸ªç‚¹å¥½åƒæœ‰è§£: å¼€clippy lintå¯ä»¥ç¦æ‰</p></blockquote></li><li>if letè¯­æ³•ç³–, å­˜åœ¨ä¸€ä¸ªè¯­ä¹‰ä¸ä¸€è‡´çš„é—®é¢˜<blockquote><p>ifå’Œletéƒ½åˆ†åˆ«æœ‰å„è‡ªçš„æ„æ€ï¼Œifåé¢åªèƒ½è·Ÿboolï¼Œletè¡¨è¾¾å¼å¹¶ä¸evaluateæˆboolç±»å‹ï¼Œè¿™é‡Œçš„if letå®ç°çš„æ˜¯pattern matchçš„åŠŸèƒ½ï¼Œè™½ç„¶letä¹Ÿå¯ä»¥ç”¨æ¥pattern matchï¼Œä½†æ˜¯å’ŒifåŸæœ¬çš„è¯­ä¹‰ä¸åè°ƒ, å¯ä»¥è¯´è®¾è®¡çš„ä¸å¤Ÿå¥½</p></blockquote></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12-æ¶æ„">1.2. æ¶æ„<a href="#12-æ¶æ„" class="hash-link" aria-label="1.2. æ¶æ„çš„ç›´æ¥é“¾æ¥" title="1.2. æ¶æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">å¥½çš„æ¶æ„éœ€è¦æœ‰æ¸…æ™°çš„æ¦‚å¿µ</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">è½¯ä»¶å²ä¸Šä¼˜é›…çš„æ¶æ„è®¾è®¡é€šå¸¸æœ‰ä¼˜é›…çš„æ¦‚å¿µ</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> socket </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> stream </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">flow </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> pipe </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    æ¯”å¦‚è¯´</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ç°åœ¨éœ€è¦å¯¹è¾“å…¥çš„ä¸€æ®µæ–‡æœ¬ç»Ÿè®¡æŸä¸ªå•è¯çš„ä¸ªæ•°</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> é‚£ä¹ˆé¦–å…ˆéœ€è¦è¿›è¡Œåˆ‡å‰²</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> è¿™ä¸ªåŠ¨ä½œå¯ä»¥æŠ½è±¡å‡ºä¸€ä¸ªæ¦‚å¿µ</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> å«åš </span><span class="token function" style="color:rgb(0, 0, 255)">åˆ†è¯</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">tokenize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ç„¶åæ˜¯å¯¹æ¯ä¸ªè¯åšå¤„ç†</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> è¿™ä¸ªå¤„ç†å¯èƒ½æ˜¯çº¿æ€§çš„</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ä¹Ÿå¯èƒ½æ˜¯å¹¶è¡Œçš„</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> è¿™ä¸ªæ¦‚å¿µå«åš map </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å¥½çš„æ¶æ„æœ‰å®šä¹‰æ¸…æ™°çš„æ¥å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å¥½çš„æ¶æ„è¦èƒ½å¤Ÿå»¶è¿Ÿå†³ç­–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> å‡½æ•°æ˜¯ä»£ç å—çš„å»¶è¿Ÿç»‘å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> ç±»å‹æ˜¯å€¼çš„å»¶è¿Ÿç»‘å®š </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> æ³›å‹æ˜¯ç±»å‹çš„ å»¶è¿Ÿç»‘å®š </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> æ³›å‹å‡½æ•°æ˜¯å‡½æ•°çš„å»¶è¿Ÿç»‘å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> é…ç½®æ˜¯ä¸šåŠ¡é€»è¾‘çš„ å»¶è¿Ÿç»‘å®š </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> ç”¨æˆ·ä»£ç æ˜¯å»¶è¿Ÿç»‘å®šçš„æœ€é«˜è¡¨ç°å½¢å¼</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> æ¯”å¦‚ nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13-ä¼˜ç‚¹-å¯¹æ¯”">1.3. ä¼˜ç‚¹ å¯¹æ¯”<a href="#13-ä¼˜ç‚¹-å¯¹æ¯”" class="hash-link" aria-label="1.3. ä¼˜ç‚¹ å¯¹æ¯”çš„ç›´æ¥é“¾æ¥" title="1.3. ä¼˜ç‚¹ å¯¹æ¯”çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ul><li><p>é«˜æ€§èƒ½: é›¶æˆæœ¬æŠ½è±¡</p></li><li><p>å®‰å…¨æ€§: æ‰€æœ‰æƒç³»ç»Ÿå‡ ä¹è§£å†³äº†é‡æŒ‡é’ˆ, å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿ</p></li><li><p>è¡¨è¾¾åŠ›</p></li><li><p>ç”Ÿæ€å·¥å…·å®Œå¤‡: è‡ªå¸¦æµ‹è¯•, cargo å·¥å…·</p></li></ul><p><a href="https://opensource.com/article/20/5/rust-java" target="_blank" rel="noopener noreferrer">https://opensource.com/article/20/5/rust-java</a> ä¸ºä»€ä¹ˆjava -&gt; rust</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="14-æ€æƒ³">1.4. æ€æƒ³<a href="#14-æ€æƒ³" class="hash-link" aria-label="1.4. æ€æƒ³çš„ç›´æ¥é“¾æ¥" title="1.4. æ€æƒ³çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ul><li><p>æ˜ç¡® : æœ‰å¾ˆå¤šå…¶ä»–è¯­è¨€åƒ Python, java, ä¸ºäº†ç…§é¡¾åˆå­¦è€…ä»–ä¼šæŠŠå¾ˆå¤šåŸºæœ¬çš„æ¦‚å¿µéšè—åœ¨è¯­æ³•çš„åé¢, æ¯”å¦‚æ¯ä¸€æ¡è¯­å¥çš„å˜é‡åˆ†é…, åœ¨å †è¿˜æ˜¯åœ¨æ ˆæ‰§è¡Œ, éƒ½è¢«å±è”½äº†, åœ¨åšä¸€äº›æ€§èƒ½ä¼˜åŒ–, å’Œå…¶ä»–è¯­è¨€è¿›è¡Œäº¤äº’å°±ä¼šæš´éœ²é—®é¢˜</p></li><li><p>é›¶æˆæœ¬æŠ½è±¡(zero cost abstract): (ç¼–è¯‘æœŸé—´å³å¯ç¼–è¯‘æˆæœºå™¨ç , è¿è¡Œæ—¶æ²¡æœ‰å¼€é”€), æ²¡æœ‰ runtime å’Œ gc, å’Œ c æ— ç¼äº¤äº’, æ¯”å¦‚ future å°±æ˜¯ä¸€ä¸ªå¾ˆæ¼‚æµªçš„æŠ½è±¡</p></li><li><p>å…¨èƒ½: ä»ç³»ç»Ÿå±‚åˆ° web å±‚, éƒ½å¯ä»¥ä½¿ç”¨ rust å¼€å‘</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="15-è¯­ä¹‰-æ¦‚å¿µ">1.5. è¯­ä¹‰ æ¦‚å¿µ<a href="#15-è¯­ä¹‰-æ¦‚å¿µ" class="hash-link" aria-label="1.5. è¯­ä¹‰ æ¦‚å¿µçš„ç›´æ¥é“¾æ¥" title="1.5. è¯­ä¹‰ æ¦‚å¿µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ol><li>èŒƒå¼: é¢å‘å¯¹è±¡ , å‡½æ•°å¼</li><li>è¯­ä¹‰: æ‰€æœ‰æƒ, move, copy, å€Ÿç”¨, lifecycle, drop</li><li>ç±»å‹ç³»ç»Ÿ: æ³›å‹, trait, å¤šæ€, ç±»å‹æ¨æ–­</li><li>å†…å­˜ç®¡ç†: heap, stack, raii</li></ol><p>1, 2, 3 ç‚¹æ¶‰åŠåˆ°å¼€å‘è€…çš„æ“ä½œ, 2,3,4 ç¼–è¯‘å™¨æ“ä½œ</p><h1>2. å¼€å‘ç¯å¢ƒé…ç½®</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21-install">2.1. install<a href="#21-install" class="hash-link" aria-label="2.1. installçš„ç›´æ¥é“¾æ¥" title="2.1. installçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>git ç¯å¢ƒæ”¯æŒ</p><p><a href="https://www.rust-lang.org/tools/install" target="_blank" rel="noopener noreferrer">https://www.rust-lang.org/tools/install</a></p><p>ä¼šè‡ªåŠ¨å®‰è£… cargo</p><p>å®‰è£…å®Œæˆåé€€å‡ºå†æ¬¡è¿›å…¥ terminal, rustc ç­‰å‘½ä»¤è‡ªåŠ¨åŠ å…¥ path äº†</p><p>ç»™nightlyé€šé“ç”¨æˆ·çš„å°æç¤ºï¼šåœ¨æ›´æ–°rustä¹‹åä½¿ç”¨cargo-sweepæ¥å¸®åŠ©ä½ æ¸…ç†åƒåœ¾
å¯¹äºnightlyé€šé“çš„ç”¨æˆ·æ¥è¯´ï¼Œé€šå¸¸åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šä¼´éšç€é¢‘ç¹çš„å‡çº§ä½ çš„rustç‰ˆæœ¬ï¼Œè€Œå¯¹äºæ—¥å¸¸ç»´æŠ¤çš„é¡¹ç›®ï¼Œå¦‚æœä½ å‡çº§äº†rustç‰ˆæœ¬ä¹‹åï¼Œtargetç¼–è¯‘æ–‡ä»¶å¤¹é‡Œé¢ä¼šç”Ÿæˆå¤šä¸ªç‰ˆæœ¬çš„ç¼–è¯‘æ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å°±æ˜¯ä½¿ç”¨cargo sweepçš„æ—¶å€™äº†ï¼Œå®ƒä¼šå¸®ä½ æ¸…ç†æ‰é™¤äº†å½“å‰ç‰ˆæœ¬ä»¥å¤–çš„targetç›®å½•ä¸‹å¤šä½™çš„æ–‡ä»¶ã€‚</p><p>ç”¨ä¾‹ï¼š cargo sweep -i -r -v ~/src</p><p>-i æ˜¯å¼€å¯ä¿ç•™~/srcç›®å½•ä¸‹targetæ–‡ä»¶å¤¹å†…å½“å‰ç”µè„‘ä¸Šå·²å®‰è£…rustç‰ˆæœ¬çš„ç¼–è¯‘æ–‡ä»¶ã€‚
-r æ˜¯å¼€å¯é€’å½’ï¼ˆrecursivelyï¼‰æœç´¢
-v æ˜¯å¼€å¯è¯¦ç»†ï¼ˆå•°å—¦æ¨¡å¼ï¼Œå¼€å¯ä¹‹åä¼šå‘Šè¯‰ä½ å®ƒå¹²äº†å•¥ã€‚ï¼‰
å¦‚æœä½ çš„ç”µè„‘ä¸Šæ²¡æœ‰cargo sweepï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š cargo install cargo-sweep</p><p>Read More: <a href="https://www.reddit.com/r/rust/comments/jfdiao/tip_for_nightly_users_use_cargosweep_after/" target="_blank" rel="noopener noreferrer">https://www.reddit.com/r/rust/comments/jfdiao/tip_for_nightly_users_use_cargosweep_after/</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22-å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨">2.2. å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨<a href="#22-å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨" class="hash-link" aria-label="2.2. å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="2.2. å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">rustc --version</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç¼–è¯‘å•ä¸ªæ–‡ä»¶, ç”Ÿæˆ xxx å¯æ‰§è¡Œæ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustc &lt;xxx.rs&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç¼–è¯‘ è¿è¡Œ dry.rs ä¸‹çš„ test mod, æ— éœ€ mainå‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustc --test dry.rs &amp;&amp; ./dry</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç®¡ç† rust ç‰ˆæœ¬, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup update</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># rust æœ‰ stable (é»˜è®¤)ã€nightly ç‰ˆæœ¬ä¹‹åˆ†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup install nightly</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å½“å‰é¡¹ç›®ä¸‹ç”Ÿæ•ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup override set nightly</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup override set stable</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è®¾ç½®é»˜è®¤å€¼, å¯¹å…¨å±€æ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup default stable</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup default nightly</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup default # show current version</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="23-ide">2.3. IDE<a href="#23-ide" class="hash-link" aria-label="2.3. IDEçš„ç›´æ¥é“¾æ¥" title="2.3. IDEçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ol><li><p>vscode + rust-analyzer + CodeLLDB  (debug, format) + even better toml (toml support) + crates (view crate version) + advanced-new-file + error lens (show error msg in editor) + github copilot + idea keybindings</p></li><li><p>clion/idea + rust æ’ä»¶ + toml æ’ä»¶ + NativeDebugæ’ä»¶</p></li></ol><p>å…¶ä»–ä»£ç æç¤ºé…ç½®: (æ¨è vscode + æ’ä»¶, å°±æ— éœ€å¦‚ä¸‹çš„é…ç½®äº†)</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># https://www.jianshu.com/p/c952db541d79</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä»£ç æç¤º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo install racer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœä¸æˆåŠŸ, å‡çº§åˆ° nightly</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup install nightly</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœæŠ¥é”™ï¼Œåˆ™éœ€è¦åˆ‡æ¢åˆ°nightlyç‰ˆæœ¬çš„ç¼–è¯‘å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç„¶åå†æ¬¡ å®‰è£… racer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup default nightly</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æˆ–è€… ç›´æ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo +nightly install racer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä»£ç åˆ†æ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup component add clippy</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="24-é…ç½®å›½å†…é•œåƒ">2.4. é…ç½®å›½å†…é•œåƒ<a href="#24-é…ç½®å›½å†…é•œåƒ" class="hash-link" aria-label="2.4. é…ç½®å›½å†…é•œåƒçš„ç›´æ¥é“¾æ¥" title="2.4. é…ç½®å›½å†…é•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://www.cnblogs.com/dhcn/p/12100675.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/dhcn/p/12100675.html</a></p><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[registry]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">token = &quot;xxx crate.io token&quot; # æ³¨å†Œè´¦å·åç”±ç½‘ç«™é¢å‘, ç”¨äºå‘å¸ƒåŒ…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ”¾åˆ° `$HOME/.cargo/config` æ–‡ä»¶ä¸­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[source.crates-io]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">registry = &quot;https://github.com/rust-lang/crates.io-index&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ›¿æ¢æˆä½ åå¥½çš„é•œåƒæº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">replace-with = &#x27;rustcc&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#replace-with = &#x27;ustc&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ¸…åå¤§å­¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[source.tuna]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">registry = &quot;https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[source.ustc]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">registry = &quot;git://mirrors.ustc.edu.cn/crates.io-index&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸Šæµ·äº¤é€šå¤§å­¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[source.sjtu]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">registry = &quot;https://mirrors.sjtug.sjtu.edu.cn/git/crates.io-index&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># rustccç¤¾åŒº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[source.rustcc]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">registry = &quot;git://crates.rustcc.cn/crates.io-index&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å‘½ä»¤åˆ«å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[alias]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">b = &quot;build&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">t = &quot;test&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">r = &quot;run&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rr = &quot;run --release&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ben = &quot;bench&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">space_example = [&quot;run&quot;, &quot;--release&quot;, &quot;--&quot;, &quot;\&quot;command list\&quot;&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>3. æ ‡å‡†åº“</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-path-è·¯å¾„">3.1. path è·¯å¾„<a href="#31-path-è·¯å¾„" class="hash-link" aria-label="3.1. path è·¯å¾„çš„ç›´æ¥é“¾æ¥" title="3.1. path è·¯å¾„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// Path å¯ä» OsStr ç±»å‹åˆ›å»º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// Path åˆ†ä¸ºä¸¤ç§ï¼šposix::Pathï¼Œé’ˆå¯¹ ç±» UNIX ç³»ç»Ÿï¼›ä»¥åŠ windows::Pathï¼Œé’ˆå¯¹ Windowsã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// prelude ä¼šé€‰æ‹©å¹¶è¾“å‡ºç¬¦åˆå¹³å°ç±»å‹ çš„ Path ç§ç±»ã€‚(prelude æ˜¯ Rust è‡ªåŠ¨åœ°åœ¨æ¯ä¸ªç¨‹åºä¸­å¯¼å…¥çš„ä¸€äº›é€šç”¨çš„ä¸œè¥¿)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// Path åœ¨å†…éƒ¨å¹¶ä¸æ˜¯ç”¨ UTF-8 å­—ç¬¦ä¸²è¡¨ç¤ºçš„ï¼Œè€Œæ˜¯å­˜å‚¨ä¸ºè‹¥å¹²å­—èŠ‚ï¼ˆVec&lt;u8&gt;ï¼‰çš„ vectorã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å› æ­¤ï¼Œå°† Path è½¬åŒ–æˆ &amp;str å¹¶éé›¶å¼€é”€çš„ï¼ˆfreeï¼‰ï¼Œä¸”å¯èƒ½å¤±è´¥ï¼ˆå› æ­¤å®ƒ è¿”å›ä¸€ä¸ª Optionï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">path_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-------------path_demo-------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">path</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·¯å¾„æ˜¯å¦å­˜åœ¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/etc/hosts&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">exists</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">metadata</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">is_ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `display` æ–¹æ³•è¿”å›ä¸€ä¸ªå¯æ˜¾ç¤ºï¼ˆshowableï¼‰çš„ç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> display </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">display</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;path = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> display</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `join` ä½¿ç”¨æ“ä½œç³»ç»Ÿç‰¹å®šçš„åˆ†éš”ç¬¦æ¥åˆå¹¶è·¯å¾„åˆ°ä¸€ä¸ªå­—èŠ‚å®¹å™¨ï¼Œå¹¶è¿”å›æ–°çš„è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> new_path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å°†è·¯å¾„è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> new_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;new path is not a valid UTF-8 sequence&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;new path is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32-æ—¶é—´">3.2. æ—¶é—´<a href="#32-æ—¶é—´" class="hash-link" aria-label="3.2. æ—¶é—´çš„ç›´æ¥é“¾æ¥" title="3.2. æ—¶é—´çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">time_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> start </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">SystemTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">now</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">10000000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> _a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{} ms&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">SystemTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">now</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">duration_since</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_millis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>4. å¯¹æ¯” 2018</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-nll">4.1. nll<a href="#41-nll" class="hash-link" aria-label="4.1. nllçš„ç›´æ¥é“¾æ¥" title="4.1. nllçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// nll ç‰¹æ€§</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 2015 edition çš„å‘¨æœŸæ£€æŸ¥ä¼šè®¤ä¸º å˜é‡æœ‰æ•ˆç›´åˆ°ä½œç”¨åŸŸç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 2018 edition ä¼šåˆ†æä»£ç , ç¡®è®¤å˜é‡åé¢ä¸ä¼šç”¨åˆ°, åˆ™æå‰é”€æ¯å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">y </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// 2018 edition åœ¨è¿™ä¸€æ­¥å, é”€æ¯ y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// 2015 åˆ°è¿™ä¸€æ­¥æ‰é”€æ¯ y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// éè¯æ³•ä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸ (Non-Lexical Lifetime, NLL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">foo</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        x</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        y</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//2015 ä¸­ error, 2018 å¼•å…¥äº† nll, ä¸æŠ¥é”™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    z </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">foo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// 2015 è®¤ä¸ºåˆ°è¿™é‡Œ y å·²ç»å¤±æ•ˆäº†, æ‰€ä»¥æŠ¥é”™, å®é™…è¿™ä¸ç¬¦åˆç›´è§‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// nll æ— æ³•è§£å†³çš„é—®é¢˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">get_default</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token class-name" style="color:rgb(38, 127, 153)">Hash</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token class-name" style="color:rgb(38, 127, 153)">Eq</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token class-name" style="color:rgb(38, 127, 153)">Copy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token class-name" style="color:rgb(38, 127, 153)">Default</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;r</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                            key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;r</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// -------------+ &#x27;r</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">              </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">                          </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">default</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">//  ^~~~~~ ERROR               // |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">                                  </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">                                      </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¿®æ­£å¦‚ä¸‹:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">get_default2</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token class-name" style="color:rgb(38, 127, 153)">Hash</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token class-name" style="color:rgb(38, 127, 153)">Eq</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token class-name" style="color:rgb(38, 127, 153)">Copy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token class-name" style="color:rgb(38, 127, 153)">Default</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;r</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                             key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                             </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;r</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">contains_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ^~~~~~~~~~~~~~~~~~ &#x27;n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// + &#x27;r</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">unreachable!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">       </span><span class="token comment" style="color:rgb(0, 128, 0)">// |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">                               </span><span class="token comment" style="color:rgb(0, 128, 0)">// v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// At this point, `map.get_mut` was never</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// called! (As opposed to having been called,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// but its result no longer being in use.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">V</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">default</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// OK now.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-raw-identifier">4.2. Raw identifier<a href="#42-raw-identifier" class="hash-link" aria-label="4.2. Raw identifierçš„ç›´æ¥é“¾æ¥" title="4.2. Raw identifierçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åˆ©ç”¨ Raw identifier å°†è¯­è¨€å…³é”®å­—ç”¨ä½œå‡½æ•°å (ä¸€èˆ¬ç”¨äº FFI ä¸­ï¼Œç”¨äºé¿å… C å‡½æ•°åå’Œ Rust çš„å…³é”®å­—æˆ–ä¿ç•™å­—é‡å)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn r#match(needle : &amp;str , haystack : &amp;str) - &gt; bool</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43-ç®€åŒ–æ¨¡å¼åŒ¹é…">4.3. ç®€åŒ–æ¨¡å¼åŒ¹é…<a href="#43-ç®€åŒ–æ¨¡å¼åŒ¹é…" class="hash-link" aria-label="4.3. ç®€åŒ–æ¨¡å¼åŒ¹é…çš„ç›´æ¥é“¾æ¥" title="4.3. ç®€åŒ–æ¨¡å¼åŒ¹é…çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// match æ¨¡å¼åŒ¹é…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let o = &amp;Some(&quot;h&quot;.to_owned());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // 2015</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //  refä¹Ÿæ˜¯ä¸€ç§æ¨¡å¼åŒ¹é…ï¼Œæ˜¯ä¸ºäº† è§£æ„ &amp;Some(ref s)ä¸­ s çš„å¼•ç”¨ï¼Œé¿å…å…¶ä¸­çš„ s è¢«è½¬ç§»æ‰€æœ‰æƒ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    match o {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &amp;Some(ref v) =&gt; println!(&quot;{}&quot;, v),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ =&gt; (),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // 2018</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //ä¸ éœ€è¦å†ä½¿ç”¨å¼•ç”¨æ“ä½œç¬¦å’Œ refæ¥è¿›è¡Œè§£æ„äº†ã€‚åœ¨æ–°çš„ç‰ˆæœ¬ä¸­ ï¼Œ match åŒ¹é…ä¼šè‡ªåŠ¨å¤„ç†è¿™ç§æƒ…å†µ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    match o {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Some(v) =&gt; println!(&quot;{}&quot;, v),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ =&gt; (),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="44-main-å‡½æ•°å¯ä»¥è¿”å›-result">4.4. main å‡½æ•°å¯ä»¥è¿”å› Result<a href="#44-main-å‡½æ•°å¯ä»¥è¿”å›-result" class="hash-link" aria-label="4.4. main å‡½æ•°å¯ä»¥è¿”å› Resultçš„ç›´æ¥é“¾æ¥" title="4.4. main å‡½æ•°å¯ä»¥è¿”å› Resultçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åœ¨ Rust 2015ç‰ˆæœ¬ä¸­ï¼Œ main å‡½æ•°å¹¶ä¸èƒ½è¿”å› Result&lt;T E&gt;ã€‚ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œ äºŒè¿›åˆ¶ å¯æ‰§è¡Œåº“ä¹Ÿéœ€è¦è¿”å›é”™è¯¯ï¼Œ æ¯”å¦‚ï¼Œ è¯»å–æ–‡ä»¶çš„æ—¶å€™å‘ç”Ÿäº†é”™è¯¯ï¼Œ è¿™æ—¶éœ€è¦æ­£å¸¸é€€å‡ºç¨‹åºã€‚äº æ˜¯åœ¨ Rust 2018 ç‰ˆæœ¬ä¸­ï¼Œå…è®¸ main å‡½æ•°è¿”å› Result&lt;T, E&gt;äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="45-impl-trait-æŠ½è±¡ç±»å‹">4.5. impl trait æŠ½è±¡ç±»å‹<a href="#45-impl-trait-æŠ½è±¡ç±»å‹" class="hash-link" aria-label="4.5. impl trait æŠ½è±¡ç±»å‹çš„ç›´æ¥é“¾æ¥" title="4.5. impl trait æŠ½è±¡ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯ ä»¥é™æ€åˆ†å‘çš„æŠ½è±¡ç±»å‹ impl Trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>5. è¯­æ³•</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-æ³¨é‡Š">5.1. æ³¨é‡Š<a href="#51-æ³¨é‡Š" class="hash-link" aria-label="5.1. æ³¨é‡Šçš„ç›´æ¥é“¾æ¥" title="5.1. æ³¨é‡Šçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">//! Hello Demo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//!   åŒ…æ³¨é‡Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//! crate spec...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Read</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">io</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">fmt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">BufWriter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// main æ–¹æ³•çš„æ³¨é‡Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ```</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// æ”¯æŒ md</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ```</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hello, world!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52-å˜é‡èµ‹å€¼">5.2. å˜é‡èµ‹å€¼<a href="#52-å˜é‡èµ‹å€¼" class="hash-link" aria-label="5.2. å˜é‡èµ‹å€¼çš„ç›´æ¥é“¾æ¥" title="5.2. å˜é‡èµ‹å€¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="521-é»˜è®¤æ˜¯ä¸å¯å˜çš„">5.2.1. é»˜è®¤æ˜¯ä¸å¯å˜çš„<a href="#521-é»˜è®¤æ˜¯ä¸å¯å˜çš„" class="hash-link" aria-label="5.2.1. é»˜è®¤æ˜¯ä¸å¯å˜çš„çš„ç›´æ¥é“¾æ¥" title="5.2.1. é»˜è®¤æ˜¯ä¸å¯å˜çš„çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">variables</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// äºŒæ¬¡èµ‹å€¼ä¸è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¹Ÿå°±æ˜¯è¯´ a æ˜¯ä¸å¯å˜å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// a = 10;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½†æ˜¯èƒ½äºŒæ¬¡ç»‘å®š, é‡å½±/é®è”½ï¼ˆShadowingï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œçš„ a å’Œä¹‹å‰çš„ a æ²¡å…³ç³», ç”šè‡³ç±»å‹éƒ½èƒ½æ”¹å˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;new a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯å˜å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// èƒ½å¤Ÿè¢«äºŒæ¬¡èµ‹å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">33</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™æ˜¯ä¸è¡Œçš„, å› ä¸º b å·²ç»è¢«ä½¿ç”¨è¿‡äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// b = &quot;bb&quot;;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰‹åŠ¨æŒ‡å®šç±»å‹, æ— ç¬¦å· 64 ä½æ•´å‹å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœæ²¡æœ‰å£°æ˜ç±»å‹ï¼Œi å°†è‡ªåŠ¨è¢«åˆ¤æ–­ä¸ºæœ‰ç¬¦å· 32 ä½æ•´å‹å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u64</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="522-å­—é¢é‡">5.2.2. å­—é¢é‡<a href="#522-å­—é¢é‡" class="hash-link" aria-label="5.2.2. å­—é¢é‡çš„ç›´æ¥é“¾æ¥" title="5.2.2. å­—é¢é‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// å­—é¢é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¦åç¼€çš„å­—é¢é‡ï¼Œå…¶ç±»å‹åœ¨åˆå§‹åŒ–æ—¶å·²ç»çŸ¥é“äº†ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> z </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3f32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="53-åŸºæœ¬æ•°æ®ç±»å‹">5.3. åŸºæœ¬æ•°æ®ç±»å‹<a href="#53-åŸºæœ¬æ•°æ®ç±»å‹" class="hash-link" aria-label="5.3. åŸºæœ¬æ•°æ®ç±»å‹çš„ç›´æ¥é“¾æ¥" title="5.3. åŸºæœ¬æ•°æ®ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="531-convert">5.3.1. convert<a href="#531-convert" class="hash-link" aria-label="5.3.1. convertçš„ç›´æ¥é“¾æ¥" title="5.3.1. convertçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://stackoverflow.com/questions/41034635/how-do-i-convert-between-string-str-vecu8-and-u8" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/41034635/how-do-i-convert-between-string-str-vecu8-and-u8</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="532-å€¼ç±»å‹-and-å¼•ç”¨ç±»å‹">5.3.2. å€¼ç±»å‹ and å¼•ç”¨ç±»å‹<a href="#532-å€¼ç±»å‹-and-å¼•ç”¨ç±»å‹" class="hash-link" aria-label="5.3.2. å€¼ç±»å‹ and å¼•ç”¨ç±»å‹çš„ç›´æ¥é“¾æ¥" title="5.3.2. å€¼ç±»å‹ and å¼•ç”¨ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å€¼ç±»å‹æ˜¯æŒ‡æ•°æ®ç›´æ¥å­˜å‚¨åœ¨æ ˆä¸­çš„æ•°æ®ç±»å‹ ï¼Œä¸€äº›åŸç”Ÿç±»å‹ï¼Œæ¯”å¦‚æ•°å€¼ ã€å¸ƒå°”å€¼ã€ç»“æ„ä½“, æšä¸¾ç­‰éƒ½æ˜¯å€¼ç±»å‹ã€‚å› æ­¤å¯¹å€¼ç±»å‹çš„æ“ä½œæ•ˆç‡ä¸€èˆ¬æ¯”è¾ƒé«˜ï¼Œä½¿ç”¨å®Œç«‹å³ä¼šè¢«å›æ”¶, è¿™äº›åŸºæœ¬ç±»å‹å®ç°äº† Copy trait, èµ‹å€¼è¯­å¥ä¸­ä¼šæ‰§è¡Œæ‹·è´</p><p>å¼•ç”¨ç±»å‹å°†æ•°æ®å­˜å‚¨åœ¨å †ä¸­ï¼Œè€Œæ ˆä¸­åªå­˜æ”¾æŒ‡å‘å †ä¸­æ•°æ®çš„åœ°å€, å¦‚æ•°ç»„, å­—ç¬¦ä¸²; å› æ­¤å¯¹å¼•ç”¨ç±»å‹çš„æ“ä½œæ•ˆç‡ä¸€èˆ¬æ¯”è¾ƒä½</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="533-å¸¸é‡-é™æ€å˜é‡">5.3.3. å¸¸é‡ é™æ€å˜é‡<a href="#533-å¸¸é‡-é™æ€å˜é‡" class="hash-link" aria-label="5.3.3. å¸¸é‡ é™æ€å˜é‡çš„ç›´æ¥é“¾æ¥" title="5.3.3. å¸¸é‡ é™æ€å˜é‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¸é‡, é™æ€å˜é‡: åœ¨å…¨å±€å£°æ˜å¸¸é‡ or å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦æ‰‹åŠ¨æŒ‡å®šç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŒºåˆ«/å¼‚åŒ:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - éƒ½æ˜¯åœ¨ç¼–è¯‘æœŸæ±‚å€¼çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨äºå­˜å‚¨éœ€è¦åŠ¨æ€åˆ†é…å†…å­˜çš„ç±»å‹ï¼Œæ¯”å¦‚ HashMap, vec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - é™æ€å˜é‡æœ‰å›ºå®šçš„å†…å­˜åœ°å€ (åˆ†é…åœ¨é™æ€å­˜å‚¨åŒº), å¯ä»¥æ˜¯å¯å˜çš„ (ç”¨ mut ä¿®é¥°), å¯èƒ½æœ‰å†…å­˜å®‰å…¨é—®é¢˜, æ‰€ä»¥ä¿®æ”¹éœ€è¦åœ¨ unsafe ä¸­; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - å¸¸é‡æ²¡æœ‰å›ºå®šçš„å†…å­˜åœ°å€, ä¸å¯å˜ (ä¼šè¢«å†…è”, åœ¨è¢«ç”¨åˆ°çš„åœ°æ–¹ä¼šè¢«å¤åˆ¶è¿‡å», ç”¨ä¸åˆ°å†…å­˜åœ°å€)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ™®é€šå¸¸é‡ ä¸èƒ½å¼•ç”¨ é™æ€å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨åœºæ™¯:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨å­˜å‚¨çš„æ•°æ®æ¯”è¾ƒå¤§ã€éœ€è¦å¼•ç”¨åœ°å€æˆ–å…·æœ‰å¯å˜æ€§çš„æƒ…å†µä¸‹ä½¿ç”¨é™æ€å˜é‡;å¦åˆ™ï¼Œåº”è¯¥ ä¼˜å…ˆä½¿ç”¨æ™®é€šå¸¸é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">MAX_POINTS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100_000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">LANGUAGE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Rust&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//&quot;string&quot; å­—é¢é‡é»˜è®¤ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ static çš„</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="534-æ•°å­—">5.3.4. æ•°å­—<a href="#534-æ•°å­—" class="hash-link" aria-label="5.3.4. æ•°å­—çš„ç›´æ¥é“¾æ¥" title="5.3.4. æ•°å­—çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// å¯¹äº åŸºæœ¬æ•°æ®ç±»å‹, æ•°æ®çš„å…‹éš†, ç§»åŠ¨éƒ½æ˜¯åœ¨æ ˆä¸Š, æ— éœ€å­˜å‚¨åˆ°å †ä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">basic_types</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ•´å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å æ® 8 bit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">A</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i8</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æœ‰ç¬¦å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ— ç¬¦å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     </span><span class="token comment" style="color:rgb(0, 128, 0)">// const b: u8 = -2; // é”™è¯¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å æ® 16 bit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// i16 u16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å æ® 32 bit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// i32 u32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 64 bit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// i64 u64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// i128 u128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// arch ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// isize    usize</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//é•¿åº¦å–å†³äºæ‰€è¿è¡Œçš„ç›®æ ‡å¹³å°ï¼Œå¦‚æœæ˜¯ 32 ä½æ¶æ„çš„å¤„ç†å™¨å°†ä½¿ç”¨ 32 ä½ä½é•¿åº¦æ•´å‹ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">C</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i16</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10_000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// 10è¿›åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i16</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0xff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// 16è¿›åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">E</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i16</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0o77</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// 8 è¿›åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">F</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i16</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0b1111_0000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// äºŒè¿›åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æµ®ç‚¹æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é»˜è®¤ f64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// f32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›¸å…³å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">min_value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">2147483648</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">max_value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// https://cloud.tencent.com/developer/article/1518453</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="535-å¸ƒå°”å€¼-å­—ç¬¦-å­—èŠ‚">5.3.5. å¸ƒå°”å€¼ å­—ç¬¦ å­—èŠ‚<a href="#535-å¸ƒå°”å€¼-å­—ç¬¦-å­—èŠ‚" class="hash-link" aria-label="5.3.5. å¸ƒå°”å€¼ å­—ç¬¦ å­—èŠ‚çš„ç›´æ¥é“¾æ¥" title="5.3.5. å¸ƒå°”å€¼ å­—ç¬¦ å­—èŠ‚çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸ƒå°”å€¼, ç±»å‹ bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> is_a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦, å•å¼•å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//4 ä¸ªå­—èŠ‚, æ”¯æŒä¸­æ–‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">CC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">char</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;c&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> heart_eyed_cat </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> &#x27;ğŸ˜»&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—èŠ‚å­—é¢é‡, å¦‚ b&#x27;*&#x27; è¡¨ç¤º 42u8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">G</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">b&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—èŠ‚, åªèƒ½ u8 ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">b&#x27;\n&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="536-æ•°ç»„">5.3.6. æ•°ç»„<a href="#536-æ•°ç»„" class="hash-link" aria-label="5.3.6. æ•°ç»„çš„ç›´æ¥é“¾æ¥" title="5.3.6. æ•°ç»„çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äºåŸå§‹å›ºå®šé•¿åº¦æ•°ç»„ï¼Œåªæœ‰å®ç° Copy trait çš„ç±»å‹æ‰èƒ½ä½œä¸ºå…¶å…ƒç´  ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ å¯ä»¥åœ¨æ ˆä¸Šå­˜æ”¾çš„å…ƒç´ æ‰å¯ä»¥å­˜æ”¾åœ¨è¯¥ç±»å‹çš„æ•°ç»„ä¸­ (åªæœ‰ç¡®å®šå¤§å°ç±»å‹(sized type)çš„å®ä¾‹æ‰å¯ä»¥æ”¾åˆ°æ ˆä¸Šï¼Œä¹Ÿå°±æ˜¯ï¼Œå¯ä»¥é€šè¿‡ä¼ å€¼çš„æ–¹å¼ä¼ é€’)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸ç¡®å®šå¤§å°ç±»å‹(unsized tpe)çš„å®ä¾‹ä¸èƒ½æ”¾åˆ°æ ˆä¸Šè€Œä¸”å¿…é¡»é€šè¿‡ä¼ å¼•ç”¨çš„æ–¹å¼ä¼ é€’</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// a æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 5 çš„æ•´å‹æ•°ç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;January&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;February&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;March&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// b æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 3 çš„å­—ç¬¦ä¸²æ•°ç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ˜ç¡®æŒ‡å®šç±»å‹, æ•°ç»„ç±»å‹å¯ä»¥é€šè¿‡ [T, N] æ˜ç¡®æŒ‡å®š, T ä¸ºå…ƒç´ ç±»å‹, N ä¸º ä¸ªæ•°; å¦‚ [u8; 4] è¿™æ˜¯é™æ€ç±»å‹ (å› ä¸ºå·²çŸ¥å¤§å°äº†)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// [u8] åªèƒ½æ˜¯åŠ¨æ€å¤§å°ç±»å‹, for don&#x27;t know the size </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// c æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 5 çš„ i32 æ•°ç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> d </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨é»˜è®¤ç±»å‹ i32, å…ƒç´ éƒ½ä¸º 3, ä¸ªæ•°ä¸º 5 ä¸ª</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰åŒäº let d = [3, 3, 3, 3, 3];</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> d </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æŒ‡å®šç±»å‹ä¸º u8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ•°ç»„è®¿é—®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> first </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> second </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">123</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯ï¼šæ•°ç»„ a ä¸å¯å˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­£ç¡®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ•°ç»„éå†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> ele </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ele</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿æ¥ä¸¤ä¸ª array å¯ä»¥ä½¿ç”¨ join</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// match è¯­æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡åŒ¹é…æ•°ç»„çš„ä¸åŒå…ƒ å¯ä»¥å®ç°æŒ‡å®šçš„åŠŸèƒ½ ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŒ‘é€‰å‡ºä»¥ 3 ç»“å°¾å’Œç¬¬ äºŒä¸ªå…ƒç´ ä¸º 2 çš„æ•°ç»„ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">pick</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™ä¸ªæœ‰é™åˆ¶, å‚æ•°æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ä¸å¯å˜, å¿…é¡»ä¸º 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> arr </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ends with 3&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}, 2, {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//  matchåŒ¹é…çš„æœ€åä¸€ä¸ªåˆ†æ”¯ï¼Œå¿…é¡»ä½¿ç”¨é€šé…ç¬¦æˆ–å…¶ä»–å˜é‡æ¥ç©·å°½æšä¸¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;pass!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å˜é•¿å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ©ç”¨æ•°ç»„åˆ‡ ç‰‡å°±å¯ä»¥æ¨¡æ‹Ÿå˜é•¿å‚æ•°çš„å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŸç´ ä¸ªæ•°å¯å˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> num </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">one</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot; at least two&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">first</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> second</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?} + {:?} = {:?} &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> first</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> second</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> first</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">second</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sum is {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">fold</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">sum</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token closure-params"> i</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> sum </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// äºŒåˆ†æŸ¥æ‰¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ ¹æ®å…ƒç´ æŸ¥æ‰¾ç´¢å¼•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">binary_search</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰ä»·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">binary_search_by</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">x</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// binary search by_key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">34</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">55</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">binary_search</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">binary_search</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">   </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">binary_search</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> r </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> seek </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">binary_search_by</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">probe</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> probe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">seek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">34</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">55</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">binary_search_by_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params">a</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token closure-params">b</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="537-range-èŒƒå›´">5.3.7. Range èŒƒå›´<a href="#537-range-èŒƒå›´" class="hash-link" aria-label="5.3.7. Range èŒƒå›´çš„ç›´æ¥é“¾æ¥" title="5.3.7. Range èŒƒå›´çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// /åŒ…å¤´ä¸åŒ…å°¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;=</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">ops</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Range</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> end</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..=</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;=</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">ops</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">RangeInclusive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..=</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="538-åˆ‡ç‰‡">5.3.8. åˆ‡ç‰‡<a href="#538-åˆ‡ç‰‡" class="hash-link" aria-label="5.3.8. åˆ‡ç‰‡çš„ç›´æ¥é“¾æ¥" title="5.3.8. åˆ‡ç‰‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// åˆ‡ç‰‡æ˜¯å¯¹åŸå§‹æ•°æ®é›†åˆçš„éƒ¨åˆ†å¼•ç”¨, æ²¡æœ‰åŸå§‹ æ•°æ®é›†åˆ çš„æ‰€æœ‰æƒ (åŸå§‹æ•°æ®é›†åˆå¯èƒ½æ˜¯ æ•°ç»„, Vec);æ— æ³•ä¿®æ”¹åŸå§‹å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// è‹¥åŸå§‹å€¼ ä¸º T, åˆ™ åˆ‡ç‰‡ç±»å‹ä¸º  &amp;[T] or &amp;mut[T]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ..y ç­‰ä»·äº 0..y (åŒ…å¤´ä¸åŒ…å°¾å·´)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// x.. ç­‰ä»·äºä½ç½® x åˆ°æ•°æ®ç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// .. ç­‰ä»·äºä½ç½® 0 åˆ°ç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">slice_vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦ä¸²åˆ‡ç‰‡   </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;broadcast&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> part1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆªå–å­ä¸², å­—ç¬¦ä¸²åˆ‡ç‰‡å°±æ˜¯ &amp;str ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> part2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}={}+{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> part1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> part2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¢«åˆ‡ç‰‡å¼•ç”¨çš„å­—ç¬¦ä¸²ç¦æ­¢æ›´æ”¹åŸå§‹å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xxxxxx&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> slice </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;yes!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ•°ç»„åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> part </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> part</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//1, 3, 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸¤ä¸ª const fn æ–¹æ³•: len(), is_empty()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡ &amp;mut å®šä¹‰å¯å˜åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŠ¨æ€æ•°ç»„è½¬åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="539-str-å­—ç¬¦ä¸²åˆ‡ç‰‡">5.3.9. str å­—ç¬¦ä¸²åˆ‡ç‰‡<a href="#539-str-å­—ç¬¦ä¸²åˆ‡ç‰‡" class="hash-link" aria-label="5.3.9. str å­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç›´æ¥é“¾æ¥" title="5.3.9. str å­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// str æ˜¯å…¸å‹çš„åŠ¨æ€å¤§å°ç±»å‹ (DST), ç¼–è¯‘æœŸä¸å¯çŸ¥å¤§å°, åˆ†é…åœ¨å †ä¸Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//æ‰€ä»¥ç¼–è¯‘å™¨è¦æ±‚å¿…é¡»ä»¥ä¸å¯å˜å€Ÿç”¨çš„å½¢å¼åœ¨ä»£ç ä¸­å­˜åœ¨ å³ &amp;str, è¿™ä¸ªå€Ÿç”¨çš„å¤§å°æ˜¯ç¡®å®šçš„(ä¸€ä¸ªæŒ‡é’ˆ+é•¿åº¦), &amp;str å­˜å‚¨åœ¨æ ˆä¸Š, å¯¹åº”çš„ str å­˜åœ¨ å †ä¸Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ç‰¹æ®Šçš„ str, ç‰¹æ®Šåœ¨å…¶å…·æœ‰é™æ€ç”Ÿå‘½å‘¨æœŸ, å¿…é¡»ä»¥ç±»å‹  &amp;&#x27;static  str æ¥æ”¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//fat pointer(èƒ–æŒ‡é’ˆ): åŒ…å« DST çš„åœ°å€ä¿¡æ¯ å’Œ é•¿åº¦çš„æŒ‡é’ˆ, &amp;str å³èƒ–æŒ‡é’ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> ss </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> ptr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ss</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_ptr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> slice </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">slice</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_raw_parts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ptr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ss</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_utf8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">slice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// turns invalid UTF-8 bytes into ï¿½ and so no error handling is required.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> buf </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0x41u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0x41u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0x42u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_utf8_lossy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> ss </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> s </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;equal&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//equal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5310-åŸç”ŸæŒ‡é’ˆ-raw-pointer">5.3.10. åŸç”ŸæŒ‡é’ˆ raw pointer<a href="#5310-åŸç”ŸæŒ‡é’ˆ-raw-pointer" class="hash-link" aria-label="5.3.10. åŸç”ŸæŒ‡é’ˆ raw pointerçš„ç›´æ¥é“¾æ¥" title="5.3.10. åŸç”ŸæŒ‡é’ˆ raw pointerçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>åˆ†ä¸º ä¸å¯å˜ raw pointer å’Œ å¯å˜ raw pointer</p><p>æŒ‡é’ˆä¸åŒäº å¼•ç”¨, æŒ‡é’ˆç±»å‹ *T, å¼•ç”¨ç±»å‹ &amp;T</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#![feature(never_type)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let mut a = 10;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let a_ptr = &amp;mut a as *mut i32;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let b = Box::new(20);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let b_ptr = &amp;*b as *const i32;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">unsafe { </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    *a_ptr += *b_ptr;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println!(&quot;{:?}&quot;, a);//30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5311-never-ç±»å‹-æ„Ÿå¹å·">5.3.11. never ç±»å‹ æ„Ÿå¹å·<a href="#5311-never-ç±»å‹-æ„Ÿå¹å·" class="hash-link" aria-label="5.3.11. never ç±»å‹ æ„Ÿå¹å·çš„ç›´æ¥é“¾æ¥" title="5.3.11. never ç±»å‹ æ„Ÿå¹å·çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åº•ç±»å‹ bottom type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// BangType</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Rust ä¸­æœ‰å¾ˆå¤šç§æƒ…å†µç¡® å®æ²¡æœ‰å€¼ï¼Œä½†ä¸ºäº†ç±»å‹å®‰å…¨ï¼Œå¿…é¡»æŠŠè¿™äº›æƒ…å†µçº³å…¥ç±»å‹ç³»ç»Ÿè¿›è¡Œç»Ÿä¸€ å¤„ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å‘æ•£å‡½æ•° (Diverging Function ): æ°¸è¿œä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°, å¦‚ panic! æˆ–è€… std::process: :exit ...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// continue å’Œ break å…³é”®å­—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//loopå¾ªç¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç©ºæšä¸¾ï¼Œæ¯”å¦‚ enumVoid{}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ! [feature (never_type)]// éœ€è¦æ”¯æŒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn foo() -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // !è¡¨ç¤ºæ°¸è¿œä¸ä¼šæœ‰è¿”å›å€¼çš„ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let x: ! = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        return 11;// ç›´æ¥fooå‡½æ•°è¿”å›é€€å‡ºäº†, æ‰€ä»¥ x æ°¸è¿œä¸ä¼šæœ‰è¿”å›å€¼, æ˜¯ ! ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // panic å®åœ¨ match åˆ†æ”¯ä¸­ä½¿ç”¨æ—¶, å³ä½¿æ²¡æœ‰è¿”å›å’Œå…¶ä»–åˆ†æ”¯ç›¸åŒçš„ç±»å‹, ä¹Ÿæ²¡æŠ¥é”™, ä¸ºä»€ä¹ˆ?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å› ä¸ºè¿”å› äº† ! ç±»å‹, (never ç±»å‹å¯ä»¥è½¬ä¸ºä»»ä½•ç±»å‹)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç©ºæšä¸¾çš„ç”¨æ³•åœºæ™¯:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    enum Void {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let res: Result&lt;i32, Void&gt; = Ok(11);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let Ok(num) = res;//å½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥ç”¨ if let è¯­å¥å¤„ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="54-å­—ç¬¦ä¸²">5.4. å­—ç¬¦ä¸²<a href="#54-å­—ç¬¦ä¸²" class="hash-link" aria-label="5.4. å­—ç¬¦ä¸²çš„ç›´æ¥é“¾æ¥" title="5.4. å­—ç¬¦ä¸²çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="541-å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«">5.4.1. å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«<a href="#541-å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«" class="hash-link" aria-label="5.4.1. å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«çš„ç›´æ¥é“¾æ¥" title="5.4.1. å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// - str è¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸², å± äºåŠ¨æ€å¤§ å° ç±»å‹ (DST)ï¼Œä¿è¯ æœ‰æ•ˆ UTF-8 , åœ¨ç¼–è¯‘æœŸå¹¶ä¸èƒ½ç¡®å®šå…¶å¤§å°ï¼Œæ‰€ä»¥åœ¨ç¨‹åºä¸­æœ€å¸¸è§åˆ°çš„æ˜¯ str çš„åˆ‡ç‰‡ (Slice)ç±»å‹ &amp;strã€‚  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      &amp;str è¡¨ç¤ºå­—ç¬¦ä¸²å­—é¢é‡, æ˜¯å¼•ç”¨ç±»å‹; å­—ç¬¦ä¸²åˆ‡ç‰‡å°±æ˜¯ &amp;str, å’Œç¨‹åºä»£ç æ®µå­˜å‚¨åœ¨ä¸€èµ·(åœ¨ç¼–è¯‘æœŸé—´åœ°å€å°±çŸ¥é“äº†), æ‰§è¡Œçš„æ˜¯å¤åˆ¶è¯­ä¹‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// - String ç±»å‹, é•¿åº¦å¯å˜, å¯ä¿®æ”¹, å­˜å‚¨ä¸ºç”±å­—èŠ‚ç»„æˆçš„ vectorï¼ˆVec&lt;u8&gt;ï¼‰ï¼Œä½†ä¿è¯äº†å®ƒä¸€å®šæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ UTF-8 åºåˆ—, å­—ç¬¦åºåˆ—åˆ†é…åœ¨å †, æ‰§è¡Œçš„æ˜¯ç§»åŠ¨è¯­ä¹‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     String æœ‰ä¸€ä¸ªå­—ç¬¦å¼€å§‹ä½ç½®å±æ€§ ptr, å’Œä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦å±æ€§ len, å’Œå †åˆ†é…çš„å®¹é‡ capacity, è¿™äº›å±æ€§ä½äº æ ˆ, å®é™…å­—ç¬¦åºåˆ—å­˜åœ¨ å †</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     str    æœ‰  ptr å’Œ len, å±æ€§, å†…å®¹éƒ½åœ¨ æ ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - CStrï¼Œ è¡¨ç¤ºç”±Cåˆ†é…è€Œè¢«Rustå€Ÿç”¨çš„å­—ç¬¦ä¸²ï¼Œ ä¸€èˆ¬ç”¨äºå’ŒCè¯­è¨€äº¤äº’ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - CStringï¼Œ è¡¨ç¤ºç”± Rust åˆ†é…ä¸”å¯ä»¥ä¼ é€’ç»™ C å‡½æ•°ä½¿ç”¨çš„ C å­—ç¬¦ä¸² ï¼ŒåŒæ ·ç”¨ äºå’Œ C è¯­è¨€äº¤äº’ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - OsStrï¼Œ è¡¨ç¤ºå’Œæ“ä½œç³»ç»Ÿç›¸å…³çš„å­—ç¬¦ä¸²ã€‚è¿™æ˜¯ä¸ºäº†å…¼å®¹ Windowsç³»ç»Ÿã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - OsStringï¼Œè¡¨ç¤º OsStr çš„å¯å˜ç‰ˆæœ¬ ã€‚ä¸ Rust å­—ç¬¦ä¸²å¯ä»¥ç›¸äº’è½¬æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - Pathï¼Œè¡¨ç¤ºè·¯å¾„ï¼Œå®šä¹‰äº std::pathæ¨¡å—ä¸­ã€‚ PathåŒ…è£…äº† OsS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - PathBuf. ft~ Path é…å¯¹ï¼Œ æ˜¯ Path çš„å¯å˜ç‰ˆæœ¬ ã€‚ PathBufåŒ…è£…äº† OsStringã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="542-å¸¸ç”¨æ–¹æ³•">5.4.2. å¸¸ç”¨æ–¹æ³•<a href="#542-å¸¸ç”¨æ–¹æ³•" class="hash-link" aria-label="5.4.2. å¸¸ç”¨æ–¹æ³•çš„ç›´æ¥é“¾æ¥" title="5.4.2. å¸¸ç”¨æ–¹æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">str_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦ä¸²è½¬ä¹‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é•¿å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> long_string </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;String literals</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">                        can span multiple lines.</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">                        The linebreak and \&#x27; indentation here </span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">                        can be escaped too!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> long_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token char" style="color:rgb(129, 31, 63)">b&#x27; &#x27;</span><span class="token plain">  è¡¨ç¤º ç©ºæ ¼å­—ç¬¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> str_value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;1234&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦ä¸²åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç®€å•å†™æ³•ä¸º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> str_value </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;1234&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">string</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤æ—¶è¿˜å¹¶æœªåœ¨å †ä¸Šåˆ†é…ç©ºé—´</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> str1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŒ‡å®šå †å®¹é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">  </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token function" style="color:rgb(0, 0, 255)">with_capacity</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å†æ¬¡åˆ†é…å®¹é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">reserve</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lO</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> one </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ•´æ•°åˆ°å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> float </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// æµ®ç‚¹æ•°åˆ°å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> slice </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;slice&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦ä¸²åˆ‡ç‰‡åˆ°å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ–°å¢ æ·»åŠ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å®šä¹‰ä¸€ä¸ªå¯å˜å­—ç¬¦ä¸²ï¼Œå¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> string_value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;1111&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// let string_value = String::from(&quot;222&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    string_value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;333&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ·»åŠ å­—ç¬¦ä¸²åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    string_value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;!&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ·»åŠ å­—ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ’å…¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;f</span><span class="token plain">â€™</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">insert_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">O</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">â€barâ€</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿æ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// String ç±»å‹çš„å­—ç¬¦ä¸²ä¹Ÿå®ç°äº† Add&lt;&amp;str&gt; å’Œ AddAssign&lt;&amp;str&gt;ä¸¤ä¸ª traitï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨â€œ+â€å’Œâ€œ+=â€æ“ä½œç¬¦æ¥è¿æ¥å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ“ä½œç¬¦ å³è¾¹çš„å­—ç¬¦ä¸²å¿…é¡»ä¸ºåˆ‡ç‰‡ç±»å‹ (&amp;str)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ›¿æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">replace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;old_str&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;new str&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">remove</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//æŒ‡å®šä½ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">pop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">//æœ€åä¸€ä¸ªå­—ç¬¦, å¹¶ä¸”è¿”å›</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">truncate</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">//æŒ‡å®šä½ç½®åˆ°æœ«å°¾åˆ é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clear</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//æ¸…ç©º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">drain</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">beta_offset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆªå–æºçš„æŒ‡å®šèŒƒå›´å¹¶è¿”å›, æºä¼šæ”¹å˜, åªç•™ä¸‹å‰©ä¸‹çš„éƒ¨åˆ†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">drain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰ä»· clear, æˆªå–æºçš„å…¨éƒ¨, æºå˜ç©º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// trim é¦–å°¾å»é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> chars_to_trim</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">char</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27; &#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;,&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å»é™¤ string é¦–å°¾çš„å­—ç¬¦, è¿™äº›å­—ç¬¦åœ¨ chars_to_trim ä¸­æŒ‡å®š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> trimmed_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">trim_matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">chars_to_trim</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŸ¥æ‰¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ ‡å‡†åº“ä¸­å¹¶æ²¡æœ‰æä¾›æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒï¼Œè¿™æ˜¯å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼ç®—æ˜¯å¤–éƒ¨DSLï¼Œ å¦‚æœ ç›´æ¥å°†å…¶å¼•å…¥æ ‡å‡†åº“ä¸­ï¼Œåˆ™ä¼šç ´å Rustçš„ä¸€è‡´æ€§</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç¬¬ä¸‰æ–¹åŒ… regex</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Rust ä¸­è¿™é‡Œä½¿ç”¨ çš„å­—ç¬¦åŒ¹é…ç®— æ³•å¹¶é KMPï¼Œè€Œæ˜¯å®ƒçš„å˜ç§åŒå‘( Two-Way)å­—ç¬¦ä¸²åŒ¹é…ç®—æ³• ï¼Œè¯¥ç®—æ³•çš„ä¼˜åŠ¿åœ¨äºæ‹¥æœ‰å¸¸é‡çº§çš„ç©ºé—´å¤æ‚åº¦ã€‚å®ƒå’Œ KMP çš„å…±åŒç‚¹åœ¨äºå…¶æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ O(n)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­˜åœ¨æ€§åˆ¤æ–­ã€‚ ç›¸å…³æ–¹æ³•åŒ…æ‹¬contains (æ”¯æŒ å­—ç¬¦/å­—ç¬¦ä¸²/è°“è¯)ã€ starts_with (æ”¯æŒå­—ç¬¦/å­—ç¬¦ä¸²)ã€ ends_with</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½ç½®åŒ¹é… ã€‚ç›¸å…³æ–¹æ³•åŒ…æ‹¬ findã€ rfind (ä»å³è¾¹å¼€å§‹æœç´¢, æ”¯æŒè°“è¯)ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ†å‰²å­—ç¬¦ä¸² ã€‚ç›¸å…³æ–¹æ³•åŒ…æ‹¬ splitã€rsplitã€split_terminator(å»æ‰æ•°ç»„lastå…ƒç´ çš„å¤šä½™)ã€rsplit_terminatorã€splitn (æŒ‡å®šåˆ†å‰²åçš„æ•°ç»„é•¿åº¦)ã€rsplitnã€‚ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ•è·åŒ¹é…, è¿”å›æ•°ç»„ã€‚ ç›¸å…³æ–¹æ³•åŒ…æ‹¬ matchsã€ rmatchesã€ match_indices (è¿”å›çš„æ˜¯å…ƒç»„æ•°ç»„, åŒ…å«äº†ç´¢å¼•)ã€ rmatch_indicesã€‚ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ é™¤åŒ¹é…ã€‚ ç›¸å…³æ–¹æ³•åŒ…æ‹¬ trim(åˆ é™¤ä¸¤å¤´ç©ºæ ¼, ä¸èƒ½æŒ‡å®š pattern å‚æ•°), trim_left, trim_right , trim_matches(å¯æŒ‡å®š pattern å‚æ•°)ã€trim_left_matchesã€trim_right_matchesã€‚ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ›¿ä»£åŒ¹é…ã€‚ ç›¸å…³æ–¹æ³•åŒ…æ‹¬ replaceã€ replacen(æŒ‡å®šæ›¿æ¢å­—ç¬¦çš„ä¸ªæ•°)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»Ÿè®¡é•¿åº¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦ å­—èŠ‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å­—èŠ‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// 5, å­—èŠ‚æ•°, æ¯ä¸ªè‹±æ–‡å­—ç¬¦å ä½1å­—èŠ‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ä½ å¥½&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//6, å› ä¸ºä¸­æ–‡æ˜¯ UTF-8 ç¼–ç çš„ï¼Œæ¯ä¸ªå­—ç¬¦é•¿ 3 å­—èŠ‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;helloä½ å¥½&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//æä¾›äº† bytes å’Œ chars ä¸¤ä¸ªæ–¹æ³•æ¥åˆ†åˆ«è¿”å›æŒ‰å­—èŠ‚ å’ŒæŒ‰å­—ç¬¦è¿­ä»£çš„æ³•ä»£å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å­—ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// 7, ç»Ÿè®¡å­—ç¬¦æ•° (ç»Ÿè®¡å­—ç¬¦çš„é€Ÿåº¦æ¯”ç»Ÿè®¡æ•°æ®é•¿åº¦çš„é€Ÿåº¦æ…¢å¾—å¤š)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//éå†å­—ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">print!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{} &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">enumerate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params"> </span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params">i</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token closure-params"> c</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token closure-params"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŒ‰ç´¢å¼•è®¿é—®å­—ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//é€šè¿‡ into_bytesæ–¹æ³•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º Vec&lt;u8&gt;åºåˆ—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">bs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">for_each</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">i</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;index = {:?}, value = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">char</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">bs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> new_s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token function" style="color:rgb(0, 0, 255)">from_utf8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·å–å•ä¸ªå­—ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ENä¸­æ–‡&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">nth</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//nth å‡½æ•°æ˜¯ä»è¿­ä»£å™¨ä¸­å–å‡ºæŸå€¼çš„æ–¹æ³•ï¼Œä¸è¦åœ¨éå†ä¸­è¿™æ ·ä½¿ç”¨ï¼å› ä¸º UTF-8 æ¯ä¸ªå­—ç¬¦çš„é•¿åº¦ä¸ä¸€å®šç›¸ç­‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//Some(&#x27;ä¸­&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŒ‡å®šç´¢å¼•èŒƒå›´æ¥è·å–å­—ç¬¦ä¸²åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">  </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">xxx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">v </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">is_char </span><span class="token function" style="color:rgb(0, 0, 255)">boundary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//éªŒè¯æŸä¸ªç´¢å¼•ä½ç½®æ˜¯å¦ä¸ºåˆæ³•çš„è¾¹ç•Œ, å› ä¸ºå¯èƒ½æŸä¸ªå­—ç¬¦å æ®äº†å¤šä¸ªç´¢å¼•ä½ç½®(stringçš„æ–¹æ³•é»˜è®¤éƒ½æ˜¯æŒ‰ç…§å­—èŠ‚æ¥å¤„ç†çš„, ä¹Ÿå°±æ˜¯ä¸€ä¸ªç´¢å¼•ä½ç½®å¯¹åº”ä¸€ä¸ªå­—èŠ‚, æŸäº›å­—ç¬¦è‹±æ–‡å­—ç¬¦å¤–çš„å­—ç¬¦å¯èƒ½ä¸æ­¢ä¸€ä¸ªå­—èŠ‚)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ†å‰²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> bool_s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">is_char_boundary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">split_at</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦å…ˆæ£€æŸ¥ç´¢å¼•æ˜¯å¦æ˜¯åˆæ³•å­—ç¬¦è¾¹ç•Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç©ºæ ¼åˆ†å‰², é€†åº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> pangram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;the quick brown fox jumps over the lazy dog&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> word </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> pangram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">split_whitespace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">rev</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&gt; {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> word</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ï¼Œæ’åºå¹¶ç§»é™¤é‡å¤å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">char</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> pangram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">sort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">dedup</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//å»é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·å–å­—èŠ‚ éå†å­—èŠ‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// as_bytes()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">first_word</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­—èŠ‚æ•°ç»„, ä¸€ä¸ªè‹±æ–‡å­—ç¬¦å ä¸€ä¸ªå­—èŠ‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> bytes </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">enumerate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> item </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">b&#x27; &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœæ˜¯ç©ºæ ¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">first_word</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="543-å­—ç¬¦ä¸²è½¬æ¢">5.4.3. å­—ç¬¦ä¸²è½¬æ¢<a href="#543-å­—ç¬¦ä¸²è½¬æ¢" class="hash-link" aria-label="5.4.3. å­—ç¬¦ä¸²è½¬æ¢çš„ç›´æ¥é“¾æ¥" title="5.4.3. å­—ç¬¦ä¸²è½¬æ¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"> //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¤æ‚ç±»å‹çš„ç±»å‹è½¬æ¢ ç›¸äº’è½¬æ¢ äº’è½¬</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // String =&gt; &amp;str</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s1 = String::from(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ–¹æ³•1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s2 = &amp;s1[..]; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let ssss = &amp;s1[..2];// æˆªå–å­ä¸²</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ–¹æ³•2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sss: &amp;str = &amp;s1.as_str();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ–¹æ³•3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // *s1 æ˜¯ str ç±»å‹, &amp;*s1 å³ä¸º &amp;str ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let new_str = &amp;*s1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // &amp;str -&gt; String</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let new_string = new_str.to_string();//to_stringåº•å±‚è°ƒç”¨çš„String::from</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let new_string1 = s2.to_string();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;new_string = {}, new_string1 = {}&quot;, new_string, new_string1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // &amp;str -&gt; String</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let string = &quot;hello&quot;.to_owned(); //æœ€å¸¸ç”¨, å§ &quot;hello&quot;ä»æ ˆè½¬ç§»åˆ°å †, to_owned æ–¹æ³•åˆ©ç”¨ &amp;str åˆ‡ç‰‡å­—èŠ‚åºåˆ—ç”Ÿæˆæ–°çš„ Stringå­—ç¬¦ä¸² ï¼Œ to_stringæ–¹æ³•æ˜¯å¯¹ String::from çš„åŒ…è£…, ä¸¤è€…æ€§èƒ½ç›¸å½“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // &amp;str -&gt; String</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let _s: String = &quot;hello&quot;.into();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // string -&gt; T</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // std::stræ¨¡å—ä¸­æä¾›çš„ parseæ³›å‹æ–¹æ³•æ¥å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæŒ‡å®šçš„ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åº•å±‚æ˜¯ FromStr::from_str</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //T -&gt; string</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // format!()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s = format!(&quot;{}&quot;, xxx); </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å’Œæ•°å­—äº’ç›¸è½¬æ¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let int_value = 5;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let string_value = int_value.to_string();//int to String</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let back_int = string_value.parse::&lt;i32&gt;().unwrap();//String to int</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="544-æ ¼å¼åŒ–">5.4.4. æ ¼å¼åŒ–<a href="#544-æ ¼å¼åŒ–" class="hash-link" aria-label="5.4.4. æ ¼å¼åŒ–çš„ç›´æ¥é“¾æ¥" title="5.4.4. æ ¼å¼åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‹¼æ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ–°åŠ çš„å­—ç¬¦ä¸²å¿…é¡»æ˜¯  &amp;str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> str1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> str2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> str3 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> str1 </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">str2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{} - {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> str3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> str2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ ¼å¼åŒ–è¾“å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç”±ä¸€äº›å®(macro)è´Ÿè´£è¾“å‡ºï¼Œè¿™äº›å®å®šä¹‰åœ¨std::fmtä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŸç†æ˜¯: å¿…é¡»å®ç° std::fmt::Display è¿™ä¸ªtraitæä¾›çš„ fmt æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// format!()ï¼šå‘å­—ç¬¦ä¸²ä¸­è¾“å‡ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// print()!ï¼šå‘æ ‡å‡†è¾“å‡ºæ‰“å°å­—ç¬¦ä¸²ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// println()!ï¼šå‘æ ‡å‡†è¾“å‡ºæ‰“å°å­—ç¬¦ä¸²ï¼ŒåŒæ—¶ä¼šæ‰“å°ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// eprint()!ï¼šå‘æ ‡å‡†é”™è¯¯æ‰“å°å­—ç¬¦ä¸²ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// eprintln()!ï¼šå‘æ ‡å‡†é”™è¯¯æ‰“å°å­—ç¬¦ä¸²ï¼ŒåŒæ—¶ä¹Ÿä¼šæ‰“å°ä¸€ä¸ªæ¢è¡Œç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å ä½ç¬¦ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {} -&gt; Display</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:?} -&gt; Debug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:#?} -&gt; æ ¼å¼åŒ–çš„ Debug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:o} -&gt; å…«è¿›åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:x} -&gt; åå…­è¿›åˆ¶å°å†™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:X}   åå…­è¿›åˆ¶å¤§å†™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:p}   æŒ‡é’ˆåœ°å€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:b}   äºŒè¿›åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:e}   æ•°å­—æ ¼å¼, æŒ‡æ•°å°å†™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// {:E}   æŒ‡æ•°å¤§å†™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{0} {1}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{h} {w}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> h </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> w </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä»¥äºŒè¿›åˆ¶çš„æ ¼å¼æ‰“å°æ•°å­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{} of {:b} people know binary, the other half doesn&#x27;t&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å³å¯¹é½å®½åº¦ä¸º6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{number:&gt;width$}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> width </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// &#x27;.....1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨å­—ç¬¦0å¡«å……å¯¹é½çš„å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{number:&gt;0width$}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> width </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// &#x27;000001&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åå…­è¿›åˆ¶è¾“å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;0x{:X}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//-&gt; &quot;0xDEADBEEF&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                            </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…«è¿›åˆ¶è¾“å‡º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;0o{:o}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//-&gt; &quot;0o33653337357&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="545-è°ƒè¯•æ‰“å°å¤åˆç±»å‹-debug-display">5.4.5. è°ƒè¯•æ‰“å°å¤åˆç±»å‹ Debug Display<a href="#545-è°ƒè¯•æ‰“å°å¤åˆç±»å‹-debug-display" class="hash-link" aria-label="5.4.5. è°ƒè¯•æ‰“å°å¤åˆç±»å‹ Debug Displayçš„ç›´æ¥é“¾æ¥" title="5.4.5. è°ƒè¯•æ‰“å°å¤åˆç±»å‹ Debug Displayçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è°ƒè¯•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// fmt::Debug ç±»ä¼¼ Display è¿™ä¸ª trait, ä½†æ˜¯èƒ½å¤Ÿç”± rust è‡ªåŠ¨æ¨å¯¼å®ç°, æ— éœ€æ‰‹åŠ¨å®ç°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// fmt::Debugæ˜¯Rustæ ‡å‡†åº“å·²ç»å®šä¹‰å¥½çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿çš„æ–¹å¼ï¼Œè·å¾—fmt::Debugçš„èƒ½åŠ›, </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å³å®šä¹‰ struct æ—¶ æ·»åŠ  #[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å…¶ä»–çš„è¿˜æœ‰ #[allow(dead_code)] ç”¨äºå±è”½å¯¹æœªä½¿ç”¨ä»£ç çš„è­¦å‘Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">DebugDemo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> debug_demo </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">DebugDemo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Debug - {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> debug_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{0:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> debug_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// fmt::Display è‡ªå®šä¹‰æ‰“å°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ˜¯ä¸€ä¸ªç”¨äºè‡ªå®šä¹‰æ ¼å¼åŒ–è¾“å‡ºçš„æ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äºæ³›å‹å®¹å™¨, å¦‚ Vec&lt;T&gt;, éœ€è¦è‡ªå·±å®ç°fmt::Display, æˆ–è€…ç›´æ¥ ç”¨fmt::Debug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">DisplayDemo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">DisplayDemo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">fmt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Formatter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">write!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;({})&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> display_demo </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">DisplayDemo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;display - {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> display_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="546-é—®å·æ“ä½œç¬¦-å¤šæ¬¡å†™">5.4.6. é—®å·æ“ä½œç¬¦ å¤šæ¬¡å†™<a href="#546-é—®å·æ“ä½œç¬¦-å¤šæ¬¡å†™" class="hash-link" aria-label="5.4.6. é—®å·æ“ä½œç¬¦ å¤šæ¬¡å†™çš„ç›´æ¥é“¾æ¥" title="5.4.6. é—®å·æ“ä½œç¬¦ å¤šæ¬¡å†™çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// &quot;?&quot; é—®å·æ“ä½œç¬¦: å°è¯•è§£åŒ…, è¿”å›å€¼ä¸º è§£åŒ…åçš„å€¼, æœ‰å¼‚å¸¸, è¿”å›å¼‚å¸¸, æ²¡æœ‰åˆ™ç»§ç»­åç»­ä»£ç </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è€ƒè™‘è¿™ç§åœºæ™¯: å¯¹ä¸€ä¸ªç»“æ„ä½“æƒ³å®ç° fmt::Displayï¼Œä½†æ˜¯å…¶ä¸­çš„å…ƒç´ éœ€è¦ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å†™å‡ºå»ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//é—®é¢˜åœ¨äºæ¯ä¸ª write! éƒ½è¦ç”Ÿæˆä¸€ä¸ª fmt::Resultã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è§£å†³: write!(f, &quot;{}&quot;, value)?;  å¤šæ¬¡å†™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹ `write!` è¿›è¡Œå°è¯•ï¼ˆtryï¼‰ï¼Œè§‚å¯Ÿæ˜¯å¦å‡ºé”™ã€‚è‹¥å‘ç”Ÿé”™è¯¯ï¼Œè¿”å›ç›¸åº”çš„é”™è¯¯ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦åˆ™ï¼ˆæ²¡æœ‰å‡ºé”™ï¼‰ç»§ç»­æ‰§è¡Œåé¢çš„è¯­å¥ã€‚ åŒ try!(xxx)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">fmt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Formatter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨å…ƒç»„çš„ä¸‹æ ‡è·å–å€¼ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª `vec` çš„å¼•ç”¨ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> vec </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">write!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;[&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//å¤šæ¬¡å†™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         </span><span class="token comment" style="color:rgb(0, 128, 0)">// éå†ä¸‹æ ‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">enumerate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹æ¯ä¸ªå…ƒç´ ï¼ˆç¬¬ä¸€ä¸ªå…ƒç´ é™¤å¤–ï¼‰åŠ ä¸Šé€—å·ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨ `?` æˆ– `try!` æ¥è¿”å›é”™è¯¯ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token macro property">write!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;, &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">write!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŠ ä¸Šé…å¯¹ä¸­æ‹¬å·ï¼Œå¹¶è¿”å›ä¸€ä¸ª fmt::Result å€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">write!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;]&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="55-é›†åˆ">5.5. é›†åˆ<a href="#55-é›†åˆ" class="hash-link" aria-label="5.5. é›†åˆçš„ç›´æ¥é“¾æ¥" title="5.5. é›†åˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>std::collections ä¸‹æœ‰å››ç§é›†åˆ</p><ul><li>çº¿æ€§åºåˆ—: Vec(å‘é‡), VecDeque (åŒç«¯é˜Ÿåˆ—), LinkedList (é“¾è¡¨)</li><li>æ˜ å°„è¡¨: hashmap(æ— åºå“ˆå¸Œè¡¨), BTreeMap(æœ‰åºå“ˆå¸Œè¡¨)</li><li>é›†åˆ: hashset(æ— åºé›†åˆ), btreeset(æœ‰åºé›†åˆ)</li><li>ä¼˜å…ˆé˜Ÿåˆ—: binaryHeap (äºŒå‰å †)</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="551-vec-åŠ¨æ€æ•°ç»„">5.5.1. Vec åŠ¨æ€æ•°ç»„<a href="#551-vec-åŠ¨æ€æ•°ç»„" class="hash-link" aria-label="5.5.1. Vec åŠ¨æ€æ•°ç»„çš„ç›´æ¥é“¾æ¥" title="5.5.1. Vec åŠ¨æ€æ•°ç»„çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å‘é‡ Vec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// åŠ¨æ€æ•°ç»„, ç±»ä¼¼ javaä¸­çš„ ArrayList</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///Vectoræ•°ç»„å¤©ç”Ÿå°±å¯ä»¥ä½œ ä¸ºå…ˆè¿›åå‡º(FILO)çš„æ ˆç»“æ„ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Vector -------------------------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸€ä¸ª vector ä½¿ç”¨ 3 ä¸ªè¯æ¥è¡¨ç¤ºï¼šä¸€ä¸ªæŒ‡å‘æ•°æ®çš„æŒ‡é’ˆï¼Œvector çš„é•¿åº¦ï¼Œè¿˜æœ‰å®ƒçš„å®¹é‡ã€‚æ­¤å®¹é‡æŒ‡æ˜äº†è¦ä¸ºè¿™ä¸ª vector ä¿ç•™å¤šå°‘å†…å­˜ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//vector çš„é•¿åº¦ åªè¦å°äºè¯¥å®¹é‡ï¼Œå°±å¯ä»¥éšæ„å¢é•¿ï¼›å½“éœ€è¦è¶…è¿‡è¿™ä¸ªé˜ˆå€¼æ—¶ï¼Œä¼šç»™ vector é‡æ–°åˆ†é…ä¸€æ®µ æ›´å¤§çš„å®¹é‡ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰©å®¹: è‡ªåŠ¨æŒ‰ç…§ 2 å€æ‰©å®¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»ºç±»å‹ä¸º i32 çš„ç©ºå‘é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é¢„åˆ†é… 10 ä¸ªå•ä½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// çœŸæ­£åˆ†é… çš„å †å†…å­˜ å¤§ å° ç­‰äºæ•°ç»„ä¸­å…ƒç´ ç±»å‹æ‰€å å­—èŠ‚ä¸ç»™å®šå®¹é‡å€¼ ä¹‹ç§¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vee</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">with </span><span class="token function" style="color:rgb(0, 0, 255)">capacity</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">1O</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> vector </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡æ•°ç»„å’Œå®åˆ›å»ºå‘é‡ // v: Vec&lt;i32&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ten zeroes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> vec_fixed</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">_</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·å–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}, v[0] = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸‹æ ‡å¿…é¡»æ˜¯ usize ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// vec è½¬æ¢ æ•°ç»„/åˆ‡ç‰‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// é•¿åº¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ·»åŠ , åˆ é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»ä¼¼ æ ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//å°¾æ’</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">pop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// å°¾éƒ¨åˆ é™¤è¿”å›</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;popped: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// 7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;None&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;after pop: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// [6]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä» 0 ä½ç½®å¼€å§‹æ¸…é™¤åˆ°æœ«å°¾, ç­‰åŒæ¸…ç©ºæ•°æ®, ä½†æ˜¯å†…å­˜æ²¡æœ‰é‡Šæ”¾, åªæ˜¯æ“¦é™¤äº†æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    vec </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">truncate</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¸…ç©º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clear</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é‡Šæ”¾ç©ºé—²å®¹é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">shrink_to_fit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ–¹æ³•ï¼Œé¢„åˆ†é…çš„å †å†…å­˜è¢«é‡Šæ”¾äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// äº¤æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">swap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…¨éƒ¨æ›¿æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// copy_from_slice æ–¹æ³•å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ•°ç»„åˆ‡ç‰‡å°†åŸ vec æ•° ç»„ ä¸­çš„å…ƒç´ å…¨éƒ¨æ›¿æ¢, æ•°ç»„åˆ‡ç‰‡å¿…é¡»å’ŒåŸæ•°ç»„ç­‰é•¿, åªæ”¯æŒå®ç° Copy è¯­ä¹‰çš„å…ƒç´ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//  clone_from sliceæ–¹æ³•çš„æ•ˆæœå’Œ copy_ä»•om sliceæ˜¯ç­‰ä»·çš„ï¼Œ ä½†å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œ clone from slice æ–¹æ³•æ”¯æŒå®ç° Clone çš„ç±»å‹å…ƒç´ ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ·»åŠ å¦å¤–çš„ vector</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">101</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">append</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;vec: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;v2: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//v2: []</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤„ç†ä¸‹æ ‡è¶Šç•Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿”å›çš„æ˜¯ Option&lt;T&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Item 7 is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Sorry, this vector is too short.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//  containsã€ starts withå’Œ ends with</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿­ä»£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿­ä»£å‡ºçš„æ˜¯å…ƒç´ å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> ele </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">vec </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ä¸å¯å˜å¼•ç”¨: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ele</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯å˜è¿­ä»£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> ele </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> vec </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;å¯å˜å¼•ç”¨: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ele</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤æ—¶å¯ä»¥ä¿®æ”¹å…ƒç´ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">ele </span><span class="token operator" style="color:rgb(0, 0, 0)">*=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ç¬¬ä¸€ä¸ª* è¡¨ç¤ºæ ¹æ®åœ°å€å–å¾—å€¼, ç¬¬äºŒä¸ª*æ˜¯è¿ç®—ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¦ä¸‹æ ‡è¿­ä»£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">enumerate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> ele </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> vec </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;æœ¬ä½“: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ele</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»å‹æ¨æ–­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› ä¸ºæœ‰ç±»å‹è¯´æ˜ï¼Œç¼–è¯‘å™¨çŸ¥é“ `elem` çš„ç±»å‹æ˜¯ u8ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> elem </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»ºä¸€ä¸ªç©ºå‘é‡ï¼ˆvectorï¼Œå³ä¸å®šé•¿çš„ï¼Œå¯ä»¥å¢é•¿çš„æ•°ç»„ï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> vec </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">elem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å•Šå“ˆ èªæ˜ï¼ç°åœ¨ç¼–è¯‘å™¨çŸ¥é“ `vec` æ˜¯ u8 çš„å‘é‡äº†ï¼ˆ`Vec&lt;u8&gt;`ï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è½¬æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// slices æ˜¯ &amp;[u8] ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> slices</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_utf8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Vec&lt;String&gt; -&gt; Vec&lt;&amp;str&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v7</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">s</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_ref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">s</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> s </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">s</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> s </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">s</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">s</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">ops</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Deref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">deref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="552-åŒç«¯é˜Ÿåˆ—-vecdeque">5.5.2. åŒç«¯é˜Ÿåˆ— VecDeque<a href="#552-åŒç«¯é˜Ÿåˆ—-vecdeque" class="hash-link" aria-label="5.5.2. åŒç«¯é˜Ÿåˆ— VecDequeçš„ç›´æ¥é“¾æ¥" title="5.5.2. åŒç«¯é˜Ÿåˆ— VecDequeçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// æ˜¯ä¸€ç§ åŒæ—¶å…·æœ‰ é˜Ÿåˆ—(å…ˆè¿›å…ˆå‡º)å’Œæ ˆ (åè¿›å…ˆå‡º)æ€§è´¨çš„æ•°æ® ç»“æ„ ã€‚ åŒç«¯é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¯ ä»¥ä»ä¸¤ç«¯å¼¹å‡ºï¼Œæ’å…¥å’Œåˆ é™¤æ“ä½œè¢«é™å®š åœ¨é˜Ÿåˆ—çš„ä¸¤ç«¯è¿›è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å†…éƒ¨ä¸»è¦ç»´æŠ¤ä¸€ä¸ªç¯å½¢ç¼“å†²åŒº (RingBuffer), ç”±ä¸¤ä¸ªæŒ‡é’ˆå’Œ ä¸€ ä¸ªå¯å¢é•¿æ•°ç»„ç»„æˆ ã€‚ è¿™ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä¸º å¤´æŒ‡é’ˆ( Head Pointer)å’Œå°¾æŒ‡é’ˆ( Tail Pointer)ã€‚ å…¶ä¸­å¤´æŒ‡é’ˆæ°¸è¿œæŒ‡å‘åº”è¯¥å†™å…¥æ•°æ® çš„ä½ç½®ï¼Œè€Œå°¾æŒ‡é’ˆæ°¸ è¿œæŒ‡ å‘å¯ä»¥è¯»å–çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç¼“å†²åŒºæº¢å‡º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å‡è®¾ç¼“å†²åŒºæ•°ç»„åˆå§‹å¤§å°ä¸º8, ç¯å½¢ ç¼“å†²åŒºä¸ºç©º æ—¶ï¼Œä¸¤ä¸ªæŒ‡é’ˆéƒ½æŒ‡å‘ä½ç½® 0ã€‚å½“æœ‰æ–°å…ƒç´  æ’å…¥æ—¶ï¼Œå¦‚æœ ç›´æ¥æ’å…¥ä½ç½® 0ï¼Œåˆ™å°†ç”¨äºå†™å…¥æ•°æ® çš„ Head æŒ‡é’ˆæŒ‡å‘ä½ç½® 1ï¼Œ è€Œç”¨äºè¯»å–æ•°æ®çš„ Tail æŒ‡é’ˆä¾ æ—§æŒ‡å‘ä½ç½® 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å½“æ’å…¥ç¬¬ 8 ä¸ªå…ƒç´ æ—¶ï¼Œ Head å’Œ Tail æŒ‡é’ˆå°†å†æ¬¡é‡å , </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚æœè¿™æ—¶ç»§ç»­ç»™ç¼“å†²åŒºæ·»åŠ æ–°å…ƒç´  ï¼Œ é‚£ä¹ˆä½ç½® ã€‚ å¤„çš„æ•°æ®å°†è¢« å…¶ä»–æ•°æ®è¦†ç›–ï¼Œè¿™å°±ä¼šé€ æˆç¼“å†²åŒºæº¢å‡ºæ”»å‡»; ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œéœ€è¦ç©ºå‡ºä¸€ä¸ªä½ç½®ï¼Œ ä¸èƒ½æ’å…¥å…ƒç´  ï¼Œ è¿™æ ·æ‰å¯ä»¥åŒºåˆ†å¤´å’Œå°¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¦åˆ¤æ–­ç¯å½¢ç¼“å†²åŒºæ˜¯å¦ä¸ºæ»¡çŠ¶æ€ï¼Œå°±å¿…é¡»çœ‹å®¹é‡å’Œå¤§å°çš„å·®æ˜¯å¦ä¸º l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="553-é“¾è¡¨-linkedlist">5.5.3. é“¾è¡¨ Linkedlist<a href="#553-é“¾è¡¨-linkedlist" class="hash-link" aria-label="5.5.3. é“¾è¡¨ Linkedlistçš„ç›´æ¥é“¾æ¥" title="5.5.3. é“¾è¡¨ Linkedlistçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å› ä¸ºæ˜¯åŒå‘åˆ—è¡¨ï¼Œ æ‰€ä»¥æä¾›äº† push back å’Œ push front ä¸¤ç±»æ–¹æ³•ï¼Œæ–¹ä¾¿æ“ä½œ æ­¤é“¾è¡¨ã€‚ä¹Ÿæä¾›äº† append æ–¹æ³• ï¼Œ å¯ä»¥ç”¨æ¥è¿æ¥ä¸¤ä¸ªé“¾è¡¨</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="554-hashmap-æ— åºå“ˆå¸Œè¡¨">5.5.4. hashmap æ— åºå“ˆå¸Œè¡¨<a href="#554-hashmap-æ— åºå“ˆå¸Œè¡¨" class="hash-link" aria-label="5.5.4. hashmap æ— åºå“ˆå¸Œè¡¨çš„ç›´æ¥é“¾æ¥" title="5.5.4. hashmap æ— åºå“ˆå¸Œè¡¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Keyå¿…é¡»æ˜¯å¯å“ˆå¸Œçš„ç±»å‹ï¼Œ Valueå¿…é¡»æ˜¯åœ¨ç¼–è¯‘æœŸå·²çŸ¥å¤§å°çš„ç±»å‹</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5541-å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨">5.5.4.1. å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨<a href="#5541-å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="5.5.4.1. å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.5.4.1. å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///HashMap çš„é”®å¯ä»¥æ˜¯å¸ƒå°”å‹ã€æ•´å‹ã€å­—ç¬¦ä¸²ï¼Œæˆ–ä»»æ„å®ç°äº† Eq å’Œ Hash trait çš„å…¶ä»–ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///HashMap åœ¨å æ®äº†å¤šä½™ç©ºé—´æ—¶è¿˜å¯ä»¥ç¼©å° è‡ªå·±</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">hash_table</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">collections</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> map </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸ä¼šé¢„åˆ†é…å†… å­˜ã€‚è‹¥å§‹ç»ˆä¸æ·»åŠ å…ƒç´ , ä¼šç¼–è¯‘æŠ¥é”™, ç¼–è¯‘å™¨è®¤ä¸º map æ²¡æœ‰åˆå§‹åŒ–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">with_capacity</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">unit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//åˆ›å»ºå…·æœ‰ä¸€å®šåˆå§‹å®¹é‡çš„ HashMap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä» vector æ„é€ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> keys </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> values </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> _</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> keys</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">zip</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">values</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦ä¸€ç§åˆå§‹åŒ–æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">char</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;I&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;V&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;X&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;L&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;C&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;D&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">500</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;M&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into_iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ’å…¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœè¢«æ’å…¥çš„å€¼ä¸ºæ–°å†…å®¹ï¼Œé‚£ä¹ˆ `HashMap::insert()` è¿”å› `None`ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦åˆ™è¿”å› `Some(è¢«è¦†ç›–çš„ value)`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;color&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;red&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ²¡æœ‰å£°æ˜æ•£åˆ—è¡¨çš„æ³›å‹ï¼Œæ˜¯å› ä¸º Rust çš„è‡ªåŠ¨åˆ¤æ–­ç±»å‹æœºåˆ¶ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;size&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;10 m^2&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸å­˜åœ¨æ‰æ’å…¥å€¼ red, å¹¶ä¸”è¿”å›è¯¥å€¼çš„å¯å˜å€Ÿç”¨, (ä¸€èˆ¬çš„æ’å…¥åˆ™æ˜¯æœ‰åˆ™è¦†ç›–æ—§çš„å€¼)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or_insert_with(FnOnce) ä¼ é€’ä¸€ä¸ªå¯è®¡ç®—çš„é—­åŒ…ä½œä¸ºè¦æ’å…¥çš„å€¼, é—­åŒ…æ²¡æœ‰å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// key()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">entry</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;color&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">or_insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;red&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// , è¿”å› &quot;red&quot; çš„ &amp;mut T </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//åˆ é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">remove</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ashley&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·å–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¥å—ä¸€ä¸ªå¼•ç”¨å¹¶è¿”å› Option&lt;&amp;V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> one </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;color&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> one </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;color&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;one is a Option&lt;&amp;V&gt; ,  {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">one</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯å˜è·å–(ä¿®æ”¹) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> map </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ˜¯å¦åŒ…å«</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">book_reviews</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">contains_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rust book&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;find {} times &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> book_reviews</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// é•¿åº¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿­ä»£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> p </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">//è¿­ä»£å…ƒç´ æ˜¯è¡¨ç¤ºé”®å€¼å¯¹çš„å…ƒç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">k</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// å…ƒç´ ä¸º (&amp;&#x27;a key, &amp;&#x27;a value) å¯¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}, {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡keyså’Œvaluesæ–¹æ³•å¯ä»¥åˆ†åˆ«å•ç‹¬è·å–HashMapä¸­çš„é”®/å€¼çš„è¿­ä»£å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> key </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> book_reviews</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">keys</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> val </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> book_reviews</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">values</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»Ÿè®¡å¥å­ä¸­çš„å•è¯ä¸ªæ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> text </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;aa bb cc bb&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> counter </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> word </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> text</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">split_whitespace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> counter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">entry</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">word</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">or_insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">count </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">word</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> counter </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}, {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> word</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆå¹¶å¤šä¸ª HashMap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ª HashMap, å°½é‡ä½¿ç”¨ extendæˆ–å…¶ä»–è¿­ä»£å™¨é€‚é…å™¨æ–¹å¼ï¼Œ è€Œä¸è¦ç”¨ forå¾ªç¯æ¥æ’å…¥ ,å¦åˆ™ä¼šå¸¦æ¥æ€§èƒ½ é—®é¢˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">extend</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">map2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//æœ¬è´¨ä¸Šï¼Œ åœ¨ extendæ–¹æ³•å†…éƒ¨ä¹Ÿå°† HashMapè½¬æ¢ä¸ºæ³•ä»£å™¨è¿›è¡Œæ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into_iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">map2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">//åŒæ ·æ˜¯é€šè¿‡ into_iterå¾—åˆ° Chainè¿­ä»£å™¨ ç„¶åæ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¢«æ·»åŠ çš„ map_ref æ˜¯ä¸ªå¼•ç”¨, åŸå§‹ map ä¸ä¼šä¸¢å¤±æ‰€æœ‰æƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    map1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">extend</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        map_ref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into_iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params">k</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token closure-params"> v</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">k</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5542-å¤åˆç±»å‹ä½œä¸º-key">5.5.4.2. å¤åˆç±»å‹ä½œä¸º key<a href="#5542-å¤åˆç±»å‹ä½œä¸º-key" class="hash-link" aria-label="5.5.4.2. å¤åˆç±»å‹ä½œä¸º keyçš„ç›´æ¥é“¾æ¥" title="5.5.4.2. å¤åˆç±»å‹ä½œä¸º keyçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŸºç¡€ç±»å‹çš„ æµ®ç‚¹æ•°, æ— æ³•ä½œä¸º key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤æ‚ç±»å‹ä½œä¸ºé”® key, å¿…é¡»å®ç° Hashå’ŒEq trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//f32 å’Œ f64 æ²¡æœ‰å®ç° Hashï¼Œè¿™å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”±äºè‹¥ä½¿ç”¨æµ®ç‚¹æ•°ä½œä¸º æ•£åˆ—è¡¨çš„é”®ï¼Œæµ®ç‚¹ç²¾åº¦è¯¯å·®ä¼šå¾ˆå®¹æ˜“å¯¼è‡´é”™è¯¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯¹äºæ‰€æœ‰çš„é›†åˆç±»ï¼ˆcollection classï¼‰ï¼Œå¦‚æœå®ƒä»¬åŒ…å«çš„ç±»å‹éƒ½åˆ†åˆ«å®ç°äº† Eq å’Œ Hashï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//é‚£ä¹ˆè¿™äº›é›†åˆç±»ä¹Ÿå°±å®ç°äº† Eq å’Œ Hashã€‚ä¾‹å¦‚ï¼Œè‹¥ T å®ç°äº† Hashï¼Œåˆ™ Vec&lt;T&gt; ä¹Ÿå®ç°äº† Hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è‡ªå®šä¹‰ç±»å‹å¯ä»¥è½»æ¾åœ°å®ç° Eq å’Œ Hashï¼Œåªéœ€åŠ ä¸Šä¸€è¡Œä»£ç ï¼š#[derive(PartialEq, Eq, Hash)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Eq è¦æ±‚ä½ å¯¹æ­¤ç±»å‹æ¨å¯¼ PartiaEqã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(PartialEq, Eq, Hash)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Account</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        password</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">AccountInfo</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        email</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Accounts</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashMap</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Account</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">AccountInfo</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">try_logon</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">accounts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Accounts</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Username: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Password: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Attempting logon...&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> logon </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Account</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            password</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> accounts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">logon</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">account_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Successful logon!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Name: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> account_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Email: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> account_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">email</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Login failed!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5543-å“ˆå¸Œç¢°æ’æ”»å‡»">5.5.4.3. å“ˆå¸Œç¢°æ’æ”»å‡»<a href="#5543-å“ˆå¸Œç¢°æ’æ”»å‡»" class="hash-link" aria-label="5.5.4.3. å“ˆå¸Œç¢°æ’æ”»å‡»çš„ç›´æ¥é“¾æ¥" title="5.5.4.3. å“ˆå¸Œç¢°æ’æ”»å‡»çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>map åº•å±‚ä½¿ç”¨æ•°ç»„å­˜å‚¨æ•°æ®, éœ€è¦ä¸€ä¸ªé«˜æ•ˆçš„ hash å‡½æ•°å‡åŒ€çš„å°†å…ƒç´ åˆ†æ•£å­˜å‚¨åœ¨ æ•°ç»„ä¸­ </p><p>è´Ÿè½½å› å­: å½“å‰çš„é»˜è®¤æ‰©å®¹ç­–ç•¥ ä¸ºè´Ÿè½½å› å­è¾¾åˆ° 0.9 æ—¶åˆ™è¿›è¡Œæ‰©å®¹</p><p>Rustæ ‡å‡†åº“å®ç°çš„ HashMapï¼Œ é»˜è®¤çš„ Hash å‡½æ•°ç®—æ³•æ˜¯ SipHashl3o å¦å¤–ï¼Œæ ‡å‡†åº“è¿˜å®ç° äº† SipHash24, SipHashç®—æ³•å¯ä»¥é˜²æ­¢ Hashç¢°æ’æ‹’ç»æœåŠ¡æ”»å‡»(Hash Collision DoS)ï¼Œè¿™ç§
æ”»å‡»æ˜¯ä¸€ç§åŸºäºå„è¯­è¨€ Hash ç®—æ³•çš„éšæœºæ€§è€Œç²¾å¿ƒæ„é€ å‡ºæ¥çš„å¢å¼º Hashç¢°æ’çš„æ‰‹æ®µï¼Œè¢«æ”»å‡» çš„æœåŠ¡å™¨ CPU å ç”¨ç‡ä¼šè½»æ¾åœ°åˆ¶å‡åˆ° 100%</p><p>å¦‚ä½•è§£å†³å“ˆå¸Œç¢°æ’?</p><ul><li>å¤–éƒ¨æ‹‰é“¾æ³•: åœ¨æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä½ç½®, é‡åˆ°ç¢°æ’å, ç”Ÿé•¿å‡ºä¸€ä¸ªé“¾è¡¨, ä½†æ˜¯æœ‰é€€åŒ–åˆ°å•é“¾è¡¨çš„é£é™©</li><li>å¼€æ”¾å®šå€æ³•: åœ¨å‘ç”Ÿå†²çªæ—¶ç›´æ¥å»å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºçš„åœ°å€, å¼€æ”¾å®šå€æ³•çš„ä¼˜ç‚¹åœ¨äºè®¡ç®—ç®€å•ã€å¿«æ·ï¼Œå¤„ç†æ–¹ä¾¿:ç¼ºç‚¹æ˜¯å®ƒä¼š äº§ç”Ÿèšé›† ç°è±¡ï¼Œå¹¶ä¸”åˆ é™¤å…ƒ ç´ ä¹Ÿä¼šå˜å¾—ååˆ†å¤æ‚(å› ä¸ºå¹¶ä¸èƒ½çœŸçš„åˆ é™¤ï¼Œ å¦åˆ™ä¼šç ´åå¯»å€çš„æ­£ç¡®æ€§)
å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºåœ°å€çš„è¡Œä¸ºï¼Œå«ä½œæ¢æµ‹ (Probe)ã€‚ä¾æ¬¡ ä¸€ ä¸ªä¸ªåœ° å¯»æ‰¾ å«ä½œ ç»­æ€§æ¢æµ‹( Linear Probing), rust é‡‡ç”¨è¿™ç§</li></ul><blockquote><p>åœ¨çº¿æ€§æ¢æµ‹æ—¶ï¼Œå¦‚æœé‡åˆ°ç©ºæ¡¶ï¼Œ åˆ™æ­£å¸¸æ’å…¥; å¦‚æœé‡åˆ°æ¡¶å·± ç»è¢«å ç”¨ ï¼Œé‚£ä¹ˆ å°±è¦çœ‹å ç”¨è¿™ä¸ªæ¡¶çš„é”®å€¼å¯¹æ˜¯ç»å† è¿‡å‡ æ¬¡ æ¢æµ‹æ‰è¢«æ’å…¥è¯¥ä½ç½® çš„ï¼Œ å¦‚æœè¯¥é”®å€¼å¯¹çš„æ¢æµ‹æ¬¡æ•°æ¯”å½“å‰å¾…æ’å…¥çš„é”®å€¼å¯¹çš„æ¢æµ‹æ¬¡æ•°å°‘ï¼Œåˆ™å®ƒå±äºâ€œå¯Œç¿â€ï¼Œ å°±æŠŠå½“å‰çš„é”®å€¼å¯¹æ’å…¥è¯¥ä½ç½®ï¼Œå†æ¥ç€æ‰¾ä¸‹ä¸€ä¸ªä½ç½®æ¥å®‰ç½®è¢«æ›¿æ¢çš„â€œå¯Œç¿â€é”®å€¼å¯¹ã€‚ æ­£æ˜¯å›  ä¸ºè¿™ç§â€œåŠ« å¯Œæµè´« â€çš„æ€è·¯ï¼Œè¿™ç§ ç®—æ³•æ‰è¢«ç§° ä¸ºç½— å®¾æ±‰ç®—æ³•ã€‚</p></blockquote><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="555-btreemap-æœ‰åºå“ˆå¸Œè¡¨">5.5.5. BTreeMap æœ‰åºå“ˆå¸Œè¡¨<a href="#555-btreemap-æœ‰åºå“ˆå¸Œè¡¨" class="hash-link" aria-label="5.5.5. BTreeMap æœ‰åºå“ˆå¸Œè¡¨çš„ç›´æ¥é“¾æ¥" title="5.5.5. BTreeMap æœ‰åºå“ˆå¸Œè¡¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>åŸºäº B æ ‘çš„æœ‰åºæ˜ å°„é›†å®ç°ï¼ŒæŒ‰ Key æ’åº</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="556-hashset-æ— åºé›†åˆ">5.5.6. hashset æ— åºé›†åˆ<a href="#556-hashset-æ— åºé›†åˆ" class="hash-link" aria-label="5.5.6. hashset æ— åºé›†åˆçš„ç›´æ¥é“¾æ¥" title="5.5.6. hashset æ— åºé›†åˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// HashSet&lt;K&gt; BTreeSet&lt;K&gt;å…¶å®å°±æ˜¯ HashMap&lt;K, V&gt;å’Œ BTrå·³eMap&lt;K, V&gt;æŠŠ Value è®¾ç½® ä¸ºç©ºå…ƒç»„çš„ç‰¹å®šç±»å‹ï¼Œç­‰ä»·äº HashSet&lt;K, ()&gt;å’Œ BTreeSet&lt;K, ()&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ•£åˆ—é›† HashSet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//unionï¼ˆå¹¶é›†ï¼‰ï¼šè·å¾—ä¸¤ä¸ªé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆä¸å«é‡å¤å€¼ï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// differenceï¼ˆå·®é›†ï¼‰ï¼šè·å–å±äºç¬¬ä¸€ä¸ªé›†åˆè€Œä¸å±äºç¬¬äºŒé›†åˆçš„æ‰€æœ‰å…ƒç´ ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// intersectionï¼ˆäº¤é›†ï¼‰ï¼šè·å–åŒæ—¶å±äºä¸¤ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// symmetric_differenceï¼ˆå¯¹ç§°å·®ï¼‰ï¼šè·å–æ‰€æœ‰åªå±äºå…¶ä¸­ä¸€ä¸ªé›†åˆï¼Œè€Œä¸åŒæ—¶å±äº ä¸¤ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">collections</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">HashSet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashSet</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into_iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HashSet</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into_iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">insert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœå€¼å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆ `HashSet::insert()` è¿”å› false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">contains</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//æ˜¯å¦å­˜åœ¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¹¶é›†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> c </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">union</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="557-btreeset-æœ‰åºé›†åˆ">5.5.7. BTreeSet æœ‰åºé›†åˆ<a href="#557-btreeset-æœ‰åºé›†åˆ" class="hash-link" aria-label="5.5.7. BTreeSet æœ‰åºé›†åˆçš„ç›´æ¥é“¾æ¥" title="5.5.7. BTreeSet æœ‰åºé›†åˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="558-ä¼˜å…ˆé˜Ÿåˆ—-binaryheap">5.5.8. ä¼˜å…ˆé˜Ÿåˆ— BinaryHeap<a href="#558-ä¼˜å…ˆé˜Ÿåˆ—-binaryheap" class="hash-link" aria-label="5.5.8. ä¼˜å…ˆé˜Ÿåˆ— BinaryHeapçš„ç›´æ¥é“¾æ¥" title="5.5.8. ä¼˜å…ˆé˜Ÿåˆ— BinaryHeapçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ä½¿ç”¨ peekæ–¹æ³•å¯ä»¥ å–å‡ºå †ä¸­çš„æœ€å¤§å€¼</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="56-ç±»å‹è½¬æ¢">5.6. ç±»å‹è½¬æ¢<a href="#56-ç±»å‹è½¬æ¢" class="hash-link" aria-label="5.6. ç±»å‹è½¬æ¢çš„ç›´æ¥é“¾æ¥" title="5.6. ç±»å‹è½¬æ¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="561-åŸºæœ¬çš„ç±»å‹è½¬æ¢">5.6.1. åŸºæœ¬çš„ç±»å‹è½¬æ¢<a href="#561-åŸºæœ¬çš„ç±»å‹è½¬æ¢" class="hash-link" aria-label="5.6.1. åŸºæœ¬çš„ç±»å‹è½¬æ¢çš„ç›´æ¥é“¾æ¥" title="5.6.1. åŸºæœ¬çš„ç±»å‹è½¬æ¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»å‹è½¬æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//Rust ä¸æä¾›åŸç”Ÿç±»å‹ä¹‹é—´çš„éšå¼ç±»å‹è½¬æ¢ï¼ˆcoercionï¼‰ï¼Œä½†å¯ä»¥ä½¿ç”¨ as å…³é”®å­—è¿›è¡Œæ˜¾ å¼ç±»å‹è½¬æ¢ï¼ˆcastingï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;------ç±»å‹è½¬æ¢--------------------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> decimal </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">65.4321_f32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡å­—é¢é‡ç›´æ¥å£°æ˜ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯ï¼ä¸æä¾›éšå¼è½¬æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> integer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> decimal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯ä»¥æ˜¾å¼è½¬æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> integer </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> decimal </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> character </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> integer </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">char</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="562-è½¬æ¢ç›¸å…³çš„-trait">5.6.2. è½¬æ¢ç›¸å…³çš„ trait<a href="#562-è½¬æ¢ç›¸å…³çš„-trait" class="hash-link" aria-label="5.6.2. è½¬æ¢ç›¸å…³çš„ traitçš„ç›´æ¥é“¾æ¥" title="5.6.2. è½¬æ¢ç›¸å…³çš„ traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å…¶ä»–è½¬æ¢ç›¸å…³çš„ trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//fromå’Œinto æ–¹æ³•æ˜¯ä¸€å¯¹ï¼Œå®ç°äº†From traitå°±ä¼šè‡ªåŠ¨åè¿‡æ¥å®ç°Into</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - std::convert::From æ¥å£å®šä¹‰ â€œæ€ä¹ˆæ ¹æ®å¦ä¸€ç§ç±»å‹ç”Ÿæˆè‡ªå·±â€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - Into trait å°±æ˜¯æŠŠ From trait å€’è¿‡æ¥è€Œå·²; ä½¿ç”¨ Into trait é€šå¸¸è¦æ±‚æŒ‡æ˜è¦è½¬æ¢åˆ°çš„ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//- TryFrom and TryInto trait ç”¨äºæ˜“å‡ºé”™çš„è½¬æ¢ï¼Œä¹Ÿæ­£å› å¦‚æ­¤ï¼Œå…¶è¿”å›å€¼æ˜¯ Result </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//- ToString trait è¦æŠŠä»»ä½•ç±»å‹è½¬æ¢æˆ Stringï¼Œåªéœ€è¦å®ç° to_string æ–¹æ³•ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//ç„¶è€Œä¸è¦ç›´æ¥è¿™ä¹ˆåšï¼Œåº”è¯¥å®ç°fmt::Display traitï¼Œå®ƒä¼šè‡ªåŠ¨æä¾› ToStringï¼Œå¹¶ä¸”è¿˜å¯ä»¥ç”¨æ¥æ‰“å°ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//-  å¯¹åº”çš„æœ‰ FromStr, åªè¦å¯¹ç›®æ ‡ç±»å‹å®ç°äº† FromStr traitï¼Œå°±å¯ä»¥ç”¨ parse æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆç›®æ ‡ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">convert</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">From</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">From</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> item </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> num </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;My number is {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> int </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// num ç±»å‹å¿…é¡»æŒ‡å®š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;My number is {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="57-æ‰€æœ‰æƒ">5.7. æ‰€æœ‰æƒ<a href="#57-æ‰€æœ‰æƒ" class="hash-link" aria-label="5.7. æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥" title="5.7. æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="571-ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ-raiiæœºåˆ¶">5.7.1. ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ RAIIæœºåˆ¶<a href="#571-ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ-raiiæœºåˆ¶" class="hash-link" aria-label="5.7.1. ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ RAIIæœºåˆ¶çš„ç›´æ¥é“¾æ¥" title="5.7.1. ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ RAIIæœºåˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ‰€æœ‰æƒæ˜¯å¯¹å †å†…å­˜ä¸Šçš„æ•°æ®æ¥è¯´çš„, æ‰€æœ‰æƒä¸ºæ¯ä¸ªæ•°æ®è§„å®šäº†ä¸»äºº, é¿å…äº†æ•°æ®ç«äº‰, åŒæ—¶ä¹Ÿèƒ½å‡å°‘bug. </p><p>æ ˆå†…å­˜ä¸­å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„, éšç€æ–¹æ³•è°ƒç”¨çš„ç»“æŸè€Œæ¸…ç†, å †å†…å­˜çš„å˜é‡è™½ç„¶å¯ä»¥é•¿ä¹…å­˜åœ¨, ä½†æ˜¯éçº¿ç¨‹ç§æœ‰, å…¶å†…éƒ¨çš„æ•°æ®éœ€è¦é€šè¿‡æ ˆå†…å­˜ä¸­çš„æŒ‡é’ˆæ¥ä½¿ç”¨</p><p>æŒ‡é’ˆåœ¨å †ä¸Šå¼€è¾Ÿå†…å­˜ ç©º é—´ï¼Œå¹¶æ‹¥æœ‰å…¶æ‰€æœ‰æƒï¼Œé€šè¿‡å­˜å‚¨äºstackä¸­çš„æŒ‡é’ˆæ¥ç®¡ç†å †å†…å­˜ , æ™ºèƒ½æŒ‡é’ˆçš„ RAII æœºåˆ¶åˆ©ç”¨stackçš„ç‰¹ç‚¹ï¼Œåœ¨å…ƒç´ è¢«è‡ªåŠ¨æ¸…ç©ºæ—¶è‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼Œæ¥é‡Šæ”¾æ™º èƒ½æŒ‡é’ˆæ‰€ç®¡ç†çš„å †å†…å­˜ ç©ºé—´</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="572-åŸºæœ¬åŸåˆ™">5.7.2. åŸºæœ¬åŸåˆ™<a href="#572-åŸºæœ¬åŸåˆ™" class="hash-link" aria-label="5.7.2. åŸºæœ¬åŸåˆ™çš„ç›´æ¥é“¾æ¥" title="5.7.2. åŸºæœ¬åŸåˆ™çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// æ¯ç§ç¼–ç¨‹è¯­è¨€éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—å†…å­˜ç®¡ç†çš„æ–¹æ³•ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//æœ‰äº›éœ€è¦æ˜¾å¼çš„åˆ†é…å’Œå›æ”¶å†…å­˜ï¼ˆå¦‚Cï¼‰ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æœ‰äº›è¯­è¨€åˆ™ä¾èµ–äºåƒåœ¾å›æ”¶å™¨æ¥å›æ”¶ä¸ä½¿ç”¨çš„å†…å­˜ï¼ˆå¦‚Javaï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è€ŒRustä¸å±äºä»¥ä¸Šä»»ä½•ä¸€ç§ï¼Œå®ƒæœ‰ä¸€å¥—è‡ªå·±çš„å†…å­˜ç®¡ç†è§„åˆ™ï¼Œå«åšOwnershipã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// //</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 1.  åœ¨åŒä¸€ä¸ª scope å†…,&quot;å€¼&quot;æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª owner, å½“ownerè¶…å‡ºä½œç”¨åŸŸåï¼Œå€¼ä¼šè¢«é”€æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//          ä¾‹å¦‚ , </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//           å› ä¸ºå‡½æ•°è°ƒç”¨åº•å±‚å®é™…æ˜¯ å°† a, b èµ‹å€¼ç»™ å‡½æ•°æ ˆä¸­çš„ä¸´æ—¶å˜é‡, é€ æˆ a, b çš„æ‰€æœ‰æƒè½¬ç§»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//            å¯¹äº åŸºæœ¬ç±»å‹ a, å®ç°äº† copy trait, æ‰€æœ‰æƒè½¬ç§»çš„æ•ˆæœæ˜¯ å¤åˆ¶, a ä»ç„¶èƒ½ç»§ç»­ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//            å¯¹äº ç¬¦åˆç±»å‹b, æ²¡æœ‰ copy trait, æ‰€æœ‰æƒè½¬ç§»å, b å°±å¤±æ•ˆäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 2. å¯ä»¥æœ‰å¤šä¸ªä¸å¯å˜å¼•ç”¨å’Œå”¯ä¸€çš„å¯å˜å¼•ç”¨ (ç±»ä¼¼è¯»å†™é”)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//       åœ¨ä¸å¯å˜å€Ÿç”¨æœŸé—´ï¼Œæ‰€æœ‰è€…ä¸èƒ½ä¿®æ”¹èµ„æºï¼Œå¹¶ä¸”ä¹Ÿä¸èƒ½å†è¿›è¡Œå¯å˜å€Ÿç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//       åœ¨å¯å˜å€Ÿç”¨æœŸé—´ï¼Œæ‰€æœ‰è€…ä¸èƒ½è®¿é—®èµ„æºï¼Œå¹¶ä¸”ä¹Ÿä¸èƒ½å†å‡ºå€Ÿæ‰€æœ‰æƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//          </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//            </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 3. references çš„ lifecycle ä¸èƒ½è¶…è¿‡&quot;å€¼&quot;çš„ lifecycle</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//          reference ä¸èƒ½æ¯” owner æ´»çš„æ—¶é—´è¿˜é•¿ (æ¯”å¦‚é€šè¿‡ closure æ•è·ä¸€ä¸ªå¤–éƒ¨å˜é‡, è‹¥ä¸æ˜¾å¼æŒ‡å®š move è¯­ä¹‰, name æ•è·çš„æ˜¯ reference, å¤–éƒ¨çš„ owner å¯èƒ½å·²ç»è¢«å›æ”¶äº†, closure å†…éƒ¨çš„ reference å¯èƒ½è¿˜åœ¨è¢«ä½¿ç”¨, è¿™æ˜¯é”™è¯¯çš„)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="573-å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒ">5.7.3. å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒ<a href="#573-å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒ" class="hash-link" aria-label="5.7.3. å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥" title="5.7.3. å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">ownership</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äº basic type, æ•°æ®çš„äº’åŠ¨éƒ½å‘ç”Ÿåœ¨æ ˆä¸Š, å¤§å°å·²ç»ç¡®å®š, å¤åˆ¶èµ·æ¥å¾ˆå¿«, æ‰€ä»¥é‡‡ç”¨çš„æ˜¯å¤åˆ¶å…‹éš†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç°åœ¨æ ˆä¸­å°†æœ‰ä¸¤ä¸ªå€¼ 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}, {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// éƒ½æœ‰æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//äº§ç”Ÿä¸€ä¸ª String å¯¹è±¡ï¼Œå€¼ä¸º &quot;hello&quot;ã€‚é•¿åº¦å¯å˜, éœ€è¦åœ¨å †ä¸­å­˜å‚¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// s1 å­˜å‚¨åœ¨æ ˆ, ç»“æ„ä¸­åŒ…å«ä¸€ä¸ª ptr, æŒ‡å‘å †ä¸­çš„String å­—ç¬¦åºåˆ—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‹·è´ s1  æœ¬èº«ç»™ s2, å †ä¸­çš„æ•°æ®è¿˜æ˜¯åŒä¸€ä»½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤æ—¶, s1å·²ç»å¤±æ•ˆäº†, è¡¨ç°çš„åƒ s1 ç§»åŠ¨åˆ° s2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸ºä»€ä¹ˆrustè§„å®šæ­¤æ—¶ s1å¤±æ•ˆ?  å› ä¸ºå¦‚æœç¨‹åºåœ¨è¿™é‡Œç»“æŸ,  s1 å’Œ s2 éƒ½è¢«é‡Šæ”¾çš„è¯å †åŒºä¸­çš„ &quot;hello&quot; è¢«é‡Šæ”¾ä¸¤æ¬¡ï¼Œä¼šå‡ºé”™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸ºäº†ç¡®ä¿å®‰å…¨ï¼Œåœ¨ç»™ s2 èµ‹å€¼æ—¶ s1 å·²ç»æ— æ•ˆäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s2 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s1 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤åˆ¶å…‹éš†å †ä¸­çš„å¯¹è±¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤æ—¶, s1 s2 éƒ½æœ‰æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s1 = {}, s2 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="574-å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒ">5.7.4. å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒ<a href="#574-å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒ" class="hash-link" aria-label="5.7.4. å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥" title="5.7.4. å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•° å‚æ•°çš„æ‰€æœ‰æƒæœºåˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¦‚æœå°†å˜é‡å½“ä½œå‚æ•°ä¼ å…¥å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒå’Œç§»åŠ¨çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ (å‡½æ•°å¤–éƒ¨çš„å˜é‡å¤±æ•ˆ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;nihao&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">fn_basic_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°ç»“æŸ, aåŸºæœ¬ç±»å‹, èµ„æºæ— éœ€é‡Šæ”¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">fn_str_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°ç»“æŸ, s èµ„æºè¢«é‡Šæ”¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// s è¢«ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°å†…, å½¢å‚æŒ‡å‘ Stringå¯¹è±¡, é‚£ä¹ˆå‰é¢çš„ s å¤±æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç›¸å½“äºæ•°æ®è¢«ç§»åŠ¨äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">fn_str_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰€ä»¥è¿™é‡Œ s æ— æ•ˆäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// a æ˜¯åŸºæœ¬ç±»å‹, å®ç°äº† copy trait, ä¼ é€’æ—¶æ˜¯ copy,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">fn_basic_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰€ä»¥, æ­¤æ—¶ a ä»ç„¶æœ‰æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="575-å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒ">5.7.5. å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒ<a href="#575-å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒ" class="hash-link" aria-label="5.7.5. å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥" title="5.7.5. å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°è¿”å›å€¼çš„æ‰€æœ‰æƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‡½æ•°è¿”å›å€¼çš„å˜é‡æ‰€æœ‰æƒå°†ä¼šè¢«ç§»åŠ¨å‡ºå‡½æ•°å¹¶è¿”å›åˆ°è°ƒç”¨å‡½æ•°çš„åœ°æ–¹ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è€Œä¸ä¼šç›´æ¥è¢«æ— æ•ˆé‡Šæ”¾ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">return_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">give_and_return_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">return_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°å°†å†…éƒ¨è¿”å›å€¼ç§»åŠ¨åˆ° s1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s3 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">give_and_return_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// s2 è¢«ç§»åŠ¨å¤±æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="576-å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒ">5.7.6. å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒ<a href="#576-å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒ" class="hash-link" aria-label="5.7.6. å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥" title="5.7.6. å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰€æœ‰æƒæœºåˆ¶ä¼šå¸¦æ¥å¤æ‚æ€§</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        email</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xiaoyu&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        email</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;775000738@qq.com&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> _name </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// property &quot;name&quot; was been removed out of p</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç¼–è¯‘å‡ºé”™ &quot;value borrowed here after partial move&quot; , å±æ€§ name ä¸º string, æ²¡æœ‰ copy trait, è¢« move æ‰å, å€¼å°±ä¸º ç©ºäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xy&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é‡æ–°èµ‹å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™æ—¶ä¸ä¼šæŠ¥é”™äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¨¡æ‹ŸåŠ¨ç”»æ¸²æŸ“ç¤ºä¾‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Buffer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Render</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        current</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Render</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">update_buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç¼–è¯‘é”™è¯¯, next æ²¡æœ‰å®ç° copy trait, è¢« move æ‰å, å°±ä¸º ç©ºäº†,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆæ˜¯å®ç° copy trait, ä½†æ˜¯è¿™æ ·å°±æ²¡æ³•äº«å—æ–¹ä¾¿çš„ move è¯­ä¹‰äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">current </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">next </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Buffer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// è§£å†³:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">//éœ€è¦åŠ¨ç”¨ std::mem::replace(&amp;dest, src) å‡½æ•°äº†ï¼Œ è¿™ä¸ªå‡½æ•°æŠŠ src çš„å€¼ move åˆ° dest ä¸­ï¼Œç„¶åæŠŠ dest å†è¿”å›å‡ºæ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">current </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mem</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">replace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Buffer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="577-å¤šæ‰€æœ‰æƒ">5.7.7. å¤šæ‰€æœ‰æƒ<a href="#577-å¤šæ‰€æœ‰æƒ" class="hash-link" aria-label="5.7.7. å¤šæ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥" title="5.7.7. å¤šæ‰€æœ‰æƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>éœ€è¦ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">multi_ownership</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="58-ç”Ÿå‘½å‘¨æœŸå‚æ•°">5.8. ç”Ÿå‘½å‘¨æœŸå‚æ•°<a href="#58-ç”Ÿå‘½å‘¨æœŸå‚æ•°" class="hash-link" aria-label="5.8. ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„ç›´æ¥é“¾æ¥" title="5.8. ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="581-ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸ">5.8.1. ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸ<a href="#581-ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸ" class="hash-link" aria-label="5.8.1. ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸçš„ç›´æ¥é“¾æ¥" title="5.8.1. ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">let a = &quot;hello&quot;;//letç»‘å®šäº†æ ‡è¯†ç¬¦ aå’Œå­˜ å‚¨å­—ç¬¦ä¸²çš„é‚£å—å†…å­˜ï¼Œä»è€Œ aå¯¹é‚£å—å†…å­˜æ‹¥æœ‰äº†æ‰€æœ‰æƒ, a ä¹Ÿå¯ç§°ä¸ºä¸€ä¸ªç»‘å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let b = a; // a çš„æ‰€æœ‰æƒè¢«è½¬ç»™b (a ä¸º &amp;strç±»å‹, æ— æ³•å®ç° copy trait); å…¶å®ä¹Ÿå¯ä»¥ç†è§£ä¸ºå¯¹ aè¿›è¡Œè§£ç»‘ï¼Œç„¶åé‡æ–°ç»‘å®šç»™ bã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç»‘å®šå…·æœ‰æ—¶æ•ˆæ€§ï¼Œä¹Ÿå°±æ˜¯æŒ‡å®ƒçš„ç”Ÿå­˜å‘¨æœŸ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="582-ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š">5.8.2. ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š<a href="#582-ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š" class="hash-link" aria-label="5.8.2. ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šçš„ç›´æ¥é“¾æ¥" title="5.8.2. ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å› ä¸ºå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ£€æŸ¥, ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šæ˜¯ç”¨æ¥æ–¹ä¾¿ç¼–è¯‘å™¨è¿›è¡Œç”Ÿå‘½å‘¨æœŸæ£€æŸ¥çš„ , å¹¶ä¸èƒ½æ”¹å˜ä»»ä½•å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸé•¿çŸ­</p><p>ä¸ºä»€ä¹ˆè¦ç”Ÿå‘½å‘¨æœŸæ£€æŸ¥? å› ä¸ºå­˜åœ¨å¼•ç”¨, å› ä¸ºè¦ä¿è¯å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½é•¿äºå‡ºå€Ÿæ–¹çš„ç”Ÿå‘½å‘¨æœŸ(é˜²æ­¢å‚æ‚¬å¼•ç”¨), æœ‰å¼•ç”¨å°±ä¼šæœ‰ç”Ÿå‘½å‘¨æœŸæ£€æŸ¥ </p><p>ä¸ºä»€éœ€è¦å¼•ç”¨å‘¢? å¤åˆç±»å‹å¦‚æœå…‹éš†çš„è¯, ä¼šæœ‰æ€§èƒ½é—®é¢˜, è¿™ç§æƒ…å†µ, åªèƒ½ä¼ é€’å¼•ç”¨äº†.</p><blockquote><p>æ€»ç»“ä¸€ä¸‹å°±æ˜¯: å‡½æ•°å‚æ•°å¯ ä»¥æŒ‰å€¼ä¼ é€’ï¼Œ ä¹Ÿå¯ä»¥æŒ‰ å¼• ç”¨ä¼ é€’ã€‚å½“å‚æ•°æŒ‰å€¼ ä¼ é€’è‚˜ ï¼Œ ä¼šè½¬ç§»æ‰€æœ‰æƒæˆ–è€…æ‰§è¡Œå¤åˆ¶( Copy)è¯­ä¹‰ã€‚å½“å‚æ•°æŒ‰å¼•ç”¨ä¼ é€’ æ—¶ï¼Œ æ‰€æœ‰æƒä¸ä¼šå‘ç”Ÿ å˜åŒ– ï¼Œä½†æ˜¯éœ€è¦æœ‰ç”Ÿå‘½å‘¨æœŸå‚æ•° ã€‚å½“ ç¬¦åˆç”Ÿå‘½å‘¨æœŸå‚æ•°çœç•¥è§„ åˆ™æ—¶ï¼Œ ç¼–è¯‘å™¨å¯ ä»¥é€šè¿‡è‡ªåŠ¨å‡† æ–­è¡¥é½å‡½æ•°å‚æ•°çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œå¦åˆ™ï¼Œéœ€è¦æ˜¾å¼åœ°ä¸ºå‚æ•°æ ‡æ˜ç”Ÿå‘½å‘¨æœŸå‚æ•°</p></blockquote><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š: ç”¨æ¥æ ‡æ³¨å¤šä¸ªå˜é‡é—´ç”Ÿå‘½å‘¨æœŸçš„å…³ç³», æ¯”å¦‚ç”Ÿå‘½å‘¨æœŸæ˜¯å¦ä¸€æ ·é•¿</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ç›®çš„: é¿å…å‚æ‚¬å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šå¹¶ä¸æ”¹å˜ä»»ä½•å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸçš„é•¿çŸ­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å•ä¸ªçš„ç”Ÿå‘½å‘¨æœŸæ³¨è§£æœ¬èº«æ²¡æœ‰å¤šå°‘æ„ä¹‰ï¼Œå› ä¸ºç”Ÿå‘½å‘¨æœŸæ³¨è§£å‘Šè¯‰ Rust å¤šä¸ªå¼•ç”¨çš„æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°å¦‚ä½•ç›¸äº’è”ç³»çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å¤§éƒ¨åˆ†æƒ…å†µ, ç”Ÿå‘½å‘¨æœŸéƒ½æ˜¯å¯ä»¥è‡ªåŠ¨æ¨æ–­çš„, å°±åƒç±»å‹æ¨æ–­ , æ²¡æ³•æ¨æ–­æ—¶, å°±éœ€è¦æ‰‹åŠ¨æ ‡æ³¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¯­æ³•: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// &amp;â€™a i32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// &amp;&#x27;a mut i32 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">life_cycle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// çœ‹ä¸€ä¸ªæœ‰é—®é¢˜çš„ä¾‹å­:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, `x` does not live long enough, å‡ºäº†x ä½œç”¨åŸŸ, a å¯¹ x çš„å€Ÿç”¨å°±å¤±æ•ˆäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤æ—¶ a å˜ä¸ºå‚æ‚¬å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¸è§„å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// å«æœ‰ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šçš„å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯å˜å‹å«æœ‰ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šçš„å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åªæœ‰ä¸€ä¸ªå‚æ•°å¹¶ä¸”ç›´æ¥è¿”å›çš„ä¾‹å­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› ä¸ºç¼–è¯‘å™¨å¯ä»¥è‡ªå·±æ¨å¯¼å‡ºæ¥ï¼Œå‡½æ•° foo() çš„å‚æ•°å’Œè¿”å›å€¼éƒ½æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œä»–ä»¬çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ï¼Œä¹Ÿå°±å¯ä»¥ç¼–è¯‘é€šè¿‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">foo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;coolshell&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello, &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">foo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™ä¸ªä¾‹å­å°±ä¸è¡Œäº† , ç¼–è¯‘å™¨æ— æ³•åœ¨ç¼–è¯‘æœŸé—´çŸ¥é“ä¼šè¿”å›å“ªä¸ªå˜é‡, ä¹Ÿå°±æ— æ³•è‡ªåŠ¨æ¨å¯¼å‡ºç”Ÿå‘½å‘¨æœŸæ˜¯å¦ç¬¦åˆè¦æ±‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™ä¸ªé”™è¯¯ä¾‹å­åªé’ˆå¯¹è¿”å›å¼•ç”¨çš„æƒ…å†µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">longer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// error, è¿”å›çš„å¼•ç”¨ å¯èƒ½å’Œå‚æ•°å®šä¹‰çš„åœ°æ–¹ä¸åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸ, è¿”å›çš„å¼•ç”¨å­©ç ¸ä½¿ç”¨çš„æ—¶å€™, å‚æ•°è¶…å‡ºä½œç”¨åŸŸè€Œå¤±æ•ˆäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­£ç¡®çš„å†™æ³•: éœ€è¦æ‰‹åŠ¨æŒ‡å®šç”Ÿå‘½å‘¨æœŸæ³¨é‡Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">longer</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">//å‡½æ•°å®šä¹‰æŒ‡å®šäº†ç­¾åä¸­æ‰€æœ‰çš„å¼•ç”¨å¿…é¡»æœ‰ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸ &#x27;a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŠ ä¸Šå‘¨æœŸæ³¨é‡Šå°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨: å‡½æ•°è¿”å›çš„å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸ &lt;= æ¯ä¸ªä¼ å…¥å‚æ•°çš„ç”Ÿå‘½å‘¨æœŸ, å³è¿”å›å€¼åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­, æ˜¯å®‰å…¨çš„, ä¸ä¼šæŒ‡å‘ç©º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rust&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ecmascript&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        r </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">longer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{} is longer&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤æ—¶ s1, s2 éƒ½é”€æ¯äº†, ä¸ºä»€ä¹ˆ r ä»ç„¶æœ‰æ•ˆå‘¢? å› ä¸º s1, s2 éƒ½æ˜¯ &amp;str ç±»å‹, åˆ†é…åœ¨ æ ˆä¸­, åœ¨æ–¹æ³•é€€å‡ºå‰, éƒ½æœ‰æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//çœ‹ String çš„ä¾‹å­:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> string1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;long string is long&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> string2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xyz&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œå°±æœ‰é—®é¢˜äº†, String ç±»å‹ å­—ç¬¦åºåˆ—åˆ†é…åœ¨ heap, è¶…å‡º ä½œç”¨åŸŸè‡ªè¡Œé”€æ¯äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">longer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">string1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> string2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// error, borrowed value does not live long enough</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                                </span><span class="token comment" style="color:rgb(0, 128, 0)">//  string2 ç”Ÿå‘½å‘¨æœŸæ¯” result çŸ­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;The longest string is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//åŠ ä¸åŠ  &#x27;a éƒ½æ˜¯é”™è¯¯, cannot return value referencing local variable `s`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› ä¸ºå‡½æ•°ç»“æŸ, s ä¼šç¦»å¼€ä½œç”¨åŸŸ, è¢«æ¸…ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯è¿”å›ä¸€ä¸ªæœ‰æ‰€æœ‰æƒçš„æ•°æ®ç±»å‹è€Œä¸æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œè¿™æ ·å‡½æ•°è°ƒç”¨è€…å°±éœ€è¦è´Ÿè´£æ¸…ç†è¿™ä¸ªå€¼äº†ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">as_str</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="583-å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°">5.8.3. å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°<a href="#583-å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°" class="hash-link" aria-label="5.8.3. å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„ç›´æ¥é“¾æ¥" title="5.8.3. å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">fn foo&lt;â€™a&gt;(s: &amp;â€™a str, t: &amp;â€™a str) -&gt; &amp;â€™a str</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¾“å‡º(å€Ÿç”¨æ–¹)çš„ç”Ÿå‘½å‘¨æœŸé•¿åº¦å¿…é¡» çŸ­äº/ç­‰äº è¾“å…¥(å‡ºå€Ÿæ–¹)çš„ç”Ÿå‘½å‘¨æœŸé•¿åº¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// -ã€‹è¿”å›çš„å¼•ç”¨å¿…é¡»å’Œè¾“å…¥å‚æ•°æœ‰ç‚¹å…³ç³»æ‰è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="584-ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ-çœç•¥çš„è§„åˆ™">5.8.4. ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ çœç•¥çš„è§„åˆ™<a href="#584-ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ-çœç•¥çš„è§„åˆ™" class="hash-link" aria-label="5.8.4. ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ çœç•¥çš„è§„åˆ™çš„ç›´æ¥é“¾æ¥" title="5.8.4. ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ çœç•¥çš„è§„åˆ™çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ç”Ÿå‘½å‘¨æœŸçœç•¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// çœç•¥éµå¾ªçš„è§„åˆ™:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - åªæœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•°, å¯ä»¥çœç•¥, å¦‚ fn bar&lt;&#x27;a&gt;(x: &amp;&#x27;a i32) -&gt; &amp;&#x27;a 32 ç­‰ä»· fn bar(x: &amp;i32) -&gt; &amp;i32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - æ¯ä¸ªå¼•ç”¨å‚æ•°éƒ½æœ‰å±äºè‡ªå·±çš„å‘¨æœŸå‚æ•°, å¦‚ fn foo&lt;&#x27;a, &#x27;b&gt;(x: &amp;&#x27;a i32, y: &amp;&#x27;b i32), fn bar&lt;&#x27;a&gt;(x: &amp;&#x27;a i32)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - å¯¹äº struct çš„æ–¹æ³•, ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯ &amp;self, é‚£ä¹ˆ self çš„å‘¨æœŸè¢«èµ‹äºˆæ‰€æœ‰è¾“å‡ºç”Ÿå‘½å‘¨æœŸå‚æ•° , æ‰€ä»¥ è¿”å›å‚æ•°å¯ä»¥çœç•¥å‘¨æœŸå‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŠ ä¸Šå‘¨æœŸæ³¨é‡Š, å‘Šè¯‰ç¼–è¯‘å™¨, ç»“æ„ä½“çš„ç”Ÿå‘½å‘¨æœŸ &lt;= æˆå‘˜å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸ, å³æˆå‘˜çš„å‘¨æœŸè¦ä¿è¯ç»“æ„ä½“å‘¨æœŸçš„å®‰å…¨, æˆå‘˜çš„å‘¨æœŸå¿…é¡»è¦æ›´å¤§</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Str</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨å­—ç¬¦ä¸²åˆ‡ç‰‡å¼•ç”¨, ä¹‹å‰éƒ½æ˜¯ä½¿ç”¨çš„ String </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Str</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//è¿™é‡Œè¿”å›å€¼å¹¶æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šï¼Œä½†æ˜¯åŠ ä¸Šä¹Ÿæ— å¦¨ã€‚è¿™æ˜¯ä¸€ä¸ªå†å²é—®é¢˜ï¼Œæ—©</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//æœŸ Rust ä¸æ”¯æŒç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨åˆ¤æ–­ï¼Œæ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå¿…é¡»ä¸¥æ ¼å£°æ˜ï¼Œä½†ä¸»æµ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç¨³å®šç‰ˆæœ¬çš„ Rust å·²ç»æ”¯æŒäº†è¿™ä¸ªåŠŸèƒ½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">get_content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">content</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//æŒ‡å®š: ç»“æ„ä½“æ–¹æ³•çš„â€œå¼•ç”¨å‚æ•°â€çš„ç”Ÿå‘½å‘¨æœŸ &gt;= ç»“æ„ä½“çš„ç”Ÿå‘½å‘¨æœŸ, ä¿è¯ç»“æ„ä½“å‘¨æœŸçš„å®‰å…¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‹¥æ²¡æœ‰ â€˜a, ä¼šæŠ¥é”™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">replate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;string_slice&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ–¹ä¾¿å¤šäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s.content = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get_content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="585-é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š">5.8.5. é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š<a href="#585-é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š" class="hash-link" aria-label="5.8.5. é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šçš„ç›´æ¥é“¾æ¥" title="5.8.5. é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//é™æ€ç”Ÿå‘½å‘¨æœŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//&#x27;static æ‰€è¡¨ç¤ºçš„ç”Ÿå‘½å‘¨æœŸä»ç¨‹åºè¿è¡Œå¼€å§‹åˆ°ç¨‹åºè¿è¡Œç»“æŸã€‚(è‹¥ä¸€ä¸ªç±»å‹è¢«é™åˆ¶ä¸º &#x27;static ,åˆ™è¡¨ç¤ºè¯¥ç±»å‹ä¸èƒ½æ˜¯ä»»ä½•å€Ÿç”¨çš„æ•°æ®, å¿…é¡»æ˜¯ own çš„æ•°æ®, å¿…é¡»æ‹¥æœ‰ownership; å› ä¸º &#x27;static è¯´æ˜ä»–çš„ lifecycle æœ€é•¿, è‹¥è¯¥ç±»å‹æ¥æ”¶çš„æ˜¯å€Ÿç”¨çš„æ•°æ®, é‚£ä¹ˆæ— æ³•ä¿è¯ lifecycle æœ€é•¿)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ‰€æœ‰å­—ç¬¦ä¸²å­—é¢é‡éƒ½æ˜¯ &amp;&#x27;static str ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰ä»·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸€ä¸ªç»¼åˆä¾‹å­ğŸŒ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">longest_with_an_announcement</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ann</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">where</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Announcement! {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ann</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            x</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            y</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="586-ç”Ÿå‘½å‘¨æœŸçº¦æŸ">5.8.6. ç”Ÿå‘½å‘¨æœŸçº¦æŸ<a href="#586-ç”Ÿå‘½å‘¨æœŸçº¦æŸ" class="hash-link" aria-label="5.8.6. ç”Ÿå‘½å‘¨æœŸçº¦æŸçš„ç›´æ¥é“¾æ¥" title="5.8.6. ç”Ÿå‘½å‘¨æœŸçº¦æŸçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// T:â€™aï¼Œ è¡¨ç¤ºTç±»å‹ä¸­çš„ä»»ä½•å¼•ç”¨éƒ½è¦â€œæ´»å¾—â€ å’Œ â€™a ä¸€æ ·é•¿ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// T: Trait + â€˜aï¼Œè¡¨ç¤º Tç±»å‹å¿…é¡»å®ç° Traitè¿™ä¸ª traitï¼Œå¹¶ä¸” Tç±»å‹ä¸­ä»»ä½•å¼•ç”¨éƒ½è¦â€œæ´»å¾—â€å’Œ â€™a ä¸€æ ·é•¿ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="59-å¼•ç”¨">5.9. å¼•ç”¨<a href="#59-å¼•ç”¨" class="hash-link" aria-label="5.9. å¼•ç”¨çš„ç›´æ¥é“¾æ¥" title="5.9. å¼•ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="591-å¼•ç”¨åŸºæœ¬ä»‹ç»">5.9.1. å¼•ç”¨åŸºæœ¬ä»‹ç»<a href="#591-å¼•ç”¨åŸºæœ¬ä»‹ç»" class="hash-link" aria-label="5.9.1. å¼•ç”¨åŸºæœ¬ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="5.9.1. å¼•ç”¨åŸºæœ¬ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å€Ÿç”¨(å¼•ç”¨)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// &quot;&amp;&quot;ç¬¦å·ç”¨äºä»å˜é‡å€Ÿç”¨æ‰€æœ‰æƒ, ç”Ÿæˆä¸€ä¸ªå˜é‡çš„å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ref å£°æ˜æŸä¸ªå˜é‡ä¸ºå¼•ç”¨ç±»å‹, ç”¨æ¥æ›´æ”¹èµ‹å€¼è¡Œä¸º, ä½¿å¾—æ™®é€šçš„å˜é‡èµ‹å€¼è¡Œä¸ºå˜ä¸ºç»™å¼•ç”¨èµ‹å€¼ ; å¯ç”¨äºå…ˆå£°æ˜æŸä¸ªå¼•ç”¨ç±»å‹, åèµ‹å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å¼•ç”¨æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç±»å‹å¹¶å…·æœ‰ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼è®°å½•çš„æ˜¯åˆ«çš„å€¼æ‰€åœ¨çš„ä½ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å¼•ç”¨ä¸ä¼šè·å¾—å€¼çš„æ‰€æœ‰æƒ, å¼•ç”¨åªèƒ½ç§Ÿå€Ÿï¼ˆBorrowï¼‰å€¼çš„æ‰€æœ‰æƒ, æ‰€ä»¥ å˜é‡ a çš„å€¼è¢«å€Ÿç”¨ä¸º b æ—¶ï¼Œa æœ¬èº«ä»ç„¶æœ‰æ•ˆã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// è§£å¼•ç”¨ ä½¿ç”¨ * ---- åœ¨ç­‰å·å³è¾¹ (ä¼šè·å¾—åŸå§‹å€¼çš„æ‰€æœ‰æƒ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å–åœ°å€ ä½¿ç”¨ &amp; ---- åœ¨ç­‰å³è¾¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// è§£æ„ ä½¿ç”¨ &amp; --- åœ¨ç­‰å·å·¦è¾¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// matchçš„æ¨¡å¼åŒ¹é…çš„åŒ¹é…é¡¹ä¸Šåªèƒ½ä½¿ç”¨ refï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// åœ¨å‡½æ•°å£°æ˜ä¸Šåªèƒ½ä½¿ç”¨&amp;æ¥è¡¨ç¤ºå¼•ç”¨ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ä¸€ä¸ªå¼•ç”¨çš„ä½œç”¨åŸŸä»å£°æ˜çš„åœ°æ–¹å¼€å§‹ä¸€ç›´æŒç»­åˆ°æœ€åä¸€æ¬¡ä½¿ç”¨ä¸ºæ­¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// åœ¨ä»»æ„ç»™å®šæ—¶é—´ï¼Œè¦ä¹ˆ åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œè¦ä¹ˆ åªèƒ½æœ‰å¤šä¸ªä¸å¯å˜å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// åˆ†ä¸ºå¯å˜, ä¸å¯å˜å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸€ä¸ªåŸå§‹å€¼, å­˜åœ¨å¯å˜å€Ÿç”¨, å°±æ— æ³•å­˜åœ¨å…¶ä»–å€Ÿç”¨äº†, æ— è®ºæ˜¯å¯å˜å€Ÿç”¨è¿˜æ˜¯ä¸å¯å˜å€Ÿç”¨ (å¯å˜å€Ÿç”¨å…·æœ‰ç‹¬å æ€§)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å­˜åœ¨ä¸å¯å˜å€Ÿç”¨, è¿˜èƒ½å­˜åœ¨å…¶ä»–ä¸å¯å˜å€Ÿç”¨ (ç›¸å½“äºå†…å­˜çš„è¯»å†™é” ï¼ŒåŒä¸€æ—¶åˆ»ï¼Œåªèƒ½ æ‹¥æœ‰ä¸€ä¸ªå†™é”ï¼Œæˆ–è€…å¤šä¸ªè¯»é”ï¼Œä¸èƒ½åŒæ—¶æ‹¥æœ‰)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// å–åœ°å€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">b  </span><span class="token comment" style="color:rgb(0, 128, 0)">// true  , *å·ä¸ºè§£å¼•ç”¨ç¬¦å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a and *b are equal&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// å°†æ‰“å°è¿™å¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;they are not equal&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ref å…³é”®å­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰æ•ˆ, ä¸¤ä¸ªå€¼éƒ½æ˜¯&amp;i32ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…ˆå£°æ˜ä¸€ä¸ªå¼•ç”¨ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//b = 1;// é”™è¯¯, ç±»å‹ä¸åŒ¹é…, expected `&amp;i32`, found integer. expected &amp;i32ï¼Œconsider borrowing here: `&amp;1`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// å†èµ‹å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸ºå‚æ•°å£°æ˜ç±»å‹çš„æ—¶å€™, åªèƒ½ç”¨ &amp;, ä¸èƒ½ç”¨ ref, ref åªç”¨äºå˜é‡ç±»å‹å£°æ˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">B</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;l</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;l</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//é”™è¯¯, expected type, found keyword `ref`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> a </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v_mut </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> v </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ref ä¼šå£°æ˜ val æ˜¯ &amp;i32 ç±»å‹, é€šè¿‡ val æ¥æ”¶ v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> val </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;val æ˜¯å¼•ç”¨, val = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰“å°, *val ä¹Ÿå¯, æ‰“å°æ—¶å¯ä»¥çœç•¥ *</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> v_mut </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> val </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦ val å£°æ˜ä¸º mut</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">val </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;val æ˜¯å¯å˜å¼•ç”¨, val = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è§£å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// r æ˜¯å¼•ç”¨ç±»å‹ &amp;i32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">a</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// a æ˜¯æ™®é€šç±»å‹, i32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// c åŒ a, æ˜¯ i32 (è§£å¼•ç”¨)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// match ä¸­ä½¿ç”¨è§£å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> r </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">val </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;é€šè¿‡è§£å¼•ç”¨è·å–å€¼: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> r </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">val </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ä½¿ç”¨ * è§£å¼•ç”¨: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, * ä¸èƒ½ç”¨æ¥åšå£°æ˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦å…ˆè§£å¼•ç”¨, å†å†…éƒ¨ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">r </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        val </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;åŒ¹é…å‰å…ˆè§£å¼•ç”¨: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">mem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">size_of</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‡½æ•°å¯ä»¥è¿”å›ç±»å‹çš„å­—èŠ‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// &amp;[u32;5]ç±»å‹ä¸ºæ™®é€šæŒ‡é’ˆ (å› ä¸ºæ•°ç»„çš„å…ƒç´ ç±»å‹, å…ƒç´ ä¸ªæ•°ç¡®å®šäº†, æ— éœ€é¢å¤–çš„å®¹é‡æ¥å­˜å‚¨æ•°æ®çš„é•¿åº¦)ï¼Œå 8ä¸ªå­—èŠ‚:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// &amp;mut[u32]ç±»å‹ä¸ºèƒ–æŒ‡é’ˆ (å®½åº¦æ˜¯åŒå®½åº¦çš„, æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ä¸ç¡®å®š, é™¤äº†è¦ä¿å­˜æŒ‡å‘èµ·å§‹ä½ç½®çš„åœ°å€å¤–, è¿˜è¦ä¿å­˜æ•°æ®çš„é•¿åº¦  )ï¼Œå 16 ä¸ªå­—èŠ‚ã€‚ å¯è§ï¼Œ æ•´æ•´å¤šå‡ºäº†ä¸€å€çš„å ç”¨ç©ºé—´ï¼Œè¿™ä¹Ÿæ˜¯ç§°å…¶ä¸ºèƒ–æŒ‡é’ˆçš„åŸå› </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="592-ä¸å¯å˜å¼•ç”¨">5.9.2. ä¸å¯å˜å¼•ç”¨<a href="#592-ä¸å¯å˜å¼•ç”¨" class="hash-link" aria-label="5.9.2. ä¸å¯å˜å¼•ç”¨çš„ç›´æ¥é“¾æ¥" title="5.9.2. ä¸å¯å˜å¼•ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;------------------å¼•ç”¨/å€Ÿç”¨---------------------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·å–å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s1 is {}, s2 is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°è°ƒç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">calculate_length</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">calculate_length</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;The length of &#x27;{}&#x27; is {}.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// s1 è¿˜æœ‰æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, æ‰§è¡Œè¿™å¥, s1 ä¼šç§»åŠ¨è€Œå¤±æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€ æˆ s2 å¯¹ s1 çš„ç§Ÿå€Ÿä¹Ÿå¤±æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s3 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s3 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// // é‡æ–°ä» s3 ç§Ÿå€Ÿæ‰€æœ‰æƒ, è¦æ±‚ s2 æ˜¯ mut çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s2 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¼•ç”¨çš„æ‰€æœ‰æƒæ˜¯ç§Ÿå€Ÿçš„, ä¸å…è®¸ä¿®æ”¹å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;run&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;oob&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯ï¼Œç¦æ­¢ä¿®æ”¹ç§Ÿå€Ÿçš„å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="593-å¯å˜å¼•ç”¨">5.9.3. å¯å˜å¼•ç”¨<a href="#593-å¯å˜å¼•ç”¨" class="hash-link" aria-label="5.9.3. å¯å˜å¼•ç”¨çš„ç›´æ¥é“¾æ¥" title="5.9.3. å¯å˜å¼•ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">borrow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯å˜å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯ä¿®æ”¹å€¼çš„ç§Ÿå€Ÿ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;run&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// s1 æ˜¯å¯å˜çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// s2 æ˜¯å¯å˜çš„å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;oob&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;å¯å˜å¼•ç”¨, s2 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//runoob</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;s1 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//runoob</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯å˜å¼•ç”¨ä¸å…è®¸å¤šé‡å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸€ä¸ªå€¼è¢«å¯å˜å¼•ç”¨æ—¶ä¸å…è®¸å†æ¬¡è¢«ä»»ä½•å¼•ç”¨ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸»è¦å‡ºäºå¯¹å¹¶å‘çŠ¶æ€ä¸‹å‘ç”Ÿæ•°æ®è®¿é—®ç¢°æ’çš„è€ƒè™‘ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå°±é¿å…äº†è¿™ç§äº‹æƒ…çš„å‘ç”Ÿ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, å› ä¸º ä¸¤ä¸ªå¯å˜å¼•ç”¨æŒ‡å‘äº† s;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»ä¼¼çš„å¤šé‡å¼•ç”¨é—®é¢˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ²¡é—®é¢˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r3 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤§é—®é¢˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> r1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="594-å‚æ‚¬å¼•ç”¨é—®é¢˜dangling-references">5.9.4. å‚æ‚¬å¼•ç”¨é—®é¢˜ï¼ˆDangling References)<a href="#594-å‚æ‚¬å¼•ç”¨é—®é¢˜dangling-references" class="hash-link" aria-label="5.9.4. å‚æ‚¬å¼•ç”¨é—®é¢˜ï¼ˆDangling References)çš„ç›´æ¥é“¾æ¥" title="5.9.4. å‚æ‚¬å¼•ç”¨é—®é¢˜ï¼ˆDangling References)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‚æ‚¬å¼•ç”¨ï¼ˆDangling Referencesï¼‰---- å¦‚ä½•è§£å†³ -&gt; ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‚æ‚¬å¼•ç”¨ï¼ˆDangling References): æ²¡æœ‰å®é™…æŒ‡å‘ä¸€ä¸ªçœŸæ­£èƒ½è®¿é—®çš„æ•°æ®çš„æŒ‡é’ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//åœ¨ Rust è¯­è¨€é‡Œä¸å…è®¸å‡ºç°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">dangle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‡½æ•°çš„ç»“æŸï¼Œå…¶å±€éƒ¨å˜é‡çš„å€¼æœ¬èº«æ²¡æœ‰è¢«å½“ä½œè¿”å›å€¼ï¼Œè¢«é‡Šæ”¾äº†ã€‚ä½†å®ƒçš„å¼•ç”¨å´è¢«è¿”å›</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å†æ¯”å¦‚:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        r </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//`x` does not live long enough,  r æ‰€å¼•ç”¨çš„å€¼å·²ç»åœ¨ä½¿ç”¨ä¹‹å‰è¢«é‡Šæ”¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;r = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å†æ¯”å¦‚:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">longer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// //ä¸Šä¸ªå‡½æ•°é”™è¯¯, æ— æ³•ç¼–è¯‘, åŸå› æ˜¯è¿”å›å€¼å¼•ç”¨å¯èƒ½ä¼šè¿”å›è¿‡æœŸçš„å¼•ç”¨, ä¾‹å¦‚è¿™æ ·ä½¿ç”¨:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rust&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ecmascript&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        r </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">longer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{} is longer&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// r è¢«ä½¿ç”¨çš„æ—¶å€™æºå€¼ s1 å’Œ s2 éƒ½å·²ç»å¤±æ•ˆäº†, éœ€è¦ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š, ä¸ºè¿”å›å€¼å£°æ˜ä¸€ä¸ªæ³¨é‡Š, è´´åˆ° å‚æ•°ä¸Š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="510-è£¸æŒ‡é’ˆ">5.10. è£¸æŒ‡é’ˆ<a href="#510-è£¸æŒ‡é’ˆ" class="hash-link" aria-label="5.10. è£¸æŒ‡é’ˆçš„ç›´æ¥é“¾æ¥" title="5.10. è£¸æŒ‡é’ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åŸç”Ÿ æŒ‡é’ˆæ˜¯æŒ‡å½¢å¦‚* const T å’Œ*mut T è¿™æ ·çš„ç±»å‹ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯ä»¥é€šè¿‡ asæ“ä½œç¬¦éšæ„è½¬æ¢ä¸ºåŸç”ŸæŒ‡é’ˆï¼Œä¾‹å¦‚ &amp;T as *constT å’Œ &amp;mut T as *mutTã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åœºæ™¯:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - åœ¨éœ€è¦çš„æ—¶å€™è·³è¿‡ Rust å®‰å…¨æ£€æŸ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - ä¸ C è¯­è¨€â€œæ‰“äº¤é“&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å†…ç½®å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ std::ptr::null å‡½æ•°å’Œ is_null æ–¹æ³• </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ offsetæ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ read/writeæ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ replace/swap æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è§£å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut s = &quot;hello&quot;.to_string();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è½¬æ¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let r1 = &amp;s as *const String;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let r2 = &amp;mut s as *mut String;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(r1, r2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let address = 0x7fff1d72307d;// éšä¾¿æŒ‡å®šçš„åœ°å€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let r3 = address as *const String;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;r1 is: {}&quot;, *r1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       println!(&quot;r2 is: {}&quot;, *r2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //    error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       // Segmentation fault  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!(*r1, *r3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åˆ›å»º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åˆ›å»ºç©ºæŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let p: *const u8 = std::ptr::null();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åˆ¤æ–­æ˜¯å¦ä¸ºç©ºæŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(p.is_null());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s: &amp;str = &quot;hello&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è·å¾—ä¸å¯å˜åŸç”ŸæŒ‡é’ˆ (æŒ‡å‘å…·ä½“æ•°æ®/æ•°æ®å†…éƒ¨çš„å…ƒç´ )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æŒ‡é’ˆ ptr çš„ç±»å‹ä¸º*const u8ï¼Œ è¿™ æ˜¯å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½å­˜å‚¨çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let ptr: *const u8 = s.as_ptr();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(!ptr.is_null());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //å¯¹æ¯” é€šè¿‡ as_ptr()è·å–æŒ‡é’ˆ:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // - é€šè¿‡ as_ptr å¾—åˆ°çš„æŒ‡é’ˆæ˜¯æŒ‡å‘å­˜æ”¾æ•°æ®å †/æ ˆ å†…å­˜çš„æŒ‡é’ˆï¼Œè€Œå¼•ç”¨åˆ™æ˜¯å¯¹å­—ç¬¦ä¸²æˆ–æ•°ç»„æœ¬èº«çš„å¼•ç”¨(æ¯”å‰è€…å•çº¯çš„æŒ‡é’ˆåŒ…å«æ›´å¤šæ•°æ®)ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut x = &quot;&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let y = &amp;mut x as *mut &amp;str;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!(y.read(), &quot;hello&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut s = [1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è·å¾—å¯å˜åŸç”ŸæŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let ptr: *mut u32 = s.as_mut_ptr();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(!ptr.is_null());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// offset() å¯ä»¥æŒ‡å®šç›¸å¯¹äºæŒ‡é’ˆåœ°å€çš„åç§»å­—èŠ‚æ•°ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s: &amp;str = &quot;Rust&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let ptr: *const u8 = s.as_ptr();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // offsetæ–¹æ³•ä¸èƒ½ä¿è¯ä¼ å…¥çš„åç§»é‡åˆæ³•ï¼Œæ•…ä¸ºunsafe</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;{:?}&quot;, *ptr.offset(1) as char); // u</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;{:?}&quot;, *ptr.offset(3) as char); // t</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;{:?}&quot;, *ptr.offset(255) as char); // Ã¿ æœ‰UBé£é™©</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// read/write  å¯ä»¥è¯»å–æˆ–å†™å…¥æŒ‡é’ˆç›¸åº” å†…å­˜ä¸­çš„ å†…å®¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let x = &quot;hello&quot;.to_string();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let y: *const u8 = x.as_ptr();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert_eq!(y.read() as char, &#x27;h&#x27;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let x = [0, 1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿™é‡Œçš„åŸç”ŸæŒ‡é’ˆç±» å‹æ˜¯å¸¦é•¿åº¦çš„ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¦‚æœå°†ç±»å‹æ”¹ä¸º* const [u32;3] ï¼Œåˆ™é€šè¿‡ read æ–¹æ³•åªèƒ½è¯»å–åˆ°å‰ä¸‰ä¸ªå…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let y = x[0..].as_ptr() as *const [u32; 4];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!(y.read(), [0,1,2,3]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let x = vec![0, 1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let y = &amp;x as *const Vec&lt;i32&gt;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert_eq!(y.read(), [0,1,2,3]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let mut x = &quot;&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let y = &amp;mut x as *mut &amp;str;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let z = &quot;hello&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       y.write(z);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!(y.read(), &quot;hello&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// replace/swap   æ›¿æ¢æŒ‡å®šä½ç½® çš„å†…å­˜ æ•°æ®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let mut v: Vec&lt;i32&gt; = vec![1, 2];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let v_ptr : *mut i32 = v.as_mut_ptr();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   unsafe{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       let old_v = v_ptr.replace(5);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!(1, old_v);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!([5, 2], &amp;v[..]);    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let mut v: Vec&lt;i32&gt; = vec![1, 2];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  let v_ptr  = &amp;mut v as *mut Vec&lt;i32&gt;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  unsafe{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      let old_v = v_ptr.replace(vec![3,4,5]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      assert_eq!([1, 2], &amp;old_v[..]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      assert_eq!([3, 4, 5], &amp;v[..]);   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  let mut array = [0, 1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  let x = array[0..].as_mut_ptr() as *mut [u32; 2];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  let y = array[1..].as_mut_ptr() as *mut [u32; 2];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      assert_eq!([0, 1], x.read());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      assert_eq!([1, 2], y.read());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      x.swap(y);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      assert_eq!([1, 0, 1, 3], array);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="511-æ™ºèƒ½æŒ‡é’ˆ">5.11. æ™ºèƒ½æŒ‡é’ˆ<a href="#511-æ™ºèƒ½æŒ‡é’ˆ" class="hash-link" aria-label="5.11. æ™ºèƒ½æŒ‡é’ˆçš„ç›´æ¥é“¾æ¥" title="5.11. æ™ºèƒ½æŒ‡é’ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5111-æ™ºèƒ½æŒ‡é’ˆä»‹ç»-å·¥ä½œæœºåˆ¶">5.11.1. æ™ºèƒ½æŒ‡é’ˆä»‹ç» å·¥ä½œæœºåˆ¶<a href="#5111-æ™ºèƒ½æŒ‡é’ˆä»‹ç»-å·¥ä½œæœºåˆ¶" class="hash-link" aria-label="5.11.1. æ™ºèƒ½æŒ‡é’ˆä»‹ç» å·¥ä½œæœºåˆ¶çš„ç›´æ¥é“¾æ¥" title="5.11.1. æ™ºèƒ½æŒ‡é’ˆä»‹ç» å·¥ä½œæœºåˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ™ºèƒ½æŒ‡é’ˆå°±æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå…¶è¡Œä¸ºç±»ä¼¼äºå¼•ç”¨, æŒ‡å‘ä¸€å—å†…å­˜çš„åœ°å€, æ­¤å¤–è¿˜æœ‰å­˜å‚¨çš„æœ‰é™„å¸¦çš„å…ƒæ•°æ®</p><p>æ™ºèƒ½æŒ‡é’ˆåŒºåˆ«äºå¸¸è§„ç»“æ„ä½“çš„ç‰¹æ€§åœ¨äºï¼Œå®ƒå®ç°äº† Deref (æ‰€ä»¥æœ‰äº†æŒ‡é’ˆè¯­ä¹‰, è€Œä¸”ä½¿ç”¨æ—¶, å¯ä»¥è‡ªåŠ¨è§£å¼•ç”¨) å’Œ Drop (æ‰€ä»¥èƒ½å¤Ÿè‡ªåŠ¨ç®¡ç†å†…å­˜é‡Šæ”¾) ; æ¯”å¦‚: String å’Œ Vec ç±»å‹ ä¹Ÿæ˜¯ä¸€ç§æ™ºèƒ½æŒ‡é’ˆ, å®ƒä»¬ä¹Ÿéƒ½å®ç°äº† Derefå’ŒDrop (è¿™å°±æ˜¯æ™ºèƒ½æŒ‡é’ˆæ™ºèƒ½çš„æ‰€åœ¨)</p><p>æ™ºèƒ½æŒ‡é’ˆæ‹¥æœ‰èµ„æºçš„æ‰€æœ‰æƒï¼Œè€Œæ™®é€šå¼•ç”¨ åª æ˜¯å¯¹æ‰€æœ‰æƒ çš„å€Ÿç”¨ ã€‚</p><ul><li>çº¿ç¨‹å®‰å…¨çš„: Arc, RwLock, Mutex</li><li>çº¿ç¨‹ä¸å®‰å…¨çš„: Box , Cell, RefCell, Rc</li></ul><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">let x =Box::new(â€helloâ€);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let y = x;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// error, å› ä¸ºæ™ºèƒ½æŒ‡é’ˆæ‹¥æœ‰åŸå§‹å€¼çš„æ‰€æœ‰æƒ, xå·²ç»è¢«è½¬ç§»äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹äºbox&lt;T&gt;, è‹¥åŒ…å«çš„ Tæ˜¯ç§»åŠ¨è¯­ä¹‰, åˆ™box ä¹Ÿæ˜¯, è‹¥Tæ˜¯å¤åˆ¶è¯­ä¹‰, åˆ™box ä¹Ÿæ˜¯å¤åˆ¶è¯­ä¹‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println1(â€(:?}â€, x);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5112-raiiæœºåˆ¶-å®ç°å†…å­˜å›æ”¶">5.11.2. RAIIæœºåˆ¶ å®ç°å†…å­˜å›æ”¶<a href="#5112-raiiæœºåˆ¶-å®ç°å†…å­˜å›æ”¶" class="hash-link" aria-label="5.11.2. RAIIæœºåˆ¶ å®ç°å†…å­˜å›æ”¶çš„ç›´æ¥é“¾æ¥" title="5.11.2. RAIIæœºåˆ¶ å®ç°å†…å­˜å›æ”¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>RAII: æ™ºèƒ½æŒ‡é’ˆåœ¨å †å†…å­˜ä¸Šå¼€è¾Ÿç©ºé—´å­˜å‚¨æ•°æ®, è‡ªèº«å­˜å‚¨åœ¨æ ˆä¸Š, åœ¨å‡½æ•°è°ƒç”¨ç»“æŸæ—¶, æŒ‡é’ˆå˜é‡è¢«æ¸…ç†, æŒ‡é’ˆæ‰§è¡Œè‡ªèº«çš„dropæ–¹æ³•, æ¥é‡Šæ”¾æ™º èƒ½æŒ‡é’ˆæ‰€ç®¡ç†çš„å †å†…å­˜ ç©ºé—´</p><p>RAII , æ™ºèƒ½æŒ‡é’ˆ, å‡èµ·æºäºç°ä»£ C++</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5113-è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ-è‡ªåŠ¨è§£å¼•ç”¨-deref-å’Œ-drop">5.11.3. è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ è‡ªåŠ¨è§£å¼•ç”¨ Deref å’Œ Drop<a href="#5113-è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ-è‡ªåŠ¨è§£å¼•ç”¨-deref-å’Œ-drop" class="hash-link" aria-label="5.11.3. è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ è‡ªåŠ¨è§£å¼•ç”¨ Deref å’Œ Dropçš„ç›´æ¥é“¾æ¥" title="5.11.3. è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ è‡ªåŠ¨è§£å¼•ç”¨ Deref å’Œ Dropçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æ‰‹åŠ¨æ˜¾å¼è§£å¼•ç”¨: *x  &lt;=&gt;   *(x.deref()), deref() æ˜¯ç¼–è¯‘å™¨å¸®å¿™åŠ çš„ (deref() è¿”å›å†…éƒ¨æ•°æ®çš„å¼•ç”¨)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;.&quot;è°ƒç”¨ or åœ¨å‡½æ•°å‚æ•°ä½ç½®ä¸Š, ä¼šå¯¹x è‡ªåŠ¨è§£å¼•ç”¨, ç­‰ä»·äº x.deref()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct MyBox&lt;T&gt;(T);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl&lt;T&gt; MyBox&lt;T&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn new(x: T) -&gt; MyBox&lt;T&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            MyBox(x)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //å®ç° Deref trait å…è®¸æˆ‘ä»¬é‡è½½ è§£å¼•ç”¨è¿ç®—ç¬¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    use std::ops::Deref;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl&lt;T&gt; Deref for MyBox&lt;T&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        type Target = T;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn deref(&amp;self) -&gt; &amp;T {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &amp;self.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let x = 5;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let y = MyBox::new(x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;y = {}&quot;, *y);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // éšå¼è§£å¼•ç”¨ (è§£å¼•ç”¨å¤šæ€)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn hello(name: &amp;str) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;Hello, {}!&quot;, name);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let m = MyBox::new(String::from(&quot;Rust&quot;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hello(&amp;m);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //åœ¨ MyBox&lt;T&gt; ä¸Šå®ç°äº† Deref traitï¼ŒRust å¯ä»¥é€šè¿‡ deref è°ƒç”¨å°† &amp;MyBox&lt;String&gt; å˜ä¸º &amp;Stringã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //æ ‡å‡†åº“ä¸­æä¾›äº† String ä¸Šçš„ Deref å®ç°ï¼Œå…¶ä¼šè¿”å›å­—ç¬¦ä¸² sliceï¼Œè¿™å¯ä»¥åœ¨ Deref çš„ API æ–‡æ¡£ä¸­çœ‹åˆ°ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //Rust å†æ¬¡è°ƒç”¨ deref å°† &amp;String å˜ä¸º &amp;strï¼Œè¿™å°±ç¬¦åˆ hello å‡½æ•°çš„å®šä¹‰äº†ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5114-box-æ— ç—›ä½¿ç”¨å †å†…å­˜">5.11.4. Box æ— ç—›ä½¿ç”¨å †å†…å­˜<a href="#5114-box-æ— ç—›ä½¿ç”¨å †å†…å­˜" class="hash-link" aria-label="5.11.4. Box æ— ç—›ä½¿ç”¨å †å†…å­˜çš„ç›´æ¥é“¾æ¥" title="5.11.4. Box æ— ç—›ä½¿ç”¨å †å†…å­˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51141-boxåŸºæœ¬ä½¿ç”¨">5.11.4.1. BoxåŸºæœ¬ä½¿ç”¨<a href="#51141-boxåŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="5.11.4.1. BoxåŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.11.4.1. BoxåŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>ç±»ä¼¼ cpp çš„ unique_ptr;</p><p>é€šè¿‡ Boxï¼Œç”¨äºåœ¨å †ä¸Šåˆ†é…å€¼</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸ºä»€ä¹ˆä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Rust ä¸­çš„å€¼é»˜è®¤è¢«åˆ†é…åˆ°stackå†…å­˜, stack å†…å­˜éœ€è¦çŸ¥é“å€¼çš„å…·ä½“å¤§å°, å¯¹äº é€’å½’ç±»å‹ å’Œ trait object, ç¼–è¯‘æ—¶å¹¶ä¸çŸ¥é“å¤§å°, è€Œ Box&lt;T&gt; çš„å¤§å°æ˜¯å·²çŸ¥çš„ã€‚ å¯ä»¥é€šè¿‡ Box &lt;T&gt;å°†å€¼è£…ç®±, åœ¨å †å†…å­˜ä¸­åˆ†é…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///æ ¸å¿ƒä½œç”¨å°±æ˜¯å¯ä»¥å®šä¹‰åŠ¨æ€å¤§å°çš„ç±»å‹, å®é™…å¤§å°è¦åˆ°è¿è¡ŒæœŸæ‰èƒ½ç¡®å®š, å¦‚ ç”¨åœ¨ é€’å½’ä¸­ and ç”¨åœ¨åŒ…è£… trait ä¸­ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å½“ç®±å­å®ä¾‹ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå®ƒçš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå†…éƒ¨çš„å¯¹è±¡ä¼šè¢« é”€æ¯ï¼Œå †ä¸Šåˆ†é…çš„å†…å­˜ä¹Ÿä¼šè¢«é‡Šæ”¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//  Box&lt;T&gt;æŒ‡é’ˆå¯¹æ‰€ç®¡ç†çš„å †å†…å­˜æœ‰å”¯ä¸€æ‹¥æœ‰æƒï¼Œ æ‰€ä»¥å¹¶ä¸å…±äº«</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ä½¿ç”¨ * è¿ç®—ç¬¦è¿›è¡Œè§£å¼•ç”¨ï¼›è¿™ä¼šç§»é™¤æ‰ä¸€å±‚è£…ç®±</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">box_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-------------box_demo--------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//ä½¿ç”¨ box åœ¨å †ä¸Šå‚¨å­˜ä¸€ä¸ª i32 å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;*b = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å°è¯•æ„é€ é“¾è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token comment" style="color:rgb(0, 128, 0)">// error, æ— é™é€’å½’, ç¼–è¯‘å™¨æ£€æµ‹å‡ºäº†æ— é™å¤§å°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­£ç¡®: (è¿™ç§æ–¹æ³•å­˜åœ¨é™åˆ¶, æ„é€ å‡ºçš„ é“¾è¡¨æ— æ³•å­˜åœ¨å¤šä¸ªå¼•ç”¨, ä½¿ç”¨ä¸€æ¬¡å°±å¤±æ•ˆäº†, æ²¡æ³•ç»™ç¬¬äºŒä¸ªä½¿ç”¨è€…ä½¿ç”¨äº†, è§£å†³: Rc)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> l </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> l</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//Cons(1, Cons(2, Cons(3, Nil)))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51142-åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹-dst">5.11.4.2. åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹ DST<a href="#51142-åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹-dst" class="hash-link" aria-label="5.11.4.2. åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹ DSTçš„ç›´æ¥é“¾æ¥" title="5.11.4.2. åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹ DSTçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    // åŠ¨æ€å¤§å°ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç¼–è¯‘æœŸé—´æ— æ³•çŸ¥é“å¤§å°, åªæœ‰åˆ°è¿è¡Œæ—¶æ‰çŸ¥é“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åŠ¨æ€å¤§å°ç±»å‹çš„å€¼å¿…é¡»é€šè¿‡æŒ‡é’ˆè®¿é—® , å¦‚ Box&lt;str&gt;, Rc&lt;str&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¦‚:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // - str åœ¨ç¼–è¯‘æœŸæ— æ³•çŸ¥é“å¤§å°, &amp;str çš„å¤§å°å¯ä»¥åœ¨ç¼–è¯‘æœŸçŸ¥é“ (&amp;str å­˜å‚¨äº† str çš„åœ°å€ å’Œé•¿åº¦)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // - trait , ä»»ä½• trait éƒ½æ˜¯åŠ¨æ€å¤§å°ç±»å‹, åº”è¯¥è¿™ä¹ˆä½¿ç”¨: Box&lt;XXXTrait&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // Sized trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å®ç°äº†è¿™ä¸ª trait çš„ç±»å‹, åœ¨ç¼–è¯‘æœŸå³å¯ç¡®å®šå¤§å°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn xxx_fn&lt;T&gt;(t: T) {} // T ä¸ºç¼–è¯‘æœŸçŸ¥é“å¤§å°çš„ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç­‰ä»·:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn xxx_fn&lt;T: Sized&gt;(t: T) {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ”¾å®½é™åˆ¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn xxx_fn&lt;T: ?Sized&gt;(t:T) {}// T å¯èƒ½æ˜¯ sized çš„, ä¹Ÿå¯èƒ½ä¸æ˜¯ sized çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5115-rc-å’Œ-weak-å…±äº«å †å†…å­˜">5.11.5. Rc å’Œ Weak å…±äº«å †å†…å­˜<a href="#5115-rc-å’Œ-weak-å…±äº«å †å†…å­˜" class="hash-link" aria-label="5.11.5. Rc å’Œ Weak å…±äº«å †å†…å­˜çš„ç›´æ¥é“¾æ¥" title="5.11.5. Rc å’Œ Weak å…±äº«å †å†…å­˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51151-rc-å¼ºå¼•ç”¨">5.11.5.1. Rc å¼ºå¼•ç”¨<a href="#51151-rc-å¼ºå¼•ç”¨" class="hash-link" aria-label="5.11.5.1. Rc å¼ºå¼•ç”¨çš„ç›´æ¥é“¾æ¥" title="5.11.5.1. Rc å¼ºå¼•ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>ç±»ä¼¼ cpp çš„ shared_ptr</p><p>å¼•ç”¨è®¡æ•°æŒ‡é’ˆ, å…¶æ•°æ®å¯ä»¥æœ‰å¤šä¸ªæ‰€æœ‰è€…, å†…éƒ¨åŒ…å«çš„æ•°æ®æ˜¯ä¸å¯å˜çš„,</p><p>åªèƒ½ç”¨äºå•çº¿ç¨‹ä¸­, å› ä¸ºå†…éƒ¨æ“ä½œä¸æ˜¯åŸå­æ€§çš„, rust ä¹Ÿä¸º å…¶å®ç°äº† !send trait , è¡¨ç¤ºæ— æ³•åœ¨çº¿ç¨‹é—´ç§»åŠ¨; å¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹ç‰ˆæœ¬: Arc</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// Rc&lt;T&gt; çš„ç±»å‹ã€‚å…¶åç§°ä¸º å¼•ç”¨è®¡æ•°ï¼ˆreference countingï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Rc&lt;T&gt; ä¸»è¦ç”¨äºåŒä¸€å †ä¸Šæ‰€åˆ†é…çš„æ•°æ®åŒºåŸŸéœ€è¦æœ‰å¤šä¸ªåªè¯»è®¿é—®çš„æƒ…å†µ, æ¯”èµ·ä½¿ç”¨ Box&lt;T&gt; ç„¶ååˆ›å»ºå¤šä¸ªä¸å¯å˜å¼•ç”¨çš„æ–¹æ³•æ›´ä¼˜é›…ä¹Ÿæ›´ç›´è§‚ä¸€äº›</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å…è®¸ &quot;ä¸å¯å˜æ•°æ®&quot; æœ‰å¤šä¸ªæ‰€æœ‰è€…, æ•°æ®æœ¬èº«æ— æ³•ä¿®æ”¹ (å°†å¤šä¸ªæ‰€æœ‰æƒå…±äº«ç»™å¤šä¸ªå˜é‡)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å†…éƒ¨ç»´æŠ¤ç€ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯cloneä¸€æ¬¡(å…±äº«ä¸€æ¬¡)ï¼Œ è®¡æ•°å™¨åŠ 1, è¿”å›ä¸å¯å˜å¼•ç”¨ï¼Œ å½“å®ƒä»¬éƒ½ç¦»å¼€ä½œç”¨åŸŸè‚˜ï¼Œ è®¡ æ•°å™¨ä¼šè¢«æ¸…é›¶ï¼Œå¯¹åº”çš„å †å†…å­˜ä¹Ÿä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¸ç”¨æ–¹æ³•:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">45</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> yl </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> x </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¢åŠ å¼ºå¼•ç”¨è®¡æ•°, å¹¶é å…‹éš†, åªæ˜¯å¢åŠ è®¡æ•°, ç„¶åè¿”å›ä¸€ä¸ªå¼•ç”¨ (å³å…±äº«æ‰€æœ‰æƒ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¢åŠ å¼ºå¼•ç”¨è®¡æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">priÎ·</span><span class="token macro property">tln!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">â€</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">â€</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">strong_count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">letw</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">downgrade</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¢åŠ å¼±å¼•ç”¨è®¡æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">â€ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> â€</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token function" style="color:rgb(0, 0, 255)">weak_count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y3 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸å¢åŠ è®¡æ•°</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51152-æ„é€ é“¾è¡¨">5.11.5.2. æ„é€ é“¾è¡¨<a href="#51152-æ„é€ é“¾è¡¨" class="hash-link" aria-label="5.11.5.2. æ„é€ é“¾è¡¨çš„ç›´æ¥é“¾æ¥" title="5.11.5.2. æ„é€ é“¾è¡¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡ box æ„é€ é“¾è¡¨å­˜åœ¨é—®é¢˜: é“¾è¡¨åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡, æ¼”ç¤º:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//a è¢«ç§»åŠ¨åˆ°äº† b å†…éƒ¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> c </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//  error é”™è¯¯, value used here after move</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨ Rc è§£å†³</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">rc</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//æ¯æ¬¡è°ƒç”¨ Rc::cloneï¼ŒRc&lt;List&gt; ä¸­æ•°æ®çš„å¼•ç”¨è®¡æ•°éƒ½ä¼šå¢åŠ ï¼ŒRc::strong_count(&amp;a) è·å– a çš„è¢«å¼•ç”¨ä¸ªæ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›´åˆ°æœ‰é›¶ä¸ªå¼•ç”¨ä¹‹å‰å…¶æ•°æ®éƒ½ä¸ä¼šè¢«æ¸…ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¹Ÿå¯ä»¥è°ƒç”¨ a.clone() è€Œä¸æ˜¯ Rc::clone(&amp;a), ä¸¤è€…æ„æ€æ˜¯ä¸€æ ·çš„, åªä¼šå¢åŠ å¼•ç”¨è®¡æ•°ï¼Œä¸ä¼šä½œæ·±åº¦å¤åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œ, b, c å…±äº« a çš„æ‰€æœ‰æƒ, a ä¸­çš„æ•°æ®ä¸å¯ä¿®æ”¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> c </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// #### å¯¹å†…éƒ¨å€¼è¿›è¡Œä¿®æ”¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///å¦‚æœä½ è¦ä¿®æ”¹ Rc é‡Œçš„å€¼ï¼ŒRust ä¼šç»™ä½ ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ get_mut()ï¼Œä¸€ä¸ªæ˜¯ make_mut() ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æœ‰å‰¯ä½œç”¨æˆ–æ˜¯é™åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// - get_mut() éœ€è¦åšä¸€ä¸ªâ€œå”¯ä¸€å¼•ç”¨â€çš„æ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä»»ä½•çš„å…±äº«æ‰èƒ½ä¿®æ”¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///- make_mut() åˆ™æ˜¯ä¼šæŠŠå½“å‰çš„å¼•ç”¨ç»™cloneå‡ºæ¥ï¼Œå†ä¹Ÿä¸å…±äº«äº†ï¼Œ æ˜¯ä¸€ä»½å…¨æ–°çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ›´å¥½çš„ä¿®æ”¹æ–¹æ³•:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// RefCell&lt;T&gt; èƒ½å¤Ÿåœ¨å¯¹è±¡è¢«è®¤ä¸ºæ˜¯ä¸å¯å˜çš„æƒ…å†µä¸‹ä¿®æ”¹å†…éƒ¨å­—æ®µ; (å¹¶éç¼–è¯‘å™¨æ£€æŸ¥, äºŒæ˜¯è¿è¡ŒæœŸè¿›è¡Œæ£€æŸ¥, ä¸æ˜¯å¾ˆå¥½)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// Cell&lt;T&gt;ï¼Œå®ƒç±»ä¼¼ RefCell&lt;T&gt; ä½†æœ‰ä¸€ç‚¹é™¤å¤–ï¼šå®ƒå¹¶éæä¾›å†…éƒ¨å€¼çš„å¼•ç”¨ï¼Œè€Œæ˜¯æŠŠå€¼æ‹·è´è¿›å’Œæ‹·è´å‡º Cell&lt;T&gt;ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¿®æ”¹å¼•ç”¨çš„å˜é‡ - get_mut ä¼šè¿”å›ä¸€ä¸ªOptionå¯¹è±¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œä»…å½“ï¼ˆåªæœ‰ä¸€ä¸ªå¼ºå¼•ç”¨ &amp;&amp; æ²¡æœ‰å¼±å¼•ç”¨ï¼‰ä¸ºçœŸæ‰èƒ½ä¿®æ”¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">get_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> strong</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">val </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">555</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€…:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//æ­¤å¤„å¯ä»¥ä¿®æ”¹ï¼Œä½†æ˜¯æ˜¯ä»¥ clone çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è®©strongè¿™ä¸ªæŒ‡é’ˆç‹¬ç«‹å‡ºæ¥äº†ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token class-name" style="color:rgb(38, 127, 153)">Rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">make_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> strong</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">555</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51153-weak-å¼±å¼•ç”¨">5.11.5.3. Weak å¼±å¼•ç”¨<a href="#51153-weak-å¼±å¼•ç”¨" class="hash-link" aria-label="5.11.5.3. Weak å¼±å¼•ç”¨çš„ç›´æ¥é“¾æ¥" title="5.11.5.3. Weak å¼±å¼•ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>ç±»ä¼¼ cpp çš„ weak_ptr</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¼±å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// å¼±å¼•ç”¨: Weak&lt;T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Weak å…±äº«çš„æŒ‡é’ˆæ²¡æœ‰æ‰€æœ‰æƒ, ç§°ä¸ºå¼±å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - é€šè¿‡ Rc::downgrade ä¼ é€’ Rc å®ä¾‹çš„ reference, å¾—åˆ° Weak ç±»å‹çš„æŒ‡é’ˆ, åŒæ—¶å°† weak_count +1, ä¸æ˜¯ strong_count +1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - å³ä½¿ weak_count ä¸ä¸ºé›¶, ä¹Ÿå¯èƒ½ä½¿å¾— Rc å®ä¾‹è¢«æ¸…ç†, åªè¦ strong_count == 0 å°±è¡Œäº† (è§£å†³å¾ªç¯é“¾è¡¨é€ æˆçš„å†…å­˜æ³„æ¼)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - å¯ä»¥é€šè¿‡ Rc::upgrade è¿”å› Option&lt;Rc&lt;T&gt;&gt; å‡çº§æˆå¼ºå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// è¿™ä¹ˆéº»çƒ¦ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦ Weak ? è¿™æ˜¯å› ä¸ºå¼ºå¼•ç”¨çš„ Rc ä¼šæœ‰å¾ªç¯å¼•ç”¨çš„é—®é¢˜â€¦â€¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åŸºæœ¬ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::rc::Rc;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::rc::Weak;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let weak: Weak&lt;i32&gt;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let strong: Rc&lt;i32&gt;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let five = Rc::new(5); //å±€éƒ¨å˜é‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    strong = five.clone(); //è¿›è¡Œå¼ºå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    weak = Rc::downgrade(&amp;five); //å¯¹å±€éƒ¨å˜é‡è¿›è¡Œå¼±å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//æ­¤æ—¶ï¼Œfiveå·²ææ„ï¼Œæ‰€ä»¥ Rc::strong_count(&amp;strong)=1ï¼Œ Rc::weak_count(&amp;strong)=1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//å¦‚æœè°ƒç”¨ drop(strong)ï¼Œé‚£ä¸ªæ•´ä¸ªå†…å­˜å°±é‡Šæ”¾äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//drop(strong);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//å¦‚æœè¦è®¿é—®å¼±å¼•ç”¨çš„å€¼ï¼Œéœ€è¦æŠŠå¼±å¼•ç”¨ upgrade æˆå¼ºå¼•ç”¨ï¼Œæ‰èƒ½å®‰å…¨çš„ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//è¿™ä¸ªå‡çº§å¯èƒ½ä¼šä¸æˆåŠŸï¼Œå› ä¸ºå†…å­˜å¯èƒ½å·²ç»è¢«åˆ«äººæ¸…ç©ºäº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">match  weak_five.upgrade() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Some(r) =&gt; println!(&quot;{}&quot;, r),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    None =&gt; println!(&quot;None&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è§£å†³å¾ªç¯å¼•ç”¨çš„å†…å­˜æ³„æ¼é—®é¢˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    cell::RefCell,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    rc::{Rc, Weak},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct Node {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        head: Option&lt;Weak&lt;RefCell&lt;Node&gt;&gt;&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        next: Option&lt;Rc&lt;RefCell&lt;Node&gt;&gt;&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl Drop for Node {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn drop(&amp;mut self) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;dropping&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let one = Rc::new(RefCell::new(Node {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        head: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        next: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let two = Rc::new(RefCell::new(Node {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        head: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        next: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let three = Rc::new(RefCell::new(Node {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        head: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        next: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    one.borrow_mut().next = Some(two.clone());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    two.borrow_mut().next = Some(three.clone());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    three.borrow_mut().head = Some(Rc::downgrade(&amp;one));// å¼±å¼•ç”¨, å³ä½¿è®¡æ•°æ²¡æœ‰å½’é›¶, ä»ç„¶å¯å›æ”¶å†…å­˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5116-refcell-å’Œ-cell-æä¾›å†…éƒ¨å¯å˜æ€§">5.11.6. RefCell å’Œ Cell æä¾›å†…éƒ¨å¯å˜æ€§<a href="#5116-refcell-å’Œ-cell-æä¾›å†…éƒ¨å¯å˜æ€§" class="hash-link" aria-label="5.11.6. RefCell å’Œ Cell æä¾›å†…éƒ¨å¯å˜æ€§çš„ç›´æ¥é“¾æ¥" title="5.11.6. RefCell å’Œ Cell æä¾›å†…éƒ¨å¯å˜æ€§çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å†…éƒ¨å¯å˜æ€§: å°†å¯å˜çš„æ•°æ®åŒ…è£…åœ¨ä¸å¯å˜çš„ç»“æ„ä¸­, è€Œæ— éœ€æ˜¾å¼å£°æ˜ mut</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ Cell å’Œ RefCell ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚åœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œéœ€è¦ä½¿ç”¨Mutexè¿›è¡Œäº’æ–¥ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51161-cell">5.11.6.1. Cell<a href="#51161-cell" class="hash-link" aria-label="5.11.6.1. Cellçš„ç›´æ¥é“¾æ¥" title="5.11.6.1. Cellçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// Cell&lt;T&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è§„é¿ borrow check: Cell&lt;T&gt; å…¶å®å’Œ Box&lt;T&gt; å¾ˆåƒï¼Œä½†åè€…åŒæ—¶ä¸å…è®¸å­˜åœ¨å¤šä¸ªå¯¹å…¶çš„å¯å˜å¼•ç”¨ï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„å¾ˆæƒ³åšè¿™æ ·çš„æ“ä½œï¼Œåœ¨éœ€è¦çš„æ—¶å€™éšæ—¶æ”¹å˜å…¶å†…éƒ¨çš„æ•°æ®ï¼Œè€Œä¸å»è€ƒè™‘ Rust ä¸­çš„ä¸å¯å˜å¼•ç”¨çº¦æŸï¼Œå°±å¯ä»¥ä½¿ç”¨ Cell&lt;T&gt;ã€‚Cell&lt;T&gt; å…è®¸å¤šä¸ªå…±äº«å¼•ç”¨å¯¹å…¶å†…éƒ¨å€¼è¿›è¡Œæ›´æ”¹ï¼Œå®ç°äº†ã€Œå†…éƒ¨å¯å˜æ€§ã€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æä¾›äº†ä¸€ç§å†…éƒ¨å¯å˜æ€§, å¦‚, æŸä¸ª struct æ˜¯ä¸å¯å˜çš„, ä½†æ˜¯ å†…éƒ¨æŸä¸ªå­—æ®µéœ€è¦å¯å˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">P</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cell</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œå®šä¹‰çš„æ˜¯ Cellçš„ä¸å¯å˜ç±»å‹, ä½†æ˜¯ å†…éƒ¨çš„æ•°ç¡®å®å¯ä»¥ä¿®æ”¹çš„, åˆæ³•çš„é¿å¼€çš„å€Ÿç”¨æ£€æŸ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">P</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cell</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// set() å¯¹å†…éƒ¨æ•°æ®çš„ç±»å‹æ²¡æœ‰è¦æ±‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// å†…éƒ¨çš„æ•°æ®å¿…é¡»æ˜¯ copy trait æ‰èƒ½ä½¿ç”¨ get(), è¿™é‡Œå®é™…æ˜¯è·å–æ‹·è´, </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)">//  è‹¥æ˜¯é copyç±»å‹, æä¾› get_mut() è·å–å†…éƒ¨æ•°æ®çš„å¯å˜å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51162-refcell">5.11.6.2. RefCell<a href="#51162-refcell" class="hash-link" aria-label="5.11.6.2. RefCellçš„ç›´æ¥é“¾æ¥" title="5.11.6.2. RefCellçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// RefCell&lt;T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// å®ƒç±»ä¼¼ Cell&lt;T&gt;,  ä½†æœ‰ä¸€ç‚¹é™¤å¤–ï¼šæä¾›å†…éƒ¨å€¼çš„å¼•ç”¨, è€Œä¸æ˜¯æ‹·è´äº†, å› æ­¤å¯¹äºå†…éƒ¨æ•°æ®çš„ç±»å‹æ²¡æœ‰ copy trait è¦æ±‚ (Cell çš„å†…éƒ¨æ•°æ®æœ‰ copy trait è¦æ±‚)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ—¢ç„¶ä¸èƒ½åœ¨è¯»å†™æ•°æ®æ—¶ç®€å•çš„ Copy å‡ºæ¥è¿›å»äº†ï¼Œè¯¥å’‹ä¿è¯å†…å­˜å®‰å…¨å‘¢?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      borrow chec æ”¾åˆ°äº†è¿è¡Œæ—¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      è™½ç„¶æ²¡æœ‰åˆ†é…ç©ºé—´ï¼Œ ä½†å®ƒæ˜¯æœ‰è¿è¡Œæ—¶å¼€é”€çš„ï¼Œå› ä¸ºå®ƒè‡ªå·±ç»´æŠ¤ç€ä¸€ä¸ªè¿è¡Œæ—¶å€Ÿç”¨æ£€æŸ¥å™¨, æ¯”å¦‚è·å–å¤šä¸ªå¯å˜å¼•ç”¨, ä¼šPanic</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¸»è¦ä¸¤ä¸ªæ–¹æ³•:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// borrow_mut() è·å–å¯å˜å¼•ç”¨ (RefMut&lt;T&gt;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// borrow(), è·å–ä¸å¯å˜å¼•ç”¨ (Mut&lt;T&gt;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// refcell æ›´å¸¸ç”¨, çœå†…å­˜, cell çš„ get() æ˜¯è·å–æ‹·è´, æµªè´¹å†…å­˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v = RefCell::new(vec![1]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, v.borrow());//1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.borrow_mut().push(1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, v.borrow());//1, 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let x = RefCell::new(vec![1, 2, 3, 4]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, *x.borrow()); //[1, 2, 3, 4]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut my_ref = x.borrow_mut();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        my_ref.push(1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è‹¥ä¸Šé¢çš„å¯å˜å€Ÿç”¨ä¸å¦å¼€ä¸€ä¸ª ä½œç”¨åŸŸ, è¿™é‡ŒæŠ¥é”™: å¯å˜å€Ÿç”¨å, ä¸å…è®¸å†æ¬¡ä¸å¯å˜å€Ÿç”¨äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¦å¼€ä¸€ä¸ªä½œç”¨åŸŸçš„æ•ˆæœ: my_ref è¿™ä¸ªå¯å˜å€Ÿç”¨åˆ°è¿™é‡Œçš„æ—¶å€™å·²ç»è¢«é‡Šæ”¾äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, *x.borrow()); //[1, 2, 3, 4, 1]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // RefCell&lt;T&gt; çš„ä¸€ä¸ªå¸¸è§ç”¨æ³•æ˜¯ä¸ Rc&lt;T&gt; ç»“åˆæ„é€ é“¾è¡¨, rc å…è®¸å¤šé‡å¼•ç”¨, æŠ±åœ¨å¤–å±‚, refcel è·å–å¯å˜å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //ä»–ä»¬æä¾›äº† set()/get() ä»¥åŠ borrow()/borrow_mut() çš„æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[derive(Debug)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    enum List1 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Cons(Rc&lt;RefCell&lt;i32&gt;&gt;, Rc&lt;List1&gt;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Nil,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    use List1::{Cons, Nil};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let value = Rc::new(RefCell::new(5));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let a = Rc::new(Cons(Rc::clone(&amp;value), Rc::new(Nil)));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let b = Cons(Rc::new(RefCell::new(6)), Rc::clone(&amp;a));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let c = Cons(Rc::new(RefCell::new(10)), Rc::clone(&amp;a));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    *value.borrow_mut() += 10;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;a after = {:?}&quot;, a);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;b after = {:?}&quot;, b);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;c after = {:?}&quot;, c);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ä¾‹:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®šä¹‰ä¸€ä¸ª trait, å®šä¹‰å‘é€æ–¹æ³• send, è¿™é‡Œ self æ˜¯ä¸å¯å˜çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åç»­ä¼šé€šè¿‡ è¿™ä¸ªä¸å¯å˜ self å¾—åˆ°å¯å˜çš„æˆå‘˜å˜é‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    trait MsgSender {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn send(&amp;self, msg: &amp;str); // è¿™ä¸ª trait å·²ç»å›ºå®š, &amp;self ä¸å…è®¸æ”¹æˆ &amp;mut self</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç›‘æ§å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct LimitTracker&lt;&#x27;a, S: MsgSender&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        sender: &amp;&#x27;a S,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        max: usize, // æœ€å¤§é™é‡é˜ˆå€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        value: usize, // å·²ç»ä½¿ç”¨äº†å¤šå°‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl&lt;&#x27;a, T&gt; LimitTracker&lt;&#x27;a, T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    where</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        T: MsgSender,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn new(sender: &amp;&#x27;a T, max: usize) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            LimitTracker {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                sender,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                max,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                value: 0,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn set_value(&amp;mut self, value: usize) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            self.value = value;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let percent = self.value as f64 / self.max as f64;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if percent &gt;= 1.0 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                self.sender.send(&quot;&gt;= 1.0&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            } else if percent &gt;= 0.8 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                self.sender.send(&quot;&gt;= 0.8&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    use std::cell::RefCell;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //æ¶ˆæ¯å‘é€æ¨¡æ‹Ÿå™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct MsgSenderMock {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä¸ºä»€ä¹ˆè¦åŒ…è£…?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //åé¢éœ€è¦é€šè¿‡ ä¸å¯å˜çš„ &amp;self æ‹¿åˆ°å¯å˜çš„ msg_send (ä¸å¯å˜ &amp;self æ˜¯åœ¨ trait ä¸­å®šä¹‰çš„, sendæ–¹æ³•è·å–çš„æ˜¯ selfä¸å¯å˜å¼•ç”¨)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //å¦‚æœä¸åŒ…è£…ä¸€ä¸‹, åˆ™è¿™é‡Œæ— æ³•ä¿®æ”¹ msg_send æ¥è®°å½•å‘é€çš„æ¶ˆæ¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        msg_send: RefCell&lt;Vec&lt;String&gt;&gt;,// è®°å½•å‘é€çš„ä¿¡æ¯, å‘é€çš„æ¶ˆæ¯ä¼šå­˜å‚¨åˆ°è¿™é‡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl MsgSenderMock {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn new() -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            MsgSenderMock {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                msg_send: RefCell::new(vec![]),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl MsgSender for MsgSenderMock {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn send(&amp;self, msg: &amp;str) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // æ”¹ä¸º refcellå, é€šè¿‡ borrow_mut å¾—åˆ°å¯å˜å¼•ç”¨, ç±»å‹ Ref, ç±»ä¼¼æ™®é€šå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            self.msg_send.borrow_mut().push(msg.to_string());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æµ‹è¯•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mock_sender = MsgSenderMock::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut tracker = LimitTracker::new(&amp;mock_sender, 10);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    tracker.set_value(8);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, mock_sender.msg_send.borrow()[0]); // è·å–ä¸å¯å˜å¼•ç”¨</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5117-rc-box-refcell-cell-å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯”-ç»„åˆä½¿ç”¨">5.11.7. Rc Box RefCell Cell å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯” ç»„åˆä½¿ç”¨<a href="#5117-rc-box-refcell-cell-å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯”-ç»„åˆä½¿ç”¨" class="hash-link" aria-label="5.11.7. Rc Box RefCell Cell å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯” ç»„åˆä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.11.7. Rc Box RefCell Cell å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯” ç»„åˆä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// åŒºåˆ«:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - owner ä¸ªæ•°: Rc&lt;T&gt; å…è®¸æ•°æ®æœ‰å¤šä¸ªæ‰€æœ‰è€…ï¼›Box&lt;T&gt; å’Œ RefCell&lt;T&gt; åªèƒ½å…è®¸æœ‰å•ä¸€æ‰€æœ‰è€…ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - borrow checker æ—¶æœŸ: Box&lt;T&gt; åœ¨ç¼–è¯‘æ—¶æ‰§è¡Œå€Ÿç”¨æ£€æŸ¥ï¼›Rc&lt;T&gt;ä¹Ÿåœ¨ç¼–è¯‘æ—¶æ‰§è¡Œå€Ÿç”¨æ£€æŸ¥ï¼›RefCell&lt;T&gt; å…è®¸åœ¨è¿è¡Œæ—¶æ‰§è¡Œå€Ÿç”¨æ£€æŸ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - è¿è¡Œæ—¶å¼€é”€: Cell&lt;T&gt;æ— è¿è¡Œ æ—¶å¼€é”€ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šåœ¨è¿è¡Œ æ—¶å¼•å‘ panic é”™è¯¯ã€‚ refcell è¦åœ¨è¿è¡Œæ—¶æ‰§è¡Œå€Ÿç”¨æ£€æŸ¥ï¼Œæ‰€ä»¥æœ‰è¿è¡Œæ—¶å¼€é”€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - æä¾›å†…éƒ¨å¯å˜æ€§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  - Cell&lt;T&gt;ä½¿ç”¨ set/get æ–¹æ³•ç›´æ¥æ“ä½œåŒ…è£¹çš„å€¼ (åº•å±‚æ˜¯å°†å†…éƒ¨å€¼æ‹·è´å‡º, ä¿®æ”¹ååœ¨æ‹·è´è¿›å», é€‚åˆäºå®ç°Copyçš„ç±»å‹å³å¤åˆ¶è¯­ä¹‰ç±»å‹)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  - RefCell&lt;T&gt;é€šè¿‡ borrow/borrow_mut è¿”å› åŒ…è£…è¿‡çš„å¼•ç”¨ Ref&lt;T&gt;å’Œ RefMut&lt;T&gt;æ¥æ“ä½œåŒ…è£¹çš„å€¼ (é€‚åˆæ²¡æœ‰å®ç°Copyçš„ç±»å‹, å³ç§»åŠ¨è¯­ä¹‰ç±»å‹ã€‚)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚æœé‡åˆ°è¦å®ç°ä¸€ä¸ªåŒæ—¶å­˜åœ¨å¤šä¸ªä¸åŒæ‰€æœ‰è€…ï¼Œä½†æ¯ä¸ªæ‰€æœ‰è€…åˆå¯ä»¥éšæ—¶ä¿®æ”¹å…¶å†…å®¹ï¼Œä¸”è¿™ä¸ªå†…å®¹ç±»å‹ T æ²¡æœ‰å®ç° Copy çš„æƒ…å†µè¯¥æ€ä¹ˆåŠ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let shared_vec: Rc&lt;RefCell&lt;_&gt;&gt; = Rc::new(RefCell::new(Vec::new()));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Output: []</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println!(&quot;{:?}&quot;, shared_vec.borrow());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let b = Rc::clone(&amp;shared_vec);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b.borrow_mut().push(1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b.borrow_mut().push(2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shared_vec.borrow_mut().push(3);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Output: [1, 2, 3]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println!(&quot;{:?}&quot;, shared_vec.borrow());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5118-pin-å’Œ-unpin">5.11.8. Pin å’Œ Unpin<a href="#5118-pin-å’Œ-unpin" class="hash-link" aria-label="5.11.8. Pin å’Œ Unpinçš„ç›´æ¥é“¾æ¥" title="5.11.8. Pin å’Œ Unpinçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">/// ä½¿ç”¨ Pin&lt;P&gt; åˆ™ä»£è¡¨å°†æ•°æ®çš„å†…å­˜ä½ç½®ç‰¢ç‰¢åœ°â€œé’‰â€åœ¨åŸåœ°ï¼Œä¸è®©å®ƒç§»åŠ¨ ã€‚(ä½œç”¨çš„ç±»å‹æ˜¯æŒ‡é’ˆ) </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    æ˜¯ä¸ºäº†è§£å†³è‡ªæˆ‘å¼•ç”¨çš„æ•°æ®ç»“æ„( å…¸å‹å¦‚: å†…éƒ¨åŒ…å«æŒ‡é’ˆ p å’Œæ•°æ® data, p æŒ‡å‘ data)åœ¨å†…å­˜ä¸­åšåœ°å€ç§»åŠ¨å, p çš„å€¼è¿˜æ˜¯åŸæ¥çš„å€¼, ä½†æ˜¯ data æœ‰äº†æ–°çš„åœ°å€, å› æ­¤æ•´ä¸ªæ•°æ®ç»“æ„å°±ä¸èƒ½ä½¿ç”¨äº†, å¦‚åœ¨åš swap æ“ä½œæ—¶å®¹æ˜“å‡ºç°å¾ªç¯å¼•ç”¨ (ç±»æ¯” &quot;åˆ»èˆŸæ±‚å‰‘&quot;çš„æ•…äº‹)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è‡ªå¼•ç”¨ç»“æ„æœ‰å•¥ç”¨å¤„å•Š?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒRustçš„å¼‚æ­¥ç¼–ç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Unpin åˆ™æ­£å¥½å’Œ Pin çš„è§£è¯ï¼Œ ä»£è¡¨è¢«â€œé’‰â€ä½çš„æ•°æ®ï¼Œå¯ä»¥å®‰å…¨åœ°ç§»åŠ¨ã€‚å¤§å¤šæ•°ç±»å‹éƒ½è‡ªåŠ¨å®ç°äº† Unpinã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      è‹¥ P æ˜¯ !Unpin ç±»å‹, Pin&lt;P&gt; æ— æ³• deref_mut, ä¹Ÿå°±æ˜¯æ— æ³•æ‹¿åˆ° P çš„å¯å˜å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      Unpin æ˜¯ auto trait, ä¼šè‡ªåŠ¨å®ç°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      impl Future æ˜¯ !Unpin ç±»å‹, å› ä¸º Future æ˜¯å…¸å‹çš„ è‡ªå¼•ç”¨ç»“æ„ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// tokio ä¸‹çš„ AsyncRead AsyncWrite</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// futures ä¸‹çš„ Stream å’Œ Sink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5119-cow-å†™æ—¶å¤åˆ¶">5.11.9. Cow å†™æ—¶å¤åˆ¶<a href="#5119-cow-å†™æ—¶å¤åˆ¶" class="hash-link" aria-label="5.11.9. Cow å†™æ—¶å¤åˆ¶çš„ç›´æ¥é“¾æ¥" title="5.11.9. Cow å†™æ—¶å¤åˆ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å†™æ—¶å¤åˆ¶( Copy on Write)æŠ€æœ¯æ˜¯ä¸€ç§ç¨‹åºä¸­çš„ä¼˜åŒ–ç­–ç•¥, ç¿»è¯‘æˆäººè¯å°±æ˜¯ æ‹–å»¶åˆ°éœ€è¦å¯¹æ•°æ®è¿›è¡Œå†™æ“ä½œæ—¶æ‰å¤åˆ¶ä¸€ä»½æ‹·è´, æ¯”å¦‚ Linux ä¸­çˆ¶è¿›ç¨‹åˆ›å»ºäºè¿›ç¨‹æ—¶ ï¼Œ å¹¶ä¸æ˜¯ç«‹åˆ»è®©å­è¿›ç¨‹å¤åˆ¶ä¸€ä»½è¿›ç¨‹ç©ºé—´ï¼Œè€Œæ˜¯å…ˆè®©å­è¿›ç¨‹å…±äº«çˆ¶è¿› ç¨‹çš„è¿›ç¨‹ç©ºé—´ ï¼Œ åªæœ‰ç­‰åˆ°å­è¿›ç¨‹çœŸæ­£éœ€è¦å†™å…¥çš„æ—¶å€™æ‰å¤åˆ¶è¿›ç¨‹ç©ºé—´ã€‚</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// æ˜¯ä¸€ä¸ªæšä¸¾ä½“çš„æ™ºèƒ½æŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Borrowedï¼Œ ç”¨äºåŒ…è£¹å¼•ç”¨ã€‚è¡¨ç¤ºæ˜¯å¯¹æ•°æ®çš„å€Ÿç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Ownedï¼Œ ç”¨äºåŒ…è£¹æ‰€æœ‰è€…ã€‚è¡¨ç¤ºæ˜¯å¯¹æ•°æ®çš„æ‹¥æœ‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä»¥ä¸å¯å˜çš„æ–¹å¼è®¿é—®å€Ÿç”¨å†…å®¹ï¼Œä»¥åŠåœ¨éœ€è¦å¯å˜å€Ÿç”¨æˆ–æ‰€æœ‰æƒ çš„æ—¶å€™å†å…‹éš†ä¸€ä»½æ•°æ®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//æ—¨åœ¨å‡å°‘å¤åˆ¶æ“ä½œï¼Œæé«˜æ€§èƒ½ï¼Œ ä¸€èˆ¬ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - Cow&lt;T&gt;å®ç°äº† Derefï¼Œ è¿™æ„å‘³ç€å¯ä»¥ç›´æ¥è°ƒç”¨å…¶åŒ…å«æ•°æ®çš„ä¸å¯å˜ æ–¹æ³•ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - to_mut æ–¹æ³•æ¥è·å–å¯å˜å€Ÿç”¨. </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      è‹¥ T æ˜¯ å€Ÿç”¨, è¯¥æ–¹æ³•ä¼šäº§ç”Ÿå…‹éš†ï¼Œä½†ä»…å…‹éš†ä¸€æ¬¡ ï¼Œ å¦‚æœå¤šæ¬¡è°ƒç”¨ï¼Œåˆ™åªä¼šä½¿ç”¨ç¬¬ä¸€æ¬¡çš„å…‹éš†å¯¹è±¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      å¦‚æœ T æœ¬èº«æ‹¥æœ‰æ‰€æœ‰æƒï¼Œåˆ™æ­¤æ—¶è°ƒç”¨ to_mutä¸ä¼šå‘ç”Ÿå…‹éš†. æ‰€æœ‰æƒè½¬ç§»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// into_ownedæ–¹æ³•æ¥è·å–ä¸€ä¸ªæ‹¥æœ‰æ‰€æœ‰æƒçš„å¯¹è±¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      è‹¥ T æ˜¯å€Ÿç”¨, å‘ç”Ÿå…‹éš†ï¼Œäº•åˆ›å»ºæ–°çš„æ‰€æœ‰æƒå¯¹ è±¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      å¦‚æœ T æ˜¯æ‰€æœ‰æƒå¯¹è±¡ï¼Œ åˆ™ä¼šå°†æ‰€æœ‰æƒè½¬ç§»åˆ°æ–°çš„å…‹éš†å¯¹è±¡ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::borrow::Cow;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ±‚å…ƒç´ ç»å¯¹å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn abs_all(input: &amp;mut Cow&lt;[i32]&gt;) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for i in 0..input.len() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let v = input[i];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if v &lt; 0 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // è·å–å¯å˜å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //to_mut æ–¹æ³•ä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶å…‹éš†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œåœ¨åç»­çš„ for å¾ªç¯ä¸­ ç»§ç»­ç”¨æ–°çš„å…‹éš†å¯¹è±¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input.to_mut()[i] = -v;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ±‚å’Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn abs_sum(ns: &amp;[i32]) -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut lst = Cow::from(ns);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    abs_all(&amp;mut lst);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lst.iter().fold(0, |acc, &amp;n| acc + n)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s1 = [1,2,3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut i1 = Cow::from(&amp;s1[..]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // i1 ä¸­çš„å…ƒç´ éƒ½ä¸ºæ­£, ä¸ä¼šè¿›å…¥ifé€»è¾‘, ä¸æ¶‰åŠåˆ°å¯å˜éœ€æ±‚ï¼Œæ‰€ä»¥ä¸ä¼šå…‹éš†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    abs_all(&amp;mut i1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;IN: {:?}&quot;, s1);//1,2,3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;OUT: {:?}&quot;, i1);//1,2,3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s2 = [1,2,3, -45, 5];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut i2 = Cow::from(&amp;s2[..]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿™é‡Œæœ‰å¯å˜éœ€æ±‚ï¼Œä¸”ç©¿è¿›cow çš„æ•°æ®æ˜¯ä¸ªå¼•ç”¨, æ²¡æœ‰æ‰€æœ‰æƒ, æ‰€ä»¥ä¼šå…‹éš†, i2 å®é™…æ˜¯å…‹éš†å‡ºçš„æ–°å¯¹è±¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    abs_all(&amp;mut i2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;IN: {:?}&quot;, s2);//[1, 2, 3, -45, 5]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;OUT: {:?}&quot;, i2);//[1, 2, 3, 45, 5]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿™é‡Œä¸ä¼šå…‹éš†ï¼Œå› ä¸ºæ•°æ®æœ¬èº«æ‹¥æœ‰æ‰€æœ‰æƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut v1 = Cow::from(vec![1,2,-3,4]);//v1æ˜¯æœ¬èº«å°±æ˜¯å¯å˜çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    abs_all(&amp;mut v1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;IN/OUT: {:?}&quot;, v1);//[1, 2, 3, 4]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦ä¸€ä¸ªç”¨å¤„æ˜¯ç»Ÿä¸€å®ç°è§„èŒƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::borrow::Cow;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Debug)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Token&lt;&#x27;a&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    raw: Cow&lt;&#x27;a, str&gt;,//è¯¥ç”¨&amp;strç±»å‹è¿˜æ˜¯ Stringç±»å‹å‘¢?ä¸ºäº†å¯»æ±‚ç»Ÿä¸€ï¼Œè¿™é‡Œä½¿ç”¨äº† Cow&lt;T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;&#x27;a&gt; Token&lt;&#x27;a&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn new&lt;S&gt;(raw: S) -&gt; Token&lt;&#x27;a&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    where</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        S: Into&lt;Cow&lt;&#x27;a, str&gt;&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Token { raw: raw.into() }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let token = Token::new(&quot;abc123&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let token = Token::new(&quot;api.example.io&quot;.to_string());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¿˜å¯ä»¥è·¨çº¿ç¨‹å®‰å…¨ä¼ é€’</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   thread::spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       println!(&quot;token: {:?}&quot;, token);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }).join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    ä½¿ç”¨åŠ¨æ€å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œåˆ™ä¼šå› ä¸ºç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜è€Œæ— æ³•è·¨çº¿ç¨‹å®‰å…¨ä¼ é€’</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let raw = String::from(&quot;abc&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s = &amp;raw[..];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let token = Token::new(s);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    thread::spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;token: {:?}&quot;, token);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }).join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="512-å‡½æ•°">5.12. å‡½æ•°<a href="#512-å‡½æ•°" class="hash-link" aria-label="5.12. å‡½æ•°çš„ç›´æ¥é“¾æ¥" title="5.12. å‡½æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5121-å‡½æ•°åŸºæœ¬è¯­æ³•">5.12.1. å‡½æ•°åŸºæœ¬è¯­æ³•<a href="#5121-å‡½æ•°åŸºæœ¬è¯­æ³•" class="hash-link" aria-label="5.12.1. å‡½æ•°åŸºæœ¬è¯­æ³•çš„ç›´æ¥é“¾æ¥" title="5.12.1. å‡½æ•°åŸºæœ¬è¯­æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// å¦‚æœä¸æŒ‡å®šè¿”å›å€¼ç±»å‹, é»˜è®¤ è¿”å›ç±»å‹ä¸º () ç©ºå…ƒç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// åŒåå‡½æ•°åœ¨å­˜åœ¨äºå¤šä¸ªä½œç”¨åŸŸ(æ¯”å¦‚ main å¤–, main å†…, main å†…çš„æ–°ä½œç”¨åŸŸ åˆ†åˆ«æœ‰ä¸‰ä¸ªåŒåå‡½æ•°), ä¼šå‘ç”Ÿå±è”½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">aa</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> bb</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i8</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿”å›å€¼æ˜ç¡®æŒ‡å®šç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‹¥å¸¦ return, å°±æ˜¯è¯­å¥, éœ€è¦åˆ†å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// return aa +bb;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸å¸¦ return, å°±æ˜¯è¡¨è¾¾å¼, æ²¡æœ‰åˆ†å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    aa </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> bb</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> sum </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sum = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°å‚æ•°æ”¯æŒæ¨¡å¼åŒ¹é…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‚æ•°ä¸ºæ•°ç»„å¯å˜ç±»å‹, ä¸æ˜¯å¼•ç”¨ç±»å‹ (mut æ— æ³•æ”¾åœ¨å†’å·åé¢)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5122-å‡½æ•°ä½“è¡¨è¾¾å¼">5.12.2. å‡½æ•°ä½“è¡¨è¾¾å¼<a href="#5122-å‡½æ•°ä½“è¡¨è¾¾å¼" class="hash-link" aria-label="5.12.2. å‡½æ•°ä½“è¡¨è¾¾å¼çš„ç›´æ¥é“¾æ¥" title="5.12.2. å‡½æ•°ä½“è¡¨è¾¾å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°ä½“è¡¨è¾¾å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å—æœ«å°¾æ˜¯è¡¨è¾¾å¼, ä¸æ˜¯è¯­å¥, æ²¡æœ‰åˆ†å·, æ²¡æœ‰ return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    x </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// return x + 1;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;x = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5123-å‡½æ•°ä½œä¸ºå‚æ•°">5.12.3. å‡½æ•°ä½œä¸ºå‚æ•°<a href="#5123-å‡½æ•°ä½œä¸ºå‚æ•°" class="hash-link" aria-label="5.12.3. å‡½æ•°ä½œä¸ºå‚æ•°çš„ç›´æ¥é“¾æ¥" title="5.12.3. å‡½æ•°ä½œä¸ºå‚æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">inc1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> num </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">print_num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">print_num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> inc1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// mut å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œå½¢å¼å‚æ•°ç±»å‹å¹¶éå¼•ç”¨, æ‰€ä»¥ä¼ å…¥å®é™…å‚æ•°æ—¶, ä¼šè½¬ç§»æ‰€æœ‰æƒ, å®é™…å‚æ•°æ˜¯ä¸æ˜¯ mut éƒ½å¯ä»¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">modify</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œå½¢å‚ä¸ºå¼•ç”¨, æ‰€ä»¥å®é™…å‚æ•°å¿…é¡»ä¸º &amp; mut</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">modify</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°å‚æ•°æ”¯æŒæ¨¡å¼åŒ¹é…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// (å‡½æ•°ä¸­çš„å‚æ•°ç­‰ä»·äºä¸€ä¸ªéšå¼çš„ letç»‘å®šï¼Œè€Œ letç»‘å®šæœ¬èº«æ˜¯ä¸€ä¸ªæ¨¡å¼åŒ¹é…çš„è¡Œä¸º)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">S</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//è¡¨ç¤º å‚æ•°ä¸ºä¸å¯å˜å¼•ç”¨, ç›¸å¯¹çš„, ref mut è¡¨ç¤ºå‚æ•°ä¸ºå¯å˜å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> _s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">S</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:p}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> _s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//0x7ffdd1364b80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">S</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">42</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// error, æ‰€æœ‰æƒè½¬ç§»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ©ç”¨äº†æ¨¡å¼åŒ¹é…æ¥è§£æ„å…ƒç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">swap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5124-result-è¿”å›å€¼">5.12.4. Result è¿”å›å€¼<a href="#5124-result-è¿”å›å€¼" class="hash-link" aria-label="5.12.4. Result è¿”å›å€¼çš„ç›´æ¥é“¾æ¥" title="5.12.4. Result è¿”å›å€¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å³ä¾¿æ˜¯æ²¡æœ‰æ˜¾å¼è¿”å›å€¼çš„å‡½æ•°ï¼Œå…¶å® ä¹Ÿç›¸å½“äºè¿”å›äº†ä¸€ä¸ªå•å…ƒå€¼()ã€‚å¦‚æœéœ€è¦è¿”å›å¤šä¸ªå€¼ï¼Œäº¦å¯ä½¿ç”¨å…ƒç»„ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å‡½æ•°è¿”å›å€¼ Result&lt;T, E&gt; è§ error_handling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5125-ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ-cfe">5.12.5. ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ cfe<a href="#5125-ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ-cfe" class="hash-link" aria-label="5.12.5. ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ cfeçš„ç›´æ¥é“¾æ¥" title="5.12.5. ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ cfeçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç¼–è¯‘æ—¶å‡½æ•°æ‰§è¡Œ, ç®€ç§° cfe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‡½æ•°ä¼šåœ¨ç¼–è¯‘æœŸè¢«æ‰§è¡Œ, è®¡ç®—å‡ºå¸¸é‡ç»“æœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">const_fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">const_fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5126-å‘æ•£å‡½æ•°">5.12.6. å‘æ•£å‡½æ•°<a href="#5126-å‘æ•£å‡½æ•°" class="hash-link" aria-label="5.12.6. å‘æ•£å‡½æ•°çš„ç›´æ¥é“¾æ¥" title="5.12.6. å‘æ•£å‡½æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ„Ÿå¹å· æƒŠå¹å·</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å‘æ•£å‡½æ•°: è¿”å›å€¼ç±»å‹ä¸º &quot;!&quot; (never type), æ ‡è¯†å‡½æ•°æ°¸è¿œä¸ä¼šè¿”å›å€¼, æ¯”å¦‚ å‡½æ•°åŒ…å«æ­»å¾ªç¯, æˆ–è€… panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     å‘æ•£å‡½æ•°å¯ä»¥ä½œä¸ºä»»ä½•ç±»å‹. åº”ç”¨:å¯ä»¥åœ¨æ­£å¸¸æœ‰è¿”å›å€¼å‡½æ•°ä¸­ panic, åœ¨if åˆ¤æ–­ä¸­ panic (å› ä¸º panic è¿”å›ç±»å‹ä¸º never type)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     https://www.zhihu.com/question/54540714/answer/146231560</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5127-æ³›å‹å‡½æ•°">5.12.7. æ³›å‹å‡½æ•°<a href="#5127-æ³›å‹å‡½æ•°" class="hash-link" aria-label="5.12.7. æ³›å‹å‡½æ•°çš„ç›´æ¥é“¾æ¥" title="5.12.7. æ³›å‹å‡½æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">//è°ƒç”¨æ—¶, ç¼–è¯‘å™¨æ¥è¿›è¡Œè‡ªåŠ¨æ¨æ–­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ— æ³•è‡ªåŠ¨æ¨æ–­, åˆ™éœ€è¦æ˜¾å¼æŒ‡å®š, å¦‚ä¸ºæ¥æ”¶çš„å˜é‡æŒ‡å®šç±»å‹, æˆ–è€…æ–¹æ³•è°ƒç”¨çš„æ—¶å€™, ä½¿ç”¨ turbofishæ“ä½œç¬¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let a: i32 = square(37 , 41) ;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let a= square::&lt;u32&gt;(37, 41)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5128-é«˜é˜¶å‡½æ•°">5.12.8. é«˜é˜¶å‡½æ•°<a href="#5128-é«˜é˜¶å‡½æ•°" class="hash-link" aria-label="5.12.8. é«˜é˜¶å‡½æ•°çš„ç›´æ¥é“¾æ¥" title="5.12.8. é«˜é˜¶å‡½æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51281-å‡½æ•°æŒ‡é’ˆ">5.12.8.1. å‡½æ•°æŒ‡é’ˆ<a href="#51281-å‡½æ•°æŒ‡é’ˆ" class="hash-link" aria-label="5.12.8.1. å‡½æ•°æŒ‡é’ˆçš„ç›´æ¥é“¾æ¥" title="5.12.8.1. å‡½æ•°æŒ‡é’ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å‡½æ•°æŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ç°è¿™ä¸€åˆ‡çš„åŸºç¡€åœ¨äº Rustæ”¯æŒç±»ä¼¼ CIC++è¯­è¨€ä¸­çš„å‡½æ•°æŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn math(op: fn(i32, i32) -&gt; i32, a: i32, b: i32) -&gt; i32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn hello(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;hello function pointer&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¿…é¡»æ˜¾å¼æŒ‡å®šå‡½æ•°æŒ‡é’ˆç±»å‹ fn()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let fn_ptr: fn() = hello;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:p}&quot;, fn_ptr); // 0x562bacfb9f80</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è‹¥æ²¡æŒ‡å®šå‡½æ•°æŒ‡é’ˆç±»å‹, å°±ä¸æ˜¯æŒ‡é’ˆ, other_fn çš„ç±»å‹å®é™…ä¸Šæ˜¯ fn() {hello}ï¼Œè¿™å…¶å®æ˜¯å‡½æ•° hello æœ¬èº«çš„ç±»å‹ï¼Œè€Œéå‡½æ•°æŒ‡é’ˆç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let other_fn = hello;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:p}&quot;, other_fn);  // not function pointer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hello();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   other_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   fn_ptr();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   (fn_ptr)();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹äºå‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ type å…³é”®å­—ä¸ºå…¶å®šä¹‰åˆ«å </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">type MathOp = fn (i32 ï¼Œ i32) - &gt; i32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn math(op: MathOp, a: i32, b: i32) -&gt; i32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn math(op: &amp;str) -&gt; MathOp</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51282-ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡">5.12.8.2. ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡<a href="#51282-ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡" class="hash-link" aria-label="5.12.8.2. ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡çš„ç›´æ¥é“¾æ¥" title="5.12.8.2. ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// error, // å› ä¸ºå‡½æ•°ä¸èƒ½æ•æ‰åŠ¨æ€ç¯å¢ƒä¸­çš„å˜é‡i, å˜é‡ ç»‘å®š i ä¼šéšç€å¸§çš„é‡Šæ”¾è€Œé‡Šæ”¾ï¼Œéœ€è¦é—­åŒ…æ‰å¯ä»¥æ•è·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn counter(i: i32) -&gt; fn(i32) -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn inc(n: i32) -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        n + i  // error[E0434]: can&#x27;t capture dynamic environment in a fn item</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let f = counter(2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(3, f(1));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ­£ç¡®, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn counter() -&gt; fn(i32) -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn inc(n: i32) -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        n + 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let f = counter();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(2, f(1));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è‹¥æœä¸€å®šè¦æ•è·ç¯å¢ƒå˜é‡, éœ€è¦é—­åŒ…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// 2015 edition:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn counter(i: i32) -&gt; Box&lt;Fn(i32) -&gt; i32&gt; {//æ”¾åˆ°äº† Box&lt;T&gt;ä¸­ï¼Œ å› ä¸ºé—­åŒ…çš„å¤§ å°åœ¨ç¼–è¯‘æœŸæ˜¯æœªçŸ¥çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Box::new(move |n: i32| n + i )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// or 2018:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä»¥å¤§å†™å­—æ¯ F å¼€å¤´çš„ Fn å¹¶ä¸æ˜¯å‡½æ•°æŒ‡é’ˆç±»å‹ Fn(i32)-&gt;i32ï¼Œ å®ƒæ˜¯ä¸€ä¸ªtrait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn counter(i: i32) -&gt; impl Fn(i32) -&gt; i32 {//åŠ¨æ€å¤§å°ç±»å‹  impl Trait, è¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨ Box&lt;T&gt;äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    move |n: i32|{ n + i }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="513-é—­åŒ…">5.13. é—­åŒ…<a href="#513-é—­åŒ…" class="hash-link" aria-label="5.13. é—­åŒ…çš„ç›´æ¥é“¾æ¥" title="5.13. é—­åŒ…çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5131-é—­åŒ…åŸºæœ¬ä½¿ç”¨">5.13.1. é—­åŒ…åŸºæœ¬ä½¿ç”¨<a href="#5131-é—­åŒ…åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="5.13.1. é—­åŒ…åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.13.1. é—­åŒ…åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">///é—­åŒ… (åŒ¿åå‡½æ•°): æ˜¯ä¸€ä¸ªæŒæœ‰å¤–éƒ¨ç¯å¢ƒå˜é‡çš„å‡½æ•°ã€‚ å¤–éƒ¨ç¯å¢ƒæ˜¯æŒ‡é—­åŒ…å®šä¹‰æ—¶æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å»¶è¿Ÿæ‰§è¡Œ ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ•è·ç¯å¢ƒå˜é‡ ã€‚é—­åŒ…ä¼šè·å–å…¶å®šä¹‰æ—¶æ‰€åœ¨ä½œç”¨åŸŸä¸­çš„è‡ªç”±å˜ é‡ ï¼Œä»¥ä¾›ä¹‹åè°ƒç”¨æ—¶ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸¤ä¸ªå®šä¹‰ä¸€æ¨¡ä¸€æ ·çš„é—­åŒ… ä¹Ÿå¹¶ä¸ä¸€å®šå±äºåŒ ä¸€ç§ç±»å‹, æ— æ³•å°†å®ƒä»¬ä¿å­˜åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚å› ä¸ºæ•°ç»„åªèƒ½ä¿ å­˜ç›¸åŒç±»å‹çš„å…ƒç´ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">closure_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;------------------------ closure demo&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> inc </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">num</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token closure-params"> </span><span class="token closure-params keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">////è¿”å›å€¼ç±»å‹æ¨å¯¼: æ— è®ºåé¢æ˜¯å¦è¢«è°ƒç”¨, è¿”å›å€¼éƒ½å¯çœç•¥, ä½†æ˜¯æ— æ³•ä¸¤æ¬¡æ¨å¯¼ä¸åŒçš„å‚æ•°/è¿”å›å€¼ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        num </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// num çš„å‚æ•°ç±»å‹å¯ä»¥çœç•¥, è¿”å›å€¼ç±»å‹å¯ä»¥çœç•¥, èŠ±æ‹¬å·å¯ä»¥çœç•¥; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è¿™æ˜¯å› ä¸ºåé¢ print_num å‡½æ•°ä¸­å·²ç»æœ‰ç±»å‹ä¿¡æ¯äº†, å•ç‹¬å®šä¹‰é—­åŒ…, æ²¡æœ‰åé¢çš„è°ƒç”¨ä¿¡æ¯, åˆ™å‚æ•°ç±»å‹ä¸èƒ½çœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> inc0 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">num</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> num</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">inc1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> num </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">print_num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">print_num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> inc1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">print_num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> inc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">print_num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> inc0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5132-rust-å®ç°é—­åŒ…çš„åŸç†">5.13.2. rust å®ç°é—­åŒ…çš„åŸç†<a href="#5132-rust-å®ç°é—­åŒ…çš„åŸç†" class="hash-link" aria-label="5.13.2. rust å®ç°é—­åŒ…çš„åŸç†çš„ç›´æ¥é“¾æ¥" title="5.13.2. rust å®ç°é—­åŒ…çš„åŸç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åœ¨ Rust ä¸­ï¼Œé—­åŒ…æ˜¯ä¸€ç§è¯­æ³•ç³–, æ˜¯åœ¨åŸºæœ¬è¯­æ³•åŠŸèƒ½ä¹‹ä¸Šåˆæä¾›çš„ä¸€å±‚æ–¹ä¾¿å¼€å‘è€…ç¼–ç¨‹çš„è¯­æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æœ€åˆé—­åŒ…æ˜¯é€šè¿‡  è£…ç®±( Boxed) é—­åŒ… å®ç°çš„, æ€§èƒ½å·®, LLVM éš¾ä»¥å¯¹å…¶è¿›è¡Œå†…è”å’Œä¼˜åŒ–ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚: é—­åŒ… || {a+b} çš„å®ç°å¯ä»¥é€šè¿‡å‡½æ•°æŒ‡é’ˆ å’Œæ•è·å˜é‡æŒ‡é’ˆç»„åˆæ¥å®ç°ã€‚æŒ‡é’ˆæ”¾stackä¸Šï¼Œæ•è·å˜é‡æ”¾åˆ°å †ä¸Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// éè£…ç®± CUnboxed) é—­åŒ… (ç°åœ¨çš„å®ç°æ–¹å¼): æ”¯æŒé—­åŒ…æŒ‰å€¼å’ŒæŒ‰å¼•ç”¨ç»‘å®šç¯å¢ƒå˜é‡ ; æ”¯æŒä¸‰ç§ä¸åŒçš„é—­åŒ…è®¿é—®ï¼Œ å¯¹åº” selfã€&amp;selfå’Œ&amp;mut selfä¸‰ç§æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å°†å‡½æ•°è°ƒç”¨æŠ½è±¡ä¸ºä¸‰ç§, æ–°å¢ä¸‰ä¸ª trait è¡¨ç¤º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¿™æ ·, æ–¹æ³•è°ƒç”¨ a(b, c, d)å˜ä¸ºä¸€ä¸‹ä¸‰ç§æ‰§è¡Œæ–¹å¼:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Fn::call(&amp;a, (b, c, d))          - è°ƒç”¨ å‚æ•°ä¸º &amp;selfï¼Œ è¿™æ„å‘³ç€å®ƒä¼šå¯¹æ–¹æ³•æ¥æ”¶è€…è¿›è¡Œä¸å¯å˜å€Ÿç”¨ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æ–¹æ³•è°ƒç”¨å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// FnMut::callmut(&amp;muta, (b, c, d)) - è°ƒç”¨å‚æ•°ä¸º&amp; mut selfï¼Œè¿™æ„å‘³ç€å®ƒä¼šå¯¹æ–¹æ³•æ¥æ”¶è€…è¿›è¡Œå¯å˜å€Ÿç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// FnOnce::call once(a, (b, c, d)) - è°ƒç”¨å‚æ•°ä¸º selfï¼Œè¿™æ„å‘³ç€å®ƒä¼šè½¬ç§»æ–¹æ³•æ¥æ”¶è€…çš„æ‰€æœ‰æƒã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯è¿™ ç§æ–¹æ³•è°ƒç”¨åªèƒ½è¢«è°ƒç”¨ ä¸€æ¬¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç°åœ¨å®ç°é—­åŒ…å°±ç®€å•äº†, ç›´æ¥å®šä¹‰ä¸€ä¸ª struct è¡¨ç¤º é—­åŒ…, å†…éƒ¨ä½¿ç”¨ä¸€ä¸ªå­—æ®µè¡¨ç¤ºæ•è·çš„è‡ªç”±å˜é‡, åœ¨è°ƒç”¨çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªå˜é‡å³å¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®é™…ä¸Š, é—­åŒ…è¡¨è¾¾å¼ä¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç¿»è¯‘ä¸ºç»“æ„ä½“å®ä¾‹ï¼Œå¹¶ä¸ºå…¶å®ç° Fnã€FnMutã€FnOnceä¸‰ä¸ª trait ä¸­çš„ ä¸€ä¸ª</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ‰‹åŠ¨å®ç°å¦‚ä¸‹:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#![feature(unboxed_closures, fn_traits)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Closure {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    env_var: u32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl FnOnce&lt;()&gt; for Closure {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    type Output = u32;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å°†å‡½æ•°å‚æ•°ä¸­çš„å…ƒ ç»„ç±»å‹åšåŠ¨æ€æ‰©å±•ï¼Œä»¥ä¾¿æ”¯æŒå¯å˜é•¿å‚æ•°ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å› ä¸ºåœ¨ Fnã€ FnMutã€ FnOnce è¿™ä¸‰ä¸ª trait é‡Œçš„æ–¹ æ³•è¦æ¥æ”¶é—­åŒ…çš„å‚æ•°ï¼Œè€Œç¼–è¯‘å™¨æœ¬èº«å¹¶ä¸å¯èƒ½çŸ¥é“å¼€å‘è€…ç»™é—­åŒ…è®¾å®šçš„å‚æ•°ä¸ªæ•°ï¼Œæ‰€ä»¥è¿™é‡Œ åªèƒ½ä¼ å…ƒç»„ï¼Œç„¶åç”± rust-callABIåœ¨åº•å±‚åšåŠ¨æ€æ‰©å±•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // éœ€è¦ unboxed closuresç‰¹æ€§æ”¯æŒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    extern &quot;rust-call&quot; fn call_once(self, args: ()) -&gt; u32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;call it FnOnce()&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.env_var + 2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl FnMut&lt;()&gt; for Closure {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    extern &quot;rust-call&quot; fn call_mut(&amp;mut self, args: ()) -&gt; u32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;call it FnMut()&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.env_var + 2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Fn&lt;()&gt; for Closure {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    extern &quot;rust-call&quot; fn call(&amp;self, args: ()) -&gt; u32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;call it Fn()&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.env_var + 2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let env_var = 1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let mut c = Closure { env_var: env_var };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç»“æ„ä½“å®ä¾‹å¯ä»¥åƒå‡½æ•°é‚£æ ·è¢«è°ƒç”¨, å› ä¸º å®šä¹‰æ–¹æ³•æ—¶å€™, ä½¿ç”¨äº† extern å…³é”®å­—ï¼Œè¡¨ç¤ºä½¿ç”¨æŒ‡å®šçš„ ABI (Application Binary Interfaceï¼Œ ç¨‹ åºäºŒè¿›åˆ¶æ¥å£)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">c();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">c.call(());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">c.call_mut(());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">c.call_once(());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5133-æ•è·ç¯å¢ƒå˜é‡-and-ä¸‰ç§é—­åŒ…ç±»å‹">5.13.3. æ•è·ç¯å¢ƒå˜é‡ and ä¸‰ç§é—­åŒ…ç±»å‹<a href="#5133-æ•è·ç¯å¢ƒå˜é‡-and-ä¸‰ç§é—­åŒ…ç±»å‹" class="hash-link" aria-label="5.13.3. æ•è·ç¯å¢ƒå˜é‡ and ä¸‰ç§é—­åŒ…ç±»å‹çš„ç›´æ¥é“¾æ¥" title="5.13.3. æ•è·ç¯å¢ƒå˜é‡ and ä¸‰ç§é—­åŒ…ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// é—­åŒ…ä¸­å¯ä»¥æ•è·å¤–éƒ¨ç¯å¢ƒä¸­çš„å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ•è·ç¯å¢ƒå˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æœ‰ä¸‰ç§æ–¹å¼, æ ¹æ®æ•è·å˜é‡æ–¹å¼ä¸åŒ, å°†é—­åŒ…å®šä¹‰ä¸ºä¸‰ç§ trait:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Fnï¼Œè¡¨ç¤ºé—­åŒ…ä»¥ä¸å¯å˜å€Ÿç”¨çš„æ–¹å¼æ¥æ•è·ç¯å¢ƒä¸­çš„è‡ªç”±å˜ é‡ ï¼ŒåŒæ—¶ä¹Ÿè¡¨ç¤º è¯¥é—­ åŒ…æ²¡æœ‰ æ”¹å˜ç¯å¢ƒçš„èƒ½åŠ› ï¼Œ å¹¶ä¸”å¯ä»¥å¤šæ¬¡è°ƒç”¨ã€‚é—­åŒ…æ¥æ”¶è€…æ˜¯ä¸å¯å˜å¼•ç”¨, å¯¹åº” &amp;selfã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//                  ç­‰å·å³ä¾§é—­åŒ…è¡¨è¾¾å¼  æ²¡åŠ  move, å†…éƒ¨æ— å†™æ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//              æœªæ•è·ä»»ä½•ç¯å¢ƒå˜é‡çš„é—­åŒ…ä¼šè‡ªåŠ¨å®ç° Fn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//              æ•è·çš„è‡ªç”±å˜é‡è‹¥ä¸ºå¤åˆ¶è¯­ä¹‰ç±»å‹, åˆ™é—­åŒ…å®ç°äº† Fn (ä¸éœ€è¦å¯¹å¤–éƒ¨å˜é‡è¿›è¡Œå†™æ“ä½œ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//              ä½¿ç”¨ move å…³é”®å­—åˆ™è‡ªåŠ¨å®ç° Fn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// FnMutï¼Œè¡¨ç¤ºé—­åŒ…ä»¥å¯å˜å€Ÿç”¨çš„æ–¹å¼æ¥æ•è·ç¯å¢ƒä¸­çš„è‡ªç”±å˜ é‡ ï¼ŒåŒæ—¶æ„å‘³ ç€è¯¥ é—­åŒ…æœ‰ æ”¹å˜ç¯å¢ƒçš„èƒ½åŠ› ï¼Œä¹Ÿå¯ä»¥ å¤šæ¬¡ è°ƒç”¨ ã€‚ é—­åŒ…æ¥æ”¶è€…æ˜¯å¯å˜å¼•ç”¨, å¯¹åº”&amp;mut selfã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//                      æ²¡åŠ  move, å†…éƒ¨æœ‰å†™æ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//                     ä¿®æ”¹ç¯å¢ƒå˜é‡ä»¥è‡ªåŠ¨å®ç° FnMut</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// FnOnceï¼Œ è¡¨ç¤ºé—­åŒ…é€šè¿‡è½¬ç§»æ‰€æœ‰æƒæ¥æ•è·ç¯å¢ƒä¸­çš„è‡ªç”±å˜é‡ï¼ŒåŒæ—¶æ„å‘³ç€è¯¥é—­åŒ…æ²¡ æœ‰æ”¹å˜ç¯å¢ƒçš„èƒ½åŠ›ï¼Œåªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå› ä¸ºè¯¥é—­åŒ…ä¼šæ¶ˆè€—è‡ªèº«ã€‚é—­åŒ…æ¥æ”¶è€…æ˜¯å€¼, å¹¶éå¼•ç”¨, å¯¹åº” selfã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//                      åŠ äº† move</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//              ç”±äºæ‰€æœ‰æ‰€æœ‰é—­åŒ…éƒ½å¯ä»¥è‡³å°‘è°ƒç”¨ä¸€æ¬¡, æ‰€ä»¥æ¶‰åŠåˆ°æ•è·ç¯å¢ƒå˜é‡ çš„æ‰€æœ‰é—­åŒ…éƒ½å®ç°äº† FnOnce </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸‰ç§ trait åŒ…å«å…³ç³»: fn å±äº(ç»§æ‰¿äº) fnmut å±äº(ç»§æ‰¿äº) fnonce;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ï¼Œå¦‚æœè¦å®ç° Fnï¼Œ å°±å¿…é¡»å®ç° FnMutå’Œ FnOnce;å¦‚æœè¦å®ç° FnMut, å°±å¿…é¡»å®ç° FnOnce; å¦‚æœåªéœ€è¦å®ç° FnOnceï¼Œ å°±ä¸éœ€è¦å®ç° FnMut å’Œ Fn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é—­åŒ…æ•è·å…¶ç¯å¢ƒå˜é‡çš„æ–¹å¼:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äºå¤åˆ¶è¯­ä¹‰ç±»å‹ ï¼Œè‹¥ è¡¨è¾¾å¼åŠ äº† move , ä»¥ copy çš„å½¢å¼è¿›è¡Œæ•è·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//                  è‹¥æœªåŠ  move, ä»¥ å¼•ç”¨/å¯å˜å¼•ç”¨ çš„å½¢å¼è¿›è¡Œæ•è·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äºç§»åŠ¨è¯­ä¹‰ç±»å‹ ï¼Œè½¬ç§»æ‰€æœ‰æƒæ¥è¿›è¡Œæ•è· (æ— è®ºåŠ æ²¡åŠ  move)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//              ç§»åŠ¨è¯­ä¹‰ç±»å‹è‡ªåŠ¨å®ç°äº† FnOnce</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äºå¯å˜ç»‘å®šï¼Œå¹¶ä¸”åœ¨é—­åŒ…ä¸­åŒ…å«å¯¹å…¶è¿›è¡Œä¿®æ”¹çš„æ“ ä½œï¼Œåˆ™ä»¥å¯ å˜å¼•ç”¨ (&amp;mut T) æ¥è¿›è¡Œæ•è· ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¿®æ”¹äº† è‡ªç”±å˜é‡, æ²¡åŠ  move, é—­åŒ…ä¸º FnMut, éœ€è¦å£°æ˜ä¸º å¯å˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> func </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">  </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        i</span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> plus_one </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// move å¯é€‰, æ¶‰åŠåˆ°å¤šçº¿ç¨‹å¹¶å‘, ä¸€å®šè¦åŠ  move, i æ‰€æœ‰æƒç§»åŠ¨åˆ°é—­åŒ…, å¯¹äºåŸºæœ¬ç±»å‹, ç›¸å½“äºå¤åˆ¶äº†ä¸€ä»½, åœ¨é—­åŒ…å†…çš„æ“ä½œä¸å½±å“å¤–éƒ¨çš„ i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½†æ˜¯  , è‹¥æœ‰è¿”å›å€¼, å°±å˜ä¸ºå¤åˆ¶å¼•ç”¨äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">plus_one</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;i = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//1,  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äºå¤æ‚ç±»å‹çš„ æ•è·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> eq </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">x</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> x</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// vçš„æ‰€æœ‰æƒç§»åŠ¨åˆ°äº†é—­åŒ…å†…éƒ¨, å¤–éƒ¨çš„ v å¤±æ•ˆäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;eq? {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">eq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;v = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, borrow of moved value: `v`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ›´å¤šç¤ºä¾‹å¯¹æ¯”</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ²¡æœ‰ move, é—­åŒ…å†…éƒ¨æ˜¯ å¼•ç”¨, </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> fu1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">fu1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//-----------Moveçš„æƒ…å†µ----------- (å¯¹äºåŸºæœ¬ç±»å‹, å®ç°äº† copy trait, æ˜¯ copy, å¯¹äº ç¬¦åˆç±»å‹, è‹¥æ²¡æœ‰å®ç° copy trait, åˆ™æ‰€æœ‰æƒè½¬ç§»)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å­˜åœ¨ move, é—­åŒ…å†…æ˜¯å¤åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> fu1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å±€éƒ¨å˜é‡è¢«ä¸¢å¼ƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">fu1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å­˜åœ¨è¿”å›å€¼çš„æƒ…å†µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> fu </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    i</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">fu</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">//12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//-----------Moveçš„æƒ…å†µ-----------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> fu </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    i</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">fu</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">//11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯¹äºæ²¡æœ‰å®ç° Copy çš„ å¤åˆç±»å‹ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨é—­åŒ…ä¸­å¯ä»¥è°ƒç”¨å…¶æ–¹æ³•ï¼Œæ˜¯â€œå€Ÿç”¨â€ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å­˜åœ¨è¿”å›å€¼, è¿”å›å€¼äº†å°±å‘ç”Ÿæ‰€æœ‰æƒè½¬ç§», å› ä¸º è¿”å›å€¼æœ‰å¯èƒ½åœ¨åˆ«çš„åœ°æ–¹ä½¿ç”¨, ä¸ºäº†å®‰å…¨, æ‰€æœ‰æƒè½¬ç§»äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;coolshell&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> take_str </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç§»åŠ¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//ERROR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">take_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// OK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> change_s1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;!&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ²¡æœ‰è¿”å›å€¼, ä¸ä¼šç§»èµ°, åªä¼šå¯å˜å€Ÿç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// error, å•ç‹¬å‡ºç°æ²¡é”™, ä½†æ˜¯å’Œä¸‹é¢å‡½æ•°è°ƒç”¨ä¸€èµ·å‡ºç°å‡ºé”™äº†, å¯å˜å€Ÿç”¨å, æ²¡æ³•è¿›è¡Œä¸å¯å˜å€Ÿç”¨äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">change_s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// hello!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xiaoyu&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> age </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">p</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token closure-params"> </span><span class="token closure-params class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å­˜åœ¨è¿”å›å€¼, æ‰€æœ‰æƒç§»åŠ¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> name </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">p</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token closure-params"> </span><span class="token closure-params class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// name(p)ç¼–è¯‘é”™è¯¯, p ä¸¢å¤±æ‰€æœ‰æƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ”¹ä¸º å¼•ç”¨ç‰ˆæœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äº åŸºæœ¬ç±»å‹ çš„å±æ€§, å­˜åœ¨ copy trait, è¿”å›çš„æ˜¯ copy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> age </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">p</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token closure-params"> </span><span class="token closure-params operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token closure-params class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ç°åœ¨å¯ä»¥é‡å¤ä½¿ç”¨äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, å› ä¸ºname ä¸º string ç±»å‹, æ²¡æœ‰ copy trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°ç»“æŸ, p.name è¢«é‡Šæ”¾, å‡ºé”™, è‹¥å­˜åœ¨ copy trait, ä¼šè¿”å› å¤åˆ¶, æ²¡æœ‰ copy trait, åªèƒ½é€šè¿‡è¿”å›å¼•ç”¨è§£å†³</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> name </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">p</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token closure-params"> </span><span class="token closure-params operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token closure-params class-name" style="color:rgb(38, 127, 153)">People</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è§£å†³: ç”Ÿå‘½å‘¨æœŸ, å»¶ç¼“ p.name  è¢«é‡Šæ”¾çš„æ—¶é—´</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">p</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token closure-params"> </span><span class="token closure-params operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token closure-params class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// é—­åŒ…è¿”å›å€¼å¿…é¡»ä¸ºå¼•ç”¨, ä¸èƒ½æŠŠ name move èµ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//or ; å‚æ•°ç±»å‹çœç•¥äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">People</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">p</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5134-é—­åŒ…ä½œä¸ºè¿”å›å€¼-or-å‚æ•°">5.13.4. é—­åŒ…ä½œä¸ºè¿”å›å€¼ or å‚æ•°<a href="#5134-é—­åŒ…ä½œä¸ºè¿”å›å€¼-or-å‚æ•°" class="hash-link" aria-label="5.13.4. é—­åŒ…ä½œä¸ºè¿”å›å€¼ or å‚æ•°çš„ç›´æ¥é“¾æ¥" title="5.13.4. é—­åŒ…ä½œä¸ºè¿”å›å€¼ or å‚æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51341-é€ƒé€¸é—­åŒ…-éé€ƒé€¸é—­åŒ…">5.13.4.1. é€ƒé€¸é—­åŒ… éé€ƒé€¸é—­åŒ…<a href="#51341-é€ƒé€¸é—­åŒ…-éé€ƒé€¸é—­åŒ…" class="hash-link" aria-label="5.13.4.1. é€ƒé€¸é—­åŒ… éé€ƒé€¸é—­åŒ…çš„ç›´æ¥é“¾æ¥" title="5.13.4.1. é€ƒé€¸é—­åŒ… éé€ƒé€¸é—­åŒ…çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Box&lt;Fn()&gt;æ˜¯ä¸€ä¸ª traitå¯¹è±¡, </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// traitå¯¹è±¡æ˜¯åŠ¨æ€åˆ†å‘çš„ï¼Œåœ¨è¿è¡Œæ—¶é€šè¿‡æŸ¥æ‰¾è™šè¡¨( vtableã€•æ¥ç¡®å®šè°ƒç”¨å“ªä¸ªé—­åŒ…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">boxed_closure</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;second&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;first&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦å°† s copy ä¸€ä»½, åœ¨æ–¹æ³•å¤–ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//é€ƒé€¸é—­åŒ… (escapeclosure): åœ¨å‡½æ•°æ ˆå¸§ç»“æŸåæ‰ä½¿ç”¨çš„é—­åŒ…, å¦‚æœæ˜¯è·Ÿéšå‡½æ•°ä¸€èµ·è°ƒç”¨çš„é—­åŒ…ï¼Œ åˆ™ æ˜¯éé€ƒé€¸é—­åŒ… (non-escape closure)ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;third&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">boxed_closure</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> f </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> c </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// first / second / third</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51342-é—­åŒ…ä½œä¸ºå‚æ•°">5.13.4.2. é—­åŒ…ä½œä¸ºå‚æ•°<a href="#51342-é—­åŒ…ä½œä¸ºå‚æ•°" class="hash-link" aria-label="5.13.4.2. é—­åŒ…ä½œä¸ºå‚æ•°çš„ç›´æ¥é“¾æ¥" title="5.13.4.2. é—­åŒ…ä½œä¸ºå‚æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å®ç° vec.any æ¡ä»¶åŒ¹é…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// é€šè¿‡æ³›å‹, å®ç°é™æ€åˆ†å‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::ops::Fn;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Any {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn any&lt;F&gt;(&amp;self,  f: F) -&gt; bool where</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Self: Sized,//å½“Anyè¢«ä½œä¸º trait å¯¹è±¡ä½¿ç”¨æ—¶ï¼Œè¯¥æ–¹æ³•ä¸èƒ½è¢«åŠ¨æ€è°ƒç”¨, åªèƒ½é™æ€åˆ†å‘ï¼Œè¿™å±äºä¸€ç§ä¼˜åŒ–ç­–ç•¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        F: Fn(u32) -&gt; bool;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Any for Vec&lt;u32&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn any&lt;F&gt;(&amp;self, f: F) -&gt; bool where</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Self: Sized,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   F: Fn(u32) -&gt; bool</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       for &amp;x in self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           if f(x) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">               return true;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let  v = vec![1,2,3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let b = v.any(|x| x == 3);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, b);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// é€šè¿‡å°†é—­åŒ…ä½œä¸º trait å¯¹è±¡çš„æ–¹å¼, å®ç°åŠ¨æ€åˆ†å‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä»£ç æ›´åŠ ç®€ç»ƒ, åŠ¨æ€åˆ†å‘æ¯”é™æ€åˆ†å‘çš„æ€§èƒ½ ä½ ä¸€äº›, ä½†å®Œå…¨å¯ä»¥æ¥å—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Any {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  fn any(&amp;self,  f: &amp;(Fn(u32) -&gt; bool)) -&gt; bool;// &amp;(Fn(u32) -&gt; bool) å³ä¸º trait object</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Any for Vec&lt;u32&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn any(&amp;self, f: &amp;(Fn(u32) -&gt; bool)) -&gt; bool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        for &amp;x in self.iter() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if f(x) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                return true;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let  v = vec![1,2,3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let b = v.any(&amp;|x| x == 3);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   println!(&quot;{:?}&quot;, b);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51343-é—­åŒ…ä½œä¸ºè¿”å›å€¼">5.13.4.3. é—­åŒ…ä½œä¸ºè¿”å›å€¼<a href="#51343-é—­åŒ…ä½œä¸ºè¿”å›å€¼" class="hash-link" aria-label="5.13.4.3. é—­åŒ…ä½œä¸ºè¿”å›å€¼çš„ç›´æ¥é“¾æ¥" title="5.13.4.3. é—­åŒ…ä½œä¸ºè¿”å›å€¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// ä½œä¸ºè¿”å›å€¼, å¿…é¡»ä½¿ç”¨ traitå¯¹è±¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn square() -&gt; Box&lt;Fn(i32) -&gt; i32&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Box::new(|i| i*i )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹äºç¼–è¯‘æœŸæ— æ³•ç¡®å®šå¤§å°çš„å€¼ï¼Œä¸èƒ½ç§»åŠ¨å…¶æ‰€æœ‰æƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚æœè¦è°ƒç”¨é—­åŒ… Box&lt;Fn0nce(i32)-&gt;i32&gt;ï¼Œ å°±å¿…é¡»å…ˆæŠŠ Fn0nce(i32)-&gt;i32 ä» Box&lt;T&gt;ä¸­ç§»å‡º æ¥ã€‚è€Œæ­¤æ—¶ Box&lt;T&gt;ä¸­çš„ Tæ— æ³•åœ¨ç¼–è¯‘æœŸç¡®å®šå¤§å°ï¼Œä¸èƒ½ç§»åŠ¨æ‰€æœ‰æƒï¼Œæ‰€ä»¥å°±æŠ¥é”™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn square() -&gt; Box&lt;FnOnce(i32) -&gt; i32&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Box::new( |i| {i*i })</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ­£ç¡®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½¿ç”¨ impl trait çš„æ–¹å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn square() -&gt; impl FnOnce(i32) -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    |i| {i*i }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//è¿”å›çš„é—­åŒ…è¿˜å¿…é¡»ä½¿ç”¨ move å…³é”®å­—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//          å®ƒè¡¨æ˜é—­åŒ…å†…æ‰€æœ‰çš„æ•è·éƒ½æ˜¯é€šè¿‡å€¼è¿›è¡Œçš„(æ˜¯ä¸€ä»½æ‹·è´, æ˜¯å®‰å…¨ç‹¬ç«‹çš„)ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//          å› ä¸ºè‹¥æœæ²¡æœ‰ move, é—­åŒ…æ˜¯æŒ‰å¼•ç”¨æ•è·å˜é‡ï¼Œå‡½æ•°ç»“æŸ, é—­åŒ…å°†å¼•ç”¨è¿”å›, ä½†æ˜¯å¼•ç”¨æŒ‡å‘çš„æ•°æ®å°†è¢«é‡Šæ”¾, åœ¨é—­åŒ…ä¸­ç•™ä¸‹æ— æ•ˆçš„å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn create_fn() -&gt; impl Fn() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let text = &quot;Fn&quot;.to_owned();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    move || println!(&quot;This is a: {}&quot;, text)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn create_fnmut() -&gt; impl FnMut() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let text = &quot;FnMut&quot;.to_owned();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    move || println!(&quot;This is a: {}&quot;, text)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let fn_plain = create_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let mut fn_mut = create_fnmut();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn_plain();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn_mut();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51344-é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸ">5.13.4.4. é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸ<a href="#51344-é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" class="hash-link" aria-label="5.13.4.4. é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸçš„ç›´æ¥é“¾æ¥" title="5.13.4.4. é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">trait DoSomething&lt;T&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn do_sth(&amp;self, value: T);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¸º&amp;usizeç±»å‹å®ç°äº†è¯¥ trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;&#x27;a, T: Debug&gt; DoSomething&lt;T&gt; for &amp;&#x27;a usize {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn do_sth(&amp;self, value: T) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;{:?}&quot;, value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ³›å‹ trait ä½œä¸º trait objectæ—¶éœ€è¦æ ‡æ³¨ç”Ÿå‘½å‘¨æœŸå‚æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¿™é‡Œç”Ÿå‘½å‘¨æœŸå‚æ•°è®©ç¼–è¯‘å™¨è¯¯è§£: æŠŠ foo çš„ç”Ÿå‘½å‘¨æœŸå’Œå†…éƒ¨ s çš„ç”Ÿå‘½å‘¨æœŸå…³è”èµ·æ¥, å³åœ¨ foo()è°ƒç”¨çš„ ç”Ÿå‘½å‘¨æœŸå†…, s å¿…é¡»å§‹ç»ˆæœ‰æ•ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//ç„¶è€Œ b å†…éƒ¨çš„ &amp;usizeå¼•ç”¨ æœ¬æ¥åº”è¯¥å’Œ foo å‡½æ•°æ²¡æœ‰ä»»ä½•å…³ç³»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn foo&lt;&#x27;a&gt;(b: Box&lt;DoSomething&lt;&amp;&#x27;a usize&gt;&gt;) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s: usize = 10;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // s åœ¨ foo å‡½æ•°è°ƒç”¨ç»“æŸåå°±ä¼šè¢«ææ„ï¼Œä»è€Œ&amp;så°±ä¼šå˜ æˆæ‚¬å‚æŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b.do_sth(&amp;s) // error[E0597]: `s` does not live long enough</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ­£ç¡®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// é«˜é˜¶ç”Ÿå‘½å‘¨æœŸ (Higher-Ranked Lifetime)è¯­æ³•: for&lt;&#x27;f&gt; , è¡¨ç¤ºæ­¤ç”Ÿå‘½å‘¨æœŸå‚æ•°åªé’ˆå¯¹å…¶åé¢æ‰€è·Ÿ ç€ çš„â€œå¯¹è±¡&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¿™é‡Œåœ¨ box å†…éƒ¨å£°æ˜ä¸€ä¸ªå‘¨æœŸæ³¨é‡Š, æ ‡æ³¨ &amp;usize, å’Œ å¤–å±‚çš„bar å‡½æ•°æ— å…³</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn bar(b: Box&lt;for&lt;&#x27;f&gt; DoSomething&lt;&amp;&#x27;f usize&gt;&gt;) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s: usize = 10;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b.do_sth(&amp;s);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let x  = Box::new(&amp;2usize);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    foo(x); // ç›¸å½“äº let _a = foo(x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar(x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ¨¡æ‹Ÿé—­åŒ…çš„è¡Œä¸º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Pick&lt;F&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    data: (u32, u32),// å­˜å‚¨é—­åŒ…å‚æ•° </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    func: F, // å­˜å‚¨é€»è¾‘è¡Œä¸º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;F&gt; Pick&lt;F&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // traité™å®šä¸­ä½¿ç”¨äº† å¼•ç”¨ç±»å‹, ç¼–è¯‘å™¨è‡ªåŠ¨ä¸ºå…¶è¡¥é½äº†ç”Ÿå‘½å‘¨æœŸå‚æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    where F: Fn(&amp;(u32, u32)) -&gt; &amp;u32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ˜¾å¼æŒ‡å®šå‘¨æœŸå‚æ•°:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    where F: for&lt;&#x27;f&gt; Fn(&amp;&#x27;f (u32, u32)) -&gt; &amp;&#x27;f u32, // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç”Ÿå‘½å‘¨æœŸå‚æ•°å¯çœç•¥    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn call(&amp;self) -&gt; &amp;u32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (self.func)(&amp;self.data)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è‹¥è¦æ·»åŠ å‘¨æœŸå‚æ•°, è¿™ç§æ˜¯é”™è¯¯çš„:  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn call&lt;&#x27;a&gt;(&amp;â€™a self)ä¸€ã€‰&amp;â€™a u32, //ä¸èƒ½è®© callæ–¹æ³•è‡ªèº«çš„ç”Ÿå‘½å‘¨æœŸå’Œ self.funcæ–¹æ³•çš„ç”Ÿå‘½å‘¨æœŸç›¸å…³è”, å› ä¸ºé—­åŒ… çš„æ•è·å¼•ç”¨æ˜¯ä»å¤–éƒ¨ç¯å¢ƒè·å–çš„ï¼Œå’Œ call æ–¹æ³•æ²¡æœ‰å…³ç³»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn max(data: &amp;(u32, u32)) -&gt; &amp;u32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    if data.0 &gt; data.1{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &amp;data.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }else{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &amp;data.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let elm = Pick { data: (3, 1), func: max };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   println!(&quot;{}&quot;, elm.call());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5135-è¿­ä»£å™¨">5.13.5. è¿­ä»£å™¨<a href="#5135-è¿­ä»£å™¨" class="hash-link" aria-label="5.13.5. è¿­ä»£å™¨çš„ç›´æ¥é“¾æ¥" title="5.13.5. è¿­ä»£å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51351-ä»€ä¹ˆæ˜¯è¿­ä»£å™¨">5.13.5.1. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨<a href="#51351-ä»€ä¹ˆæ˜¯è¿­ä»£å™¨" class="hash-link" aria-label="5.13.5.1. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨çš„ç›´æ¥é“¾æ¥" title="5.13.5.1. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>é—­åŒ…æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ï¼Œ åœ¨éå†é›†åˆå®¹å™¨ä¸­çš„å…ƒç´ çš„åŒæ—¶ï¼ŒæŒ‰é—­åŒ…å†… æŒ‡å®šçš„é€»è¾‘è¿›è¡Œæ“ä½œ, å³è¿­ä»£å™¨</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// è¿­ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// è¿­ä»£å™¨æ˜¯æƒ°æ€§çš„, è°ƒç”¨æ–¹æ³•ä½¿ç”¨è¿­ä»£å™¨å‰, ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// æ¯ä¸ªè¿­ä»£å™¨éƒ½å®ç° Iterator trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// trait Iterator {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///     // è¿™é‡Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨ æ³›å‹å‘¢? è‹¥ç”¨æ³›å‹è¯­æ³•, ä¼šé€ æˆè¿™æ ·çš„ç»“æœ: ä½¿ç”¨è€…å¯ä»¥é€šè¿‡æ³›å‹, ä¸ºä¸€ä¸ª struct å®ç°å¤šç§ Iterator trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///     // è°ƒç”¨æ—¶, ç¼–è¯‘å™¨æ— æ³•çŸ¥é“ä½¿ç”¨å“ªä¸ª trait å®ç°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///     type Item;// å…³è”å…ƒç´ ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///     // éœ€è¦å®ç°çš„æ–¹æ³• (è¦åŒ…å«ä¸¤ä¸ªè¦ç‚¹: 1. åˆ°è¾¾æŸä¸ªæ¡ä»¶è¿”å› none; 2. è¿”å› cur; 3. è®¡ç®—ä¸‹ä¸€æ­¥çš„å€¼, èµ‹ç»™ cur)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///     fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// for ç»“æ„ä¼šä½¿ç”¨ .into_iterator() æ–¹æ³•å°†ä¸€äº›é›†åˆç±»å‹ è½¬æ¢ä¸ºè¿­ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¤–éƒ¨è¿­ä»£å™¨ (External Iterator): åœ¨å®¹å™¨å¤–éƒ¨, å¯ä»¥æ§åˆ¶æ•´ä¸ªè¿­ä»£è¿‡ç¨‹ (å¦‚æ‰‹åŠ¨è°ƒç”¨ next() è·å–ä¸‹ä¸€ä¸ªå…ƒç´ )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å†…éƒ¨è¿­ä»£å™¨ (internal Iterator):é€šè¿‡è¿­ä»£å™¨è‡ªèº«æ¥æ§åˆ¶è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¤–éƒ¨æ— æ³•å¹²é¢„, ä¸€æ—¦å¼€å§‹, å¿…é¡»å…¨éƒ¨è¿­ä»£å®Œæ¯•æ‰èƒ½ç»“æŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¤–éƒ¨è¿­ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v = vec![1, 2, 3, 4, 5];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // forå¾ªç¯æ˜¯ä¸€ä¸ªå…¸å‹çš„å¤–éƒ¨è¿­ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å…¶å®æ˜¯ä¸€ä¸ªè¯­æ³•ç³–, åº•å±‚å®ç°æ˜¯ into_iteræ–¹æ³•å£°æ˜äº†ä¸€ä¸ªå¯å˜è¿­ä»£å™¨ iterator</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for i in v {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;{}&quot;, i);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç­‰ä»·äº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v = vec![1, 2, 3, 4, 5];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {  // ç­‰ä»·äºforå¾ªç¯çš„scope</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut _iterator = v.into_iter();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        loop {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            match _iterator.next() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                Some(i) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    println!(&quot;{}&quot;, i);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">               None =&gt; break,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Stepper {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    cur: i32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    step: i32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    max: i32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Iterator for Stepper {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    type Item = i32;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if self.cur &gt; self.max {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            return None;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let resp = self.cur;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.cur += self.step;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Some(resp)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let stepper = Stepper {cur: 0, step: 1, max: 9};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stepper.into_iter().for_each(|it| println!(&quot;{}&quot;, it)); </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è‡ªå®šä¹‰å†…éƒ¨è¿­ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait InIterator&lt;T: Copy&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn each&lt;F: Fn(T) -&gt; T&gt;(&amp;mut self, f: F);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;T: Copy&gt; InIterator&lt;T&gt; for Vec&lt;T&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn each&lt;F: Fn(T) -&gt; T&gt;(&amp;mut self, f: F) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut i = 0;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        while i &lt; self.len() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            self[i] = f(self[i]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            i += 1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut v = vec![1,2,3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.each(|i| i * 3);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!([3, 6, 9], &amp;v[..3]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51352-iterator-trait">5.13.5.2. Iterator trait<a href="#51352-iterator-trait" class="hash-link" aria-label="5.13.5.2. Iterator traitçš„ç›´æ¥é“¾æ¥" title="5.13.5.2. Iterator traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">iter_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è·å–è¿­ä»£å™¨æ—¶, æ ¹æ®å¯¹æºå®¹å™¨çš„å¤„ç†, å¯ä»¥åˆ†ä¸ºå‡ ç±»è¿­ä»£å™¨:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - Intolterï¼Œè½¬ç§»æ‰€æœ‰æƒï¼Œå¯¹åº” selfã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - Iterï¼Œ è·å¾—ä¸å¯å˜å€Ÿç”¨ ï¼Œ å¯¹åº”&amp;selfã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - IterMutï¼Œè·å¾—å¯å˜å€Ÿç”¨ï¼Œå¯¹åº”&amp; mut selfã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Iterå’Œ IterMutè¿­ä»£å™¨çš„å…¸å‹åº”ç”¨å°±æ˜¯ slice </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ç‰¹æ®Šçš„: Drain è¿­ä»£å™¨, Stringç±»å‹å’Œ HashMap ç‰¹æœ‰, å¯ä»¥è¿­ä»£åˆ é™¤æŒ‡å®šèŒƒå›´å†…çš„å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›¸åº”çš„å°±æœ‰å¤šä¸ªè·å–è¿­ä»£å™¨çš„æ–¹æ³•:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// iter() è¿­ä»£å‡ºå¼•ç”¨, è¿­ä»£å‡ºçš„ç±»å‹ä¸º &amp;T</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// iter_mut() è¿­ä»£å‡ºå¯å˜å¼•ç”¨, ç±»å‹ä¸º  &amp;mut T</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// into_iter() è¿­ä»£å‡ºå€¼, ä¸æ˜¯å¼•ç”¨, åŸå§‹æ•°æ®æºçš„å…ƒç´ æ‰€æœ‰æƒå˜æ›´ (æ¨è)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//size_hint() (usize, Option&lt;usize&gt;)ï¼Œæ­¤å…ƒç»„è¡¨ç¤ºè¿­ä»£å™¨å‰©ä½™é•¿åº¦çš„è¾¹ç•Œä¿¡æ¯, å…ƒç´  1: ä¸‹é™, å…ƒç´  2: ä¸Šé™, é»˜è®¤è¿”å› (0, None)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//       ç”¨æ¥å’Œå®¹å™¨åˆä½œæ—¶, ç²¾ç¡®çš„æ‹“å±•å®¹å™¨å®¹é‡, ä»è€Œé¿å…ä¸å¿…è¦çš„å®¹é‡æ£€æŸ¥ï¼Œæé«˜æ€§èƒ½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//          å¯¹äºæ•°ç»„, ä¸Šä¸‹é™æ˜¯ç›¸åŒçš„, ä»£è¡¨è¿­ä»£å™¨å½“å‰æŒ‡é’ˆåˆ°æœ«å°¾æŒ‡é’ˆçš„è·ç¦»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> ele </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç­‰åŒäº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ele</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿­ä»£å‡ºçš„ç±»å‹ä¸º &amp;i32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> it </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">//`for` éå† `Iterator` ç›´åˆ°è¿”å› `None`ï¼Œæ¯ä¸ª `Some` å€¼éƒ½è¢«è§£åŒ…ï¼ˆunwrapï¼‰ï¼Œç„¶åç»‘å®šç»™ä¸€ä¸ªå˜é‡, è¿™é‡Œæ˜¯ &quot;_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> it</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦ it å¯å˜, è§£å¼•ç”¨å¯çœç•¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿­ä»£å‡ºå¯å˜å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> it_mut </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦ v ä¸º å¯å˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> ele_first </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> it_mut</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">ele_first </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦å†™æ“ä½œ, å…ˆè§£å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;v = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// [100,2,3]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿­ä»£å™¨çš„ä¸Šä¸‹é™, è¡¨ç¤º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> iter </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">size_hint</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//çš„å‰©ä½™é•¿åº¦å°±ä¼šå‡å°‘ï¼Œ ç›´åˆ°å‡ä¸º 0ä¸ºæ­¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">size_hint</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨è¿­ä»£å™¨è¿½åŠ å­—ç¬¦ä¸²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> message </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    message </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">extend</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27; &#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;R&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;u&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;s&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;t&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™ä¸ªæ–¹æ³•é‡Œé¢å°±ç”¨åˆ°äº† size_hint ç”¨äº String æ‰©å®¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">â€ </span><span class="token class-name" style="color:rgb(38, 127, 153)">Hello</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rust</span><span class="token plain">â€ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain"> message </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Intolterator trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¹¶æ²¡æœ‰ä¸º[T]ç±»å‹å®ç° IntoIteratorï¼Œéœ€è¦è°ƒç”¨ iter() ç”Ÿæˆè¿­ä»£å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸º&amp;â€™a [T]å’Œ&amp;â€™a mut [T]ç±»å‹å®ç° äº† Intoiterator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">arr </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ±‚å’Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> total</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;total = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> total</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `take(n)` æ–¹æ³•æå– `Iterator` çš„å‰ `n` é¡¹ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `skip(n)` æ–¹æ³•ç§»é™¤å‰ `n` é¡¹ï¼Œä»è€Œç¼©çŸ­äº† `Iterator` </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51353-è¿­ä»£å™¨é€‚é…å™¨-æ”¶é›†å™¨-å‡½æ•°å¼é£æ ¼">5.13.5.3. è¿­ä»£å™¨é€‚é…å™¨ æ”¶é›†å™¨ å‡½æ•°å¼é£æ ¼<a href="#51353-è¿­ä»£å™¨é€‚é…å™¨-æ”¶é›†å™¨-å‡½æ•°å¼é£æ ¼" class="hash-link" aria-label="5.13.5.3. è¿­ä»£å™¨é€‚é…å™¨ æ”¶é›†å™¨ å‡½æ•°å¼é£æ ¼çš„ç›´æ¥é“¾æ¥" title="5.13.5.3. è¿­ä»£å™¨é€‚é…å™¨ æ”¶é›†å™¨ å‡½æ•°å¼é£æ ¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿­ä»£å™¨çš„é€‚é…å™¨, é€‚é…å™¨éƒ½ä¼šè¿”å›æ–°çš„é›†åˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Mapï¼Œé€šè¿‡å¯¹åŸå§‹æ³¨ä»£å™¨ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨æŒ‡å®š é—­åŒ…æ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Chainï¼Œé€šè¿‡è¿æ¥ä¸¤ä¸ªè¿­ä»£å™¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Clonedï¼Œé€šè¿‡æ‹·è´åŸå§‹è¿­ä»£å™¨ä¸­å…¨éƒ¨å…ƒç´ æ¥åˆ›å»ºæ–°çš„è¿­ä»£å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Cycleï¼Œåˆ›å»ºä¸€ä¸ªæ°¸è¿œå¾ªç¯è¿­ä»£çš„è¿­ä»£å™¨ï¼Œå½“å®Œæ¯•å ï¼Œå†è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹æ³•ä»£ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Enumerateï¼Œåˆ›å»ºä¸€ä¸ªåŒ…å«è®¡æ•°çš„è¿­ä»£å™¨ï¼Œå®ƒä¼šè¿”å› ä¸€ä¸ªå…ƒç»„(i,val)ï¼Œ å…¶ä¸­ i æ˜¯ usize ç±»å‹ ï¼Œä¸ºè¿­ä»£çš„ å½“å‰ç´¢ å¼•ï¼Œ val æ˜¯è¿­ä»£å™¨è¿”å› çš„å€¼ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Filterï¼Œåˆ›å»ºä¸€ä¸ªåŸºäºè°“è¯åˆ¤æ–­å¼( predicateï¼Œäº§ç”Ÿå¸ƒå°”å€¼çš„è¡¨è¾¾å¼)è¿‡æ»¤å…ƒç´ çš„è¿­ä»£å™¨ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ FlatMapï¼Œåˆ›å»ºä¸€ä¸ªç±»ä¼¼ Map çš„ç»“æ„çš„æ³•ä»£å™¨ï¼Œä½†æ˜¯å…¶ä¸­ä¸ä¼šå«æœ‰ä»»ä½•åµŒå¥—ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ FilterMapï¼Œç›¸å½“äº Filterå’Œ Mapä¸¤ä¸ªæ³•ä»£å™¨ä¾æ¬¡ä½¿ç”¨åçš„æ•ˆæœã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Fuseï¼Œåˆ›å»ºä¸€ä¸ªå¯ ä»¥å¿«é€Ÿç»“æŸéå† çš„è¿­ä»£å™¨ã€‚åœ¨éå†è¿­ä»£å™¨æ—¶ï¼Œåª è¦è¿”å›è¿‡ä¸€æ¬¡ None,é‚£ä¹ˆä¹‹åæ‰€æœ‰çš„éå†ç»“æœéƒ½ä¸º Noneã€‚è¯¥è¿­ä»£å™¨é€‚é…å™¨å¯ä»¥ç”¨äºä¼˜åŒ–ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // â€¢ Revï¼Œåˆ› å»ºä¸€ ä¸ªå¯ä»¥åå‘éå†çš„è¿­ä»£å™¨ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // map, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // Mapæ˜¯ä¸€ä¸ªæ³›å‹ç»“æ„ä½“ï¼Œå®ƒåªæœ‰ä¸¤ä¸ªæˆå‘˜å­—æ®µï¼Œä¸€ä¸ªæ˜¯iterï¼Œ ä¸€ä¸ªfï¼Œ åˆ†åˆ«å­˜ å‚¨çš„æ˜¯è¿­ä»£å™¨å’Œä¼ å…¥çš„é—­åŒ…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å®ç°äº† Iterator trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let a = [1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut iter =a.into_iter() .map(|x| 2 * x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let arr1 = [1, 2, 3, 4, 5];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let c1 = arr1.iter().map(|x| 2 * x).collect::&lt;Vec&lt;i32&gt;&gt;();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(&amp;c1[..], [2, 4, 6, 8, 10]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let arr2 = [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;h&quot;];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let c2 = arr2.iter().filter_map(|x| x.parse().ok()).collect::&lt;Vec&lt;i32&gt;&gt;();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(&amp;c2[..], [1,2,3]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let arr3 = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   for (idx, val) in arr3.iter().enumerate() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       println!(&quot;idx: {:?}, val: {}&quot;, idx, val.to_uppercase());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v = vec![1,2,3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let scaled : Vec&lt;i32&gt; = v.iter().map(|&amp;x| x * 10).collect(); // è¿”å›æ–°çš„ vec, åŸå§‹ vec ä¸å—å½±å“, x ä¸åŠ &amp;äº¦å¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;scaled = {:?}&quot;, scaled);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let scaled1: Vec&lt;_&gt; = v.iter_mut().map(|&amp;mut x| x* 10).collect(); //ç­‰æ•ˆ, è¿”å›æ–°çš„ vec, ä¸æ”¹å˜åŸå§‹ v</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;scaled1 = {:?}&quot;, scaled1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;v = {:?}&quot;,v);//ä¸å˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let plused: Vec&lt;_&gt; = scaled.into_iter().map(|x| x +1).collect();// è·å–scaled æ‰€æœ‰æƒ,  ç›´æ¥åœ¨åŸå§‹å€¼ä¸Šä¿®æ”¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;plused = {:?}&quot;, plused);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // filter</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let filtered: Vec&lt;_&gt; = v.into_iter().filter(|&amp;x| x &gt; 3).collect();// ç›´æ¥åœ¨åŸå§‹ vec ä¸Šä¿®æ”¹, v æ‰€æœ‰æƒå¤±æ•ˆ // å­˜ç–‘, ä¸ºä»€ä¹ˆéœ€è¦ &amp;x</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;filtered = {:?}&quot;, filtered); // [100]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;v = {:?}&quot;, v); // é”™è¯¯, into_iter() ä½¿å¾— v å¤±å»å€¼å¾—æ‰€æœ‰æƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // é€†åº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut iter= a.iter().rev()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    iter.next();//ä»åå‘å¼€å§‹è¿­ä»£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // é€šè¿‡ æ™®é€šè¿­ä»£å™¨çš„ next_back() æ–¹æ³•åå‘è¿­ä»£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // next() å’Œ next_back() æœ‰å„è‡ªç‹¬ç«‹çš„æŒ‡é’ˆ, äº’ä¸å½±å“, ä½†æ˜¯å½“æŒ‡é’ˆç›¸é‡æ—¶, å°±è¿­ä»£ä¸å‡ºå€¼äº†, è¿”å› none</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ”¶é›†å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // any è°“è¯, åˆ¤æ–­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // é—­åŒ…å‚æ•°ä¸º å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v = vec![1,2,3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let contain = v.iter().any(|&amp;x| x == 2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;contains 2?  : {}&quot;, contain);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let contain = v.into_iter().any(|x| x == 3);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;contains 3?  : {}&quot;, contain);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let a = [1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(a.iter().any(|&amp;x| x != 2), true);// å­˜åœ¨ä¸ä¸º 2 çš„å…ƒç´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let arr = [1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let result1 = arr.iter().any(|&amp;x| x != 2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let result2 = arr.iter().any(|x| *x != 2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // error:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // the trait bound `&amp;{integer}: std::cmp::PartialEq&lt;{integer}&gt;` is not satisfied</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let result2 = arr.iter().any(|x| x != 2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(result1, true);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(result2, true);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // fold</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // é—­åŒ…å‚æ•°ä¸ºå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let arr = vec![1, 2, 3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sum1 = arr.iter().fold(0, |acc, x| acc + x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sum2 = arr.iter().fold(0, |acc, x| acc + *x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sum3 = arr.iter().fold(0, |acc, &amp;x| acc + x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sum4 = arr.into_iter().fold(0, |acc, x| acc + x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(sum1, 6);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(sum2, 6);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(sum3, 6);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   assert_eq!(sum4, 6);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // find æŸ¥æ‰¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v = vec![1,2,3];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let find2 = v.iter().find(|&amp;&amp;x| x == 2).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;find2 = {}&quot;, find2);//2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let find3 = v.into_iter().find(|&amp;x| x == 3).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;find2 = {}, find3 = {}&quot;, find2, find3);// å‡ºé”™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;find3 = {}&quot;, find3);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å‡½æ•°å¼é£æ ¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let upper = 3;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sum: u32 =(0..).map(|n| n * n)             // æ‰€æœ‰è‡ªç„¶æ•°å–å¹³æ–¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             .take_while(|&amp;n| n &lt; upper) // å–å°äºä¸Šé™çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             .filter(|&amp;n| is_odd(n))     // å–å¥‡æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             .fold(0, |sum, i| sum + i); // æœ€ååŠ èµ·æ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;sum = {}&quot;, sum);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¤„ç†è¿­ä»£ä¸­çš„é”™è¯¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let strings = vec![&quot;tofu&quot;, &quot;93&quot;, &quot;18&quot;];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let possible_numbers: Vec&lt;_&gt; = strings</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .into_iter()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .map(|s| s.parse::&lt;i32&gt;())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .filter_map(Result::ok) // è¿‡æ»¤å‡ºæˆåŠŸçš„result</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .collect();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;Results: {:?}&quot;, possible_numbers);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¦å¤–çš„å¤„ç†æ–¹å¼:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //Result å®ç°äº† FromIter, Vec&lt;Result&lt;T, E&gt;&gt;å¯ä»¥è½¬ä¸º Result&lt;Vec&lt;T&gt;, E&gt;, ä¸€æ—¦æ‰¾åˆ°ä¸€ä¸ª Result::Err ï¼Œéå†å°±è¢«ç»ˆæ­¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let strings = vec![&quot;tofu&quot;, &quot;93&quot;, &quot;18&quot;];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let numbers: Result&lt;Vec&lt;_&gt;, _&gt; = strings</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .into_iter()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .map(|s| s.parse::&lt;i32&gt;())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .collect();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;Results: {:?}&quot;, numbers);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //åˆ†ç»„æ”¶é›†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let strings = vec![&quot;tofu&quot;, &quot;93&quot;, &quot;18&quot;];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let (numbers, errors): (Vec&lt;_&gt;, Vec&lt;_&gt;) = strings</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .into_iter()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .map(|s| s.parse::&lt;i32&gt;())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .partition(Result::is_ok);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let numbers: Vec&lt;_&gt; = numbers.into_iter().map(Result::unwrap).collect();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let errors: Vec&lt;_&gt; = errors.into_iter().map(Result::unwrap_err).collect();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;Numbers: {:?}&quot;, numbers);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;Errors: {:?}&quot;, errors);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51354-è‡ªå®šä¹‰è¿­ä»£å™¨">5.13.5.4. è‡ªå®šä¹‰è¿­ä»£å™¨<a href="#51354-è‡ªå®šä¹‰è¿­ä»£å™¨" class="hash-link" aria-label="5.13.5.4. è‡ªå®šä¹‰è¿­ä»£å™¨çš„ç›´æ¥é“¾æ¥" title="5.13.5.4. è‡ªå®šä¹‰è¿­ä»£å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è‡ªå®šä¹‰ iterator</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct Counter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        count: u32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        max: u32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl Counter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn new(max: u32) -&gt; Self {// new æ–¹æ³•ä¸èƒ½æ”¾åˆ°ä¸‹é¢çš„ iterator å®ç°ä¸­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Counter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                count: 0,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                max</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl Iterator for Counter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        type Item = u32;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            self.count += 1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if self.count &lt;= self.max {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                Some(self.count)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            } else {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                None</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut counter = Counter::new(5);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    loop {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if let Some(count) = counter.next() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;count = {}&quot;, count);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            break;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51355-è‡ªå®šä¹‰é€‚é…å™¨-æ”¶é›†å™¨">5.13.5.5. è‡ªå®šä¹‰é€‚é…å™¨ æ”¶é›†å™¨<a href="#51355-è‡ªå®šä¹‰é€‚é…å™¨-æ”¶é›†å™¨" class="hash-link" aria-label="5.13.5.5. è‡ªå®šä¹‰é€‚é…å™¨ æ”¶é›†å™¨çš„ç›´æ¥é“¾æ¥" title="5.13.5.5. è‡ªå®šä¹‰é€‚é…å™¨ æ”¶é›†å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç¬¬ä¸‰æ–¹åŒ…Itertools äº¦å¯å®ç°è‡ªå®šä¹‰é€‚é…å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::iter::FromIterator;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Debug)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct MyVec(Vec&lt;i32&gt;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl MyVec {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; MyVec {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        MyVec(Vec::new())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn add(&amp;mut self, elem: i32) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.0.push(elem);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ç°FromIteratorå°±å¯ä»¥æ‹¥æœ‰Collectçš„èƒ½åŠ›</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl FromIterator&lt;i32&gt; for MyVec {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   fn from_iter&lt;I: IntoIterator&lt;Item = i32&gt;&gt;(iter: I) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       let mut c = MyVec::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       for i in iter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           c.add(i);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let iter = (0..5).into_iter();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    ç›´æ¥è°ƒç”¨ MyVec::from_iteræ–¹æ³•å’Œä½¿ç”¨ collectæ–¹æ³•çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let c = MyVec::from_iter(iter);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   assert_eq!(c.0, vec![0, 1, 2, 3, 4]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let iter = (0..5).into_iter();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let c: MyVec = iter.collect();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   assert_eq!(c.0, vec![0, 1, 2, 3, 4]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let iter = (0..5).into_iter();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let c = iter.collect::&lt;MyVec&gt;();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   assert_eq!(c.0, vec![0, 1, 2, 3, 4]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è‡ªå®šä¹‰é€‚é…å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æŒ‰æŒ‡å®šæ­¥æ•°è¿­ä»£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Clone, Debug)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[must_use = &quot;iterator adaptors are lazy and do nothing unless consumed&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct Step&lt;I&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    iter: I,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    skip: usize,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;I&gt; Iterator for Step&lt;I&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    where I: Iterator,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    type Item = I::Item;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn next(&amp;mut self) -&gt; Option&lt;I::Item&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let elt = self.iter.next();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if self.skip &gt; 0 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            self.iter.nth(self.skip - 1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       elt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// äº§ç”Ÿ Stepé€‚é…å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn step&lt;I&gt;(iter: I, step: usize) -&gt; Step&lt;I&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    where I: Iterator,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(step != 0);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Step {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        iter: iter,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            skip: step - 1,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®šä¹‰äº†ä¸€ä¸ªç»§æ‰¿è‡ª Iterator çš„å­ trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub trait IterExt: Iterator {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn step(self, n: usize) -&gt; Step&lt;Self&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        where Self: Sized,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        step(self, n)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;T: ?Sized&gt; IterExt for T where T: Iterator {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let arr = [1,2,3,4,5,6];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sum = arr.iter().step(2).fold(0, |acc, x| acc + x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(9, sum); // [1, 3, 5]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="514-æ¡ä»¶å¾ªç¯">5.14. æ¡ä»¶å¾ªç¯<a href="#514-æ¡ä»¶å¾ªç¯" class="hash-link" aria-label="5.14. æ¡ä»¶å¾ªç¯çš„ç›´æ¥é“¾æ¥" title="5.14. æ¡ä»¶å¾ªç¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">condition_loop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// if ç”¨åœ¨ let å¥å­ä¸­, è¿”å›å€¼ç±»å‹ç›¸åŒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> c </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;c = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// while å¾ªç¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­»å¾ªç¯ä¸è¦ä½¿ç”¨ while true, å› ä¸ºè‹¥åœ¨ å¾ªç¯ä½“ä¸­ return xx; ç¼–è¯‘å™¨ä¼šè®¤ä¸ºæ— æ•ˆ, ç¼–è¯‘å™¨åªä¼šè®¤ä¸º while true ä¼šè¿”å›ç©ºå³ &quot;()&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> d </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">while</span><span class="token plain"> d </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;d = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        d </span><span class="token operator" style="color:rgb(0, 0, 0)">-=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// for å¾ªç¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> ele </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a[{}] = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ele</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸åŒ…æ‹¬å°¾å·´, 0..3 æ˜¯ä¸€ä¸ª Range ç±»å‹, æ˜¯ä¸€ä¸ª iterator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a[{}] = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//loop å¾ªç¯ æ­»å¾ªç¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;R&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;U&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;N&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;O&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;O&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> ch </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> ch </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;O&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">break</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;O index = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¦è¿”å›å€¼çš„ loop å¾ªç¯, ç”¨break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> location </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token char" style="color:rgb(129, 31, 63)">&#x27;O&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">break</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;O index = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> location</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="515-æ³›å‹">5.15. æ³›å‹<a href="#515-æ³›å‹" class="hash-link" aria-label="5.15. æ³›å‹çš„ç›´æ¥é“¾æ¥" title="5.15. æ³›å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5151-å•æ€åŒ–">5.15.1. å•æ€åŒ–<a href="#5151-å•æ€åŒ–" class="hash-link" aria-label="5.15.1. å•æ€åŒ–çš„ç›´æ¥é“¾æ¥" title="5.15.1. å•æ€åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å•æ€åŒ–æ˜¯ç¼–è¯‘å™¨ è¿›è¡Œé™æ€åˆ†å‘ çš„ä¸€ç§ç­–ç•¥, ç¼–è¯‘å™¨è¦å°†ä¸€ä¸ªæ³›å‹å‡½æ•°ç”Ÿ æˆå¤šä¸ªå…·ä½“ç±»å‹å¯¹åº”çš„å‡½æ•°</p><p>å¥½å¤„æ˜¯æ€§èƒ½å¥½ ï¼Œ æ²¡æœ‰è¿è¡Œ æ—¶å¼€é”€;ç¼ºç‚¹æ˜¯å®¹æ˜“é€ æˆç¼–è¯‘åç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶è†¨èƒ€ (å¦‚ æœå˜å¾—å¤ª å¤§ï¼Œå¯ä»¥æ ¹ æ®å…·ä½“çš„æƒ…å†µé‡æ„ä»£ç æ¥è§£å†³é—®é¢˜)</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5152-å¤šé‡çº¦æŸ-åŠ å·">5.15.2. å¤šé‡çº¦æŸ åŠ å·<a href="#5152-å¤šé‡çº¦æŸ-åŠ å·" class="hash-link" aria-label="5.15.2. å¤šé‡çº¦æŸ åŠ å·çš„ç›´æ¥é“¾æ¥" title="5.15.2. å¤šé‡çº¦æŸ åŠ å·çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>trait Bound</p><p>åŒ…å« trait é™å®šçš„æ³›å‹å±äºé™æ€åˆ†å‘ï¼Œåœ¨ç¼–è¯‘æœŸé€šè¿‡å•æ€åŒ–åˆ†åˆ«ç”Ÿæˆå…·ä½“ç±»å‹çš„å®ä¾‹ï¼Œæ‰€ä»¥è°ƒç”¨ trait é™å®šä¸­çš„æ–¹æ³•ä¹Ÿéƒ½æ˜¯è¿è¡Œæ—¶é›¶æˆæœ¬çš„ï¼Œå› ä¸ºä¸éœ€è¦åœ¨è¿è¡Œæ—¶å†è¿›è¡Œæ–¹æ³•æŸ¥æ‰¾ ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// æ³›å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">generic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">largest</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialOrd</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Copy</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">list</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤šé‡çº¦æŸä½¿ç”¨ + å· (ä¸”çš„å…³ç³»)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> largest </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> list</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">ele </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> list</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> largest </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> ele </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                largest </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ele</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        largest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">ops</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">sum</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Add</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Output</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        a </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> b</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»“æ„ä½“ä¸­çš„æ³›å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Point</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Point</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">x</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æœ‰æ¡ä»¶çš„å®ç°æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">A</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™æ®µä»£ç å£°æ˜äº† A&lt;T&gt; ç±»å‹å¿…é¡»åœ¨ T å·²ç»å®ç° B å’Œ C ç‰¹æ€§çš„å‰æä¸‹æ‰èƒ½æœ‰æ•ˆå®ç°æ­¤ impl å—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">C</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">A</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">d</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨ where é‡æ„ trait çº¦æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">foo</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">R</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">R</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">where</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">A</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">K</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token class-name" style="color:rgb(38, 127, 153)">C</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">R</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5153-é»˜è®¤æ³›å‹å‚æ•°-and-å…³è”ç±»å‹">5.15.3. é»˜è®¤æ³›å‹å‚æ•° and å…³è”ç±»å‹<a href="#5153-é»˜è®¤æ³›å‹å‚æ•°-and-å…³è”ç±»å‹" class="hash-link" aria-label="5.15.3. é»˜è®¤æ³›å‹å‚æ•° and å…³è”ç±»å‹çš„ç›´æ¥é“¾æ¥" title="5.15.3. é»˜è®¤æ³›å‹å‚æ•° and å…³è”ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é»˜è®¤æ³›å‹å‚æ•°, å¦‚ stdä¸­çš„ Add trait:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// (ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å…³è”ç±»å‹çš„æ–¹å¼è€Œä¸åœ¨æ³›å‹ä¸­æŒ‡å®šä¸¤ä¸ªå‚æ•°å‘¢?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//      ä½¿ç”¨å•æ³›å‹å‚æ•°æ›´çµæ´», å¯ä¼ å¯ä¸ä¼ , ä½¿å¾—ä»£ç æ›´ç²¾ç®€)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// sometype è¡¨ç¤ºç¬¦å·å³è¾¹çš„ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Add</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">SomeType</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// Self è¡¨ç¤ºä¸ºæ³›å‹å‚æ•°æŒ‡å®šé»˜è®¤å€¼ Self (Selfæ˜¯æ¯ä¸ªtraitéƒ½å¸¦æœ‰çš„éšå¼ç±»å‹å‚æ•°, ä»£è¡¨å®ç°å½“å‰ trait çš„å…·ä½“ç±»å‹); è‹¥å®ç° add æ–¹æ³•æ²¡æœ‰æŒ‡å®šå…·ä½“æ³›å‹, åˆ™é»˜è®¤ä¸º Self</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…³è”ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> xx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">SomeType</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Output</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// string ä¹Ÿå®ç°äº† Add trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s  </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> ns </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5154-ç©ºçº¦æŸ">5.15.4. ç©ºçº¦æŸ<a href="#5154-ç©ºçº¦æŸ" class="hash-link" aria-label="5.15.4. ç©ºçº¦æŸçš„ç›´æ¥é“¾æ¥" title="5.15.4. ç©ºçº¦æŸçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç©ºçº¦æŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct Cardinal;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct BlueJay;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct Turkey;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    trait Red {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    trait Blue {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl Red for Cardinal {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl Blue for BlueJay {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿™äº›å‡½æ•°åªå¯¹å®ç°äº†ç›¸åº”çš„ trait çš„ç±»å‹æœ‰æ•ˆã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn red&lt;T: Red&gt;(_: &amp;T)   -&gt; &amp;&#x27;static str { &quot;red&quot; }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn blue&lt;T: Blue&gt;(_: &amp;T) -&gt; &amp;&#x27;static str { &quot;blue&quot; }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let cardinal = Cardinal;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let blue_jay = BlueJay;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let _turkey   = Turkey;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç”±äºçº¦æŸï¼Œ`red()` ä¸èƒ½ä½œç”¨äº blue_jay ï¼ˆè“æ¾é¸Ÿï¼‰ï¼Œåè¿‡æ¥ä¹Ÿä¸€æ ·ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;A cardinal is {}&quot;, red(&amp;cardinal));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;A blue jay is {}&quot;, blue(&amp;blue_jay));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;A turkey is {}&quot;, red(&amp;_turkey));// é”™è¯¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5155-turbofish-æ“ä½œç¬¦-and-è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼">5.15.5. turbofish æ“ä½œç¬¦ and è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼<a href="#5155-turbofish-æ“ä½œç¬¦-and-è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼" class="hash-link" aria-label="5.15.5. turbofish æ“ä½œç¬¦ and è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼çš„ç›´æ¥é“¾æ¥" title="5.15.5. turbofish æ“ä½œç¬¦ and è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // turbofishæ“ä½œç¬¦ ç±»å‹æ¨å¯¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å½“ Rust æ— æ³•ä»ä¸Šä¸‹æ–‡ä¸­è‡ªåŠ¨æ¨å¯¼å‡ºç±»å‹çš„æ—¶å€™, å¯ä»¥æ‰‹åŠ¨æŒ‡å®šç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let x = &quot;1&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(â€{:?}â€, x.parse() .unwrap()) //error, parse() æ˜¯ä¸ªæ³›å‹æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ‰‹åŠ¨æŒ‡å®šç±»å‹ rust ä¼šè‡ªåŠ¨ç±»å‹æ¨å¯¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let intx:i32= x.parse().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æˆ–è€…, é€šè¿‡ turbofish æ“ä½œç¬¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯­æ³•: ::&lt;T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!( x.parse::&lt;i32&gt;().unwrap(), 1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="516-trait">5.16. trait<a href="#516-trait" class="hash-link" aria-label="5.16. traitçš„ç›´æ¥é“¾æ¥" title="5.16. traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5161-trait-æ¦‚å¿µ">5.16.1. trait æ¦‚å¿µ<a href="#5161-trait-æ¦‚å¿µ" class="hash-link" aria-label="5.16.1. trait æ¦‚å¿µçš„ç›´æ¥é“¾æ¥" title="5.16.1. trait æ¦‚å¿µçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51611-trait-åŸºæœ¬ä½¿ç”¨">5.16.1.1. trait åŸºæœ¬ä½¿ç”¨<a href="#51611-trait-åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="5.16.1.1. trait åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.16.1.1. trait åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///ç‰¹æ€§ï¼ˆtraitï¼‰æ¦‚å¿µæ¥è¿‘äº Java ä¸­çš„æ¥å£ï¼ˆInterfaceï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">trait_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">describe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// é»˜è®¤ trait, ç±»ä¼¼ java æ¥å£é»˜è®¤å®ç°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">fn1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;default impl trait&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// user.show() ç­‰ä»·äº User: :show(&amp;user)è¿™æ ·çš„ å‡½æ•°è°ƒç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">describe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{} {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xiaoyu&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">describe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">fn1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51612-å­¤å„¿è§„åˆ™-é€šè¿‡fundamentalè§„é¿">5.16.1.2. å­¤å„¿è§„åˆ™ é€šè¿‡fundamentalè§„é¿<a href="#51612-å­¤å„¿è§„åˆ™-é€šè¿‡fundamentalè§„é¿" class="hash-link" aria-label="5.16.1.2. å­¤å„¿è§„åˆ™ é€šè¿‡fundamentalè§„é¿çš„ç›´æ¥é“¾æ¥" title="5.16.1.2. å­¤å„¿è§„åˆ™ é€šè¿‡fundamentalè§„é¿çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>orphan rule: è¦ä¸º struct b å®ç°æŸä¸ª trait a, åˆ™ a, b è‡³å°‘æœ‰ä¸€ä¸ªå¿…é¡»åœ¨å½“å‰ crate ä¸­å®šä¹‰ (ä¸èƒ½a, b éƒ½æ˜¯åœ¨åˆ«å¤„å®šä¹‰çš„æ¯”å¦‚éƒ½æ˜¯åœ¨ std ä¸­å®šä¹‰çš„)</p><p>ç›®çš„: é˜²æ­¢å¯¹åˆ«äºº crate ä¸­çš„ç±»å‹è¡Œä¸ºè¿›è¡Œç ´åæ€§æ”¹å†™</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚ è¦ä¸º u32 ç±»å‹å®ç°  add, ä½¿å¾—å¯ä»¥åŠ ä¸Š u64 ç±»å‹æ•°å­—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç›´æ¥å®ç° æ ‡å‡†åº“ä¸­çš„ Add ä¸è¡Œ, å› ä¸º u32 å’Œ Add éƒ½åœ¨å…¶ä»– crate ä¸­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// éœ€è¦è‡ªå·±å®šä¹‰ åœ¨å½“å‰ crate : ËšAdd trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å½“ç„¶ï¼Œé™¤äº†åœ¨æœ¬åœ°å®šä¹‰ Addtraitè¿™ä¸ªæ–¹æ³•ï¼Œè¿˜å¯ä»¥åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œç„¶åä¸ºæ­¤ æ–°ç±»å‹å®ç°Add</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å±€é™æ€§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹äºä¸€äº›æœ¬åœ°ç±»å‹ï¼Œ å¦‚æœå°†å…¶æ”¾åˆ°ä¸€äº›å®¹å™¨ä¸­ï¼Œæ¯”å¦‚Rc&lt;T&gt;æˆ–Option&lt;T&gt;ï¼Œ é‚£ä¹ˆè¿™äº›æœ¬åœ°ç±»å‹å°±ä¼šå˜æˆè¿œç¨‹ç±»å‹ (å› ä¸ºè¿™äº›å®¹å™¨ç±»å‹éƒ½æ˜¯åœ¨æ ‡å‡†åº“ä¸­å®šä¹‰çš„ ï¼Œ è€Œéæœ¬åœ°ã€‚)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// rust ä½¿ç”¨ #[fundamental]çš„å±æ€§æ ‡è¯†ï¼Œæ¥ä¸ºç‰¹å®šçš„trait è§„é¿å­¤å„¿é™åˆ¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  Box&lt;T&gt;ï¼Œè¿˜æœ‰ Fnã€ FnMutã€ FnOnceã€ Sized ç­‰éƒ½ä¸Šäº†#[fundamental]å±æ€§</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51613-ç‰¹åŒ–-specialization">5.16.1.3. ç‰¹åŒ– Specialization<a href="#51613-ç‰¹åŒ–-specialization" class="hash-link" aria-label="5.16.1.3. ç‰¹åŒ– Specializationçš„ç›´æ¥é“¾æ¥" title="5.16.1.3. ç‰¹åŒ– Specializationçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// é—®é¢˜: é‡å è§„åˆ™ï¼šä¸èƒ½ä¸ºé‡å çš„ç±»å‹å®ç°åŒä¸€ä¸ªtrait </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;T&gt; AnyTrait for T</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;T&gt; AnyTrait for T where T: Copy // Copy å’Œä¸Šé¢çš„ T é‡å äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;T&gt; AnyTrait for String</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è§£å†³: ç‰¹åŒ– (ç±»ä¼¼ java ä¸­çš„æ–¹æ³•é‡å†™/è¦†ç›–)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#![feature(specialization)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Diver&lt;T&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inner: T,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Swimmer {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¸¦æœ‰é»˜è®¤å®ç°çš„ æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn swim(&amp;self) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;swimming&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å…ˆä¸º Diver&lt;T&gt;å®ç°è¯¥ trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;T&gt; Swimmer for Diver&lt;T&gt; {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¸ºDiver&lt;&amp;â€™static str&gt;å®ç°äº† è¯¥ trait (ä¹Ÿå°±æ˜¯ ç‰¹æ®Šç±»å‹, ç‰¹æ®Šå¤„ç†)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Swimmer for Diver&lt;&amp;&#x27;static str&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn swim(&amp;self) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;drowning, help!&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let x = Diver::&lt;&amp;&#x27;static str&gt; { inner: &quot;Bob&quot; };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">x.swim();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let y = Diver::&lt;String&gt; { inner: String::from(&quot;Alice&quot;) };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">y.swim();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51614-trait-ä½œä¸ºå‚æ•°-éœ€è¦-impl-å‰ç¼€">5.16.1.4. trait ä½œä¸ºå‚æ•° éœ€è¦ impl å‰ç¼€<a href="#51614-trait-ä½œä¸ºå‚æ•°-éœ€è¦-impl-å‰ç¼€" class="hash-link" aria-label="5.16.1.4. trait ä½œä¸ºå‚æ•° éœ€è¦ impl å‰ç¼€çš„ç›´æ¥é“¾æ¥" title="5.16.1.4. trait ä½œä¸ºå‚æ•° éœ€è¦ impl å‰ç¼€çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ç‰¹æ€§åšå‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">describe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å†™æ³•2: (é£æ ¼ç±»ä¼¼æ³›å‹çš„è¯­æ³•ç³–)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">output</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">object</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> object</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">describe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">output_two</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arg1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arg2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arg1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">describe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arg2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">describe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//ç‰¹æ€§ä½œç±»å‹è¡¨ç¤ºæ—¶å¦‚æœæ¶‰åŠå¤šä¸ªç‰¹æ€§ï¼Œå¯ä»¥ç”¨ + ç¬¦å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">notify</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Summary</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">notify</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Summary</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//å¤æ‚çš„å®ç°å…³ç³»å¯ä»¥ä½¿ç”¨ where å…³é”®å­—ç®€åŒ–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//å¦‚: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">some_function</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">U</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Clone</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Debug</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> u</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">U</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯ä»¥ç®€åŒ–æˆï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">some_function</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">U</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> u</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">U</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">where</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">U</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Clone</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Debug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å–æœ€å¤§å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Comparable</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">compare</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> object</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">max</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Comparable</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> max_index </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">while</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> array</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> array</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">compare</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">max_index</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            max_index </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        i </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">max_index</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Comparable</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">compare</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> object</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i8</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">object </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">object </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;maximum of arr is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51615-trait-ä½œä¸º-è¿”å›å€¼-è¿”å›åŠ¨æ€ç±»å‹">5.16.1.5. trait ä½œä¸º è¿”å›å€¼ è¿”å›åŠ¨æ€ç±»å‹<a href="#51615-trait-ä½œä¸º-è¿”å›å€¼-è¿”å›åŠ¨æ€ç±»å‹" class="hash-link" aria-label="5.16.1.5. trait ä½œä¸º è¿”å›å€¼ è¿”å›åŠ¨æ€ç±»å‹çš„ç›´æ¥é“¾æ¥" title="5.16.1.5. trait ä½œä¸º è¿”å›å€¼ è¿”å›åŠ¨æ€ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç‰¹æ€§åšè¿”å›å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">person</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Cali&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­æ‰€æœ‰å¯èƒ½çš„è¿”å›å€¼ç±»å‹å¿…é¡»å®Œå…¨ä¸€æ ·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¦‚æœå¸Œæœ›è¿”å›ä¸åŒçš„struct, ä½¿ç”¨  Box&lt;dyn Animal&gt; ä½œä¸ºè¿”å›å€¼ ----- å¤šæ€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, å› ä¸º A, B è™½ç„¶éƒ½å®ç°äº† Descriptive, ä½†æ˜¯ A B æ˜¯ä¸åŒçš„ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">some_function</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token plain"> bl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> bl </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">A</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é‚£ä¹ˆå¦‚ä½•è¿”å›ä¸åŒçš„ struct?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä½¿ç”¨ Box&lt;dyn xxx&gt;, box æ˜¯ä¸€ç§æ•°æ®ç»“æ„, æ•ˆæœç±»ä¼¼å¼•ç”¨,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">random_animal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">random_number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Animal</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿”å›ç±»å‹å†…å­˜å¤§å°ç¡®å®šäº†, ç¼–è¯‘å¯ä»¥é€šè¿‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> random_number </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Sheep</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cow</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51616-trait-ç»§æ‰¿">5.16.1.6. trait ç»§æ‰¿<a href="#51616-trait-ç»§æ‰¿" class="hash-link" aria-label="5.16.1.6. trait ç»§æ‰¿çš„ç›´æ¥é“¾æ¥" title="5.16.1.6. trait ç»§æ‰¿çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Person1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Implementing Student requires you to also impl Person.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Student</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">university</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Programmer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">fav_language</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">CompSciStudent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Programmer</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Student</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">git_username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">comp_sci_student_greeting</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">student</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">CompSciStudent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;My name is {} and I attend {}. My Git username is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            student</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            student</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">university</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            student</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">git_username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è±å½¢ç»§æ‰¿é—®é¢˜: æŸä¸ª struct å®ç°ä¸¤ä¸ª trait, éœ€è¦å®ç°ä¸¤ä¸ªåŒåæ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å®Œå…¨é™å®šè¯­æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Descriptive</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">xxx_fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç±»ä¼¼äºå¼ºåˆ¶è½¬æ¢</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// çœ‹ä¾‹å­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">UsernameWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">AgeWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Form</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">UsernameWidget</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Form</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">AgeWidget</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Form</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">age</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> form </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Form</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rustacean&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// error, &quot;multiple `get` found&quot;. Because, after all, there are multiple methods named `get`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> form</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ok</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> username </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Form</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">UsernameWidget</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">form</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rustacean&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> age </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Form</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">AgeWidget</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">form</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">assert_eq!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51617-é™æ€åˆ†å‘-åŠ¨æ€åˆ†å‘">5.16.1.7. é™æ€åˆ†å‘ åŠ¨æ€åˆ†å‘<a href="#51617-é™æ€åˆ†å‘-åŠ¨æ€åˆ†å‘" class="hash-link" aria-label="5.16.1.7. é™æ€åˆ†å‘ åŠ¨æ€åˆ†å‘çš„ç›´æ¥é“¾æ¥" title="5.16.1.7. é™æ€åˆ†å‘ åŠ¨æ€åˆ†å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>impl Traitä»£è¡¨é™ æ€åˆ†å‘ ï¼Œ dyn Trait ä»£è¡¨åŠ¨æ€åˆ†å‘ ã€‚</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">      trait Fly {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn can_fly(&amp;self) -&gt; bool;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct Duck;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct Pig;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl Fly for Duck {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn can_fly(&amp;self) -&gt; bool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl Fly for Pig {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn can_fly(&amp;self) -&gt; bool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä½¿ç”¨æ³›å‹, å®šä¹‰é™æ€åˆ†å‘çš„å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç¼–è¯‘é˜¶æ®µ, æ³›å‹å·²ç»è¢«å±•å¼€ ä¸ºå…·ä½“ç±»å‹çš„ä»£ç , æ²¡æœ‰æŠ½è±¡å¼€é”€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // or å¯ä»¥ä½¿ç”¨ impl trait æ”¹å†™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn fly_static&lt;T: Fly&gt;(t: &amp;T) -&gt; bool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        t.can_fly()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä½¿ç”¨ dyn å®šä¹‰åŠ¨æ€åˆ†å‘çš„å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿è¡ŒæœŸå†³å®šåˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹, æœ‰é¢å¤–å¼€é”€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn fly_dyn(t: &amp;dyn Fly) -&gt; bool { // æŠ½è±¡ç±»å‹æ˜¯ trait object, æ˜¯æœ‰è¦æ±‚çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        t.can_fly()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let pig = Pig;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let duck = Duck;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, fly_static::&lt;Pig&gt;(&amp;pig));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, fly_dyn(&amp;duck));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51618-ä½¿ç”¨æŠ½è±¡ç±»å‹">5.16.1.8. ä½¿ç”¨æŠ½è±¡ç±»å‹<a href="#51618-ä½¿ç”¨æŠ½è±¡ç±»å‹" class="hash-link" aria-label="5.16.1.8. ä½¿ç”¨æŠ½è±¡ç±»å‹çš„ç›´æ¥é“¾æ¥" title="5.16.1.8. ä½¿ç”¨æŠ½è±¡ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="516181-traitå¯¹è±¡">5.16.1.8.1. traitå¯¹è±¡<a href="#516181-traitå¯¹è±¡" class="hash-link" aria-label="5.16.1.8.1. traitå¯¹è±¡çš„ç›´æ¥é“¾æ¥" title="5.16.1.8.1. traitå¯¹è±¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// AbstractType ExistentialType</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç›¸å¯¹äºå…·ä½“ç±»å‹è€Œè¨€ï¼ŒæŠ½è±¡ç±»å‹æ— æ³•ç›´æ¥å®ä¾‹åŒ–ï¼Œ ä½†æ˜¯å®ƒçš„æ¯ä¸ªå®ä¾‹éƒ½ æ˜¯å…·ä½“ç±»å‹çš„å®ä¾‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç¼–è¯‘å™¨å¯èƒ½æ— æ³•ç¡®å®šå…¶ç¡®åˆ‡çš„åŠŸèƒ½å’Œæ‰€å çš„ç©ºé—´å¤§ å° ã€‚ æ‰€ä»¥ Rust ç›®å‰æœ‰ä¸¤ç§æ–¹æ³•æ¥å¤„ç†æŠ½è±¡ç±»å‹: trait å¯¹è±¡å’Œ impl Trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ–¹å¼ 1: trait å¯¹è±¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Debug)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Foo;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Bar {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn baz(&amp;self);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Bar for Foo {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn baz(&amp;self) { println!(&quot;{:?}&quot;, self) }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn static_dispatch&lt;T&gt;(t: &amp;T) where T:Bar {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    t.baz();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åŠ¨æ€åˆ†å‘, æœ‰æ€§èƒ½å¼€é”€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn dynamic_dispatch(t: &amp;Bar) { // è¿™é‡Œå‚æ•°æ˜¯ä¸€ä¸ª trait object, æ— æ³•ç¡®å®šå¤§å°, å¿…é¡»ä½¿ç”¨ å¼•ç”¨ &amp; or box</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    t.baz();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let foo = Foo;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">static_dispatch(&amp;foo);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">dynamic_dispatch(&amp;foo);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¸ºä»€ä¹ˆ å°† traitå¯¹è±¡ç§°ä¸ºåŠ¨æ€ åˆ†å‘?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// std ä¸­  ä¸º trait object å®šä¹‰äº†ä¸€ä¸ª struct</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åŒ…å«è¿ä¸ªæŒ‡é’ˆ:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// 1. data ptr</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//          æŒ‡å‘ ç±»å‹æ•°æ®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// 2. vtable ptr</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//          æŒ‡å‘ virtual table (cpp ä¸­çš„æ¦‚å¿µ), å°±æ˜¯ä¸€ä¸ªç»“æ„ä½“, åŒ…å« ææ„å‡½æ•°, å¤§å°, æ–¹æ³•...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åœ¨ç¼–è¯‘æœŸ ï¼Œ ç¼–è¯‘å™¨åªçŸ¥é“ TraitObject åŒ…å«æŒ‡ é’ˆ çš„ä¿¡æ¯ ï¼Œ å¹¶ä¸”æŒ‡é’ˆçš„å¤§ å° ä¹Ÿæ˜¯ç¡®å®šçš„ ï¼Œå¹¶ ä¸çŸ¥é“ è¦ è°ƒç”¨å“ªä¸ª æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//åœ¨è¿è¡ŒæœŸ ï¼Œ å½“æœ‰ trait_object.method()æ–¹æ³•è¢«è°ƒ ç”¨æ—¶ï¼Œ TraitObject ä¼š æ ¹æ®è™šè¡¨æŒ‡é’ˆä»è™šè¡¨ä¸­æŸ¥å‡ºæ­£ç¡®çš„æŒ‡é’ˆï¼Œç„¶åå†è¿›è¡ŒåŠ¨æ€è°ƒç”¨ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="516182-traitå¯¹è±¡å®‰å…¨é—®é¢˜-sized-trait">5.16.1.8.2. traitå¯¹è±¡å®‰å…¨é—®é¢˜ Sized trait<a href="#516182-traitå¯¹è±¡å®‰å…¨é—®é¢˜-sized-trait" class="hash-link" aria-label="5.16.1.8.2. traitå¯¹è±¡å®‰å…¨é—®é¢˜ Sized traitçš„ç›´æ¥é“¾æ¥" title="5.16.1.8.2. traitå¯¹è±¡å®‰å…¨é—®é¢˜ Sized traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å¯¹è±¡å®‰å…¨çš„æœ¬è´¨å°±æ˜¯ä¸º äº†è®© trait å¯¹è±¡å¯ä»¥å®‰å…¨åœ°è°ƒç”¨ç›¸åº”çš„æ–¹æ³•</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å¹¶ä¸æ˜¯æ¯ä¸ª traitéƒ½å¯ä»¥ä½œä¸º traitå¯¹è±¡è¢«ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//æ¯ä¸ª trait, Selfé»˜è®¤æœ‰ä¸€ä¸ªéšå¼çš„ trait é™å®š ?Sized, å½¢å¦‚&lt;Self: ?Sized&gt; , ?Sized trait åŒ…æ‹¬äº†æ‰€æœ‰çš„åŠ¨æ€å¤§å°ç±»å‹å’Œæ‰€æœ‰å¯ç¡®å®šå¤§å° çš„ç±»å‹ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Rust ä¸­å¤§éƒ¨åˆ†ç±»å‹éƒ½é»˜è®¤æ˜¯å¯ç¡®å®šå¤§å°çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯&lt;T: Sized&gt;ï¼Œè¿™ä¹Ÿæ˜¯æ³›å‹ä»£ ç å¯ä»¥æ­£å¸¸ç¼–è¯‘çš„åŸå›  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å½“ traitå¯¹è±¡åœ¨è¿è¡ŒæœŸè¿›è¡ŒåŠ¨æ€åˆ†å‘ï¼Œä¹Ÿå¿…é¡»ç¡®å®šå¤§å°ï¼Œå¦åˆ™æ— æ³•ä¸ºå…¶æ­£ç¡®åˆ†é…å†…å­˜ç©º é—´ ã€‚æ‰€ ä»¥å¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤æ¡è§„åˆ™çš„ trait æ‰å¯ä»¥ä½œä¸º trait å¯¹è±¡ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  traitå¯¹è±¡ èƒ½å¤Ÿç¼–è¯‘é€šè¿‡çš„è¦æ±‚æ˜¯, trait å¿…é¡»æ˜¯å¯¹è±¡å®‰å…¨çš„, æ»¡è¶³:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// 1.  trait çš„ Selfç±»å‹å‚æ•°ä¸èƒ½è¢«é™å®šä¸º Sized, å¿…é¡»æ˜¯ é»˜è®¤çš„ ?Sized (å› ä¸º trait objec åœ¨ç¼–è¯‘æœŸæ— æ³•ç¡®å®šå…·ä½“ç±»å‹, å¤§å°æœªçŸ¥)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// 2.  trait ä¸­æ‰€æœ‰çš„æ–¹ æ³•éƒ½å¿…é¡»æ˜¯å¯¹è±¡å®‰å…¨çš„, æ»¡è¶³ä¸‰ç‚¹ä¹‹ä¸€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//          - æ–¹æ³•å— Self: Sized çº¦æŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//          - trait ä¸­ ä¸èƒ½åŒ…å«å…³è”å¸¸ é‡( Associated Constant, å…¶å®šä¹‰æ–¹æ³•å’Œå…³è”ç±»å‹å·®ä¸å¤šï¼Œ åªä¸è¿‡éœ€è¦ä½¿ç”¨ constå…³é”®å­—)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//          - æ–¹æ³•æ»¡è¶³æ²¡æœ‰é¢å¤– Selfç±»å‹å‚æ•°çš„éæ³›å‹æˆå‘˜æ–¹æ³•(åˆ†è§£å¼€æ¥å°±æ˜¯ä¸‰ç‚¹)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //          - å¿…é¡»ä¸åŒ…å«ä»»ä½•æ³›å‹å‚æ•° (å› ä¸ºå¦‚æœåŒ…å«æ³›å‹ ï¼Œtrait å¯¹ è±¡åœ¨ è™šè¡¨Vtableä¸­æŸ¥æ‰¾æ–¹æ³•æ—¶å°†ä¸ç¡®å®šè¯¥è°ƒç”¨å“ªä¸ªæ–¹æ³•)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //          - ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»ä¸º Self ç±»å‹æˆ–å¯ä»¥è§£å¼•ç”¨ä¸º Self çš„ç±»å‹ (æ¯”å¦‚ selfã€ &amp;selfã€&amp;mutselfå’Œ self: Box&lt;Selt&gt;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //          - Selfä¸èƒ½å‡ºç°åœ¨é™¤ç¬¬ä¸€ä¸ªå‚æ•°ä¹‹å¤–çš„åœ°æ–¹ï¼Œ åŒ…æ‹¬è¿”å›å€¼ä¸­ (å› ä¸ºå¦‚æœå‡ºç° Self,é‚£å°±æ„å‘³ç€ Selfå’Œ selfã€ &amp;selfæˆ–&amp;mutselfçš„ç±»å‹èƒ½å¤Ÿç›¸åŒ¹é…ã€‚ ä½†æ˜¯å¯¹äº traitå¯¹è±¡æ¥è¯´ï¼Œ æ ¹æœ¬æ— æ³•åšåˆ°ä¿è¯ç±»å‹åŒ¹é…)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¿™ä¸ªtrait å°±æ— æ³•ä½œä¸º trait objectåœ¨åŠ¨æ€åˆ†å‘ä¸­ä½¿ç”¨, ä¸æ˜¯å¯¹è±¡å®‰å…¨çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Foo: Sized {...}//è¡¨ç¤ºè¦ä¸ºæŸç±»å‹å®ç° Fooï¼Œå¿…é¡»å…ˆå®ç° Sized, Foo ä¸­ çš„éšå¼ Selfè¢«è®¾å®šä¸ºæ˜¯ Sized çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ ‡å‡†çš„å¯¹è±¡å®‰å…¨çš„ trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Bar {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn bax(self, x: u32);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     fn bay (&amp;self) ;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     fn baz (&amp;mut self) ;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å…¸å‹çš„å¯¹è±¡ä¸å®‰å…¨çš„ trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹è±¡ä¸å®‰å…¨çš„ trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Foo {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn bad&lt;T&gt;(&amp;self, x: T);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; Self;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//å¯¹è±¡å®‰å…¨çš„ trait ï¼Œ å°†ä¸å®‰å…¨ çš„æ–¹æ³•æ‹† åˆ† å‡º å»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Foo {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn bad&lt;T&gt;(&amp;self, x: T);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Bar:Foo {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; Self;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//å¯¹è±¡å®‰å…¨çš„traitï¼Œä½¿ç”¨whereå­å¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åªä¸è¿‡åœ¨ traitFooä½œä¸º traitå¯¹è±¡ä¸”æœ‰?Sizedé™å®šæ—¶ï¼Œ ä¸å…è®¸è°ƒç”¨è¯¥ newæ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Foo {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn bad&lt;T&gt;(&amp;self, x: T);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; Self where Self: Sized;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="516183-impl-trait">5.16.1.8.3. impl trait<a href="#516183-impl-trait" class="hash-link" aria-label="5.16.1.8.3. impl traitçš„ç›´æ¥é“¾æ¥" title="5.16.1.8.3. impl traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å¯ ä»¥é™æ€åˆ†å‘çš„æŠ½è±¡ç±»å‹ impl Trait, å¯ä»¥ç”¨æ¥æ›¿ä»£æ³›å‹çº¦æŸ, å¯ä»¥ä½¿ç”¨åŠ å· (impl Fly+Debug)</p><p>ç›®å‰ impl Trait åªå¯ä»¥åœ¨è¾“å…¥çš„å‚æ•¬å’Œè¿”å›å€¼è¿™ä¸¤ä¸ªä½ç½®ä½¿ç”¨</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// â€™static æ˜¯ä¸€ç§ç”Ÿå‘½å‘¨æœŸå‚æ•° ï¼Œ å®ƒé™å®šäº† impl Fly+Debug æŠ½è±¡ç±» å‹ä¸å¯èƒ½æ˜¯å¼•ç”¨ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn dyn_can_fly( s : impl Fly+Debug+ â€™static) -&gt; Box&lt;dyn Fly&gt; {}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51619-traitçš„ç±»å‹è½¬æ¢">5.16.1.9. traitçš„ç±»å‹è½¬æ¢<a href="#51619-traitçš„ç±»å‹è½¬æ¢" class="hash-link" aria-label="5.16.1.9. traitçš„ç±»å‹è½¬æ¢çš„ç›´æ¥é“¾æ¥" title="5.16.1.9. traitçš„ç±»å‹è½¬æ¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>éšå¼ç±»å‹è½¬æ¢ (Implicit Type Conversion)å’Œæ˜¾å¼ç±»å‹è½¬ æ¢ (ExplicitType Conversion)</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// éšå¼ç±»å‹è½¬æ¢åŸºæœ¬ä¸Šåªæœ‰ è‡ªåŠ¨è§£ å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¼•ç”¨ä½¿ç”¨&amp;æ“ä½œç¬¦ï¼Œ è€Œè§£å¼•ç”¨ä½¿ç”¨*æ“ä½œç¬¦ã€‚å¯ä»¥é€šè¿‡å®ç°Deref traitæ¥è‡ªå®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// as æ“ä½œç¬¦ æœ€å¸¸ç”¨çš„åœºæ™¯å°±æ˜¯è½¬æ¢ Rust ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let a: i64 = 11 as i64</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// çŸ­(å¤§å°)ç±»å‹è½¬æ¢ä¸ºé•¿(å¤§å°)ç±»å‹çš„æ—¶å€™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œ ä½† æ˜¯å¦‚æœåè¿‡æ¥ï¼Œåˆ™ä¼šè¢« æˆªæ–­å¤„ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å½“ä»æœ‰ç¬¦å·ç±»å‹ å‘æ— ç¬¦å·ç±»å‹è½¬æ¢ çš„æ—¶å€™ï¼Œ æœ€å¥½ä½¿ç”¨æ ‡å‡†åº“ä¸­æä¾›çš„ä¸“é—¨çš„æ–¹æ³•ï¼Œè€Œä¸è¦ç›´æ¥ä½¿ç”¨ asæ“ä½œç¬¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç±»å‹å’Œå­ç±»å‹ç›¸äº’è½¬æ¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç”Ÿå‘½å‘¨æœŸæ ‡è®°å¯çœ‹ä½œå­ç±»å‹ã€‚ æ¯”å¦‚&amp;â€™static strç±»å‹æ˜¯&amp;â€™a strç±»å‹çš„å­ç±» å‹; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//â€™a å’Œ &#x27;static éƒ½æ˜¯ç”Ÿå‘½å‘¨æœŸæ ‡è®°ï¼Œå…¶ä¸­â€™a æ˜¯æ³›å‹æ ‡è®°ï¼Œ æ˜¯ &amp;strçš„é€šç”¨å½¢å¼ï¼Œ è€Œâ€™staticåˆ™æ˜¯ç‰¹æŒ‡é™æ€ç”Ÿå‘½å‘¨æœŸçš„&amp;strå­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5162-å¯è‡ªåŠ¨æ¨å¯¼çš„trait">5.16.2. å¯è‡ªåŠ¨æ¨å¯¼çš„trait<a href="#5162-å¯è‡ªåŠ¨æ¨å¯¼çš„trait" class="hash-link" aria-label="5.16.2. å¯è‡ªåŠ¨æ¨å¯¼çš„traitçš„ç›´æ¥é“¾æ¥" title="5.16.2. å¯è‡ªåŠ¨æ¨å¯¼çš„traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¨å¯¼ æ´¾ç”Ÿ trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸‹é¢ä»¥ä¸‹æ˜¯å¯ä»¥è‡ªåŠ¨æ¨å¯¼çš„ trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)">/*</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Eq, PartialEq, Ord, PartialOrd (æ¯”è¾ƒç±»çš„ trait)</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Clone, ç”¨æ¥ä» &amp;T åˆ›å»ºå‰¯æœ¬ Tã€‚å½“å¤„ç†èµ„æºæ—¶ï¼Œé»˜è®¤çš„è¡Œä¸ºæ˜¯åœ¨èµ‹å€¼æˆ–å‡½æ•°è°ƒç”¨çš„åŒæ—¶å°†å®ƒä»¬è½¬ç§»ã€‚ä½†æ˜¯æˆ‘ä»¬æœ‰æ—¶å€™ä¹Ÿéœ€è¦ æŠŠèµ„æºå¤åˆ¶ä¸€ä»½ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">        - åŒ…æ‹¬ clone, colon_from æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">        - å¦‚æœä¸€ä¸ªç±»å‹æ˜¯ Copyçš„ï¼Œ å®ƒçš„cloneæ–¹æ³•ä»…éœ€è¦è¿”å›*selfå³å¯ </span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">        - ä½¿ç”¨éœ€è¦æ˜¾å¼è°ƒç”¨ clone(), è‹¥å¸Œæœ›rust ç¢°åˆ° ç­‰å·èµ‹å€¼äº†å°±è‡ªåŠ¨éšå¼è°ƒç”¨ clone() , éœ€è¦ç»™ç»“æ„ä½“åŠ ä¸Š derive(Clone, Copy), </span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Copyï¼Œä½¿ç±»å‹å…·æœ‰ â€œå¤åˆ¶è¯­ä¹‰â€ï¼ˆcopy semanticsï¼‰è€Œé â€œç§»åŠ¨è¯­ä¹‰â€ï¼ˆmove semanticsï¼‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">        copy trait æ— æ³•å•ç‹¬ä½¿ç”¨, å¿…é¡»åœ¨ Clone trait å­˜åœ¨çš„æƒ…å†µä¸‹æ‰èƒ½ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Hashï¼Œä» &amp;T è®¡ç®—å“ˆå¸Œå€¼ï¼ˆhashï¼‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Debugï¼Œä½¿ç”¨ {:?} formatter æ¥æ ¼å¼åŒ–ä¸€ä¸ªå€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Serialize Deserialize</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug, Clone, Copy)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `Centimeters`ï¼Œå¯ä»¥æ¯”è¾ƒçš„å…ƒç»„ç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(PartialEq, PartialOrd)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Centimeters</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `Inches`ï¼Œå¯ä»¥æ‰“å°çš„å…ƒç»„ç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Inches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Inches</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_centimeters</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Centimeters</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Inches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">inches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Centimeters</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">inches </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2.54</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> foot </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Inches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;One foot equals {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> foot</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> meter </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Centimeters</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">100.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> cmp </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> foot</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_centimeters</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> meter </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;smaller&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;bigger&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;One foot is {} than one meter.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `Seconds`ï¼Œä¸å¸¦é™„åŠ å±æ€§çš„å…ƒç»„ç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Seconds</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> _one_second </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Seconds</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŠ¥é”™ï¼š`Seconds` ä¸èƒ½æ‰“å°ï¼›å®ƒæ²¡æœ‰å®ç° `Debug` trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;One second looks like: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> _one_second</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŠ¥é”™ï¼š`Seconds`ä¸èƒ½æ¯”è¾ƒï¼›å®ƒæ²¡æœ‰å®ç° `PartialEq` trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> _this_is_true </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_one_second </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> _one_second</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5163-è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„trait">5.16.3. è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„trait<a href="#5163-è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„trait" class="hash-link" aria-label="5.16.3. è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„traitçš„ç›´æ¥é“¾æ¥" title="5.16.3. è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ“ä½œç¬¦é‡è½½</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¾ˆå¤šè¿ç®—ç¬¦å¯ä»¥é€šè¿‡ trait æ¥é‡è½½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è¿™äº›è¿ç®—ç¬¦å¯ä»¥æ ¹æ®å®ƒä»¬çš„ è¾“å…¥å‚æ•°æ¥å®Œæˆä¸åŒçš„ä»»åŠ¡ã€‚è¿™ä¹‹æ‰€ä»¥å¯è¡Œï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ˜¯å› ä¸ºè¿ç®—ç¬¦å°±æ˜¯æ–¹æ³•è°ƒç”¨çš„è¯­æ³•ç³–ã€‚ä¾‹ å¦‚ï¼Œa + b ä¸­çš„ + è¿ç®—ç¬¦ä¼šè°ƒç”¨ add æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯ a.add(b)ï¼‰ã€‚è¿™ä¸ª add æ–¹ æ³•æ˜¯ Add trait çš„ä¸€éƒ¨åˆ†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Add trait  é‡è½½ + è¿ç®—ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/// Deref trait é‡è½½è§£å¼•ç”¨ç¬¦å·, å°±æ˜¯ &quot;*&quot; å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//åœ¨ std::ops ä¸‹æœ‰å…¨éƒ¨é‡è½½çš„ trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨std::cmp ä¸‹åˆ™æ˜¯æ¯”è¾ƒæ“ä½œçš„æ“ä½œç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¾‹å­: å¯¹è±¡æ’åº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æœ‰å››ä¸ªTrait : Ordã€PartialOrd ã€Eq å’Œ PartialEq  ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">cmp</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token class-name" style="color:rgb(38, 127, 153)">Ord</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialOrd</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialEq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        salary </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ord</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> rhs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">rhs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialOrd</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">partial_cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> rhs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rhs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Eq</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialEq</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">eq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> rhs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">salary </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> rhs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">salary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Bob&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">     salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Alice&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">   salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3208</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Tom&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">     salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2359</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Jack&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">    salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4865</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Marray&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3743</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hao&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">     salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2964</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Employee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Chen&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">    salary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4197</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç”¨for-loopæ‰¾å‡ºè–ªæ°´æœ€å¤šçš„äºº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> e </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">e </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            e </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;max = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä½¿ç”¨æ ‡å‡†çš„æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;min = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">min</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;max = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä½¿ç”¨æ ‡å‡†çš„æ’åºæ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">sort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5164-from-å’Œ-into">5.16.4. From å’Œ Into<a href="#5164-from-å’Œ-into" class="hash-link" aria-label="5.16.4. From å’Œ Intoçš„ç›´æ¥é“¾æ¥" title="5.16.4. From å’Œ Intoçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// å®šä¹‰äº std::convert æ¨¡å—ä¸­çš„ä¸¤ä¸ª traitã€‚ å®ƒä»¬å®šä¹‰äº† from å’Œ into ä¸¤ä¸ªæ–¹ æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•äº’ä¸ºåæ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">â€helloâ€</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å…è®¸ä¼ å…¥çš„å‚æ•°æ˜¯&amp;strç±»å‹æˆ– String ç±»å‹ ï¼Œæ–¹ä¾¿è¿›è¡Œå¼€å‘ (&amp;strå’Œ Stringç±»å‹éƒ½å®ç°äº† Into, å½“å‚æ•°æ˜¯&amp;strç±»å‹æ—¶ï¼Œä¼šé€šè¿‡ intoè½¬æ¢ä¸º String)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">new</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Into</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Person</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœç±»å‹ Uå®ç°äº† From&lt;T&gt;ï¼Œåˆ™ Tç±»å‹å®ä¾‹è°ƒç”¨ intoæ–¹ æ³•å°±å¯ä»¥è½¬æ¢ä¸ºç±»å‹ U (rust è‡ªåŠ¨å¸®æˆ‘ä»¬å®ç°äº† Into)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// impl&lt;T, U&gt; Into&lt;U&gt; for T where U: From&lt;T&gt; {}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰€ä»¥ ï¼Œ ä¸€èˆ¬æƒ…å†µä¸‹ ï¼Œ åªéœ€è¦å®ç° From å³å¯ ï¼Œ é™¤é From ä¸å®¹æ˜“å®ç°ï¼Œæ‰éœ€è¦è€ƒè™‘å® ç° Into</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//String ç±»å‹å®ç°äº† From&lt;&amp;str&gt;ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ into æ–¹æ³•å°† &amp;str è½¬æ¢ä¸º String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// TryFrom å’Œ TryInto ä¸¤ç§ traitï¼Œæ˜¯ From å’Œ Into çš„é”™è¯¯å¤„ç†ç‰ˆæœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5165-derefmut-å’Œ-deref">5.16.5. DerefMut å’Œ Deref<a href="#5165-derefmut-å’Œ-deref" class="hash-link" aria-label="5.16.5. DerefMut å’Œ Derefçš„ç›´æ¥é“¾æ¥" title="5.16.5. DerefMut å’Œ Derefçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ç”¨äºè‡ªå®šä¹‰è§£é™¤å¼•ç”¨è¿ç®—ç¬¦(*)çš„è¡Œä¸º</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token macro property">print!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Value of *b is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//11, box å¯ä»¥åƒæ™®é€šå¼•ç”¨ä¸€æ ·è§£å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ„é€ è‡ªå·±çš„ box</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">MyBox</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MyBox</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MyBox</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">ops</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Deref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Deref</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MyBox</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Target</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">deref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Target</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MyBox</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b inner = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b inner2 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">deref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// 32, deref() è¿”å›å†…éƒ¨æ•°æ®çš„å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//è‡ªåŠ¨è§£åŒ… , deref çš„å¼ºåˆ¶æ•ˆæœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">prin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">prin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‡ªåŠ¨å°† &amp;MyBox åŒ…è£…è§£é™¤, æˆä¸º &amp;i32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚æœä¸€ä¸ªç±»å‹ T å®ç°äº† Deref&lt;Target=U&gt;ï¼Œ åˆ™è¯¥ç±»å‹ T çš„å¼•ç”¨ (æˆ–æ™ºèƒ½æŒ‡é’ˆ)åœ¨åº”ç”¨çš„æ—¶å€™ä¼šè¢« è‡ªåŠ¨è½¬æ¢ä¸ºç±»å‹ U</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Stringç±»å‹å®ç°äº† Deref</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let a = &quot;hello&quot;.to_string();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let b = &quot; world&quot;.to_string();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let c = a+&amp;b;//&amp;bï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ª&amp;Stingç±»å‹ï¼Œè€Œ Stringç±»å‹å®ç°çš„ addæ–¹æ³•çš„å³å€¼å‚æ•°å¿…é¡»æ˜¯&amp;strç±»å‹, ä½†ç°åœ¨å®ƒæ˜¯å¯ ä»¥æ­£å¸¸è¿è¡Œçš„ã€‚åŸå› å°±æ˜¯ String ç±»å‹å® ç°äº† Deref&lt;Target=str&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println!(â€{:?)â€™â€, c); // &quot;hello world&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ ‡å‡†åº“ä¸­å¸¸ç”¨çš„å…¶ä»–ç±»å‹éƒ½å®ç°äº† Derefï¼Œ æ¯”å¦‚ Vec&lt;T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn foo(s : &amp;[i32]){}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let v= vec![1,2,3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">foo(&amp;v);//æ‰€ä»¥&amp;Vec&lt;T&gt; ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸º &amp;[T]ç±»å‹ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Box&lt;T&gt;ã€ Rc&lt;T&gt;ã€ Arc&lt;T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let x = Rc::new(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println1 (â€{:?}â€, x.chars());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å½“æŸç±»å‹å’Œå…¶è§£å¼•ç”¨ç›®æ ‡ç±»å‹ä¸­åŒ…å«äº†ç›¸åŒçš„æ–¹æ³•æ—¶ï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“è¯¥ç”¨å“ªä¸€ä¸ªäº†,æ­¤æ—¶å°±éœ€è¦æ‰‹åŠ¨è§£å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  cloneæ–¹æ³•åœ¨Rcå’Œ&amp;strç±»å‹ä¸­éƒ½è¢«å®ç°äº†ï¼Œæ‰€ä»¥è°ƒç”¨æ—¶ä¼šç›´æ¥è°ƒç”¨ Rc çš„ clone æ–¹æ³•ï¼Œå¦‚æœæƒ³è°ƒç”¨ Rc é‡Œé¢ &amp;str ç±»å‹çš„ clone æ–¹æ³•ï¼Œåˆ™éœ€è¦ä½¿ç”¨â€œè§£ å¼•ç”¨â€æ“ä½œ ç¬¦ æ‰‹åŠ¨è§£å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let x= Rc::new(â€helloâ€),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let y=x.clone(); //Rc&lt;&amp;str&gt;çš„ clone æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let z = (*x) .clone() ; // &amp;str çš„ clone æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// match å¼•ç”¨æ—¶ä¹Ÿéœ€è¦æ‰‹åŠ¨è§£å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let x = &quot;hello&quot;. to_string (); </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">match &amp;x {//æ‰‹åŠ¨è§£å¼•ç”¨æŠŠ&amp; String ç±»å‹è½¬æ¢æˆ&amp; str</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // match x.deref()ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //match x.as_ref()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //match x.borrow()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //match &amp;*x ä½¿ç”¨â€œè§£å¼•ç”¨ â€æ“ä½œç¬¦ï¼Œå°† Stringè½¬æ¢ä¸º strï¼Œç„¶åå†ç”¨â€œå¼•ç”¨â€æ“ä½œç¬¦è½¬ä¸º&amp; str</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //match&amp;x[..]ï¼Œè¿™æ˜¯å› ä¸ºStringç±»å‹çš„indexæ“ä½œå¯ä»¥è¿”å›&amp;ç”±ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;hello&quot; =&gt; {println! (&quot;xxx&quot;)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// DerefMutå’Œ Derefç±»ä¼¼ï¼Œ åªä¸è¿‡å®ƒæ˜¯è¿”å›å¯å˜å¼•ç”¨çš„ã€‚ Derefä¸­åŒ…å«å…³è”ç±»å‹ Target, å®ƒè¡¨ç¤ºè§£å¼•ç”¨ä¹‹åçš„ç›®æ ‡ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5166-asref-asmut">5.16.6. AsRef AsMut<a href="#5166-asref-asmut" class="hash-link" aria-label="5.16.6. AsRef AsMutçš„ç›´æ¥é“¾æ¥" title="5.16.6. AsRef AsMutçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p> å¯ä»¥å°†å€¼åˆ†åˆ«è½¬æ¢ä¸ºä¸å¯å˜å¼•ç”¨å’Œ å¯å˜å¼•ç”¨</p><p> AsRefå’Œæ ‡å‡†åº“çš„å¦å¤–ä¸€ä¸ª Borrow traitåŠŸèƒ½æœ‰äº›ç±»ä¼¼ï¼Œä½†æ˜¯ AsRefæ¯”è¾ƒè½»é‡çº§ï¼Œ å®ƒåªæ˜¯ç®€å•åœ°å°†å€¼è½¬æ¢ä¸ºå¼•ç”¨ï¼Œè€Œ Borrow trait å¯ä»¥ç”¨æ¥å°†æŸä¸ªå¤åˆç±»å‹æŠ½è±¡ä¸ºæ‹¥æœ‰å€Ÿç”¨è¯­ä¹‰ çš„ç±»å‹</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5167-borrow-trait">5.16.7. Borrow trait<a href="#5167-borrow-trait" class="hash-link" aria-label="5.16.7. Borrow traitçš„ç›´æ¥é“¾æ¥" title="5.16.7. Borrow traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5168-drop-èµ„æºé‡Šæ”¾">5.16.8. Drop èµ„æºé‡Šæ”¾<a href="#5168-drop-èµ„æºé‡Šæ”¾" class="hash-link" aria-label="5.16.8. Drop èµ„æºé‡Šæ”¾çš„ç›´æ¥é“¾æ¥" title="5.16.8. Drop èµ„æºé‡Šæ”¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é‡Šæ”¾èµ„æº Drop trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/*</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Drop trait åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼šdropï¼Œå½“å¯¹è±¡ç¦»å¼€ä½œç”¨åŸŸæ—¶ç³»ç»Ÿä¼šè¿›è¡Œèµ„æºé‡Šæ”¾, åŒæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥ æ–¹æ³•, ç”¨äºé‡Šæ”¾ç±»ä¼¼äºæ–‡ä»¶æˆ–ç½‘ç»œè¿æ¥çš„èµ„æºã€‚, è¿™ä¸ªæ–¹æ³•ä¸å…è®¸æ‰‹åŠ¨è°ƒç”¨, ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨, ç”¨äºé‡Šæ”¾ç±»ä¼¼äºæ–‡ä»¶æˆ–ç½‘ç»œè¿æ¥çš„èµ„æº, æˆ–è€…é‡Šæ”¾ box æ‰€æŒ‡å‘çš„å †ç©ºé—´</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    ä¹Ÿå¯ä»¥ drop(a) æ‰‹åŠ¨è°ƒç”¨é‡Šæ”¾, ä½¿ç”¨ std::mem::drop(xxx)</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="display:inline-block;color:rgb(0, 128, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    Boxï¼ŒVecï¼ŒStringï¼ŒFileï¼Œä»¥åŠ Process æ˜¯ä¸€äº›å®ç°äº† Drop trait æ¥é‡Šæ”¾ èµ„æºçš„ç±»å‹ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ææ„é¡ºåº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - æœ¬åœ°å˜é‡éµå¾ªå…ˆå£°æ˜çš„å˜é‡åææ„çš„è§„åˆ™ (è¿™ä¹Ÿç¼˜äºæ¡”ç»“æ„å…ˆè¿›å å‡ºçš„ç‰¹æ€§)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - å…ƒç»„æ•´ä½“æ¥è¯´ä¹Ÿå±äºæœ¬åœ°å˜é‡, æ‰€ä»¥ææ„é¡ºåºå’Œå±€éƒ¨å˜é‡çš„ææ„é¡ºåºä¸€è‡´</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//         ä½†å†…éƒ¨å…ƒç´ æ˜¯æŒ‰å…ƒç´ çš„å‡ºç°é¡ºåºä¾æ¬¡è¿›è¡Œææ„çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - ç»“æ„ä½“å’Œæšä¸¾ä½“ å†…éƒ¨å…ƒç´ æŒ‰ç…§å®šä¹‰æ—¶çš„æ¬¡åºææ„ (ç±»ä¼¼å…ƒç»„çš„ææ„)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - é—­åŒ…æ•è·å˜ é‡ çš„ææ„é¡ºåºå’Œé—­åŒ…å†…è¯¥å˜é‡çš„æ’åˆ—é¡ºåº ä¸€è‡´, ä¸æ•è·å˜ é‡å£° æ˜çš„é¡ºåºæ˜¯æ²¡æœ‰å…³ç³»çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Drop</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">drop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Dropping {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// é¡ºåº: y, x</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;x&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;y&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// é¡ºåº: x, y, z, a,b,c</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> tup1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;c&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> tup2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;x&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;y&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;z&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// é¡ºåº: y,x, a,b,c</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> tup1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;c&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> tup2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;x&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PrintDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;y&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//çº¿ç¨‹çš„å´©æ„¤è§¦å‘äº† tup2 çš„æå‰ææ„, è¿™ ç§æå‰ææ„çš„é¡ºåºæ­£å¥½å’Œå±€éƒ¨å˜é‡çš„ææ„é¡ºåºä¸€è‡´: å…ˆå£°æ˜çš„å…ƒç´ åææ„ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å±è”½ è§„é¿ drop æ£€æŸ¥(è·³è¿‡ å†…å­˜è‡ªåŠ¨é‡Šæ”¾)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">A</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">B</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">A</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">take</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">A</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// error[E0509]: cannot move out of type `Foo`, which implements the `Drop` trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› ä¸º drop æ–¹æ³•ä¸­å¯èƒ½è¿˜éœ€è¦ç”¨åˆ°è¿™ä¸¤ä¸ªå­—æ®µ, æ‰€ä»¥ä¸èƒ½å°†ä»–ä»¬çš„æ‰€æœ‰æƒç§»åŠ¨åˆ°å¤–éƒ¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­£ç¡®:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)">// é‡æ–°å®ç°take</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">take</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">A</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">B</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡std::mem::uninitialized()è¿›è¡Œä¼ªåˆå§‹åŒ–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç”¨äºè·³è¿‡Rustçš„å†…å­˜åˆå§‹åŒ–æ£€æŸ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœæ­¤æ—¶å¯¹aæˆ–bè¿›è¡Œè¯»å†™ï¼Œåˆ™æœ‰UB(å¼•å‘æœªå®šä¹‰è¡Œä¸º)é£é™©ï¼Œä¸€èˆ¬åªç”¨äº FFIå’Œ Cè¯­è¨€äº¤äº”</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mem</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">replace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mem</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">uninitialized</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mem</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">replace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mem</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">uninitialized</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡forgeté¿å…è°ƒç”¨ç»“æ„ä½“å®ä¾‹çš„drop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//    è¿™æ ·, ææ„å‡½æ•°å°±ä¸ä¼šè¢«è‡ªåŠ¨è°ƒç”¨, éœ€è¦æˆ‘ä»¬åœ¨æŸä¸ªåœ°æ–¹æ‰‹åŠ¨é‡Šæ”¾å†…å­˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mem</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">forget</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è‹¥ä¸å®ç° Drop åˆ™ä¸Šé¢ä»£ç ä¸ä¼šæŠ¥é”™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Drop</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">drop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// do something</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦å¤–çš„æ‰‹åŠ¨é‡Šæ”¾å†…å­˜çš„æ–¹å¼ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ManuallyDrop&lt;T&gt;æ˜¯ä¸€ä¸ªè”åˆä½“ï¼ŒRustä¸ä¼šä¸ºè”åˆä½“è‡ªåŠ¨å®ç°Dropã€‚ å› ä¸ºè”åˆä½“æ˜¯æ‰€æœ‰å­—æ®µå…±ç”¨å†…å­˜ï¼Œä¸èƒ½éšä¾¿è¢«ææ„ï¼Œå¦åˆ™ä¼šå¼•èµ·æœªå®šä¹‰è¡Œä¸º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// (std::mem::forget&lt;T&gt;å‡½æ•°çš„å®ç°å°±æ˜¯ç”¨äº†ManuallyDrop::newæ–¹æ³•)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mem</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">ManuallyDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Peach</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Melon</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">FruitBox</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    peach</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ManuallyDrop</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Peach</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    melon</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Melon</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ManuallyDrop</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Banana</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Drop</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">FruitBox</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">drop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           </span><span class="token class-name" style="color:rgb(38, 127, 153)">ManuallyDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">drop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">peach</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰‹åŠ¨é‡Šæ”¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           </span><span class="token class-name" style="color:rgb(38, 127, 153)">ManuallyDrop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">drop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5169-æ ‡ç­¾-trait">5.16.9. æ ‡ç­¾ trait<a href="#5169-æ ‡ç­¾-trait" class="hash-link" aria-label="5.16.9. æ ‡ç­¾ traitçš„ç›´æ¥é“¾æ¥" title="5.16.9. æ ‡ç­¾ traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å³ å†…éƒ¨æ²¡æœ‰ä»»ä½•å†…å®¹çš„ trait, åªæ˜¯ä½œä¸ºä¸€ä¸ªæ ‡ç­¾, èµ·åˆ°æ ‡è¯†ä½œç”¨</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51691-send-å’Œ-sync">5.16.9.1. Send å’Œ Sync<a href="#51691-send-å’Œ-sync" class="hash-link" aria-label="5.16.9.1. Send å’Œ Syncçš„ç›´æ¥é“¾æ¥" title="5.16.9.1. Send å’Œ Syncçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>ä¸€èˆ¬ç¼–è¯‘å™¨å¸®æˆ‘ä»¬è‡ªåŠ¨å®ç°äº†</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å¯ä»¥å®‰å…¨åœ°è·¨çº¿ç¨‹ä¼ é€’å’Œè®¿ é—® çš„ç±»å‹ç”¨ Send å’Œ Sync æ ‡è®°ï¼Œå¦åˆ™ç”¨! Send å’Œ!Sync æ ‡è®° , è¿™æ ·ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å°±èƒ½æ£€å‡ºæ•°æ®ç«äº‰çš„éšæ‚£ï¼Œ è€Œä¸éœ€è¦ç­‰åˆ°è¿è¡Œæ—¶å†æ’æŸ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ç°äº† Send çš„ç±»å‹ ï¼Œå¯ä»¥å®‰å…¨åœ°åœ¨çº¿ç¨‹é—´ä¼ é€’æ‰€æœ‰æƒ, å³å¯ä»¥è·¨çº¿ç¨‹ç§»åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ç°äº† Sync çš„ç±»å‹ ï¼Œå¯ä»¥è·¨çº¿ç¨‹å®‰å…¨åœ°ä¼ é€’ä¸å¯å˜å¼•ç”¨ , å³å¯ä»¥è·¨çº¿ç¨‹å…±äº«ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¹‹æ‰€ä»¥å¯ä»¥æ­£å¸¸åœ°moveå˜é‡ï¼Œä¹Ÿæ˜¯å› ä¸ºæ•°ç»„xä¸­çš„å…ƒç´ å‡ä¸ºåŸç”Ÿæ•°æ®ç±»å‹ï¼Œ é»˜è®¤éƒ½å®ç°äº† Send å’Œ Sync æ ‡ç­¾ traitï¼Œæ‰€ä»¥å®ƒä»¬è·¨çº¿ç¨‹ä¼ é€’å’Œè®¿é—®éƒ½å¾ˆå®‰å…¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let mut x=vec![1, 2, 3, 4] ;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">thread::spawn(move || x.push(1));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//Rc æ²¡æœ‰å® ç° Send å’Œ Syncï¼Œæ‰€ä»¥ä¸èƒ½åœ¨çº¿ç¨‹ä¹‹é—´ä¼ é€’å˜ é‡ x</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å› ä¸º Rcæ˜¯ç”¨äºå¼•ç”¨è®¡æ•°çš„æ™ºèƒ½æŒ‡é’ˆï¼Œ å¦‚æœæŠŠ Rcç±»å‹çš„å˜é‡ xä¼ é€’åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œä¼š å¯¼è‡´ä¸åŒçº¿ç¨‹çš„ Rc å˜é‡å¼•ç”¨åŒä¸€å—æ•°æ®ï¼Œ Rc å†… éƒ¨å®ç°å¹¶æ²¡æœ‰åšä»»ä½•çº¿ç¨‹åŒæ­¥çš„å¤„ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let x = Rc::new(vec! [1, 2, 3, 4]);//</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">thread::spawn( move || x[1]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹äºè‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå¦‚æœå…¶æˆå‘˜ç±»å‹å…¨éƒ¨å®ç° Send å’Œ Syncï¼Œæ­¤ç±»å‹æ‰ä¼šè¢«è‡ª åŠ¨å®ç° Send å’Œ Sync</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51692-copy-trait">5.16.9.2. Copy trait<a href="#51692-copy-trait" class="hash-link" aria-label="5.16.9.2. Copy traitçš„ç›´æ¥é“¾æ¥" title="5.16.9.2. Copy traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>åŒºåˆ†å€¼è¯­ä¹‰å’Œå¼•ç”¨è¯­ä¹‰</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// Copy traitï¼Œç”¨æ¥æ ‡è¯† å¯ ä»¥æŒ‰ä½ å¤åˆ¶å…¶å€¼ çš„ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Copy å‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªç±»å‹é»˜è®¤é‡‡ç”¨ copy è¯­ä¹‰ï¼Œè€Œä¸æ˜¯ move è¯­ä¹‰; åœ¨æ‰§è¡Œå˜é‡ç»‘å®šã€å‡½æ•°å‚æ•°ä¼ é€’ã€å‡½æ•°è¿”å›ç­‰åœºæ™¯ä¸‹, æ‰§è¡Œçš„æ˜¯å†…å­˜æ‹·è´æ“ä½œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¼•ç”¨ç±»å‹æ— æ³•å®ç° copy trait, è™½ç„¶å¼•ç”¨è¯­ä¹‰ç±»å‹ä¸èƒ½å®ç° Copyï¼Œ ä½†å¯ä»¥å®ç° Clone çš„ clone æ–¹æ³•ï¼Œ ä»¥ å®ç°æ·±å¤åˆ¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Copy traitç»§æ‰¿è‡ª Clone trait, è¦å®ç° Copy trait çš„ç±»å‹ï¼Œå¿…é¡»å®ç° Clone trait ä¸­å®šä¹‰çš„æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  Rust æä¾›äº†æ›´æ–¹ä¾¿çš„ derive å±æ€§ä¾›æˆ‘ä»¬å®Œæˆè¿™é¡¹é‡å¤çš„å·¥ä½œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive (Copy , Clone)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct xxx {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æŸä¸ªç±»å‹æ ‡æ³¨ä¸º Copyå, å°±ä¸èƒ½éšä¾¿å®ç° Clone çš„ clone æ–¹æ³•äº†, è°ƒç”¨ t.clone() æ—¶, æ‰§è¡Œçš„æ“ä½œå¿…é¡»ç­‰åŒäºâ€œç®€å•å†…å­˜æ‹·è´â€;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ‰€ä»¥ ä¸€èˆ¬ä½¿ç”¨ #[derive(Copy, Clone)] è¿™ç§æ–¹å¼ï¼Œè¿™ç§æƒ…å†µä¸‹å®ƒä»¬ä¿©æœ€å¥½ä¸€èµ·å‡ºç°ï¼Œé¿å…æ‰‹å·¥å®ç° Clone å¯¼è‡´é”™è¯¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Rust ä¸ºå¾ˆå¤šåŸºæœ¬æ•°æ®ç±»å‹å®ç°äº† Copy traitï¼Œæ¯”å¦‚å¸¸ç”¨çš„æ•°å­—ç±»å‹ã€å­—ç¬¦( Char)ã€å¸ƒå°” ç±»å‹ã€å•å…ƒå€¼ã€ä¸å¯å˜å¼•ç”¨ç­‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ£€æµ‹å“ªäº›ç±»å‹å®ç° äº† Copy trait:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn test copy&lt;T: Copy&gt;(t : T) { //å¦‚æœå®ç°äº†Copy traitçš„ç±»å‹ï¼Œ åˆ™å¯ä»¥æ­£å¸¸ç¼–è¯‘: å¦‚æœæ²¡æœ‰å®ç°ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println(â€hhhâ€);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¹¶éæ‰€æœ‰ç±»å‹éƒ½å¯ä»¥ å®ç° Copy traitã€‚ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹äºè‡ªå®šä¹‰ç±»å‹æ¥è¯´ï¼Œå¿…é¡»è®©æ‰€æœ‰çš„æˆå‘˜éƒ½å®ç° äº† Copy traitï¼Œ è¿™ä¸ªç±»å‹æ‰æœ‰èµ„æ ¼ å®ç° Copy traitã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚æœæ˜¯æ•°ç»„ç±»å‹ ï¼Œ ä¸”å…¶å†…éƒ¨å…ƒç´ éƒ½æ˜¯ Copy ç±»å‹ï¼Œ åˆ™æ•°ç»„æœ¬èº«å°±æ˜¯ Copy ç±»å‹;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚æœæ˜¯å…ƒç»„ç±»å‹ï¼Œä¸”å…¶å†…éƒ¨å…ƒç´ éƒ½æ˜¯ Copy ç±»å‹ï¼Œ åˆ™è¯¥å…ƒ ç»„ä¼šè‡ªåŠ¨å®ç°Copy</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51693-sized-trait--å’Œ-åŠ¨æ€ç±»å‹dst">5.16.9.3. Sized trait  å’Œ åŠ¨æ€ç±»å‹DST<a href="#51693-sized-trait--å’Œ-åŠ¨æ€ç±»å‹dst" class="hash-link" aria-label="5.16.9.3. Sized trait  å’Œ åŠ¨æ€ç±»å‹DSTçš„ç›´æ¥é“¾æ¥" title="5.16.9.3. Sized trait  å’Œ åŠ¨æ€ç±»å‹DSTçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// sized trait ç”¨æ¥æ ‡è¯†ç¼–è¯‘æœŸå¯ç¡®å®šå¤§å°çš„ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Unsize traitï¼Œ ç›®å‰è¯¥ trait ä¸ºå®éªŒç‰¹æ€§ï¼Œç”¨äºæ ‡è¯†åŠ¨æ€å¤§å°ç±»å‹ (DST)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Dynamical sized type -&gt; DST</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿è¡ŒæœŸæ‰çŸ¥é“å¤§å°çš„ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚ str (ä¸æ˜¯ &amp;str å“¦), ç¼–è¯‘å™¨ä¸å¯çŸ¥å¤§å°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//      &amp;str è¿™ä¸ªç±»å‹çš„å€¼åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†, str çš„åœ°å€, str çš„é•¿åº¦, æ‰€ä»¥ &amp;str çš„å¤§å°ç±»å‹å¯ä»¥ç¡®å®š å³ 2*usize</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚ trait object, éƒ½æ˜¯åŠ¨æ€ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚[T],  æœªçŸ¥ç±»å‹çš„æ•°ç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚ åŒ…å« DST çš„ struct/tuple</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰€ä»¥ä¸ºäº†èƒ½å¤Ÿç¼–è¯‘é€šè¿‡, å¿…é¡»å°†åŠ¨æ€ç±»å‹æ”¾åˆ°æŒ‡é’ˆèƒŒå, æŒ‡é’ˆæ—¶ &quot;fat pointe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// compileré»˜è®¤ä¸º ç±»å‹åŠ ä¸Šäº† Sized trait, å¦‚:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">xxx</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Sized</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŒ‡å®š t ä¸ºå¯çŸ¥å¤§å°ç±»å‹, Sized å¯çœç•¥, ç¼–è¯‘å™¨é»˜è®¤æ·»åŠ äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ?Sized åŒ…å« Sized å’Œ unsized</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">xxx</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token class-name" style="color:rgb(38, 127, 153)">Sized</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// t ä¸º ç¼–è¯‘æœŸé—´ä¸å¯çŸ¥å¤§å°çš„ç±»å‹ or ä¸º å¯çŸ¥å¤§å°ç±»å‹, å‘Šè¯‰ ç¼–è¯‘å™¨, åˆ°åº•æ˜¯é‚£ç§ç±»å‹ä¸ç¡®å®š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½†æ˜¯åŠ¨æ€å¤§å°ç±»å‹ä¸èƒ½éšæ„ä½¿ç”¨ï¼Œè¿˜éœ€è¦éµå¾ªå¦‚ä¸‹ä¸‰æ¡é™åˆ¶è§„åˆ™:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 1. åªå¯ä»¥é€šè¿‡èƒ–æŒ‡é’ˆæ¥æ“ä½œ Unsizeç±»å‹ï¼Œæ¯”å¦‚&amp;[T]æˆ–&amp;Trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 2. å˜é‡ã€å‚æ•°å’Œæšä¸¾å˜é‡ä¸èƒ½ä½¿ç”¨åŠ¨æ€å¤§å°ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// 3. ç»“æ„ä½“ä¸­åªæœ‰æœ€åä¸€ä¸ªå­—æ®µå¯ä»¥ä½¿ç”¨åŠ¨æ€å¤§å°ç±»å‹ï¼Œå…¶ä»–å­—æ®µä¸å¯ä»¥ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51610-default-trait">5.16.10. Default trait<a href="#51610-default-trait" class="hash-link" aria-label="5.16.10. Default traitçš„ç›´æ¥é“¾æ¥" title="5.16.10. Default traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// ä¸º struct æä¾›é»˜è®¤å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input: String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fgcolor: String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bgcolor: String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Default for ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn default() -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input: String::default(),// è¿™æ ·ä½¿ç”¨å³å¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fgcolor: String::new(),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            bgcolor: String::new(),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51611-extend-trait">5.16.11. Extend trait<a href="#51611-extend-trait" class="hash-link" aria-label="5.16.11. Extend traitçš„ç›´æ¥é“¾æ¥" title="5.16.11. Extend traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// é€šè¿‡ iteratorä¸­çš„å…ƒç´ , æ‰©å……é›†åˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åŒ…å«æ–¹æ³•:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// fn extend&lt;T: IntoIterator&lt;Item = A&gt;&gt;(&amp;mut self, iter: T);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let mut s = &quot;Hello&quot;.to_owned();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">s.extend(&amp;[&#x27; &#x27;, &#x27;R&#x27;, &#x27;u&#x27;, &#x27;s&#x27;, &#x27;t&#x27;]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println!(&quot;{}&quot;, s);//Hello Rust</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// String åˆšå¥½å®ç°äº†è¿™ä¸ª trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51612-any-trait">5.16.12. Any trait<a href="#51612-any-trait" class="hash-link" aria-label="5.16.12. Any traitçš„ç›´æ¥é“¾æ¥" title="5.16.12. Any traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// use std::any::Any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51613-å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„trait">5.16.13. å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„trait<a href="#51613-å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„trait" class="hash-link" aria-label="5.16.13. å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„traitçš„ç›´æ¥é“¾æ¥" title="5.16.13. å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// PartialEqã€ Eqã€ PartialOrd å’Œ Ord</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - PartialEqä»£è¡¨éƒ¨åˆ†ç­‰ä»·å…³ç³»ï¼Œå…¶ä¸­å®šä¹‰äº† eqå’Œ ne (ä¸ç­‰, æœ‰é»˜è®¤å®ç°)ä¸¤ä¸ªæ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - Eq ä»£è¡¨ç­‰ä»·å…³ç³»ï¼Œè¯¥ trait ç»§æ‰¿è‡ª PartialEqï¼Œ ä½†æ˜¯å…¶ä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•æ–¹æ³• ã€‚ å®ƒå®é™…ä¸Š ç›¸å½“äºæ ‡è®°å®ç°äº† Eq çš„ç±»å‹æ‹¥æœ‰ç­‰ä»·å…³ç³»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - PartialOrdå¯¹åº”äºååºï¼Œå…¶ä¸­å®šä¹‰äº† partial_cmp (å¿…é¡»å®ç°)ã€ ltã€ le(å°äºç­‰äº)ã€ gtå’Œ geäº”ä¸ªæ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - Ordå¯¹åº”äºå…¨åºï¼Œå…¶ä¸­å®šä¹‰äº† cmpã€ maxå’Œ minä¸‰ä¸ªæ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æšä¸¾ä½“ä¸º Orderingï¼Œ ç”¨äºè¡¨ç¤º æ¯”è¾ƒç»“æœï¼Œå…¶ä¸­å®šä¹‰äº† å°äºã€ç­‰äºå’Œå¤§äºä¸‰ç§çŠ¶æ€ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let mut v = [-5i32, 4, 1, -3, 2];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    é»˜è®¤å‡åº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.sort();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(v == [-5, -3, 1, 2, 4]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è€Œ sort_by æ˜¯æŒ‰ a å’Œ b çš„æ¯”è¾ƒç»“æœæ˜¯å¦ç­‰äº Less çš„è§„åˆ™è¿›è¡Œæ’åº çš„ï¼Œ è‹¥ç­‰äº less, åˆ™ a å°äº bï¼Œä¸ºå‡åºæ’åˆ—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.sort_by(|a, b| a.cmp(b));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(v == [-5, -3, 1, 2, 4]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.sort_by(|a, b| b.cmp(a));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(v == [4, 2, 1, -3, -5]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.sort_by_key(|k| k.abs());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   assert!(v == [1, 2, -3, 4, -5]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let result = 1.0.partial_cmp(&amp;2.0);//æµ®ç‚¹æ•°ï¼Œåªèƒ½ç”¨ååºæ¯”è¾ƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(result, Some(Ordering::Less));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let result = 1.cmp(&amp;1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(result, Ordering::Equal);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let result = &quot;abc&quot;.partial_cmp(&amp;&quot;Abc&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(result, Some(Ordering::Greater));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut v: [f32; 5] = [5.0, 4.1, 1.2, 3.4, 2.5];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.sort_by(|a, b| a.partial_cmp(b).unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(v == [1.2, 2.5, 3.4, 4.1, 5.0]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v.sort_by(|a, b| b.partial_cmp(a).unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(v == [5.0, 4.1, 3.4, 2.5, 1.2]);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="517-å…ƒç»„">5.17. å…ƒç»„<a href="#517-å…ƒç»„" class="hash-link" aria-label="5.17. å…ƒç»„çš„ç›´æ¥é“¾æ¥" title="5.17. å…ƒç»„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…ƒç»„,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç±»å‹å¯ä»¥ä¸åŒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> tup</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">500</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6.4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;holla&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// tup.0 ç­‰äº 500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// tup.1 ç­‰äº 6.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// tup.2 ç­‰äº 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»“æ„å…ƒç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> tup</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// y ç­‰äº 6.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å½“å…ƒç»„ä¸­åªæœ‰ä¸€ä¸ªå€¼çš„æ—¶å€™ï¼Œéœ€è¦åŠ é€—å·ï¼Œå³(0,)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç©ºå…ƒç»„ / å•å…ƒç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é›¶å¤§å°ç±»å‹(Zero Sized Type, ZST), ä¸å ç©ºé—´</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨åœºæ™¯:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 1. åœ¨å¼€å‘æ—¶, æŸ¥çœ‹æ•°æ®ç±»å‹; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// error, æç¤º expected (), foundstruct ã€std: :vecÂ·:Vee, è¿™æ ·å°±çŸ¥é“äº†å³å€¼ vec![(); 10]æ˜¯å‘é‡ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 2. åœ¨éœ€è¦å¾ªç¯æŒ‡å®šæ¬¡æ•°çš„ä½ç½®, ç”¨æ¥æé«˜æ€§èƒ½ (å› ä¸º Vee å†…éƒ¨è¿­ä»£å™¨ä¸­ ä¼šé’ˆå¯¹ ZST ç±»å‹åšä¸€äº›ä¼˜åŒ–)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vee</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> v </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// xxx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 3. å®˜æ–¹æ ‡å‡†åº“ ä¸­çš„ HashSet&lt;T&gt; å’Œ BTreeSet&lt;T&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…¶å®åªæ˜¯æŠŠ HashMap&lt;K, T&gt;æ¢æˆäº† HashMap&lt;K, ()&gt;ï¼Œ ç„¶åå°±å¯ ä»¥å…±ç”¨ HashMap&lt;K, T&gt;ä¹‹å‰çš„ä»£ç ï¼Œè€Œä¸éœ€è¦å†é‡æ–°å®ç°ä¸€é HashSet&lt;T&gt;äº†ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="518-ç»“æ„ä½“">5.18. ç»“æ„ä½“<a href="#518-ç»“æ„ä½“" class="hash-link" aria-label="5.18. ç»“æ„ä½“çš„ç›´æ¥é“¾æ¥" title="5.18. ç»“æ„ä½“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5181-ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨">5.18.1. ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨<a href="#5181-ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="5.18.1. ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.18.1. ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ç»“æ„ä½“ï¼ˆStructï¼‰ä¸å…ƒç»„ï¼ˆTupleï¼‰éƒ½å¯ä»¥å°†è‹¥å¹²ä¸ªç±»å‹ä¸ä¸€å®šç›¸åŒçš„æ•°æ®æ†ç»‘åœ¨ä¸€èµ·å½¢æˆæ•´ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ä½†æ˜¯ç»“æ„ä½“å¯ä»¥ç»™æ¯ä¸ªæ•°æ®èµ·ä¸ªåå­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// è¿™æ ·è®¿é—®å®ƒæˆå‘˜çš„æ—¶å€™å°±ä¸ç”¨è®°ä½ä¸‹æ ‡äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å’Œ c ä¸åŒ,  Rust é‡Œ struct è¯­å¥ä»…ç”¨æ¥å®šä¹‰ï¼Œä¸èƒ½å£°æ˜å®ä¾‹ï¼Œç»“å°¾ä¸éœ€è¦ ; ç¬¦å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å’Œ go ä¸åŒ, rust çš„ struct æ— æ³•åµŒå¥—, åªèƒ½åˆ†æˆå¤šä¸ª struct æ¥å®šä¹‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ç»“æ„ä½“å¿…é¡»æŒæ¡å­—æ®µå€¼æ‰€æœ‰æƒï¼Œå› ä¸ºç»“æ„ä½“å¤±æ•ˆçš„æ—¶å€™ä¼šé‡Šæ”¾æ‰€æœ‰å­—æ®µ, æ‰€ä»¥å­—ç¬¦ä¸²å­—æ®µä½¿ç”¨ String ä¸ç”¨ &amp;str (å› ä¸º &amp;str æ˜¯å€Ÿç”¨çš„æ‰€æœ‰æƒ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// æ²¡æœ‰èº«ä½“çš„ç»“æ„ä½“ä¸ºå•å…ƒç»“æ„ä½“ï¼ˆUnit Structï¼‰, å¦‚ struct UnitStruct;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">struct_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å®šä¹‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨å®šä¹‰ struct æ—¶å¯¼å…¥è°ƒè¯•åº“, æ‰èƒ½ print</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        domain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        nation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        found</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å®ä¾‹åŒ–, è‹¥æ˜¯ç©º struct,     let inner_a = InnerA {};</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> domain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xiaoyureed.github.io&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> st </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        domain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æœ‰å­—æ®µåç§°å’Œç°å­˜å˜é‡åç§°ä¸€æ ·çš„ï¼Œå¯ä»¥ç®€åŒ–ä¹¦å†™, ç±»ä¼¼ JavaScript</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xiaoyu&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        nation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;China&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        found</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2013</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éƒ¨åˆ†æ›´æ–°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› ä¸ºæ²¡æœ‰å®ç°äº† Copy trait, æ‰€æœ‰ st æ‰€æœ‰æƒä¼šè½¬ç§»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> st1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        domain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;new domain&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">st</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¾“å‡ºç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦å®šä¹‰ struct æ—¶å¯¼å…¥è°ƒè¯•åº“ #[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;st = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> st1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ ¼å¼åŒ–è¾“å‡º {:#?}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;st = {:#?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> st1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// åªæœ‰ æˆå‘˜éƒ½ä¸º å¤åˆ¶è¯­ä¹‰,  struct æ‰èƒ½è‡ªåŠ¨ Copy derive </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug,Copy,Clone)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;a</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    isbn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> book </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Rustç¼–ç¨‹ä¹‹é“&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> isbn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20181212</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> book2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// book ç”±äº å®ç° äº† Copy trait, æ‰€æœ‰æƒæ²¡æœ‰è½¬ç§»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">book2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5182-å…ƒç»„ç»“æ„ä½“-and-å•å…ƒç»“æ„ä½“">5.18.2. å…ƒç»„ç»“æ„ä½“ and å•å…ƒç»“æ„ä½“<a href="#5182-å…ƒç»„ç»“æ„ä½“-and-å•å…ƒç»“æ„ä½“" class="hash-link" aria-label="5.18.2. å…ƒç»„ç»“æ„ä½“ and å•å…ƒç»“æ„ä½“çš„ç›´æ¥é“¾æ¥" title="5.18.2. å…ƒç»„ç»“æ„ä½“ and å•å…ƒç»“æ„ä½“çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…ƒç»„ç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç®€åŒ–çš„ç»“æ„ä½“, æ²¡æœ‰å­—æ®µåç§°, åªæœ‰å­—æ®µç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ˜¯ä¸ºäº†å¤„ç†é‚£äº›éœ€è¦å®šä¹‰ç±»å‹ï¼ˆç»å¸¸ä½¿ç”¨ï¼‰åˆä¸æƒ³å¤ªå¤æ‚çš„ç®€å•æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Color</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Point</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> black </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Color</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> origin </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Point</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨å’Œå…ƒç»„ä¸€æ ·, é€šè¿‡ä¸‹æ ‡è®¿é—®å­—æ®µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;black = ({}, {}, {})&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> black</span><span class="token number" style="color:rgb(9, 134, 88)">.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> black</span><span class="token number" style="color:rgb(9, 134, 88)">.1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> black</span><span class="token number" style="color:rgb(9, 134, 88)">.2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;origin = ({}, {})&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> origin</span><span class="token number" style="color:rgb(9, 134, 88)">.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> origin</span><span class="token number" style="color:rgb(9, 134, 88)">.1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›´æ¥æ‰“å°ç»“æ„ä½“ é”™è¯¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¦æ‰“å°, ä¸¤ç§æ–¹æ³•:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 1. å®šä¹‰ struct æ—¶ç»§æ‰¿ #[derive(Debug)], ç„¶å ä½¿ç”¨ {:?} or {:#?} æ‰“å°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 2. ä¸º struct å®ç° fmt::Display æ¥å£, ç„¶åä½¿ç”¨ {} å³å¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// println!(&quot;tuple struct - {}&quot;, black);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å•å…ƒç»“æ„ä½“ å³ ç©ºçš„ç»“æ„ä½“, é›¶å¤§å°ç±»å‹(Zero Sized Type, ZST), ä¸å ç©ºé—´</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨Debugç¼–è¯‘æ¨¡å¼ä¸‹, å¤šä¸ª ç©ºç»“æ„ä½“ å®ä¾‹æ˜¯ä¸åŒ çš„å¯¹è±¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨åœ¨Releaseç¼–è¯‘æ¨¡å¼ä¸‹, ä¼šè¢«ä¼˜åŒ–ä¸ºåŒä¸€ä¸ª å¯¹è±¡ (å†…å­˜åœ°å€ç›¸åŒ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ ‡å‡†åº“ä¸­è¡¨ç¤ºå…¨èŒƒå›´()çš„ RangeFullï¼Œ å°±æ˜¯ä¸€ä¸ªå•å…ƒç»“æ„ä½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5183-ç»“æ„ä½“æ–¹æ³•">5.18.3. ç»“æ„ä½“æ–¹æ³•<a href="#5183-ç»“æ„ä½“æ–¹æ³•" class="hash-link" aria-label="5.18.3. ç»“æ„ä½“æ–¹æ³•çš„ç›´æ¥é“¾æ¥" title="5.18.3. ç»“æ„ä½“æ–¹æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»“æ„ä½“æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// &amp;self å…³é”®å­— æ€»æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°, ç±»ä¼¼ Python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// self è¡¨ç¤º struct å®ä¾‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;to string -&gt; {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;st.to_string() = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> st</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»“æ„ä½“å…³è”å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç±»ä¼¼ Java ä¸­çš„é™æ€æ–¹æ³•, è°ƒç”¨ä¸ä¾èµ– struct å®ä¾‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ²¡æœ‰ &amp;self å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">create</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// Site å¯ç”¨ Self æ›¿ä»£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                domain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;new domain create()&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xiaoyu&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                nation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;nation&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                found</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> create_site </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Site</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">create</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;create_site = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> create_site</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5184-new-type-æ¨¡å¼-å’Œ-ç±»å‹åˆ«å-selfåˆ«å">5.18.4. new type æ¨¡å¼ å’Œ ç±»å‹åˆ«å Selfåˆ«å<a href="#5184-new-type-æ¨¡å¼-å’Œ-ç±»å‹åˆ«å-selfåˆ«å" class="hash-link" aria-label="5.18.4. new type æ¨¡å¼ å’Œ ç±»å‹åˆ«å Selfåˆ«åçš„ç›´æ¥é“¾æ¥" title="5.18.4. new type æ¨¡å¼ å’Œ ç±»å‹åˆ«å Selfåˆ«åçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å½“ä¸€ä¸ªå…ƒç»„ç»“æ„ä½“åªæœ‰ä¸€ä¸ªå­—æ®µçš„æ—¶å€™ï¼Œç§°ä¹‹ä¸º New Type æ¨¡å¼</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨åœºæ™¯:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - æ˜ç¡®è¯­ä¹‰: ä¸ºåŒç±»å‹çš„æ•°æ®åˆ†åˆ«å®šä¹‰æ–°çš„ç±»å‹è¿›è¡ŒåŒºåˆ†, å¦‚ ä¸º i32 ç±»å‹åˆ†åˆ«å®šä¹‰ Hour, Second ç±»å‹ (è¿™æ˜¯ä¸ºäº†èƒ½ä¿è¯åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘æœŸé—´å³å¯å‘ç°é”™è¯¯ã€‚), åŒ…è£…äº†ä¸€å±‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä½¿å¤åˆ¶è¯­ä¹‰çš„ ç±»å‹å…·æœ‰ç§»åŠ¨è¯­ä¹‰; æ¯”å¦‚ f64 æœ¬æ¥æ˜¯å¤åˆ¶è¯­ä¹‰ ï¼Œè€ŒåŒ…è£…ä¸º Miles(f64)ä¹‹ åï¼Œå› ä¸ºç»“æ„ä½“æœ¬èº«ä¸èƒ½è¢«è‡ªåŠ¨å®ç° Copyï¼Œæ‰€ä»¥ Miles(f64)å°±æˆäº†ç§»åŠ¨è¯­ä¹‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - éšè—å®é™…ç±»å‹ï¼Œ é™åˆ¶åŠŸèƒ½; ä½¿ç”¨ Newtypeæ¨¡å¼åŒ…è£…çš„ç±»å‹å¹¶ä¸èƒ½è¢«å¤–ç•Œè®¿é—®ï¼Œé™¤éæ ä¾›ç›¸åº”æ–¹æ³•ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - ç»™æ ‡å‡†åº“ä¸­çš„ç»“æ„å®ç°æ ‡åº“ä¸­çš„ trait, å¦‚ç»™ Vector å®ç° Display trait.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//         ç”±äºå­¤å„¿è§„åˆ™, è¿™æ˜æ˜¾ä¸è¡Œ, å¯ä»¥é€šè¿‡ç»™ Vector åŒ…è£…ä¸€å±‚æ¥è¾¾åˆ°ç›®çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Wrapper</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Wrapper</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//new type æƒ¯ç”¨æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Years</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Years</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Days</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">365</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Days</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">/// èˆå»ä¸æ»¡ä¸€å¹´çš„éƒ¨åˆ†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_years</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Years</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Years</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">365</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">old_enough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Years</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        age</span><span class="token number" style="color:rgb(9, 134, 88)">.0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> age </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Years</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> age_days </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Old enough {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">old_enough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">age</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// åªèƒ½ä¼ å¹´å•ä½çš„æ•°å­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Old enough {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">old_enough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">age_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_years</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Old enough {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">old_enough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">age_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‡ºé”™, ç¼–è¯‘æœŸé—´å³å¯å‘ç° // ä¸èƒ½ä¼ å¤©å•ä½çš„æ•°å­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»å‹åˆ«å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¹Ÿå¯ä»¥ä½¿ç”¨ typeå…³é”®å­—ä¸ºä¸€ä¸ªç±»å‹åˆ›å»ºåˆ«åï¼Œå¦‚ä»£ç ç¬¬ 2è¡Œä¸º i32ç±»å‹åˆ›å»ºäº†ä¸€ä¸ªåˆ«å Intï¼Œ ä½†æ˜¯å…¶æœ¬è´¨è¿˜æ˜¯ i32 ç±»å‹ï¼Œå®ƒæ‰€æ‹¥æœ‰çš„è¡Œä¸ºå’Œ i32 æ˜¯ä¸€æ · çš„ ã€‚ç›¸ æ¯”ä¹‹ä¸‹ï¼Œ New Type æ¨¡å¼ å±äº è‡ªå®šä¹‰ç±»å‹ï¼Œæ›´åŠ çµæ´»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//åˆ«åçš„ä¸»è¦ç”¨é€”æ˜¯é¿å…å†™å‡ºå†—é•¿çš„æ¨¡æ¿åŒ–ä»£ç ï¼ˆboilerplate codeï¼‰ã€‚å¦‚ IoResult&lt;T&gt; æ˜¯ Result&lt;T, IoError&gt; ç±»å‹çš„åˆ«åã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">VeryVerboseEnumOfThingsToDoWithNumbers</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Subtract</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Creates a type alias</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Operations</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">VeryVerboseEnumOfThingsToDoWithNumbers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Operations</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// èƒ½è¿™ä¹ˆç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">VeryVerboseEnumOfThingsToDoWithNumbers</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">// Self åˆ«å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Add</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Subtract</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `NanoSecond` æ˜¯ `u64` çš„æ–°åå­—ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">NanoSecond</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Inch</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡è¿™ä¸ªå±æ€§å±è”½è­¦å‘Šã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[allow(non_camel_case_types)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">u64_t</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `NanoSecond` = `Inch` = `u64_t` = `u64`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> nanoseconds</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">NanoSecond</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> u64_t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> inches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Inch</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> u64_t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5185-æ¡ˆä¾‹-å½©è‰²å‘½ä»¤è¡Œè¾“å‡º">5.18.5. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡º<a href="#5185-æ¡ˆä¾‹-å½©è‰²å‘½ä»¤è¡Œè¾“å‡º" class="hash-link" aria-label="5.18.5. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºçš„ç›´æ¥é“¾æ¥" title="5.18.5. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>main.rs </p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">mod color;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use color::Colorized;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s=  &quot;hello&quot;.red().on_yellow();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, s);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>color.rs </p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::fmt::Display;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input: String, // å†…å®¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fg: String,    // å‰æ™¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bg: String,    // èƒŒæ™¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ç°é»˜è®¤å€¼, å¯¹ color string è¿›è¡Œåˆå§‹å¡«å……</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Default for ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn default() -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input: String::default(),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fg: String::default(),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            bg: String::default(),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub trait Colorized {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å…³è”å¸¸é‡, å’Œè”ç±»å‹ç±»ä¼¼ï¼Œ ç”±å®ç°è¯¥ trait çš„ç±»å‹æ¥æŒ‡å®šå¸¸é‡çš„å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿™é‡ŒæŒ‡å®šäº†é»˜è®¤å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    const FG_RED: &amp;&#x27;static str = &quot;31&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    const BG_YELLOW: &amp;&#x27;static str = &quot;43&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn red(self) -&gt; ColorString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_yellow(self) -&gt; ColorString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Colorized for ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn red(self) -&gt; ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fg: String::from(Self::FG_RED),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ..self</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_yellow(self) -&gt; ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            bg: String::from(Self::BG_YELLOW),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ..self</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    const FG_RED: &amp;&#x27;static str = &quot;31&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    const BG_YELLOW: &amp;&#x27;static str = &quot;43&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;&#x27;a&gt; Colorized for &amp;&#x27;a str {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn red(self) -&gt; ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input: String::from(self),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fg: String::from(Self::FG_RED),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ..ColorString::default()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_yellow(self) -&gt; ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input: String::from(self),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            bg: String::from(Self::BG_YELLOW),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ..ColorString::default()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    const FG_RED: &amp;&#x27;static str = &quot;31&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    const BG_YELLOW: &amp;&#x27;static str = &quot;43&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl ColorString{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç»„è£… ansi ç </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // \xlB[43;31m, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn compute_style(&amp;self) -&gt; String {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut res = String::from(&quot;\x1B[&quot;);// ansi ç èµ·å§‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut has_wrote = false;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if !self.bg.is_empty() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            res.push_str(&amp;self.bg);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            has_wrote = true;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if !self.fg.is_empty() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if has_wrote {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                res.push(&#x27;;&#x27;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            res.push_str(&amp;self.fg);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        res.push(&#x27;m&#x27;);// ansi ç ç»“æŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        res</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Display for ColorString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#x27;_&gt;) -&gt; std::fmt::Result {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        f.write_str(&amp;self.compute_style())?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        write!(f, &quot;{}&quot;, self.input)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        write!(f, &quot;\x1B[0m&quot;)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Ok(())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="519-æšä¸¾">5.19. æšä¸¾<a href="#519-æšä¸¾" class="hash-link" aria-label="5.19. æšä¸¾çš„ç›´æ¥é“¾æ¥" title="5.19. æšä¸¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5191-æšä¸¾åŸºæœ¬ä½¿ç”¨">5.19.1. æšä¸¾åŸºæœ¬ä½¿ç”¨<a href="#5191-æšä¸¾åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="5.19.1. æšä¸¾åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.19.1. æšä¸¾åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// æšä¸¾ç±»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// æšä¸¾å…ƒç´ å¯ä»¥å„ä¸ç›¸åŒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">enum_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-------------enum demo-----------------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Resp</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">E</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Obj</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">E</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">divide</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Resp</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Resp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;åˆ†æ¯ä¸èƒ½ä¸ºé›¶&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Resp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Obj</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">divide</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">divide</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> a </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Resp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Obj</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;n: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> b </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Resp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;msg: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Papery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book3</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">field1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> field2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> book </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Papery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot; enum book = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å®ä¾‹åŒ–å¸¦å±æ€§çš„æšä¸¾ç±»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> boot1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Book1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, æ²¡è¿™ä¸ªè¯­æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;book1.0 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> boot1</span><span class="token number" style="color:rgb(9, 134, 88)">.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­£ç¡®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;book1 = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> boot1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è®¿é—®æšä¸¾ç±»çš„å±æ€§, å¿…é¡»å€ŸåŠ© match</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> book3 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Book3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        field1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        field2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> book3 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Papery</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;book&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹äº å…ƒç»„, ç”±äºæ²¡æœ‰å­—æ®µåç§°, éœ€è¦ä¸´æ—¶æŒ‡å®šä¸€ä¸ªå½¢å‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Book1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;book1.i = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Book2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;book2.s = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Book3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">field1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> field2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;book3.field1 = {}, book3.field2 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> field1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> field2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain">  </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;no match&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5192-option">5.19.2. Option<a href="#5192-option" class="hash-link" aria-label="5.19.2. Optionçš„ç›´æ¥é“¾æ¥" title="5.19.2. Optionçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Option æšä¸¾ç±»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ˜¯ Rust æ ‡å‡†åº“ä¸­çš„æšä¸¾ç±»ï¼Œè¿™ä¸ªç±»ç”¨äºå¡«è¡¥ Rust ä¸æ”¯æŒ null å¼•ç”¨çš„ç©ºç™½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// enum Option&lt;T&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//    Some(T),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//    None,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨åœºæ™¯:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - åˆå§‹åŒ–å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼, è¡¨ç¤ºç©º, or å‡ºç°çš„ç®€å•é”™è¯¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä½œä¸ºå‡½æ•°å¯é€‰å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä½œä¸ºç»“æ„ä½“çš„å¯é€‰å­—æ®µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä½œä¸ºç»“æ„ä½“ä¸­å¯å€Ÿå‡º/è½½å…¥çš„å­—æ®µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä»£è¡¨ç©ºæŒ‡é’ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è§£å¼€å¯ä»¥é€šè¿‡ match æ¨¡å¼åŒ¹é…, </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡ unwrap ç³»åˆ—æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - expect(&quot;error message&quot;) è§£å¼€ Some, è‹¥ None, åˆ™ panic!(&quot;error message&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// -  unwrap()    è§£å¼€ Some, è‹¥ç¢°åˆ° None, åˆ™ panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - unwrap_or(T)  è§£å¼€ Some, è‹¥ç¢°åˆ° None, åˆ™ è¿”å›æŒ‡å®šçš„é»˜è®¤å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// - unwrap_or_else(FnOnce()-&gt;T) è§£å¼€ Some, ç¢°åˆ° None, åˆ™æ‰§è¡Œä¸€æ®µé—­åŒ… </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> opt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// opt å…è®¸ä¸ºç©º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> opt </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">something</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> something</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;opt is nothing&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›´æ¥å®šä¹‰ä¸€ä¸ª &amp;str ç±»å‹çš„ç©ºå€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//Option æ˜¯ Rust ç¼–è¯‘å™¨é»˜è®¤å¼•å…¥çš„ï¼Œåœ¨ä½¿ç”¨æ—¶å¯ä»¥çœç•¥ Option:: ç›´æ¥å†™ None æˆ–è€… Some()ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> opt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> opt </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">something</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> something</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;opt is nothing&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æµå¼å¤„ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»„åˆç®—å­ combinator: ç®€åŒ– match å¤„ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// map()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// map_or() å¯ä»¥ä¸º None æŒ‡å®šé»˜è®¤å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// map_or_else()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¥å—ä¸€ä¸ªå‡½æ•°f, è¿”å›ä¸€ä¸ªoption, è¿™ä¸ªå‡½æ•°f:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//  - å‚æ•°ä¸ºoptionåŒ…å«çš„å…ƒç´ , è¿”å›å€¼ä¸ºå¤„ç†åçš„å…ƒç´ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¦æ±‚å¤„ç†çš„optionä¸­å…ƒç´ å¯ä»¥æ˜¯ä¸åŒç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Apple</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Potato</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Peeled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//å‰Šçš®çš„é£Ÿç‰©</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Chopped</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//åˆ‡å—çš„é£Ÿç‰©</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Cooked</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// çƒ¹ç…®çš„é£Ÿç‰©</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">process</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Cooked</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">foo</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Peeled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">// é—­åŒ…å‚æ•°æ˜¯Food ç±»å‹, è¿™é‡Œæ˜¯è§£å¼€äº† Option, è¿”å› Option&lt;Peeled&gt; ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params class-name" style="color:rgb(38, 127, 153)">Peeled</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params">foo</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Chopped</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‚æ•°æ˜¯ Peeled ç±»å‹, è¿™é‡Œè§£å¼€äº†Option, Peeled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params class-name" style="color:rgb(38, 127, 153)">Chopped</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params">foo</span><span class="token closure-params punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cooked</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">process</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Apple</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">cooked</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;cooked: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cooked</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// and_then() </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ¥å—ä¸€ä¸ªå‡½æ•°fä½œä¸ºå‚æ•°, è¿”å›option, å‡½æ•°fæ»¡è¶³: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//- å‚æ•°ä¸º option åŒ…å«çš„å…ƒç´ , è¿”å›ä¸ºoption</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¦æ±‚å¤„ç†çš„optionä¸­å…ƒç´ æ˜¯ç›¸åŒç±»å‹, æ¯”å¦‚éƒ½å±äºæŸä¸ªæšä¸¾ç±»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_potato</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Potato</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">to_potato</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Food</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Apple</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">and_then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">to_banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;banana: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> banana</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5193-c-é£æ ¼çš„æšä¸¾">5.19.3. c é£æ ¼çš„æšä¸¾<a href="#5193-c-é£æ ¼çš„æšä¸¾" class="hash-link" aria-label="5.19.3. c é£æ ¼çš„æšä¸¾çš„ç›´æ¥é“¾æ¥" title="5.19.3. c é£æ ¼çš„æšä¸¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‹¥æœ‰éšå¼è¾¨åˆ«å€¼ï¼ˆimplicit discriminatorï¼Œä» 0 å¼€å§‹ï¼‰çš„ enum</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Zero</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">One</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Two</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// c é£æ ¼æšä¸¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‹¥æœ‰æ˜¾å¼è¾¨åˆ«å€¼ï¼ˆexplicit discriminatorï¼‰çš„ enum</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Color</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Red</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0xff0000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Green</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0x00ff00</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Blue</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0x0000ff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `enum` å¯ä»¥è½¬æˆæ•´å½¢ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;zero is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Zero</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;one is {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">One</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;roses are #{:06x}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Color</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Red</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//ff0000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;violets are #{:06x}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Color</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Blue</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//0000ff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5194-æ¡ˆä¾‹-å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–">5.19.4. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–<a href="#5194-æ¡ˆä¾‹-å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–" class="hash-link" aria-label="5.19.4. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–çš„ç›´æ¥é“¾æ¥" title="5.19.4. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::convert::From;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::str::FromStr;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::string::String;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::fmt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Clone, Copy, Debug, PartialEq, Eq)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enum Color {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Red,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Yellow,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Blue,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Color {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn to_fg_str(&amp;self) -&gt; &amp;str {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match *self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Color::Red =&gt; &quot;31&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Color::Yellow =&gt; &quot;33&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Color::Blue =&gt; &quot;34&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn to_bg_str(&amp;self) -&gt; &amp;str {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match *self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Color::Red =&gt; &quot;41&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Color::Yellow =&gt; &quot;43&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Color::Blue =&gt; &quot;44&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;&#x27;a&gt; From&lt;&amp;&#x27;a str&gt; for Color {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn from(src: &amp;str) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // parse æ–¹æ³•ï¼Œè¦æ±‚ç›®æ ‡ç±»å‹å¿…é¡»å®ç° FromStr</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        src.parse().unwrap_or(Color::Red)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl From&lt;String&gt; for Color {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn from(src: String) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        src.parse().unwrap_or(Color::Red)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl FromStr for Color {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    type Err = ();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //  from sä»• æ–¹æ³•åŒ…å«äº† é”™è¯¯å¤„ç†ç›¸å…³çš„ä»£ç </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn from_str(src: &amp;str) -&gt; Result&lt;Self, Self::Err&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let src = src.to_lowercase();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match src.as_ref() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;red&quot; =&gt; Ok(Color::Red),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;yellow&quot; =&gt; Ok(Color::Yellow),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;blue&quot; =&gt; Ok(Color::Blue),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ =&gt; Err(()),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Clone, Debug, PartialEq, Eq)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input: String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fgcolor: Option&lt;Color&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bgcolor: Option&lt;Color&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn compute_style(&amp;self) -&gt; String {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut res = String::from(&quot;\x1B[&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut has_wrote = false;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if let Some(ref bgcolor) = self.bgcolor {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if has_wrote {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                res.push(&#x27;;&#x27;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            res.push_str(bgcolor.to_bg_str());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            has_wrote = true;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if let Some(ref fgcolor) = self.fgcolor {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if has_wrote {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                res.push(&#x27;;&#x27;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            res.push_str(fgcolor.to_fg_str());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        res.push(&#x27;m&#x27;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        res</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Default for ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn default() -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input: String::default(),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fgcolor: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            bgcolor: None,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// impl&lt;&#x27;a&gt; From&lt;&amp;&#x27;a str&gt; for ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//     fn from(s: &amp;&#x27;a str) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//         ColoredString { input: String::from(s), ..ColoredString::default() }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//     }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait Colorize {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn red(self) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn yellow(self) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn blue(self) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // Colorå®ç°äº† Fromï¼Œæ‰€ä»¥å¯¹äº Stringå’Œ&amp;â€™a strç±»å‹çš„å­—ç¬¦ä¸²å‡å¯é€š è¿‡ into æ–¹æ³•è½¬æ¢ä¸º Color</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn color&lt;S: Into&lt;Color&gt;&gt;(self, color: S) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_red(self) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_yellow(self) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_blue(self) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_color&lt;S: Into&lt;Color&gt;&gt;(self, color: S) -&gt; ColoredString;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Colorize for ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn red(self) -&gt; ColoredString {self.color(Color::Red)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn yellow(self) -&gt; ColoredString {self.color(Color::Yellow)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn blue(self) -&gt; ColoredString {self.color(Color::Blue)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn color&lt;S: Into&lt;Color&gt;&gt;(self, color: S) -&gt; ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColoredString { fgcolor: Some(color.into()), ..self }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_red(self) -&gt; ColoredString {self.on_color(Color::Red)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_yellow(self) -&gt; ColoredString {self.on_color(Color::Yellow)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_blue(self) -&gt; ColoredString {self.on_color(Color::Blue)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_color&lt;S: Into&lt;Color&gt;&gt;(self, color: S) -&gt; ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColoredString { bgcolor: Some(color.into()), ..self }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl&lt;&#x27;a&gt; Colorize for &amp;&#x27;a str {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn red(self) -&gt; ColoredString {self.color(Color::Red)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn yellow(self) -&gt; ColoredString {self.color(Color::Yellow)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn blue(self) -&gt; ColoredString {self.color(Color::Blue)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn color&lt;S: Into&lt;Color&gt;&gt;(self, color: S) -&gt; ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fgcolor: Some(color.into()),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input: String::from(self),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ..ColoredString::default()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_red(self) -&gt; ColoredString {self.on_color(Color::Red)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_yellow(self) -&gt; ColoredString {self.on_color(Color::Yellow)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_blue(self) -&gt; ColoredString {self.on_color(Color::Blue)}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn on_color&lt;S: Into&lt;Color&gt;&gt;(self, color: S) -&gt; ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            bgcolor: Some(color.into()),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            input: String::from(self),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ..ColoredString::default()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl fmt::Display for ColoredString {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut input = &amp;self.input.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        try!(f.write_str(&amp;self.compute_style()));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        try!(f.write_str(input));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        try!(f.write_str(&quot;\x1B[0m&quot;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Ok(())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let red = &quot;red&quot;.red();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, red);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let yellow = &quot;yellow&quot;.yellow().on_blue();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, yellow);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let blue = &quot;blue&quot;.blue();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, blue);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let red = &quot;red&quot;.color(&quot;red&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, red);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let yellow = &quot;yellow&quot;.on_color(&quot;yellow&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, yellow);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5195-å®ä¾‹-åˆ›å»ºé“¾è¡¨">5.19.5. å®ä¾‹ åˆ›å»ºé“¾è¡¨<a href="#5195-å®ä¾‹-åˆ›å»ºé“¾è¡¨" class="hash-link" aria-label="5.19.5. å®ä¾‹ åˆ›å»ºé“¾è¡¨çš„ç›´æ¥é“¾æ¥" title="5.19.5. å®ä¾‹ åˆ›å»ºé“¾è¡¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// enum çš„ä¸€ä¸ªå¸¸è§ç”¨æ³•å°±æ˜¯åˆ›å»ºé“¾è¡¨ï¼ˆlinked-listï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Consï¼šå…ƒç»„ç»“æ„ä½“ï¼ŒåŒ…å«é“¾è¡¨çš„ä¸€ä¸ªå…ƒç´ å’Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹çš„æŒ‡é’ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Nilï¼šæœ«ç»“ç‚¹ï¼Œè¡¨æ˜é“¾è¡¨ç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯ä»¥ä¸º enum å®šä¹‰æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»ºä¸€ä¸ªç©ºçš„ List å®ä¾‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤„ç†ä¸€ä¸ª Listï¼Œåœ¨å…¶å¤´éƒ¨æ’å…¥æ–°å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥ List</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// self ä¸åŠ  &amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">prepend</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> elem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">List</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// `Cons` åŒæ ·ä¸º List ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">elem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿”å› List çš„é•¿åº¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// `self` ä¸º `&amp;List` ç±»å‹ï¼Œ`*self` ä¸º `List` ç±»å‹ï¼ŒåŒ¹é…ä¸€ä¸ªå…·ä½“çš„ `T`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»å‹è¦å¥½è¿‡åŒ¹é…å¼•ç”¨ `&amp;T`ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸èƒ½å¾—åˆ° tail çš„æ‰€æœ‰æƒï¼Œå› ä¸º `self` æ˜¯å€Ÿç”¨çš„ï¼›æ‰€ä»¥è¦ä½¿ç”¨å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› æ­¤ä½¿ç”¨ä¸€ä¸ªå¯¹ tail çš„å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> tail</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> tail</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">// ï¼ˆé€’å½’çš„ï¼‰åŸºå‡†æƒ…å½¢ï¼ˆbase caseï¼‰ï¼šä¸€ä¸ªé•¿åº¦ä¸º 0 çš„ç©ºåˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿”å›åˆ—è¡¨çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼ˆè¯¥å­—ç¬¦ä¸²æ˜¯å †åˆ†é…çš„ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">stringify</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cons</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">head</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> tail</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `format!` å’Œ `print!` ç±»ä¼¼ï¼Œä½†è¿”å›çš„æ˜¯ä¸€ä¸ªå †åˆ†é…çš„å­—ç¬¦ä¸²ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}, {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> head</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> tail</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">stringify</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">Nil</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Nil&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// // åˆ›å»ºä¸€ä¸ªç©ºé“¾è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// let mut list = List::new();</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// // è¿½åŠ ä¸€äº›å…ƒç´ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// list = list.prepend(1);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// list = list.prepend(2);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// list = list.prepend(3);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// // æ˜¾ç¤ºé“¾è¡¨çš„æœ€åçŠ¶æ€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// println!(&quot;linked list has length: {}&quot;, list.len());</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// println!(&quot;{}&quot;, list.stringify());</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="520-match-æ¨¡å¼åŒ¹é…">5.20. match æ¨¡å¼åŒ¹é…<a href="#520-match-æ¨¡å¼åŒ¹é…" class="hash-link" aria-label="5.20. match æ¨¡å¼åŒ¹é…çš„ç›´æ¥é“¾æ¥" title="5.20. match æ¨¡å¼åŒ¹é…çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5201-æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨">5.20.1. æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨<a href="#5201-æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨" class="hash-link" aria-label="5.20.1. æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.20.1. æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// match æ¨¡å¼åŒ¹é…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ç±»ä¼¼ Java ä¸­çš„ switch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å¿…é¡»ç©·å°½æ‰€æœ‰åˆ†æ”¯ (ä½¿ç”¨ _ å¿½ç•¥æŸä¸ªæƒ…å†µ), æ¯ä¸ªåˆ†æ”¯è¿”å›åŒä¸ªç±»å‹ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">match_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;------------------------ match demo ------------------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯ä»¥å¯¹æšä¸¾ç±», å¯¹æ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡å¼•ç”¨ï¼ˆ&amp;strï¼‰ç±»å‹çš„æ•°æ®è¿›è¡Œåˆ†æ”¯é€‰æ‹©,    </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// match è¿”å›çš„å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;len = 5&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;len = 0&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;unkonwn len&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½œä¸ºå‡½æ•°è¿”å›å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å®ç°ä¸€ä¸ªç¼“å­˜, ä¿å­˜ç¬¬ä¸€æ¬¡å¤„ç†åçš„å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Cache</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">where</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡½æ•°ç±»å‹ä½œä¸ºæ³›å‹, Fn æ˜¯ä¸€ä¸ª trait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        calc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Fn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cache</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">caculator</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cache</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                caculator</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> caculator</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤–å±‚ match æ²¡æœ‰ return, æ²¡æœ‰ åˆ†å· </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿”å›å€¼åªæ˜¯è¿”å›ç»™ match è¡¨è¾¾å¼, ä¸æ˜¯ç›´æ¥è¿”å›ç»™äº†å¤–å±‚çš„å‡½æ•°, è‹¥æƒ³ç›´æ¥è¿”å›ç»™å‡½æ•°, éœ€è¦ return å…³é”®å­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ç¬¬ä¸€æ¬¡, arg = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">caculator</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// å¿…é¡»æœ‰æ‹¬å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// self å¿…é¡»å¯å˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    v</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> ca </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Cache</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">x</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> x</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œå¯ä»¥çœç•¥å‚æ•°ç±»å‹æ˜¯å› ä¸ºç±»å‹ä¿¡æ¯å®šä¹‰åœ¨å‰é¢çš„æ³›å‹ä¸­äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;arg = 1, v = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ca</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;arg = 1, v = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ca</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å’Œ if åˆç”¨çš„åŒ¹é…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       x </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">is_normal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       _                      </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5202-if-lef-while-let-è¯­æ³•ç³–">5.20.2. if lef while let è¯­æ³•ç³–<a href="#5202-if-lef-while-let-è¯­æ³•ç³–" class="hash-link" aria-label="5.20.2. if lef while let è¯­æ³•ç³–çš„ç›´æ¥é“¾æ¥" title="5.20.2. if lef while let è¯­æ³•ç³–çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// if let è¯­æ³•ç³–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//é€‚ç”¨äºåªåŒºåˆ†ä¸¤ç§æƒ…å†µçš„ match è¯­å¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¯­æ³•:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// if let åŒ¹é…å€¼ = æºå˜é‡ {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//    è¯­å¥å—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Papery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Electronic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> book </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Electronic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;url&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Book</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Papery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> book </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Papery {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Not papery book&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»ä¼¼çš„è¿˜æœ‰ while let è¯­æ³•ç³–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">while</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> xx_vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">pop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="521-é”™è¯¯å¤„ç†">5.21. é”™è¯¯å¤„ç†<a href="#521-é”™è¯¯å¤„ç†" class="hash-link" aria-label="5.21. é”™è¯¯å¤„ç†çš„ç›´æ¥é“¾æ¥" title="5.21. é”™è¯¯å¤„ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://www.v2ex.com/t/843118#reply6" target="_blank" rel="noopener noreferrer">https://www.v2ex.com/t/843118#reply6</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5211-æ–­è¨€">5.21.1. æ–­è¨€<a href="#5211-æ–­è¨€" class="hash-link" aria-label="5.21.1. æ–­è¨€çš„ç›´æ¥é“¾æ¥" title="5.21.1. æ–­è¨€çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// assert ç³»åˆ—å®åœ¨è°ƒè¯•( Debug)å’Œå‘å¸ƒ( Release)æ¨¡å¼ä¸‹å‡å¯ç”¨ï¼Œ å¹¶ä¸”ä¸èƒ½è¢«ç¦ç”¨ã€‚ debug_assertç³»åˆ—å®åªåœ¨è°ƒè¯•æ¨¡å¼ä¸‹èµ·ä½œç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å°½é‡ä½¿ç”¨ debug_assert ç³»åˆ—å®è¾ƒå°æ€§èƒ½å¼€é”€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åº•å±‚å®é™…ä¹Ÿæ˜¯ä½¿ç”¨ panic! å®å¼•å‘çº¿ç¨‹ææ…Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ assert!ï¼Œ ç”¨äºæ–­è¨€å¸ƒå°”è¡¨è¾¾å¼åœ¨è¿è¡Œæ—¶ä¸€å®šè¿”å› trueã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ assert_eq!ï¼Œ ç”¨äºæ–­ è¨€ä¸¤ä¸ªè¡¨è¾¾å¼æ˜¯å¦ç›¸ç­‰(ä½¿ç”¨ PartialEq)ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ assert_ne!ï¼Œ ç”¨äºæ–­è¨€ä¸¤ä¸ªè¡¨è¾¾å¼æ˜¯å¦ä¸ç›¸ç­‰(ä½¿ç”¨ PartialEq)ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ debug_assert!ï¼Œ ç­‰ä»·äº asseæ­¤!ï¼Œåªèƒ½ç”¨äºè°ƒè¯•æ¨¡å¼ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ debug assert_eq!ï¼Œ ç­‰ä»·äº asseæ­¤ä¸€eq!ï¼Œåªèƒ½ç”¨äºè°ƒè¯•æ¨¡å¼ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ debug_assert_ne!ï¼Œ ç­‰ä»·äº assert ne!ï¼Œåªèƒ½ç”¨äºè°ƒè¯•æ¨¡å¼ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å‡ä¼šå¼•å‘çº¿ç¨‹ææ…Œ, åŒæ—¶è¾“å‡ºé”™è¯¯ä¿¡æ¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">assert! (x,&quot;x wasnâ€™t true&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">debug_assert!(a + b == 30,&quot;a={), b = {}&quot;, a, b);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5212-panic-å’Œ-abort">5.21.2. panic å’Œ Abort<a href="#5212-panic-å’Œ-abort" class="hash-link" aria-label="5.21.2. panic å’Œ Abortçš„ç›´æ¥é“¾æ¥" title="5.21.2. panic å’Œ Abortçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// panic ä¸ºçº¿ç¨‹ææ…Œ, ä¼šé€ æˆåº”ç”¨ç¨‹ åºä»¥éé›¶é€€å‡ºç é€€å‡ºè¿›ç¨‹ï¼Œ ä¹Ÿå°±æ˜¯å‘ç”Ÿå´©æºƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Abort ä¸ºçº¿ç¨‹ç»ˆæ­¢, å°†è¿›ç¨‹ æ­£å¸¸ä¸­æ­¢ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// RUST_BACKTRACE=1 cargo run è¿™ç§æ–¹å¼è¿è¡Œå¸¦æœ‰å›æº¯, ç¢°åˆ° panic!(&quot;xxx&quot;) ä¼šæ˜¾ç¤º backtrace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å¦‚æœæƒ³ä½¿ä¸€ä¸ªå¯æ¢å¤é”™è¯¯æŒ‰ä¸å¯æ¢å¤é”™è¯¯å¤„ç†(ç±»æ¯”java ä¸­ å°† exceptin è½¬ä¸º runtime exception)ï¼ŒResult ç±»æä¾›äº†ä¸¤ä¸ªåŠæ³•ï¼šunwrap() å’Œ expect(message: &amp;str) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// https://rust-cli.github.io/book/tutorial/errors.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">error_handling</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨ panic!() å®: å¯¹äºä¸å¯æ¢å¤é”™è¯¯ä½¿ç”¨ panic! å®æ¥å¤„ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> f </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello.txt&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> f </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;File opened successfully.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Failed to open the file.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// if let è¯­æ³•ç³–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> f </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello.txt&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> f </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;File opened successfully.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Failed to open the file.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// panic ä¼šä¸­æ–­ç¨‹åº, è‹¥ä¸å¸Œæœ›ä¸­æ–­ç¨‹åº, ä¸è¦ panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç®€åŒ–å†™æ³•: ç›´æ¥è§£åŒ…è£…, å¯æ¢å¤å¼‚å¸¸ä¹Ÿä¼š panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸ä¼šä¸ºå‡½æ•°äº§ç”Ÿè¿”å›å€¼, è€Œæ˜¯ç›´æ¥ panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> f1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello.txt&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//åŸç†: åœ¨ Result ä¸º Err æ—¶è°ƒç”¨ panic! å®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> f2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello.txt&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Failed to open.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//expect èƒ½å¤Ÿå‘ panic! å®å‘é€ä¸€æ®µæŒ‡å®šçš„é”™è¯¯ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‡ªå·±æ§åˆ¶æ˜¯å¦ panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">unwrap_or_else</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">e</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">  </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;failed to execute process: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5213-result--å’Œ-é—®å·æ“ä½œç¬¦">5.21.3. Result  å’Œ é—®å·æ“ä½œç¬¦<a href="#5213-result--å’Œ-é—®å·æ“ä½œç¬¦" class="hash-link" aria-label="5.21.3. Result  å’Œ é—®å·æ“ä½œç¬¦çš„ç›´æ¥é“¾æ¥" title="5.21.3. Result  å’Œ é—®å·æ“ä½œç¬¦çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å¯æ¢å¤é”™è¯¯, ç”¨ Result&lt;T, E&gt; ç±»æ¥å¤„ç†ï¼Œ,ç±»æ¯” java ä¸­ çš„ exception</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// //åœ¨ Rust æ ‡å‡†åº“ä¸­å¯èƒ½äº§ç”Ÿå¼‚å¸¸çš„å‡½æ•°çš„è¿”å›å€¼éƒ½æ˜¯ Result ç±»å‹çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// enum Result&lt;T, E&gt; { </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///   Ok(T),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///   Err(E),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¼‚å¸¸ä¼ é€’, å‡½æ•°è¿”å›å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">g</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> t </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€…çœç•¥ return å’Œåˆ†å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŸæ ·ä¼ ç»™ match, matchä½œä¸ºæœ€ç»ˆç»“æ„ä¼ ç»™å‡½æ•°è¿”å›å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ›´å¥½çš„å†™æ³•: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//? ç¬¦çš„å®é™…ä½œç”¨æ˜¯å°† Result ç±»éå¼‚å¸¸çš„å€¼ç›´æ¥å–å‡ºï¼Œå¦‚æœæœ‰å¼‚å¸¸å°±å°†å¼‚å¸¸ Result è¿”å›å‡ºå»ã€‚æ‰€ä»¥ï¼Œ? ç¬¦ä»…ç”¨äºè¿”å›å€¼ç±»å‹ä¸º Result&lt;T, E&gt; çš„å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//?å· æ˜¯ â€œè¦ä¹ˆ unwrap è¦ä¹ˆ return Err(From::from(err))â€ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¼šä¸ºå‡½æ•°äº§ç”Ÿè¿”å›å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">g1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">func</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› ä¸ºç¡®å®š t ä¸æ˜¯ Err, t åœ¨è¿™é‡Œå·²ç»æ˜¯ i32 ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> r </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">g1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">10000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> r </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ok, r = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Err&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·å– error ç±»å‹, å¤„ç†å¼‚å¸¸</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">read_text_from_file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Error</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> f </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> str_file </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">read_text_from_file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello.txt&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> str_file </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">kind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">ErrorKind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">NotFound</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;No such file&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Cannot read the file&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Result çš„ map, and_then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç±»ä¼¼ option, resultä¹Ÿæœ‰è‡ªå·±çš„é“¾å¼å¤„ç†æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">num</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">ParseIntError</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">multiply</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">first_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> second_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ParseIntError</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// parse() è¿”å›çš„æ˜¯ result ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        first_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">and_then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">first_number</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            second_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">second_number</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> first_number </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> second_number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ›´æ¨èçš„å†™æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¨èç»™ å¤ªé•¿çš„ç±»å‹èµ·ä¸ªåˆ«å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">AliasedResult</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ParseIntError</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">multiply1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">first_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> second_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">AliasedResult</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> first_number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> first_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> second_number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> second_number_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">first_number </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> second_number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5214-é”™è¯¯è£…ç®±-è‡ªå®šä¹‰å¼‚å¸¸">5.21.4. é”™è¯¯è£…ç®± è‡ªå®šä¹‰å¼‚å¸¸<a href="#5214-é”™è¯¯è£…ç®±-è‡ªå®šä¹‰å¼‚å¸¸" class="hash-link" aria-label="5.21.4. é”™è¯¯è£…ç®± è‡ªå®šä¹‰å¼‚å¸¸çš„ç›´æ¥é“¾æ¥" title="5.21.4. é”™è¯¯è£…ç®± è‡ªå®šä¹‰å¼‚å¸¸çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è£…ç®±å¯ä»¥ä¿å­˜åŸå§‹é”™è¯¯ä¿¡æ¯, åå¤„å°±æ˜¯ï¼Œè¢«åŒ…è£…çš„é”™è¯¯ç±»å‹åªèƒ½åœ¨è¿è¡Œæ—¶äº†è§£ï¼Œè€Œä¸èƒ½è¢«é™æ€åœ° åˆ¤åˆ«ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯¹ä»»ä½•å®ç°äº† Error trait çš„ç±»å‹ï¼Œæ ‡å‡†åº“çš„ Box é€šè¿‡ From ä¸ºå®ƒä»¬æä¾›äº† åˆ° Box&lt;Error&gt; çš„è½¬æ¢, åªè¦è°ƒç”¨ XxxError.into() å³è£…ç®±</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">fmt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸º `Box&lt;error::Error&gt;` å–åˆ«åã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">result</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Error</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‡ªå®šä¹‰å¼‚å¸¸ /////////////////////////////</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿˜å¿…é¡»åŒæ—¶å®ç° Debug å’Œ Display</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug, Clone)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">EmptyVec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Display</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">EmptyVec</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">fmt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Formatter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token namespace">fmt</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">write!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;invalid first item to double&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Error</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">EmptyVec</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">description</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;invalid first item to double&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">cause</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Error</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ³›å‹é”™è¯¯ã€‚æ²¡æœ‰è®°å½•å…¶å†…éƒ¨åŸå› ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å°†ç¬¬ä¸€ä¸ªæ•°å­—ä¹˜ä»¥2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">double_first</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">first</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">ok_or_else</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">EmptyVec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// è£…ç®±</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">and_then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">s</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map_err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">e</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// è£…ç®±</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">i</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ›´å¥½çš„å†™æ³•: ä½¿ç”¨ ? å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ?å· æ˜¯ â€œè¦ä¹ˆ unwrap è¦ä¹ˆ return Err(From::from(err))â€ã€‚From::from æ˜¯ ä¸åŒç±»å‹é—´çš„è½¬æ¢å·¥å…·ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">double_first</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> first </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">first</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">ok_or</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">EmptyVec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> parsed </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> first</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> parsed</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5215-æ•è·å¼‚å¸¸">5.21.5. æ•è·å¼‚å¸¸<a href="#5215-æ•è·å¼‚å¸¸" class="hash-link" aria-label="5.21.5. æ•è·å¼‚å¸¸çš„ç›´æ¥é“¾æ¥" title="5.21.5. æ•è·å¼‚å¸¸çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// ææ…Œå®‰å…¨: å‘ç”Ÿ panicå, ä»£ç ç»ˆæ­¢æ‰§è¡Œ, åç»­çš„èµ„æºå›æ”¶ç›¸å…³çš„ä»£ç ä¸ä¼šæ‰§è¡Œ, å¯èƒ½å¼•å‘é—®é¢˜, é˜²æ­¢è¿™æ ·çš„é—®é¢˜å°±æ˜¯ä¿è¯ææ…Œå®‰å…¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// rust é€šè¿‡ raiiæœºåˆ¶, ä¿è¯äº†åŸºæœ¬çš„ææ…Œå®‰å…¨, å³ä½¿åœ¨ safe rust ä¸­å‘ç”Ÿ panic, ä¹Ÿèƒ½ä¿è¯èµ„æºå›æ”¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½†æ˜¯è‹¥ panic å‘ç”Ÿåœ¨ unsafe rust é‡Œé¢, å°±æ— æ³•ä¿è¯ææ…Œå®‰å…¨äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// catch_unwind æ–¹æ³•æ¥è®©å¼€å‘è€…æ•è·ææ…Œï¼Œæ¢å¤å½“å‰çº¿ç¨‹ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ¥æ”¶çš„æ˜¯ä¸€ä¸ªæ­£å¸¸çš„é—­åŒ…ï¼Œåœ¨è¯¥é—­åŒ…ä¸­ å¹¶æœªå‘ç”Ÿææ…Œï¼Œæ‰€ ä»¥æ­£å¸¸æ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let result = panic::catch_unwind(|| { println!(&quot;hello!&quot;); });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">assert!(result.is_ok());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ•è·æ­¤ææ…Œï¼Œå¹¶æ¢å¤å½“å‰çº¿ç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let result = panic::catch_unwind(|| { panic!(&quot;oh no!&quot;); });// è¾“ å‡º ç»“æœ ä¸­æ‰“å° äº†ææ…Œä¿¡æ¯ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å½± å“ åˆ°åç»­ä»£ç  çš„æ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">assert!(result.is_err());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println!(&quot;{}&quot;, sum(1, 2));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½¿ç”¨ set_hook è‡ªå®šä¹‰panic æ¶ˆæ¯æ¶ˆæ¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// set_hook æ˜¯å…¨å±€æ€§è®¾ç½®ï¼Œ å¹¶ä¸æ˜¯åªé’ˆå¯¹å•ä¸ªä»£ç æ¨¡å—çš„, å¯ä»¥å’Œ take_hook é…åˆä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">panic::set_hook(Box::new(|panic_info| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    if let Some(location) = panic_info.location() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;panic occurred &#x27;{}&#x27; at {}&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            location.file(), location.line()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;can&#x27;t get location information...&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">let result = panic::catch_unwind(|| { panic!(&quot;oh no!&quot;); });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">assert!(result.is_err());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5216-é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹">5.21.6. é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹<a href="#5216-é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹" class="hash-link" aria-label="5.21.6. é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹çš„ç›´æ¥é“¾æ¥" title="5.21.6. é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›´æ¥è§£é™¤åŒ…è£…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¯»å–æ–‡ä»¶å†…å®¹, ä¸€æ­¥åˆ°ä½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&gt;&gt;&gt; Error occurred: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿”å› error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦ main è¿”å› Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">into</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨é—®å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Error</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ·»åŠ é”™è¯¯ä¸Šä¸‹æ–‡, è‡ªå®šä¹‰å¼‚å¸¸</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    main </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)">SomeErr</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map_err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">err</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">SomeErr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Error of reading {}: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">failure</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">ResultExt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">exitfailure</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">ExitFailure</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ref</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PathBuf</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">with_context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">_</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;could not read file {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5217-ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸">5.21.7. ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸<a href="#5217-ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸" class="hash-link" aria-label="5.21.7. ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸çš„ç›´æ¥é“¾æ¥" title="5.21.7. ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>anyhow + thiserror</p><p><a href="https://github.com/rust-cli/human-panic" target="_blank" rel="noopener noreferrer">https://github.com/rust-cli/human-panic</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="522-io">5.22. io<a href="#522-io" class="hash-link" aria-label="5.22. ioçš„ç›´æ¥é“¾æ¥" title="5.22. ioçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5221-å‘½ä»¤è¡Œå‚æ•°">5.22.1. å‘½ä»¤è¡Œå‚æ•°<a href="#5221-å‘½ä»¤è¡Œå‚æ•°" class="hash-link" aria-label="5.22.1. å‘½ä»¤è¡Œå‚æ•°çš„ç›´æ¥é“¾æ¥" title="5.22.1. å‘½ä»¤è¡Œå‚æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">io_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> args </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">env</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;args: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//Args { inner: [&quot;target/debug/hello&quot;, &quot;main.rs&quot;] }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> item </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> args </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;arg: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//arg: target/debug/hello</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//arg: main.rs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arg0 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// å‘½ä»¤æœ¬èº«, æ‹¿åˆ°å‚æ•°è¦ä¸¤ä¸ª args.next()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€…ä¸€æ­¥åˆ°ä½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> pattern </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">env</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">nth</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;no pattern given&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€…é€šè¿‡ vector æ”¶é›†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">env</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‘½ä»¤è¡Œè¾“å…¥æ–‡æœ¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> secret_number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">rand</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">thread_rng</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">gen_range</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">101</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Please input your guess.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> guess </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">stdin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read_line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> guess</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Failed to read line&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> guess</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> guess</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">trim</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">continue</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;You guessed: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> guess</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> guess</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">cmp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">secret_number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Less</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Too small!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Greater</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Too big!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Equal</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;You win!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">break</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5222-æ–‡ä»¶-io">5.22.2. æ–‡ä»¶ io<a href="#5222-æ–‡ä»¶-io" class="hash-link" aria-label="5.22.2. æ–‡ä»¶ ioçš„ç›´æ¥é“¾æ¥" title="5.22.2. æ–‡ä»¶ ioçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// //////////////////////////  æ–‡ä»¶ io //////////////</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">fs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">prelude</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ¶‰åŠåˆ° write éœ€è¦ ä¸‡èƒ½å¯¼å…¥ prelude</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»ºå†™å…¥æ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//é™æ€æ–¹æ³•ï¼Œä»¥ å¯å†™ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™æ¸…ç©ºæ—§å†…å®¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™æ–°å»º                  ç±»ä¼¼ echo &quot;xxxx&quot; &gt; path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> file </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">create</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;./cc.md&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;create file error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write_all</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;write error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write_all</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot; world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;write error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write_all</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;\nä½ å¥½&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;write error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¯»å–æ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸€æ¬¡æ€§è¯»å–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é™æ€æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> text </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;./Cargo.toml&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›¸å¯¹è·¯å¾„æ˜¯ç›¸å¯¹äºæ ¹ç›®å½•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> file </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;./cc.md&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;open error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// åªè¯»æ¨¡å¼æ‰“å¼€, ç›¸å½“äº cat &lt;path&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> str_buf </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å®ä¾‹æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> str_buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;read error&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> str_buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¿®æ”¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//  append() ç”¨äºå°†æ–‡ä»¶çš„æ‰“å¼€æ¨¡å¼è®¾ç½®ä¸º è¿½åŠ æ¨¡å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ­¤å¤–è¿˜æœ‰ .read(true).write(true)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¯”å¦‚  OpenOptions::new().create(true).write(true).open(path) å¯åˆ›å»º, å¯å†™æ¨¡å¼æ‰“å¼€ , ç›¸å½“äº touch xxx , æœ‰åˆ™ä¸åŠ¨, æ— åˆ™åˆ›å»º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> file </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">OpenOptions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">append</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;./cc.md&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write_all</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;\nappend something...&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> updated_content </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;./cc.md&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> updated_content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¯»å†™äºŒè¿›åˆ¶æ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ–‡ä»¶æµè¯»å–, å¤šæ¬¡è¯»å–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// äºŒè¿›åˆ¶ ä½¿ç”¨ std::fs::read(&quot;&quot;) è¯»å– u8 ç±»å‹é›†åˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤åˆ¶æ–‡ä»¶çš„ demo:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buffer </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> file </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;cc.md&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;æ–‡ä»¶æ‰“å¼€æˆåŠŸï¼š{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//File { fd: 3, path: &quot;.../data.txt&quot;, read: true, write: false }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">remove_file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;cc.md&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å…¶ä»–æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»º ç›®å½•, è¿”å› io::Result&lt;()&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">create_dir</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é€’å½’åˆ›å»º,ç›®å½•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">create_dir_all</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a/c/d&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»ºç¬¦å·é“¾æ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">unix</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">symlink</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;../b.txt&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a/c/b.txt&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è¯»å–ç›®å½•ä¸‹çš„æ‰€æœ‰çš„å†…å®¹ï¼Œè¿”å› `io::Result&lt;Vec&lt;Path&gt;&gt;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">read_dir</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;! {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">kind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">paths</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> paths </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&gt; {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç§»é™¤ä¸€ä¸ªç©ºç›®å½•ï¼Œè¿”å› `io::Result&lt;()&gt;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">remove_dir</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a/c/d&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-----------------meta -------------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// metadata å…ƒæ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éå†ç›®å½•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> meta </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">metadata</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;./src&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/*</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">        Ok(Metadata {</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            file_type: FileType(FileType {</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                mode: 16895</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            }),</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            is_dir: true,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            is_file: false,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            permissions: Permissions(FilePermissions {</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                mode: 16895</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            }),</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            modified: Ok(SystemTime {</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                tv_sec: 1597127845,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                tv_nsec: 217049100</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            }),</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            accessed: Ok(SystemTime {</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                tv_sec: 1597132516,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                tv_nsec: 30962100</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            }),</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            created: Err(Custom {</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                kind: Other,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">                error: &quot;creation time is not available for the filesystem&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">            })</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">        })</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">    */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;meta = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> meta</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;src is dir? {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> meta</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">is_dir</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">copy_file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> command_line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">env</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Args</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">env</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   command_line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·³è¿‡ç¨‹åºå</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)">// åŸæ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> source </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> command_line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ–°æ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> destination </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> command_line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">next</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> file_in </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> file_out </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">File</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">create</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">destination</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buffer </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0u8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Write</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> nbytes </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> file_in</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      file_out</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">nbytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> nbytes </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">break</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœæŸæ¬¡è¯»å–æ²¡æœ‰å°† buf è¯»æ»¡, åˆ™å†™å®Œåé€€å‡ºå¾ªç¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="523-é¢å‘å¯¹è±¡-oop">5.23. é¢å‘å¯¹è±¡ oop<a href="#523-é¢å‘å¯¹è±¡-oop" class="hash-link" aria-label="5.23. é¢å‘å¯¹è±¡ oopçš„ç›´æ¥é“¾æ¥" title="5.23. é¢å‘å¯¹è±¡ oopçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5231-å¯è§æ€§">5.23.1. å¯è§æ€§<a href="#5231-å¯è§æ€§" class="hash-link" aria-label="5.23.1. å¯è§æ€§çš„ç›´æ¥é“¾æ¥" title="5.23.1. å¯è§æ€§çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// rust ä¸‹æ‰€æœ‰å…ƒç´ éƒ½æ˜¯é»˜è®¤ç§æœ‰çš„, æ— æ³•åœ¨å¤–éƒ¨ä½¿ç”¨, é€šè¿‡ pub å£°æ˜ä¸º å…¬å¼€, æ‰èƒ½åœ¨å¤–éƒ¨ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - pubï¼Œ å¯ä»¥å¯¹å¤– æš´éœ² å…¬å…±æ¥å£ï¼Œéšè—å†…éƒ¨å®ç°ç»†èŠ‚ (å¯ç”¨äºä»»ä½•å¯¹è±¡)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - pub(crate)ï¼Œå¯¹æ•´ä¸ª crate å¯è§ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - pub(in Path)ï¼Œå…¶ä¸­ Pathæ˜¯æ¨¡å—è·¯å¾„(ä»¥ crate å¼€å¤´), è¡¨ç¤ºåªèƒ½åœ¨ Path æŒ‡å®šçš„æ¨¡å—ä¸­è®¿é—®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - pub(self)ï¼Œ ç­‰ä»·äº pub(in self)ï¼Œè¡¨ç¤ºåªé™å½“å‰æ¨¡å—å¯è§/ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - pub(super)ï¼Œ ç­‰ä»·äº pub(in super)ï¼Œè¡¨ç¤ºåœ¨å½“å‰æ¨¡å—å’Œçˆ¶æ¨¡å—ä¸­å¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç»“æ„ä½“ä¸­çš„å­—æ®µ, éœ€è¦å•ç‹¬ä½¿ç”¨ pub å…³é”®å­—æ¥ æ”¹å˜å…¶ å¯è§æ€§ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// 2015 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub mod outer_mod {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub(self) fn outer_mod_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub mod inner_mod {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // use outer_mod::outer_mod_fn;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // å¯¹å¤–å±‚æ¨¡å— `outer_mod` å¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(in outer_mod) fn outer_mod_visible_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // å¯¹æ•´ä¸ªcrateå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(crate) fn crate_visible_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // `outer_mod` å†…éƒ¨å¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(super) fn super_mod_visible_fn() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // è®¿é—®åŒä¸€æ¨¡å—çš„å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            inner_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // è®¿é—®çˆ¶æ¨¡å—çš„å‡½æ•°éœ€è¦ä½¿ç”¨â€œ::â€å‰ç¼€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ::outer_mod::outer_mod_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä»…åœ¨`inner_mod`å¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(self) fn inner_mod_visible_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn foo() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inner_mod::outer_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inner_mod::crate_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inner_mod::super_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä¸èƒ½ä½¿ç”¨inner_mod çš„ç§æœ‰å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // inner_mod::inner_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn bar() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯¥å‡½æ•°å¯¹æ•´ä¸ªcrateå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    outer_mod::inner_mod::crate_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯¥å‡½æ•°åªå¯¹outer_modå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // outer_mod::inner_mod::super_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯¥å‡½æ•°åªå¯¹outer_modå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // outer_mod::inner_mod::outer_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // é€šè¿‡fooå‡½æ•°è°ƒç”¨å†…éƒ¨ç»†èŠ‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    outer_mod::foo();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() { bar() }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// 2018</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub mod outer_mod {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub(self) fn outer_mod_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub mod inner_mod {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // åœ¨Rust 2018 edtion æ¨¡å—ç³»ç»Ÿå¿…é¡»ä½¿ç”¨useå¯¼å…¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        use crate::outer_mod::outer_mod_fn;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // å¯¹å¤–å±‚æ¨¡å— `outer_mod` å¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(in crate::outer_mod)  fn outer_mod_visible_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // å¯¹æ•´ä¸ªcrateå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(crate) fn crate_visible_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // `outer_mod` å†…éƒ¨å¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(super) fn super_mod_visible_fn() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // è®¿é—®åŒä¸€æ¨¡å—çš„å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            inner_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // ä½¿ç”¨useå¯¼å…¥äº†outer_mod</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            outer_mod_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä»…åœ¨`inner_mod`å¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        pub(self) fn inner_mod_visible_fn() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn foo() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inner_mod::outer_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inner_mod::crate_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inner_mod::super_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä¸èƒ½ä½¿ç”¨inner_mod çš„ç§æœ‰å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // inner_mod::inner_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn bar() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯¥å‡½æ•°å¯¹æ•´ä¸ªcrateå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    outer_mod::inner_mod::crate_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯¥å‡½æ•°åªå¯¹outer_modå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // outer_mod::inner_mod::super_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯¥å‡½æ•°åªå¯¹outer_modå¯è§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // outer_mod::inner_mod::outer_mod_visible_fn();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // é€šè¿‡fooå‡½æ•°è°ƒç”¨å†…éƒ¨ç»†èŠ‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    outer_mod::foo();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() { bar() }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5232-å¤šæ€">5.23.2. å¤šæ€<a href="#5232-å¤šæ€" class="hash-link" aria-label="5.23.2. å¤šæ€çš„ç›´æ¥é“¾æ¥" title="5.23.2. å¤šæ€çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">oop_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤šæ€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Screen</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> components</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Draw</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token comment" style="color:rgb(0, 128, 0)">// Box&lt;dyn Draw&gt; ä¸ºä»»ä½•å®ç°äº† Draw trait çš„ç±»å‹çš„æ›¿èº«</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦å¤–å¤šæ€ä¾‹å­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Rectangle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        width </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        height </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Circle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        x </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        y </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        radius </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain">  </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">IShape</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">area</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">IShape</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rectangle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">area</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">height </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">width</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Rectangle -&gt; width={} height={} area={}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">width</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">height</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">area</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">f64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">consts</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token constant" style="color:rgb(129, 31, 63)">PI</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">IShape</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Circle</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">area</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">radius </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">radius</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">PI</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">f32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">format!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Circle -&gt; x={}, y={}, area={}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">area</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">vec</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> rect </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rectangle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> width</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> circle </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Circle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> radius</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">circle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;area={}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">area</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5233-å‘ä¸‹è½¬å‹">5.23.3. å‘ä¸‹è½¬å‹<a href="#5233-å‘ä¸‹è½¬å‹" class="hash-link" aria-label="5.23.3. å‘ä¸‹è½¬å‹çš„ç›´æ¥é“¾æ¥" title="5.23.3. å‘ä¸‹è½¬å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å‘ä¸‹è½¬å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å…ˆå¾—è®© IShape ç»§æ‰¿äº Any ï¼Œå¹¶å¢åŠ ä¸€ä¸ª as_any() çš„è½¬å‹æ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">any</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">trait</span><span class="token plain">  </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">IShape</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Any</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">as_any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        â€¦â€¦ â€¦â€¦ â€¦â€¦ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç„¶åï¼Œåœ¨å…·ä½“ç±»ä¸­å®ç°è¿™ä¸ªæ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">IShape</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Rectangle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">as_any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Any</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        â€¦â€¦ â€¦â€¦ â€¦â€¦ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">IShape</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Circle</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">as_any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Any</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        â€¦â€¦ â€¦â€¦ â€¦â€¦ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> v </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Box</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">dyn</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">IShape</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">circle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">downcast_ref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Rectangle</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;downcast - Rectangle w={}, h={}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">width</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">height</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">downcast_ref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Circle</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;downcast - Circle x={}, y={}, r={}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">radius</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;invaild type&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5234-å„ç§selfåŒºåˆ†ä½¿ç”¨">5.23.4. å„ç§selfåŒºåˆ†ä½¿ç”¨<a href="#5234-å„ç§selfåŒºåˆ†ä½¿ç”¨" class="hash-link" aria-label="5.23.4. å„ç§selfåŒºåˆ†ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="5.23.4. å„ç§selfåŒºåˆ†ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">&amp;self           å¸¸ç”¨, è¡¨ç¤ºå½“å‰å¯¹è±¡çš„å¼•ç”¨, ä¸å¯å˜, æ— æ³•ä¿®æ”¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&amp;mut self       å¸¸ç”¨, è¡¨ç¤ºå½“å‰å¯¹è±¡çš„å¼•ç”¨, å¯å˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">self            ä¸å¸¸ç”¨, è¡¨ç¤ºå½“å‰å¯¹è±¡æœ¬èº«, æ“ä½œå®Œæˆå, å½“å‰å¯¹è±¡æ— æ³•å†ä½¿ç”¨,ä¼šè¢«ä¸¢å¼ƒå›æ”¶ (åœºæ™¯: ææ„å‡½æ•°)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mut self        ä¸å¸¸ç”¨ ..... æ“ä½œå®Œæˆè¢«ä¸¢å¼ƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5235-è®¾è®¡æ¨¡å¼">5.23.5. è®¾è®¡æ¨¡å¼<a href="#5235-è®¾è®¡æ¨¡å¼" class="hash-link" aria-label="5.23.5. è®¾è®¡æ¨¡å¼çš„ç›´æ¥é“¾æ¥" title="5.23.5. è®¾è®¡æ¨¡å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52351-å»ºé€ è€…æ¨¡å¼">5.23.5.1. å»ºé€ è€…æ¨¡å¼<a href="#52351-å»ºé€ è€…æ¨¡å¼" class="hash-link" aria-label="5.23.5.1. å»ºé€ è€…æ¨¡å¼çš„ç›´æ¥é“¾æ¥" title="5.23.5.1. å»ºé€ è€…æ¨¡å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// std::process::Command å°±ä½¿ç”¨äº† å»ºé€ è€…æ¨¡å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Circle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    x: f64,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    y: f64,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    radius: f64,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct CircleBuilder {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    x: f64,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    y: f64,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    radius: f64,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Circle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn area(&amp;self) -&gt; f64 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        std::f64::consts::PI * (self.radius * self.radius)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; CircleBuilder {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        CircleBuilder {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            x: 0.0, y: 0.0, radius: 1.0,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl CircleBuilder {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   fn x(&amp;mut self, coordinate: f64) -&gt; &amp;mut CircleBuilder {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       self.x = coordinate;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       self</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   fn y(&amp;mut self, coordinate: f64) -&gt; &amp;mut CircleBuilder {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       self.y = coordinate;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       self</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   fn radius(&amp;mut self, radius: f64) -&gt; &amp;mut CircleBuilder {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       self.radius = radius;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      self</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   fn build(&amp;self) -&gt; Circle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       Circle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           x: self.x, y: self.y, radius: self.radius,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52352-è®¿é—®è€…æ¨¡å¼">5.23.5.2. è®¿é—®è€…æ¨¡å¼<a href="#52352-è®¿é—®è€…æ¨¡å¼" class="hash-link" aria-label="5.23.5.2. è®¿é—®è€…æ¨¡å¼çš„ç›´æ¥é“¾æ¥" title="5.23.5.2. è®¿é—®è€…æ¨¡å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// ç”¨äºå°†æ•°æ®ç»“æ„å’Œä½œç”¨äºç»“æ„ä¸Šçš„æ“ä½œè§£ç¥¸ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è®¿é—®è€…æ¨¡å¼ä¸€èˆ¬åŒ…å«ä¸¤ä¸ªå±‚ æ¬¡:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - å®šä¹‰éœ€è¦æ“ä½œçš„å…ƒç´ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - å®šä¹‰ç›¸å…³çš„æ“ä½œ. ä¸€èˆ¬å°†æ“ä½œå°è£…åˆ°ä¸€ä¸ª trait ä¸­, é’ˆå¯¹ä¸åŒçš„å…ƒç´ , æœ‰ä¸åŒçš„æ–¹æ³•å®ç°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Serdeçš„æ¶æ„æ˜¯è®¿é—®è€…æ¨¡å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::any::Any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait HouseElement {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn accept(&amp;self, visitor: &amp;HouseElementVisitor);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn as_any(&amp;self) -&gt; &amp;Any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">trait HouseElementVisitor {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn visit(&amp;self, element: &amp;HouseElement);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct House {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    components: Vec&lt;Box&lt;HouseElement&gt;&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl House {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        House {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            components: vec![Box::new(Livingroom::new())],</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl HouseElement for House {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn accept(&amp;self, visitor: &amp;HouseElementVisitor) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        for component in self.components.iter() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            component.accept(visitor);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        visitor.visit(self);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn as_any(&amp;self) -&gt; &amp;Any { self }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Livingroom;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Livingroom {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; Self { Livingroom }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl HouseElement for Livingroom {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn accept(&amp;self, visitor: &amp;HouseElementVisitor) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        visitor.visit(self);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn as_any(&amp;self) -&gt; &amp;Any { self }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct HouseElementListVisitor;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl HouseElementListVisitor {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new() -&gt; Self { HouseElementListVisitor }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl HouseElementVisitor for  HouseElementListVisitor {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn visit(&amp;self, element: &amp;HouseElement) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match element.as_any() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            house if house.is::&lt;House&gt;() =&gt; println!(&quot;Visiting the house...&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            living if living.is::&lt;Livingroom&gt;() =&gt; println!(&quot;Visiting the Living room...&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ =&gt; {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct HouseElementDemolishVisitor;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl HouseElementDemolishVisitor {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn new() -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        HouseElementDemolishVisitor</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl HouseElementVisitor for HouseElementDemolishVisitor {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn visit(&amp;self, element: &amp;HouseElement) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match element.as_any() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            house if house.is::&lt;House&gt;() =&gt; println!(&quot;Annihilating the house...!!!&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            living if living.is::&lt;Livingroom&gt;() =&gt; println!(&quot;Bombing the Living room...!!!&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ =&gt; {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let house = House::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // simply print out the house elements</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    house.accept(&amp;HouseElementListVisitor::new());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // do something with the elements of a house</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    house.accept(&amp;HouseElementDemolishVisitor::new());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52353-raiiæ¨¡å¼">5.23.5.3. raiiæ¨¡å¼<a href="#52353-raiiæ¨¡å¼" class="hash-link" aria-label="5.23.5.3. raiiæ¨¡å¼çš„ç›´æ¥é“¾æ¥" title="5.23.5.3. raiiæ¨¡å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>é‡æ„åçš„ä»£ç :</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">åˆ©ç”¨Rustçš„ownershipï¼ˆlinear/affine typeï¼‰æ¥è®¾è®¡æ¥å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Refact</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1. å»æ‰letterçš„Cloneï¼Œä½¿ç”¨æ‰€æœ‰æƒä¿è¯å…¶å”¯ä¸€æ€§ï¼›å¹¶ä¸”ä¿¡å°çš„wrapæ–¹æ³•åªæ¥å—è·å¾—æ‰€æœ‰æƒçš„ä¿¡å°ï¼Œè€Œéå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2. ä½¿ç”¨ç±»å‹ç³»ç»Ÿæ¥ä¿è¯ä¿¡å°çš„å”¯ä¸€æ€§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3. ä½¿ç”¨RAIIæœºåˆ¶æ¥ç®¡ç†æ”¶å°¾é€»è¾‘ï¼Œæ¯”å¦‚å®ç°Drop</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å…¶ä»–ç¤ºä¾‹ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1. http response</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2. steaming engine</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// #[derive(Clone)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct Letter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    text: String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct EmptyEnvelope {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct ClosedEnvelope {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    letter: Letter,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct PickupLorryHandle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    done: bool,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Letter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn new(text: String) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Letter {text: text}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl EmptyEnvelope {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn wrap(self, letter: Letter) -&gt; ClosedEnvelope {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ClosedEnvelope {letter: letter}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn buy_prestamped_envelope() -&gt; EmptyEnvelope {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    EmptyEnvelope {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl PickupLorryHandle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn pickup(&amp;mut self, envelope: ClosedEnvelope) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        /*give letter*/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn done(self) {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Drop for PickupLorryHandle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn drop(&amp;mut self) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;sent&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn order_pickup() -&gt; PickupLorryHandle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PickupLorryHandle {done: false , /* other handles */}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let letter = Letter::new(String::from(&quot;Dear RustFest&quot;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let envelope = buy_prestamped_envelope();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let closed_envelope = envelope.wrap(letter);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut lorry = order_pickup();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lorry.pickup(closed_envelope);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æœ‰é—®é¢˜çš„ä»£ç :</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">åˆ©ç”¨Rustçš„ownershipï¼ˆlinear/affine typeï¼‰æ¥è®¾è®¡æ¥å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å­˜åœ¨çš„é—®é¢˜ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1. Letteræœ‰å¯èƒ½å¤åˆ¶å¤šä»½åˆ°å¤šä¸ªä¿¡å°ï¼ˆenvelopeï¼‰é‡Œï¼Œä¸å®‰å…¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2. ä¿¡å°é‡Œæœ‰å¯èƒ½æœ‰ä¿¡ï¼Œä¹Ÿæœ‰å¯èƒ½æ²¡æœ‰ä¿¡, å¯èƒ½å¯„å‡ºçš„æ˜¯ç©ºä¿¡å°ï¼›æˆ–è€…åŒä¸€ä¸ªä¿¡å°è£…å¤šæ¬¡ä¸åŒçš„ä¿¡ä»¶, é€ æˆä¿¡ä»¶çš„è¦†ç›–ï¼Œä¸å®‰å…¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">3. æœ‰æ²¡æœ‰æŠŠä¿¡äº¤ç»™é‚®è½¦ä¹Ÿæ˜¯æ— æ³•ä¿è¯ï¼Œä¸å®‰å…¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¿¡çº¸</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Clone)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct Letter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    text: String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¿¡å°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct Envelope {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    letter: Option&lt;Letter&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä¿¡ä»¶å¤„ç†å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct PickupLorryHandle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    done: bool,//æ˜¯å¦å¯„å‡º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Letter {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn new(text: String) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Letter {text: text}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Envelope {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è£…ä¿¡çº¸è¿›å»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn wrap(&amp;mut self, letter: &amp;Letter){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.letter = Some(letter.clone());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åˆ›å»ºç©ºçš„ä¿¡å°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn buy_prestamped_envelope() -&gt; Envelope {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Envelope {letter: None}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl PickupLorryHandle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è£…è½¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn pickup(&amp;mut self, envelope: &amp;Envelope) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        /*give letter*/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¯„å‡º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn done(&amp;mut self) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.done = true;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;sent&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åˆ›å»ºå¤„ç†å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn order_pickup() -&gt; PickupLorryHandle {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PickupLorryHandle {done: false , /* other handles */}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let letter = Letter::new(String::from(&quot;Dear RustFest&quot;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut envelope = buy_prestamped_envelope();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    envelope.wrap(&amp;letter);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut lorry = order_pickup();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lorry.pickup(&amp;envelope);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lorry.done();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn builder_pattern(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unimplemented!();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="524-å­è¿›ç¨‹">5.24. å­è¿›ç¨‹<a href="#524-å­è¿›ç¨‹" class="hash-link" aria-label="5.24. å­è¿›ç¨‹çš„ç›´æ¥é“¾æ¥" title="5.24. å­è¿›ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å­è¿›ç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// process::Output ç»“æ„ä½“è¡¨ç¤ºå·²ç»“æŸçš„å­è¿›ç¨‹ï¼ˆchild processï¼‰çš„è¾“å‡ºï¼Œè€Œ process::Command ç»“æ„ä½“æ˜¯ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºè€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// std::Child ç»“æ„ä½“ä»£è¡¨äº†ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å­è¿›ç¨‹ï¼Œå®ƒæš´éœ²äº† stdinï¼ˆæ ‡å‡† è¾“å…¥ï¼‰ï¼Œstdoutï¼ˆæ ‡å‡†è¾“å‡ºï¼‰ å’Œ stderrï¼ˆæ ‡å‡†é”™è¯¯ï¼‰ å¥æŸ„ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ä»è€Œå¯ä»¥é€šè¿‡ç®¡é“ä¸ æ‰€ä»£è¡¨çš„è¿›ç¨‹äº¤äº’</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">sub_process_command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-------------sub_process_command--------------&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">process</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> output </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rustc&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">arg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;--version&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap_or_else</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">e</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;failed to execute process: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">success</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_utf8_lossy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">print!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rustc succeeded and stdout was:\n{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_utf8_lossy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">print!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rustc failed and stderr was:\n{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç®¡é“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">prelude</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// éšè—å¯¼å…¥ ä¸‡èƒ½å¯¼å…¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">process</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token class-name" style="color:rgb(38, 127, 153)">Stdio</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">PANGRAM</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;the quick brown fox jumped over the lazy dog\n&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯åŠ¨ `wc` å‘½ä»¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> process </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;wc&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">stdin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Stdio</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">piped</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Stdio</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">piped</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;couldn&#x27;t spawn wc: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">description</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">process</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å°†å­—ç¬¦ä¸²å†™å…¥ `wc` çš„ `stdin`ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `stdin` æ‹¥æœ‰ `Option&lt;ChildStdin&gt;` ç±»å‹ï¼Œä¸è¿‡æˆ‘ä»¬å·²ç»çŸ¥é“è¿™ä¸ªå®ä¾‹ä¸ä¸ºç©ºå€¼ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› è€Œå¯ä»¥ç›´æ¥ `unwrap å®ƒã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">stdin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write_all</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token constant" style="color:rgb(129, 31, 63)">PANGRAM</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;couldn&#x27;t write to wc stdin: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">description</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sent pangram to wc&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å› ä¸º `stdin` åœ¨ä¸Šé¢è°ƒç”¨åå°±ä¸å†å­˜æ´»ï¼Œæ‰€ä»¥å®ƒè¢« `drop` äº†ï¼Œç®¡é“ä¹Ÿè¢«å…³é—­ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‹¥ç®¡é“ä¸å…³é—­,  `wc` å°±ä¸ä¼šå¼€å§‹å¤„ç†æˆ‘ä»¬åˆšåˆšå‘é€çš„è¾“å…¥ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read_to_string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">panic!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;couldn&#x27;t read wc stdout: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                           why</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">description</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">print!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;wc responded with:\n{}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰å¾…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¦‚æœä½ æƒ³ç­‰å¾…ä¸€ä¸ª process::Child å®Œæˆï¼Œå°±å¿…é¡»è°ƒç”¨ Child::waitï¼Œè¿™ä¼šè¿”å› ä¸€ä¸ª process::ExitStatusã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> child </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sleep&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">arg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;5&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> _result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> child</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">wait</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¿…é¡»è°ƒç”¨ wait() ç­‰å¾…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;reached end of main&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="525-åå°„">5.25. åå°„<a href="#525-åå°„" class="hash-link" aria-label="5.25. åå°„çš„ç›´æ¥é“¾æ¥" title="5.25. åå°„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// æ ‡å‡†åº“æä¾›äº† std::any::Any æ¥æ”¯æŒè¿è¡Œæ—¶åå°„ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯ä»¥æ¥æ”¶ä»»ä½•é™æ€ç”Ÿå‘½å‘¨æœŸç±»å‹ å³ &#x27;static ç±»å‹, ä¸èƒ½æ¥æ”¶éé™æ€ç”Ÿå‘½å‘¨æœŸçš„ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let v1 = 0xc0ffee_u32;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v2 = E::He;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v3 = S { x: 0xde, y: 0xad, z: 0xbeef };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let v4 = &quot;rust&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut a: &amp;Any; // trait object</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a = &amp;v1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åˆ¤æ–­æ˜¯å¦å±äºæŸç§ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(a.is::&lt;u32&gt;());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å…¨å±€å”¯ä¸€ç±»å‹æ ‡è¯†ç¬¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç­‰ä»· get_type_id()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // TypeId { t: 12849923012446332737 }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, TypeId::of::&lt;u32&gt;());   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a = &amp;v2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(a.is::&lt;E&gt;());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // TypeId { t: 15527215023668350898 }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, TypeId::of::&lt;E&gt;());   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a = &amp;v3;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(a.is::&lt;S&gt;());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // TypeId { t: 17868507538031848664 }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, TypeId::of::&lt;S&gt;());   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a = &amp;v4;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(a.is::&lt;&amp;str&gt;());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // TypeId { t: 1229646359891580772 }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, TypeId::of::&lt;&amp;str&gt;());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å‘ä¸‹è½¬å‹ä¸ºå…·ä½“ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    use std::any::Any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[derive(Debug)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    enum E { H, He, Li}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct S { x: u8, y: u8, z: u16 }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å‚æ•°é™¤ä½¿ç”¨&amp;Anyå¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Box&lt;Any&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn print_any(a: &amp;Any) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if let Some(v) = a.downcast_ref::&lt;u32&gt;() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;u32 {:x}&quot;, v);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        } else if let Some(v) = a.downcast_ref::&lt;E&gt;() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;enum E {:?}&quot;, v);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    } else if let Some(v) = a.downcast_ref::&lt;S&gt;() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;struct S {:x} {:x} {:x}&quot;, v.x, v.y, v.z);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;else!&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        print_any(&amp; 0xc0ffee_u32);                       </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        print_any(&amp; E::He);                             </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        print_any(&amp; S{ x: 0xde, y: 0xad, z: 0xbeef }); </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        print_any(&amp; &quot;rust&quot;);                           </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        print_any(&amp; &quot;hoge&quot;);                           </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // éé™æ€ç”Ÿå‘½å‘¨æœŸçš„ç±»å‹æœªå®ç°Any, æ— æ³•è¢« Any ç±»å‹æ¥æ”¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    use std::any::Any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct UnStatic&lt;&#x27;a&gt; { x: &amp;&#x27;a i32 }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let a = 42;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let v = UnStatic { x: &amp;a };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut any: &amp;Any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        any = &amp;v;  // Compile Error!</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //ok</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å› ä¸º ä½¿ç”¨äº† é™æ€ç”Ÿå‘½å‘¨æœŸç±»å‹æ¥åˆ›å»º UnStatic, ä½¿å¾— UnStatic ä¹Ÿå˜ä¸º äº†é™æ€ç”Ÿå‘½å‘¨æœŸç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    static ANSWER: i32 = 42;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let v = UnStatic { x: &amp;ANSWER };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut a: &amp;Any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        a = &amp;v;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert!(a.is::&lt;UnStatic&gt;());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="526-å®">5.26. å®<a href="#526-å®" class="hash-link" aria-label="5.26. å®çš„ç›´æ¥é“¾æ¥" title="5.26. å®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5261-å®åŸºæœ¬ä»‹ç»">5.26.1. å®åŸºæœ¬ä»‹ç»<a href="#5261-å®åŸºæœ¬ä»‹ç»" class="hash-link" aria-label="5.26.1. å®åŸºæœ¬ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="5.26.1. å®åŸºæœ¬ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><img loading="lazy" alt="rust macro process" src="/assets/images/rust_macro_process-ee8b27ee3a95c102b98fc156cdce0bf8.png" width="1472" height="1230" class="img_ev3q"></p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// å¯è¿›è¡Œå…ƒç¼–ç¨‹ï¼ˆmetaprogrammingï¼‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// å®å¹¶ä¸äº§ ç”Ÿå‡½æ•°è°ƒç”¨ï¼Œè€Œæ˜¯å±•å¼€æˆæºç ï¼Œå¹¶å’Œç¨‹åºçš„å…¶ä½™éƒ¨åˆ†ä¸€èµ·è¢«ç¼–è¯‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// ä½¿ç”¨åœºæ™¯:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - é¿å…é‡å¤ä»£ç  (https://doc.rust-lang.org/stable/rust-by-example/macros/dry.html)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - é¢†åŸŸä¸“ç”¨è¯­è¨€ï¼ˆDSLï¼Œdomain-specific languageï¼‰ã€‚å®å…è®¸ä½ ä¸ºç‰¹å®šçš„ç›®çš„åˆ›é€ ç‰¹å®šçš„ è¯­æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - å¯å˜æ¥å£ï¼ˆvariadic interfaceï¼‰ã€‚æœ‰æ—¶ä½ éœ€è¦èƒ½å¤Ÿæ¥å—ä¸å®šæ•°ç›®å‚æ•°çš„æ¥å£ï¼Œæ¯”å¦‚ println!</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æŒ‰ç…§å®šä¹‰æ–¹å¼åˆ†ç±»:</p><ul><li>å£°æ˜å®, é€šè¿‡ macro_rules! å®šä¹‰ ( è¾“å…¥ä»£ç , é€šè¿‡ match åŒ¹é…, ä»¥å¦å¤–çš„ä»£ç æ›¿æ¢è¾“å‡º)</li><li>è¿‡ç¨‹å® (æ¥å— rust ä»£ç ä½œä¸ºè¾“å…¥,  åœ¨æ­¤åŸºç¡€ä¸Šä¿®æ”¹å, è¾“å‡º;)</li></ul><p>æ ¹æ®ä½¿ç”¨çš„è¯­æ³•å½¢å¼åˆåˆ†ä¸ºä»¥ä¸‹ä¸¤ç§:</p><ul><li>è°ƒç”¨å®ï¼Œ å½¢å¦‚ println!ã€ assert_eq! ã€ thread_local!ç­‰å¯ä»¥å½“ä½œå‡½æ•°è°ƒç”¨çš„å®, </li><li>å±æ€§å®ï¼Œ ä¹Ÿå°±æ˜¯å½¢å¦‚ <code>#[derive(Debug))æˆ–#[cfg]</code>è¿™ç§å½¢å¼çš„è¯­æ³•</li></ul><p>æŒ‰å®çš„æ¥æºï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»</p><ul><li>å†…ç½®å®</li><li>è‡ªå®šä¹‰å®</li></ul><p>æœ‰å“ªäº›å†…ç½®å®?</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token macro property">todo!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">print!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">eprintln!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot; = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">vec!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">panic!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"> è°ƒè¯•æ‰“å° </span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[allow(dead_code)]</span><span class="token plain"> ç”¨äºå±è”½å¯¹æœªä½¿ç”¨ä»£ç çš„è­¦å‘Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// é€šè¿‡è¿™ä¸ªå±æ€§å±è”½è­¦å‘Šã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[allow(non_camel_case_types)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[cfg(test)]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¡ä»¶ç¼–è¯‘, åªåœ¨ æµ‹è¯•æ—¶ç¼–è¯‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5262-å£°æ˜å®">5.26.2. å£°æ˜å®<a href="#5262-å£°æ˜å®" class="hash-link" aria-label="5.26.2. å£°æ˜å®çš„ç›´æ¥é“¾æ¥" title="5.26.2. å£°æ˜å®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52621-åˆ›å»ºå®">5.26.2.1. åˆ›å»ºå®<a href="#52621-åˆ›å»ºå®" class="hash-link" aria-label="5.26.2.1. åˆ›å»ºå®çš„ç›´æ¥é“¾æ¥" title="5.26.2.1. åˆ›å»ºå®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// å®å±•å¼€:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡å¦‚æ˜¯å•ç‹¬çš„æ–‡ä»¶åˆ™æ‰§è¡Œæ­¤å‘½ä»¤å±•å¼€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//  rustc -Z unstable-options --pretty=expanded main.rs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å‡å¦‚æ˜¯ cargo ç”Ÿæˆçš„äºŒè¿›å’ŒlåŒ…åˆ™æ‰§è¡Œæ­¤å‘½ä»¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// cargo rustc -- -Z unstable-options --pretty=expanded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// macro rules!æœ¬èº« ä¹Ÿ æ˜¯ä¸€ç§å£°æ˜å® ï¼Œ åªä¸è¿‡å®ƒç”±ç¼–è¯‘å™¨ å†…éƒ¨æ‰€å®šä¹‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å®çš„åŸç†å’Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„åŸç†ç±»ä¼¼ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¯­æ³•:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// macro_rule! $macro_name { </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      // æ‰©å±•éƒ¨åˆ†, å¤§å°æ‹¬å·å‡å¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      ($arg1:expr, $arg2:expr) =&gt; {code...}; // åˆ†æ”¯ä»¥åˆ†å·ç»“å°¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      () =&gt; ()                                // æœ€åä¸€ä¸ªåˆ†æ”¯å¯çœç•¥åˆ†å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æœªæ¥ä¼šæ”¯æŒ macro å…³é”®å­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// #![feature(decl_macro)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// macro unless($arg:expr, $branch:expr) {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//     ( if !$arg { $branch }); </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// } </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// åŒ¹é…è¡¨è¾¾å¼ä¸­ç±»å‹æ”¯æŒ: (å„ä¸ªç±»å‹èƒ½å¤ŸåŒ¹é…çš„èŒƒå›´æœ‰é‡å è¦†ç›–)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ itemï¼Œ ä»£è¡¨è¯­è¨€é¡¹ï¼Œå°±æ˜¯ç»„æˆä¸€ä¸ª RuståŒ…çš„åŸºæœ¬å•ä½ï¼Œæ¯”å¦‚æ¨¡å—ã€å£°æ˜ã€å‡½æ•°å®šä¹‰ ã€ ç±»å‹å®šä¹‰ã€ç»“æ„ä½“å®šä¹‰ã€ impl å®ç°ç­‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ blockï¼Œ ä»£è¡¨ä»£ç å—ï¼Œç”±èŠ±æ‹¬å·é™å®šçš„ä»£ç ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ stmtï¼Œä»£è¡¨è¯­å¥ ï¼Œ ä¸€èˆ¬æ˜¯ æŒ‡ä»¥åˆ†å·ç»“å°¾çš„ä»£ç  ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ exprï¼ŒæŒ‡ä»£è¡¨è¾¾å¼ï¼Œä¼šç”Ÿæˆå…·ä½“çš„å€¼ ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ patï¼ŒæŒ‡ä»£æ¨¡å¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ tyï¼Œ è¡¨ç¤ºç±»å‹ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ identï¼Œ æŒ‡ä»£æ ‡è¯†ç¬¦ã€‚å¦‚ å˜é‡åæˆ–å‡½æ•°å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ pathï¼ŒæŒ‡ä»£è·¯å¾„ï¼Œ æ¯”å¦‚fooã€ std::iterç­‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ metaï¼Œ å…ƒä¿¡æ¯ï¼Œè¡¨ç¤ºåŒ…å«åœ¨# [...]æˆ–#![...]å±æ€§ å†…çš„ä¿¡ æ¯ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ tt , TokenTree çš„ ç¼©å†™ï¼ŒæŒ‡ä»£è¯æ¡æ ‘ã€‚æ¯” expr èƒ½åŒ¹é…çš„èŒƒå›´è¦å¹¿</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ visï¼ŒæŒ‡ä»£å¯è§æ€§ï¼Œæ¯”å¦‚ pubã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// â€¢ lifetimeï¼Œ æŒ‡ä»£ç”Ÿå‘½å‘¨æœŸå‚æ•° ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å®ï¼Œåä¸º `say_hello`ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">macro_rules!</span><span class="token plain"> say_hello </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `()` è¡¨ç¤ºæ­¤å®ä¸æ¥å—ä»»ä½•å‚æ•°ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œä½¿ç”¨ å¤§æ‹¬å·äº¦å¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤å®å°†ä¼šå±•å¼€æˆè¿™ä¸ªä»£ç å—é‡Œé¢çš„å†…å®¹ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hello cacro!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™ä¸ªè°ƒç”¨å°†ä¼šå±•å¼€æˆ `println(&quot;xxx&quot;);`!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">say_hello!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™é‡Œä½¿ç”¨å¤§æ‹¬å·äº¦å¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¦å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">macro_rules!</span><span class="token plain"> hello </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token fragment-specifier punctuation" style="color:rgb(4, 81, 165)">expr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨ å¤§å°æ‹¬å·å‡å¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hello, {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">hello!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xy&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">// ä½¿ç”¨å¤§å°æ‹¬å·å‡å¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¸¦ä»£ç æ®µ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">macro_rules!</span><span class="token plain"> unless </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$arg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> expr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$logic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token fragment-specifier punctuation" style="color:rgb(4, 81, 165)">expr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token variable" style="color:rgb(9, 134, 88)">$arg</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token variable" style="color:rgb(9, 134, 88)">$logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">unless!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤§æ‹¬å·å¯çœç•¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a &lt; b&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å‚æ•°ç±»å‹ä¸º æ ‡è¯†ç¬¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">macro_rules!</span><span class="token plain"> create_function </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `ident` æŒ‡ç¤ºç¬¦, æ ‡è¯† func_name æ˜¯å˜é‡åæˆ–å‡½æ•°å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$func_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token fragment-specifier punctuation" style="color:rgb(4, 81, 165)">ident</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$func_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// `stringify!` å®æŠŠ `ident` è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;You called {:?}()&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token macro property">stringify!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$func_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å€ŸåŠ©ä¸Šè¿°å®æ¥åˆ›å»ºåä¸º `foo` å’Œ `bar` çš„å‡½æ•°ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">create_function!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">create_function!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">macro_rules!</span><span class="token plain"> print_result </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `expr` æŒ‡ç¤ºç¬¦è¡¨ç¤ºè¾“å…¥å‚æ•°ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$expression</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token fragment-specifier punctuation" style="color:rgb(4, 81, 165)">expr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?} = {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token macro property">stringify!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$expression</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token comment" style="color:rgb(0, 128, 0)">// `stringify!` æŠŠè¡¨è¾¾å¼*åŸæ ·*è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token variable" style="color:rgb(9, 134, 88)">$expression</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰§è¡Œè¡¨è¾¾å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">foo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">print_result!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1u32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//ä»£ç å—ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property">print_result!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    x </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52622-é‡å¤å¾ªç¯åŒ¹é…">5.26.2.2. é‡å¤å¾ªç¯åŒ¹é…<a href="#52622-é‡å¤å¾ªç¯åŒ¹é…" class="hash-link" aria-label="5.26.2.2. é‡å¤å¾ªç¯åŒ¹é…çš„ç›´æ¥é“¾æ¥" title="5.26.2.2. é‡å¤å¾ªç¯åŒ¹é…çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// ä¸å®šå‚æ•° å¯å˜æ¥å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//å®åœ¨å‚æ•°åˆ—è¡¨ä¸­å¯ä»¥ä½¿ç”¨ + æ¥è¡¨ç¤ºä¸€ä¸ªå‚æ•°å¯èƒ½å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½¿ç”¨ * æ¥è¡¨ç¤ºè¯¥ å‚æ•°å¯èƒ½å‡ºç°é›¶æ¬¡æˆ–å¤šæ¬¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">macro_rules! map {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ($($key:expr =&gt; $value:expr),*) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // åŒ…è£¹ä¸€å±‚å¤§æ‹¬å·, è¡¨ç¤ºè¿”å›ä¸€ä¸ªå€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // ä½¿ç”¨ç»å¯¹è·¯å¾„, é¿å…å†²çª</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // è‹¥ä½¿ç”¨åˆ°è‡ªå®šä¹‰å‡½æ•°, éœ€è¦åœ¨è·¯å¾„ä¸­ä½¿ç”¨ $crate , é¿å…å¯¼å‡ºæ—¶å‡º bug</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let mut map = std::collections::HashMap::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // å¾ªç¯è¯»å–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            $(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                map.insert($key, $value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            )*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            map</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è°ƒç”¨æ—¶, å¤§å°æ‹¬å·éƒ½å¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let map = map!(&quot;a&quot; =&gt; 1, &quot;b&quot; =&gt; 2, &quot;c&quot; =&gt; 3);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;map: {:?}&quot;, map);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mat1 = map!{1 =&gt; &quot;a&quot;, 2 =&gt; &quot;b&quot;, 3 =&gt; &quot;c&quot;};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;mat1: {:?}&quot;, mat1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //ä½†è¿˜æ˜¯å­˜åœ¨é—®é¢˜, æœ«å°¾å…ƒç´ ä¸èƒ½æœ‰é€—å· , å¯ä»¥é€šè¿‡æ·»åŠ å¤šä¸ªåŒ¹é…è§„åˆ™è§£å†³</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let map2 = map!(&quot;a&quot; =&gt; 1, &quot;b&quot; =&gt; 2,);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è§£å†³:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">macro_rules! map {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ($($key:expr =&gt; $value:expr),*) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let mut map = std::collections::HashMap::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            $(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                map.insert($key, $value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            )*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            map</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ–°å¢ä¸€æ¡åŒ¹é…è§„åˆ™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ($($key:expr =&gt; $value:expr,)*) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        map!($($key =&gt; $value),*) // é€’å½’è°ƒç”¨å‰é¢çš„ åŒ¹é…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æˆ–è€…æœ€ç®€å•çš„æ–¹æ³•, å°†åŸæ¥çš„åŒ¹é…ç•¥åŠ ä¿®æ”¹:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ·»åŠ çš„ $(,)* è¡¨ç¤ºåŒ¹é…ä»»æ„æ¬¡æ•°çš„é€—å·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">($($key:expr =&gt; $value:expr),* $(,)*) =&gt; {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">($($key:expr =&gt; $value:expr,)* $(,)*) =&gt; {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let map = map!(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        1 =&gt; &quot;a&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        2 =&gt; &quot;b&quot;, // å¯ä»¥ä½¿ç”¨ é€—å·ç»“å°¾äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, map);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52623-å®é™…æ¡ˆä¾‹">5.26.2.3. å®é™…æ¡ˆä¾‹<a href="#52623-å®é™…æ¡ˆä¾‹" class="hash-link" aria-label="5.26.2.3. å®é™…æ¡ˆä¾‹çš„ç›´æ¥é“¾æ¥" title="5.26.2.3. å®é™…æ¡ˆä¾‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">//  åˆ›å»º map å®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">macro_rules! map {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // @unit æ˜¯çº¦å®šä¿—æˆçš„åœ¨å®å†…éƒ¨å®šä¹‰å®çš„å‘½åè§„åˆ™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¿…é¡»å®šä¹‰åœ¨å¼€å¤´, å¦åˆ™å°±æŒ‰ç…§æ™®é€šåŒ¹é…åˆ†æ”¯å¤„ç†äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    (@unit $($x:tt)*) =&gt; {()};    // ç»Ÿè®¡ item ä¸ªæ•°æ—¶ä½¿ç”¨çš„å•ä½, è¿™é‡Œä½¿ç”¨ ç©ºå…ƒç»„, ä¸å ç©ºé—´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    (@count $($key:expr),* ) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&lt;[()]&gt;::len(&amp;[$(map!(@unit $key)),*]));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ($($key:expr =&gt; $value:expr),* $(,)*) =&gt; (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let _cap = map!(@count $($key),*);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let mut _map = std::collections::HashMap::with_capacity(_cap);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           $(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">               _map.insert($key, $value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            )*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           _map</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let map = map!(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        1 =&gt; &quot;a&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        2 =&gt; &quot;b&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, map);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  å®ä¾‹:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // `min!` å°†æ±‚å‡ºä»»æ„æ•°é‡çš„å‚æ•°çš„æœ€å°å€¼ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    macro_rules! find_min {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // åŸºæœ¬æƒ…å½¢ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ($x:expr) =&gt; ($x);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // `$x` åé¢è·Ÿç€è‡³å°‘ä¸€ä¸ª `$y,`</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ($x:expr, $($y:expr),+) =&gt; (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // å¯¹ `$x` åé¢çš„ `$y` ä»¬è°ƒç”¨ `find_min!` </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            std::cmp::min($x, find_min!($($y),+))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, find_min!(1u32));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, find_min!(1u32 + 2 , 2u32));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, find_min!(5u32, 2u32 * 3, 4u32));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åˆ›é€  dsl</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿™é‡Œåˆ›é€ å…³é”®å­— eval</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    macro_rules! calculate {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (eval $e:expr) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let val: usize = $e; // å¼ºåˆ¶ç±»å‹ä¸ºæ•´å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;{} = {}&quot;, stringify!{$e}, val);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    calculate! {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        eval 1 + 2 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    calculate! {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        eval (1 + 2) * (3 / 4)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å‡çº§ç‰ˆ dsl</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¯æ¥å—å¤šä¸ªå‚æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    macro_rules! calculate {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // å•ä¸ª `eval` çš„æ¨¡å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (eval $e:expr) =&gt; {{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                let val: usize = $e; // Force types to be integers</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                println!(&quot;{} = {}&quot;, stringify!{$e}, val);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // é€’å½’åœ°æ‹†è§£å¤šé‡çš„ `eval`</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (eval $e:expr, $(eval $es:expr),+) =&gt; {{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            calculate! { eval $e }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            calculate! { $(eval $es),+ }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    calculate! { </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        eval 1 + 2,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        eval 3 + 4,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        eval (2 * 3) + 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5263-å®è°ƒè¯•">5.26.3. å®è°ƒè¯•<a href="#5263-å®è°ƒè¯•" class="hash-link" aria-label="5.26.3. å®è°ƒè¯•çš„ç›´æ¥é“¾æ¥" title="5.26.3. å®è°ƒè¯•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å¿…é¡» nightly rust æ‰è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// #![feature(trace_macros) æ ‡æ³¨å®å®šä¹‰, ç„¶ååœ¨main å¼€å¤´ trace_macros!(true);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#![feature(trace_macros)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">macro_rules! hashmap {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    (@unit $($x:tt)*) =&gt; (());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    (@count $($rest:expr),*) =&gt; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&lt;[()]&gt;::len(&amp;[$(hashmap!(@unit $rest)),*]));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ($($key:expr =&gt; $value:expr),* $(,)*) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let _cap = hashmap!(@count $($key),*);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let mut _map = </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                ::std::collections::HashMap::with_capacity(_cap);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           $(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">               _map.insert($key, $value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           )*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           _map</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   trace_macros!(true);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let map = hashmap!{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       &quot;a&quot; =&gt; 1,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       &quot;b&quot; =&gt; 2,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       &quot;c&quot; =&gt; 3, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   assert_eq!(map[&quot;a&quot;], 1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5264-è¿‡ç¨‹å®">5.26.4. è¿‡ç¨‹å®<a href="#5264-è¿‡ç¨‹å®" class="hash-link" aria-label="5.26.4. è¿‡ç¨‹å®çš„ç›´æ¥é“¾æ¥" title="5.26.4. è¿‡ç¨‹å®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52641-è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™">5.26.4.1. è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™<a href="#52641-è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™" class="hash-link" aria-label="5.26.4.1. è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™çš„ç›´æ¥é“¾æ¥" title="5.26.4.1. è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯ä»¥ç”¨æ¥:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - è‡ªå®šä¹‰æ´¾ç”Ÿå±æ€§, ç±»ä¼¼äº #[derive(Debug)]è¿™æ ·çš„ derive å±æ€§ï¼Œå¯ä»¥è‡ªåŠ¨ä¸º ç»“æ„ä½“æˆ–æšä¸¾ç±»å‹è¿›è¡Œè¯­æ³•æ‰©å±•, å¢åŠ æ–°çš„æ–¹æ³•å®ç°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - è‡ªå®šä¹‰å±æ€§ï¼Œ å¯ä»¥è‡ªå®šä¹‰ç±»ä¼¼äº#[cfg()]è¿™ç§å±æ€§</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - ç±»ä¼¼å‡½æ•°è°ƒç”¨çš„å®, å’Œ macro_rules!å®šä¹‰çš„å®ç±»ä¼¼ï¼Œä»¥ Bang ç¬¦å·(å°±æ˜¯å¹å· &quot;!&quot; )ç»“å°¾çš„å® ã€‚å¯ä»¥åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ , custom!(...)ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># è¿‡ç¨‹å®ï¼Œå¿…é¡»å†™åœ¨å•ç‹¬çš„libç±»å‹çš„crateä¸­, `cargo new --lib xxx`, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # ä¸ºä»€ä¹ˆä¸èƒ½åœ¨åŒä¸€ä¸ª crate é‡ŒåŒæ—¶å®šä¹‰&amp;ä½¿ç”¨ procedual macro ?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # procedual macro æ˜¯åœ¨é¡¹ç›®ç¼–è¯‘å‰ä¼šè¢«é¢„å…ˆç¼–è¯‘åŠ å·¥çš„ä¸€æ®µç¨‹åº, å¦‚æœå®šä¹‰å’Œä½¿ç”¨åœ¨åŒä¸€ä¸ª crate, å°±åµŒå…¥äº†æ­»é” (é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡çš„é—®é¢˜)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # crate ä»£ç è¦ç¼–è¯‘çš„è¯éœ€è¦å…ˆå¤„ç† procedual macroå±•å¼€, è€Œ å¤„ç† procedual macro å±•å¼€éœ€è¦å…ˆç¼–è¯‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># éœ€è¦ ä¸ºå½“å‰é¡¹ç›®å£°æ˜ä½¿ç”¨ proc_macro,  proc_macro crateä¸º rust è‡ªå¸¦, é»˜è®¤ä¸å¼•å…¥, éœ€è¦æ˜¾å¼å£°æ˜ä¸º true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[lib]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è®¾ç½®ä¸º proc_macro ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">proc_macro = true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52642-è‡ªå®šä¹‰å±æ€§å®">5.26.4.2. è‡ªå®šä¹‰å±æ€§å®<a href="#52642-è‡ªå®šä¹‰å±æ€§å®" class="hash-link" aria-label="5.26.4.2. è‡ªå®šä¹‰å±æ€§å®çš„ç›´æ¥é“¾æ¥" title="5.26.4.2. è‡ªå®šä¹‰å±æ€§å®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>Rust è‡ªèº«æœ‰å¾ˆå¤šå†…ç½®çš„å±æ€§ ï¼Œ æ¯”å¦‚æ¡ä»¶ç¼–è¯‘å±æ€§ <code>#[cfgOJå’Œæµ‹è¯•å±æ€§#[test]</code></p><p>è¿‡ç¨‹å®å®ç°è‡ªå®šä¹‰å±æ€§çš„åŠŸèƒ½è¿˜æœªç¨³å®šã€‚åœ¨ è¯¥ç‰ˆæœ¬ç¨³å®šä¹‹å‰ï¼Œå¿…é¡»åœ¨ Nightly ç‰ˆæœ¬ä¸‹ä½¿ç”¨ <code>#![feature(custom_attribute)]</code>ç‰¹æ€§, å½“å‰ç‰ˆæœ¬ä¸éœ€è¦äº†</p><p>å®šä¹‰å®:</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use proc_macro::TokenStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[proc_macro_attribute]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn attr_with_args(args: TokenStream, _input: TokenStream) -&gt; TokenStream {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // args æ˜¯ #[attr_with_args(&quot;Hello attr macro.&quot;)] ä¸­çš„å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // _input æ˜¯è¾“å…¥, å³ fn boo() {}, è¿™é‡Œç›´æ¥å¿½ç•¥äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    format!(&quot;fn foo() -&gt; &amp;&#x27;static str {{{}}}&quot;, args.to_string()).parse().unwrap()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä½¿ç”¨:</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#[macro_use] extern crate proc_macro_me;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn tt() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[attr_with_args(&quot;Hello attr macro.&quot;)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn foo() {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, foo());//&quot;Hello attr macro.&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52643-å‡½æ•°è°ƒç”¨å®">5.26.4.3. å‡½æ•°è°ƒç”¨å®<a href="#52643-å‡½æ•°è°ƒç”¨å®" class="hash-link" aria-label="5.26.4.3. å‡½æ•°è°ƒç”¨å®çš„ç›´æ¥é“¾æ¥" title="5.26.4.3. å‡½æ•°è°ƒç”¨å®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>å®šä¹‰å‡½æ•°è°ƒç”¨å®:</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use proc_macro::TokenStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[proc_macro]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn make_fn_answer(_item: TokenStream) -&gt; TokenStream {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;fn answer() -&gt; u32 { 11 }&quot;.parse().unwrap()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä½¿ç”¨:</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#[macro_use] extern crate proc_macro_me;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn tt() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    make_fn_answer!();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, answer());// 11</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52644-derive-å®">5.26.4.4. derive å®<a href="#52644-derive-å®" class="hash-link" aria-label="5.26.4.4. derive å®çš„ç›´æ¥é“¾æ¥" title="5.26.4.4. derive å®çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>å®šä¹‰å®</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// è‡ªå®šä¹‰ derive å®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// extern crate proc_macro;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// use proc_macro::TokenStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// use self::proc_macro::TokenStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use proc_macro::TokenStream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// AnswerFn ç›¸å½“äºæ ‡è¯†ç¬¦, ä½¿ç”¨æ—¶, è¿™æ ·ä½¿ç”¨ #[derive(Hello, AnswerFn)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[proc_macro_derive(AnswerFn)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn derive_answer_fn(_input: TokenStream) -&gt; TokenStream {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;fn answer() -&gt; u32 { 11 }&quot;.parse().unwrap()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[proc_macro_derive(Hello)]//è¡¨ç¤ºå…¶ä¸‹æ–¹çš„å‡½æ•°ä¸“é—¨å¤„ç†è‡ªå®šä¹‰æ´¾ç”Ÿå±æ€§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn derive_a_hello(input: TokenStream) -&gt; TokenStream {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let input = input.to_string();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä¿è¯ ä»£ç ä¸­å­˜åœ¨ struct A</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert!(input.contains(&quot;struct A&quot;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //æ–¹æ³•æœ€ç»ˆä¼šè¿”å›ä¸€ä¸ª Result&lt;TokenSteam, Errã€‰ç±»å‹ï¼Œ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ‰€ä»¥è¿˜éœ€è¦å†æ¬¡ç”¨ unwrap æ–¹æ³•æ‰èƒ½è¿”å›ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    r#&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        impl A {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fn a(&amp;self) -&gt; String {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                format!(&quot;hello from a impl&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;#.parse().unwrap() </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä½¿ç”¨:</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// #[macro_use] extern crate proc_macro_me;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use proc_macro_me::{AnswerFn, Hello};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(Hello, AnswerFn)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct A;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn test_derive_a() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let aa = A;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(&quot;hello from a impl&quot;.to_string(), aa.a());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, answer());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5265-ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…">5.26.5. ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…<a href="#5265-ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…" class="hash-link" aria-label="5.26.5. ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…çš„ç›´æ¥é“¾æ¥" title="5.26.5. ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å®˜æ–¹çš„è¿‡ç¨‹å®åº“ä¸ºproc_macro, è¿˜æ²¡ç¨³å®šï¼Œä¸æ¨èç›´æ¥ä½¿ç”¨</p><p>derive_more</p><p>syn  å®Œæ•´å®ç°äº† Rust æºç  çš„è¯­ æ³•æ ‘ç»“æ„</p><p>quote å¯ä»¥å°† syn çš„è¯­æ³•æ ‘ç»“æ„è½¬ä¸º proc macro::TokenStrem ç±»å‹</p><p>proc_macro2</p><p>proc-macro-workshop</p><p>seq-macro</p><p>paste</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5266-ç¼–è¯‘å™¨æ’ä»¶">5.26.6. ç¼–è¯‘å™¨æ’ä»¶<a href="#5266-ç¼–è¯‘å™¨æ’ä»¶" class="hash-link" aria-label="5.26.6. ç¼–è¯‘å™¨æ’ä»¶çš„ç›´æ¥é“¾æ¥" title="5.26.6. ç¼–è¯‘å™¨æ’ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>cargo-expand</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo </span><span class="token function" style="color:rgb(0, 0, 255)">install</span><span class="token plain"> cargo-expand</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup component </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> rustfmt </span><span class="token comment" style="color:rgb(0, 128, 0)"># this is used to format the expanded code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustup </span><span class="token function" style="color:rgb(0, 0, 255)">install</span><span class="token plain"> nightly </span><span class="token comment" style="color:rgb(0, 128, 0)"># åœ¨ Nightly ç‰ˆæœ¬çš„ Rust ä¹‹ä¸‹ï¼Œé…åˆ, just need install nightly version, not have to switch to nightly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># ä½¿ç”¨ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo </span><span class="token function" style="color:rgb(0, 0, 255)">expand</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># this will expand all code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo </span><span class="token function" style="color:rgb(0, 0, 255)">expand</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">function name</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># this will only expand the specified function</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>6. unsafe å±è”½å†…å­˜å®‰å…¨æ£€æŸ¥</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="61-unsafe-åŸºæœ¬åœºæ™¯">6.1. unsafe åŸºæœ¬åœºæ™¯<a href="#61-unsafe-åŸºæœ¬åœºæ™¯" class="hash-link" aria-label="6.1. unsafe åŸºæœ¬åœºæ™¯çš„ç›´æ¥é“¾æ¥" title="6.1. unsafe åŸºæœ¬åœºæ™¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// ä½¿ç”¨ unsafe å®šä¹‰ ä¸å®‰å…¨çš„ å‡½æ•°/æ–¹æ³•/trait, ä»¥åŠä¸º trait å®ç°æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚: String::from_utf8_unchecked å°±æ˜¯ä¸å®‰å…¨çš„, å¯¹äºè¾“å…¥å‚æ•°, æ²¡æœ‰æ£€æŸ¥æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ utf-8å­—èŠ‚åºåˆ—; String::from_utf8_lossy åˆ™æ˜¯å®‰å…¨çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚: Send trait, Sync trait éƒ½æ˜¯ unsafe çš„, ä½¿ ç”¨ unsafeå¯¹ Sendå’Œ Syncè¿›è¡Œæ ‡è®°ï¼Œå°±æ„å‘³ç€å¼€å‘è€…æ‰‹åŠ¨å®ç°å®ƒä¼šæœ‰å®‰å…¨é£é™©, æ‰€ä»¥ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¯¹æˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»å‹å®ç°è¿™ä¸¤ä¸ªæ¥å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¦‚: Searcher trait, æ²¡æœ‰æ£€æŸ¥æˆªå–çš„å­—ç¬¦ä½ç½®åœ¨å­—ç¬¦ä¸²ä¸­æ˜¯å¦æ˜¯æœ‰æ•ˆå­—ç¬¦è¾¹ç•Œ, éœ€è¦å¼€å‘è€…è‡ªå·±ä¿è¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åœ¨ unsafe å—ä¸­æ‰§è¡Œä¸å®‰å…¨çš„æ“ä½œ (å¯¹äºä¸å®‰å…¨çš„æ“ä½œ, ä¼šå±è”½å†…å­˜å®‰å…¨æ£€æŸ¥, ä½†æ˜¯å¯¹äºå®‰å…¨çš„æ“ä½œ, ä¾ç„¶æœ‰å®‰å…¨æ£€æŸ¥)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - è§£å¼•ç”¨è£¸æŒ‡é’ˆ (ä½†æ˜¯åˆ›å»ºè£¸æŒ‡é’ˆæ— éœ€åœ¨ unsafe ä¸­)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - è°ƒç”¨ unsafe çš„å‡½æ•°/æ–¹æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - è®¿é—®ä¿®æ”¹å¯å˜é™æ€å˜é‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - å®ç° unsafe çš„ trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - è¯»å†™ union è”åˆä½“ä¸­çš„  å­—æ®µ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// è®¿é—®ä¿®æ”¹å¯å˜é™æ€å˜é‡ (ä¸€èˆ¬ç”¨ä¸åˆ°, åªæ˜¯ç”¨äºå’Œ c äº¤äº’)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// é™æ€å˜é‡æ˜¯å…¨å±€å¯è®¿ é—® çš„ ã€‚å¯¹äºä¸å¯å˜é™æ€å˜é‡æ¥è¯´ï¼Œè®¿é—®å®ƒä¸å­˜åœ¨ä»»ä½•å®‰å…¨ é—®é¢˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿ é—®å¯å˜é™æ€å˜é‡, ä¼šæœ‰å®‰å…¨é—®é¢˜, æ‰€ä»¥è¦åœ¨ unsafe ä¸­ä¿®æ”¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">COUNTER</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> inc </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">COUNTER</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> inc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;COUNTER: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">COUNTER</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è®¿é—® union è”åˆä½“ (åªè¦è¿˜æ˜¯ä¸ºäº†æ–¹ä¾¿ å’Œ c äº¤äº’)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è§£å¼•ç”¨è£¸/åŸç”ŸæŒ‡é’ˆ (raw pointer), è£¸æŒ‡é’ˆå¸¸ç”¨äº å’Œ c äº¤äº’</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ†ä¸º:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸å¯å˜è£¸æŒ‡é’ˆ   *const T</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯å˜è£¸æŒ‡é’ˆ     *mut T</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - å…è®¸å¿½ç•¥å€Ÿç”¨è§„åˆ™: æŸä¸ªå¯¹è±¡å¯ä»¥åŒæ—¶æ‹¥æœ‰å¯å˜ä¸å¯å˜è£¸æŒ‡é’ˆ, æˆ–è€…å¤šä¸ªåŒæ—¶æŒ‡å‘ç›¸åŒä½ç½®çš„å¯å˜è£¸æŒ‡é’ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä¸ä¿è¯æŒ‡å‘çš„å†…å­˜æ˜¯æœ‰æ•ˆçš„, å…è®¸æŒ‡å‘ç©ºåœ°å€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - ä¸ä¿è¯çº¿ç¨‹å®‰å…¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - æ²¡æœ‰è‡ªåŠ¨æ¸…ç†çš„åŠŸèƒ½, éœ€è¦æ‰‹åŠ¨æ¸…ç†å†…å­˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> rp1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain"> a </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»ºæ—¶æ— éœ€åœ¨ unsafe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// åŒæ—¶å‡ºç°äº† å¯å˜, ä¸å¯å˜å€Ÿç”¨, ç¼–è¯‘å™¨ä¸æŠ¥é”™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> rp2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> a </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rp1 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">rp1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rp2 = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain">rp2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// è®¿é—® unsafe æ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">danger</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;dangerous&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">unsafe</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">danger</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="62-äº¤å‰ç¼–è¯‘">6.2. äº¤å‰ç¼–è¯‘<a href="#62-äº¤å‰ç¼–è¯‘" class="hash-link" aria-label="6.2. äº¤å‰ç¼–è¯‘çš„ç›´æ¥é“¾æ¥" title="6.2. äº¤å‰ç¼–è¯‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœæ˜¯é’ˆå¯¹ ARM åµŒå…¥å¼å¼€å‘å¹³å°, ä¸èƒ½ä½¿ ç”¨stdæ ‡å‡†åº“ (#![no_std))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rustc --target=arm-unknown-linux-gnueabihf hello .rs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo build --target=arm - unknown - linux - gnueabihf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç¬¬ä¸‰æ–¹äº¤å‰ç¼–è¯‘å·¥å…· xargo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>é€šè¿‡é…ç½®æ–‡ä»¶æŒ‡å®šé“¾æ¥å™¨: vim ~/ . cargo/config</p><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[target . arm- unknown-linux-gnueabihf]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">linker = â€arm-linux-gnueabihf-gcc-4.8â€</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="63-ffi-å¤–éƒ¨å‡½æ•°æ¥å£">6.3. ffi å¤–éƒ¨å‡½æ•°æ¥å£<a href="#63-ffi-å¤–éƒ¨å‡½æ•°æ¥å£" class="hash-link" aria-label="6.3. ffi å¤–éƒ¨å‡½æ•°æ¥å£çš„ç›´æ¥é“¾æ¥" title="6.3. ffi å¤–éƒ¨å‡½æ•°æ¥å£çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="631-ffi-åŸºæœ¬ä»‹ç»">6.3.1. ffi åŸºæœ¬ä»‹ç»<a href="#631-ffi-åŸºæœ¬ä»‹ç»" class="hash-link" aria-label="6.3.1. ffi åŸºæœ¬ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="6.3.1. ffi åŸºæœ¬ä»‹ç»çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Javaè¯­è¨€åˆ™å°†FFIç§°ä¸ºJNI CJavaNativeInterface)</p><p><a href="https://www.cnblogs.com/Jackeyzhe/p/12623689.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/Jackeyzhe/p/12623689.html</a></p><p><a href="https://rustcc.cn/article?id=3b8241d0-c4ca-4f49-8e07-0a5142b00f59" target="_blank" rel="noopener noreferrer">https://rustcc.cn/article?id=3b8241d0-c4ca-4f49-8e07-0a5142b00f59</a></p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">///å¤–éƒ¨è¯­è¨€å‡½æ•°æ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// Rust æä¾›äº†åˆ° C è¯­è¨€åº“çš„å¤–éƒ¨è¯­è¨€å‡½æ•°æ¥å£ï¼ˆForeign Function Interfaceï¼ŒFFIï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å¤– éƒ¨è¯­è¨€å‡½æ•°å¿…é¡»åœ¨ä¸€ä¸ª extern ä»£ç å—ä¸­å£°æ˜ï¼Œä¸”è¯¥ä»£ç å—è¦å¸¦æœ‰ä¸€ä¸ªåŒ…å«åº“åç§° çš„ #[link] å±æ€§</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// æ”¯æŒå››ç§åº“:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - dylib , ruståŠ¨æ€åº“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - rlib, rust é™æ€åº“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - cdylib, å…¶ä»–è¯­è¨€å†™çš„åŠ¨æ€åº“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - staticlib , å…¶ä»–è¯­è¨€é™æ€åº“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚ä½•ç¼–è¯‘ä¸ºåº“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// flag å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// (crate type å¯ä»¥æŒ‡å®šå¤šä¸ª, #[crate_type = &quot;bin&quot;] è¿™ç§ä½¿ç”¨å½¢å¼éœ€è¦æ ‡æ³¨åœ¨ lib.rs or main.rs å¼€å¤´)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// --crate-type=bin or #[crate_type = &quot;bin&quot;] è¡¨ç¤ºå°†ç”Ÿæˆ-ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ ã€‚è¦æ±‚ç¨‹åºä¸­å¿… é¡»åŒ…å«ä¸€ä¸ª main å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// --crate-type=lib or #[crate_type = &quot;lib&quot;] è¡¨ç¤ºå°†ç”Ÿæˆä¸€ä¸ª Ruståº“ã€‚ å…·ä½“ç”Ÿæˆä»€ä¹ˆç±»å‹åº“ï¼Œç”±ç¼–è¯‘å™¨è‡ªè¡Œå†³å®šã€‚é»˜è®¤ä¼šäº§ç”Ÿ rlibé™æ€ åº“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//--crate-type=rlib or #[crate_type = &quot;rlib&quot;] é™æ€ Ruståº“ï¼Œç”±Rustç¼–è¯‘å™¨æ¥ä½¿ ç”¨ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//--crate-type=dylib or #[crate_type = &quot;dylib&quot;] åŠ¨æ€ Ruståº“,ç”± Rust ç¼–è¯‘å™¨æ¥ä½¿ç”¨(åœ¨ Linuxä¸Šä¼šåˆ›å»º*.soæ–‡ä»¶ï¼Œåœ¨ MacOSXä¸Šä¼šåˆ›å»º.dylibæ–‡ä»¶ï¼Œ åœ¨ Windowsä¸Šä¼šåˆ›å»º.dllæ–‡ä»¶)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// --crate-type=staticlib or #[crate_type = &quot;staticlib&quot;] ç”Ÿæˆé™æ€ç³»ç»Ÿåº“ ã€‚ Rust ç¼–è¯‘å™¨ æ°¸è¿œä¸ä¼šé“¾æ¥è¯¥ç±»å‹åº“ï¼Œä¸»è¦ç”¨äºå’Œ C è¯­è¨€è¿›è¡Œé“¾æ¥ ï¼Œè¾¾æˆå’Œå…¶ä»–è¯­ è¨€äº¤äº’ çš„ç›®çš„ ã€‚ é™æ€ç³»ç»Ÿåº“åœ¨ Linuxå’Œ MacOSXä¸Šä¼šåˆ›å»º.aæ–‡ä»¶ï¼Œåœ¨ Windowsä¸Šä¼šåˆ›å»º*.libæ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//--crate-type=cdylib or #[crate_type = &quot;cdylib&quot;] ç”ŸæˆåŠ¨æ€ç³»ç»Ÿåº“ã€‚åŒæ · ç”¨ äºç”Ÿæˆ C æ¥å£ï¼Œ å’Œå…¶ä»–è¯­è¨€äº¤äº’ã€‚è¯¥ç±»å‹åœ¨ Linuxä¸Šä¼šåˆ›å»º.soæ–‡ä»¶ ï¼Œåœ¨ MacOSXä¸Šä¼šåˆ›å»º.dylib , åœ¨ Windowsä¸Šä¼šåˆ›å»º.dllæ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="632-å’Œ-elixir-äº¤äº’">6.3.2. å’Œ elixir äº¤äº’<a href="#632-å’Œ-elixir-äº¤äº’" class="hash-link" aria-label="6.3.2. å’Œ elixir äº¤äº’çš„ç›´æ¥é“¾æ¥" title="6.3.2. å’Œ elixir äº¤äº’çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>rustler</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="633-å’Œc-cpp-äº¤äº’">6.3.3. å’Œc cpp äº¤äº’<a href="#633-å’Œc-cpp-äº¤äº’" class="hash-link" aria-label="6.3.3. å’Œc cpp äº¤äº’çš„ç›´æ¥é“¾æ¥" title="6.3.3. å’Œc cpp äº¤äº’çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Cbindgen</p><p>autocxx -&gt; c++</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6331-åœ¨-rust-ä¸­è°ƒç”¨-c-å‡½æ•°">6.3.3.1. åœ¨ rust ä¸­è°ƒç”¨ C å‡½æ•°<a href="#6331-åœ¨-rust-ä¸­è°ƒç”¨-c-å‡½æ•°" class="hash-link" aria-label="6.3.3.1. åœ¨ rust ä¸­è°ƒç”¨ C å‡½æ•°çš„ç›´æ¥é“¾æ¥" title="6.3.3.1. åœ¨ rust ä¸­è°ƒç”¨ C å‡½æ•°çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åœ¨ Rust ä¸­è°ƒç”¨ C å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è¿™é‡ŒæŒ‡å®šä½¿ç”¨ C-ABIï¼Œç­‰ä»·äº â€œextern fn foo () â€è¿™æ ·çš„å‡½æ•°å£°æ˜; æ­¤å¤–è¿˜æœ‰ extern &quot;Rustâ€ï¼Œ è¿™æ˜¯é»˜è®¤çš„ ABIï¼Œä»»ä½•æ™®é€š çš„å‡½æ•°éƒ½å°†ä½¿ ç”¨ è¯¥ ABI</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">extern &quot;C&quot; {//ä¹Ÿå¯ä»¥ ç›´æ¥ä½¿ç”¨ extern å—ï¼Œè€Œçœç•¥æ‰ABIå­—ç¬¦ä¸²Â°Câ€ ã€‚å› ä¸ºé»˜è®¤çš„externå—å°±æ˜¯æŒ‰C-ABIå¤„ç†çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å®šä¹‰äº† C æ ‡å‡†åº“å†…ç½®çš„ isalnum å‡½æ•°ç­¾å, å¯ä»¥ç›´æ¥ä½¿ç”¨äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn isalnum(input: i32) -&gt; i32;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;Is 3 a number ?  the answer is : {}&quot;, isalnum(3));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // error, å‚æ•°ç±»å‹é”™è¯¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;Is &#x27;a&#x27; a number ? &quot;, isalnum(&#x27;a&#x27;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6332-åœ¨-rustè°ƒç”¨-cpp">6.3.3.2. åœ¨ rustè°ƒç”¨ cpp<a href="#6332-åœ¨-rustè°ƒç”¨-cpp" class="hash-link" aria-label="6.3.3.2. åœ¨ rustè°ƒç”¨ cppçš„ç›´æ¥é“¾æ¥" title="6.3.3.2. åœ¨ rustè°ƒç”¨ cppçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è°ƒç”¨ cpp c++</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å•ç²¾åº¦å¤æ•°çš„æœ€ç®€å®ç°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[repr(C)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[derive(Clone, Copy)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    struct Complex {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        re: f32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        im: f32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    impl fmt::Debug for Complex {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if self.im &lt; 0. {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                write!(f, &quot;{}-{}i&quot;, self.re, -self.im)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            } else {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                write!(f, &quot;{}+{}i&quot;, self.re, self.im)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¿™ä¸ª extern ä»£ç å—é“¾æ¥åˆ° libm åº“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[link(name = &quot;m&quot;)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    extern {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // è¿™ä¸ªå¤–éƒ¨å‡½æ•°ç”¨äºè®¡ç®—å•ç²¾åº¦å¤æ•°çš„å¹³æ–¹æ ¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn csqrtf(z: Complex) -&gt; Complex;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // è¿™ä¸ªç”¨æ¥è®¡ç®—å•ç²¾åº¦å¤æ•°çš„å¤å˜ä½™å¼¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        fn ccosf(z: Complex) -&gt; Complex;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç”±äºè°ƒç”¨å…¶ä»–è¯­è¨€çš„å‡½æ•°è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç»™å®ƒä»¬å†™ä¸€å±‚å®‰å…¨çš„å°è£…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn cos(z: Complex) -&gt; Complex {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        unsafe { ccosf(z) }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // z = -1 + 0i</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let z = Complex { re: -1., im: 0. };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è°ƒç”¨å¤–éƒ¨è¯­è¨€å‡½æ•°æ˜¯ä¸å®‰å…¨æ“ä½œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let z_sqrt = unsafe { csqrtf(z) };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;the square root of {:?} is {:?}&quot;, z, z_sqrt);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è°ƒç”¨ä¸å®‰å…¨æ“ä½œçš„å®‰å…¨çš„ API å°è£…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;cos({:?}) = {:?}&quot;, z, cos(z));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6333-åœ¨-c-ä¸­è°ƒç”¨-rust">6.3.3.3. åœ¨ c ä¸­è°ƒç”¨ rust<a href="#6333-åœ¨-c-ä¸­è°ƒç”¨-rust" class="hash-link" aria-label="6.3.3.3. åœ¨ c ä¸­è°ƒç”¨ rustçš„ç›´æ¥é“¾æ¥" title="6.3.3.3. åœ¨ c ä¸­è°ƒç”¨ rustçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="634-å’Œ-python-äº¤äº’">6.3.4. å’Œ Python äº¤äº’<a href="#634-å’Œ-python-äº¤äº’" class="hash-link" aria-label="6.3.4. å’Œ Python äº¤äº’çš„ç›´æ¥é“¾æ¥" title="6.3.4. å’Œ Python äº¤äº’çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://github.com/PyO3/pyo3" target="_blank" rel="noopener noreferrer">https://github.com/PyO3/pyo3</a>
<a href="https://saidvandeklundert.net/learn/2021-11-18-calling-rust-from-python-using-pyo3/" target="_blank" rel="noopener noreferrer">https://saidvandeklundert.net/learn/2021-11-18-calling-rust-from-python-using-pyo3/</a>
<a href="https://zhuanlan.zhihu.com/p/148144823" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/148144823</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="635-å’Œ-swift">6.3.5. å’Œ Swift<a href="#635-å’Œ-swift" class="hash-link" aria-label="6.3.5. å’Œ Swiftçš„ç›´æ¥é“¾æ¥" title="6.3.5. å’Œ Swiftçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>cbingen</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="636-å’Œ-js-javascript-nodejs-äº¤äº’">6.3.6. å’Œ js JavaScript nodejs äº¤äº’<a href="#636-å’Œ-js-javascript-nodejs-äº¤äº’" class="hash-link" aria-label="6.3.6. å’Œ js JavaScript nodejs äº¤äº’çš„ç›´æ¥é“¾æ¥" title="6.3.6. å’Œ js JavaScript nodejs äº¤äº’çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>neon -&gt; å’Œ node äº¤äº’</p><p><a href="https://github.com/napi-rs/napi-rs" target="_blank" rel="noopener noreferrer">https://github.com/napi-rs/napi-rs</a></p><p><a href="https://rustwasm.github.io/" target="_blank" rel="noopener noreferrer">https://rustwasm.github.io/</a> webassembly</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="637-å’Œ-java-äº¤äº’">6.3.7. å’Œ java äº¤äº’<a href="#637-å’Œ-java-äº¤äº’" class="hash-link" aria-label="6.3.7. å’Œ java äº¤äº’çš„ç›´æ¥é“¾æ¥" title="6.3.7. å’Œ java äº¤äº’çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://github.com/jni-rs/jni-rs" target="_blank" rel="noopener noreferrer">https://github.com/jni-rs/jni-rs</a>
<a href="https://github.com/astonbitecode/j4rs" target="_blank" rel="noopener noreferrer">https://github.com/astonbitecode/j4rs</a></p><p>flapigen-rs, robusta</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6371-java-è°ƒç”¨-rust">6.3.7.1. java è°ƒç”¨ rust<a href="#6371-java-è°ƒç”¨-rust" class="hash-link" aria-label="6.3.7.1. java è°ƒç”¨ rustçš„ç›´æ¥é“¾æ¥" title="6.3.7.1. java è°ƒç”¨ rustçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p><a href="https://github.com/drrb/java-rust-example" target="_blank" rel="noopener noreferrer">https://github.com/drrb/java-rust-example</a></p><p><a href="https://github.com/jnr/jnr-ffi" target="_blank" rel="noopener noreferrer">https://github.com/jnr/jnr-ffi</a></p><p><a href="https://github.com/drrb/java-rust-example" target="_blank" rel="noopener noreferrer">https://github.com/drrb/java-rust-example</a>
<a href="https://stackoverflow.com/questions/30258427/calling-rust-from-java" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/30258427/calling-rust-from-java</a></p><p><a href="https://blog.csdn.net/abcamus/article/details/81017325" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/abcamus/article/details/81017325</a></p><p><a href="https://rustcc.cn/article?id=98b96e69-7a5f-4bba-a38e-35bdd7a0a7dd" target="_blank" rel="noopener noreferrer">https://rustcc.cn/article?id=98b96e69-7a5f-4bba-a38e-35bdd7a0a7dd</a> å„ç§åº“åŒºåˆ«</p><p><a href="https://rustcc.cn/article?id=f371a5f1-08fa-4ab8-99a4-21d307223f82" target="_blank" rel="noopener noreferrer">https://rustcc.cn/article?id=f371a5f1-08fa-4ab8-99a4-21d307223f82</a> rust å¯¼å‡ºå…±äº«åº“</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6372-rust-è°ƒç”¨-java">6.3.7.2. rust è°ƒç”¨ java<a href="#6372-rust-è°ƒç”¨-java" class="hash-link" aria-label="6.3.7.2. rust è°ƒç”¨ javaçš„ç›´æ¥é“¾æ¥" title="6.3.7.2. rust è°ƒç”¨ javaçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p><a href="https://github.com/benanders/rjni" target="_blank" rel="noopener noreferrer">https://github.com/benanders/rjni</a> </p><h1>7. å†…å­˜ç®¡ç†</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="71-å †-å’Œ-æ ˆ">7.1. å † å’Œ æ ˆ<a href="#71-å †-å’Œ-æ ˆ" class="hash-link" aria-label="7.1. å † å’Œ æ ˆçš„ç›´æ¥é“¾æ¥" title="7.1. å † å’Œ æ ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ‰‹åŠ¨ç®¡ç†å†…å­˜ -&gt; bug (å†…å­˜æ³„æ¼, å‚æ‚¬æŒ‡é’ˆ)</p><p>gc -&gt; æ€§èƒ½é—®é¢˜(stop the world, å› ä¸ºGC åœ¨å·¥ä½œçš„ æ—¶å€™å¿…é¡»ä¿è¯ç¨‹åºä¸ä¼šå¼•å…¥æ–°çš„â€œåƒåœ¾&quot;, æ‰€ä»¥è¦ä½¿è¿è¡Œä¸­çš„ç¨‹åºæš‚åœ)</p><ul><li><p>è™šæ‹Ÿå†…å­˜ç®¡ç†æŠ€æœ¯: å¯¹ç‰©ç†å­˜å‚¨è®¾å¤‡çš„æŠ½è±¡, æ–¹ä¾¿åŒæ—¶è¿è¡Œ å¤šé“ç¨‹åº ï¼Œä½¿å¾—æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å„è‡ªç‹¬ç«‹çš„è¿›ç¨‹åœ°å€ç©ºé—´</p></li><li><p>è™šæ‹Ÿåœ°å€ç©ºé—´: (ç”¨æˆ·æ‰€æ¥è§¦åˆ°çš„åœ°å€éƒ½æ˜¯è™šæ‹Ÿåœ°å€ï¼Œè€Œä¸æ˜¯çœŸå® çš„ç‰©ç†åœ°å€)</p><ul><li><p>æ˜¯çº¿æ€§ç©ºé—´, åˆ†ä¸º ç”¨æˆ·ç©º é—´å’Œå†…æ ¸ç©ºé—´ (å®ƒä»¬çš„æ¯”ä¾‹æ˜¯ 3:1 (Linuxç³»ç»Ÿä¸­)æˆ– 2:2 (Windowsç³»ç»Ÿä¸­))</p><p>  32 ä½è®¡ç®—æœºLinuxçš„åœ°å€ç©ºé—´å¤§å°æ˜¯ 4GB</p></li><li><p>å¥½å¤„:</p><ul><li><p>ç”¨æˆ·ç¨‹åºå¯ä»¥ä½¿ç”¨æ¯”ç‰©ç†å†…å­˜æ›´å¤§çš„åœ°å€ç©ºé—´</p></li><li><p>ä¿æŠ¤æ“ä½œç³»ç»Ÿï¼Œè®©è¿›ç¨‹åœ¨å„è‡ªçš„åœ°å€ç©ºé—´å†…æ“ä½œå†…å­˜</p></li></ul></li></ul></li><li><p>ç”¨æˆ·ç©ºé—´ä¸­çš„ æ ˆ (stack), å † (heap)</p><ul><li><p>æ ˆ (å †æ ˆ): ç”¨ äºæ”¯æŒ CPU å…¥æ ˆæˆ–å‡ºæ ˆçš„æŒ‡ä»¤æ“ä½œ, å¦‚å‡½æ•°åµŒå¥—è°ƒç”¨æ—¶éœ€è¦å­˜å‚¨æ–¹æ³•æ ˆå¸§</p><p>  stack å†…å­˜ä¸­ä¿å­˜çš„æ•°æ®ï¼Œç”Ÿå‘½å‘¨æœŸéƒ½æ¯”è¾ƒçŸ­ï¼Œä¼šéšç€å‡½æ•°è°ƒç”¨çš„å®Œæˆè€Œæ¶ˆäº¡, </p><p>  å¯¹äºåŸºæœ¬åŸç”Ÿæ•°æ®ç±»å‹æ¥è¯´ï¼Œ Rust æ˜¯é»˜è®¤å°†å…¶åˆ†é…åˆ°æ ˆä¸­çš„</p><p>  ç»“æ„ä½“æˆ–æšä¸¾, è”åˆä½“åªæ˜¯å®šä¹‰ï¼Œçœ‹å®ƒä»¬è¢«åˆ†é…åœ¨å“ª ï¼Œä¸»è¦æ˜¯çœ‹å…¶ç±»å‹å®ä¾‹å¦‚ ä½•ä½¿ç”¨</p></li><li><p>å †: ä¸€å—å·¨å¤§çš„å†…å­˜ç©ºé—´, é•¿ä¹…åœ°ä¿å­˜åœ¨å†…å­˜ä¸­çš„æ•°æ®ï¼Œä»¥ä¾¿è·¨å‡½æ•°ä½¿ç”¨;ç¨‹åºä¸å¯ä»¥ä¸»åŠ¨ç”³è¯·æ¡” å†…å­˜ï¼Œä½†å¯ä»¥ä¸»åŠ¨ç”³è¯·å †å†…å­˜</p></li><li><p>å †åˆ†é…ç®—æ³•: ç©ºé—²é“¾è¡¨ (Free List)å’Œä½å›¾æ ‡è®° (Bitmap)ã€‚</p><p>  ç©ºé—²é“¾è¡¨å®é™…ä¸Šå°±æ˜¯æŠŠå †ä¸­ç©ºé—²çš„å†…å­˜åœ°å€è®°å½•ä¸ºé“¾è¡¨ ï¼Œ å½“ç³»ç»Ÿæ”¶åˆ°ç¨‹åºç”³è¯·æ—¶ï¼Œä¼šé å†è¯¥é“¾è¡¨:å½“æ‰¾åˆ°é€‚åˆçš„ç©ºé—´å †èŠ‚ç‚¹ æ—¶ï¼Œ ä¼šå°†æ­¤èŠ‚ç‚¹ä»é“¾è¡¨ä¸­åˆ é™¤;å½“ç©ºé—´è¢«å›æ”¶ä»¥å ï¼Œ å† å°†å…¶åŠ åˆ°ç©ºé—²é“¾è¡¨ä¸­ã€‚ç©ºé—²é“¾è¡¨çš„ä¼˜åŠ¿æ˜¯å®ç°ç®€å•ï¼Œä½†å¦‚æœé“¾è¡¨é­åˆ°ç ´å ï¼Œ æ•´ä¸ªå †å°±æ— æ³•æ­£ å¸¸å·¥ä½œã€‚</p><p>  ä½å›¾çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•´ä¸ªå †åˆ’åˆ†ä¸ºå¤§é‡å¤§å°ç›¸ç­‰çš„å—ã€‚ å½“ç¨‹åºç”³è¯·å†…å­˜æ—¶ï¼Œæ€»æ˜¯åˆ†é…æ•´ æ•°ä¸ªå—çš„ç©ºé—´ã€‚æ¯å—å†…å­˜éƒ½ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶ä½æ¥è¡¨ç¤ºå…¶çŠ¶æ€ï¼Œå¦‚æœè¯¥å†…å­˜è¢«å ç”¨ ï¼Œåˆ™ç›¸åº”ä½å›¾ ä¸­çš„ä½ç½®ç½®ä¸º 1;å¦‚æœè¯¥å†…å­˜ç©ºé—²ï¼Œåˆ™ç›¸åº”ä½å›¾ä¸­çš„ä½ç½®ç½®ä¸º 0ã€‚ä½å›¾çš„ä¼˜åŠ¿æ˜¯é€Ÿåº¦å¿«ï¼Œå¦‚ æœå•ä¸ªå†…å­˜å—æ•°æ®é­åˆ°ç ´åï¼Œ ä¹Ÿä¸ä¼šå½±å“æ•´ä¸ªå †ï¼Œä½†ç¼ºç‚¹æ˜¯å®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡</p></li><li><p>å†…å­˜é‡Šæ”¾: åˆ†é…çš„éƒ½æ˜¯è™šæ‹Ÿåœ°å€ç©º é—´ ã€‚ æ‰€ä»¥å½“å †ç©ºé—´è¢«é‡Šæ”¾æ—¶ï¼Œå¹¶ä¸ä»£è¡¨æŒ‡ç‰©ç† ç©º é—´ä¹Ÿ é©¬ä¸Šè¢«é‡Šæ”¾, åªæ˜¯å†…å­˜è¢«å½’è¿˜ç»™äº†å†…å­˜åˆ†é…å™¨ã€‚ å†…å­˜åˆ†é… å™¨ä¼šå¯¹ç©ºé—²çš„ å†…å­˜è¿›è¡Œç»Ÿä¸€ â€œæ•´ç†â€, åœ¨é€‚åˆ( æ¯”å¦‚ç©ºé—²å†…å­˜è¾¾åˆ° 2048KB)çš„æ—¶å€™ï¼Œæ‰ä¼šæŠŠ å†…å­˜å½’è¿˜ç»™ç³»ç»Ÿ ï¼Œä¹Ÿå°±æ˜¯æŒ‡é‡Šæ”¾ç‰©ç†ç©º é—´</p><p>  Rust ç¼–è¯‘å™¨ç›®å‰è‡ªå¸¦ä¸¤ä¸ªé»˜è®¤åˆ†é… å™¨: alloc_system å’Œ alloc_jemalloc, Rust 2018 ç‰ˆæœ¬ ä¸‹ï¼Œ é»˜è®¤ä½¿ç”¨ alloc_system, å¯ä»¥è‡ªå·±æŒ‡å®š</p></li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="72-å†…å­˜å¯¹é½">7.2. å†…å­˜å¯¹é½<a href="#72-å†…å­˜å¯¹é½" class="hash-link" aria-label="7.2. å†…å­˜å¯¹é½çš„ç›´æ¥é“¾æ¥" title="7.2. å†…å­˜å¯¹é½çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å†…å­˜å¯¹é½, å³å­—èŠ‚å¯¹é½, å‡å°‘ cpu è¯»å–å†…å­˜æ¬¡æ•°</p><p>CPUåœ¨å•ä½æ—¶é—´/ä¸€æ¬¡è®¡ç®—èƒ½å¤„ç†çš„ä½æ•° -&gt; å­—é•¿, 32ä½CPUï¼Œ å…¶å­—é•¿ä¸º32ä½ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡è¯»å–4ä¸ªå­—èŠ‚, æ‰€ä»¥æ¯æ¬¡åªèƒ½å¯¹ 4 çš„ å€æ•°çš„ åœ°å€ è¿›è¡Œè¯»å–</p><p>ç°æœ‰ä¸€æ•´æ•°ç±»å‹çš„æ•°æ®ï¼Œé¦–åœ°å€å¹¶ä¸æ˜¯ 4 çš„å€æ•°ï¼Œä¸å¦¨è®¾ä¸º Ox3, å­˜å‚¨åœ¨ åœ°å€èŒƒå›´æ˜¯ Ox3~Ox7 çš„å­˜å‚¨ç©ºé—´, cpu éœ€è¦åˆ†åˆ«åœ¨ Ox1 å’Œ Ox5 å¤„è¿›è¡Œä¸¤æ¬¡è¯»å–, é‡‡å–å†…å­˜å¯¹é½ç­–ç•¥å, æ•°æ®çš„é¦–åœ°å€å˜ä¸º 0x5, CPUåªéœ€è¦è¯»å–ä¸€æ¬¡ã€‚</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹åº”åˆ°ä»£ç å±‚é¢:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct A {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a: u8,// 1byte</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b: u32,// 4byte</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    c: u16,  // 2 byte</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">println!(&quot;{:?}&quot;, std :: mem::size o f : : &lt; A &gt; ( );// 8 , å•ä½ å­—èŠ‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åˆ†æ:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ€»å…±æ˜¯ 7, ä¸ºä»€ä¹ˆæ‰“å° 8 ?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å› ä¸ºå­˜åœ¨å†…å­˜å¯¹é½ç­–ç•¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å†…å­˜å¯¹é½åŒ…æ‹¬åŸºæœ¬æ•°æ®å¯¹é½å’Œç»“æ„ä½“(æˆ–è”åˆä½“)æ•°æ®å¯¹é½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œé»˜è®¤ å¯¹é½æ–¹å¼æ˜¯æŒ‰å…¶å¤§å°è¿›è¡Œå¯¹é½ï¼Œä¹Ÿè¢«ç§°ä½œè‡ªç„¶å¯¹é½ã€‚ æ¯”å¦‚Rustä¸­u32ç±»å‹å 4å­—èŠ‚ï¼Œåˆ™å®ƒé»˜ è®¤å¯¹é½æ–¹å¼ä¸º 4 å­—èŠ‚å¯¹é½</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="73-æ‰‹åŠ¨å †å†…å­˜åˆ†é…">7.3. æ‰‹åŠ¨å †å†…å­˜åˆ†é…<a href="#73-æ‰‹åŠ¨å †å†…å­˜åˆ†é…" class="hash-link" aria-label="7.3. æ‰‹åŠ¨å †å†…å­˜åˆ†é…çš„ç›´æ¥é“¾æ¥" title="7.3. æ‰‹åŠ¨å †å†…å­˜åˆ†é…çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>åœ¨ç¼–å†™ Unsafe Rustçš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿéœ€è¦æ‰‹åŠ¨è¿›è¡Œå †å†…å­˜åˆ†é…ï¼Œæ‰€ä»¥ Rustæ ‡å‡†åº“ std::alloc æ¨¡å—ä¸­ä¹Ÿæä¾› äº†å †å†…å­˜ åˆ†é…çš„ ç›¸ å…³ API</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// Rust 1.28ä¹‹å‰é»˜è®¤å…¨å±€å†…å­˜åˆ†é…å™¨ï¼šjemalloc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Rust 1.28å†…å­˜åˆ†é…å™¨ : Systemï¼ŒåŒæ—¶ä¼šæä¾›å…¶ä»–å…¨å±€åˆ†é…å™¨ï¼Œå¯è‡ªå®šä¹‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::alloc::{GlobalAlloc, System, Layout};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct MyAllocator;// å¯ä»¥ç›´æ¥ä½¿ç”¨GlobalAlloc, è¿™é‡Œæ˜¯åšäº†ä¸€ä¸ªåŒ…è£…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">unsafe impl GlobalAlloc for MyAllocator {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe fn alloc(&amp;self, layout: Layout) -&gt; *mut u8 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        System.alloc(layout)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe fn dealloc(&amp;self, ptr: *mut u8, layout: Layout) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        System.dealloc(ptr, layout)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å£°æ˜ä¸ºå…¨å±€åˆ†é…å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[global_allocator]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">static GLOBAL: MyAllocator = MyAllocator;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   // æ­¤å¤„Vecçš„å†…å­˜ä¼šç”±GLOBALå…¨å±€åˆ†é…å™¨æ¥åˆ†é…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let mut v = Vec::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   v.push(1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æŒ‡å®šå…¨å±€åˆ†é…å™¨ä¸ºjemalloc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">extern crate jemallocator;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use jemallacator::Jemalloc;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[global_allocator]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">static GLOBAL: Jemalloc = Jemalloc;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>8. å·¥ç¨‹ç®¡ç† æ¨¡å—</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="81-æ¦‚å¿µç®€å•è§£é‡Š">8.1. æ¦‚å¿µç®€å•è§£é‡Š<a href="#81-æ¦‚å¿µç®€å•è§£é‡Š" class="hash-link" aria-label="8.1. æ¦‚å¿µç®€å•è§£é‡Šçš„ç›´æ¥é“¾æ¥" title="8.1. æ¦‚å¿µç®€å•è§£é‡Šçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://www.jianshu.com/p/51693602114a" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/51693602114a</a>
<a href="https://zhuanlan.zhihu.com/p/73544030" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/73544030</a>
or
<a href="https://privaterookie.github.io/2019-07-14-Rust%E6%A8%A1%E5%9D%97%E4%B8%8E%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener noreferrer">https://privaterookie.github.io/2019-07-14-Rust%E6%A8%A1%E5%9D%97%E4%B8%8E%E6%96%87%E4%BB%B6/</a></p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// - ç®±ï¼ˆCrateï¼‰: äºŒè¿›åˆ¶ç¨‹åºæ–‡ä»¶or åº“æ–‡ä»¶, ä½äºåŒ…ä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// - åŒ…ï¼ˆPackageï¼‰: cargo new xxx æ–°å»ºçš„ å°±æ˜¯ åŒ…; åŒ…å¿…é¡»ç”±ä¸€ä¸ª Cargo.toml æ–‡ä»¶æ¥ç®¡ç†ï¼Œè¯¥æ–‡ä»¶æè¿°äº†åŒ…çš„åŸºæœ¬ä¿¡æ¯ä»¥åŠä¾èµ–é¡¹ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///    ä¸€ä¸ª package æœ€å°‘æœ‰ä¸€ä¸ª crate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///    å½“ä½¿ç”¨ cargo new å‘½ä»¤åˆ›å»ºå®ŒåŒ…ä¹‹åï¼Œsrc ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ª main.rs æºæ–‡ä»¶ï¼ŒCargo é»˜è®¤è¿™ä¸ªæ–‡ä»¶ä¸ºäºŒè¿›åˆ¶ç®±çš„æ ¹ï¼Œç¼–è¯‘ä¹‹åçš„äºŒè¿›åˆ¶ç®±å°†ä¸åŒ…åç›¸åŒã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// - æ¨¡å—ï¼ˆModuleï¼‰: ä½¿ç”¨ mod å£°æ˜ä¸€ä¸ªæ¨¡å—, ä¸€ä¸ªæ–‡ä»¶é»˜è®¤å°±æ˜¯ä¸€ä¸ª module, æ–‡ä»¶åå°±æ˜¯ module name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      æ¯ä¸ªåŒ…éƒ½æ‹¥æœ‰ä¸€ä¸ªé¡¶çº§ (top level) æ¨¡å— src/lib.rs æˆ– src/main.rsã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     æ¯ä¸ª rust æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ª module, æ¯”å¦‚: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      (è‹¥æƒ³åœ¨åŒä¸ªæ–‡ä»¶å®šä¹‰å¤šä¸ª module , åªéœ€ mod xx_module {...} mod yy_module {...})</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     ```</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     // main.rs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     mod second_module; // å£°æ˜ä¸€ä¸ªæ¨¡å—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     fn main() {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///         println!(&quot;This is the main module.&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///         println!(&quot;{}&quot;, second_module::message());</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     // second_module.rs, æ¨¡å—åå°±æ˜¯æ–‡ä»¶å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     pub fn message() -&gt; String {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///         String::from(&quot;This is the 2nd module.&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///     ```</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      è‹¥å¸Œæœ›å¤šä¸ª æ–‡ä»¶, ç»„æˆä¸€ä¸ª module,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      éœ€è¦:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹, æ–°å»ºä¸€ä¸ª mod.rs (2018 ä¸­å¯ä»¥çœç•¥äº†), ç„¶ååœ¨å…¶ä¸­å¯¼å‡ºå³å¯ (pub use sub1; pub use sub2;), æ–° module name = æ–‡ä»¶å¤¹å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//      è‹¥æ–‡ä»¶å¤¹ å’ŒæŸä¸ªæ–‡ä»¶ aa.rs åŒå, åˆ™æ–‡ä»¶å¤¹ä¸‹å®šä¹‰çš„ module éƒ½æ˜¯ aa.rs çš„å­æ¨¡å— (2015 ä¸­åˆ™ä¸å…è®¸æ–‡ä»¶ä¸ç›®å½•åŒå)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">mod_package_crate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è·¯å¾„:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Rust ä¸­çš„è·¯å¾„åˆ†éš”ç¬¦æ˜¯ ::</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç»å¯¹è·¯å¾„ä» crate å…³é”®å­—å¼€å§‹æè¿°ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›¸å¯¹è·¯å¾„ä» self æˆ– super å…³é”®å­—æˆ–ä¸€ä¸ªæ ‡è¯†ç¬¦å¼€å§‹æè¿°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¦‚: å¯¼å…¥å¤–éƒ¨ä¾èµ–</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">super</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">deserial</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> serial</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯¼å…¥ parent æŒ‡å®šèµ„æº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">super</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¼å…¥ parent çš„æ‰€æœ‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">crate</span><span class="token module-declaration namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token module-declaration namespace">codec</span><span class="token module-declaration namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">serial</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> deserial</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç»å¯¹è·¯å¾„, codec ä¸ºä¾èµ– (ä¸è®ºæ˜¯è‡ªå®šä¹‰æ¨¡å—è¿˜æ˜¯ç¬¬ä¸‰æ–¹ä¾èµ–, è‹¥ä¸ºç¬¬ä¸‰æ–¹æ¨¡å—, åˆ™ crate å…³é”®å­—å¯é€‰), codec ä¹Ÿèƒ½æ˜¯ åŒä¸ªé¡¹ç›®çš„å…¶ä»– module (rust æ–‡ä»¶)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//  æ ‡å‡†åº“ é»˜è®¤å¯¼å…¥äº†, æ‰€ä»¥ä»¥ä¸‹ä¸¤å¥å¯é€‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">extern</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">crate</span><span class="token plain"> </span><span class="token module-declaration namespace">std</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¼å…¥ æ ‡å‡†åº“ std crate, è¿™æ˜¯ 2015 ä¸­çš„è¯­æ³•, 2018 ä¸­å¯é€‰äº†, åªéœ€è¦ cargo.toml ä¸­å¯¼å…¥å³å¯, æ— éœ€å†ä»£ç ä¸­æ˜¾å¼æŒ‡å®š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> std </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">prelude</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">vl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ ‡å‡†åº“çš„ prelude module</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åœ¨ module å¼€å¤´å£°æ˜ä¸éœ€è¦ æ ‡å‡†åº“, ä½¿ç”¨ æ ¸å¿ƒåº“(åµŒå…¥å¼å¼€å‘å¿…é¡»)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[no_std]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// govern å‡½æ•°çš„ç»å¯¹è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">crate</span><span class="token module-declaration namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token module-declaration namespace">nation</span><span class="token module-declaration namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token module-declaration namespace">government</span><span class="token module-declaration namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">govern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç›¸å¯¹è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">nation</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">government</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">govern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//Rust ä¸­æœ‰ä¸¤ç§ç®€å•çš„è®¿é—®æƒï¼šå…¬å…±ï¼ˆpubï¼‰å’Œç§æœ‰ï¼ˆæ¨¡å—æˆå‘˜é»˜è®¤éƒ½æ˜¯ç§æœ‰ï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç§æœ‰ æ¨¡å—ä¸­çš„å…ƒç´ éƒ½éœ€è¦ pub ä¿®é¥°æ‰èƒ½åœ¨å¤–éƒ¨è®¿é—®åˆ° , ä½†æ˜¯ æšä¸¾ç±»çš„å­—æ®µä¸å—è¿™ä¸ªé™åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯¹äºç§æœ‰çš„æ¨¡å—ï¼Œåªæœ‰åœ¨ä¸å…¶å¹³çº§çš„ä½ç½®æˆ–ä¸‹çº§çš„ä½ç½®æ‰èƒ½è®¿é—®ï¼Œä¸èƒ½ä»å…¶å¤–éƒ¨è®¿é—®ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">nation</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">government</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">govern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;govern()&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">congress</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">legislate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;legislate()&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">court</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">judicial</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token macro property">print!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;judicial - &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">super</span><span class="token module-declaration namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token module-declaration namespace">congress</span><span class="token module-declaration namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">legislate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// use å…³é”®å­—å¯ä»¥ä¸ pub å…³é”®å­—é…åˆä½¿ç”¨ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">congress</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">legislate </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> le</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">nation</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">government</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">govern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">nation</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">court</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">judicial</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¼å…¥ and ç®€åŒ–è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">nation</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">court</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">judicial </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain">  ju</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">ju</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">nation</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">le</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="82-å¯è§æ€§ç®¡ç†">8.2. å¯è§æ€§ç®¡ç†<a href="#82-å¯è§æ€§ç®¡ç†" class="hash-link" aria-label="8.2. å¯è§æ€§ç®¡ç†çš„ç›´æ¥é“¾æ¥" title="8.2. å¯è§æ€§ç®¡ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>pub use T å¯¼å‡ºäº† Tï¼ŒT å¯ä»¥è¢«å…¶ä»– crate ä½¿ç”¨ï¼›pub (crate) use T åªæŠŠ T å¯¼å‡ºåˆ°å½“å‰çš„ crateï¼Œå…¶ä»– crate è®¿é—®ä¸äº†</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="83-ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†">8.3. ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†<a href="#83-ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†" class="hash-link" aria-label="8.3. ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†çš„ç›´æ¥é“¾æ¥" title="8.3. ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹, æ”¾ rust-toolchain æ–‡ä»¶, æŒ‡å®šç¼–è¯‘å™¨ç‰ˆæœ¬</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="84-ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig-é…ç½®">8.4. ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig é…ç½®<a href="#84-ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig-é…ç½®" class="hash-link" aria-label="8.4. ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig é…ç½®çš„ç›´æ¥é“¾æ¥" title="8.4. ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig é…ç½®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">cargo å…¨å±€é…ç½® </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">cargo</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">confg</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">å½“å‰ç”¨æˆ·å…¨å±€é…ç½®</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> $</span><span class="token constant" style="color:rgb(129, 31, 63)">HOME</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">cargo</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">é¡¹ç›®å•ç‹¬é…ç½®</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain">     $proj</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">cargo</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token function" style="color:rgb(0, 0, 255)">config</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">å­æ¨¡å—äº¦å¯ç»§ç»­æŒ‡å®š</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="85-ä¾èµ–ç®¡ç†-cargo">8.5. ä¾èµ–ç®¡ç† cargo<a href="#85-ä¾èµ–ç®¡ç†-cargo" class="hash-link" aria-label="8.5. ä¾èµ–ç®¡ç† cargoçš„ç›´æ¥é“¾æ¥" title="8.5. ä¾èµ–ç®¡ç† cargoçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="851-cargo-åŸºæœ¬å‘½ä»¤">8.5.1. cargo åŸºæœ¬å‘½ä»¤<a href="#851-cargo-åŸºæœ¬å‘½ä»¤" class="hash-link" aria-label="8.5.1. cargo åŸºæœ¬å‘½ä»¤çš„ç›´æ¥é“¾æ¥" title="8.5.1. cargo åŸºæœ¬å‘½ä»¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># æ–°å»ºå¯æ‰§è¡Œç¨‹åº, é»˜è®¤æ˜¯ --bin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç”Ÿæˆ main.rs å¯åŠ¨ç±»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo new [--bin] &lt;proj&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸åˆå§‹åŒ– git</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo new &lt;proj&gt; --vcs none</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ–°å»ºåº“, åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç”Ÿæˆ çš„åº“ä¸‹, æœ‰ src, toml, lib_name.rs (å¸¦æœ‰åŸºæœ¬çš„æµ‹è¯•)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo new --lib &lt;lib name&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹æ–°å»ºé¡¹ç›®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo init [--bin]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo init --lib</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ„å»º, æ›´æ–°ä¾èµ–, ä¾èµ–åœ¨è¿™é‡Œæ‰¾ https://crates.io/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é»˜è®¤æ˜¯ä»¥ debug æ–¹å¼ç¼–è¯‘, ç¼–è¯‘é€Ÿåº¦å¿«, ä½†æ˜¯ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶æœªä¼˜åŒ–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># build åä¼šç”Ÿæˆ Cargo.lock</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#  ./target/debug/project_name ä¸­æ‰¾åˆ°ç¼–è¯‘åçš„ å¯æ‰§è¡Œæ–‡ä»¶(exe) è¿è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo build </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½¿ç”¨ --release å‚æ•°ç¼–è¯‘æœ€ç»ˆå‘å¸ƒç‰ˆæœ¬ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç¼–è¯‘å™¨ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œ ä½¿å¾—ç¼–è¯‘æ—¶é—´å˜æ…¢ï¼Œ ä½†æ˜¯ä»£ç è¿è¡Œé€Ÿåº¦ä¼šå˜å¿«ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo build --release</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŒ‡å®šæ¡ä»¶ç¼–è¯‘å±æ€§ (å¯ä»¥åœ¨ Cargo.toml ä¸­æŒ‡å®š)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¼šç»™ rustc ä¼ é€’ --cfg features=&quot;xxx&quot;, è¡¨ç¤º ä¼šç¼–è¯‘ aa_module æ¨¡å—, ä¸æŒ‡å®š xxx feature åˆ™ä¸ä¼šç¼–è¯‘ è¯¥æ¨¡å—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo build --features &quot;xxx&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åœ¨ä»£ç ä¸­è¿™ä¹ˆä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#   # è¡¨ç¤ºè‹¥æ²¡æœ‰æŒ‡å®š xxx feature, åˆ™ç¼–è¯‘æŠ¥é”™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#   #[cfg(not(feature = &quot;xxx&quot;))]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#   compile_error!(&quot;xxx feature is required to build this crate&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#   # è¡¨ç¤º åªæœ‰æŒ‡å®š äº† xxx feature, ç¼–è¯‘æ—¶æ‰ä¼šåŒ…å« aa_module è¿›å»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#   #[cfg(feature = &quot;xxx&quot;)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#   mod aa_module</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo check # è¿…é€Ÿæ£€æŸ¥é”™è¯¯, æ—¶é—´çŸ­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo run </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿è¡Œ example æ–‡ä»¶å¤¹ä¸‹çš„ server.rs çš„ main()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo run --example server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿è¡ŒæŒ‡å®šå­æ¨¡å—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo run -p &lt;xxx&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿è¡Œå½“å‰é¡¹ç›®(rust_tools)ä¸‹çš„ bin æ–‡ä»¶å¤¹ä¸‹çš„ chat_server.rs å¯æ‰§è¡Œæ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo run --package rust_tools --bin chat_server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä»ä¸­å¿ƒä»“åº“å®‰è£…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo install &lt;package&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä» GitHub å®‰è£…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo install orz --git https://github.com/richox/orz --tag v1.6.1 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo doc # ç”Ÿæˆhtmlæ–‡æ¡£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo doc --open # åŒæ—¶æ‰“å¼€æ–‡æ¡£é¢„è§ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo doc --target-doc ./ #è¾“å‡ºæ–‡æ¡£æ—¶æŒ‡å®štargetç›®å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># # æµ‹è¯•, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¼šè·‘ #cfg[test] ä¸‹çš„ #[test]; ä¹Ÿä¼šè·‘æ–‡æ¡£æ³¨é‡Š (å•å…ƒæµ‹è¯•)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># and  tests/ ä¸‹çš„æµ‹è¯• (é›†æˆæµ‹è¯•)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo test </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo test xxx # è¿‡æ»¤, è¿è¡Œä»»ä½•åå­—ä¸­åŒ…å« xxx çš„æµ‹è¯•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo publish # publish a library to crates.io</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo --version</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># This will write out a new Cargo.lock with the new version information</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo update           # updates all dependencies</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo update -p rand   # updates just â€œrandâ€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç¬¬ä¸‰æ–¹æ’ä»¶æ‰©å±•:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># éœ€è¦ rustup component add rustfmt [ä¸€toolchain nightly]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo fmt # æ ¼å¼åŒ–é¡¹ç›®ä»£ç , åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ, ä¼šç”Ÿæˆå¤‡ä»½æ–‡ä»¶, .bkç»“å°¾, è·³è¿‡æ ¼å¼åŒ– #[rustfmt_skip]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo fix # è‡ªåŠ¨ä¿®å¤ä»£ç è­¦å‘Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cargo clippy #æ•æ‰å¸¸è§é”™è¯¯ï¼Œæ”¹å–„ä»£ç  (éœ€è¦å®‰è£… clippy)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è‡ªå®šä¹‰æ ¼å¼åŒ–:  åœ¨é¡¹ç›®æ ¹ç›®å½• rustfmt.tomI</p><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">max_width = 90 # æœ€å¤§å®½åº¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn_call_width = 90 # å‡½æ•°å®½åº¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">chain_one_line_max = 80 # é“¾å¼è°ƒç”¨æœ€å¤§å®½åº¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">condense_wildcard_suffixes = true # å‹ç¼©é€šé…ç¬¦å‰ç¼€</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="852-æ–‡ä»¶å¸ƒå±€ç»“æ„">8.5.2. æ–‡ä»¶å¸ƒå±€ç»“æ„<a href="#852-æ–‡ä»¶å¸ƒå±€ç»“æ„" class="hash-link" aria-label="8.5.2. æ–‡ä»¶å¸ƒå±€ç»“æ„çš„ç›´æ¥é“¾æ¥" title="8.5.2. æ–‡ä»¶å¸ƒå±€ç»“æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”œâ”€â”€ Cargo.lock</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”œâ”€â”€ Cargo.toml</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”œâ”€â”€ benches #æ€§èƒ½æµ‹è¯•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚Â Â  â””â”€â”€ large-input.rs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”œâ”€â”€ examples    # ç¤ºä¾‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚Â Â  â””â”€â”€ simple.rs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”œâ”€â”€ src    # æºç </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚Â Â  â”œâ”€â”€ bin # å…¶ä»–å¯æ‰§è¡Œæ–‡ä»¶ (å¦‚æœå¯æ‰§è¡Œæ–‡ä»¶åŒ…å«ä¸æ­¢ä¸€ä¸ªæºæ–‡ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨src/binç›®å½•ä¸‹ï¼Œåˆä¸€ä¸ªåŒ…å«main.rsæ–‡ä»¶çš„ç›®å½•,è€Œè¯¥ç›®å½•å°†è¢«è§†ä¸ºå…·æœ‰çˆ¶ç›®å½•åç§°çš„å¯æ‰§è¡Œæ–‡ä»¶)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚Â Â  â”‚Â Â  â””â”€â”€ another_executable.rs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚Â Â  â”œâ”€â”€ lib.rs  # é»˜è®¤åº“æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚Â Â  â””â”€â”€ main.rs # é»˜è®¤å¯æ‰§è¡Œæ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€ tests   # é›†æˆæµ‹è¯• , å•å…ƒæµ‹è¯•ä¸€èˆ¬å°±å†™åœ¨ src ä¸‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    â””â”€â”€ some-integration-tests.rs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="853-cargotoml">8.5.3. Cargo.toml<a href="#853-cargotoml" class="hash-link" aria-label="8.5.3. Cargo.tomlçš„ç›´æ¥é“¾æ¥" title="8.5.3. Cargo.tomlçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Cargo.toml é¡¹ç›®å…ƒä¿¡æ¯, åŒ…æ‹¬ç‰ˆæœ¬, ä¾èµ–</p><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[package]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">build = &quot;build.rs&quot; # æ„å»ºè„šæœ¬, ç›¸å¯¹äºæ ¹ç›®å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">workspace = &quot;..&quot; # è¿™æ˜¯ sub crate ä¸­çš„é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">member = [&quot;&quot;, &quot;&quot;] # è¿™æ˜¯ parent crate ä¸­çš„é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[bin]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;run-main&quot; # ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„åå­—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;src/main.rs&quot; # å½“æƒ³åœ¨ä¸€ä¸ªä½œä¸ºåº“çš„åŒ…é‡ŒåŒæ—¶åŒ…å« main.rs , éœ€è¦é…ç½®è¿™ä¸ª, æ–‡ä»¶åå¿…é¡»ä¸º main.rs, è‹¥æ”¾åœ¨ src/bin ä¸‹åˆ™å¯ä»¥è‡ªå®šä¹‰æ–‡ä»¶å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bench = false # ç”Ÿæˆ å¯æ‰§è¡Œæ–‡ä»¶æ—¶ä¸æ‰§è¡Œæ€§èƒ½æµ‹è¯•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[bench]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;bench&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;src/bench.rs&quot; # æ€§èƒ½æµ‹è¯•ä»£ç </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">test = false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bench = true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¾èµ–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#  [dependencies] ä¸“é—¨ç”¨äºè®¾ç½®ç¬¬ä¸‰æ–¹åŒ…çš„ä¾èµ–ï¼Œè¿™äº›ä¾èµ–ä¼šåœ¨æ‰§è¡Œ cargo buildå‘½ä»¤ç¼–è¯‘ æ—¶ä½¿ç”¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">uuid = &quot;0.0.1&quot; # ä¼šä»ä¸­å¿ƒä»“åº“ä¸‹è½½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ferris-says = &quot;0.1&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç‰ˆæœ¬å·è§„åˆ™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">gfx-hal = { version = &quot;0.1.0&quot;, git = &quot;https://github.com/gfx-rs/gfx&quot;, rev = &quot;bd7f058efe78d7626a1cc6fbc0c1d3702fb6d2e7&quot; }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#  æˆ–è€…å†™æˆå¤šè¡Œ (ä½¿ç”¨ç‚¹ &quot;.&quot; è¡¨ç¤ºjson ä¸­çš„åµŒå¥—)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[dependencies.gfx-hal]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">git = &quot;https://github.com/gfx-rs/gfx&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">version = &quot;0.1.0&quot; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rev = &quot;bd7f058efe78d7626a1cc6fbc0c1d3702fb6d2e7&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æœ¬åœ°é¡¹ç›®å¯¼å…¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">hello_utils = { path = &quot;../hello_utils&quot;, version = &quot;0.1.0&quot; }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é»˜è®¤ä¸ä¼šè¢«ç¼–è¯‘, ä½†æ˜¯å®šä¹‰äº†ä¸€ä¸ª å’Œä¾èµ–åç§°ä¸€æ ·çš„ feature, å³ gif, åœ¨ä»£ç ä¸­å¯ä»¥ä½¿ç”¨ cfg(feature = &quot;gif&quot;), ç„¶åå‘½ä»¤è¡Œä¸­å¯ä»¥ --features gif ä½¿ç”¨æ¡ä»¶ç¼–è¯‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å½“ç„¶, ä¹Ÿèƒ½è¿™æ ·ä½¿ç”¨: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # [dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # ravif = { version = &quot;0.6.3&quot;, optional = true }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # rgb = { version = &quot;0.8.25&quot;, optional = true }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # [features]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # avif = [&quot;ravif&quot;, &quot;rgb&quot;] (æ— æ³•ç›´æ¥ä½¿ç”¨ raif, æˆ–è€… rgb)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">gif = { version = &quot;0.11.1&quot;, optional = true }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># [dev-dependencies]è¡¨çš„ä½œç”¨ç”¨æ¥è®¾ç½®æµ‹è¯•( tests)ã€ç¤ºä¾‹ (examples)å’ŒåŸºå‡†æµ‹è¯•( benchmarks)æ—¶ä½¿ç”¨çš„ä¾èµ–, åœ¨æ‰§è¡Œ cargo test æˆ– cargo bench å‘½ ä»¤ æ—¶ä½¿ç”¨ ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[dev-dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># build ä¾èµ–åº“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[build-dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cc = &quot;1.0&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰“å¼€æŒ‡å®š feature</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">serde = { version = &quot;1.0.118&quot;, features = [&quot;derive&quot;] }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç¦ç”¨é»˜è®¤æ‰“å¼€çš„ feature</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">flate2 = { version = &quot;1.0.3&quot;, default-features = false, features = [&quot;zlib&quot;] }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ¡ä»¶ç¼–è¯‘åŠŸèƒ½ (é€‰æ‹©æ€§åœ°ç¼– è¯‘ ä»£ ç )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é€šè¿‡å‘½ä»¤è¡Œ --features &quot;foo bar&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é»˜è®¤æ‰€æœ‰ features æ˜¯å…³é—­çš„, é™¤éæ‰‹åŠ¨æ‰“å¼€, é€šè¿‡ default feature å¯ä»¥æ”¹å˜è¿™ä¸€é»˜è®¤çº¦å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯ä»¥é€šè¿‡å¼•å…¥ä¾èµ–æ—¶æŒ‡å®š default-features=false å³ flate2 = { version = &quot;1.0.3&quot;, default-features = false, features = [&quot;zlib&quot;] } æ¥é˜²æ­¢é»˜è®¤æ‰“å¼€æŸäº› feature</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[features]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">default=[&quot;use_std&quot;] # use_std feature å°±é»˜è®¤æ‰“å¼€äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use_std=[]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">unstable= [&quot;pattern&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">patter=[]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰“å¼€jpeg-decoderä¾èµ–çš„ rayon feature</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">parallel = [&quot;jpeg-decoder/rayon&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æœ€ç»ˆç¼–è¯‘ç›®æ ‡åº“çš„ä¿¡æ¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[lib]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = foo # è¡¨ç¤ºå°†æ¥ç¼–è¯‘çš„åº“åå­—ä¸ºâ€œlibfooaâ€ æˆ– â€œlibfoo.so&quot;ç­‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">crate-type = dylib # æ¯”å¦‚ crate-type = [â€dylibâ€, â€staticlibâ€]ï¼Œè¡¨ç¤ºå¯ ä»¥åŒæ—¶ç¼–è¯‘ç”ŸæˆåŠ¨æ€åº“å’Œé™æ€åº“ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;src/lib.rs&quot; # è¡¨ç¤ºåº“æ–‡ä»¶å…¥å£ ï¼Œ å¦‚æœä¸æŒ‡å®šï¼Œ åˆ™é»˜è®¤æ˜¯ src/lib.rsã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">test=true # è¡¨ç¤ºå¯ä»¥ä½¿ç”¨å•å…ƒæµ‹è¯•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bench = true # è¡¨ç¤ºå¯ä»¥ä½¿ç”¨æ€§èƒ½åŸºå‡†æµ‹è¯•, è‹¥ä»£ç ä¸­æ²¡æœ‰æä¾›æ€§èƒ½åŸºå‡†æµ‹è¯•, åˆ™å¯è®¾ç½®ä¸º  false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åŒä¸­æ‹¬å· -&gt; æ•°ç»„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[test]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;tests/test_default.rs&quot; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;default&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[test]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;aa&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;tests/aa.rs&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½¿ç”¨æœ¬åœ°ä»“åº“ä¸­çš„ä»£ç build</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[patch.crates-io]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">uuid = { path = &quot;../path/to/uuid&quot; }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é»˜è®¤ master åˆ†æ”¯, # æ‰‹åŠ¨æŒ‡å®š commit id, ä¸è¿‡æœ‰äº† lock æ–‡ä»¶, å°±ä¸å¿…è¿™ä¹ˆå¹²äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">uuid = {git = &quot;https://github.com/uuid-rs/uuid.git&quot;,  rev = &quot;9f35b8e&quot;} </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å››ä¸ªå†…å»ºçš„ profile : dev, release, test, and bench, åœ¨å‘½ä»¤è¡Œé€šè¿‡ --release æŒ‡å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯¹æ¯ä¸ª profile è¿›è¡Œæ›´ç»†è‡´çš„é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ†åˆ«ä»£è¡¨å¯¹ Releaseã€ Bench å’Œ Test, debug å››ç§ ç¼–è¯‘æ¨¡å¼è¿›è¡Œé…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[profile.release]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">debug=true # ç¼–è¯‘æ—¶, åŒ…å« debug ä¿¡æ¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¼˜åŒ–çº§åˆ«</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">opt-level = 3 # ç¼–è¯‘ä¼˜åŒ–, è€—æ—¶æ›´é•¿</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[profile.bench]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">debug=true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[profile.test]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">debug=true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[profile.dev]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">opt-level = 0 # ä¼˜åŒ–çº§åˆ«, å‘½ä»¤è¡Œé€šè¿‡  -C opt-level=1 æŒ‡å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                # 0: no optimizations, also turns on cfg(debug_assertions) (the default).</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                # 1: basic optimizations.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                # 2: some optimizations.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                # 3: all optimizations.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                # s: optimize for binary size.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                # z: optimize for binary size, but also turn off loop vectorization.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">overflow-checks = false # Disable integer overflow checks</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">lto= # è¿æ¥æ—¶é—´ä¼˜åŒ–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="854-cargolock">8.5.4. cargo.lock<a href="#854-cargolock" class="hash-link" aria-label="8.5.4. cargo.lockçš„ç›´æ¥é“¾æ¥" title="8.5.4. cargo.lockçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>é”å®šä¾èµ–ç‰ˆæœ¬</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="855-workspace">8.5.5. workspace<a href="#855-workspace" class="hash-link" aria-label="8.5.5. workspaceçš„ç›´æ¥é“¾æ¥" title="8.5.5. workspaceçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å·¥ä½œç©ºé—´å¯ä»¥ç®¡ç†å¤šä¸ª proj å’Œ lib</p><p>æ–°å»º Cargo.toml ä½œä¸ºæ ¹åŒ…çš„å…ƒæ•°æ® (å·¥ä½œç©ºé—´ä¸­çš„å­åŒ… ä¹Ÿéƒ½æœ‰è‡ªå·±çš„ Cargo.toml é…ç½®ï¼Œå„è‡ªç‹¬ç«‹ï¼Œ äº’ä¸å½±å“)</p><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[workspace]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">members = [</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;main&quot;, # å¯æ‰§è¡Œ ä¸»ç¨‹åº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;core&quot;, # æ ¸å¿ƒç±»åº“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;util&quot;, # å·¥å…·åº“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä¸ç®¡æ˜¯ç¼–è¯‘æ ¹åŒ…è¿˜æ˜¯å­åŒ…ï¼Œæœ€ç»ˆçš„ç¼–è¯‘ç»“ æœæ°¸è¿œéƒ½ä¼šè¾“å‡ºåˆ°æ ¹åŒ…çš„ target ç›®å½•ä¸‹ï¼Œå¹¶ä¸”æ•´ä¸ªå·¥ä½œç©ºé—´åªå…è®¸æœ‰ä¸€ä¸ª Cargo.lock æ–‡ä»¶ã€‚</p><p><code>cargo new [--bin] main</code>, <code>cargo new --lib core</code>, <code>cargo new --lib util</code>; ç”±äºæ¯æ¬¡åˆ›å»ºæ—¶, cargo éƒ½ä¼šæ£€æŸ¥ é¡¶å±‚ Cargo é…ç½®æ–‡ä»¶ä¸­çš„ member æ˜¯å¦éƒ½å­˜åœ¨, æ‰€ä»¥ä¸­é—´å¯èƒ½æ£€æŸ¥å‡ºç°é”™è¯¯, ä¸å¿…æ‹…å¿ƒ, å…¨éƒ¨åˆ›å»ºå®Œé”™è¯¯å°±æ¶ˆå¤±äº†</p><p>lib ç±»å‹ç±»å‹éœ€è¦å°†æ–°å»ºçš„ module (å³rsæ–‡ä»¶) åœ¨ lib.rs ä¸­å£°æ˜ <code>pub mod xxx</code>, pub å¯é€‰</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="856-ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™">8.5.6. ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™<a href="#856-ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™" class="hash-link" aria-label="8.5.6. ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™çš„ç›´æ¥é“¾æ¥" title="8.5.6. ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// Rust åŒ…ä½¿ç”¨çš„æ˜¯è¯­ä¹‰åŒ–ç‰ˆæœ¬å· (SemVer)ã€‚åŸºæœ¬æ ¼å¼ä¸ºâ€œXå«Zâ€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ xï¼Œä¸»ç‰ˆæœ¬å· å½“åšäº†ä¸å…¼å®¹æˆ–é¢ è¦†æ€§çš„æ›´æ–°æ—¶ ï¼Œ ä¿®æ”¹æ­¤ç‰ˆæœ¬å·ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ yï¼Œ ;æ¬ ç‰ˆæœ¬å· (minor)ã€‚å½“åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§ä¿®æ”¹æ—¶ï¼Œä¿®æ”¹æ­¤ç‰ˆæœ¬å· ã€‚ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// â€¢ zï¼Œä¿®è®¢ç‰ˆæœ¬å· (patch)ã€‚å½“åšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£æ—¶ï¼Œä¿®æ”¹æ­¤ç‰ˆæœ¬å·ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç¬¦å·:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ^: ç‰ˆæœ¬å·å¿…é¡»å¤§äºæŒ‡å®šç‰ˆæœ¬, æ–°çš„ç‰ˆæœ¬å¿…é¡»æ»¡è¶³ä¸ä¿®æ”¹[major, minor, patch]ä¸­æœ€å·¦è¾¹éé›¶æ•°å­—ã€‚å¦‚æŒ‡å®š ^1.0.0, ç­‰ä»·äº &gt;=1.0.0 &lt;2.0.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// *: é€šé…ç¬¦, å¯ä»¥ç”¨åœ¨[major, minor,patch]çš„ä»»ä½•ä¸€ä¸ªä¸Šé¢ã€‚ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ~: å…è®¸ä¿®æ”¹[major, minor, patch]ä¸­æ²¡æœ‰æ˜ç¡®æŒ‡å®šçš„ç‰ˆæœ¬å·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ‰‹åŠ¨æŒ‡å®šï¼Œ é€šè¿‡ &gt;, &lt;, =, &gt;=, &lt;= æ¥æŒ‡å®šç‰ˆæœ¬å· ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="86-buildrs">8.6. build.rs<a href="#86-buildrs" class="hash-link" aria-label="8.6. build.rsçš„ç›´æ¥é“¾æ¥" title="8.6. build.rsçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>build.rså¯å®ç°æœ¬é¡¹ç›®ç¼–è¯‘å‰çš„é¢å¤–æ“ä½œï¼Œæ¯”å¦‚ä»£ç ç”Ÿæˆ(å¦‚ grpc)ã€è°ƒç”¨cmake/clang/gcc/ndk-buildç­‰ç¼–è¯‘æ‰€ä¾èµ–çš„C/C++åº“ã€è¯»å–C/C++å¤´æ–‡ä»¶ç”ŸæˆFFIæ–‡ä»¶ç»™Rusté¡¹ç›®ä½¿ç”¨ç­‰ç­‰ï¼Œç›¸å½“äºRustå†™çš„shellè„šæœ¬</p><p>å…ˆäº cargo build è¢«ç¼– è¯‘</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="87-é¡¹ç›®ç®¡ç†æ¡ˆä¾‹">8.7. é¡¹ç›®ç®¡ç†æ¡ˆä¾‹<a href="#87-é¡¹ç›®ç®¡ç†æ¡ˆä¾‹" class="hash-link" aria-label="8.7. é¡¹ç›®ç®¡ç†æ¡ˆä¾‹çš„ç›´æ¥é“¾æ¥" title="8.7. é¡¹ç›®ç®¡ç†æ¡ˆä¾‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="871-å¯¼å‡ºè‡ªå®šä¹‰å®">8.7.1. å¯¼å‡ºè‡ªå®šä¹‰å®<a href="#871-å¯¼å‡ºè‡ªå®šä¹‰å®" class="hash-link" aria-label="8.7.1. å¯¼å‡ºè‡ªå®šä¹‰å®çš„ç›´æ¥é“¾æ¥" title="8.7.1. å¯¼å‡ºè‡ªå®šä¹‰å®çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><code>cargo new --bin hello_macro</code>, æ–°å»º lib.rs (åå­—ä»»æ„), å®šä¹‰ macro, å¯¼å‡º</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#[macro_export]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">macro_rules! map {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç»Ÿè®¡ item ä¸ªæ•°æ—¶ä½¿ç”¨çš„å•ä½, è¿™é‡Œä½¿ç”¨ ç©ºå…ƒç»„, ä¸å ç©ºé—´</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // @unit æ˜¯çº¦å®šä¿—æˆçš„åœ¨å®å†…éƒ¨å®šä¹‰å®çš„å‘½åè§„åˆ™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å¿…é¡»å®šä¹‰åœ¨å¼€å¤´æ¡, å¦åˆ™å°±æŒ‰ç…§æ™®é€šåŒ¹é…åˆ†æ”¯å¤„ç†äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    (@unit $($x:tt)*) =&gt; {()};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    (@count $($key:expr),* ) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&lt;[()]&gt;::len(&amp;[$(map!(@unit $key)),*]));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ($($key:expr =&gt; $value:expr),* $(,)*) =&gt; (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let _cap = map!(@count $($key),*);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let mut _map = std::collections::HashMap::with_capacity(_cap);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           $(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">               _map.insert($key, $value);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           )*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           _map</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>åœ¨ main.rs ä¸­å¯¼å…¥ä½¿ç”¨</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// #[macro_use] extern crate hello_async; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use hello_macro::map;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let map = map!(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        1 =&gt; &quot;a&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        2 =&gt; &quot;b&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:?}&quot;, map);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯¼å‡ºåŒä¸ªåŒ…ä¸‹, å…¶ä»– mod å†…çš„å®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[macro_use]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mod macros {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     macro_rules! xxx {...}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     macro_rules! yy {..}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç›´æ¥ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    xxx!(...);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="872-å¯¼å…¥è‡ªå®šä¹‰-crate">8.7.2. å¯¼å…¥è‡ªå®šä¹‰ crate<a href="#872-å¯¼å…¥è‡ªå®šä¹‰-crate" class="hash-link" aria-label="8.7.2. å¯¼å…¥è‡ªå®šä¹‰ crateçš„ç›´æ¥é“¾æ¥" title="8.7.2. å¯¼å…¥è‡ªå®šä¹‰ crateçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><code>cargo new web-server</code></p><p><code>cd web-server</code></p><p><code>cargo new --lib thread-pool</code></p><p>ä¿®æ”¹ web-server çš„ cargo.toml:</p><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">thread-pool = {path = &quot;./thread-pool&quot; } # å¿…é¡»ä¸º thread-pool, å’Œåº“åä¸€è‡´; thread_pool é”™è¯¯, threadpoolé”™è¯¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                    # ä½¿ç”¨: use thread_pool::xxxx (å˜ä¸ºä¸‹åˆ’çº¿)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="873-æ‰§è¡Œå­ç›®å½•ä¸­çš„-module">8.7.3. æ‰§è¡Œå­ç›®å½•ä¸­çš„ module<a href="#873-æ‰§è¡Œå­ç›®å½•ä¸­çš„-module" class="hash-link" aria-label="8.7.3. æ‰§è¡Œå­ç›®å½•ä¸­çš„ moduleçš„ç›´æ¥é“¾æ¥" title="8.7.3. æ‰§è¡Œå­ç›®å½•ä¸­çš„ moduleçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[example]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;udp_server&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;examples/udp_server.rs&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[example]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;udp_client&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;examples/udp_client.rs&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[example]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;tcp_server&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;examples/tcp_server.rs&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[[example]]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name = &quot;tcp_client&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">path = &quot;examples/tcp_client.rs&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ç„¶ååœ¨ /examples ä¸‹æ–°å»º rs æ–‡ä»¶, å†™ main æ–¹æ³•å³å¯</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="874-å¯¼å…¥è‡ªå®šä¹‰-module">8.7.4. å¯¼å…¥è‡ªå®šä¹‰ module<a href="#874-å¯¼å…¥è‡ªå®šä¹‰-module" class="hash-link" aria-label="8.7.4. å¯¼å…¥è‡ªå®šä¹‰ moduleçš„ç›´æ¥é“¾æ¥" title="8.7.4. å¯¼å…¥è‡ªå®šä¹‰ moduleçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">//ferris_says  ä¸ºè‡ªå®šä¹‰ module</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">ferris_says</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ–¹æ³• 1: é€šè¿‡å£°æ˜å¯¼å…¥ module</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">ferris_says</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">say</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ–¹æ³• 2: å¯¼å…¥æ¨¡å—çš„æ–¹æ³•  // æ”¯æŒ as , å¦‚ use xxx as yyy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">io</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">BufWriter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> stdout </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> message </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hello fellow Rustaceans!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> width </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> message</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> writer </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">BufWriter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">lock</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">say</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> width</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> writer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="875-å¯¼å…¥ç¬¬ä¸‰æ–¹-crate">8.7.5. å¯¼å…¥ç¬¬ä¸‰æ–¹ crate<a href="#875-å¯¼å…¥ç¬¬ä¸‰æ–¹-crate" class="hash-link" aria-label="8.7.5. å¯¼å…¥ç¬¬ä¸‰æ–¹ crateçš„ç›´æ¥é“¾æ¥" title="8.7.5. å¯¼å…¥ç¬¬ä¸‰æ–¹ crateçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// Rust 2015 ç‰ˆæœ¬çš„å†™æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// åœ¨ Rust2018 ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥çœç•¥æ‰ extern erate, å› ä¸ºåœ¨ Cargo.toml ä¸­å·²ç»æ·»åŠ äº†ä¾èµ– </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// extern crate å£°æ˜åŒ…çš„åç§° æ˜¯ linked_listï¼Œ ç”¨çš„æ˜¯ä¸‹ç”»çº¿â€œ_â€ï¼Œ è€Œåœ¨ Cargo.tom! ä¸­ç”¨çš„æ˜¯è¿å­—ç¬¦&quot;-&quot;ã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢?å…¶å® Cargo é»˜è®¤ä¼šæŠŠè¿å­—ç¬¦è½¬æ¢æˆ ä¸‹ç”»çº¿ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">extern crate linked_listï¼Œ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>9. å•å…ƒæµ‹è¯•</h1><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// å•å…ƒæµ‹è¯•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// ä½¿ç”¨ cargo test è¿è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// è¿è¡ŒæŸä¸ªç‰¹å®šçš„æµ‹è¯•æ–¹æ³• cargo test test_any_panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// cargo test panic æ–¹æ³•åä¸­å«æœ‰ panic çš„æµ‹è¯•æ–¹æ³•ä¼šè¿è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[cfg(test)]</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¡ä»¶ç¼–è¯‘ ï¼Œ å‘Šè¯‰ç¼–è¯‘å™¨åªåœ¨è¿è¡Œæµ‹è¯•( cargo test å‘½ä»¤)æ—¶æ‰ç¼–è¯‘æ‰§è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">tests</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ³¨æ„è¿™ä¸ªæƒ¯ç”¨æ³•ï¼šåœ¨ tests æ¨¡å—ä¸­ï¼Œä»å¤–éƒ¨ä½œç”¨åŸŸå¯¼å…¥æ‰€æœ‰åå­—ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">super</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[test]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">test_xx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello unit test&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æµ‹è¯• panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[test]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[ignore]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¿½ç•¥æµ‹è¯•, æˆ–è€…ä½¿ç”¨ cargo test -- --ignored å‘½ä»¤æ¥è¿è¡Œå®ƒä»¬ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[should_panic(expected = </span><span class="token attribute attr-name string" style="color:rgb(163, 21, 21)">&quot;assertion failed&quot;</span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">)]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å€’ç½®æˆ‘ä»¬çš„æµ‹è¯•ç»“æœ (å¦‚æœå‘ç”Ÿé”™è¯¯æµ‹è¯•å°†ä¼šæˆåŠŸå¹¶ä¸”å¦‚æœæ²¡æœ‰é”™è¯¯ä¼šå¤±è´¥), ä¸€èˆ¬ å’Œ `(expected = &quot;assertion failed&quot;)` ä¸€èµ·ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">test_any_panic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">divide_non_zero_result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æµ‹è¯• å¸¦æœ‰è¾“å‡ºæ–‡æœ¬çš„panic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[test]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[should_panic(expected = </span><span class="token attribute attr-name string" style="color:rgb(163, 21, 21)">&quot;Divide result is zero&quot;</span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">test_specific_panic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">divide_non_zero_result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>10. äº¤å‰ç¼–è¯‘ and æ¡ä»¶ç¼–è¯‘</h1><p><a href="https://github.com/japaric/rust-cross#tldr-ubuntu-example" target="_blank" rel="noopener noreferrer">https://github.com/japaric/rust-cross#tldr-ubuntu-example</a>
<a href="https://zhuanlan.zhihu.com/p/76611800" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/76611800</a>
<a href="https://zhuanlan.zhihu.com/p/128626720" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/128626720</a></p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">///æ¡ä»¶ç¼–è¯‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// cfg å±æ€§ï¼šåœ¨å±æ€§ä½ç½®ä¸­ä½¿ç”¨ #[cfg(...)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">///cfg! å®ï¼šåœ¨å¸ƒå°”è¡¨è¾¾å¼ä¸­ä½¿ç”¨ cfg!(...)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">condition_compile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¿™ä¸ªå‡½æ•°ä»…å½“ç›®æ ‡ç³»ç»Ÿæ˜¯ Linux çš„æ—¶å€™æ‰ä¼šç¼–è¯‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[cfg(target_os = </span><span class="token attribute attr-name string" style="color:rgb(163, 21, 21)">&quot;linux&quot;</span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">are_you_on_linux</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;You are running linux!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è€Œè¿™ä¸ªå‡½æ•°ä»…å½“ç›®æ ‡ç³»ç»Ÿ **ä¸æ˜¯** Linux æ—¶æ‰ä¼šç¼–è¯‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[cfg(not(target_os = </span><span class="token attribute attr-name string" style="color:rgb(163, 21, 21)">&quot;linux&quot;</span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">))]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">are_you_on_linux</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;You are *not* running linux!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">are_you_on_linux</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token macro property">cfg!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">target_os </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;linux&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Yes. It&#x27;s definitely linux!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Yes. It&#x27;s definitely *not* linux!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‡ªå®šä¹‰æ¡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `rustc --cfg some_condition custom.rs &amp;&amp; ./custom`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// #[cfg(some_condition)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// fn conditional_function() {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//     println!(&quot;condition met!&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// conditional_function();</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>11. å¹¶å‘</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="111-é€šç”¨æ¦‚å¿µ">11.1. é€šç”¨æ¦‚å¿µ<a href="#111-é€šç”¨æ¦‚å¿µ" class="hash-link" aria-label="11.1. é€šç”¨æ¦‚å¿µçš„ç›´æ¥é“¾æ¥" title="11.1. é€šç”¨æ¦‚å¿µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1111-è¿›ç¨‹-and-çº¿ç¨‹">11.1.1. è¿›ç¨‹ and çº¿ç¨‹<a href="#1111-è¿›ç¨‹-and-çº¿ç¨‹" class="hash-link" aria-label="11.1.1. è¿›ç¨‹ and çº¿ç¨‹çš„ç›´æ¥é“¾æ¥" title="11.1.1. è¿›ç¨‹ and çº¿ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•å…ƒï¼Œçº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œæ—¶çš„æœ€å°å•å…ƒ </p><p>å¯ä»¥ä½¿ç”¨å¤šè¿›ç¨‹æ¥æä¾›å¹¶å‘ï¼Œæ¯”å¦‚ Master-Worker æ¨¡å¼ï¼Œç”± Master è¿›ç¨‹æ¥ç®¡ç† Worker å­è¿›ç¨‹ï¼Œ Worker å­è¿›ç¨‹æ‰§è¡Œä»»åŠ¡ ã€‚ Master å’Œ Worker ä¹‹é—´é€šå¸¸ä½¿ç”¨ Socket æ¥è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡å¥½å¤„æ˜¯ç¨‹åºå¥å£®, ç¼ºç‚¹æ˜¯è€—è´¹èµ„æº</p><p>ä½¿ç”¨çº¿ç¨‹æä¾›å¹¶å‘, å ç”¨èµ„æºå°‘, ä½†æ˜¯ç¼–ç¨‹è°ƒè¯•ç›¸å½“å¤æ‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1112-äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘">11.1.2. äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘<a href="#1112-äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘" class="hash-link" aria-label="11.1.2. äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘çš„ç›´æ¥é“¾æ¥" title="11.1.2. äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><blockquote><p>å¤šè¿›ç¨‹/çº¿ç¨‹ å®ç°çš„å¹¶å‘, è¿˜æ˜¯æ— æ³•æ”¯æ’‘ä¸‡çº§åˆ«çš„å¹¶å‘è®¿é—®, å› ä¸ºå°±ç®—ä¸€ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªè¿æ¥, ä¹Ÿè¦ä¸Šä¸‡çº¿ç¨‹, è¿™æ—¶å€™æœåŠ¡å™¨ä¹Ÿå´©äº†</p></blockquote><p>äº‹ä»¶é©±åŠ¨å®ç°å¹¶å‘: åªæœ‰ä¸€ä¸ªçº¿ç¨‹, ä¸æ–­ä»äº‹ä»¶é˜Ÿåˆ—ä¸­æŸ¥è¯¢æ˜¯å¦æœ‰äº‹ä»¶å‘ç”Ÿ, è‹¥æœ‰, åˆ™è°ƒç”¨å…³è”çš„å›è°ƒå‡½æ•°, æ•´ä¸ªè¿‡ç¨‹æ˜¯éé˜»å¡çš„</p><ol><li><p>ä¸ºäº†è§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜, æ–°çš„æ–¹æ¡ˆå‡ºç°äº† --&gt; Promise, Future, promise ç«™åœ¨ä»»åŠ¡å¤„ç†è€…çš„è§’åº¦ï¼Œå°†å¼‚æ­¥ä»»åŠ¡å®Œæˆæˆ–å¤±è´¥çš„ çŠ¶æ€æ ‡è®°åˆ° Promise å¯¹è±¡ä¸­ ã€‚ Future åˆ™ç«™åœ¨ä»»åŠ¡è°ƒç”¨è€…çš„è§’åº¦ï¼Œæ¥æ£€æµ‹ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œå¦‚æœ å®Œæˆåˆ™ç›´æ¥è·å–ç»“æœï¼Œå¦‚æœæœªå®Œæˆåˆ™é˜»å¡ç›´åˆ°è·å–åˆ°ç»“æœ ï¼Œ æˆ–è€…ç¼–å†™å›è°ƒå‡½æ•°é¿å…é˜»å¡</p></li><li><p>ä¸ºäº†è¿›ä¸€æ­¥è§£å†³ä»£ç å†—ä½™ ---&gt; åç¨‹: æè¿°äº†ä¸€ç§ä»»åŠ¡ååŒæ‰§è¡Œçš„æ–¹å¼, åªæœ‰ä¸€ä¸ªçº¿ç¨‹, åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡, ä¸€ä¸ªæ—¶é—´ç‰‡åœ¨æ‰§è¡Œä»»åŠ¡ 1, æŸä¸ªæ—¶é—´ç‰‡åˆåˆ‡åˆ°æ‰§è¡Œä»»åŠ¡ 2, çœ‹èµ·æ¥å°±å¥½åƒä»»åŠ¡ 1,2 åŒæ—¶åœ¨æ‰§è¡Œ (æ•´ä¸ªæ¦‚å¿µç±»ä¼¼ CPU å¯¹çº¿ç¨‹çš„è°ƒåº¦æ–¹å¼)</p><p>æ€»çš„æ¥è¯´ï¼Œåç¨‹å¯ä»¥è®©å¼€å‘è€…ç”¨å†™åŒæ­¥(é¡ºåº)ä»£ç çš„æ–¹ å¼ç¼–å†™å¯å¼‚æ­¥æ‰§è¡Œçš„ä»£ç  </p><p>åç¨‹æ˜¯ä»¥çº¿ç¨‹ä¸ºå®¹å™¨çš„ï¼Œ åç¨‹çš„ç‰¹ç‚¹æ˜¯å†…å­˜å ç”¨æ¯”çº¿ç¨‹æ›´å°ã€ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€æ›´å°, ä¹Ÿè¢«ç§°ä¸ºç”¨æˆ· æ€çº¿ç¨‹ï¼Œæ‰€ä»¥å¯å¤§é‡ä½¿ç”¨</p><p>è™½ç„¶å……åˆ†æŒ–æ˜äº†å•çº¿ç¨‹çš„åˆ©ç”¨ç‡ï¼Œåœ¨ å•çº¿ç¨‹ä¸‹å¯ä»¥å¤„ç†é«˜å¹¶å‘ioï¼Œä½†å´æ— æ³•åˆ©ç”¨å¤šæ ¸, å› ä¸ºå§‹ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚</p></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="112-çº¿ç¨‹åŸºæœ¬ä½¿ç”¨">11.2. çº¿ç¨‹åŸºæœ¬ä½¿ç”¨<a href="#112-çº¿ç¨‹åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="11.2. çº¿ç¨‹åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="11.2. çº¿ç¨‹åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1121-åˆ›å»ºçº¿ç¨‹">11.2.1. åˆ›å»ºçº¿ç¨‹<a href="#1121-åˆ›å»ºçº¿ç¨‹" class="hash-link" aria-label="11.2.1. åˆ›å»ºçº¿ç¨‹çš„ç›´æ¥é“¾æ¥" title="11.2.1. åˆ›å»ºçº¿ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/// å¹¶å‘ é—­åŒ…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// Rust ä¸­é€šè¿‡ std::thread::spawn å‡½æ•°åˆ›å»ºæœ¬åœ°æ“ä½œç³»ç»Ÿï¼ˆnative OSï¼‰çº¿ç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// spawn() è¿”å›æ–°çº¿ç¨‹çš„å¥æŸ„ï¼ˆhandleï¼‰ï¼Œæˆ‘ä»¬å¿…é¡»æ‹¥æœ‰å¥æŸ„ï¼Œæ‰èƒ½è·å–çº¿ç¨‹çš„è¿”å›å€¼, é€šè¿‡ handle.join().unwrap();</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">concurrent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">thread</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">time</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ™®é€šå‡½æ•°çš„å†™æ³•, ä¸æ¨èå†™æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">spawn_function</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;spawned thread print {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">sleep</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_millis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">spawn_function</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é—­åŒ…çš„å†™æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;spawned thread print {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">sleep</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_millis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ç¡çœ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰å¾…çº¿ç¨‹ç»“æŸ or è·å–è¿”å›å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//move å¼ºåˆ¶æ‰€æœ‰æƒè¿ç§»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//åœ¨å­çº¿ç¨‹ä¸­å°è¯•ä½¿ç”¨å½“å‰å‡½æ•°çš„èµ„æº, è¿™ä¸€å®šæ˜¯é”™è¯¯çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// éœ€è¦ä½¿ç”¨ move, å°†èµ„æºæ‰€æœ‰æƒç§»åŠ¨åˆ°å­çº¿ç¨‹å†…éƒ¨ä½¿å¾—å¤–éƒ¨èµ„æºå¤±æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// let s = &quot;hello&quot;; // è‹¥æ˜¯ &amp;str ç±»å‹, åˆ™ move æ‰§è¡Œçš„æ˜¯ copy, é—­åŒ…å¤–å±‚ s è¿˜æ˜¯æœ‰æ•ˆçš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_owned</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// è‹¥ä¸º String, åˆ™ move æ‰§è¡Œ ç§»åŠ¨è¯­ä¹‰, s å¤±æ•ˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> handle </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸€å®šè¦åŠ  move</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sub thread, s = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é”™è¯¯, så·²ç» å¤±æ•ˆäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;main thread, s= {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    handle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1122-è‡ªå®šä¹‰é…ç½®çº¿ç¨‹">11.2.2. è‡ªå®šä¹‰é…ç½®çº¿ç¨‹<a href="#1122-è‡ªå®šä¹‰é…ç½®çº¿ç¨‹" class="hash-link" aria-label="11.2.2. è‡ªå®šä¹‰é…ç½®çº¿ç¨‹çš„ç›´æ¥é“¾æ¥" title="11.2.2. è‡ªå®šä¹‰é…ç½®çº¿ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// è®¾ç½®çº¿ç¨‹æ ˆ, çº¿ç¨‹å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> // ç›´æ¥ä½¿ç”¨ thread::spawnç”Ÿæˆçš„çº¿ç¨‹ï¼Œ é»˜è®¤æ²¡æœ‰åç§°ï¼Œ å¹¶ä¸”å…¶æ ˆå¤§å°é»˜è®¤ä¸º 2MB (å…¶å®åº•å±‚è¿˜æ˜¯é€šè¿‡ builder åˆ›å»ºçš„)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä½¿ç”¨ thread::Builder ç»“æ„ä½“æ¥åˆ›å»ºå¯é…ç½®çš„çº¿ ç¨‹, ä¸»çº¿ç¨‹æ— æ³•é…ç½®, å’Œ rust æ— å…³, å› ä¸ºä¸»çº¿ç¨‹é»˜è®¤ä½¿ç”¨ è¿›ç¨‹çš„æ ˆ, ç”±æ“ä½œç³»ç»Ÿå†³å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šç¯å¢ƒå˜ é‡ RUST_MIN_STACK  è®¾ç½®æ–°åˆ›å»ºçš„çº¿ç¨‹çš„çº¿ç¨‹æ ˆ, ä¼šè¢« builder è¦†ç›–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{panic::catch_unwind, thread::{Builder, current}};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut ths = vec![];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for id in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let thread_builder = Builder::new()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            .name(format!(&quot;child-{}&quot;, id))</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // unit: byte</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            .stack_size(3 * 1024);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let child = thread_builder.spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;child id = {}&quot;, id);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if id == 2 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                // panic!(&quot;panic.&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                catch_unwind(|| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    panic!(&quot;panic.&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                }).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                println!(&quot;catch panic in {}&quot;, current().name().unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ths.push(child);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for t in ths {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        t.join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1123-çº¿ç¨‹æœ¬åœ°å˜é‡">11.2.3. çº¿ç¨‹æœ¬åœ°å˜é‡<a href="#1123-çº¿ç¨‹æœ¬åœ°å˜é‡" class="hash-link" aria-label="11.2.3. çº¿ç¨‹æœ¬åœ°å˜é‡çš„ç›´æ¥é“¾æ¥" title="11.2.3. çº¿ç¨‹æœ¬åœ°å˜é‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// çº¿ç¨‹æœ¬åœ°å˜é‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::cell::RefCell;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    thread_local!(static FOO: RefCell&lt;u32&gt; = RefCell::new(1));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    FOO.with(|f| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert_eq!(*f.borrow(), 1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        *f.borrow_mut() = 2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    thread::spawn(|| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       FOO.with(|f| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           assert_eq!(*f.borrow(), 1);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           *f.borrow_mut() = 3;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   FOO.with(|f| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!(*f.borrow(), 2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1124-æ‰‹åŠ¨é˜»å¡å”¤é†’">11.2.4. æ‰‹åŠ¨é˜»å¡å”¤é†’<a href="#1124-æ‰‹åŠ¨é˜»å¡å”¤é†’" class="hash-link" aria-label="11.2.4. æ‰‹åŠ¨é˜»å¡å”¤é†’çš„ç›´æ¥é“¾æ¥" title="11.2.4. æ‰‹åŠ¨é˜»å¡å”¤é†’çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::time::Duration;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let parked_thread = thread::Builder::new()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .spawn(|| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;Parking thread&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // é˜»å¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // ä¹Ÿå¯ä»¥ é€šè¿‡ std::thread: :park_timeout æ¥æ˜¾ å¼æŒ‡å®šé˜»å¡è¶…æ—¶æ—¶é—´ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            thread::park();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;Thread unparked&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   thread::sleep(Duration::from_millis(10));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   println!(&quot;Unpark the thread&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    å”¤é†’</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   parked_thread.thread().unpark();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   parked_thread.join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ­¤å¤–, è¿˜æœ‰ yield_now() è°¦è®©, è®©å‡º cpu æ§åˆ¶æƒ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="113-çº¿ç¨‹åŒæ­¥">11.3. çº¿ç¨‹åŒæ­¥<a href="#113-çº¿ç¨‹åŒæ­¥" class="hash-link" aria-label="11.3. çº¿ç¨‹åŒæ­¥çš„ç›´æ¥é“¾æ¥" title="11.3. çº¿ç¨‹åŒæ­¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1131-é”™è¯¯ç¤ºä¾‹">11.3.1. é”™è¯¯ç¤ºä¾‹<a href="#1131-é”™è¯¯ç¤ºä¾‹" class="hash-link" aria-label="11.3.1. é”™è¯¯ç¤ºä¾‹çš„ç›´æ¥é“¾æ¥" title="11.3.1. é”™è¯¯ç¤ºä¾‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åœ¨çº¿ç¨‹é—´ä¼ é€’å¯å˜å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç›´æ¥ä½¿ç”¨ String</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::thread::spawn;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s = String::from(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _i in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s.push_str(&quot;xxx&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½¿ç”¨ Rc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{rc::Rc, thread::spawn};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æƒ³åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å…±äº«sï¼Œåˆ™éœ€è¦ä½¿ç”¨ã€‚ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // Rcå®ç°äº†!Send, ä¸å¯åœ¨çº¿ç¨‹é—´ä¼ é€’æ‰€æœ‰æƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut s = Rc::new(String::from(&quot;hello&quot;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _i in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut s_clone = s.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // spawn å‡½æ•°ä¼ å…¥çš„ é—­åŒ…æ²¡æœ‰å®ç° Sendï¼Œè¿™æ˜¯å› ä¸ºæ•è·å˜é‡æ²¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // æœ‰å®ç° Sendã€‚æ•è·å˜é‡æ˜¯ Rc&lt;String&gt;ç±»å‹ï¼Œ å®ç°çš„æ˜¯!Sendï¼Œæ­£å¥½å’Œ Sendç›¸å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s_clone.push_str(&quot;xxx&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½¿ç”¨å¯ä»¥åœ¨å¤šçº¿ç¨‹é—´è¢«ç§»åŠ¨å’Œå…±äº«çš„ Arc&lt;T&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{sync::Arc, thread::spawn};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s = Arc::new(String::from(&quot;hello&quot;));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _i in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let s_clone = s.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // è¿™æ˜¯å› ä¸º Arc&lt;T&gt;é»˜è®¤æ˜¯ä¸å¯å˜çš„, è€ƒè™‘ä½¿ç”¨å…·æœ‰å†…éƒ¨å¯å˜æ€§çš„ç±»å‹, å¦‚ Cell/RefCell</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s_clone.push_str(&quot;xxx&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½¿ç”¨ RefCell æä¾›å†…éƒ¨å¯å˜æ€§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{cell::RefCell, sync::Arc, thread::spawn};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s = Arc::new(RefCell::new(String::from(&quot;hello&quot;)));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _i in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let s_clone = s.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // `RefCell&lt;String&gt;` cannot be shared between threads safely</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let s_clone = s_clone.borrow_mut();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s_clone.push_str(&quot;xxx&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ­£ç¡®æ–¹å¼: ä½¿ç”¨ Mutex</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{sync::{Arc, Mutex}, thread::spawn};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // Arc ç”¨äºæ”¯æŒå®‰å…¨çš„å¤šå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // Mutex ç”¨äºå®‰å…¨çš„æä¾›å†…éƒ¨å¯å˜æ€§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let s = Arc::new(Mutex::new(String::from(&quot;hello&quot;)));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut ths = vec![];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _i in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let s_ref = s.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let child = spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let mut s_ref_mut = s_ref.lock().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            s_ref_mut.push_str(&quot; xxx&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ths.push(child);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for t in ths {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        t.join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1132-é”">11.3.2. é”<a href="#1132-é”" class="hash-link" aria-label="11.3.2. é”çš„ç›´æ¥é“¾æ¥" title="11.3.2. é”çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// Mutex&lt;T&gt; äº’æ–¥é”: æ”¯æŒè·¨çº¿ç¨‹å®‰å…¨å…±äº«å¯å˜å˜é‡çš„å®¹å™¨, åŒæ—¶åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®å†…éƒ¨ å¯å˜æ•°æ®, ç±»ä¼¼ çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬çš„ RefCell</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// - lock() è¿”å›å†…éƒ¨æ•°æ®çš„å¯å˜å¼•ç”¨(é˜»å¡å½“å‰çº¿ç¨‹, ç›´åˆ°æ‹¿åˆ°é”)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      è¿”å›å€¼ LockResult&lt;MutexGuard&lt;T&gt;&gt;, è¶…å‡ºä½œç”¨åŸŸä¼šè‡ªåŠ¨é‡Šæ”¾é”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - try_lock() è·å– é”çš„æ—¶å€™ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹, å¦‚æœå¾—åˆ°é” ï¼Œ å°±è¿”å› MutexGuard&lt;T&gt;; å¦‚æœå¾—ä¸åˆ°é”ï¼Œå°±è¿”å› Errã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// RefCell&lt;T&gt;: ä½¿å¾—å†…éƒ¨æ•°æ®å¯å˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  Rc&lt;T&gt;: åŸå­å¼•ç”¨è®¡æ•° , å…è®¸å¤šå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  Arc&lt;T&gt; : çº¿ç¨‹å®‰å…¨çš„ Rc&lt;T&gt;, å…è®¸å¤šçº¿ç¨‹ä¸‹çš„å¤šå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// Mutex&lt;T&gt; : çº¿ç¨‹å®‰å…¨çš„ RefCell, æä¾›å¤šçº¿ç¨‹ä¸‹å†…éƒ¨æ•°æ®çš„å¯å˜å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// é€šé“éƒ½ç±»ä¼¼äºå•æ‰€æœ‰æƒï¼Œå› ä¸ºä¸€æ—¦å°†ä¸€ä¸ªå€¼ä¼ é€åˆ°é€šé“ä¸­ï¼Œå°†æ— æ³•å†ä½¿ç”¨è¿™ä¸ªå€¼ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/// é”ç±»ä¼¼äºå¤šæ‰€æœ‰æƒ: å¤šä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®ç›¸åŒçš„å†…å­˜ä½ç½® , åªæ˜¯ä¸èƒ½åŒä¸€æ—¶å€™è®¿é—®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn lock_demo() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è®¡æ•°å™¨ç¤ºä¾‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    use std::sync::{Mutex, Arc};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä¸èƒ½ä»…ä»…ä½¿ç”¨ Mutex::new(0), å› ä¸ºæœ‰å¤šä¸ª Threadéœ€è¦å®ƒ, counterç§»åŠ¨è¿›å…¥æŸä¸ªThreadåå…¶ä»–Threadå°±æ²¡æ³•æ‹¥æœ‰counteräº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä¹Ÿä¸èƒ½ç”¨Rc::new(Mutex::new(0)), å› ä¸ºRc&lt;T&gt;çš„å¼•ç”¨è®¡æ•°, åœ¨å¤šçº¿ç¨‹ä¸‹ä¸å®‰å…¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let counter = Arc::new(Mutex::new(0));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut handles = vec![];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _ in 0..10 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let counter = Arc::clone(&amp;counter);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let counter = counter.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let handle = thread::spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // lock() è¿™ä¸ªè°ƒç”¨ä¼šé˜»å¡å½“å‰çº¿ç¨‹, ç›´åˆ°è·å–é”ä¸ºæ­¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //å¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰é”ï¼Œå¹¶ä¸”é‚£ä¸ªçº¿ç¨‹ panic äº†ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // åˆ™æœ¬çº¿ç¨‹ lock è°ƒç”¨ä¼šå¤±è´¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ²¡äººèƒ½å¤Ÿå†è·å–é”ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // æ‰€ä»¥è¿™é‡Œé€‰æ‹© unwrap åœ¨é‡åˆ°è¿™ç§æƒ…å†µæ—¶ä½¿çº¿ç¨‹ç›´æ¥ panic</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //è¿”å› result, æ‹†åŒ…åæ˜¯ MutexGuard&lt;T&gt;, æ˜¯ä¸ªæ™ºèƒ½æŒ‡é’ˆ, å®ç°äº† Derefæ‰€ä»¥å¯ä»¥è§£å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // å®ç°äº† Drop ,å½“ MutexGuard ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾é”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            let mut num = counter.lock().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // è§£å¼•ç”¨å, æ•°æ®æ˜¯å¯å˜çš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            *num += 1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        handles.push(handle);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for handle in handles {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        handle.join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;Result: {}&quot;, *counter.lock().unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä¸­æ¯’: çº¿ç¨‹åœ¨è·å¾—é”ä¹‹åå‘ç”Ÿææ…Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mutex = Arc::new(Mutex::new(1));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let c_mutex = mutex.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let _ = thread::spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut data = c_mutex.lock().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        *data = 2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // å­çº¿ç¨‹ panic, ä¸­æ¯’äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        panic!(&quot;oh no&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }).join();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    æ˜¯å¦ä¸­æ¯’, å³æŸ¥çœ‹è·å–é”çš„å­çº¿ç¨‹æ˜¯å¦ panic</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   assert_eq!(mutex.is_poisoned(), true);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    ä¸»çº¿ç¨‹è·å–é”, å½“ç„¶è·å–ä¸åˆ°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   match mutex.lock() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //    ä¸å¯è¾¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       Ok(_) =&gt; unreachable!(),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       Err(p_err) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //    æä¾›äº† get_refæˆ– get_mutæ–¹æ³•, è·å–é”å†…éƒ¨çš„æ•°æ®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           let data = p_err.get_ref();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           println!(&quot;recovered: {}&quot;, data);//2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯»å†™é”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // RwLock&lt;T&gt; æ”¯æŒå¤šä¸ªè¯»çº¿ç¨‹å’Œä¸€ä¸ªå†™çº¿ç¨‹åŒæ—¶è®¿é—® (ä¸åƒ Mutex&lt;T&gt;åªèƒ½çº¿ç¨‹ç‹¬å è®¿é—®)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åªè¦çº¿ç¨‹æ²¡æœ‰æ‹¿åˆ°å†™é” ï¼Œ RwLock&lt;T&gt;å°± å…è®¸ä»»æ„æ•°é‡ çš„è¯»çº¿ç¨‹è·å¾—è¯»é”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let lock = RwLock::new(5);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¯»é”å’Œ å†™é”è¦ä½¿ç”¨æ˜¾å¼ä½œç”¨åŸŸå—éš”ç¦»å¼€ ï¼Œè¿™æ ·çš„è¯ ï¼Œ è¯»é”æˆ–å†™é”æ‰èƒ½åœ¨ç¦»å¼€ä½œç”¨ åŸŸä¹‹åè‡ª åŠ¨é‡Šæ”¾ ; å¦åˆ™ä¼šå¼•èµ·æ­»é”ï¼Œå› ä¸ºè¯»é”å’Œå†™é”ä¸èƒ½åŒæ—¶å­˜åœ¨ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // è·å–å¤šä¸ªè¯»é”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let r1 = lock.read().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let r2 = lock.read().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert_eq!(*r1, 5);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert_eq!(*r2, 5);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    //    è·å–å†™é”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       let mut w = lock.write().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       *w += 1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       assert_eq!(*w, 6);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å±éšœ (ç±»ä¼¼ java çš„ CountDownLatch)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::sync::{Arc, Barrier};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut handles = Vec::with_capacity(5);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let barrier = Arc::new(Barrier::new(5));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _ in 0..5 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let c = barrier.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        handles.push(thread::spawn(move|| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;before wait&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // ä½¿å¾—å½“å‰å­çº¿ç¨‹é˜»å¡, çŸ¥é“ clone 5 æ¬¡å barrie å½’é›¶å, çº¿ç¨‹æ¢å¤æ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           c.wait();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           println!(&quot;after wait&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   for handle in handles {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       handle.join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ¡ä»¶å˜é‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ»¡è¶³æŒ‡å®šæ¡ä»¶ä¹‹å‰é˜»å¡æŸä¸€ä¸ªå¾—åˆ°äº’æ–¥é”çš„çº¿ç¨‹ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ¡ä»¶å˜é‡éœ€è¦é…åˆäº’æ–¥é”æ‰èƒ½ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - æ¯ä¸ªæ¡ä»¶å˜é‡æ¯æ¬¡åªèƒ½å’Œä¸€ä¸ªäº’æ–¥ä½“ä¸€èµ·ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - ä½¿ç”¨åœºæ™¯: å½“çŠ¶æ€æˆç«‹æ—¶é€šçŸ¥äº’æ–¥ä½“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::sync::{Arc, Condvar, Mutex};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let pair = Arc::new((Mutex::new(false), Condvar::new()));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let pair_clone = pair.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    thread::spawn(move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let &amp;(ref lock, ref cvar) = &amp;*pair_clone;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut started = lock.lock().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä¿®æ”¹é”å†…éƒ¨æ•°æ®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        *started = true;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // é€šçŸ¥ä¸»çº¿ç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       cvar.notify_one();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let &amp;(ref lock, ref cvar) = &amp;*pair;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let mut started = lock.lock().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   while !*started {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       println!(&quot;{}&quot;, started); // false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //é˜»å¡å½“å‰çº¿ç¨‹(ä¸»çº¿ç¨‹), ç›´åˆ°æ”¶åˆ°æ¡ä»¶å˜é‡çš„é€šçŸ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       started = cvar.wait(started).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       println!(&quot;{}&quot;, started); // true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1133-åŸå­ç±»å‹">11.3.3. åŸå­ç±»å‹<a href="#1133-åŸå­ç±»å‹" class="hash-link" aria-label="11.3.3. åŸå­ç±»å‹çš„ç›´æ¥é“¾æ¥" title="11.3.3. åŸå­ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// AtomicBoolã€ AtomicIsizeã€ AtomicPtr å’Œ AtomicUsize</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ç°è‡ªæ—‹é”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::sync::Arc;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::sync::atomic::{AtomicUsize, Ordering};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // åˆå§‹å€¼è®¾ç½®ä¸º 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let spinlock = Arc::new(AtomicUsize::new(1));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let spinlock_clone = spinlock.clone();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let thread = thread::spawn(move|| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä¿®æ”¹ä¸º 0;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // åŒæ—¶æŒ‡å®šå†…å­˜é¡ºåº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        spinlock_clone.store(0, Ordering::SeqCst);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è‹¥ä¸ä¸º 0, åˆ™è‡ªæ—‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   while spinlock.load(Ordering::SeqCst) != 0 {}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//    é˜»å¡ä¸»çº¿ç¨‹, ç­‰å¾…å­çº¿ç¨‹å®Œæˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   if let Err(panic) = thread.join() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       println!(&quot;Thread had an error: {:?}&quot;, panic);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1134-channel">11.3.4. channel<a href="#1134-channel" class="hash-link" aria-label="11.3.4. channelçš„ç›´æ¥é“¾æ¥" title="11.3.4. channelçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// channel æ¶ˆæ¯ä¼ é€’</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/// å…·ä½“å®ç°å®é™…ä¸Šæ˜¯ä¸€ä¸ª å¤šç”Ÿäº§è€…å•æ¶ˆè´¹è€… (Multi-Producer-Single-Consumer, MPSC) çš„å…ˆè¿›å…ˆå‡º(FIFOã€• é˜Ÿåˆ—, åº•å±‚åŸºäºé“¾è¡¨å®ç°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸‰ç§ç±»å‹çš„csp è¿›ç¨‹:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - Sender ç”¨äºå‘é€å¼‚æ­¥æ¶ˆæ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - SyncSender å‘é€åŒæ­¥æ¶ˆæ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - Receiveræ¥æ”¶æ¶ˆæ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸¤ç§ç±»å‹çš„ channel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - å¼‚æ­¥æ— ç•Œ Channel -  let (sender, receiver):  (Sender, Receiver) = channel(); å‘é€æ¶ˆæ¯æ˜¯å¼‚æ­¥æ— é˜»å¡çš„, ç¼“å†²åŒºæ— é™å¤§</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// - åŒæ­¥æœ‰ç•Œ Channel -  let (sender, receiver):  (SyncSender, Receiver) = sync_channel(size);å¯ä»¥é¢„åˆ†é…å…·æœ‰å›ºå®šå¤§å°çš„ç¼“å†²åŒº , æ»¡äº†å°±é˜»å¡æ¶ˆæ¯å‘é€, è‹¥ç¼“å†²åŒº == 0, senderå’Œ receiver é—´å˜ä¸ºåŸå­æ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">channel_demo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¸€ä¸ªå‘é€è€…ï¼ˆtransmitterï¼‰å’Œä¸€ä¸ªæ¥æ”¶è€…ï¼ˆreceiverï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">sync</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">mpsc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// mpsc æ˜¯ å¤šä¸ªç”Ÿäº§è€…ï¼Œå•ä¸ªæ¶ˆè´¹è€…ï¼ˆmultiple producer, single consumerï¼‰çš„ç¼©å†™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">thread</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// tx: å‘é€è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// rx : æ¥æ”¶è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ­¤æ—¶è¿˜æ— æ³•ç¼–è¯‘, å› ä¸º Rust ä¸çŸ¥é“æˆ‘ä»¬æƒ³è¦åœ¨é€šé“ä¸­å‘é€ä»€ä¹ˆç±»å‹, åç»­ç¼–è¯‘å™¨èƒ½å¤Ÿè‡ªåŠ¨æ¨æ–­ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> rx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">mpsc</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">channel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ä½œä¸ºå‘é€è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// //ä½¿ç”¨ move å°† tx ç§»åŠ¨åˆ°é—­åŒ…ä¸­è¿™æ ·æ–°å»ºçº¿ç¨‹å°±æ‹¥æœ‰ tx äº†, å½“</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å‘é€è€…æ‰§è¡Œå®Œé€»è¾‘, é€€å‡ºä½œç”¨åŸŸ, tx ä¹Ÿå°±è‡ªåŠ¨ææ„äº†, æ¥æ”¶ç«¯ä¹Ÿå°±æ”¶åˆ°å…³é—­çš„ä¿¡å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// (è‹¥æ²¡æœ‰ ä½¿ç”¨ move, tx å§‹ç»ˆå­˜æ´», æ— æ³•è‡ªåŠ¨ææ„, ä¼šé€ æˆ æ¥æ”¶è€…å§‹ç»ˆé˜»å¡)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> val </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hi&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        tx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">val</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¥æ”¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è¿™ä¸ªæ–¹æ³•ä¼šé˜»å¡ä¸»çº¿ç¨‹æ‰§è¡Œç›´åˆ°ä»é€šé“ä¸­æ¥æ”¶ä¸€ä¸ªå€¼, </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å½“é€šé“å‘é€ç«¯å…³é—­ï¼Œrecv ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯è¡¨æ˜ä¸ä¼šå†æœ‰æ–°çš„å€¼åˆ°æ¥äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//try_recv ä¸ä¼šé˜»å¡ï¼Œç›¸åå®ƒç«‹åˆ»è¿”å›ä¸€ä¸ª Result&lt;T, E&gt;ï¼šOk å€¼åŒ…å«å¯ç”¨çš„ä¿¡æ¯ï¼Œè€Œ Err å€¼ä»£è¡¨æ­¤æ—¶æ²¡æœ‰ä»»ä½•æ¶ˆæ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å¯ä»¥ç¼–å†™ä¸€ä¸ªå¾ªç¯æ¥é¢‘ç¹è°ƒç”¨ try_recvï¼Œåœ¨æœ‰å¯ç”¨æ¶ˆæ¯æ—¶è¿›è¡Œå¤„ç†ï¼Œå…¶ä½™æ—¶å€™åˆ™å¤„ç†ä¸€ä¼šå…¶ä»–å·¥ä½œç›´åˆ°å†æ¬¡æ£€æŸ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> received </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> rx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">recv</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Got: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> received</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¹Ÿå¯ä»¥è¿­ä»£æ¥æ”¶å™¨, å½“é€šé“è¢«å…³é—­æ—¶ï¼Œè¿­ä»£å™¨ä¹Ÿå°†ç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> received </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> rx </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€… rx.iter()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Got: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> received</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//é€šè¿‡å…‹éš†å‘é€è€…æ¥åˆ›å»ºå¤šä¸ªç”Ÿäº§è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">sync</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">mpsc</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token class-name" style="color:rgb(38, 127, 153)">Sender</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Receiver</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">NTHREADS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> rx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Sender</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Receiver</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">mpsc</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">channel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// æ‰‹åŠ¨æŒ‡å®šä¼ è¾“æ•°æ®çš„ç±»å‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> id </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token constant" style="color:rgb(129, 31, 63)">NTHREADS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// sender ç«¯å¯è¢«å¤åˆ¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> thread_tx </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> tx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// æˆ–è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> tx1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">mpsc</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Sender</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">tx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// è¢«åˆ›å»ºçš„çº¿ç¨‹å–å¾— `thread_tx` çš„æ‰€æœ‰æƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            thread_tx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;thread {} finished&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> ids </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">with_capacity</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token constant" style="color:rgb(129, 31, 63)">NTHREADS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token constant" style="color:rgb(129, 31, 63)">NTHREADS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// è‹¥æ— å¯ç”¨æ¶ˆæ¯çš„è¯ï¼Œ`recv` å°†é˜»æ­¢å½“å‰çº¿ç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ids</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">recv</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ˜¾ç¤ºæ¶ˆæ¯è¢«å‘é€çš„æ¬¡åº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ids</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1135-tokio-ä¸­çš„å„ç§-channel-å®ç°">11.3.5. tokio ä¸­çš„å„ç§ channel å®ç°<a href="#1135-tokio-ä¸­çš„å„ç§-channel-å®ç°" class="hash-link" aria-label="11.3.5. tokio ä¸­çš„å„ç§ channel å®ç°çš„ç›´æ¥é“¾æ¥" title="11.3.5. tokio ä¸­çš„å„ç§ channel å®ç°çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">sync</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> å®¹é‡æœ‰é™</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sender ä¼šè¢« block</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">async</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> å®¹é‡æ— é™</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sender ä¸ä¼šè¢« block</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">rendezvous</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> å®¹é‡ä¸º </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ç”¨äºçº¿ç¨‹é—´åŒæ­¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">oneshot</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> åªå…è®¸å‘é€ä¸€æ¬¡æ•°æ®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">async</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> å’Œ sync channel ç±»ä¼¼</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ä½†æ˜¯ waker ä¸åŒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="114-å¤šçº¿ç¨‹å°ä¾‹å­">11.4. å¤šçº¿ç¨‹å°ä¾‹å­<a href="#114-å¤šçº¿ç¨‹å°ä¾‹å­" class="hash-link" aria-label="11.4. å¤šçº¿ç¨‹å°ä¾‹å­çš„ç›´æ¥é“¾æ¥" title="11.4. å¤šçº¿ç¨‹å°ä¾‹å­çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1141-å®ç°çº¿ç¨‹æ± ">11.4.1. å®ç°çº¿ç¨‹æ± <a href="#1141-å®ç°çº¿ç¨‹æ± " class="hash-link" aria-label="11.4.1. å®ç°çº¿ç¨‹æ± çš„ç›´æ¥é“¾æ¥" title="11.4.1. å®ç°çº¿ç¨‹æ± çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ç¬¬ä¸‰æ–¹åŒ…: threadpool</p><p>è¿™é‡Œæ‰‹åŠ¨å®ç°</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1142-å®ç°-map-reduce-ç®—æ³•">11.4.2. å®ç° map-reduce ç®—æ³•<a href="#1142-å®ç°-map-reduce-ç®—æ³•" class="hash-link" aria-label="11.4.2. å®ç° map-reduce ç®—æ³•çš„ç›´æ¥é“¾æ¥" title="11.4.2. å®ç° map-reduce ç®—æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ä¾‹å­:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//å®ç° map-reduce ç®—æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> data </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;86967897737416471853297327050364959</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">11861322575564723963297542624962850</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">70856234701860851907960690014725639</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">38397966707106094172783238747669219</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">52380795257888236525459303330302837</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">58495327135744041048897885734297812</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">69920216438980873548808413720956532</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">16278424637452589860345374828574668&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">// åˆ›å»ºä¸€ä¸ªå‘é‡ï¼Œç”¨äºå‚¨å­˜å°†è¦åˆ›å»ºçš„å­çº¿ç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> children </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> chunked_data </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">split_whitespace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> data_segment</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> chunked_data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">enumerate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;data segment {} is \&quot;{}\&quot;&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> data_segment</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// è®¡ç®—è¯¥æ®µçš„æ¯ä¸€ä½çš„å’Œï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> data_segment</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¯¹è¯¥æ®µä¸­çš„å­—ç¬¦è¿›è¡Œè¿­ä»£..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">chars</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ..æŠŠå­—ç¬¦è½¬æˆæ•°å­—..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">map</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params">c</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">to_digit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;should be a digit&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ..å¯¹è¿”å›çš„æ•°å­—ç±»å‹çš„è¿­ä»£å™¨æ±‚å’Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// println! ä¼šé”ä½æ ‡å‡†è¾“å‡ºï¼Œè¿™æ ·å„çº¿ç¨‹æ‰“å°çš„å†…å®¹ä¸ä¼šäº¤é”™åœ¨ä¸€èµ·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;processed segment {}, result={}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸éœ€è¦ â€œreturnâ€ï¼Œå› ä¸º Rust æ˜¯ä¸€ç§ â€œè¡¨è¾¾å¼è¯­è¨€â€ï¼Œæ¯ä¸ªä»£ç å—ä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// æœ€åæ±‚å€¼çš„è¡¨è¾¾å¼å°±æ˜¯ä»£ç å—çš„å€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            result</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æŠŠæ¯ä¸ªçº¿ç¨‹äº§ç”Ÿçš„ä¸­é—´ç»“æœæ”¶å…¥ä¸€ä¸ªæ–°çš„å‘é‡ä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> intermediate_sums </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> child </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> children </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ”¶é›†æ¯ä¸ªå­çº¿ç¨‹çš„è¿”å›å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> intermediate_sum </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> child</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        intermediate_sums</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">intermediate_sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> final_result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> intermediate_sums</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">iter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Final sum result: {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> final_result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1143-å¤šçº¿ç¨‹ç»Ÿè®¡å’Œ">11.4.3. å¤šçº¿ç¨‹ç»Ÿè®¡å’Œ<a href="#1143-å¤šçº¿ç¨‹ç»Ÿè®¡å’Œ" class="hash-link" aria-label="11.4.3. å¤šçº¿ç¨‹ç»Ÿè®¡å’Œçš„ç›´æ¥é“¾æ¥" title="11.4.3. å¤šçº¿ç¨‹ç»Ÿè®¡å’Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOTAL_SIZE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ•°ç»„é•¿åº¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">NTHREAD</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//çº¿ç¨‹æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> data </span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token constant" style="color:rgb(129, 31, 63)">TOTAL_SIZE</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">collect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//åˆå§‹åŒ–ä¸€ä¸ªæ•°æ®ä»1åˆ°næ•°ç»„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> arc_data </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Arc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//data çš„æ‰€æœ‰æƒè½¬ç»™äº† ar_data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> result  </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Arc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">AtomicU64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ”¶é›†ç»“æœçš„æ•°ç»„(åŸå­æ“ä½œ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> thread_handlers </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token macro property">vec!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ç”¨äºæ”¶é›†çº¿ç¨‹å¥æŸ„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token constant" style="color:rgb(129, 31, 63)">NTHREAD</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// clone Arc å‡†å¤‡moveåˆ°çº¿ç¨‹ä¸­ï¼Œåªå¢åŠ å¼•ç”¨è®¡æ•°ï¼Œä¸ä¼šæ·±æ‹·è´å†…éƒ¨æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> test_data </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> arc_data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> res </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        thread_handlers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> id </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">//æ‰¾åˆ°è‡ªå·±çš„åˆ†åŒº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> chunk_size </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOTAL_SIZE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">NTHREAD</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> start </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> id </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> chunk_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> end </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">cmp</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">min</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">start </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> chunk_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOTAL_SIZE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">//è¿›è¡Œæ±‚å’Œè¿ç®—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> sum </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain">  i </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">end  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    sum </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> test_data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token comment" style="color:rgb(0, 128, 0)">//åŸå­æ“ä½œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                res</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">fetch_add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sum </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">SeqCst</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;id={}, sum={}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sum </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç­‰æ‰€æœ‰çš„çº¿ç¨‹æ‰§è¡Œå®Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> th </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> thread_handlers </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        th</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">expect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;The sender thread panic!!!&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//è¾“å‡ºç»“æœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;result = {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">load</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Ordering</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">SeqCst</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1144-å¸¦çº¿ç¨‹æ± çš„-webserver">11.4.4. å¸¦çº¿ç¨‹æ± çš„ webserver<a href="#1144-å¸¦çº¿ç¨‹æ± çš„-webserver" class="hash-link" aria-label="11.4.4. å¸¦çº¿ç¨‹æ± çš„ webserverçš„ç›´æ¥é“¾æ¥" title="11.4.4. å¸¦çº¿ç¨‹æ± çš„ webserverçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>main.rs æ˜¯é¡¹ç›®å¯åŠ¨å…¥å£</p><p>lib.rs ä¸º é¡¹ç›®å†…éƒ¨çš„ å­åº“</p><p>main.rs :</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">mod lib;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::net::{TcpListener, TcpStream};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::io::{Read, Write};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::fs::read_to_string;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::time::Duration;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use thread_pool::ThreadPool;// æ¨ªçº¿å˜ä¸ºä¸‹åˆ’çº¿äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let listener = TcpListener::bind(&quot;127.0.0.1:8080&quot;).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let pool = ThreadPool::new(4);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for stream in listener.incoming().take(2) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match stream {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Ok(stream) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                pool.execute(|| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    handle_conn_quick(stream);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                // handle_conn_quick(stream);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Err(_) =&gt; eprintln!(&quot;error of connection&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn handle_conn_quick(mut stream: TcpStream) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut buf = [0u8; 512];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    stream.read(&amp;mut buf).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;************** req ***************&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}\n&quot;, String::from_utf8_lossy(&amp;buf));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let get = b&quot;GET / HTTP/1.1\r\n&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let sleep = b&quot;GET /sleep HTTP/1.1\r\n&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let (status_line, html_path) = if buf.starts_with(get) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&quot;HTTP/1.1 200 OK\r\n\r\n&quot;, &quot;resources/hello.html&quot;)// ç›¸å¯¹äºæ ¹è·¯å¾„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    } else if buf.starts_with(sleep) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        thread::sleep(Duration::from_secs(5));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&quot;HTTP/1.1 200 OK\r\n\r\n&quot;, &quot;resources/hello.html&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&quot;HTTP/1.1 404 NOT FOUND\r\n\r\n&quot;, &quot;resources/404.html&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let resp = format!(&quot;{}{}&quot;, status_line, read_to_string(html_path).unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;************** resp ***************&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}\n&quot;, resp);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    stream.write(resp.as_bytes()).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    stream.flush().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  è¿™æ˜¯å•çº¿ç¨‹ webserver çš„ä»£ç </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[allow(dead_code)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn handle_conn(mut stream: TcpStream) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut buf = [0u8; 1024];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut content = String::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    loop {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let len = stream.read(&amp;mut buf).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        content.push_str(&amp;String::from_utf8_lossy(&amp;buf)[..]);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if len &lt; buf.len() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            break;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let get = &quot;GET / HTTP/1.1\r\n&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let (status_line, html_path) = if content.starts_with(get) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&quot;HTTP/1.1 200 OK\r\n\r\n&quot;, &quot;resources/hello.html&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        (&quot;HTTP/1.1 404 NOT FOUND\r\n\r\n&quot;, &quot;resources/404.html&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let html = read_to_string(html_path).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let resp = format!(&quot;{}{}&quot;, status_line, html);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    stream.write(resp.as_bytes()).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    stream.flush().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>lib.rs:</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::thread::{JoinHandle, spawn};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::sync::mpsc::{Sender, channel, Receiver};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::sync::{Arc, Mutex};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[cfg(test)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mod tests {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[test]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn it_works() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert_eq!(2 + 2, 4);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub struct ThreadPool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è¦å®ç°çš„è¡Œä¸ºæ˜¯åˆ›å»ºçº¿ç¨‹å¹¶ç¨åå‘é€ä»»åŠ¡ä»£ç </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // æ‰€ä»¥ä¸èƒ½ç›´æ¥å­˜ Thread, è€Œè¦å¼•å…¥ä¸­é—´å±‚ worker</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // è‹¥ç›´æ¥ä½¿ç”¨ Thread, åˆ›å»ºçº¿ç¨‹å, ä»»åŠ¡ä¼šç›´æ¥ç«‹å³æ‰§è¡Œ, ä¸è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    workers: Vec&lt;Worker&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sender: Sender&lt;Msg&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Drop for ThreadPool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn drop(&amp;mut self) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // å‘æ¯ä¸ª workerå‘é€ç»ˆæ­¢æ¶ˆæ¯, ä½¿å¾—ä»»åŠ¡ä»£ç è·³å‡ºreceiveå¾ªç¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºä¸¤ä¸ªforå¾ªç¯?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //å¦‚æœå°è¯•åœ¨åŒä¸€å¾ªç¯ä¸­å‘é€æ¶ˆæ¯å¹¶ç«‹å³ join çº¿ç¨‹ï¼Œåˆ™æ— æ³•ä¿è¯å½“å‰è¿­ä»£çš„ worker æ˜¯ä»é€šé“æ”¶åˆ°ç»ˆæ­¢æ¶ˆæ¯çš„ worker</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        for _ in &amp;mut self.workers {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            self.sender.send(Msg::TerminateMsg).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        for w in &amp;mut self.workers {// éœ€è¦è·å–workersçš„å¯å˜å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            println!(&quot;worker {} stop&quot;, w.id);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // join è°ƒç”¨è€…éœ€è¦æ˜¯ éå¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // é‚£ä¹ˆ, éœ€è¦ä¸€ä¸ªæ–¹æ³•å°† thread ç§»åŠ¨å‡ºæ‹¥æœ‰å…¶æ‰€æœ‰æƒçš„ Worker å®ä¾‹ä»¥ä¾¿ join å¯ä»¥æ¶ˆè´¹è¿™ä¸ªçº¿ç¨‹ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // w.thread.join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            if let Some(thread) = w.thread.take() {//take æ–¹æ³•ä¼šå–å‡º Some è€Œç•™ä¸‹ None</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                thread.join().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enum Msg {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    JobMsg(Job),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    TerminateMsg,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">type Job = Box&lt;dyn FnOnce() + Send + &#x27;static&gt;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl ThreadPool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /// åˆ›å»ºçº¿ç¨‹æ± ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /// # Panics</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ///</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /// `new` å‡½æ•°åœ¨ size ä¸º 0 æ—¶ä¼š panicã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn new(size: usize) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        assert!(size &gt; 0);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut workers = Vec::with_capacity(size);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let (sender, receiver) = channel();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let receiver = Arc::new(Mutex::new(receiver));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //å¤š ç”Ÿäº§è€…ï¼Œå• æ¶ˆè´¹è€… çš„ã€‚è¿™æ„å‘³ç€ä¸èƒ½ç®€å•çš„å…‹éš†é€šé“çš„æ¶ˆè´¹ç«¯æ¥è§£å†³é—®é¢˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        //æˆ‘ä»¬å¸Œæœ›é€šè¿‡åœ¨æ‰€æœ‰çš„ worker ä¸­å…±äº«å•ä¸€ receiverï¼Œåœ¨çº¿ç¨‹é—´åˆ†å‘ä»»åŠ¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        for id in 0..size {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            workers.push(Worker::new(id, Arc::clone(&amp;receiver)));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ThreadPool {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            workers,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            sender,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pub fn execute&lt;F&gt;(&amp;self, f: F)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // æ²¡å‚æ•°, æ²¡è¿”å›å€¼çš„é—­åŒ…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        where F: FnOnce() + Send + &#x27;static</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let job = Box::new(f);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        self.sender.send(Msg::JobMsg(job)).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Worker {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id: usize,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    thread: Option&lt;JoinHandle&lt;()&gt;&gt;,// &quot;()&quot; è¡¨ç¤ºçº¿ç¨‹ä¸­çš„ä»»åŠ¡æ²¡æœ‰è¿”å›å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">impl Worker {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fn new(id: usize, receiver: Arc&lt;Mutex&lt;Receiver&lt;Msg&gt;&gt;&gt;) -&gt; Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let thread = spawn(move|| {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // ä¸å¯ä½¿ç”¨ while let, å› ä¸ºwhile è¡¨è¾¾å¼ä¸­çš„å€¼è¿˜æœ‰å—éƒ½ä¸€ç›´å¤„äºä½œç”¨åŸŸä¸­, é”æ— æ³•é‡Šæ”¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // åªèƒ½ä½¿ç”¨ loop å¾ªç¯,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            //ä½¿ç”¨ loop å¹¶åœ¨å¾ªç¯å—ä¹‹å†…è€Œä¸æ˜¯ä¹‹å¤–è·å–é”å’Œä»»åŠ¡ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // lock æ–¹æ³•è¿”å›çš„ MutexGuard åœ¨ let job è¯­å¥ç»“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // æŸä¹‹åç«‹åˆ»å°±è¢«ä¸¢å¼ƒäº†ã€‚è¿™ç¡®ä¿äº† recv è°ƒç”¨è¿‡ç¨‹ä¸­æŒæœ‰é”ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            // è€Œåœ¨ job() è°ƒç”¨å‰é”å°±è¢«é‡Šæ”¾äº†ï¼Œè¿™å°±å…è®¸å¹¶å‘å¤„ç†å¤šä¸ªè¯·æ±‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            loop {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                let msg = receiver.lock().unwrap().recv().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                match msg {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    Msg::JobMsg(job) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        println!(&quot;worker {} running&quot;, id);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        job();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    Msg::TerminateMsg =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        println!(&quot;worker {} receive terminate msg&quot;, id);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        break;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Self {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            id,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            thread: Some(thread),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="115-rayon-å¹¶è¡Œæ‰§è¡Œä»»åŠ¡">11.5. rayon å¹¶è¡Œæ‰§è¡Œä»»åŠ¡<a href="#115-rayon-å¹¶è¡Œæ‰§è¡Œä»»åŠ¡" class="hash-link" aria-label="11.5. rayon å¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„ç›´æ¥é“¾æ¥" title="11.5. rayon å¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>è½»æ¾åœ°å°†é¡ºåºè®¡ç®—è½¬æ¢ä¸ºå®‰å…¨çš„å¹¶è¡Œè®¡ç®—ï¼Œå¹¶ä¸”ä¿è¯æ— æ•°æ®ç«äº‰</p><p>åº•å±‚ä½¿ç”¨ çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡, è‹¥å·¥ä½œçº¿ç¨‹éƒ½è¢«å ç”¨, åˆ™æ–°åŠ çš„ä»»åŠ¡ä¼šé¡ºåºæ‰§è¡Œ</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// å¹¶è¡Œè¿­ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">extern crate rayon;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use rayon::prelude::*;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn sum_of_squares(input: &amp;[i32]) -&gt; i32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input.par_iter()// è¿”å›ä¸€ä¸ªä¸å¯å˜çš„å¹¶è¡Œè¿­ä»£å™¨ç±»å‹, é€šè¿‡ map æ„é€ äº†æ–°çš„ é›†åˆè¿­ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .map(|&amp;i| i * i).sum()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn increment_all(input: &amp;mut [i32]) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input.par_iter_mut() // å›ä¸€ä¸ªå¯å˜çš„å¹¶è¡Œè¿­ä»£å™¨ç±»å‹ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        .for_each(|p| *p += 1);// ç›´æ¥åœ¨åŸæœ‰åŸºç¡€ä¸Šä¿®æ”¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let v = [1,2,3,4,5,6,7,8,9,10];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let r = sum_of_squares(&amp;v);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   println!(&quot;{}&quot;, r);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   let mut v = [1,2,3,4,5,6,7,8,9,10];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   increment_all(&amp;mut v);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   println!(&quot;{:?}&quot;, v);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// join()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¹¶ä¸ä¿è¯æ¥æ”¶çš„ä¸¤ä¸ªé—­åŒ…ä¸€å®šå¹¶è¡Œæ‰§è¡Œ, å› ä¸º è‹¥ çº¿ç¨‹æ± ä¸­æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹äº†, æ–°ä»»åŠ¡è¿˜æ˜¯åªèƒ½é¡ºåºæ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">extern crate rayon;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn fib(n: u32) -&gt; u32 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    if n &lt; 2 { return n; }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let (a, b) = rayon::join(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // æ¥æ”¶ä¸¤ä¸ªé—­åŒ… , å¹¶è¡Œæ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        || fib(n - 1), || fib(n - 2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a + b</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let r = fib(32);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    assert_eq!(r, 2178309);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="116-crossbeam-æ— é”çš„æ•°æ®ç»“æ„">11.6. CrossBeam æ— é”çš„æ•°æ®ç»“æ„<a href="#116-crossbeam-æ— é”çš„æ•°æ®ç»“æ„" class="hash-link" aria-label="11.6. CrossBeam æ— é”çš„æ•°æ®ç»“æ„çš„ç›´æ¥é“¾æ¥" title="11.6. CrossBeam æ— é”çš„æ•°æ®ç»“æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ˜¯å¯¹ æ ‡å‡†åº“çš„æ‰©å±•å’ŒåŒ…è£…ï¼Œ</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// - æ‰©å±•åŸå­ç±»å‹, ä¸ºåŸºç¡€åº“ä¸­çš„åŸå­ç±»å‹å®ç°äº† AtomicConsume trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - Scoped çº¿ç¨‹: å…è®¸å­çº¿ç¨‹å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨çˆ¶çº¿ç¨‹ä¸­çš„å¼•ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - ä½¿ç”¨ç¼“å­˜è¡Œå¡«å……æå‡äº•å‘æ€§èƒ½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - MPMC Channel: å¤šç”Ÿäº§è€…å¤šæ¶ˆ è´¹è€…é€šé“</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="117-rwlock-å’Œ-refcell">11.7. RwLock å’Œ RefCell<a href="#117-rwlock-å’Œ-refcell" class="hash-link" aria-label="11.7. RwLock å’Œ RefCellçš„ç›´æ¥é“¾æ¥" title="11.7. RwLock å’Œ RefCellçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// RwLock&lt;T&gt;ç›¸å½“äºçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬çš„ RefCell&lt;T&gt;ï¼ŒåŒæ—¶è¿è¡Œå¤šä¸ª readeræˆ–è€…ä¸€ä¸ª writer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// RwLock è¯»å†™é”ï¼Œæ˜¯å¤šè¯»å•å†™é”ï¼Œä¹Ÿ å«å…±äº«ç‹¬å é” ã€‚ å®ƒå…è®¸å¤šä¸ªçº¿ç¨‹è¯»ï¼Œå•ä¸ªçº¿ç¨‹å†™ ã€‚ ä½†æ˜¯åœ¨å†™çš„æ—¶å€™ ï¼Œ åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å æœ‰å†™é” ; è€Œåœ¨è¯»çš„æ—¶å€™ï¼Œ å…è®¸ä»»æ„çº¿ç¨‹è·å–è¯»é” ã€‚ è¯»é”å’Œå†™é”ä¸èƒ½è¢«åŒæ—¶è·å–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ‰€ä»¥åœ¨åº¦å¤šå†™å°‘çš„åœºæ™¯, ä½¿ç”¨ è¯»å†™é”å¯ä»¥æœ‰æ›´é«˜çš„å¹¶å‘æ”¯æŒ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="118-mutex">11.8. Mutex<a href="#118-mutex" class="hash-link" aria-label="11.8. Mutexçš„ç›´æ¥é“¾æ¥" title="11.8. Mutexçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// Mutex&lt;T&gt;æ˜¯é”ï¼ŒåŒä¸€æ—¶é—´ä»…å…è®¸æœ‰-ä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œ, ä¸ç®¡æ˜¯è¯»è¿˜æ˜¯å†™ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æœ¬è´¨æ˜¯ä¸€ä¸ª struct</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="119-atomicptr-å’Œ-cell">11.9. AtomicPtr å’Œ Cell<a href="#119-atomicptr-å’Œ-cell" class="hash-link" aria-label="11.9. AtomicPtr å’Œ Cellçš„ç›´æ¥é“¾æ¥" title="11.9. AtomicPtr å’Œ Cellçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// Atomic ç³»åˆ—ç±»å‹: AtomicBoolã€ Atomiclsizeã€ AtomicUsizeå’ŒAtomicPtr</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å¯ä»¥ç”¨ AtomicPtr æ¥æ¨¡æ‹Ÿå…¶ä»–æƒ³è¦çš„ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// AtomicPtr ç›¸å½“äºçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ çš„ Cell&lt;T&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1110-send-å’Œ-sync-trait">11.10. Send å’Œ Sync trait<a href="#1110-send-å’Œ-sync-trait" class="hash-link" aria-label="11.10. Send å’Œ Sync traitçš„ç›´æ¥é“¾æ¥" title="11.10. Send å’Œ Sync traitçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token maybe-class-name">Send</span><span class="token plain"> è¡¨ç¤ºè¯¥ç±»å‹çš„å€¼å¯ä»¥å®‰å…¨çš„åœ¨å¤šçº¿ç¨‹ä¸­ä¼ é€’</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> è½¬ç§» </span><span class="token function" style="color:rgb(0, 0, 255)">ownership</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">è¡¨ç¤ºè·¨çº¿ç¨‹ move</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    å‡ ä¹æ‰€æœ‰çš„Rustç±»å‹éƒ½æ˜¯Sendçš„ï¼Œä½†æ˜¯ä¾‹å¤–ï¼šä¾‹å¦‚Rc</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">æ˜¯ä¸èƒ½Sendçš„ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ä»»ä½•å®Œå…¨ç”±Sendç±»å‹ç»„æˆçš„ç±»å‹ä¹Ÿä¼šè‡ªåŠ¨è¢«æ ‡è®°ä¸ºSend</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token maybe-class-name">Sync</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">è¡¨ç¤ºç±»å‹å¯ä»¥å®‰å…¨çš„åœ¨å¤šä¸ªçº¿ç¨‹ä¸­æ‹¥æœ‰å…¶å€¼çš„å¼•ç”¨</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">è¡¨ç¤ºè·¨çº¿ç¨‹ share data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> å¯ä»¥è¢«å®‰å…¨çš„ borrow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    å³ï¼Œå¯¹äºä»»æ„ç±»å‹</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain">ï¼Œå¦‚æœ</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain">ï¼ˆ</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain"> çš„å¼•ç”¨ï¼‰æ˜¯Sendçš„è¯</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain">å°±æ˜¯Syncçš„ï¼Œè¿™æ„å‘³ç€å…¶å¼•ç”¨å°±å¯ä»¥å®‰å…¨çš„å‘é€åˆ°å¦ä¸€ä¸ªçº¿ç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æ‰‹åŠ¨å®ç°Sendå’ŒSyncæ˜¯ä¸å®‰å…¨çš„ã€‚é€šå¸¸å¹¶ä¸éœ€è¦æ‰‹åŠ¨å®ç°Sendå’ŒSync traitï¼Œå› ä¸ºç”±Sendå’ŒSyncçš„ç±»å‹ç»„æˆçš„ç±»å‹ï¼Œè‡ªåŠ¨å°±æ˜¯Sendå’ŒSyncçš„ã€‚å› ä¸ºä»–ä»¬æ˜¯æ ‡è®°traitï¼Œç”šè‡³éƒ½ä¸éœ€è¦å®ç°ä»»ä½•æ–¹æ³•</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>12. å¼‚æ­¥å¹¶å‘</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="121-å¼‚æ­¥æ¦‚å¿µ">12.1. å¼‚æ­¥æ¦‚å¿µ<a href="#121-å¼‚æ­¥æ¦‚å¿µ" class="hash-link" aria-label="12.1. å¼‚æ­¥æ¦‚å¿µçš„ç›´æ¥é“¾æ¥" title="12.1. å¼‚æ­¥æ¦‚å¿µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1211-ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥">12.1.1. ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥<a href="#1211-ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥" class="hash-link" aria-label="12.1.1. ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥çš„ç›´æ¥é“¾æ¥" title="12.1.1. ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æƒ³è¦åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡, å¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹, ä½†æ˜¯åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢å’Œçº¿ç¨‹ä¹‹é—´çš„æ•°æ®å…±äº«è¿‡ç¨‹ä¸­ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šå¼€é”€ã€‚å³ä½¿æ˜¯ä¸€ä¸ªåªæ˜¯åç€ä»€ä¹ˆéƒ½ä¸åšçš„çº¿ç¨‹ï¼Œä¹Ÿä¼šæ¶ˆè€—å®è´µçš„ç³»ç»Ÿèµ„æº</p><p>å¼‚æ­¥å¯ä»¥åœ¨ä¸åˆ›å»ºå¤šä¸ªçº¿ç¨‹çš„æƒ…å†µä¸‹åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡, å…·ä½“æ¥è¯´å°±æ˜¯ä½¿ç”¨åç¨‹ coroutine</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1212-æ™®é€šå¤šçº¿ç¨‹-webserver">12.1.2. æ™®é€šå¤šçº¿ç¨‹ webserver<a href="#1212-æ™®é€šå¤šçº¿ç¨‹-webserver" class="hash-link" aria-label="12.1.2. æ™®é€šå¤šçº¿ç¨‹ webserverçš„ç›´æ¥é“¾æ¥" title="12.1.2. æ™®é€šå¤šçº¿ç¨‹ webserverçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ä¾‹å­: ä»ä¸¤ä¸ª serverä¸‹è½½, ç¬¬ä¸€ä¸ªèµ„æº è€—æ—¶ 3s, ç¬¬äºŒä¸ªèµ„æºè€—æ—¶ 1s , æ€»å…±è€—æ—¶ 4s, æ”¹ä¸º å¤šçº¿ç¨‹å¯ä»¥ç¼©çŸ­ä¸º 3s, ä½†æ˜¯æœ‰çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€, æœ€å¥½çš„æ˜¯ æ”¹ä¸ºå¼‚æ­¥</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// client</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">start_client</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é¡ºåºæ‰§è¡Œ, è€—æ—¶é•¿, 4s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// connect_to_server(&quot;localhost&quot;, 8080, &quot;send to server0: 8080&quot;)?;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// connect_to_server(&quot;localhost&quot;, 8081, &quot;send to server1: 8081&quot;)?;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¤šçº¿ç¨‹, è¿›ä¸€æ­¥, å¯ä»¥è€ƒè™‘ ä½¿ç”¨çº¿ç¨‹æ± </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> handles </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> handle_server0 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">connect_to_server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8080</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;send to server0: 8080&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    handles</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">handle_server0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> handle_server1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">connect_to_server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8081</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;send to server0: 8081&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    handles</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">handle_server1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> handle </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> handles </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        handle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">connect_to_server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">host</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> port</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u16</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">TcpStream</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">connect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">host</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> port</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buf_reader </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">BufReader</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buf </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    buf_reader</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read_until</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token char" style="color:rgb(129, 31, 63)">b&#x27;\n&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&gt;&gt;&gt; recv from server : {}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_utf8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// server1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">start_server1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> tcp_listener </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">TcpListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">bind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;localhost:8080&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> stream </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> tcp_listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">incoming</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">handle_conn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> stream</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">//server2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">start_server2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> tcp_listener </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">TcpListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">bind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;localhost:8081&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> stream </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> tcp_listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">incoming</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">handle_conn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> stream</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">handle_conn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">TcpStream</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> wait_seconds</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">u64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buf </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">read</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sleep</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_secs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">wait_seconds</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">as_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1213-æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬">12.1.3. æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬<a href="#1213-æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬" class="hash-link" aria-label="12.1.3. æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬çš„ç›´æ¥é“¾æ¥" title="12.1.3. æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    io::{BufRead, BufReader, Read, Result, Write},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    net::{TcpListener, TcpStream},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    str::from_utf8,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use futures::{executor::block_on, join};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    block_on(conn_all_async())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">async fn conn_all_async() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let f0 = conn_server_async(&quot;localhost&quot;, 8080, &quot;send to server0: 8080&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let f1 = conn_server_async(&quot;localhost&quot;, 8081, &quot;send to server0: 8081&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    join!(f0, f1);// ç­‰å¾… f0, f1 å®Œæˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">async fn conn_server_async(host: &amp;str, port: u16, content: &amp;str) -&gt; Result&lt;()&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    conn_serve(host, port, content)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn conn_serve(host: &amp;str, port: u16, content: &amp;str) -&gt; Result&lt;()&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut s = TcpStream::connect((host, port))?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    s.write(content.as_bytes())?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut buf = Vec::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut buf_reader = BufReader::new(&amp;s);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    buf_reader.read_until(b&#x27;\n&#x27;, &amp;mut buf)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;recv from server: {}&quot;, from_utf8(&amp;buf).unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Ok(())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="122-åŸºæœ¬ä½¿ç”¨">12.2. åŸºæœ¬ä½¿ç”¨<a href="#122-åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="12.2. åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="12.2. åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1221-block_on">12.2.1. block_on<a href="#1221-block_on" class="hash-link" aria-label="12.2.1. block_onçš„ç›´æ¥é“¾æ¥" title="12.2.1. block_onçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å®šä¹‰å¼‚æ­¥å‡½æ•°, ç„¶åä½¿ç”¨ block_on é˜»å¡ä¸»çº¿ç¨‹:</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// futures = &quot;0.3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">futures</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">executor</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> hello_future </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">hello</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// å¼‚æ­¥æ‰§è¡Œ (ä¸ä¼šç­‰å¾…æ‰§è¡Œå®Œ), hello_future ä»£è¡¨å¼‚æ­¥å‡½æ•°çš„ handle å¥æŸ„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;main finish&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// é˜»å¡ main thread,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// æ¥å—ä¸€ä¸ª future, è¿”å›çœŸå®ç»“æœ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">hello_future</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// å¼‚æ­¥å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">hello</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello async&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1222-await">12.2.2. await<a href="#1222-await" class="hash-link" aria-label="12.2.2. awaitçš„ç›´æ¥é“¾æ¥" title="12.2.2. awaitçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ä½¿ç”¨ .await ç­‰å¾…å¼‚æ­¥å‡½æ•°æ‰§è¡Œå®Œ, ç”¨äºå¤šä¸ªå¼‚æ­¥å‡½æ•°æœ‰ä¾èµ–å…³ç³»</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// futures = &quot;0.3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">futures</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">executor</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">hello2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// é˜»å¡ç­‰å¾… hello2 æ‰§è¡Œå®Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">hello</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello async&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">hello1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">hello</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰å¾… hello() æ‰§è¡Œå®Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello 1&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">hello2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">hello1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//ç­‰å¾… hello1 æ‰§è¡Œå®Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;hello 2&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1223-joinn">12.2.3. joinn<a href="#1223-joinn" class="hash-link" aria-label="12.2.3. joinnçš„ç›´æ¥é“¾æ¥" title="12.2.3. joinnçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å¹¶è¡Œæ‰§è¡Œå¼‚æ­¥å‡½æ•°</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">futures</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">executor</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">time</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> main </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">async_main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">//é˜»å¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(255, 0, 0)">#[derive(Debug)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">learn_song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Song</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¸èƒ½ä½¿ç”¨ thread::sleep</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">async_std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">task</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">sleep</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_secs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//async-std = &quot;1.5&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;learn song&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token class-name" style="color:rgb(38, 127, 153)">Song</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">sing_song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">async_std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">task</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">sleep</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_secs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sing song: {:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">dance</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;dance&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">learn_and_sing</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> song </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">learn_song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ç­‰å¾…æ‰§è¡Œå®Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sing_song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">song</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token comment" style="color:rgb(0, 128, 0)">// ä¹Ÿè¦åŠ  await, å¦åˆ™ä¸»çº¿ç¨‹ä¸ä¼šç­‰å¾… sing_song() æ‰§è¡Œå®Œå°±ç»§ç»­å‰è¿›äº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">async_main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> f1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">learn_and_sing</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> f2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dance</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// `join!` ç±»ä¼¼äº `.await` ï¼Œä½†æ˜¯å¯ä»¥ç­‰å¾…å¤šä¸ª future å¹¶å‘å®Œæˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">futures</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token macro property">join!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">f1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> f2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">//  f1, f2 å¹¶è¡Œå®Œæˆ, è¿”å› (handle1, handle2)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//dance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//learn song</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">//sing song: Song</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="123-futureå¹¶å‘æ¨¡å¼">12.3. futureå¹¶å‘æ¨¡å¼<a href="#123-futureå¹¶å‘æ¨¡å¼" class="hash-link" aria-label="12.3. futureå¹¶å‘æ¨¡å¼çš„ç›´æ¥é“¾æ¥" title="12.3. futureå¹¶å‘æ¨¡å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1231-futureåº•å±‚æ˜¯ç”Ÿæˆå™¨">12.3.1. futureåº•å±‚æ˜¯ç”Ÿæˆå™¨<a href="#1231-futureåº•å±‚æ˜¯ç”Ÿæˆå™¨" class="hash-link" aria-label="12.3.1. futureåº•å±‚æ˜¯ç”Ÿæˆå™¨çš„ç›´æ¥é“¾æ¥" title="12.3.1. futureåº•å±‚æ˜¯ç”Ÿæˆå™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>è¦æ”¯æŒasync/awaitå¼‚æ­¥å¼€å‘ï¼Œ æœ€å¥½æ˜¯èƒ½æœ‰åç¨‹çš„æ”¯æŒ, </p><p>ä¸€ç§æ˜¯æœ‰æ ˆåç¨‹(Stackful); å¦ä¸€ç§æ˜¯æ— æ ˆåç¨‹(Stackless)ã€‚å¯¹äºæœ‰æ ˆåç¨‹çš„å®ç°ï¼Œ ä¸€èˆ¬æ¯ä¸ªåç¨‹éƒ½è‡ªå¸¦ç‹¬ç«‹çš„æ ˆï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œ ä½†æ˜¯æ¯”è¾ƒè€— å†…å­˜ï¼Œ æ€§èƒ½ä¸å¦‚æ— æ ˆåç¨‹ã€‚ è€Œæ— æ ˆåç¨‹ä¸€èˆ¬æ˜¯åŸºäºçŠ¶æ€æœº(StateMachine) æ¥å®ç°çš„ï¼Œ ä¸ä½¿ ç”¨ç‹¬ç«‹ çš„æ ˆï¼Œå…·ä½“çš„åº”ç”¨å½¢å¼ å«ç”Ÿæˆå™¨( Generator), rust ä½¿ç”¨åè€…</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åŸºæœ¬ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#![feature(generators, generator_trait)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{ops::{Generator, GeneratorState}, pin::Pin};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç”Ÿæˆå™¨æ— æ³•æ¥å—å‚æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // å’Œé—­åŒ…ä¸€æ ·å¯ä»¥æ•è·å¤–éƒ¨ç¯å¢ƒçš„å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨moveå…³é”®å­—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ç”Ÿæˆå™¨è‡ªåŠ¨å®ç°äº†Sendå’ŒSync,ä½†ä¸ä¼šè‡ªåŠ¨å®ç°Copyæˆ–Cloneä¹‹ç±»çš„trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut gen = || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        yield 1;// æ¯ä¸ª yield å¯¹åº”ä¸€ä¸ªä¸åŒçš„çŠ¶æ€, æ¯æ¬¡è°ƒç”¨ resume(), åˆ™è¿”å›å¯¹åº”å€¼, ç”Ÿæˆå™¨æš‚æ—¶è¢«æŒ‚èµ·, ç›´åˆ°å†æ¬¡ è°ƒç”¨ resume(), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        yield 2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        return 3; // è°ƒç”¨ resume è¿”å› 3, åˆ™ ç”Ÿæˆå™¨ç»“æŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    match Pin::new(&amp;mut gen).resume(()) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        GeneratorState::Yielded(1) =&gt; {},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ =&gt; panic!(&quot;error 1&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    match Generator::resume(Pin::new(&amp;mut gen), ()) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        GeneratorState::Yielded(2) =&gt; {},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ =&gt; panic!(&quot;error 2&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    match Generator::resume(Pin::new(&amp;mut gen), ()) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // GeneratorState::Yielded(3) =&gt; {},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        GeneratorState::Complete(3) =&gt; {},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ =&gt; panic!(&quot;error 3&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // let state = Generator::resume(Pin::new(&amp;mut gen), ());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // println!(&quot;{:?}&quot;, state);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ä½œä¸ºå‡½æ•°è¿”å›å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#![feature(generators, generator_trait)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::ops::Generator;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn up_to(limit: u64) -&gt; impl Generator&lt;Yield = u64, Return = u64&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for x in 0..limit {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         yield x;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    return limit;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let a = 10;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut b = up_to(a);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      for _ in 0..=10{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         let c = b.resume();   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         println!(&quot;{:?}&quot;, c);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//  å’Œè¿­ä»£å™¨ çš„å…³ç³»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Generator&lt;Yield=T, Return=()&gt; - å¦‚æœåªå…³æ³¨è®¡ç®— çš„è¿‡ç¨‹ï¼Œè€Œä¸å…³ å¿ƒè®¡ ç®—çš„ç»“æœï¼Œ åˆ™å¯ä»¥ å°† Return è®¾ç½®ä¸ºå•å…ƒç±»å‹ï¼Œåªä¿ç•™ Yield çš„ç±»å‹ï¼Œ é‚£ ä¹ˆç”Ÿæˆå™¨å°±å¯ä»¥åŒ–èº«ä¸ºæ³•ä»£å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// ç”Ÿæˆå™¨çš„æ€§èƒ½æ¯”è¿­ä»£å™¨æ›´é«˜ã€‚å› ä¸ºç”Ÿæˆå™¨æ˜¯ä¸€ç§å»¶è¿Ÿè®¡ç®—æˆ–æƒ°æ€§è®¡ç®—ï¼Œ å®ƒé¿å…äº†ä¸å¿… è¦çš„è®¡ç®—ï¼Œåªæœ‰åœ¨æ¯æ¬¡éœ€è¦æ—¶æ‰é€šè¿‡ yieldæ¥äº§ç”Ÿç›¸å…³çš„å€¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#![feature(generators, generator_trait)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::{ops::{Generator, GeneratorState}, pin::Pin};</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut gen = gen();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut state = Pin::new(&amp;mut gen);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for _ in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match state.as_mut().resume(()) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            GeneratorState::Yielded(i) =&gt; println!(&quot;{:?}&quot;, i),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _ =&gt; println!(&quot;complete&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn gen() -&gt; impl Generator&lt;Yield = u64, Return = ()&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut i = 0;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        loop {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            i += 1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            yield i;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å’Œ futureå…³ç³»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// Generator&lt;Yield = (), Return = Result&lt;T, E&gt;&gt; - ä¸å…³ å¿ƒè¿‡ ç¨‹ ï¼Œ åªå…³æ³¨ç»“æœ, ç”Ÿæˆå™¨å°±å¯ä»¥åŒ–èº«ä¸º Future</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pub fn up_to(limit: u64) -&gt; impl Generator&lt;Yield = (), Return = Result&lt;u64, ()&gt;&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    move || {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        for x in 0..limit {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            yield ();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        return Ok(limit);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main(){</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let limit = 2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut gen = up_to(limit);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    unsafe {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      for i in 0..=limit{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         match gen.resume() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             GeneratorState::Yielded(v) =&gt; println!(&quot;resume {:?} : Pending&quot;, i),// è¡¨ç¤ºè¿˜æ²¡å¤„ç†å®Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             GeneratorState::Complete(v) =&gt; println!(&quot;resume {:?} : Ready&quot;, i), // å¤„ç†å®Œæˆ, æ‹¿åˆ°ç»“æœ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1232-futureåŸºæœ¬ä½¿ç”¨ç”¨">12.3.2. futureåŸºæœ¬ä½¿ç”¨ç”¨<a href="#1232-futureåŸºæœ¬ä½¿ç”¨ç”¨" class="hash-link" aria-label="12.3.2. futureåŸºæœ¬ä½¿ç”¨ç”¨çš„ç›´æ¥é“¾æ¥" title="12.3.2. futureåŸºæœ¬ä½¿ç”¨ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ç¬¬ä¸‰æ–¹åº“ futures-rs æä¾›</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// åŸºæœ¬ç»„ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - Future  çœŸå®ç»“æœçš„åŒ…è£…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">//      æ ¸å¿ƒå‡½æ•° poll(), è¿”å› è®¡ç®—ç»“æœæ˜¯å¦å‡†å¤‡å¥½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - Executor è°ƒåº¦å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// - Task å…·ä½“çš„å¼‚æ­¥ä»»åŠ¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// å®ç°ä¸€ä¸ª Future traitçš„æ–¹å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ–¹å¼1ï¼šä½¿ç”¨ async fnï¼Œasync fu ä¼šè‡ªåŠ¨ä¸ºå¼€å‘è€…ç”Ÿæˆè¿”å›å€¼æ˜¯ impl Future ç±» å‹çš„å‡½æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// æ–¹å¼2ï¼šè‡ªå®šä¹‰ ç»“æ„ä½“ï¼Œå¹¶å®ç° Future trait</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// async/await åŸç†: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// async å…³é”®å­—å®šä¹‰å¼‚æ­¥å‡½æ•°/å¼‚æ­¥å—ï¼Œåº•å±‚éƒ½ä¼šå…ˆè½¬ä¸º async å—çš„å½¢å¼, å†å°† async å—ç”Ÿæˆä¸€ä¸ª Generator&lt;Yield=()&gt;ç±»å‹çš„ç”Ÿæˆå™¨æ¥ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1233-åŠ¨æ‰‹å®ç°-future-ç±»å‹">12.3.3. åŠ¨æ‰‹å®ç° Future ç±»å‹<a href="#1233-åŠ¨æ‰‹å®ç°-future-ç±»å‹" class="hash-link" aria-label="12.3.3. åŠ¨æ‰‹å®ç° Future ç±»å‹çš„ç›´æ¥é“¾æ¥" title="12.3.3. åŠ¨æ‰‹å®ç° Future ç±»å‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://www.rectcircle.cn/posts/rust%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/" target="_blank" rel="noopener noreferrer">https://www.rectcircle.cn/posts/rust%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1234-åŠ¨æ‰‹å®ç°-å¼‚æ­¥-sleep">12.3.4. åŠ¨æ‰‹å®ç° å¼‚æ­¥ sleep<a href="#1234-åŠ¨æ‰‹å®ç°-å¼‚æ­¥-sleep" class="hash-link" aria-label="12.3.4. åŠ¨æ‰‹å®ç° å¼‚æ­¥ sleepçš„ç›´æ¥é“¾æ¥" title="12.3.4. åŠ¨æ‰‹å®ç° å¼‚æ­¥ sleepçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>é€šè¿‡è‡ªå®šä¹‰ç±»å‹çš„æ–¹å¼å®ç°ä¸€ä¸ªå¼‚æ­¥çš„sleep, ç±»ä¼¼äºasync_std::task:sleep</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">futures</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">executor</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">time</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">async_std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">sync</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Arc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">sync</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Mutex</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">futures</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">task</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token class-name" style="color:rgb(38, 127, 153)">Waker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Poll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">futures</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Future</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">pin</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Pin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sleep</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">block_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// å¼‚æ­¥ä»£ç å—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;start&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">TimerFuture</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">from_secs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;end&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">TimerFuture</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    shared_state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Arc</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Mutex</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">SharedState</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">SharedState</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    completed</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    waker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Waker</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Future</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">TimerFuture</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:rgb(38, 127, 153)">Output</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">poll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Pin</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Context</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token lifetime-annotation symbol">&#x27;_</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Poll</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Output</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> shared_state </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">self</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">shared_state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">lock</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> shared_state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">completed </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Poll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Ready</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            shared_state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">waker </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">cx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">waker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token class-name" style="color:rgb(38, 127, 153)">Poll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token class-name" style="color:rgb(38, 127, 153)">Pending</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">impl</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">TimerFuture</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">du</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Duration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> shared_state </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Arc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Mutex</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">SharedState</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            completed</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            waker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">None</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> thread_shared_state </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> shared_state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">sleep</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">du</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> state </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> thread_shared_state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">lock</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">completed </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">waker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">waker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">take</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                waker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">wake</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token class-name" style="color:rgb(38, 127, 153)">TimerFuture</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            shared_state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="124-async-std">12.4. async-std<a href="#124-async-std" class="hash-link" aria-label="12.4. async-stdçš„ç›´æ¥é“¾æ¥" title="12.4. async-stdçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ç›¸è¾ƒäº tokio, å¹´è½», æ²¡æœ‰å†å²åŒ…è¢±, å…¼å®¹æ ‡å‡†åº“, æ›´åŠ å°å·§</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="125-tokio">12.5. tokio<a href="#125-tokio" class="hash-link" aria-label="12.5. tokioçš„ç›´æ¥é“¾æ¥" title="12.5. tokioçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h1>13. ç®€å•æ–‡ä»¶ç³»ç»Ÿ</h1><p><a href="https://zhuanlan.zhihu.com/p/115464045" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/115464045</a></p><h1>14. ç½‘ç»œç¼–ç¨‹</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="141-tcp">14.1. tcp<a href="#141-tcp" class="hash-link" aria-label="14.1. tcpçš„ç›´æ¥é“¾æ¥" title="14.1. tcpçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::net::TcpListener;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::io::Read;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() -&gt; std::io::Result&lt;()&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let listener = TcpListener::bind(&quot;127.0.0.1:1080&quot;)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for stream in listener.incoming() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        match stream {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Ok(mut stream) =&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                let mut buf = [0u8; 512];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                let len = stream.read(&amp;mut buf)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                println!(&quot;{}&quot;, String::from_utf8_lossy(&amp;buf));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            Err(_) =&gt; eprintln!(&quot;Error of accept request.&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Ok(())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() -&gt; std::io::Result&lt;()&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut stream = TcpStream::connect(&quot;127.0.0.1:1080&quot;)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for index in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let msg = format!(&quot;tcp msg {}&quot;, index);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        stream.write_all(msg.as_bytes());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        debug!(&quot;send: {}&quot;, msg);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut buf = [0u8; 512];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        stream.read(&amp;mut buf);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Ok(())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="142-udp">14.2. udp<a href="#142-udp" class="hash-link" aria-label="14.2. udpçš„ç›´æ¥é“¾æ¥" title="14.2. udpçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">// server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use std::net::UdpSocket;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() -&gt; std::io::Result&lt;()&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let socket = UdpSocket::bind(&quot;127.0.0.1:1080&quot;)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    loop {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut buf = [0u8; 512];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // receive from client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // len: data length</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        // src_addr: source address</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let (len, src_addr) = socket.recv_from(&amp;mut buf)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;recv: {}&quot;, String::from_utf8_lossy(&amp;buf));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let resp_buf = &amp;mut buf[..len];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        resp_buf.reverse();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        socket.send_to(resp_buf, src_addr)?;// send data to client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;send: {}&quot;, String::from_utf8_lossy(resp_buf));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Ok(())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() -&gt; std::io::Result&lt;()&gt; {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let socket = UdpSocket::bind(&quot;127.0.0.1:34254&quot;)?;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    socket.connect(&quot;127.0.0.1:8080&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    for index in 0..3 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let msg = format!(&quot;udp msg {}&quot;, index);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        socket.send(msg.as_bytes());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;send: {}&quot;, msg);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut buf = [0u8; 512];</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        socket.recv(&amp;mut buf);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;recv: {}&quot;, String::from_utf8_lossy(&amp;buf));</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Ok(())</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>15. æ¶ˆæ¯ä¸­é—´ä»¶</h1><p><a href="https://github.com/nkbai/learnrustbynats" target="_blank" rel="noopener noreferrer">https://github.com/nkbai/learnrustbynats</a></p><p>TODO</p><h1>16. æ¸¸æˆå¼€å‘</h1><p><a href="https://www.yuque.com/quaint/rust/ldnc5g" target="_blank" rel="noopener noreferrer">https://www.yuque.com/quaint/rust/ldnc5g</a>
TODO</p><h1>17. çˆ¬è™«</h1><p>Hyper ï¼šä¸€ä¸ªå¿«é€Ÿå’Œæ­£ç¡®çš„ Rust HTTPå®ç°ã€‚ <a href="https://github.com/hyperium/hyper" target="_blank" rel="noopener noreferrer">https://github.com/hyperium/hyper</a>
reqwest : rust http clientå®ç° <a href="https://github.com/seanmonstar/reqwest" target="_blank" rel="noopener noreferrer">https://github.com/seanmonstar/reqwest</a>
html5everï¼šRust htmlè§£æåº“ <a href="https://github.com/servo/html5ever" target="_blank" rel="noopener noreferrer">https://github.com/servo/html5ever</a>
select :åŸºäºhtml5ever çš„htmlè§£æåº“ï¼Œç±»ä¼¼äºpythonçš„ beautifulsoap <a href="https://github.com/utkarshkukreti/select.rs" target="_blank" rel="noopener noreferrer">https://github.com/utkarshkukreti/select.rs</a>
crates.io <a href="https://crates.io/crates/select" target="_blank" rel="noopener noreferrer">https://crates.io/crates/select</a>
é™„ï¼šhttpsï¼š//github.com/carllerche/curl-rust</p><h1>18. rpc æ¡†æ¶</h1><p><a href="https://zhuanlan.zhihu.com/p/36528189" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/36528189</a></p><h1>19. ç¼–å†™ä»£ç†</h1><p><a href="https://github.com/gwuhaolin/blog/issues/12" target="_blank" rel="noopener noreferrer">https://github.com/gwuhaolin/blog/issues/12</a>
<a href="https://github.com/importcjj/rust-miniproxy" target="_blank" rel="noopener noreferrer">https://github.com/importcjj/rust-miniproxy</a>
<a href="https://github.com/wangyuntao/socks5-rs" target="_blank" rel="noopener noreferrer">https://github.com/wangyuntao/socks5-rs</a>
<a href="https://github.com/importcjj/gkd-rs" target="_blank" rel="noopener noreferrer">https://github.com/importcjj/gkd-rs</a></p><p><a href="https://zhuanlan.zhihu.com/p/28645724" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/28645724</a>
<a href="https://www.jianshu.com/p/d1048d0b687f" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/d1048d0b687f</a>
<a href="https://doc.rust-lang.org/std/net/" target="_blank" rel="noopener noreferrer">https://doc.rust-lang.org/std/net/</a>
<a href="https://zhuanlan.zhihu.com/p/97200083" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/97200083</a>
<a href="https://www.mojidong.com/post/2015-03-07-socket5-1/" target="_blank" rel="noopener noreferrer">https://www.mojidong.com/post/2015-03-07-socket5-1/</a>
<a href="https://www.zhihu.com/search?type=content&amp;q=rust%20socket" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/search?type=content&amp;q=rust%20socket</a></p><p>TODO</p><p><a href="https://lowlvl.org/" target="_blank" rel="noopener noreferrer">https://lowlvl.org/</a> ä½¿ç”¨ rust å­¦ä¹  tcp</p><p><a href="https://github.com/shadowsocks/shadowsocks-rust" target="_blank" rel="noopener noreferrer">https://github.com/shadowsocks/shadowsocks-rust</a>
<a href="https://github.com/trojan-gfw/trojan" target="_blank" rel="noopener noreferrer">https://github.com/trojan-gfw/trojan</a>
<a href="https://github.com/p4gefau1t/trojan-r" target="_blank" rel="noopener noreferrer">https://github.com/p4gefau1t/trojan-r</a>
<a href="https://github.com/importcjj/rust-miniproxy" target="_blank" rel="noopener noreferrer">https://github.com/importcjj/rust-miniproxy</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="191-http-ä»£ç†">19.1. http ä»£ç†<a href="#191-http-ä»£ç†" class="hash-link" aria-label="19.1. http ä»£ç†çš„ç›´æ¥é“¾æ¥" title="19.1. http ä»£ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>http ä»£ç†: åŸºäº HTTP åè®®. å±äºåº”ç”¨å±‚åè®®ï¼Œä¸€èˆ¬åªä¼šä»£ç†è½¬å‘ HTTP è¯·æ±‚ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ CONNECT æ–¹æ³•æ¥å®ç°ä¸€èˆ¬ TCP çš„ä»£ç†è½¬å‘
<a href="https://github.com/linmx0130/rust-http-proxy" target="_blank" rel="noopener noreferrer">https://github.com/linmx0130/rust-http-proxy</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="192-socket-ä»£ç†">19.2. socket ä»£ç†<a href="#192-socket-ä»£ç†" class="hash-link" aria-label="19.2. socket ä»£ç†çš„ç›´æ¥é“¾æ¥" title="19.2. socket ä»£ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Socketæ˜¯ä¸€å¥—æ ‡å‡†ï¼Œå®ƒå®Œæˆäº†å¯¹TCP/IPçš„é«˜åº¦å°è£…; Socket = IPåœ°å€ + ç«¯å£ + åè®®ã€‚</p><p>socket5ä»£ç†: socket5 æ˜¯ä¸€ä¸ªtcpã€udpçš„ä»£ç†åè®®(socket4ä¸æ”¯æŒudp), ä¼ è¾“å±‚ä»£ç†åè®®, å®ƒç›´æ¥é€šè¿‡åè®®æ¡æ‰‹æ¥è¿›è¡Œè¿æ¥ï¼Œå¹¶ç›´æ¥ä¿®æ”¹æŠ¥å¤´æ¥å®ç°è½¬å‘ï¼Œæ‰€ä»¥é€Ÿåº¦éå¸¸å¿«,å¤§éƒ¨åˆ†è½¯ä»¶éƒ½æ”¯æŒsocket5ä»£ç†ã€‚</p><p><a href="https://github.com/importcjj" target="_blank" rel="noopener noreferrer">https://github.com/importcjj</a>
<a href="https://github.com/zhboner/realm" target="_blank" rel="noopener noreferrer">https://github.com/zhboner/realm</a> æµé‡è½¬å‘
<a href="https://cloud.tencent.com/developer/article/1484318" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1484318</a>
<a href="https://github.com/gwuhaolin/blog/issues/12" target="_blank" rel="noopener noreferrer">https://github.com/gwuhaolin/blog/issues/12</a></p><h1>20. å¼€å‘å¾®ä¿¡å°ç¨‹åº-web æ¸¸æˆ</h1><p><a href="https://github.com/planet0104" target="_blank" rel="noopener noreferrer">https://github.com/planet0104</a></p><h1>21. ç¬¬ä¸‰æ–¹ crates</h1><p><a href="https://crates.io/" target="_blank" rel="noopener noreferrer">https://crates.io/</a>
<a href="https://s0docs0rs.icopy.site/" target="_blank" rel="noopener noreferrer">https://s0docs0rs.icopy.site/</a></p><p><a href="https://rust-lang-nursery.github.io/rust-cookbook/" target="_blank" rel="noopener noreferrer">https://rust-lang-nursery.github.io/rust-cookbook/</a></p><p><a href="https://github.com/crate-ci/typos" target="_blank" rel="noopener noreferrer">https://github.com/crate-ci/typos</a> æ‹¼å†™æ£€æŸ¥</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="211-äº‹å®ä¸Šçš„æ ‡å‡†åº“">21.1. äº‹å®ä¸Šçš„æ ‡å‡†åº“<a href="#211-äº‹å®ä¸Šçš„æ ‡å‡†åº“" class="hash-link" aria-label="21.1. äº‹å®ä¸Šçš„æ ‡å‡†åº“çš„ç›´æ¥é“¾æ¥" title="21.1. äº‹å®ä¸Šçš„æ ‡å‡†åº“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>clap<br>
<!-- -->serde<br>
<!-- -->reqwest  http client<br>
<!-- -->hyper  å¿«é€ŸHTTPå®ç°   , ç»å¸¸ä½¿ç”¨Actixè€Œä¸æ˜¯Hyper<br>
<!-- -->rayon æ•°æ®å¹¶è¡Œ<br>
<!-- -->slog and log<br>
<!-- -->itertools<br>
<!-- -->PyO3  åŒ…è£… rust lib åœ¨ Python ä¸­ä½¿ç”¨  (<a href="https://github.com/ijl/orjson" target="_blank" rel="noopener noreferrer">https://github.com/ijl/orjson</a>, <a href="https://github.com/mre/hyperjson" target="_blank" rel="noopener noreferrer">https://github.com/mre/hyperjson</a>)<br>
<!-- -->proptest åŸºäºå±æ€§çš„æµ‹è¯•åº“<br>
<!-- -->libloading å°†Goæˆ–å…¶ä»–c-libåº“æ··åˆåˆ°Rustå‰ç«¯<br>
<!-- -->regex   æ­£åˆ™    </p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="212-markdown">21.2. markdown<a href="#212-markdown" class="hash-link" aria-label="21.2. markdownçš„ç›´æ¥é“¾æ¥" title="21.2. markdownçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/raphlinus/pulldown-cmark" target="_blank" rel="noopener noreferrer">https://github.com/raphlinus/pulldown-cmark</a> ç®€å•<br>
<a href="https://github.com/kivikakk/comrak" target="_blank" rel="noopener noreferrer">https://github.com/kivikakk/comrak</a> å¤æ‚, å¼ºå¤§</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="213-æ¡Œé¢å¼€å‘">21.3. æ¡Œé¢å¼€å‘<a href="#213-æ¡Œé¢å¼€å‘" class="hash-link" aria-label="21.3. æ¡Œé¢å¼€å‘çš„ç›´æ¥é“¾æ¥" title="21.3. æ¡Œé¢å¼€å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/tauri-apps/tauri" target="_blank" rel="noopener noreferrer">https://github.com/tauri-apps/tauri</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="214-è§†é¢‘å¤„ç†">21.4. è§†é¢‘å¤„ç†<a href="#214-è§†é¢‘å¤„ç†" class="hash-link" aria-label="21.4. è§†é¢‘å¤„ç†çš„ç›´æ¥é“¾æ¥" title="21.4. è§†é¢‘å¤„ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/larksuite/rsmpeg" target="_blank" rel="noopener noreferrer">https://github.com/larksuite/rsmpeg</a> é£ä¹¦å›¢é˜Ÿå‡ºå“ ffmpeg çš„ rust binding</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="215-å›¾ç‰‡å¤„ç†">21.5. å›¾ç‰‡å¤„ç†<a href="#215-å›¾ç‰‡å¤„ç†" class="hash-link" aria-label="21.5. å›¾ç‰‡å¤„ç†çš„ç›´æ¥é“¾æ¥" title="21.5. å›¾ç‰‡å¤„ç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/Aloxaf/silicon" target="_blank" rel="noopener noreferrer">https://github.com/Aloxaf/silicon</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="216-æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“">21.6. æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“<a href="#216-æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“" class="hash-link" aria-label="21.6. æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“çš„ç›´æ¥é“¾æ¥" title="21.6. æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/rust-gamedev/arewegameyet" target="_blank" rel="noopener noreferrer">https://github.com/rust-gamedev/arewegameyet</a></p><p>bevy</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="217-ç³»ç»Ÿä¿¡æ¯">21.7. ç³»ç»Ÿä¿¡æ¯<a href="#217-ç³»ç»Ÿä¿¡æ¯" class="hash-link" aria-label="21.7. ç³»ç»Ÿä¿¡æ¯çš„ç›´æ¥é“¾æ¥" title="21.7. ç³»ç»Ÿä¿¡æ¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/GuillaumeGomez/sysinfo" target="_blank" rel="noopener noreferrer">https://github.com/GuillaumeGomez/sysinfo</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="218-web-å¼€å‘å‘">21.8. web å¼€å‘å‘<a href="#218-web-å¼€å‘å‘" class="hash-link" aria-label="21.8. web å¼€å‘å‘çš„ç›´æ¥é“¾æ¥" title="21.8. web å¼€å‘å‘çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2181-swagger-openapi-ç”Ÿæˆ">21.8.1. swagger openapi ç”Ÿæˆ<a href="#2181-swagger-openapi-ç”Ÿæˆ" class="hash-link" aria-label="21.8.1. swagger openapi ç”Ÿæˆçš„ç›´æ¥é“¾æ¥" title="21.8.1. swagger openapi ç”Ÿæˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://github.com/GREsau/okapi" target="_blank" rel="noopener noreferrer">https://github.com/GREsau/okapi</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2182-webæ¡†æ¶">21.8.2. webæ¡†æ¶<a href="#2182-webæ¡†æ¶" class="hash-link" aria-label="21.8.2. webæ¡†æ¶çš„ç›´æ¥é“¾æ¥" title="21.8.2. webæ¡†æ¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://hardocs.com/d/rustprimer/quickstart/quickstart.html" target="_blank" rel="noopener noreferrer">https://hardocs.com/d/rustprimer/quickstart/quickstart.html</a></p><p><a href="https://www.arewewebyet.org/" target="_blank" rel="noopener noreferrer">https://www.arewewebyet.org/</a></p><p>rocket <a href="https://rocket.rs/" target="_blank" rel="noopener noreferrer">https://rocket.rs/</a></p><p><a href="https://github.com/actix/actix-web" target="_blank" rel="noopener noreferrer">https://github.com/actix/actix-web</a></p><p>tiny_http</p><p>warp</p><p><a href="https://github.com/yewstack/yew" target="_blank" rel="noopener noreferrer">https://github.com/yewstack/yew</a> ä½¿ç”¨ jsx è¯­æ³•å†™ wasm</p><p>å¯¹æ¯”é€‰å‹ <a href="http://jiagoushi.pro/book/export/html/334" target="_blank" rel="noopener noreferrer">http://jiagoushi.pro/book/export/html/334</a></p><p>Zola é™æ€ç½‘ç«™</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2183-orm">21.8.3. orm<a href="#2183-orm" class="hash-link" aria-label="21.8.3. ormçš„ç›´æ¥é“¾æ¥" title="21.8.3. ormçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Diesel ORM</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2184-http-client">21.8.4. http client<a href="#2184-http-client" class="hash-link" aria-label="21.8.4. http clientçš„ç›´æ¥é“¾æ¥" title="21.8.4. http clientçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>http - HTTPæ ‡å‡†ç›¸å…³çš„åŸºç¡€ç±»å‹ï¼Œå¦‚<code>Request&lt;T&gt; ã€Response&lt;T&gt;</code>ä»¥åŠStatusCodeå’Œå¸¸ç”¨çš„Header</p><p>hyper -  HTTPåº•å±‚åº“ï¼Œå®ƒå°è£…äº†HTTPçš„æŠ¥æ–‡è§£æã€æŠ¥æ–‡ç¼–ç å¤„ç†ã€è¿æ¥æ§åˆ¶</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="219-åºåˆ—åŒ–ååºåˆ—åŒ–">21.9. åºåˆ—åŒ–ååºåˆ—åŒ–<a href="#219-åºåˆ—åŒ–ååºåˆ—åŒ–" class="hash-link" aria-label="21.9. åºåˆ—åŒ–ååºåˆ—åŒ–çš„ç›´æ¥é“¾æ¥" title="21.9. åºåˆ—åŒ–ååºåˆ—åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2191-toml">21.9.1. toml<a href="#2191-toml" class="hash-link" aria-label="21.9.1. tomlçš„ç›´æ¥é“¾æ¥" title="21.9.1. tomlçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::env::args;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let config = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let config_path = args().nth(1).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let content = std::fs::read_to_string(config_path).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        content.parse::&lt;toml::Value&gt;().unwrap()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:#?}&quot;, config);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // let tbl = config.as_table().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let input = config.get(&quot;input&quot;).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:#?}&quot;, input);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let json_file = input.get(&quot;json_file&quot;).unwrap().as_str().unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:#?}&quot;, json_file);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2192-json">21.9.2. json<a href="#2192-json" class="hash-link" aria-label="21.9.2. jsonçš„ç›´æ¥é“¾æ¥" title="21.9.2. jsonçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>serde_json æ˜¯åŸºäº serde å®ç°çš„</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2110-è¯»å†™æ•°æ®">21.10. è¯»å†™æ•°æ®<a href="#2110-è¯»å†™æ•°æ®" class="hash-link" aria-label="21.10. è¯»å†™æ•°æ®çš„ç›´æ¥é“¾æ¥" title="21.10. è¯»å†™æ•°æ®çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>bytes</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2111-å¢å¼ºå·¥å…·">21.11. å¢å¼ºå·¥å…·<a href="#2111-å¢å¼ºå·¥å…·" class="hash-link" aria-label="21.11. å¢å¼ºå·¥å…·çš„ç›´æ¥é“¾æ¥" title="21.11. å¢å¼ºå·¥å…·çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>itertools</p><p>time</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2112-æˆæƒ-authorization">21.12. æˆæƒ Authorization<a href="#2112-æˆæƒ-authorization" class="hash-link" aria-label="21.12. æˆæƒ Authorizationçš„ç›´æ¥é“¾æ¥" title="21.12. æˆæƒ Authorizationçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>oso</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2113-æ—¥å¿—ç³»ç»Ÿ">21.13. æ—¥å¿—ç³»ç»Ÿ<a href="#2113-æ—¥å¿—ç³»ç»Ÿ" class="hash-link" aria-label="21.13. æ—¥å¿—ç³»ç»Ÿçš„ç›´æ¥é“¾æ¥" title="21.13. æ—¥å¿—ç³»ç»Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ—¥å¿— <a href="https://segmentfault.com/a/1190000021681959" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000021681959</a></p><p>log æä¾› api, å¦‚æœåªæ˜¯å¼€å‘ä¸€ä¸ª lib , æ— éœ€å¯¼å…¥å®ç°, å¦‚æœæ˜¯åœ¨ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºé‡Œ, å¿…é¡»æœ‰å®ç°æ‰èƒ½æ‰“å°</p><p>å…·ä½“å®ç°æœ‰å¤šç§</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21131-tracing">21.13.1. tracing<a href="#21131-tracing" class="hash-link" aria-label="21.13.1. tracingçš„ç›´æ¥é“¾æ¥" title="21.13.1. tracingçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ—¥å¿— è¿½è¸ª</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21132-env_logger">21.13.2. env_logger<a href="#21132-env_logger" class="hash-link" aria-label="21.13.2. env_loggerçš„ç›´æ¥é“¾æ¥" title="21.13.2. env_loggerçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><code>RUST_LOG=info ./bin_file</code></p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#[macro_use]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">extern crate log;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    env_logger::init();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    debug!(&quot;debug&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    info!(&quot;info&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    warn!(&quot;warn&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    trace!(&quot;trace&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    error!(&quot;error&quot;); // default</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21133-log4rs-and-log">21.13.3. log4rs and log<a href="#21133-log4rs-and-log" class="hash-link" aria-label="21.13.3. log4rs and logçš„ç›´æ¥é“¾æ¥" title="21.13.3. log4rs and logçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-t codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-t codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">log = &quot;0.4.11&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">log4rs = &quot;0.13.0&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>log4rs.yml</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">refresh_rate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> 30 seconds</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">appenders</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">stdout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> console</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">requests</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> file</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;log/requests.log&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># ç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">encoder</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">pattern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{d} - {m}{n}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">root</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">level</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> debug</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">appenders</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> stdout</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#loggers:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#  app::backend::db:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#    level: info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#  app::requests:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#    level: info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#    appenders:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#      - requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#    additive: false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let log_file = &quot;config/log4rs.yml&quot;; // ç›¸å¯¹äº é¡¹ç›®æ ¹ç›®å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    log4rs::init_file(log_file, Default::default()).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    debug!(&quot;&gt;&gt;&gt; load log config file: {}&quot;, log_file);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let listener = TcpListener::bind(&quot;127.0.0.1:8090&quot;).unwrap();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    info!(&quot;visit ==&gt; http://127.0.0.1:8090&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2114-æ–‡æœ¬è§£æå™¨-parser">21.14. æ–‡æœ¬è§£æå™¨ parser<a href="#2114-æ–‡æœ¬è§£æå™¨-parser" class="hash-link" aria-label="21.14. æ–‡æœ¬è§£æå™¨ parserçš„ç›´æ¥é“¾æ¥" title="21.14. æ–‡æœ¬è§£æå™¨ parserçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/Geal/nom" target="_blank" rel="noopener noreferrer">https://github.com/Geal/nom</a>
<a href="https://zhuanlan.zhihu.com/p/115017849" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/115017849</a></p><p>pest</p><p>pom</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2115-lazy-static-å»¶è¿Ÿåˆå§‹åŒ–">21.15. lazy static å»¶è¿Ÿåˆå§‹åŒ–<a href="#2115-lazy-static-å»¶è¿Ÿåˆå§‹åŒ–" class="hash-link" aria-label="21.15. lazy static å»¶è¿Ÿåˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥" title="21.15. lazy static å»¶è¿Ÿåˆå§‹åŒ–çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å¯ä»¥æŠŠå®šä¹‰å…¨å±€é™æ€å˜é‡å»¶è¿Ÿåˆ°è¿è¡Œæ—¶ï¼Œè€Œéç¼–è¯‘æ—¶</p><p>åœ¨è¿è¡Œæ—¶åˆå§‹åŒ–é™æ€å˜é‡, å³é™æ€å˜é‡å»¶è¿Ÿåˆå§‹åŒ–</p><p>ä¾‹å¦‚, æŸäº›é™æ€å˜é‡ç”±å‘½ä»¤è¡Œå‚æ•°å†³å®š, å¾—ç­‰åˆ°è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šé™æ€å˜é‡</p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::collections::HashMap;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use lazy_static::lazy_static;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// #[macro_use]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">// extern crate lazy_static;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">lazy_static! {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    static ref HASH_MAP: HashMap&lt;u32, &amp;&#x27;static str&gt; = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        let mut m = HashMap::new();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        m.insert(1, &quot;hello&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        m.insert(2, &quot;world&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;hash map init&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        m</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, HASH_MAP.get(&amp;1).unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    print!(&quot;{}&quot;, HASH_MAP.get(&amp;2).unwrap());</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2116-ç”µå­ä¹¦">21.16. ç”µå­ä¹¦<a href="#2116-ç”µå­ä¹¦" class="hash-link" aria-label="21.16. ç”µå­ä¹¦çš„ç›´æ¥é“¾æ¥" title="21.16. ç”µå­ä¹¦çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>mdBook ç”Ÿæˆç”µå­ä¹¦</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2117-å‘½ä»¤è¡Œç¨‹åº">21.17. å‘½ä»¤è¡Œç¨‹åº<a href="#2117-å‘½ä»¤è¡Œç¨‹åº" class="hash-link" aria-label="21.17. å‘½ä»¤è¡Œç¨‹åºçš„ç›´æ¥é“¾æ¥" title="21.17. å‘½ä»¤è¡Œç¨‹åºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>indicatif è¿›åº¦æ¡</p><p>clap å‘½ä»¤è¡Œå‚æ•°è§£æ</p><p>å€ŸåŠ©ç¬¬ä¸‰æ–¹è§£æåº“:</p><p><a href="https://rust-cli.github.io/book/tutorial/cli-args.html" target="_blank" rel="noopener noreferrer">https://rust-cli.github.io/book/tutorial/cli-args.html</a>
<a href="http://llever.com/cli-wg-zh/tutorial/cli-args.zh.html" target="_blank" rel="noopener noreferrer">http://llever.com/cli-wg-zh/tutorial/cli-args.zh.html</a></p><p><a href="https://github.com/rust-cli" target="_blank" rel="noopener noreferrer">https://github.com/rust-cli</a></p><p>ansi_term å½©è‰²è¾“å‡º</p><p><a href="https://github.com/fdehau/tui-rs" target="_blank" rel="noopener noreferrer">https://github.com/fdehau/tui-rs</a></p><p><a href="https://github.com/cjbassi/ytop" target="_blank" rel="noopener noreferrer">https://github.com/cjbassi/ytop</a> å‘½ä»¤è¡Œç³»ç»Ÿç›‘æ§ç¨‹åº</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21171-structopt">21.17.1. structopt<a href="#21171-structopt" class="hash-link" aria-label="21.17.1. structoptçš„ç›´æ¥é“¾æ¥" title="21.17.1. structoptçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ•´åˆ clap, å°†å‚æ•°ç›´æ¥è§£æä¸º struct, æ›´åŠ æ–¹ä¾¿ </p><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use std::path::PathBuf;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use structopt::StructOpt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[derive(StructOpt, Debug)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#[structopt(name = &quot;basic&quot;)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">struct Opt {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // ä¸æŒ‡å®š short long, ä¼šä½¿ç”¨ field name</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[structopt(short = &quot;v&quot;, long)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    verbose: bool,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[structopt(short = &quot;r&quot;, long = &quot;result&quot;, parse(from_os_str))]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    result: PathBuf,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #[structopt(parse(from_os_str))]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files: Vec&lt;PathBuf&gt;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // result this cmd: cargo run input.txt input2.txt -v --result res.xy</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let opt = Opt::from_args();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{:#?}&quot;, opt);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21172-clap">21.17.2. clap<a href="#21172-clap" class="hash-link" aria-label="21.17.2. clapçš„ç›´æ¥é“¾æ¥" title="21.17.2. clapçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>åŠŸèƒ½å¼ºå¤§, ä½¿ç”¨ä¸å¤Ÿç®€å•</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2118-å¼‚æ­¥ç¼–ç¨‹">21.18. å¼‚æ­¥ç¼–ç¨‹<a href="#2118-å¼‚æ­¥ç¼–ç¨‹" class="hash-link" aria-label="21.18. å¼‚æ­¥ç¼–ç¨‹çš„ç›´æ¥é“¾æ¥" title="21.18. å¼‚æ­¥ç¼–ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>tokio</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2119-websocket">21.19. websocket<a href="#2119-websocket" class="hash-link" aria-label="21.19. websocketçš„ç›´æ¥é“¾æ¥" title="21.19. websocketçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/websockets-rs/rust-websocket" target="_blank" rel="noopener noreferrer">https://github.com/websockets-rs/rust-websocket</a></p><p>wsl ä¸­å¯èƒ½ build å¤±è´¥, å¦‚ä¸‹è§£å†³:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">apt install -y openssl</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">apt install -y libssl-dev</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">apt install -y pkg-config</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2120-ç¼©å°ä½“ç§¯">21.20. ç¼©å°ä½“ç§¯<a href="#2120-ç¼©å°ä½“ç§¯" class="hash-link" aria-label="21.20. ç¼©å°ä½“ç§¯çš„ç›´æ¥é“¾æ¥" title="21.20. ç¼©å°ä½“ç§¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>cargo-bloat</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2121-http-client">21.21. http client<a href="#2121-http-client" class="hash-link" aria-label="21.21. http clientçš„ç›´æ¥é“¾æ¥" title="21.21. http clientçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>chttp</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2122-å®¹é”™è¿è¡Œæ—¶">21.22. å®¹é”™è¿è¡Œæ—¶<a href="#2122-å®¹é”™è¿è¡Œæ—¶" class="hash-link" aria-label="21.22. å®¹é”™è¿è¡Œæ—¶çš„ç›´æ¥é“¾æ¥" title="21.22. å®¹é”™è¿è¡Œæ—¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>bastion</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2123-ç›‘æ§">21.23. ç›‘æ§<a href="#2123-ç›‘æ§" class="hash-link" aria-label="21.23. ç›‘æ§çš„ç›´æ¥é“¾æ¥" title="21.23. ç›‘æ§çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>sentry é”™è¯¯ç›‘æ§</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2124-ç”µå­é‚®ä»¶">21.24. ç”µå­é‚®ä»¶<a href="#2124-ç”µå­é‚®ä»¶" class="hash-link" aria-label="21.24. ç”µå­é‚®ä»¶çš„ç›´æ¥é“¾æ¥" title="21.24. ç”µå­é‚®ä»¶çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>tera</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2125-åˆ†å‘å·¥å…·">21.25. åˆ†å‘å·¥å…·<a href="#2125-åˆ†å‘å·¥å…·" class="hash-link" aria-label="21.25. åˆ†å‘å·¥å…·çš„ç›´æ¥é“¾æ¥" title="21.25. åˆ†å‘å·¥å…·çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Cargo-release</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2126-å¹¶å‘ç¼–ç¨‹">21.26. å¹¶å‘ç¼–ç¨‹<a href="#2126-å¹¶å‘ç¼–ç¨‹" class="hash-link" aria-label="21.26. å¹¶å‘ç¼–ç¨‹çš„ç›´æ¥é“¾æ¥" title="21.26. å¹¶å‘ç¼–ç¨‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/crossbeam-rs/crossbeam" target="_blank" rel="noopener noreferrer">https://github.com/crossbeam-rs/crossbeam</a></p><p>Rayon å¹¶è¡Œæµ</p><p>dashmap</p><p>parking_lot</p><p>crossbeam</p><p>flume</p><p>rsRust</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2127-gui-å›¾å½¢åº“">21.27. gui å›¾å½¢åº“<a href="#2127-gui-å›¾å½¢åº“" class="hash-link" aria-label="21.27. gui å›¾å½¢åº“çš„ç›´æ¥é“¾æ¥" title="21.27. gui å›¾å½¢åº“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/PistonDevelopers/conrod" target="_blank" rel="noopener noreferrer">https://github.com/PistonDevelopers/conrod</a> 2d</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2128-åº•å±‚ç½‘ç»œ-api">21.28. åº•å±‚ç½‘ç»œ api<a href="#2128-åº•å±‚ç½‘ç»œ-api" class="hash-link" aria-label="21.28. åº•å±‚ç½‘ç»œ apiçš„ç›´æ¥é“¾æ¥" title="21.28. åº•å±‚ç½‘ç»œ apiçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>libpnet, å¦‚ <code>pnet = &quot;0.25.0&quot;</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2129-æ­£åˆ™">21.29. æ­£åˆ™<a href="#2129-æ­£åˆ™" class="hash-link" aria-label="21.29. æ­£åˆ™çš„ç›´æ¥é“¾æ¥" title="21.29. æ­£åˆ™çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ul><li>regex å®˜æ–¹å®ç°, ä¸æ”¯æŒç¯è§† ( look-around ) å’Œ åå‘å¼•ç”¨ ( backreference)</li><li>fancy-regex , æ”¯æŒ æ”¯æŒç¯è§† ( look-around ) å’Œ åå‘å¼•ç”¨ ( backreference)</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2130-éšæœº">21.30. éšæœº<a href="#2130-éšæœº" class="hash-link" aria-label="21.30. éšæœºçš„ç›´æ¥é“¾æ¥" title="21.30. éšæœºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21301-rand-éšæœºæ•°å­—">21.30.1. rand éšæœºæ•°å­—<a href="#21301-rand-éšæœºæ•°å­—" class="hash-link" aria-label="21.30.1. rand éšæœºæ•°å­—çš„ç›´æ¥é“¾æ¥" title="21.30.1. rand éšæœºæ•°å­—çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-rs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use rand::prelude::*;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let mut rng = rand::thread_rng();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let i = rng.gen_range(0..3); // 0/1/2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;{}&quot;, i);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    // let s: &amp;str = rng.gen();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let boo = rng.gen::&lt;bool&gt;();</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    println!(&quot;bool true from gen() : {}&quot;, boo);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    let rate = rng.gen_ratio(1, 2);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    if rng.gen_bool(1.0 / 2.0) {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;percent of true&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    if rng.gen() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;bool from gen() without turbofish&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    if rand::random() {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        println!(&quot;rand bool from random()&quot;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2131-æœç´¢å¼•æ“">21.31. æœç´¢å¼•æ“<a href="#2131-æœç´¢å¼•æ“" class="hash-link" aria-label="21.31. æœç´¢å¼•æ“çš„ç›´æ¥é“¾æ¥" title="21.31. æœç´¢å¼•æ“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/valeriansaliou/sonic" target="_blank" rel="noopener noreferrer">https://github.com/valeriansaliou/sonic</a>
<a href="https://github.com/tantivy-search/tantivy" target="_blank" rel="noopener noreferrer">https://github.com/tantivy-search/tantivy</a>
<a href="https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine/" target="_blank" rel="noopener noreferrer">https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine/</a> å®ç°åŸç†</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2132-å¼€æºé›†åˆå®¹å™¨">21.32. å¼€æºé›†åˆå®¹å™¨<a href="#2132-å¼€æºé›†åˆå®¹å™¨" class="hash-link" aria-label="21.32. å¼€æºé›†åˆå®¹å™¨çš„ç›´æ¥é“¾æ¥" title="21.32. å¼€æºé›†åˆå®¹å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/jonhoo/flurry" target="_blank" rel="noopener noreferrer">https://github.com/jonhoo/flurry</a>  A port of Java&#x27;s ConcurrentHashMap to Rust</p><h1>22. å¼€æºé¡¹ç›®</h1><p><a href="https://zhuanlan.zhihu.com/p/62325234" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/62325234</a>
<a href="https://zhuanlan.zhihu.com/p/139180791" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/139180791</a>
<a href="https://www.zhihu.com/question/30511494" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/30511494</a></p><h1>23. å‚è€ƒé“¾æ¥</h1><p><a href="https://fasterthanli.me/articles/a-half-hour-to-learn-rust" target="_blank" rel="noopener noreferrer">https://fasterthanli.me/articles/a-half-hour-to-learn-rust</a></p><p>libp2p<br>
<!-- -->æ˜¯ç”¨äºæ„å»ºP2Pç½‘ç»œçš„æ¨¡å—åŒ–ç½‘ç»œå †æ ˆå’Œåº“ï¼Œæºè‡ªå¼€æºé¡¹ç›®IPFSï¼Œæ¨¡å—åŒ–è®¾è®¡ä½¿å®ƒèƒ½å¤Ÿç”¨æ¥æ„å»ºå„ç§å»ä¸­å¿ƒåŒ–åº”ç”¨çš„P2Pç½‘ç»œå±‚ã€‚ç›®å‰ï¼ŒçŸ¥ååŒºå—é“¾é¡¹ç›®Ethereum 2.0ã€Pokdotã€BitXHubéƒ½é€‰æ‹©åŸºäºLibp2påº“æ­å»ºç³»ç»Ÿç½‘ç»œå±‚ã€‚</p><p><a href="https://github.com/WumaCoder/rust-boom" target="_blank" rel="noopener noreferrer">https://github.com/WumaCoder/rust-boom</a></p><p><a href="https://github.com/rustlang-cn/rusty-book" target="_blank" rel="noopener noreferrer">https://github.com/rustlang-cn/rusty-book</a> å¼€æºåº“</p><p><a href="https://github.com/search?q=algorithm+language%3ARust&amp;type=Repositories&amp;ref=advsearch&amp;l=Rust&amp;l=" target="_blank" rel="noopener noreferrer">https://github.com/search?q=algorithm+language%3ARust&amp;type=Repositories&amp;ref=advsearch&amp;l=Rust&amp;l=</a> ç®—æ³•</p><p><a href="https://github.com/rust-unofficial/patterns" target="_blank" rel="noopener noreferrer">https://github.com/rust-unofficial/patterns</a> è§„èŒƒ</p><p><a href="https://github.com/lapce/lapce" target="_blank" rel="noopener noreferrer">https://github.com/lapce/lapce</a> ç¼–è¾‘å™¨, ui</p><p><a href="https://github.com/develon2015/dnsd" target="_blank" rel="noopener noreferrer">https://github.com/develon2015/dnsd</a>
<a href="https://github.com/develon2015/remote_bind" target="_blank" rel="noopener noreferrer">https://github.com/develon2015/remote_bind</a>
<a href="https://github.com/ppbl/scicode" target="_blank" rel="noopener noreferrer">https://github.com/ppbl/scicode</a> yew+actix</p><p><a href="https://jasonkayzk.github.io/2022/02/20/%E4%BD%BF%E7%94%A8Rust%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8/" target="_blank" rel="noopener noreferrer">https://jasonkayzk.github.io/2022/02/20/%E4%BD%BF%E7%94%A8Rust%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8/</a> åŒå‘é“¾è¡¨</p><p><a href="https://github.com/bitlabx/cherry" target="_blank" rel="noopener noreferrer">https://github.com/bitlabx/cherry</a> orm</p><p><a href="https://github.com/mini-lust/tutorials" target="_blank" rel="noopener noreferrer">https://github.com/mini-lust/tutorials</a> æ‰‹æŠŠæ‰‹åŠ¨æ‰‹å®ç° rpc</p><p><a href="https://rust-cli.github.io/book/index.html" target="_blank" rel="noopener noreferrer">https://rust-cli.github.io/book/index.html</a> å‘½ä»¤è¡Œ</p><p><a href="https://github.com/wisespace-io/binance-rs" target="_blank" rel="noopener noreferrer">https://github.com/wisespace-io/binance-rs</a></p><p><a href="https://www.youtube.com/watch?v=qyRIkcdRfRg&amp;t=974s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=qyRIkcdRfRg&amp;t=974s</a> ä¼ä¸šçº§å¼€å‘æœ€ä½³å®è·µ
<a href="https://www.youtube.com/watch?v=36_TiWriqQ4" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=36_TiWriqQ4</a> rust and webasembly</p><p><a href="https://course.rs/about-book.html" target="_blank" rel="noopener noreferrer">https://course.rs/about-book.html</a></p><p><a href="https://github.com/sunface/rust-course" target="_blank" rel="noopener noreferrer">https://github.com/sunface/rust-course</a></p><p><a href="https://books.budshome.com/" target="_blank" rel="noopener noreferrer">https://books.budshome.com/</a></p><p><a href="https://github.com/sunface/rust-course" target="_blank" rel="noopener noreferrer">https://github.com/sunface/rust-course</a></p><p><a href="https://github.com/0voice/Understanding_in_Rust" target="_blank" rel="noopener noreferrer">https://github.com/0voice/Understanding_in_Rust</a></p><p><a href="https://github.com/KernelErr/awesome-rust-zh" target="_blank" rel="noopener noreferrer">https://github.com/KernelErr/awesome-rust-zh</a>
<a href="https://github.com/studyrs/fancy-rust" target="_blank" rel="noopener noreferrer">https://github.com/studyrs/fancy-rust</a>
<a href="https://github.com/TaKO8Ki/awesome-alternatives-in-rust" target="_blank" rel="noopener noreferrer">https://github.com/TaKO8Ki/awesome-alternatives-in-rust</a></p><p><a href="https://github.com/pingcap/talent-plan" target="_blank" rel="noopener noreferrer">https://github.com/pingcap/talent-plan</a> è¯¾ç¨‹</p><p><a href="https://github.com/meilisearch/MeiliSearch" target="_blank" rel="noopener noreferrer">https://github.com/meilisearch/MeiliSearch</a> æœç´¢å¼•æ“, ç±»ä¼¼ algolia, ä¸è¿‡æ˜¯å¼€æºçš„</p><p><a href="https://docs.rs/" target="_blank" rel="noopener noreferrer">https://docs.rs/</a>  cates api æ–‡æ¡£
<a href="https://crates.io/" target="_blank" rel="noopener noreferrer">https://crates.io/</a> crates æœç´¢</p><p><a href="https://github.com/pretzelhammer/rust-blog" target="_blank" rel="noopener noreferrer">https://github.com/pretzelhammer/rust-blog</a></p><p><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials" target="_blank" rel="noopener noreferrer">https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials</a> åœ¨æ ‘è“æ´¾ä¸Šå®ç°æ“ä½œç³»ç»Ÿ</p><p><a href="https://github.com/mre/idiomatic-rust" target="_blank" rel="noopener noreferrer">https://github.com/mre/idiomatic-rust</a> æœ€ä½³å®è·µ
<a href="https://github.com/ctjhoa/rust-learning" target="_blank" rel="noopener noreferrer">https://github.com/ctjhoa/rust-learning</a></p><p><a href="https://github.com/sassman/t-rec-rs" target="_blank" rel="noopener noreferrer">https://github.com/sassman/t-rec-rs</a> ç»ˆç«¯è®°å½•å·¥å…· å½•åˆ¶ gif</p><p><a href="https://github.com/wtklbm/crm" target="_blank" rel="noopener noreferrer">https://github.com/wtklbm/crm</a> ç®€å•é¡¹ç›® é•œåƒæºåˆ‡æ¢</p><p><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials" target="_blank" rel="noopener noreferrer">https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials</a> åµŒå…¥å¼ os å†…æ ¸ å¼€å‘</p><p><a href="https://folyd.com/blog/" target="_blank" rel="noopener noreferrer">https://folyd.com/blog/</a> Rustçš„Pinä¸Unpin</p><p><a href="https://github.com/ajmwagar" target="_blank" rel="noopener noreferrer">https://github.com/ajmwagar</a> rust å°é¡¹ç›®
<a href="https://github.com/kilerd" target="_blank" rel="noopener noreferrer">https://github.com/kilerd</a>
<a href="https://github.com/ramsayleung" target="_blank" rel="noopener noreferrer">https://github.com/ramsayleung</a></p><p><a href="https://github.com/warycat/rustgym" target="_blank" rel="noopener noreferrer">https://github.com/warycat/rustgym</a> ç®—æ³•
<a href="https://github.com/aylei/leetcode-rust" target="_blank" rel="noopener noreferrer">https://github.com/aylei/leetcode-rust</a> ç®—æ³•å®ç°
<a href="https://github.com/sunface/rust-algos" target="_blank" rel="noopener noreferrer">https://github.com/sunface/rust-algos</a>
<a href="https://github.com/dxx/datastructure-algorithm" target="_blank" rel="noopener noreferrer">https://github.com/dxx/datastructure-algorithm</a></p><p><a href="https://github.com/rust-unofficial/awesome-rust" target="_blank" rel="noopener noreferrer">https://github.com/rust-unofficial/awesome-rust</a>
<a href="https://github.com/rust-lang-nursery/rust-cookbook" target="_blank" rel="noopener noreferrer">https://github.com/rust-lang-nursery/rust-cookbook</a></p><p><a href="https://play.integer32.com/" target="_blank" rel="noopener noreferrer">https://play.integer32.com/</a>
<a href="https://play.rust-lang.org/" target="_blank" rel="noopener noreferrer">https://play.rust-lang.org/</a></p><p><a href="https://rust-unofficial.github.io/patterns/" target="_blank" rel="noopener noreferrer">https://rust-unofficial.github.io/patterns/</a> è®¾è®¡æ¨¡å¼</p><p><a href="https://www.rust-lang.org/" target="_blank" rel="noopener noreferrer">https://www.rust-lang.org/</a> å®˜æ–¹ç«™</p><p><a href="https://www.zhihu.com/question/31038569" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/31038569</a> å¦‚ä½•å­¦</p><p><a href="https://users.rust-lang.org/" target="_blank" rel="noopener noreferrer">https://users.rust-lang.org/</a> ç¤¾åŒº
<a href="https://rustcc.cn/" target="_blank" rel="noopener noreferrer">https://rustcc.cn/</a> ä¸­æ–‡ç¤¾åŒº</p><p><a href="https://doc.rust-lang.org/std/" target="_blank" rel="noopener noreferrer">https://doc.rust-lang.org/std/</a> std api</p><p><a href="https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html" target="_blank" rel="noopener noreferrer">https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html</a> the book æ‰‹å†Œ
<a href="https://kaisery.github.io/trpl-zh-cn/title-page.html" target="_blank" rel="noopener noreferrer">https://kaisery.github.io/trpl-zh-cn/title-page.html</a> the book ç¿»è¯‘
<a href="https://course.rs/into-rust.html" target="_blank" rel="noopener noreferrer">https://course.rs/into-rust.html</a>
<a href="https://rust-by-example.budshome.com/" target="_blank" rel="noopener noreferrer">https://rust-by-example.budshome.com/</a></p><p><a href="https://github.com/rust-lang/nomicon" target="_blank" rel="noopener noreferrer">https://github.com/rust-lang/nomicon</a> æ­»çµä¹¦ è®¾è®¡åŸç†</p><p><a href="https://doc.rust-lang.org/stable/reference/introduction.html" target="_blank" rel="noopener noreferrer">https://doc.rust-lang.org/stable/reference/introduction.html</a></p><p><a href="https://doc.rust-lang.org/stable/rust-by-example/macros/dsl.html" target="_blank" rel="noopener noreferrer">https://doc.rust-lang.org/stable/rust-by-example/macros/dsl.html</a> example
<a href="https://books.budshome.com/rust-by-example/testing/unit_testing.html" target="_blank" rel="noopener noreferrer">https://books.budshome.com/rust-by-example/testing/unit_testing.html</a> ä¸­æ–‡</p><p><a href="https://rust-unofficial.github.io/too-many-lists/" target="_blank" rel="noopener noreferrer">https://rust-unofficial.github.io/too-many-lists/</a> another tutorial
<a href="https://github.com/rust-unofficial/too-many-lists" target="_blank" rel="noopener noreferrer">https://github.com/rust-unofficial/too-many-lists</a></p><p><a href="https://cheats.rs/#data-structures" target="_blank" rel="noopener noreferrer">https://cheats.rs/#data-structures</a> é€ŸæŸ¥è¡¨ cheatsheet</p><p><a href="https://doc.rust-lang.org/cargo/index.html" target="_blank" rel="noopener noreferrer">https://doc.rust-lang.org/cargo/index.html</a> cargo book
<a href="https://cargo.budshome.com/index.html" target="_blank" rel="noopener noreferrer">https://cargo.budshome.com/index.html</a></p><p><a href="https://github.com/chinanf-boy?tab=stars" target="_blank" rel="noopener noreferrer">https://github.com/chinanf-boy?tab=stars</a> - çˆ±å¥½è€…
<a href="https://github.com/AurevoirXavier" target="_blank" rel="noopener noreferrer">https://github.com/AurevoirXavier</a> - çˆ±å¥½è€…
<a href="https://github.com/BurntSushi" target="_blank" rel="noopener noreferrer">https://github.com/BurntSushi</a> - master
<a href="https://github.com/mre" target="_blank" rel="noopener noreferrer">https://github.com/mre</a> master
<a href="https://github.com/rust-lang" target="_blank" rel="noopener noreferrer">https://github.com/rust-lang</a> å®˜æ–¹GitHub</p><p><a href="http://intorust.com/" target="_blank" rel="noopener noreferrer">http://intorust.com/</a> åŠ¨ç”»ä»‹ç»</p><p><a href="https://zhuanlan.zhihu.com/c_208092758/" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/c_208092758/</a> çŸ¥ä¹ä¸“æ 
<a href="https://zhuanlan.zhihu.com/c_118514498" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/c_118514498</a></p><p><a href="https://github.com/phil-opp/blog_os" target="_blank" rel="noopener noreferrer">https://github.com/phil-opp/blog_os</a> rust å®ç°os</p><p><a href="https://github.com/Kilerd/resource" target="_blank" rel="noopener noreferrer">https://github.com/Kilerd/resource</a> - ä¸­æ–‡èµ„æ–™æ”¶é›†
<a href="https://zhuanlan.zhihu.com/rust-lang" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/rust-lang</a>
<a href="https://wiki.jikexueyuan.com/project/rust-primer/concurrency-parallel-thread/thread.html" target="_blank" rel="noopener noreferrer">https://wiki.jikexueyuan.com/project/rust-primer/concurrency-parallel-thread/thread.html</a></p><p><a href="https://www.zhihu.com/question/382172347/answer/1103525234" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/382172347/answer/1103525234</a> tips
<a href="https://www.zhihu.com/question/393796866/answer/1213171124" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/393796866/answer/1213171124</a></p><p><a href="https://www.zhihu.com/question/30407715/answer/48032883" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/30407715/answer/48032883</a></p><p><a href="https://www.zhihu.com/question/34665842?sort=created" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/34665842?sort=created</a> ç»ƒæ‰‹
<a href="https://www.zhihu.com/question/352420716/answer/973279231" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/352420716/answer/973279231</a></p><p><a href="https://www.zhihu.com/question/30511494/answer/649921526" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/30511494/answer/649921526</a> å€¼å¾—å…³æ³¨</p><p><a href="https://github.com/rajasekarv/vega" target="_blank" rel="noopener noreferrer">https://github.com/rajasekarv/vega</a> spark æ›¿ä»£</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/rust">rust</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£åˆ†é¡µå¯¼èˆª"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/regex"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">Regular Expression æ­£åˆ™ğŸŒˆ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/saas-paas-iaas-as-a-service"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">SaaS Intro</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#11-pros-and-cons" class="table-of-contents__link toc-highlight">1.1. Pros and Cons</a></li><li><a href="#12-æ¶æ„" class="table-of-contents__link toc-highlight">1.2. æ¶æ„</a></li><li><a href="#13-ä¼˜ç‚¹-å¯¹æ¯”" class="table-of-contents__link toc-highlight">1.3. ä¼˜ç‚¹ å¯¹æ¯”</a></li><li><a href="#14-æ€æƒ³" class="table-of-contents__link toc-highlight">1.4. æ€æƒ³</a></li><li><a href="#15-è¯­ä¹‰-æ¦‚å¿µ" class="table-of-contents__link toc-highlight">1.5. è¯­ä¹‰ æ¦‚å¿µ</a></li><li><a href="#21-install" class="table-of-contents__link toc-highlight">2.1. install</a></li><li><a href="#22-å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨" class="table-of-contents__link toc-highlight">2.2. å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨</a></li><li><a href="#23-ide" class="table-of-contents__link toc-highlight">2.3. IDE</a></li><li><a href="#24-é…ç½®å›½å†…é•œåƒ" class="table-of-contents__link toc-highlight">2.4. é…ç½®å›½å†…é•œåƒ</a></li><li><a href="#31-path-è·¯å¾„" class="table-of-contents__link toc-highlight">3.1. path è·¯å¾„</a></li><li><a href="#32-æ—¶é—´" class="table-of-contents__link toc-highlight">3.2. æ—¶é—´</a></li><li><a href="#41-nll" class="table-of-contents__link toc-highlight">4.1. nll</a></li><li><a href="#42-raw-identifier" class="table-of-contents__link toc-highlight">4.2. Raw identifier</a></li><li><a href="#43-ç®€åŒ–æ¨¡å¼åŒ¹é…" class="table-of-contents__link toc-highlight">4.3. ç®€åŒ–æ¨¡å¼åŒ¹é…</a></li><li><a href="#44-main-å‡½æ•°å¯ä»¥è¿”å›-result" class="table-of-contents__link toc-highlight">4.4. main å‡½æ•°å¯ä»¥è¿”å› Result</a></li><li><a href="#45-impl-trait-æŠ½è±¡ç±»å‹" class="table-of-contents__link toc-highlight">4.5. impl trait æŠ½è±¡ç±»å‹</a></li><li><a href="#51-æ³¨é‡Š" class="table-of-contents__link toc-highlight">5.1. æ³¨é‡Š</a></li><li><a href="#52-å˜é‡èµ‹å€¼" class="table-of-contents__link toc-highlight">5.2. å˜é‡èµ‹å€¼</a><ul><li><a href="#521-é»˜è®¤æ˜¯ä¸å¯å˜çš„" class="table-of-contents__link toc-highlight">5.2.1. é»˜è®¤æ˜¯ä¸å¯å˜çš„</a></li><li><a href="#522-å­—é¢é‡" class="table-of-contents__link toc-highlight">5.2.2. å­—é¢é‡</a></li></ul></li><li><a href="#53-åŸºæœ¬æ•°æ®ç±»å‹" class="table-of-contents__link toc-highlight">5.3. åŸºæœ¬æ•°æ®ç±»å‹</a><ul><li><a href="#531-convert" class="table-of-contents__link toc-highlight">5.3.1. convert</a></li><li><a href="#532-å€¼ç±»å‹-and-å¼•ç”¨ç±»å‹" class="table-of-contents__link toc-highlight">5.3.2. å€¼ç±»å‹ and å¼•ç”¨ç±»å‹</a></li><li><a href="#533-å¸¸é‡-é™æ€å˜é‡" class="table-of-contents__link toc-highlight">5.3.3. å¸¸é‡ é™æ€å˜é‡</a></li><li><a href="#534-æ•°å­—" class="table-of-contents__link toc-highlight">5.3.4. æ•°å­—</a></li><li><a href="#535-å¸ƒå°”å€¼-å­—ç¬¦-å­—èŠ‚" class="table-of-contents__link toc-highlight">5.3.5. å¸ƒå°”å€¼ å­—ç¬¦ å­—èŠ‚</a></li><li><a href="#536-æ•°ç»„" class="table-of-contents__link toc-highlight">5.3.6. æ•°ç»„</a></li><li><a href="#537-range-èŒƒå›´" class="table-of-contents__link toc-highlight">5.3.7. Range èŒƒå›´</a></li><li><a href="#538-åˆ‡ç‰‡" class="table-of-contents__link toc-highlight">5.3.8. åˆ‡ç‰‡</a></li><li><a href="#539-str-å­—ç¬¦ä¸²åˆ‡ç‰‡" class="table-of-contents__link toc-highlight">5.3.9. str å­—ç¬¦ä¸²åˆ‡ç‰‡</a></li><li><a href="#5310-åŸç”ŸæŒ‡é’ˆ-raw-pointer" class="table-of-contents__link toc-highlight">5.3.10. åŸç”ŸæŒ‡é’ˆ raw pointer</a></li><li><a href="#5311-never-ç±»å‹-æ„Ÿå¹å·" class="table-of-contents__link toc-highlight">5.3.11. never ç±»å‹ æ„Ÿå¹å·</a></li></ul></li><li><a href="#54-å­—ç¬¦ä¸²" class="table-of-contents__link toc-highlight">5.4. å­—ç¬¦ä¸²</a><ul><li><a href="#541-å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«" class="table-of-contents__link toc-highlight">5.4.1. å‡ ç§å­—ç¬¦ä¸²åŒºåˆ«</a></li><li><a href="#542-å¸¸ç”¨æ–¹æ³•" class="table-of-contents__link toc-highlight">5.4.2. å¸¸ç”¨æ–¹æ³•</a></li><li><a href="#543-å­—ç¬¦ä¸²è½¬æ¢" class="table-of-contents__link toc-highlight">5.4.3. å­—ç¬¦ä¸²è½¬æ¢</a></li><li><a href="#544-æ ¼å¼åŒ–" class="table-of-contents__link toc-highlight">5.4.4. æ ¼å¼åŒ–</a></li><li><a href="#545-è°ƒè¯•æ‰“å°å¤åˆç±»å‹-debug-display" class="table-of-contents__link toc-highlight">5.4.5. è°ƒè¯•æ‰“å°å¤åˆç±»å‹ Debug Display</a></li><li><a href="#546-é—®å·æ“ä½œç¬¦-å¤šæ¬¡å†™" class="table-of-contents__link toc-highlight">5.4.6. é—®å·æ“ä½œç¬¦ å¤šæ¬¡å†™</a></li></ul></li><li><a href="#55-é›†åˆ" class="table-of-contents__link toc-highlight">5.5. é›†åˆ</a><ul><li><a href="#551-vec-åŠ¨æ€æ•°ç»„" class="table-of-contents__link toc-highlight">5.5.1. Vec åŠ¨æ€æ•°ç»„</a></li><li><a href="#552-åŒç«¯é˜Ÿåˆ—-vecdeque" class="table-of-contents__link toc-highlight">5.5.2. åŒç«¯é˜Ÿåˆ— VecDeque</a></li><li><a href="#553-é“¾è¡¨-linkedlist" class="table-of-contents__link toc-highlight">5.5.3. é“¾è¡¨ Linkedlist</a></li><li><a href="#554-hashmap-æ— åºå“ˆå¸Œè¡¨" class="table-of-contents__link toc-highlight">5.5.4. hashmap æ— åºå“ˆå¸Œè¡¨</a><ul><li><a href="#5541-å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.5.4.1. å“ˆå¸Œè¡¨åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5542-å¤åˆç±»å‹ä½œä¸º-key" class="table-of-contents__link toc-highlight">5.5.4.2. å¤åˆç±»å‹ä½œä¸º key</a></li><li><a href="#5543-å“ˆå¸Œç¢°æ’æ”»å‡»" class="table-of-contents__link toc-highlight">5.5.4.3. å“ˆå¸Œç¢°æ’æ”»å‡»</a></li></ul></li><li><a href="#555-btreemap-æœ‰åºå“ˆå¸Œè¡¨" class="table-of-contents__link toc-highlight">5.5.5. BTreeMap æœ‰åºå“ˆå¸Œè¡¨</a></li><li><a href="#556-hashset-æ— åºé›†åˆ" class="table-of-contents__link toc-highlight">5.5.6. hashset æ— åºé›†åˆ</a></li><li><a href="#557-btreeset-æœ‰åºé›†åˆ" class="table-of-contents__link toc-highlight">5.5.7. BTreeSet æœ‰åºé›†åˆ</a></li><li><a href="#558-ä¼˜å…ˆé˜Ÿåˆ—-binaryheap" class="table-of-contents__link toc-highlight">5.5.8. ä¼˜å…ˆé˜Ÿåˆ— BinaryHeap</a></li></ul></li><li><a href="#56-ç±»å‹è½¬æ¢" class="table-of-contents__link toc-highlight">5.6. ç±»å‹è½¬æ¢</a><ul><li><a href="#561-åŸºæœ¬çš„ç±»å‹è½¬æ¢" class="table-of-contents__link toc-highlight">5.6.1. åŸºæœ¬çš„ç±»å‹è½¬æ¢</a></li><li><a href="#562-è½¬æ¢ç›¸å…³çš„-trait" class="table-of-contents__link toc-highlight">5.6.2. è½¬æ¢ç›¸å…³çš„ trait</a></li></ul></li><li><a href="#57-æ‰€æœ‰æƒ" class="table-of-contents__link toc-highlight">5.7. æ‰€æœ‰æƒ</a><ul><li><a href="#571-ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ-raiiæœºåˆ¶" class="table-of-contents__link toc-highlight">5.7.1. ä¸ºä»€ä¹ˆéœ€è¦æ‰€æœ‰æƒ RAIIæœºåˆ¶</a></li><li><a href="#572-åŸºæœ¬åŸåˆ™" class="table-of-contents__link toc-highlight">5.7.2. åŸºæœ¬åŸåˆ™</a></li><li><a href="#573-å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒ" class="table-of-contents__link toc-highlight">5.7.3. å­—ç¬¦ä¸²èµ‹å€¼çš„æ‰€æœ‰æƒ</a></li><li><a href="#574-å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒ" class="table-of-contents__link toc-highlight">5.7.4. å‡½æ•°å‚æ•°çš„æ‰€æœ‰æƒ</a></li><li><a href="#575-å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒ" class="table-of-contents__link toc-highlight">5.7.5. å‡½æ•°è¿”å›å€¼æ‰€æœ‰æƒ</a></li><li><a href="#576-å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒ" class="table-of-contents__link toc-highlight">5.7.6. å¤åˆç±»å‹ä¸­çš„æ‰€æœ‰æƒ</a></li><li><a href="#577-å¤šæ‰€æœ‰æƒ" class="table-of-contents__link toc-highlight">5.7.7. å¤šæ‰€æœ‰æƒ</a></li></ul></li><li><a href="#58-ç”Ÿå‘½å‘¨æœŸå‚æ•°" class="table-of-contents__link toc-highlight">5.8. ç”Ÿå‘½å‘¨æœŸå‚æ•°</a><ul><li><a href="#581-ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸ" class="table-of-contents__link toc-highlight">5.8.1. ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="#582-ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š" class="table-of-contents__link toc-highlight">5.8.2. ä¸ºä»€ä¹ˆå­˜åœ¨ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š</a></li><li><a href="#583-å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°" class="table-of-contents__link toc-highlight">5.8.3. å‡½æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°</a></li><li><a href="#584-ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ-çœç•¥çš„è§„åˆ™" class="table-of-contents__link toc-highlight">5.8.4. ç»“æ„ä½“ä¸­ç”Ÿå‘½å‘¨æœŸ çœç•¥çš„è§„åˆ™</a></li><li><a href="#585-é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š" class="table-of-contents__link toc-highlight">5.8.5. é™æ€ç”Ÿå‘½å‘¨æœŸæ³¨é‡Š</a></li><li><a href="#586-ç”Ÿå‘½å‘¨æœŸçº¦æŸ" class="table-of-contents__link toc-highlight">5.8.6. ç”Ÿå‘½å‘¨æœŸçº¦æŸ</a></li></ul></li><li><a href="#59-å¼•ç”¨" class="table-of-contents__link toc-highlight">5.9. å¼•ç”¨</a><ul><li><a href="#591-å¼•ç”¨åŸºæœ¬ä»‹ç»" class="table-of-contents__link toc-highlight">5.9.1. å¼•ç”¨åŸºæœ¬ä»‹ç»</a></li><li><a href="#592-ä¸å¯å˜å¼•ç”¨" class="table-of-contents__link toc-highlight">5.9.2. ä¸å¯å˜å¼•ç”¨</a></li><li><a href="#593-å¯å˜å¼•ç”¨" class="table-of-contents__link toc-highlight">5.9.3. å¯å˜å¼•ç”¨</a></li><li><a href="#594-å‚æ‚¬å¼•ç”¨é—®é¢˜dangling-references" class="table-of-contents__link toc-highlight">5.9.4. å‚æ‚¬å¼•ç”¨é—®é¢˜ï¼ˆDangling References)</a></li></ul></li><li><a href="#510-è£¸æŒ‡é’ˆ" class="table-of-contents__link toc-highlight">5.10. è£¸æŒ‡é’ˆ</a></li><li><a href="#511-æ™ºèƒ½æŒ‡é’ˆ" class="table-of-contents__link toc-highlight">5.11. æ™ºèƒ½æŒ‡é’ˆ</a><ul><li><a href="#5111-æ™ºèƒ½æŒ‡é’ˆä»‹ç»-å·¥ä½œæœºåˆ¶" class="table-of-contents__link toc-highlight">5.11.1. æ™ºèƒ½æŒ‡é’ˆä»‹ç» å·¥ä½œæœºåˆ¶</a></li><li><a href="#5112-raiiæœºåˆ¶-å®ç°å†…å­˜å›æ”¶" class="table-of-contents__link toc-highlight">5.11.2. RAIIæœºåˆ¶ å®ç°å†…å­˜å›æ”¶</a></li><li><a href="#5113-è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ-è‡ªåŠ¨è§£å¼•ç”¨-deref-å’Œ-drop" class="table-of-contents__link toc-highlight">5.11.3. è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆ è‡ªåŠ¨è§£å¼•ç”¨ Deref å’Œ Drop</a></li><li><a href="#5114-box-æ— ç—›ä½¿ç”¨å †å†…å­˜" class="table-of-contents__link toc-highlight">5.11.4. Box æ— ç—›ä½¿ç”¨å †å†…å­˜</a><ul><li><a href="#51141-boxåŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.11.4.1. BoxåŸºæœ¬ä½¿ç”¨</a></li><li><a href="#51142-åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹-dst" class="table-of-contents__link toc-highlight">5.11.4.2. åŒ…è£…åŠ¨æ€å¤§å°ç±»å‹ DST</a></li></ul></li><li><a href="#5115-rc-å’Œ-weak-å…±äº«å †å†…å­˜" class="table-of-contents__link toc-highlight">5.11.5. Rc å’Œ Weak å…±äº«å †å†…å­˜</a><ul><li><a href="#51151-rc-å¼ºå¼•ç”¨" class="table-of-contents__link toc-highlight">5.11.5.1. Rc å¼ºå¼•ç”¨</a></li><li><a href="#51152-æ„é€ é“¾è¡¨" class="table-of-contents__link toc-highlight">5.11.5.2. æ„é€ é“¾è¡¨</a></li><li><a href="#51153-weak-å¼±å¼•ç”¨" class="table-of-contents__link toc-highlight">5.11.5.3. Weak å¼±å¼•ç”¨</a></li></ul></li><li><a href="#5116-refcell-å’Œ-cell-æä¾›å†…éƒ¨å¯å˜æ€§" class="table-of-contents__link toc-highlight">5.11.6. RefCell å’Œ Cell æä¾›å†…éƒ¨å¯å˜æ€§</a><ul><li><a href="#51161-cell" class="table-of-contents__link toc-highlight">5.11.6.1. Cell</a></li><li><a href="#51162-refcell" class="table-of-contents__link toc-highlight">5.11.6.2. RefCell</a></li></ul></li><li><a href="#5117-rc-box-refcell-cell-å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯”-ç»„åˆä½¿ç”¨" class="table-of-contents__link toc-highlight">5.11.7. Rc Box RefCell Cell å‡ ç§æŒ‡é’ˆçš„åŒºåˆ«å¯¹æ¯” ç»„åˆä½¿ç”¨</a></li><li><a href="#5118-pin-å’Œ-unpin" class="table-of-contents__link toc-highlight">5.11.8. Pin å’Œ Unpin</a></li><li><a href="#5119-cow-å†™æ—¶å¤åˆ¶" class="table-of-contents__link toc-highlight">5.11.9. Cow å†™æ—¶å¤åˆ¶</a></li></ul></li><li><a href="#512-å‡½æ•°" class="table-of-contents__link toc-highlight">5.12. å‡½æ•°</a><ul><li><a href="#5121-å‡½æ•°åŸºæœ¬è¯­æ³•" class="table-of-contents__link toc-highlight">5.12.1. å‡½æ•°åŸºæœ¬è¯­æ³•</a></li><li><a href="#5122-å‡½æ•°ä½“è¡¨è¾¾å¼" class="table-of-contents__link toc-highlight">5.12.2. å‡½æ•°ä½“è¡¨è¾¾å¼</a></li><li><a href="#5123-å‡½æ•°ä½œä¸ºå‚æ•°" class="table-of-contents__link toc-highlight">5.12.3. å‡½æ•°ä½œä¸ºå‚æ•°</a></li><li><a href="#5124-result-è¿”å›å€¼" class="table-of-contents__link toc-highlight">5.12.4. Result è¿”å›å€¼</a></li><li><a href="#5125-ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ-cfe" class="table-of-contents__link toc-highlight">5.12.5. ç¼–è¯‘æœŸå‡½æ•°æ‰§è¡Œ cfe</a></li><li><a href="#5126-å‘æ•£å‡½æ•°" class="table-of-contents__link toc-highlight">5.12.6. å‘æ•£å‡½æ•°</a></li><li><a href="#5127-æ³›å‹å‡½æ•°" class="table-of-contents__link toc-highlight">5.12.7. æ³›å‹å‡½æ•°</a></li><li><a href="#5128-é«˜é˜¶å‡½æ•°" class="table-of-contents__link toc-highlight">5.12.8. é«˜é˜¶å‡½æ•°</a><ul><li><a href="#51281-å‡½æ•°æŒ‡é’ˆ" class="table-of-contents__link toc-highlight">5.12.8.1. å‡½æ•°æŒ‡é’ˆ</a></li><li><a href="#51282-ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡" class="table-of-contents__link toc-highlight">5.12.8.2. ç¦æ­¢å‡½æ•°æ•è·å¤–éƒ¨ç¯å¢ƒä¸­å˜é‡</a></li></ul></li></ul></li><li><a href="#513-é—­åŒ…" class="table-of-contents__link toc-highlight">5.13. é—­åŒ…</a><ul><li><a href="#5131-é—­åŒ…åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.13.1. é—­åŒ…åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5132-rust-å®ç°é—­åŒ…çš„åŸç†" class="table-of-contents__link toc-highlight">5.13.2. rust å®ç°é—­åŒ…çš„åŸç†</a></li><li><a href="#5133-æ•è·ç¯å¢ƒå˜é‡-and-ä¸‰ç§é—­åŒ…ç±»å‹" class="table-of-contents__link toc-highlight">5.13.3. æ•è·ç¯å¢ƒå˜é‡ and ä¸‰ç§é—­åŒ…ç±»å‹</a></li><li><a href="#5134-é—­åŒ…ä½œä¸ºè¿”å›å€¼-or-å‚æ•°" class="table-of-contents__link toc-highlight">5.13.4. é—­åŒ…ä½œä¸ºè¿”å›å€¼ or å‚æ•°</a><ul><li><a href="#51341-é€ƒé€¸é—­åŒ…-éé€ƒé€¸é—­åŒ…" class="table-of-contents__link toc-highlight">5.13.4.1. é€ƒé€¸é—­åŒ… éé€ƒé€¸é—­åŒ…</a></li><li><a href="#51342-é—­åŒ…ä½œä¸ºå‚æ•°" class="table-of-contents__link toc-highlight">5.13.4.2. é—­åŒ…ä½œä¸ºå‚æ•°</a></li><li><a href="#51343-é—­åŒ…ä½œä¸ºè¿”å›å€¼" class="table-of-contents__link toc-highlight">5.13.4.3. é—­åŒ…ä½œä¸ºè¿”å›å€¼</a></li><li><a href="#51344-é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" class="table-of-contents__link toc-highlight">5.13.4.4. é—­åŒ…å‚æ•°ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</a></li></ul></li><li><a href="#5135-è¿­ä»£å™¨" class="table-of-contents__link toc-highlight">5.13.5. è¿­ä»£å™¨</a><ul><li><a href="#51351-ä»€ä¹ˆæ˜¯è¿­ä»£å™¨" class="table-of-contents__link toc-highlight">5.13.5.1. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨</a></li><li><a href="#51352-iterator-trait" class="table-of-contents__link toc-highlight">5.13.5.2. Iterator trait</a></li><li><a href="#51353-è¿­ä»£å™¨é€‚é…å™¨-æ”¶é›†å™¨-å‡½æ•°å¼é£æ ¼" class="table-of-contents__link toc-highlight">5.13.5.3. è¿­ä»£å™¨é€‚é…å™¨ æ”¶é›†å™¨ å‡½æ•°å¼é£æ ¼</a></li><li><a href="#51354-è‡ªå®šä¹‰è¿­ä»£å™¨" class="table-of-contents__link toc-highlight">5.13.5.4. è‡ªå®šä¹‰è¿­ä»£å™¨</a></li><li><a href="#51355-è‡ªå®šä¹‰é€‚é…å™¨-æ”¶é›†å™¨" class="table-of-contents__link toc-highlight">5.13.5.5. è‡ªå®šä¹‰é€‚é…å™¨ æ”¶é›†å™¨</a></li></ul></li></ul></li><li><a href="#514-æ¡ä»¶å¾ªç¯" class="table-of-contents__link toc-highlight">5.14. æ¡ä»¶å¾ªç¯</a></li><li><a href="#515-æ³›å‹" class="table-of-contents__link toc-highlight">5.15. æ³›å‹</a><ul><li><a href="#5151-å•æ€åŒ–" class="table-of-contents__link toc-highlight">5.15.1. å•æ€åŒ–</a></li><li><a href="#5152-å¤šé‡çº¦æŸ-åŠ å·" class="table-of-contents__link toc-highlight">5.15.2. å¤šé‡çº¦æŸ åŠ å·</a></li><li><a href="#5153-é»˜è®¤æ³›å‹å‚æ•°-and-å…³è”ç±»å‹" class="table-of-contents__link toc-highlight">5.15.3. é»˜è®¤æ³›å‹å‚æ•° and å…³è”ç±»å‹</a></li><li><a href="#5154-ç©ºçº¦æŸ" class="table-of-contents__link toc-highlight">5.15.4. ç©ºçº¦æŸ</a></li><li><a href="#5155-turbofish-æ“ä½œç¬¦-and-è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼" class="table-of-contents__link toc-highlight">5.15.5. turbofish æ“ä½œç¬¦ and è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼</a></li></ul></li><li><a href="#516-trait" class="table-of-contents__link toc-highlight">5.16. trait</a><ul><li><a href="#5161-trait-æ¦‚å¿µ" class="table-of-contents__link toc-highlight">5.16.1. trait æ¦‚å¿µ</a><ul><li><a href="#51611-trait-åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.16.1.1. trait åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#51612-å­¤å„¿è§„åˆ™-é€šè¿‡fundamentalè§„é¿" class="table-of-contents__link toc-highlight">5.16.1.2. å­¤å„¿è§„åˆ™ é€šè¿‡fundamentalè§„é¿</a></li><li><a href="#51613-ç‰¹åŒ–-specialization" class="table-of-contents__link toc-highlight">5.16.1.3. ç‰¹åŒ– Specialization</a></li><li><a href="#51614-trait-ä½œä¸ºå‚æ•°-éœ€è¦-impl-å‰ç¼€" class="table-of-contents__link toc-highlight">5.16.1.4. trait ä½œä¸ºå‚æ•° éœ€è¦ impl å‰ç¼€</a></li><li><a href="#51615-trait-ä½œä¸º-è¿”å›å€¼-è¿”å›åŠ¨æ€ç±»å‹" class="table-of-contents__link toc-highlight">5.16.1.5. trait ä½œä¸º è¿”å›å€¼ è¿”å›åŠ¨æ€ç±»å‹</a></li><li><a href="#51616-trait-ç»§æ‰¿" class="table-of-contents__link toc-highlight">5.16.1.6. trait ç»§æ‰¿</a></li><li><a href="#51617-é™æ€åˆ†å‘-åŠ¨æ€åˆ†å‘" class="table-of-contents__link toc-highlight">5.16.1.7. é™æ€åˆ†å‘ åŠ¨æ€åˆ†å‘</a></li><li><a href="#51618-ä½¿ç”¨æŠ½è±¡ç±»å‹" class="table-of-contents__link toc-highlight">5.16.1.8. ä½¿ç”¨æŠ½è±¡ç±»å‹</a><ul><li><a href="#516181-traitå¯¹è±¡" class="table-of-contents__link toc-highlight">5.16.1.8.1. traitå¯¹è±¡</a></li><li><a href="#516182-traitå¯¹è±¡å®‰å…¨é—®é¢˜-sized-trait" class="table-of-contents__link toc-highlight">5.16.1.8.2. traitå¯¹è±¡å®‰å…¨é—®é¢˜ Sized trait</a></li><li><a href="#516183-impl-trait" class="table-of-contents__link toc-highlight">5.16.1.8.3. impl trait</a></li></ul></li><li><a href="#51619-traitçš„ç±»å‹è½¬æ¢" class="table-of-contents__link toc-highlight">5.16.1.9. traitçš„ç±»å‹è½¬æ¢</a></li></ul></li><li><a href="#5162-å¯è‡ªåŠ¨æ¨å¯¼çš„trait" class="table-of-contents__link toc-highlight">5.16.2. å¯è‡ªåŠ¨æ¨å¯¼çš„trait</a></li><li><a href="#5163-è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„trait" class="table-of-contents__link toc-highlight">5.16.3. è¿ç®—ç¬¦é‡è½½ç›¸å…³çš„trait</a></li><li><a href="#5164-from-å’Œ-into" class="table-of-contents__link toc-highlight">5.16.4. From å’Œ Into</a></li><li><a href="#5165-derefmut-å’Œ-deref" class="table-of-contents__link toc-highlight">5.16.5. DerefMut å’Œ Deref</a></li><li><a href="#5166-asref-asmut" class="table-of-contents__link toc-highlight">5.16.6. AsRef AsMut</a></li><li><a href="#5167-borrow-trait" class="table-of-contents__link toc-highlight">5.16.7. Borrow trait</a></li><li><a href="#5168-drop-èµ„æºé‡Šæ”¾" class="table-of-contents__link toc-highlight">5.16.8. Drop èµ„æºé‡Šæ”¾</a></li><li><a href="#5169-æ ‡ç­¾-trait" class="table-of-contents__link toc-highlight">5.16.9. æ ‡ç­¾ trait</a><ul><li><a href="#51691-send-å’Œ-sync" class="table-of-contents__link toc-highlight">5.16.9.1. Send å’Œ Sync</a></li><li><a href="#51692-copy-trait" class="table-of-contents__link toc-highlight">5.16.9.2. Copy trait</a></li><li><a href="#51693-sized-trait--å’Œ-åŠ¨æ€ç±»å‹dst" class="table-of-contents__link toc-highlight">5.16.9.3. Sized trait  å’Œ åŠ¨æ€ç±»å‹DST</a></li></ul></li><li><a href="#51610-default-trait" class="table-of-contents__link toc-highlight">5.16.10. Default trait</a></li><li><a href="#51611-extend-trait" class="table-of-contents__link toc-highlight">5.16.11. Extend trait</a></li><li><a href="#51612-any-trait" class="table-of-contents__link toc-highlight">5.16.12. Any trait</a></li><li><a href="#51613-å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„trait" class="table-of-contents__link toc-highlight">5.16.13. å’Œæ¯”è¾ƒæ’åºç›¸å…³çš„trait</a></li></ul></li><li><a href="#517-å…ƒç»„" class="table-of-contents__link toc-highlight">5.17. å…ƒç»„</a></li><li><a href="#518-ç»“æ„ä½“" class="table-of-contents__link toc-highlight">5.18. ç»“æ„ä½“</a><ul><li><a href="#5181-ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.18.1. ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5182-å…ƒç»„ç»“æ„ä½“-and-å•å…ƒç»“æ„ä½“" class="table-of-contents__link toc-highlight">5.18.2. å…ƒç»„ç»“æ„ä½“ and å•å…ƒç»“æ„ä½“</a></li><li><a href="#5183-ç»“æ„ä½“æ–¹æ³•" class="table-of-contents__link toc-highlight">5.18.3. ç»“æ„ä½“æ–¹æ³•</a></li><li><a href="#5184-new-type-æ¨¡å¼-å’Œ-ç±»å‹åˆ«å-selfåˆ«å" class="table-of-contents__link toc-highlight">5.18.4. new type æ¨¡å¼ å’Œ ç±»å‹åˆ«å Selfåˆ«å</a></li><li><a href="#5185-æ¡ˆä¾‹-å½©è‰²å‘½ä»¤è¡Œè¾“å‡º" class="table-of-contents__link toc-highlight">5.18.5. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡º</a></li></ul></li><li><a href="#519-æšä¸¾" class="table-of-contents__link toc-highlight">5.19. æšä¸¾</a><ul><li><a href="#5191-æšä¸¾åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.19.1. æšä¸¾åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#5192-option" class="table-of-contents__link toc-highlight">5.19.2. Option</a></li><li><a href="#5193-c-é£æ ¼çš„æšä¸¾" class="table-of-contents__link toc-highlight">5.19.3. c é£æ ¼çš„æšä¸¾</a></li><li><a href="#5194-æ¡ˆä¾‹-å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–" class="table-of-contents__link toc-highlight">5.19.4. æ¡ˆä¾‹ å½©è‰²å‘½ä»¤è¡Œè¾“å‡ºä¼˜åŒ–</a></li><li><a href="#5195-å®ä¾‹-åˆ›å»ºé“¾è¡¨" class="table-of-contents__link toc-highlight">5.19.5. å®ä¾‹ åˆ›å»ºé“¾è¡¨</a></li></ul></li><li><a href="#520-match-æ¨¡å¼åŒ¹é…" class="table-of-contents__link toc-highlight">5.20. match æ¨¡å¼åŒ¹é…</a><ul><li><a href="#5201-æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.20.1. æ¨¡å¼åŒ¹é…ç®€å•ä½¿ç”¨</a></li><li><a href="#5202-if-lef-while-let-è¯­æ³•ç³–" class="table-of-contents__link toc-highlight">5.20.2. if lef while let è¯­æ³•ç³–</a></li></ul></li><li><a href="#521-é”™è¯¯å¤„ç†" class="table-of-contents__link toc-highlight">5.21. é”™è¯¯å¤„ç†</a><ul><li><a href="#5211-æ–­è¨€" class="table-of-contents__link toc-highlight">5.21.1. æ–­è¨€</a></li><li><a href="#5212-panic-å’Œ-abort" class="table-of-contents__link toc-highlight">5.21.2. panic å’Œ Abort</a></li><li><a href="#5213-result--å’Œ-é—®å·æ“ä½œç¬¦" class="table-of-contents__link toc-highlight">5.21.3. Result  å’Œ é—®å·æ“ä½œç¬¦</a></li><li><a href="#5214-é”™è¯¯è£…ç®±-è‡ªå®šä¹‰å¼‚å¸¸" class="table-of-contents__link toc-highlight">5.21.4. é”™è¯¯è£…ç®± è‡ªå®šä¹‰å¼‚å¸¸</a></li><li><a href="#5215-æ•è·å¼‚å¸¸" class="table-of-contents__link toc-highlight">5.21.5. æ•è·å¼‚å¸¸</a></li><li><a href="#5216-é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹" class="table-of-contents__link toc-highlight">5.21.6. é”™è¯¯å¤„ç†è¿›åŒ–è¿‡ç¨‹</a></li><li><a href="#5217-ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸" class="table-of-contents__link toc-highlight">5.21.7. ç¬¬ä¸‰æ–¹åº“å¤„ç†å¼‚å¸¸</a></li></ul></li><li><a href="#522-io" class="table-of-contents__link toc-highlight">5.22. io</a><ul><li><a href="#5221-å‘½ä»¤è¡Œå‚æ•°" class="table-of-contents__link toc-highlight">5.22.1. å‘½ä»¤è¡Œå‚æ•°</a></li><li><a href="#5222-æ–‡ä»¶-io" class="table-of-contents__link toc-highlight">5.22.2. æ–‡ä»¶ io</a></li></ul></li><li><a href="#523-é¢å‘å¯¹è±¡-oop" class="table-of-contents__link toc-highlight">5.23. é¢å‘å¯¹è±¡ oop</a><ul><li><a href="#5231-å¯è§æ€§" class="table-of-contents__link toc-highlight">5.23.1. å¯è§æ€§</a></li><li><a href="#5232-å¤šæ€" class="table-of-contents__link toc-highlight">5.23.2. å¤šæ€</a></li><li><a href="#5233-å‘ä¸‹è½¬å‹" class="table-of-contents__link toc-highlight">5.23.3. å‘ä¸‹è½¬å‹</a></li><li><a href="#5234-å„ç§selfåŒºåˆ†ä½¿ç”¨" class="table-of-contents__link toc-highlight">5.23.4. å„ç§selfåŒºåˆ†ä½¿ç”¨</a></li><li><a href="#5235-è®¾è®¡æ¨¡å¼" class="table-of-contents__link toc-highlight">5.23.5. è®¾è®¡æ¨¡å¼</a><ul><li><a href="#52351-å»ºé€ è€…æ¨¡å¼" class="table-of-contents__link toc-highlight">5.23.5.1. å»ºé€ è€…æ¨¡å¼</a></li><li><a href="#52352-è®¿é—®è€…æ¨¡å¼" class="table-of-contents__link toc-highlight">5.23.5.2. è®¿é—®è€…æ¨¡å¼</a></li><li><a href="#52353-raiiæ¨¡å¼" class="table-of-contents__link toc-highlight">5.23.5.3. raiiæ¨¡å¼</a></li></ul></li></ul></li><li><a href="#524-å­è¿›ç¨‹" class="table-of-contents__link toc-highlight">5.24. å­è¿›ç¨‹</a></li><li><a href="#525-åå°„" class="table-of-contents__link toc-highlight">5.25. åå°„</a></li><li><a href="#526-å®" class="table-of-contents__link toc-highlight">5.26. å®</a><ul><li><a href="#5261-å®åŸºæœ¬ä»‹ç»" class="table-of-contents__link toc-highlight">5.26.1. å®åŸºæœ¬ä»‹ç»</a></li><li><a href="#5262-å£°æ˜å®" class="table-of-contents__link toc-highlight">5.26.2. å£°æ˜å®</a><ul><li><a href="#52621-åˆ›å»ºå®" class="table-of-contents__link toc-highlight">5.26.2.1. åˆ›å»ºå®</a></li><li><a href="#52622-é‡å¤å¾ªç¯åŒ¹é…" class="table-of-contents__link toc-highlight">5.26.2.2. é‡å¤å¾ªç¯åŒ¹é…</a></li><li><a href="#52623-å®é™…æ¡ˆä¾‹" class="table-of-contents__link toc-highlight">5.26.2.3. å®é™…æ¡ˆä¾‹</a></li></ul></li><li><a href="#5263-å®è°ƒè¯•" class="table-of-contents__link toc-highlight">5.26.3. å®è°ƒè¯•</a></li><li><a href="#5264-è¿‡ç¨‹å®" class="table-of-contents__link toc-highlight">5.26.4. è¿‡ç¨‹å®</a><ul><li><a href="#52641-è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™" class="table-of-contents__link toc-highlight">5.26.4.1. è¿‡ç¨‹å®åŸºæœ¬ä½¿ç”¨è§„åˆ™</a></li><li><a href="#52642-è‡ªå®šä¹‰å±æ€§å®" class="table-of-contents__link toc-highlight">5.26.4.2. è‡ªå®šä¹‰å±æ€§å®</a></li><li><a href="#52643-å‡½æ•°è°ƒç”¨å®" class="table-of-contents__link toc-highlight">5.26.4.3. å‡½æ•°è°ƒç”¨å®</a></li><li><a href="#52644-derive-å®" class="table-of-contents__link toc-highlight">5.26.4.4. derive å®</a></li></ul></li><li><a href="#5265-ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…" class="table-of-contents__link toc-highlight">5.26.5. ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…</a></li><li><a href="#5266-ç¼–è¯‘å™¨æ’ä»¶" class="table-of-contents__link toc-highlight">5.26.6. ç¼–è¯‘å™¨æ’ä»¶</a></li></ul></li><li><a href="#61-unsafe-åŸºæœ¬åœºæ™¯" class="table-of-contents__link toc-highlight">6.1. unsafe åŸºæœ¬åœºæ™¯</a></li><li><a href="#62-äº¤å‰ç¼–è¯‘" class="table-of-contents__link toc-highlight">6.2. äº¤å‰ç¼–è¯‘</a></li><li><a href="#63-ffi-å¤–éƒ¨å‡½æ•°æ¥å£" class="table-of-contents__link toc-highlight">6.3. ffi å¤–éƒ¨å‡½æ•°æ¥å£</a><ul><li><a href="#631-ffi-åŸºæœ¬ä»‹ç»" class="table-of-contents__link toc-highlight">6.3.1. ffi åŸºæœ¬ä»‹ç»</a></li><li><a href="#632-å’Œ-elixir-äº¤äº’" class="table-of-contents__link toc-highlight">6.3.2. å’Œ elixir äº¤äº’</a></li><li><a href="#633-å’Œc-cpp-äº¤äº’" class="table-of-contents__link toc-highlight">6.3.3. å’Œc cpp äº¤äº’</a><ul><li><a href="#6331-åœ¨-rust-ä¸­è°ƒç”¨-c-å‡½æ•°" class="table-of-contents__link toc-highlight">6.3.3.1. åœ¨ rust ä¸­è°ƒç”¨ C å‡½æ•°</a></li><li><a href="#6332-åœ¨-rustè°ƒç”¨-cpp" class="table-of-contents__link toc-highlight">6.3.3.2. åœ¨ rustè°ƒç”¨ cpp</a></li><li><a href="#6333-åœ¨-c-ä¸­è°ƒç”¨-rust" class="table-of-contents__link toc-highlight">6.3.3.3. åœ¨ c ä¸­è°ƒç”¨ rust</a></li></ul></li><li><a href="#634-å’Œ-python-äº¤äº’" class="table-of-contents__link toc-highlight">6.3.4. å’Œ Python äº¤äº’</a></li><li><a href="#635-å’Œ-swift" class="table-of-contents__link toc-highlight">6.3.5. å’Œ Swift</a></li><li><a href="#636-å’Œ-js-javascript-nodejs-äº¤äº’" class="table-of-contents__link toc-highlight">6.3.6. å’Œ js JavaScript nodejs äº¤äº’</a></li><li><a href="#637-å’Œ-java-äº¤äº’" class="table-of-contents__link toc-highlight">6.3.7. å’Œ java äº¤äº’</a><ul><li><a href="#6371-java-è°ƒç”¨-rust" class="table-of-contents__link toc-highlight">6.3.7.1. java è°ƒç”¨ rust</a></li><li><a href="#6372-rust-è°ƒç”¨-java" class="table-of-contents__link toc-highlight">6.3.7.2. rust è°ƒç”¨ java</a></li></ul></li></ul></li><li><a href="#71-å †-å’Œ-æ ˆ" class="table-of-contents__link toc-highlight">7.1. å † å’Œ æ ˆ</a></li><li><a href="#72-å†…å­˜å¯¹é½" class="table-of-contents__link toc-highlight">7.2. å†…å­˜å¯¹é½</a></li><li><a href="#73-æ‰‹åŠ¨å †å†…å­˜åˆ†é…" class="table-of-contents__link toc-highlight">7.3. æ‰‹åŠ¨å †å†…å­˜åˆ†é…</a></li><li><a href="#81-æ¦‚å¿µç®€å•è§£é‡Š" class="table-of-contents__link toc-highlight">8.1. æ¦‚å¿µç®€å•è§£é‡Š</a></li><li><a href="#82-å¯è§æ€§ç®¡ç†" class="table-of-contents__link toc-highlight">8.2. å¯è§æ€§ç®¡ç†</a></li><li><a href="#83-ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†" class="table-of-contents__link toc-highlight">8.3. ç¼–è¯‘å™¨ç‰ˆæœ¬ç®¡ç†</a></li><li><a href="#84-ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig-é…ç½®" class="table-of-contents__link toc-highlight">8.4. ä¸ºé¡¹ç›®å•ç‹¬æŒ‡å®šconfig é…ç½®</a></li><li><a href="#85-ä¾èµ–ç®¡ç†-cargo" class="table-of-contents__link toc-highlight">8.5. ä¾èµ–ç®¡ç† cargo</a><ul><li><a href="#851-cargo-åŸºæœ¬å‘½ä»¤" class="table-of-contents__link toc-highlight">8.5.1. cargo åŸºæœ¬å‘½ä»¤</a></li><li><a href="#852-æ–‡ä»¶å¸ƒå±€ç»“æ„" class="table-of-contents__link toc-highlight">8.5.2. æ–‡ä»¶å¸ƒå±€ç»“æ„</a></li><li><a href="#853-cargotoml" class="table-of-contents__link toc-highlight">8.5.3. Cargo.toml</a></li><li><a href="#854-cargolock" class="table-of-contents__link toc-highlight">8.5.4. cargo.lock</a></li><li><a href="#855-workspace" class="table-of-contents__link toc-highlight">8.5.5. workspace</a></li><li><a href="#856-ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™" class="table-of-contents__link toc-highlight">8.5.6. ä¾èµ–çš„ç‰ˆæœ¬å·è§„åˆ™</a></li></ul></li><li><a href="#86-buildrs" class="table-of-contents__link toc-highlight">8.6. build.rs</a></li><li><a href="#87-é¡¹ç›®ç®¡ç†æ¡ˆä¾‹" class="table-of-contents__link toc-highlight">8.7. é¡¹ç›®ç®¡ç†æ¡ˆä¾‹</a><ul><li><a href="#871-å¯¼å‡ºè‡ªå®šä¹‰å®" class="table-of-contents__link toc-highlight">8.7.1. å¯¼å‡ºè‡ªå®šä¹‰å®</a></li><li><a href="#872-å¯¼å…¥è‡ªå®šä¹‰-crate" class="table-of-contents__link toc-highlight">8.7.2. å¯¼å…¥è‡ªå®šä¹‰ crate</a></li><li><a href="#873-æ‰§è¡Œå­ç›®å½•ä¸­çš„-module" class="table-of-contents__link toc-highlight">8.7.3. æ‰§è¡Œå­ç›®å½•ä¸­çš„ module</a></li><li><a href="#874-å¯¼å…¥è‡ªå®šä¹‰-module" class="table-of-contents__link toc-highlight">8.7.4. å¯¼å…¥è‡ªå®šä¹‰ module</a></li><li><a href="#875-å¯¼å…¥ç¬¬ä¸‰æ–¹-crate" class="table-of-contents__link toc-highlight">8.7.5. å¯¼å…¥ç¬¬ä¸‰æ–¹ crate</a></li></ul></li><li><a href="#111-é€šç”¨æ¦‚å¿µ" class="table-of-contents__link toc-highlight">11.1. é€šç”¨æ¦‚å¿µ</a><ul><li><a href="#1111-è¿›ç¨‹-and-çº¿ç¨‹" class="table-of-contents__link toc-highlight">11.1.1. è¿›ç¨‹ and çº¿ç¨‹</a></li><li><a href="#1112-äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘" class="table-of-contents__link toc-highlight">11.1.2. äº‹ä»¶å›è°ƒå®ç°çš„å¼‚æ­¥å¹¶å‘</a></li></ul></li><li><a href="#112-çº¿ç¨‹åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">11.2. çº¿ç¨‹åŸºæœ¬ä½¿ç”¨</a><ul><li><a href="#1121-åˆ›å»ºçº¿ç¨‹" class="table-of-contents__link toc-highlight">11.2.1. åˆ›å»ºçº¿ç¨‹</a></li><li><a href="#1122-è‡ªå®šä¹‰é…ç½®çº¿ç¨‹" class="table-of-contents__link toc-highlight">11.2.2. è‡ªå®šä¹‰é…ç½®çº¿ç¨‹</a></li><li><a href="#1123-çº¿ç¨‹æœ¬åœ°å˜é‡" class="table-of-contents__link toc-highlight">11.2.3. çº¿ç¨‹æœ¬åœ°å˜é‡</a></li><li><a href="#1124-æ‰‹åŠ¨é˜»å¡å”¤é†’" class="table-of-contents__link toc-highlight">11.2.4. æ‰‹åŠ¨é˜»å¡å”¤é†’</a></li></ul></li><li><a href="#113-çº¿ç¨‹åŒæ­¥" class="table-of-contents__link toc-highlight">11.3. çº¿ç¨‹åŒæ­¥</a><ul><li><a href="#1131-é”™è¯¯ç¤ºä¾‹" class="table-of-contents__link toc-highlight">11.3.1. é”™è¯¯ç¤ºä¾‹</a></li><li><a href="#1132-é”" class="table-of-contents__link toc-highlight">11.3.2. é”</a></li><li><a href="#1133-åŸå­ç±»å‹" class="table-of-contents__link toc-highlight">11.3.3. åŸå­ç±»å‹</a></li><li><a href="#1134-channel" class="table-of-contents__link toc-highlight">11.3.4. channel</a></li><li><a href="#1135-tokio-ä¸­çš„å„ç§-channel-å®ç°" class="table-of-contents__link toc-highlight">11.3.5. tokio ä¸­çš„å„ç§ channel å®ç°</a></li></ul></li><li><a href="#114-å¤šçº¿ç¨‹å°ä¾‹å­" class="table-of-contents__link toc-highlight">11.4. å¤šçº¿ç¨‹å°ä¾‹å­</a><ul><li><a href="#1141-å®ç°çº¿ç¨‹æ± " class="table-of-contents__link toc-highlight">11.4.1. å®ç°çº¿ç¨‹æ± </a></li><li><a href="#1142-å®ç°-map-reduce-ç®—æ³•" class="table-of-contents__link toc-highlight">11.4.2. å®ç° map-reduce ç®—æ³•</a></li><li><a href="#1143-å¤šçº¿ç¨‹ç»Ÿè®¡å’Œ" class="table-of-contents__link toc-highlight">11.4.3. å¤šçº¿ç¨‹ç»Ÿè®¡å’Œ</a></li><li><a href="#1144-å¸¦çº¿ç¨‹æ± çš„-webserver" class="table-of-contents__link toc-highlight">11.4.4. å¸¦çº¿ç¨‹æ± çš„ webserver</a></li></ul></li><li><a href="#115-rayon-å¹¶è¡Œæ‰§è¡Œä»»åŠ¡" class="table-of-contents__link toc-highlight">11.5. rayon å¹¶è¡Œæ‰§è¡Œä»»åŠ¡</a></li><li><a href="#116-crossbeam-æ— é”çš„æ•°æ®ç»“æ„" class="table-of-contents__link toc-highlight">11.6. CrossBeam æ— é”çš„æ•°æ®ç»“æ„</a></li><li><a href="#117-rwlock-å’Œ-refcell" class="table-of-contents__link toc-highlight">11.7. RwLock å’Œ RefCell</a></li><li><a href="#118-mutex" class="table-of-contents__link toc-highlight">11.8. Mutex</a></li><li><a href="#119-atomicptr-å’Œ-cell" class="table-of-contents__link toc-highlight">11.9. AtomicPtr å’Œ Cell</a></li><li><a href="#1110-send-å’Œ-sync-trait" class="table-of-contents__link toc-highlight">11.10. Send å’Œ Sync trait</a></li><li><a href="#121-å¼‚æ­¥æ¦‚å¿µ" class="table-of-contents__link toc-highlight">12.1. å¼‚æ­¥æ¦‚å¿µ</a><ul><li><a href="#1211-ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥" class="table-of-contents__link toc-highlight">12.1.1. ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥</a></li><li><a href="#1212-æ™®é€šå¤šçº¿ç¨‹-webserver" class="table-of-contents__link toc-highlight">12.1.2. æ™®é€šå¤šçº¿ç¨‹ webserver</a></li><li><a href="#1213-æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬" class="table-of-contents__link toc-highlight">12.1.3. æ”¹è¿›åçš„å¼‚æ­¥ç‰ˆæœ¬</a></li></ul></li><li><a href="#122-åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">12.2. åŸºæœ¬ä½¿ç”¨</a><ul><li><a href="#1221-block_on" class="table-of-contents__link toc-highlight">12.2.1. block_on</a></li><li><a href="#1222-await" class="table-of-contents__link toc-highlight">12.2.2. await</a></li><li><a href="#1223-joinn" class="table-of-contents__link toc-highlight">12.2.3. joinn</a></li></ul></li><li><a href="#123-futureå¹¶å‘æ¨¡å¼" class="table-of-contents__link toc-highlight">12.3. futureå¹¶å‘æ¨¡å¼</a><ul><li><a href="#1231-futureåº•å±‚æ˜¯ç”Ÿæˆå™¨" class="table-of-contents__link toc-highlight">12.3.1. futureåº•å±‚æ˜¯ç”Ÿæˆå™¨</a></li><li><a href="#1232-futureåŸºæœ¬ä½¿ç”¨ç”¨" class="table-of-contents__link toc-highlight">12.3.2. futureåŸºæœ¬ä½¿ç”¨ç”¨</a></li><li><a href="#1233-åŠ¨æ‰‹å®ç°-future-ç±»å‹" class="table-of-contents__link toc-highlight">12.3.3. åŠ¨æ‰‹å®ç° Future ç±»å‹</a></li><li><a href="#1234-åŠ¨æ‰‹å®ç°-å¼‚æ­¥-sleep" class="table-of-contents__link toc-highlight">12.3.4. åŠ¨æ‰‹å®ç° å¼‚æ­¥ sleep</a></li></ul></li><li><a href="#124-async-std" class="table-of-contents__link toc-highlight">12.4. async-std</a></li><li><a href="#125-tokio" class="table-of-contents__link toc-highlight">12.5. tokio</a></li><li><a href="#141-tcp" class="table-of-contents__link toc-highlight">14.1. tcp</a></li><li><a href="#142-udp" class="table-of-contents__link toc-highlight">14.2. udp</a></li><li><a href="#191-http-ä»£ç†" class="table-of-contents__link toc-highlight">19.1. http ä»£ç†</a></li><li><a href="#192-socket-ä»£ç†" class="table-of-contents__link toc-highlight">19.2. socket ä»£ç†</a></li><li><a href="#211-äº‹å®ä¸Šçš„æ ‡å‡†åº“" class="table-of-contents__link toc-highlight">21.1. äº‹å®ä¸Šçš„æ ‡å‡†åº“</a></li><li><a href="#212-markdown" class="table-of-contents__link toc-highlight">21.2. markdown</a></li><li><a href="#213-æ¡Œé¢å¼€å‘" class="table-of-contents__link toc-highlight">21.3. æ¡Œé¢å¼€å‘</a></li><li><a href="#214-è§†é¢‘å¤„ç†" class="table-of-contents__link toc-highlight">21.4. è§†é¢‘å¤„ç†</a></li><li><a href="#215-å›¾ç‰‡å¤„ç†" class="table-of-contents__link toc-highlight">21.5. å›¾ç‰‡å¤„ç†</a></li><li><a href="#216-æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“" class="table-of-contents__link toc-highlight">21.6. æ¸¸æˆå¼€å‘ä¸‰æ–¹åº“</a></li><li><a href="#217-ç³»ç»Ÿä¿¡æ¯" class="table-of-contents__link toc-highlight">21.7. ç³»ç»Ÿä¿¡æ¯</a></li><li><a href="#218-web-å¼€å‘å‘" class="table-of-contents__link toc-highlight">21.8. web å¼€å‘å‘</a><ul><li><a href="#2181-swagger-openapi-ç”Ÿæˆ" class="table-of-contents__link toc-highlight">21.8.1. swagger openapi ç”Ÿæˆ</a></li><li><a href="#2182-webæ¡†æ¶" class="table-of-contents__link toc-highlight">21.8.2. webæ¡†æ¶</a></li><li><a href="#2183-orm" class="table-of-contents__link toc-highlight">21.8.3. orm</a></li><li><a href="#2184-http-client" class="table-of-contents__link toc-highlight">21.8.4. http client</a></li></ul></li><li><a href="#219-åºåˆ—åŒ–ååºåˆ—åŒ–" class="table-of-contents__link toc-highlight">21.9. åºåˆ—åŒ–ååºåˆ—åŒ–</a><ul><li><a href="#2191-toml" class="table-of-contents__link toc-highlight">21.9.1. toml</a></li><li><a href="#2192-json" class="table-of-contents__link toc-highlight">21.9.2. json</a></li></ul></li><li><a href="#2110-è¯»å†™æ•°æ®" class="table-of-contents__link toc-highlight">21.10. è¯»å†™æ•°æ®</a></li><li><a href="#2111-å¢å¼ºå·¥å…·" class="table-of-contents__link toc-highlight">21.11. å¢å¼ºå·¥å…·</a></li><li><a href="#2112-æˆæƒ-authorization" class="table-of-contents__link toc-highlight">21.12. æˆæƒ Authorization</a></li><li><a href="#2113-æ—¥å¿—ç³»ç»Ÿ" class="table-of-contents__link toc-highlight">21.13. æ—¥å¿—ç³»ç»Ÿ</a><ul><li><a href="#21131-tracing" class="table-of-contents__link toc-highlight">21.13.1. tracing</a></li><li><a href="#21132-env_logger" class="table-of-contents__link toc-highlight">21.13.2. env_logger</a></li><li><a href="#21133-log4rs-and-log" class="table-of-contents__link toc-highlight">21.13.3. log4rs and log</a></li></ul></li><li><a href="#2114-æ–‡æœ¬è§£æå™¨-parser" class="table-of-contents__link toc-highlight">21.14. æ–‡æœ¬è§£æå™¨ parser</a></li><li><a href="#2115-lazy-static-å»¶è¿Ÿåˆå§‹åŒ–" class="table-of-contents__link toc-highlight">21.15. lazy static å»¶è¿Ÿåˆå§‹åŒ–</a></li><li><a href="#2116-ç”µå­ä¹¦" class="table-of-contents__link toc-highlight">21.16. ç”µå­ä¹¦</a></li><li><a href="#2117-å‘½ä»¤è¡Œç¨‹åº" class="table-of-contents__link toc-highlight">21.17. å‘½ä»¤è¡Œç¨‹åº</a><ul><li><a href="#21171-structopt" class="table-of-contents__link toc-highlight">21.17.1. structopt</a></li><li><a href="#21172-clap" class="table-of-contents__link toc-highlight">21.17.2. clap</a></li></ul></li><li><a href="#2118-å¼‚æ­¥ç¼–ç¨‹" class="table-of-contents__link toc-highlight">21.18. å¼‚æ­¥ç¼–ç¨‹</a></li><li><a href="#2119-websocket" class="table-of-contents__link toc-highlight">21.19. websocket</a></li><li><a href="#2120-ç¼©å°ä½“ç§¯" class="table-of-contents__link toc-highlight">21.20. ç¼©å°ä½“ç§¯</a></li><li><a href="#2121-http-client" class="table-of-contents__link toc-highlight">21.21. http client</a></li><li><a href="#2122-å®¹é”™è¿è¡Œæ—¶" class="table-of-contents__link toc-highlight">21.22. å®¹é”™è¿è¡Œæ—¶</a></li><li><a href="#2123-ç›‘æ§" class="table-of-contents__link toc-highlight">21.23. ç›‘æ§</a></li><li><a href="#2124-ç”µå­é‚®ä»¶" class="table-of-contents__link toc-highlight">21.24. ç”µå­é‚®ä»¶</a></li><li><a href="#2125-åˆ†å‘å·¥å…·" class="table-of-contents__link toc-highlight">21.25. åˆ†å‘å·¥å…·</a></li><li><a href="#2126-å¹¶å‘ç¼–ç¨‹" class="table-of-contents__link toc-highlight">21.26. å¹¶å‘ç¼–ç¨‹</a></li><li><a href="#2127-gui-å›¾å½¢åº“" class="table-of-contents__link toc-highlight">21.27. gui å›¾å½¢åº“</a></li><li><a href="#2128-åº•å±‚ç½‘ç»œ-api" class="table-of-contents__link toc-highlight">21.28. åº•å±‚ç½‘ç»œ api</a></li><li><a href="#2129-æ­£åˆ™" class="table-of-contents__link toc-highlight">21.29. æ­£åˆ™</a></li><li><a href="#2130-éšæœº" class="table-of-contents__link toc-highlight">21.30. éšæœº</a><ul><li><a href="#21301-rand-éšæœºæ•°å­—" class="table-of-contents__link toc-highlight">21.30.1. rand éšæœºæ•°å­—</a></li></ul></li><li><a href="#2131-æœç´¢å¼•æ“" class="table-of-contents__link toc-highlight">21.31. æœç´¢å¼•æ“</a></li><li><a href="#2132-å¼€æºé›†åˆå®¹å™¨" class="table-of-contents__link toc-highlight">21.32. å¼€æºé›†åˆå®¹å™¨</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">å†å²</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tags">æ ‡ç­¾</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">å½’æ¡£</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾äº¤åª’ä½“</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">å…³äºæˆ‘</a></li><li class="footer__item"><a href="https://github.com/xiaoyureed" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/xiaoyuhfq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/3fPgwd3naN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/friends">å‹é“¾</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/resource">å¯¼èˆª</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Xiaoyureed, Inc. Built with â¤ï¸ by xiaoyu.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.93472f92.js"></script>
<script src="/assets/js/main.c24d32c9.js"></script>
</body>
</html>