<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-docker-note-virtual-dev-env">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Docker Note &amp; Other Virtual Develop Environment - Xiaoyureed çš„ç½‘ç»œ Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xiaoyureed.github.io/img/logo.webp"><meta data-rh="true" name="twitter:image" content="https://xiaoyureed.github.io/img/logo.webp"><meta data-rh="true" property="og:url" content="https://xiaoyureed.github.io/docs/docker-note-virtual-dev-env"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="keywords" content="xiaoyureed"><meta data-rh="true" name="keywords" content="blog, java, spring, microservice, python, rust, typescript, react, web"><meta data-rh="true" name="keywords" content=" åŠè·¯è½¬è¡Œçš„ç¼–ç¨‹çˆ±å¥½è€…, å†™è¿‡ Python, Rust, ç°åœ¨ä¸»æ”» Java åˆ†å¸ƒå¼ç³»ç»Ÿ"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker Note &amp; Other Virtual Develop Environment - Xiaoyureed çš„ç½‘ç»œ Wiki"><meta data-rh="true" name="description" content="https://github.com/yeasy/docker_practice"><meta data-rh="true" property="og:description" content="https://github.com/yeasy/docker_practice"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xiaoyureed.github.io/docs/docker-note-virtual-dev-env"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/en/docs/docker-note-virtual-dev-env" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/docker-note-virtual-dev-env" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/docker-note-virtual-dev-env" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5SAMPKXTP9-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Xiaoyureed çš„ç½‘ç»œ Wiki" href="/opensearch.xml">


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f6da56a47f5085d1e0fedae39b8de00a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="xiaoyureed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="xiaoyureed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="xiaoyureed JSON Feed">

<link rel="icon" href="/img/logo.webp">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)">
<meta name="description" content="Xiaoyureed çš„ä¸ªäººåšå®¢"><link rel="stylesheet" href="/assets/css/styles.d08d09a2.css">
<link rel="preload" href="/assets/js/runtime~main.fcfce0fe.js" as="script">
<link rel="preload" href="/assets/js/main.c0b909ce.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><a href="/docs/rust-note" target="_blank">Rust æŒ‡åŒ—, æ¬¢è¿æŸ¥çœ‹...</a></div><button type="button" aria-label="å…³é—­" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="ä¸»å¯¼èˆª" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">èœå•</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/archive">åšå®¢</a></li><li><a class="dropdown__link" href="/docs/intro">æ•™ç¨‹</a></li><li><a class="dropdown__link" href="/resource">å¯¼èˆª</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"><b></b></a><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/SpringBoot-note">Spring Boot å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/autohotkey">Autohotkey è„šæœ¬</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/blockchain">blockchainåŒºå—é“¾</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/c-sharp-and-dot-net">C# &amp; .NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/chatgpt">Chatgpt Usage Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cpp">CPP and C å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cross-gfw">Cross The GFW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cs-note">Computer Science Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/css-pre-processor">å‡ ç§CSSé¢„å¤„ç†å™¨æ¯”è¾ƒé€‰å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/data-structure-and-algorithm">Data Structure and Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/design-pattern-note">Design Pattern ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-resources">å¼€å‘è€…èµ„æº</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/distributed-system">Distributed System åˆ†å¸ƒå¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/docker-note-virtual-dev-env">Docker Note &amp; Other Virtual Develop Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/effective-java-reading-note">Effective Java é˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/elk-elastic-log">Distributed log collectionåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/english-note">è‹±è¯­å­¦ä¹ ğŸ”¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/extjs-note">Extjs ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/git-note">Git å¤‡å¿˜ ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/golang-note">Golang ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/gps-gis-tracing">åŸºäºåœ°ç†ä½ç½®å¼€å‘æŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/gradle">Gradle note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/greasy-monkey">æ²¹çŒ´æ’ä»¶&amp;ç¼–å†™è„šæœ¬ğŸ’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/groovy-note">groovy note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/health">Health å…³çˆ±ç¨‹åºå‘˜å¥åº·ğŸ¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/how-to-test-java-app">How to Test Java App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/interview-system-design">ç³»ç»Ÿè®¾è®¡ System design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/iot">Iot ç‰©è”ç½‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-code-clean">Java Clean Code Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-concurrent">Java ConcurrentğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-memory-model-jmm-jvm">JMM and GCğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/java-note">Java Core ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/js-tutorial">JavaScript tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/kotlin">kotlin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/kubernetes-k8s">kubernetes-k8s â˜ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux-note">é¸Ÿå“¥çš„ Linux ç§æˆ¿èœé˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/low-code-platform">Low code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mac">Mac å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/machine-learning-ml">machine-learning-ml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/marketing-seo">Marketing SEO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/maven-note">Maven NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/message-queue">Message QueueğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/money">Investment Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mongodb-note">MongoDB NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/monitor-system-grafana-prometheus-influxdb-hbase">monitor-system-grafana-prometheusç›‘æ§ğŸ–¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mvc-mvvm">MVC to MVVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mybatis-note">MyBatis Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/netty-note">netty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nlp-natural-language-processing">nlp-natural-language-processingğŸ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nodejs-yarn-npm">Nodejs, Yarn, Npm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/oracle">Oracle å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-audio-video">Audio and Video development Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-big-data-introduce">å¤§æ•°æ®å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-cache">Cache ç¼“å­˜ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-computational-ad">è®¡ç®—å¹¿å‘Š Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-crawler-spider">ç½‘ç»œçˆ¬è™« Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-db-design-note">å…³ç³»å‹æ•°æ®åº“è¡¨è®¾è®¡ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-desktop-develop">æ¡Œé¢åº”ç”¨å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-http-restful">HTTP protocol Intro &amp; RESTful</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-reactive-programming">å“åº”å¼ç¼–ç¨‹ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-rpc">RPC Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/outline-about-rule-engine-note">è§„åˆ™å¼•æ“ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/php-note">PHP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/postgres-note">Postgres noteğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/process-workflow-bpm-engine">å·¥ä½œæµå¼•æ“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/protect-your-app-authentication-oauth2-jwt-https">Protect Your App å®‰å…¨ä¿æŠ¤è®¤è¯é‰´æƒğŸ”‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/python-note">PythonğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quant-money">é‡åŒ–äº¤æ˜“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quarkus">Quarkus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/react-note">ReactğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/real-time-communication-protocol">å®æ—¶é€šä¿¡ Real-time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/redis-note">RedisğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/regex">Regular Expression æ­£åˆ™ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/rust-note">Rust ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/scala-akka-play-framework">Scala è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/serverless">Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/service-mesh">service mesh æœåŠ¡ç½‘æ ¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/servlet">Servlet Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/shell-bash-note">shell-bashè„šæœ¬æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/spring-note">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/springcloud-note">Spring Cloud ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/springmvc-note">Spring MVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/task-schedule-note">Task Schedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tcp-ip-note-p2p">TCP IP, p2p</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tomcat-jetty-nginx">Tomcat Jetty Nginx ç­‰ web å®¹å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/vertx">Vertx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/video-creator">æ‹æ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webassembly">webassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webpack-esbuild-vite-rollup">å‰ç«¯æ‰“åŒ…æ„å»ºå·¥å…·</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/windows-sub-system-on-linux">WSL ä½¿ç”¨</a></li></ul></nav><button type="button" title="æ”¶èµ·ä¾§è¾¹æ " aria-label="æ”¶èµ·ä¾§è¾¹æ " class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Docker Note &amp; Other Virtual Develop Environment</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>Docker Note &amp; Other Virtual Develop Environment</h1></header><div align="center"><p><a href="https://github.com/yeasy/docker_practice" target="_blank" rel="noopener noreferrer">https://github.com/yeasy/docker_practice</a></p><p><a href="https://vuepress.mirror.docker-practice.com/" target="_blank" rel="noopener noreferrer">https://vuepress.mirror.docker-practice.com/</a></p><p>æ›¿ä»£å“:
containerd <a href="https://github.com/containerd/containerd/" target="_blank" rel="noopener noreferrer">https://github.com/containerd/containerd/</a>
Podman
CRI-O <a href="https://github.com/cri-o/cri-o" target="_blank" rel="noopener noreferrer">https://github.com/cri-o/cri-o</a>
å‚è€ƒ:
<a href="https://juejin.cn/post/7005393730131722247" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7005393730131722247</a>
<a href="https://segmentfault.com/a/1190000040633750" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000040633750</a>
<a href="https://www.modb.pro/db/43692" target="_blank" rel="noopener noreferrer">https://www.modb.pro/db/43692</a></p><p>Docker Note | reference: <a href="https://docker_practice.gitee.io/image/dockerfile/healthcheck.html" target="_blank" rel="noopener noreferrer">1</a>, <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer">2</a>, <a href="https://github.com/docker-library/docs" target="_blank" rel="noopener noreferrer">3</a>
<a href="https://blog.csdn.net/zmx729618/article/details/72930474" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/zmx729618/article/details/72930474</a></p><p><a href="https://labs.play-with-docker.com/" target="_blank" rel="noopener noreferrer">docker online</a></p><p><a href="https://www.katacoda.com/" target="_blank" rel="noopener noreferrer">å¿«é€Ÿçš„å®éªŒç¯å¢ƒ</a></p><p><a href="https://github.com/wsargent/docker-cheat-sheet" target="_blank" rel="noopener noreferrer">https://github.com/wsargent/docker-cheat-sheet</a> é€ŸæŸ¥è¡¨</p><p><a href="https://github.com/docker/kitematic" target="_blank" rel="noopener noreferrer">https://github.com/docker/kitematic</a> å¯è§†åŒ–ç®¡ç†gui</p></div><ul><li><a href="#1-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4">1. å¸¸ç”¨æŒ‡ä»¤</a></li><li><a href="#2-%E5%BC%80%E5%90%AF%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5">2. å¼€å¯è¿œç¨‹è¿æ¥</a></li><li><a href="#3-shipyard-ui%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2">3. shipyard uiç®¡ç†ç•Œé¢</a></li><li><a href="#4-%E4%BB%8B%E7%BB%8D">4. ä»‹ç»</a><ul><li><a href="#41-%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84">4.1. åŸºæœ¬æ¶æ„</a></li><li><a href="#42-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-%E5%BE%97%E5%88%B0%E4%BB%80%E4%B9%88%E5%A5%BD%E5%A4%84">4.2. ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„</a></li><li><a href="#43-%E5%AE%B9%E5%99%A8%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8E%9F%E7%90%86">4.3. å®¹å™¨å®ç°çš„åŸç†</a></li></ul></li><li><a href="#5-%E5%AE%89%E8%A3%85">5. å®‰è£…</a><ul><li><a href="#51-ubuntu-22-install-docker">5.1. ubuntu 22 install docker</a></li><li><a href="#52-%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F">5.2. ä½¿ç”¨å›½å†…é•œåƒ</a></li></ul></li><li><a href="#6-%E9%95%9C%E5%83%8F-image">6. é•œåƒ image</a><ul><li><a href="#61-packaging-image-%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA">6.1. packaging image å¯¼å…¥å¯¼å‡º</a></li><li><a href="#62-%E7%89%88%E6%9C%AC%E5%91%BD%E5%90%8D%E6%84%8F%E4%B9%89">6.2. ç‰ˆæœ¬å‘½åæ„ä¹‰</a></li><li><a href="#63-%E9%95%9C%E5%83%8F%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86">6.3. é•œåƒå®ç°åŸç†</a></li><li><a href="#64-%E8%8E%B7%E5%8F%96%E9%95%9C%E5%83%8F">6.4. è·å–é•œåƒ</a></li><li><a href="#65-%E8%BF%90%E8%A1%8C%E9%95%9C%E5%83%8F">6.5. è¿è¡Œé•œåƒ</a></li><li><a href="#66-%E5%88%97%E5%87%BA%E9%95%9C%E5%83%8F">6.6. åˆ—å‡ºé•œåƒ</a></li><li><a href="#67-%E5%88%A0%E9%99%A4%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F">6.7. åˆ é™¤æœ¬åœ°é•œåƒ</a></li></ul></li><li><a href="#7-%E5%88%B6%E4%BD%9C%E9%95%9C%E5%83%8F%E7%9A%84%E6%96%B9%E6%B3%95">7. åˆ¶ä½œé•œåƒçš„æ–¹æ³•</a><ul><li><a href="#71-work-with-golang">7.1. work with golang</a></li><li><a href="#72-working-with-frontend">7.2. working with frontend</a></li><li><a href="#73-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-%E4%BC%98%E5%8C%96%E4%BD%93%E7%A7%AF">7.3. æœ€ä½³å®è·µ ä¼˜åŒ–ä½“ç§¯</a></li><li><a href="#74-%E9%80%9A%E8%BF%87-dockerfile-%E6%9D%A5-build-%E9%95%9C%E5%83%8F">7.4. é€šè¿‡ dockerfile æ¥ build é•œåƒ</a></li><li><a href="#75-commit%E5%AE%B9%E5%99%A8%E6%88%90%E4%B8%BA%E9%95%9C%E5%83%8F%E4%B8%8D%E6%8E%A8%E8%8D%90">7.5. commitå®¹å™¨æˆä¸ºé•œåƒ(ä¸æ¨è)</a></li><li><a href="#76-%E4%BB%8E%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%AF%BC%E5%85%A5">7.6. ä»å‹ç¼©åŒ…å¯¼å…¥</a></li><li><a href="#77-docker-save-%E5%92%8C-docker-load">7.7. docker save å’Œ docker load</a></li></ul></li><li><a href="#8-dockerfile">8. Dockerfile</a><ul><li><a href="#81-from">8.1. from</a></li><li><a href="#82-%E9%95%9C%E5%83%8F%E7%9A%84%E6%9E%84%E5%BB%BA%E4%B8%8A%E4%B8%8B%E6%96%87context">8.2. é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡context</a><ul><li><a href="#821-dockerignore">8.2.1. dockerignore</a></li></ul></li><li><a href="#83-copy-%E5%92%8C-add">8.3. COPY å’Œ ADD</a></li><li><a href="#84-workdir-%E6%8C%87%E5%AE%9A%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95">8.4. WORKDIR æŒ‡å®šå·¥ä½œç›®å½•</a></li><li><a href="#85-run-cmd-%E5%92%8C-entrypoint-%E5%AE%B9%E5%99%A8%E5%90%AF%E5%8A%A8%E5%91%BD%E4%BB%A4">8.5. run cmd å’Œ entrypoint å®¹å™¨å¯åŠ¨å‘½ä»¤</a><ul><li><a href="#851-%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA">8.5.1. è®¾ç½®æ—¶åŒº</a></li><li><a href="#852-%E5%B8%B8%E8%A7%81%E7%9A%84%E9%94%99%E8%AF%AF%E7%94%A8%E6%B3%95">8.5.2. å¸¸è§çš„é”™è¯¯ç”¨æ³•</a></li><li><a href="#853-%E9%83%BD%E6%94%AF%E6%8C%81%E4%B8%A4%E7%A7%8D%E6%A0%BC%E5%BC%8F-shell-%E5%92%8C-exec-%E7%9A%84%E5%8C%BA%E5%88%AB">8.5.3. éƒ½æ”¯æŒä¸¤ç§æ ¼å¼ shell å’Œ exec çš„åŒºåˆ«</a></li><li><a href="#854-run">8.5.4. run</a><ul><li><a href="#8541-%E5%85%B8%E5%9E%8B%E9%94%99%E8%AF%AF">8.5.4.1. å…¸å‹é”™è¯¯</a></li></ul></li><li><a href="#855-cmd%E6%8C%87%E4%BB%A4">8.5.5. cmdæŒ‡ä»¤</a></li><li><a href="#856-entrypoint-%E5%85%A5%E5%8F%A3%E7%82%B9">8.5.6. ENTRYPOINT å…¥å£ç‚¹</a><ul><li><a href="#8561-eg-%E8%AE%A9%E9%95%9C%E5%83%8F%E5%8F%98%E6%88%90%E5%83%8F%E5%91%BD%E4%BB%A4%E4%B8%80%E6%A0%B7%E4%BD%BF%E7%94%A8">8.5.6.1. eg: è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨</a></li><li><a href="#8562-eg-%E5%BA%94%E7%94%A8%E8%BF%90%E8%A1%8C%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">8.5.6.2. eg: åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œ</a></li></ul></li></ul></li><li><a href="#86-env-%E5%92%8C-arg-%E8%AE%BE%E7%BD%AE%E5%8F%98%E9%87%8F">8.6. ENV å’Œ arg è®¾ç½®å˜é‡</a></li><li><a href="#87-volume-%E5%AE%9A%E4%B9%89%E5%8C%BF%E5%90%8D%E6%95%B0%E6%8D%AE%E5%8D%B7">8.7. VOLUME å®šä¹‰åŒ¿åæ•°æ®å·</a></li><li><a href="#88-expose-%E5%A3%B0%E6%98%8E%E7%AB%AF%E5%8F%A3">8.8. EXPOSE å£°æ˜ç«¯å£</a></li><li><a href="#89-user-%E6%8C%87%E5%AE%9A%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7">8.9. USER æŒ‡å®šå½“å‰ç”¨æˆ·</a></li><li><a href="#810-healthcheck-%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5">8.10. HEALTHCHECK å¥åº·æ£€æŸ¥</a></li><li><a href="#811-onbuild-%E7%BB%99%E5%88%AB%E4%BA%BA%E7%94%A8">8.11. ONBUILD ç»™åˆ«äººç”¨</a></li><li><a href="#812-multi-stage-%E5%A4%9A%E9%98%B6%E6%AE%B5%E6%9E%84%E5%BB%BA">8.12. multi-stage å¤šé˜¶æ®µæ„å»º</a><ul><li><a href="#8121-%E6%B8%85%E7%90%86%E7%BC%93%E5%AD%98%E7%9A%84%E9%95%9C%E5%83%8F">8.12.1. æ¸…ç†ç¼“å­˜çš„é•œåƒ</a></li></ul></li></ul></li><li><a href="#9-%E4%BD%BF%E7%94%A8%E5%AE%B9%E5%99%A8">9. ä½¿ç”¨å®¹å™¨</a><ul><li><a href="#91-use-docker-in-github-action">9.1. use docker in github action</a></li><li><a href="#92-%E6%9F%A5%E7%9C%8B">9.2. æŸ¥çœ‹</a></li><li><a href="#93-%E5%90%AF%E5%8A%A8">9.3. å¯åŠ¨</a><ul><li><a href="#931--it-%E7%BB%B4%E6%8C%81%E4%BA%A4%E4%BA%92%E7%BB%88%E7%AB%AF">9.3.1. -it ç»´æŒäº¤äº’ç»ˆç«¯</a></li><li><a href="#932--d-%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C">9.3.2. -d åå°è¿è¡Œ</a></li><li><a href="#933---privilegedtrue-%E8%B5%8B%E4%BA%88%E7%89%B9%E6%9D%83">9.3.3. --privileged=true èµ‹äºˆç‰¹æƒ</a></li></ul></li><li><a href="#94-%E7%BB%88%E6%AD%A2container">9.4. ç»ˆæ­¢container</a></li><li><a href="#95-%E5%88%A0%E9%99%A4container">9.5. åˆ é™¤container</a></li><li><a href="#96-%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8">9.6. è¿›å…¥å®¹å™¨</a></li><li><a href="#97-%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA">9.7. å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡º</a></li><li><a href="#98-%E6%8B%B7%E8%B4%9D%E5%AE%B9%E5%99%A8%E5%86%85%E6%96%87%E4%BB%B6%E5%88%B0%E4%B8%BB%E6%9C%BA">9.8. æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœº</a></li></ul></li><li><a href="#10-%E8%AE%BF%E9%97%AE%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93">10. è®¿é—®é•œåƒä»“åº“</a><ul><li><a href="#101-dockerhub">10.1. dockerhub</a><ul><li><a href="#1011-publish-by-using-github-action">10.1.1. publish by using github action</a></li></ul></li><li><a href="#102-%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93">10.2. ç§æœ‰ä»“åº“</a><ul><li><a href="#allow-http">allow http</a></li><li><a href="#harbor%E6%8E%A8%E8%8D%90">harbor(æ¨è)</a><ul><li><a href="#k8s-%E9%85%8D%E7%BD%AEharbor">k8s é…ç½®harbor</a></li></ul></li><li><a href="#nexus">Nexus</a></li><li><a href="#docker-registry">docker-registry</a></li></ul></li></ul></li><li><a href="#11-docker%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86">11. dockeræ•°æ®ç®¡ç†</a><ul><li><a href="#111-%E6%95%B0%E6%8D%AE%E5%8D%B7">11.1. æ•°æ®å·</a></li><li><a href="#112-%E6%8C%82%E8%BD%BD%E4%B8%BB%E6%9C%BA%E7%9B%AE%E5%BD%95">11.2. æŒ‚è½½ä¸»æœºç›®å½•</a></li><li><a href="#113-volume-%E7%9A%84%E5%85%B1%E4%BA%AB">11.3. volume çš„å…±äº«</a></li></ul></li><li><a href="#12-%E7%BD%91%E7%BB%9C%E4%BA%92%E8%81%94">12. ç½‘ç»œäº’è”</a><ul><li><a href="#121-docker-%E9%BB%98%E8%AE%A4%E5%88%9D%E5%A7%8B%E5%88%9B%E5%BB%BA3-%E4%B8%AA%E7%BD%91%E7%BB%9C">12.1. docker é»˜è®¤åˆå§‹åˆ›å»º3 ä¸ªç½‘ç»œ</a></li><li><a href="#124-%E5%88%9B%E5%BB%BA%E5%9B%BA%E5%AE%9Aip">12.4. åˆ›å»ºå›ºå®šip</a></li><li><a href="#125-%E6%9F%A5%E7%9C%8Bcontainer%E7%9A%84ip">12.5. æŸ¥çœ‹containerçš„ip</a></li><li><a href="#126-%E5%A4%96%E9%83%A8%E8%AE%BF%E9%97%AE%E5%AE%B9%E5%99%A8">12.6. å¤–éƒ¨è®¿é—®å®¹å™¨</a></li><li><a href="#127-%E5%AE%B9%E5%99%A8%E4%BA%92%E8%81%94">12.7. å®¹å™¨äº’è”</a></li><li><a href="#128-%E9%85%8D%E7%BD%AEdns-%E5%92%8C-%E4%B8%BB%E6%9C%BA%E5%90%8D-hostname">12.8. é…ç½®dns å’Œ ä¸»æœºå hostname</a></li></ul></li><li><a href="#13-docker-compose">13. docker-compose</a><ul><li><a href="#131-some-significant-materials">13.1. some significant materials</a></li><li><a href="#132-compose%E7%AE%80%E4%BB%8B">13.2. composeç®€ä»‹</a></li><li><a href="#133-%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8">13.3. å‘½ä»¤ä½¿ç”¨</a><ul><li><a href="#1331-up">13.3.1. up</a></li><li><a href="#1332-run">13.3.2. run</a></li><li><a href="#1333-scale">13.3.3. scale</a></li><li><a href="#1334-start">13.3.4. start</a></li><li><a href="#1335-build">13.3.5. build</a></li><li><a href="#1336-config">13.3.6. config</a></li><li><a href="#1337-exec">13.3.7. exec</a></li><li><a href="#1338-images">13.3.8. images</a></li><li><a href="#1339-kill">13.3.9. kill</a></li><li><a href="#13310-down">13.3.10. down</a></li><li><a href="#13311-pause">13.3.11. pause</a></li><li><a href="#13312-unpause">13.3.12. unpause</a></li><li><a href="#13313-restart">13.3.13. restart</a></li><li><a href="#13314-stop">13.3.14. stop</a></li><li><a href="#13315-rm">13.3.15. rm</a></li><li><a href="#13316-logs">13.3.16. logs</a></li><li><a href="#13317-top">13.3.17. top</a></li><li><a href="#13318-version">13.3.18. version</a></li><li><a href="#13319-port">13.3.19. port</a></li><li><a href="#13320-ps">13.3.20. ps</a></li><li><a href="#13321-pull">13.3.21. pull</a></li><li><a href="#13322-push">13.3.22. push</a></li></ul></li><li><a href="#134-docker-composeyml">13.4. docker-compose.yml</a></li></ul></li><li><a href="#14-docker-machine">14. docker-machine</a></li><li><a href="#15-docker-swarmswarm-mode">15. docker-swarm,swarm-mode</a></li><li><a href="#16-docker%E5%AE%9E%E8%B7%B5">16. dockerå®è·µ</a><ul><li><a href="#nacos">nacos</a></li><li><a href="#161-%E6%90%AD%E5%BB%BA%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F">16.1. æ­å»ºæŒç»­é›†æˆç³»ç»Ÿ</a></li><li><a href="#162-docker%E5%92%8Cspringboot">16.2. dockerå’Œspringboot</a></li><li><a href="#163-oracle11g">16.3. oracle11g</a></li><li><a href="#164-%E4%BD%BF%E7%94%A8-mysql-%E9%95%9C%E5%83%8F">16.4. ä½¿ç”¨ mysql é•œåƒ</a></li><li><a href="#165-%E4%BD%BF%E7%94%A8postgres%E9%95%9C%E5%83%8F">16.5. ä½¿ç”¨postgresé•œåƒ</a></li><li><a href="#166-%E4%BD%BF%E7%94%A8-rabbitmq%E9%95%9C%E5%83%8F">16.6. ä½¿ç”¨ rabbitmqé•œåƒ</a></li><li><a href="#167-redis%E9%95%9C%E5%83%8F">16.7. redisé•œåƒ</a></li><li><a href="#168-ubuntu%E9%95%9C%E5%83%8F">16.8. ubuntué•œåƒ</a></li><li><a href="#169-zookeeper">16.9. zookeeper</a></li><li><a href="#1610-kafka">16.10. kafka</a></li><li><a href="#1611-rabbitmq">16.11. rabbitmq</a></li><li><a href="#1612-zipkin">16.12. zipkin</a></li><li><a href="#1613-nginx">16.13. nginx</a></li><li><a href="#1614-mongodb">16.14. mongodb</a></li><li><a href="#1615-gitlab">16.15. gitlab</a></li><li><a href="#1616-etcd">16.16. etcd</a></li><li><a href="#1617-influxdb">16.17. influxdb</a></li></ul></li><li><a href="#17-vagrant">17. vagrant</a><ul><li><a href="#171-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">17.1. åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#172-vagrant-%E8%AE%BE%E7%BD%AE-ip">17.2. vagrant è®¾ç½® ip</a></li><li><a href="#173-virtualbox%E5%9B%9B%E7%A7%8D%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F">17.3. VirtualBoxå››ç§ç½‘ç»œæ¨¡å¼</a></li></ul></li><li><a href="#18-kali">18. kali</a></li><li><a href="#19-%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1-macvlan">19. è™šæ‹Ÿç½‘å¡ macvlan</a></li><li><a href="#20-multipass">20. Multipass</a></li><li><a href="#21-drone">21. drone</a></li></ul><h1>1. å¸¸ç”¨æŒ‡ä»¤</h1><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker -v # ç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker version # client, server ç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿™ç§æ–¹å¼å¯èƒ½ä¸å‡†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ¨è ps -ef | grep &lt;container id&gt; æ‰¾åˆ° æ‰¾åˆ°å®¹å™¨å¯¹åº”çš„è¿›ç¨‹, ç„¶åé€šè¿‡ top &lt;pid &gt; æŸ¥çœ‹å®é™…å†…å­˜, cpu å ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker stats # ç›‘è§†å®¹å™¨ CPU å†…å­˜ä½¿ç”¨ç‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">########## æ›´æ–° å®¹å™¨å¯åŠ¨é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å®¹å™¨éš docker è‡ªåŠ¨å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker update &lt;container&gt; --restart=always</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker update --restart=no &lt;container-id&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">######################### prune å‘½ä»¤ (æ¸…ç†)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container prune</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker images prune</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker volume prune</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network prune</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker system prune     # åˆ é™¤ä»¥ä¸Šæ‰€æœ‰ç©ºé—²</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">####################### image ç›¸å…³</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‹‰å– docker pull</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker pull &lt;image&gt;:&lt;tag&gt;  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker images </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image ls [image_name][:tag]       #æŸ¥çœ‹æ‰€æœ‰/æŒ‡å®šçš„é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image ls -a                    #æ˜¾ç¤ºåŒ…æ‹¬ä¸­é—´å±‚é•œåƒåœ¨å†…çš„æ‰€æœ‰é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‡ªå®šä¹‰ç»“æœé•œåƒæŸ¥è¯¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image ls --format &quot;{{.ID}}: {{.Repository}}&quot;    # åˆ—å‡ºé•œåƒç»“æœï¼Œå¹¶ä¸”åªåŒ…å«é•œåƒIDå’Œä»“åº“å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image ls --format &quot;table {{.ID}}\t{{.Repository}}\t{{.Tag}}&quot; #å¸¦æ ‡é¢˜, ä½†æ˜¯è‡ªå·±å®šä¹‰åˆ—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image ls -q                        # ä»…ä»…æ˜¾ç¤ºimageçš„id</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image rm &lt;xxx&gt;                           åˆ é™¤æŒ‡å®šé•œåƒ(å¯ä»¥æ˜¯id, name....)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image rm $(docker image ls -q redis)     å’Œå…¶ä»–å‘½ä»¤é…åˆåˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image rm $(docker image ls -q -f before=mongo:3.2) é…åˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker image prune                              æ‰¹é‡æ¸…ç†ä¸´æ—¶é•œåƒæ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rmi image_name </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿‡æ»¤é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># //ä½¿ç”¨grepå’Œawkè¿‡æ»¤å¾—åˆ°é•œåƒIDã€‚(åŒ¹é…é•œåƒåç§°ä¸ºimage-bï¼Œæ ‡ç­¾ä¸ºé™¤äº†v1d0-7ä¹‹å¤–çš„å…¶ä»–è¡Œï¼Œè·å–ç¬¬ä¸‰åˆ—çš„ID)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker images | grep image-b | grep -v &quot;v1d0-7&quot; | awk  &#x27;{print $3}&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># // ä½¿ç”¨docker rmiåˆ é™¤è¿‡æ»¤å¾—åˆ°çš„é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rmi $(docker images | grep image-b | grep -v &quot;v1d0-7&quot; | awk  &#x27;{print $3}&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># // åˆ é™¤5å¤©å‰çš„é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rmi $(docker images | grep &quot;&lt;none&gt;&quot;| grep &quot;5 days ago&quot; | awk  &#x27;{print $3}&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ###########################docker machineçš„å‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker-machine ls                                  #æŸ¥çœ‹è¿è¡Œdocker serverçš„è™šæ‹Ÿæœº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker-machine create --driver=virtualbox default  #åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºç”¨äºè¿è¡Œdocker</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker-machine env [default]          #æŸ¥çœ‹ç¯å¢ƒå˜é‡(æœºå™¨ipåœ¨é‡Œé¢å¯ä»¥çœ‹åˆ°), é»˜è®¤æŸ¥çœ‹åä¸ºdefaultçš„æœºå™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">############################ docker ps</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps | less -S                 #æŸ¥çœ‹æ‰€æœ‰è¿è¡Œçš„container, æ¯æ¡è®°å½•åªå ç”¨ä¸€è¡Œæ˜¾ç¤º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps -q                # ä»…ä»…æ˜¾ç¤º id åˆ—, é…åˆ filter æ¸…ç†å®¹å™¨æ—¶éå¸¸å¥½ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps -a                       # æŸ¥çœ‹æ‰€æœ‰(åŒ…æ‹¬åœæ­¢çš„container)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps -s            # æ˜¾ç¤ºå®¹å™¨æ–‡ä»¶å¤§å° (å¦‚ 211MB (virtual 1.83GB), ä¸€ä¸ªæ˜¯å®¹å™¨çœŸå®å¢åŠ çš„å¤§å°ï¼Œä¸€ä¸ªæ˜¯æ•´ä¸ªå®¹å™¨çš„è™šæ‹Ÿå¤§å°, å®¹å™¨è™šæ‹Ÿå¤§å° = å®¹å™¨çœŸå®å¢åŠ å¤§å° + å®¹å™¨é•œåƒå¤§å°)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">###################### è¿‡æ»¤ filter</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># [-f] è¿‡æ»¤, ç­‰åŒ --filter</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># [--filter &quot;until=24h&quot;] åˆ é™¤24hä»¥å‰çš„; [--filter &quot;label!=keep&quot;]åªåˆ é™¤æ ‡ç­¾ä¸ä¸ºkeepçš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># - é€‰é¡¹åè·Ÿçš„éƒ½æ˜¯é”®å€¼å¯¹ key=value (å¯ä¸å¸¦å¼•å·ï¼‰ï¼Œå¦‚æœæœ‰å¤šä¸ªè¿‡æ»¤æ¡ä»¶ï¼Œå°±å¤šæ¬¡ä½¿ç”¨ filter é€‰é¡¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># - ç›¸åŒæ¡ä»¶ä¹‹é—´çš„å…³ç³»æ˜¯æˆ–ï¼Œä¸åŒæ¡ä»¶ä¹‹é—´çš„å…³ç³»æ˜¯ä¸</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># - id å’Œ nameï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œä½¿ç”¨èµ·æ¥éå¸¸çµæ´»ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps --filter id=a1b2c3 --filter name=bingohuang</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps --filter name=bingo --filter name=huang --filter status=running # ä»¥ä¸Šè¿‡æ»¤æ¡ä»¶ä¼šæ‰¾å‡º name åŒ…å« bingo æˆ– huang å¹¶ä¸” status ä¸º running çš„å®¹å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps --filter name=^/bingohuang$ # ç²¾ç¡®åŒ¹é… name ä¸º bingohuang çš„å®¹å™¨ã€‚æ³¨æ„ï¼Œå®¹å™¨å®é™…åç§°ï¼Œå¼€å¤´æ˜¯æœ‰ä¸€ä¸ªæ­£æ–œçº¿ / ï¼Œå¯ç”¨ docker inspect ä¸€çœ‹ä¾¿çŸ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps --filter name=.*bingohuang.* # åŒ¹é… name åŒ…å« bingohuang çš„å®¹å™¨ï¼Œå’Œ --filter name=bingohuang ä¸€ä¸ªæ•ˆæœã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ¸…ç†åç§°åŒ…å« bingohuangï¼Œä¸”çŠ¶æ€ä¸º exited æˆ– dead çš„å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rm $(docker ps -q --filter name=.*bingohuang.* --filter status=exited --filter status=dead 2&gt;/dev/null)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ########################## Format æ ¼å¼åŒ–æ˜¾ç¤º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åŸºäº Go templateï¼ˆhttps://golang.org/pkg/html/template/ï¼‰è¯­æ³•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps --format &quot;{{.ID}}: {{.Command}}&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœæƒ³å¸¦ä¸Šè¡¨æ ¼åˆ—å¤´ï¼Œéœ€è¦å† template ä¸­åŠ ä¸Š table æŒ‡ä»¤ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker ps --format &quot;table {{.ID}}\t{{.Command}}&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ”¯æŒçš„å…¶ä»–å ä½ç¬¦ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ID, Names, Image, Command, CreatedAt, RuningFor (å­˜æ´»äº†å¤šä¹…äº†), Ports, Status, Size, Mounts (volumns çš„åå­—), Networks</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># Labels (æ‰€æœ‰è´´ä¸Šçš„æ ‡ç­¾åå­—), Label (æŒ‡å®šæ ‡ç­¾åçš„æ ‡ç­¾å€¼, æ ¼å¼: &#x27;{{.Label &quot;xxx_label_value&quot;}}&#x27;), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ########################## æŸ¥çœ‹å…ƒä¿¡æ¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker system df             #æŸ¥çœ‹é•œåƒã€å®¹å™¨ã€æ•°æ®å·æ‰€å ç”¨çš„ç©ºé—´, è¿è¡ŒçŠ¶å†µ(é€šè¿‡è¡¨æ ¼çš„å½¢å¼)(å¸¸ç”¨) </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker info        # dockerçš„åŸºæœ¬ä¿¡æ¯(å¤šå°‘container, å¤šå°‘image, å„ä¸ªcontainerçŠ¶å†µ ,docker root dir)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network ls                   #æŸ¥çœ‹dockerç½‘ç»œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker build -t &lt;nginx:v3&gt; &lt;.&gt;      #æ ¹æ®Dockerfileæ„å»ºé•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # -t æŒ‡å®šé•œåƒåç§°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # . è¡¨ç¤ºæ„å»ºä¸Šä¸‹æ–‡ context ä¸ºå½“å‰ç›®å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker top &lt;id, container_name&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">######################## docker run/exec</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run &lt;IMAGE&gt; env                              æŸ¥çœ‹é•œåƒæ”¯æŒçš„ç¯å¢ƒå˜é‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run --name webserver -d -p &lt;host_port&gt;:&lt;container_port&gt; nginx       æŒ‡å®šcontaineråå­—è¿è¡Œ, ç«¯å£æ˜ å°„,  -p &lt;å®¿ä¸»ç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    * `-d` åå°è¿è¡Œ(ä¸åŠ , åˆ™å‰å°è¿è¡Œ, æ—¥å¿—è¾“å‡ºåˆ°å‰å°, ctrl+cä¸ä¼šç»ˆæ­¢container, ä½†ä¼šç»ˆæ­¢æ—¥å¿—è¾“å‡º)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    * `-p` æŒ‡å®šç«¯å£æ˜ å°„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    * `--name` æŒ‡å®šcontaineråå­—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run &lt;image_name&gt;:&lt;tag&gt; &lt;cmd&gt;                 è¿è¡ŒæŒ‡å®šé•œåƒå¯åŠ¨å®¹å™¨, å¹¶æ‰§è¡Œä¸€æ¡æŒ‡ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run image_name apt-get install -y app_name è¿è¡Œé•œåƒ, åœ¨å®¹å™¨ä¸­å®‰è£…æ–°çš„ç¨‹åº, å®Œæˆåé€€å‡º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                    * -y : ä¸è¦è¿›å…¥äº¤äº’æ¨¡å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec -itd &lt;container_name/id&gt; &lt;cmd&gt;        è¿›å…¥å®¹å™¨, æ‰§è¡Œå‘½ä»¤åé€€å‡º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                        * -d : åå°è¿è¡Œ, å»æ‰å, cmdæ‰§è¡Œå®Œæˆåä¼šå‘†åœ¨containerå†…éƒ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it --rm &lt;image_name&gt;:&lt;tag&gt; bash         è¿è¡Œå¹¶è¿›å…¥æŒ‡å®šå®¹å™¨å†…éƒ¨, æ‰“å¼€bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                        * -iï¼šäº¤äº’å¼æ“ä½œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                        * -t ç»ˆç«¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                        * --rmï¼šå®¹å™¨é€€å‡ºåéšä¹‹å°†å…¶åˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec -it webserver bash                      è¿›å…¥æŸä¸ªå®¹å™¨å†…, å¹¶æ‰§è¡Œä¸€æ¡å‘½ä»¤, ä»¥`exit` é€€å‡º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                        * ä¸æ¨è docker attach &lt;xxx&gt;, exité€€å‡º, containerä¹Ÿéšä¹‹ç»ˆæ­¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker cp &lt;container_name/id&gt;:&lt;container_path&gt; &lt;host_path&gt;      å¤åˆ¶æ–‡ä»¶, ä»containeråˆ°æœ¬æœº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># docker container</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container ls æˆ– docker ps                    è¿è¡Œç€çš„å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                        * -q : åªè¿”å›å®¹å™¨id</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container start &lt;stoped_container&gt;           å¯åŠ¨ç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container restart &lt;xxx&gt;                      é‡å¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker-compose restart &lt;service_name&gt;               å¿…é¡»åœ¨ä¸Šä¸‹æ–‡ç›®å½•, æ˜¯service name, è€Œécontainer_name</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker stop &lt;xxx&gt;                                   åœæ­¢å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container stop &lt;xxx&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker start/restart &lt;xxx&gt;                          å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker kill $(docker ps -a -q)                      åœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rm &lt;xxx&gt;                               åˆ é™¤å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rm -fv &lt;å®¹å™¨ID&gt;               åœæ­¢ã€åˆ é™¤å®¹å™¨ï¼Œå¹¶æ¸…é™¤æ•°æ® </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container rm &lt;xxx&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container prune                              åˆ é™¤æ‰€æœ‰çš„åœæ­¢çš„å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># docker inspect å®¹å™¨è¯¦ç»†ä¿¡æ¯/å®¹å™¨é…ç½®(jsonæ ¼å¼)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker inspect &lt;container&gt;                                              å®¹å™¨è¯¦ç»†ä¿¡æ¯(jsonæ ¼å¼, å¤§é‡ä¿¡æ¯ åŒ…æ‹¬ip)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker inspect -f=&#x27;{{.Name}}&#x27; $(sudo docker ps -a -q)                   æŸ¥çœ‹æ‰€æœ‰å®¹å™¨name (å¯ä»¥ä¸å¸¦ç­‰å·)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker inspect --format &#x27;{{ .NetworkSettings.IPAddress }}&#x27;  &lt;container&gt; è·å–æŒ‡å®šå®¹å™¨ip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                                            * ç”¨ $(sudo docker ps -a -q) æ›¿æ¢&lt;container&gt; è·å–æ‰€æœ‰containerçš„ip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker inspect &lt;id,container_name&gt; | grep &quot;IPAddress&quot;                   æŸ¥çœ‹ip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># docker log æŸ¥çœ‹æ—¥å¿—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker logs &lt;xxx&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container logs &lt;xxx&gt;            #  æŸ¥çœ‹æŒ‡å®šcontainerçš„æ—¥å¿—(å…¨éƒ¨)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker logs -f -t --since=&quot;2017-05-31&quot; --tail=10 &lt;container&gt;   # è¿½è¸ªæ—¥å¿—æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #* -f : æŸ¥çœ‹å®æ—¶æ—¥å¿—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #* -t : å¸¦ä¸Šæ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #* --since : æ­¤å‚æ•°æŒ‡å®šäº†è¾“å‡ºæ—¥å¿—å¼€å§‹æ—¥æœŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #* --tail=10 : å10è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># docker commit æäº¤ docker history æäº¤å†å²</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker commit \                                                 # æäº¤ä¿®æ”¹åçš„å®¹å™¨å½¢æˆæ–°çš„é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        --author &quot;Tao Wang &lt;twang2218@gmail.com&gt;&quot; \ # ä¿®æ”¹äºº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        --message &quot;ä¿®æ”¹äº†é»˜è®¤ç½‘é¡µ&quot; \ # ä¿®æ”¹è¯´æ˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        webserver \ # ä¿®æ”¹çš„container</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        nginx:v2 # ä»“åº“å:æ ‡ç­¾å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker history nginx:v2                 æŸ¥çœ‹æŒ‡å®šé•œåƒçš„å†å²æäº¤è®°å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rename &lt;oldå®¹å™¨å&gt;  &lt;newå®¹å™¨å&gt; ä¿®æ”¹å®¹å™¨åç§°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç½‘ç»œç›¸å…³å‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network create -d &lt;network-type&gt; --subnet=172.18.0.0/16 &lt;my-network&gt; # åˆ›å»ºç½‘ç»œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    * -d ç½‘ç»œç±»å‹, é»˜è®¤ bridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    * --subnet æŒ‡å®šç½‘æ®µ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network rm my-net # åˆ é™¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network connect my-net my-nginx # è¿è¡Œç€çš„ container åŠ å…¥ç½‘ç»œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network disconnect my-net my-nginx # æ–­å¼€ç½‘ç»œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -itd --name &lt;test1&gt; --network bridge --ip 172.17.0.10 &lt;centos:latest&gt; &lt;/bin/bash &gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    * ç”¨ --network å‚æ•°ï¼Œå¯ä»¥æŒ‡å®šç½‘ç»œç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    * --ip 172.17.0.10æŒ‡å®šip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>2. å¼€å¯è¿œç¨‹è¿æ¥</h1><p>ç”¨äºå¼€å‘ç¯å¢ƒ, ä¸å®‰å…¨</p><p>åŸç”Ÿ docker: <a href="https://blog.csdn.net/yjt520557/article/details/99715097" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/yjt520557/article/details/99715097</a> æˆ–è€… <a href="https://www.cnblogs.com/weiyiming007/p/10168733.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/weiyiming007/p/10168733.html</a></p><p>wsl ä¸‹çš„ docker: <a href="https://www.jianshu.com/p/c7bc8fa1ee5f" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/c7bc8fa1ee5f</a> ä¿®æ”¹ <code>/lib/systemd/system/docker.service</code></p><h1>3. shipyard uiç®¡ç†ç•Œé¢</h1><p>web ç®¡ç†æ§åˆ¶å°, ç®¡ç†å®¹å™¨, é»˜è®¤ç”¨æˆ·åå¯†ç  admin/shipyard</p><p>åŒç±»: docker-ui</p><h1>4. ä»‹ç»</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-åŸºæœ¬æ¶æ„">4.1. åŸºæœ¬æ¶æ„<a href="#41-åŸºæœ¬æ¶æ„" class="hash-link" aria-label="4.1. åŸºæœ¬æ¶æ„çš„ç›´æ¥é“¾æ¥" title="4.1. åŸºæœ¬æ¶æ„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>docker clientå’Œdocker server: dockeræ˜¯c/sæ¶æ„, clientå’Œserverå¯ä»¥åœ¨åŒä¸€å°æœºå™¨ä¹Ÿå¯ä»¥ä¸å†åŒä¸€å°æœºå™¨</p><p>Repository: å…·ä½“æŸä¸ªé•œåƒçš„ä»“åº“, åªå­˜å‚¨æŸä¸€ä¸ªé¡¹ç›®çš„é•œåƒ(æ¯”å¦‚Tomcatä¸‹é¢æœ‰å¾ˆå¤šä¸ªç‰ˆæœ¬(ç”¨tagè¡¨ç¤º)çš„é•œåƒï¼Œå®ƒä»¬å…±åŒç»„æˆäº†Tomcatçš„Repositoryã€‚)</p><p>Registry: æ‰€æœ‰çš„é•œåƒ, å®˜æ–¹ä¸ºDocker Hub, ä¹Ÿå¯ä»¥éƒ¨ç½²ç§æœ‰registry(Registryä¸Šæœ‰å¾ˆå¤šçš„Repositoryï¼ŒRedisã€Tomcatã€MySQLç­‰ç­‰Repositoryç»„æˆäº†Registryã€‚)</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„">4.2. ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„<a href="#42-ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„" class="hash-link" aria-label="4.2. ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„çš„ç›´æ¥é“¾æ¥" title="4.2. ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ä¼ ç»Ÿè™šæ‹Ÿæœºåœ¨å®¿ä¸»æ“ä½œç³»ç»Ÿä¸Šå…ˆè™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶, ç¡¬ä»¶ä¸Šå†è¿è¡Œæ“ä½œç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸Šå†è¿è¡Œæ‰€éœ€åº”ç”¨è¿›ç¨‹ï¼›</p><ul><li><p>è€Œ docker å®¹å™¨å†…çš„åº”ç”¨è¿›ç¨‹ç›´æ¥è¿è¡Œäºå®¿ä¸»çš„å†…æ ¸ï¼Œå®¹å™¨å†…æ²¡æœ‰è‡ªå·±çš„å†…æ ¸ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è¿›è¡Œç¡¬ä»¶è™šæ‹Ÿã€‚å› æ­¤å®¹å™¨è¦æ¯”ä¼ ç»Ÿè™šæ‹Ÿæœºæ›´ä¸ºè½»ä¾¿</p></li><li><p>Dockerç»™åº”ç”¨æä¾›äº†ä¸€ä¸ªä»å¼€å‘åˆ°ä¸Šçº¿  <code>ç»Ÿä¸€çš„ç¯å¢ƒ</code></p></li><li><p>æ•°æ®åº“çš„æ•°æ®ä¸æ•°æ®åº“ç¨‹åºæœ¬èº«åˆ†ç¦»å¼€ï¼šç”¨ä¸€ä¸ªcontainer Aä½œä¸ºæ•°æ®å­˜å‚¨ï¼Œç„¶åå¦ä¸€ä¸ªcontainer Bè¿è¡Œæ•°æ®åº“ã€‚å½“ä½ æƒ³å‡çº§æ•°æ®åº“æ—¶ï¼Œç”¨æ–°çš„container Cæ›¿æ¢æ‰container Bå³å¯ . <code>æ–¹ä¾¿çš„è¿ç§»åº”ç”¨</code></p></li><li><p>ä½¿ç”¨docker buildå®Œæˆå•å…ƒæµ‹è¯•(åˆ›å»ºéš”ç¦»çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•, å¦‚ç”¨jenkins ciè¿™æ ·çš„ciå·¥å…·å¯åŠ¨ä¸€ä¸ªç”¨äºæµ‹è¯•çš„container)</p></li><li><p>å°¤å…¶é€‚åˆå¾®æœåŠ¡</p><ul><li><p>åç«¯åº”ç”¨æ˜¯å¾®æœåŠ¡åŒ–çš„ï¼Œæœ‰å¾ˆå¤šä¸ªç‹¬ç«‹çš„ java åº”ç”¨ï¼Œå¼€å‘ã€æµ‹è¯•å’Œçº¿ä¸Šå¤šå¥—ç¯å¢ƒã€‚</p></li><li><p>docker ä¹‹å‰çš„éƒ¨ç½²æ–¹æ¡ˆ: æ‰“ war åŒ…ï¼Œä¸Šä¼ åˆ° ecsï¼Œé‡å¯tomcat; docker éƒ¨ç½²æ–¹æ¡ˆï¼šç¼–è¯‘æœºå™¨ä¸Šç¼–è¯‘ jar åŒ…ï¼Œæ‰“å‡º docker-imgï¼ˆæŠŠjaråŒ…æ”¾è¿›å»ï¼‰, push åˆ° docker registryï¼Œçº¿ä¸Šæœºå™¨pull docker-img, ç„¶å docker stopï¼Œ docker runã€‚</p></li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43-å®¹å™¨å®ç°çš„åŸç†">4.3. å®¹å™¨å®ç°çš„åŸç†<a href="#43-å®¹å™¨å®ç°çš„åŸç†" class="hash-link" aria-label="4.3. å®¹å™¨å®ç°çš„åŸç†çš„ç›´æ¥é“¾æ¥" title="4.3. å®¹å™¨å®ç°çš„åŸç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å®¹å™¨: æ˜¯ä¸€ä¸ª è§†å›¾éš”ç¦», èµ„æºå¯é™åˆ¶, ç‹¬ç«‹æ–‡ä»¶ç³»ç»Ÿçš„è¿›ç¨‹é›†åˆ</p><p>Linux æä¾›ä¸‰å¤§æŠ€æœ¯</p><ul><li>namespace å®ç°èµ„æºè§†å›¾éš”ç¦», å¦‚ç‹¬ç«‹çš„ä¸»æœºå, å¯ä»¥é™åˆ¶åªèƒ½çœ‹åˆ°éƒ¨åˆ†å…¶ä»–è¿›ç¨‹</li><li>cgroup æ§åˆ¶èµ„æºä½¿ç”¨ç‡, å¦‚å¯æ§åˆ¶cpu, å†…å­˜ä½¿ç”¨ç‡</li><li>chroot åˆ›å»ºç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿ , å¦‚å§æŸä¸ªç›®å½•è®¾ç½®ä¸ºå­ç³»ç»Ÿçš„æ ¹ç›®å½•</li></ul><h1>5. å®‰è£…</h1><p><a href="https://www.runoob.com/docker/ubuntu-docker-install.html" target="_blank" rel="noopener noreferrer">https://www.runoob.com/docker/ubuntu-docker-install.html</a></p><p>å®‰è£…dockerå‰æ£€æŸ¥ç¯å¢ƒæ˜¯å¦åŒ¹é…:</p><ul><li><code>uname -a</code> æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬</li><li>å‡çº§å†…æ ¸ç‰ˆæœ¬: å…ˆé€šè¿‡<code>sudo apt-get update</code> æ›´æ–°atp-get, ç„¶åé€šè¿‡<code>sudo atp-get install &lt;æŒ‡å®šlinuxå†…æ ¸&gt;</code>å®‰è£…, æœ€åé€šè¿‡<code>sudo update-grub</code>åŠ è½½æ–°å†…æ ¸. è¿˜éœ€è¦é‡å¯<code>sudo reboot</code></li><li>æ£€æŸ¥æ˜¯å¦ä»¥device mapperä½œä¸ºå­˜å‚¨é©±åŠ¨ <code>grep device-mapper /proc/devices</code></li></ul><p>å®‰è£…å‚è€ƒ: <a href="https://docs.docker.com/engine/install/centos/#install-using-the-convenience-script" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/install/centos/#install-using-the-convenience-script</a></p><p>æœ€ç®€å•çš„ <code>curl -fsSL https://get.docker.com -o get-docker.sh &amp;&amp; sudo sh get-docker.sh</code></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">sudo systemctl enable docker</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sudo systemctl start docker</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run hello-world</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-ubuntu-22-install-docker">5.1. ubuntu 22 install docker<a href="#51-ubuntu-22-install-docker" class="hash-link" aria-label="5.1. ubuntu 22 install dockerçš„ç›´æ¥é“¾æ¥" title="5.1. ubuntu 22 install dockerçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># According to the official doc , these two comand is the easiest way </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># but I occurred a issue : lsb_release can not be found</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">curl -fsSL https://get.docker.com -o get-docker.sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sudo sh ./get-docker.sh --dry-run</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># after check, this can resolve the issue above</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">apt-get update &amp;&amp; apt-get install -y lsb-release &amp;&amp; apt-get clean all</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># It&#x27;s fucking disgusting</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># finally I find this link : https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-22-04</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># https://cloudcone.com/docs/article/how-to-install-docker-on-ubuntu-22-04-20-04/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># Every thing is ok!</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52-ä½¿ç”¨å›½å†…é•œåƒ">5.2. ä½¿ç”¨å›½å†…é•œåƒ<a href="#52-ä½¿ç”¨å›½å†…é•œåƒ" class="hash-link" aria-label="5.2. ä½¿ç”¨å›½å†…é•œåƒçš„ç›´æ¥é“¾æ¥" title="5.2. ä½¿ç”¨å›½å†…é•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ailiyunåŠ é€Ÿ<a href="https://7lwsinal.mirror.aliyuncs.com" target="_blank" rel="noopener noreferrer">https://7lwsinal.mirror.aliyuncs.com</a></p><p>ä¸´æ—¶ä½¿ç”¨ <code>docker run hello-world --registry-mirror=https://docker.mirrors.ustc.edu.cn</code></p><p>æŒä¹…ä½¿ç”¨, ä¿®æ”¹ or æ–°å¢ <code>vim /etc/docker/daemon.json</code>, </p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://registry.docker-cn.com&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;http://hub-mirror.c.163.com&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">systemctl restart docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://www.cnblogs.com/nihaorz/p/12131873.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/nihaorz/p/12131873.html</a></p><h1>6. é•œåƒ image</h1><p>å¯ä»¥é€šè¿‡Dockerfileæ„å»ºimageï¼Œä¹Ÿå¯ä»¥å°†imageè¿è¡Œï¼Œä½¿å…¶å˜æˆcontainer</p><p><a href="https://juejin.cn/post/6850418112237502472" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6850418112237502472</a> å¥‡æ€ªå¼‚å¸¸</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="61-packaging-image-å¯¼å…¥å¯¼å‡º">6.1. packaging image å¯¼å…¥å¯¼å‡º<a href="#61-packaging-image-å¯¼å…¥å¯¼å‡º" class="hash-link" aria-label="6.1. packaging image å¯¼å…¥å¯¼å‡ºçš„ç›´æ¥é“¾æ¥" title="6.1. packaging image å¯¼å…¥å¯¼å‡ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker save -o local-image.tar image:tag</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker save -o local-images.tar image1:tag1 image2:tag2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># save all local images</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker save -o all-local-images-in-namespace.tar $(docker image ls --format &#x27;{{json .}}&#x27; | jq -r &#x27;select(.Repository!=&quot;&lt;none&gt;&quot;) | if (.Tag==&quot;&lt;none&gt;&quot;) then .Repository else (.Repository+&quot;:&quot;+.Tag) end&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker load &lt; local-images.tar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="62-ç‰ˆæœ¬å‘½åæ„ä¹‰">6.2. ç‰ˆæœ¬å‘½åæ„ä¹‰<a href="#62-ç‰ˆæœ¬å‘½åæ„ä¹‰" class="hash-link" aria-label="6.2. ç‰ˆæœ¬å‘½åæ„ä¹‰çš„ç›´æ¥é“¾æ¥" title="6.2. ç‰ˆæœ¬å‘½åæ„ä¹‰çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ç©ºé•œåƒscratch</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å·¥å…·é•œåƒbusybox </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  æœ¬èº«åªæœ‰ </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">16Mï¼Œéå¸¸ä¾¿äºæ„å»ºå°é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">slim  </span><span class="token maybe-class-name">Represents</span><span class="token plain"> the minimum image size</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  æ˜¯å®Œæ•´é•œåƒçš„é…å¯¹ç‰ˆæœ¬ã€‚è¿™ä¸ªé•œåƒé€šå¸¸åªå®‰è£…è¿è¡Œç‰¹å®šå·¥å…·æ‰€éœ€çš„æœ€å°åŒ…</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ç›¸æ¯”äº alpine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> å¸¦æœ‰ä¸€äº›å·¥å…·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  åœ¨ä½¿ç”¨è¿™ä¸ªé•œåƒæ—¶ï¼Œä¸€å®šè¦è¿›è¡Œå½»åº•çš„æµ‹è¯•ï¼å¦‚æœé‡åˆ°æ— æ³•è§£é‡Šçš„é”™è¯¯ï¼Œè¯·å°è¯•åˆ‡æ¢åˆ°å®Œæ•´çš„é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token maybe-class-name">Alphine</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  é«˜åº¦ç²¾ç®€åˆåŒ…å«äº†åŸºæœ¬å·¥å…·çš„è½»é‡çº§ </span><span class="token maybe-class-name">Linux</span><span class="token plain"> å‘è¡Œç‰ˆï¼ŒåŸºç¡€é•œåƒåªæœ‰ </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">41M</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ä½†æ˜¯å¤ªç²¾ç®€ï¼Œå¯èƒ½å‡ºç°ä¸€äº›å¥‡æ€ªçš„ç¯å¢ƒé—®é¢˜</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> but on the other hands it also cannot work very well </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> you wanna use some basic tools</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  using apk</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ä½¿ç”¨äº†ä¸€ä¸ªæ›´å°çš„musl libä»£æ›¿glibcã€‚å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºæœ‰ç‰¹å®šçš„libcéœ€æ±‚ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">buster  é€‚ç”¨ä¸ debian </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> apt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stretch é€‚ç”¨äº debian </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">jessie  é€‚ç”¨äº debian </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bullseyeã€bookworm   å¼€å‘ç‰ˆæœ¬ï¼Œå¤„äºæœªç¨³å®šçŠ¶æ€</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="63-é•œåƒå®ç°åŸç†">6.3. é•œåƒå®ç°åŸç†<a href="#63-é•œåƒå®ç°åŸç†" class="hash-link" aria-label="6.3. é•œåƒå®ç°åŸç†çš„ç›´æ¥é“¾æ¥" title="6.3. é•œåƒå®ç°åŸç†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>docker é•œåƒéƒ½æ˜¯å±‚å±‚å åŠ ï¼Œæ¯ä¸€å±‚éƒ½å¯èƒ½è¢«ä¸åŒçš„é•œåƒå…±äº« (åœ¨Dockerfileä¸­æ¯ä¸€æ­¥éƒ½ä¼šäº§ç”Ÿä¸€å±‚layerï¼Œæ¯ä¸€æ­¥çš„ç»“æœäº§å‡ºå˜æˆæ–‡ä»¶)</p><p>Docker ä½¿ç”¨ Union FS å°†è¿™äº›ä¸åŒçš„å±‚ç»“åˆåˆ°ä¸€ä¸ªé•œåƒä¸­å»ã€‚</p><p>é€šå¸¸ Union FS æœ‰ä¸¤ä¸ªç”¨é€”, ä¸€æ–¹é¢å¯ä»¥å®ç°ä¸å€ŸåŠ© LVMã€RAID å°†å¤šä¸ª disk æŒ‚åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹,å¦ä¸€ä¸ªæ›´å¸¸ç”¨çš„å°±æ˜¯å°†ä¸€ä¸ªåªè¯»çš„åˆ†æ”¯å’Œä¸€ä¸ªå¯å†™çš„åˆ†æ”¯è”åˆåœ¨ä¸€èµ·ï¼ŒLive CD æ­£æ˜¯åŸºäºæ­¤æ–¹æ³•å¯ä»¥å…è®¸åœ¨é•œåƒä¸å˜çš„åŸºç¡€ä¸Šå…è®¸ç”¨æˆ·åœ¨å…¶ä¸Šè¿›è¡Œä¸€äº›å†™æ“ä½œã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="64-è·å–é•œåƒ">6.4. è·å–é•œåƒ<a href="#64-è·å–é•œåƒ" class="hash-link" aria-label="6.4. è·å–é•œåƒçš„ç›´æ¥é“¾æ¥" title="6.4. è·å–é•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>é€šè¿‡ <code>docker pull --help</code> æŸ¥è¯¢å¯çŸ¥æ ¼å¼ä¸º:</p><p><code>docker pull [é€‰é¡¹] [Docker Registryåœ°å€ [:ç«¯å£å·] / ] ä»“åº“å[:æ ‡ç­¾]</code></p><ul><li><p>Docker é•œåƒä»“åº“åœ°å€çš„æ ¼å¼ä¸€èˆ¬æ˜¯ &lt;åŸŸå/IP&gt;<!-- -->[:ç«¯å£å·]<!-- -->ã€‚é»˜è®¤åœ°å€æ˜¯ Docker Hubã€‚</p></li><li><p>ä»“åº“åï¼šå¦‚ä¹‹å‰æ‰€è¯´ï¼Œè¿™é‡Œçš„ä»“åº“åæ˜¯ä¸¤æ®µå¼åç§°ï¼Œå³ &lt;ç”¨æˆ·å&gt;/&lt;è½¯ä»¶å&gt;ã€‚å¯¹äº Docker Hubï¼Œå¦‚æœä¸ç»™å‡ºç”¨æˆ·åï¼Œåˆ™é»˜è®¤ä¸º libraryï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹é•œåƒã€‚</p></li></ul><p>ä¾‹å¦‚: </p><p>docker pull ubuntu:16.04</p><p>ä¸Šé¢çš„å‘½ä»¤ä¸­æ²¡æœ‰ç»™å‡º Docker é•œåƒä»“åº“åœ°å€ï¼Œå› æ­¤å°†ä¼šä» Docker Hub è·å–é•œåƒã€‚è€Œé•œåƒåç§°æ˜¯ ubuntu:16.04ï¼Œå› æ­¤å°†ä¼šè·å–å®˜æ–¹é•œåƒ library/ubuntu ä»“åº“ä¸­æ ‡ç­¾ä¸º 16.04 çš„é•œåƒã€‚</p><p>ä»ä¸‹è½½è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹‹å‰æåŠçš„åˆ†å±‚å­˜å‚¨çš„æ¦‚å¿µï¼Œé•œåƒæ˜¯ç”±å¤šå±‚å­˜å‚¨æ‰€æ„æˆã€‚ä¸‹è½½ä¹Ÿæ˜¯ä¸€å±‚å±‚çš„å»ä¸‹è½½ï¼Œå¹¶éå•ä¸€æ–‡ä»¶ã€‚ä¸‹è½½è¿‡ç¨‹ä¸­ç»™å‡ºäº†æ¯ä¸€å±‚çš„ ID çš„å‰ 12 ä½ã€‚å¹¶ä¸”ä¸‹è½½ç»“æŸåï¼Œç»™å‡ºè¯¥é•œåƒå®Œæ•´çš„ sha256 çš„æ‘˜è¦ï¼Œä»¥ç¡®ä¿ä¸‹è½½ä¸€è‡´æ€§</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="65-è¿è¡Œé•œåƒ">6.5. è¿è¡Œé•œåƒ<a href="#65-è¿è¡Œé•œåƒ" class="hash-link" aria-label="6.5. è¿è¡Œé•œåƒçš„ç›´æ¥é“¾æ¥" title="6.5. è¿è¡Œé•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ä»¥ä¸Šé¢çš„ ubuntu:16.04 ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬æ‰“ç®—å¯åŠ¨é‡Œé¢çš„ bash å¹¶ä¸”è¿›è¡Œäº¤äº’å¼æ“ä½œçš„è¯ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -it --rm \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ubuntu:16.04 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="66-åˆ—å‡ºé•œåƒ">6.6. åˆ—å‡ºé•œåƒ<a href="#66-åˆ—å‡ºé•œåƒ" class="hash-link" aria-label="6.6. åˆ—å‡ºé•œåƒçš„ç›´æ¥é“¾æ¥" title="6.6. åˆ—å‡ºé•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ul><li><p><code>docker image ls [xxx:xxx]</code> åˆ—å‡ºæ‰€æœ‰/æŒ‡å®šä¸‹è½½çš„é¡¶å±‚é•œåƒ</p></li><li><p><code>docker image ls -a</code> åˆ—å‡ºæ‰€æœ‰åŒ…æ‹¬ä¸­é—´å±‚é•œåƒ</p></li><li><p><code>docker images</code> ä¹Ÿå¯æŸ¥çœ‹</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="67-åˆ é™¤æœ¬åœ°é•œåƒ">6.7. åˆ é™¤æœ¬åœ°é•œåƒ<a href="#67-åˆ é™¤æœ¬åœ°é•œåƒ" class="hash-link" aria-label="6.7. åˆ é™¤æœ¬åœ°é•œåƒçš„ç›´æ¥é“¾æ¥" title="6.7. åˆ é™¤æœ¬åœ°é•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><code>docker image rm [é€‰é¡¹] &lt;é•œåƒ1&gt; [&lt;é•œåƒ2&gt; ...]</code></p><h1>7. åˆ¶ä½œé•œåƒçš„æ–¹æ³•</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="71-work-with-golang">7.1. work with golang<a href="#71-work-with-golang" class="hash-link" aria-label="7.1. work with golangçš„ç›´æ¥é“¾æ¥" title="7.1. work with golangçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>create a main.go, then create dockerfile in the same directory:</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">FROM golang</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">1.16</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">buster AS builder</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN mkdir /src</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ADD . /src</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /src</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN go env </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">w GO111MODULE=auto</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN go build </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">o main .</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM gcr.io/distroless/base</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">debian10</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">from=builder /src/main /main</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">EXPOSE 3000</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/main&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>generate the image:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker build . -t xiaoyureed/hellok8s:v1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># when build, this error occurred:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å‡ºç°â€œfailed to solve with frontend dockerfile.v0: failed to create LLB definition: failed to copy: httpReadSeeker: failed open: failed to do request:â€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># Just need to setup the docker desktop config:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># &quot;features&quot;: { buildkit: false}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># start</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -p 3000:3000 --name hellok8s -d xiaoyureed/hellok8s:v1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="72-working-with-frontend">7.2. working with frontend<a href="#72-working-with-frontend" class="hash-link" aria-label="7.2. working with frontendçš„ç›´æ¥é“¾æ¥" title="7.2. working with frontendçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">FROM node:latest AS builder</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /usr/src/app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY package.json yarn.lock ./</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN yarn</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY . ./</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN yarn build</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY --from=builder /usr/src/app/dist /usr/share/nginx/html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY nginx.conf /etc/nginx/conf.d/default.conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="73-æœ€ä½³å®è·µ-ä¼˜åŒ–ä½“ç§¯">7.3. æœ€ä½³å®è·µ ä¼˜åŒ–ä½“ç§¯<a href="#73-æœ€ä½³å®è·µ-ä¼˜åŒ–ä½“ç§¯" class="hash-link" aria-label="7.3. æœ€ä½³å®è·µ ä¼˜åŒ–ä½“ç§¯çš„ç›´æ¥é“¾æ¥" title="7.3. æœ€ä½³å®è·µ ä¼˜åŒ–ä½“ç§¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/phusion/baseimage-docker" target="_blank" rel="noopener noreferrer">https://github.com/phusion/baseimage-docker</a> ä½“ç§¯æœ€å°çš„ Linux</p><p><a href="https://www.infoq.cn/article/3-simple-tricks-for-smaller-docker-images" target="_blank" rel="noopener noreferrer">https://www.infoq.cn/article/3-simple-tricks-for-smaller-docker-images</a>
<a href="https://segmentfault.com/a/1190000017858358" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000017858358</a>
<a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</a>
<a href="https://fuckcloudnative.io/posts/docker-images-part1-reducing-image-size/" target="_blank" rel="noopener noreferrer">https://fuckcloudnative.io/posts/docker-images-part1-reducing-image-size/</a>
TODO</p><div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ç¼–è¯‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM node:latest AS builder</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">maintainer xiaoyu &lt;775000738@qq.com&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /usr/src/app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY package.json yarn.lock ./</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN yarn</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¤åˆ¶å½“å‰è·¯å¾„(é€šè¿‡ docker build -t xxx . è¿™ä¸ª ç‚¹ æŒ‡å®š)ä¸‹æ‰€æœ‰æ–‡ä»¶åˆ° ç›®å½• ${workdir}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY . ./</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN yarn build</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å®é™…é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY --from=builder /usr/src/app/dist /usr/share/nginx/html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY nginx.conf /etc/nginx/conf.d/default.conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="74-é€šè¿‡-dockerfile-æ¥-build-é•œåƒ">7.4. é€šè¿‡ dockerfile æ¥ build é•œåƒ<a href="#74-é€šè¿‡-dockerfile-æ¥-build-é•œåƒ" class="hash-link" aria-label="7.4. é€šè¿‡ dockerfile æ¥ build é•œåƒçš„ç›´æ¥é“¾æ¥" title="7.4. é€šè¿‡ dockerfile æ¥ build é•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker build [-f MyDockerfile] -t xiaoyureed/myImage:v1 .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="75-commitå®¹å™¨æˆä¸ºé•œåƒä¸æ¨è">7.5. commitå®¹å™¨æˆä¸ºé•œåƒ(ä¸æ¨è)<a href="#75-commitå®¹å™¨æˆä¸ºé•œåƒä¸æ¨è" class="hash-link" aria-label="7.5. commitå®¹å™¨æˆä¸ºé•œåƒ(ä¸æ¨è)çš„ç›´æ¥é“¾æ¥" title="7.5. commitå®¹å™¨æˆä¸ºé•œåƒ(ä¸æ¨è)çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å°†è‡ªå®šä¹‰çš„å®¹å™¨ä¿å­˜ä¸ºé•œåƒ, ä¸€èˆ¬ä¸ç”¨commitåˆ¶ä½œé•œåƒ, å› ä¸ºä¼šæœ‰å¤§é‡çš„æ— å…³å†…å®¹è¢«æ·»åŠ è¿›æ¥ï¼Œå¦‚æœä¸å°å¿ƒåœ°æ¸…ç†ï¼Œå°†ä¼šå¯¼è‡´é•œåƒæä¸ºè‡ƒè‚¿ã€‚)</p><p><code>docker commit [é€‰é¡¹] &lt;å®¹å™¨IDæˆ–å®¹å™¨å&gt; [&lt;ä»“åº“å&gt;[:&lt;æ ‡ç­¾&gt;]]</code></p><p>é•œåƒæ˜¯å¤šå±‚å­˜å‚¨ï¼Œæ¯ä¸€å±‚æ˜¯åœ¨å‰ä¸€å±‚çš„åŸºç¡€ä¸Šè¿›è¡Œçš„ä¿®æ”¹ï¼›è€Œå®¹å™¨åŒæ ·ä¹Ÿæ˜¯å¤šå±‚å­˜å‚¨ï¼Œæ˜¯åœ¨ä»¥é•œåƒä¸ºåŸºç¡€å±‚ï¼Œåœ¨å…¶åŸºç¡€ä¸ŠåŠ ä¸€å±‚ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶çš„å­˜å‚¨å±‚</p><p>å…ˆçœ‹ä¸€ä¸ªä¾‹å­: å®šåˆ¶ä¸€ä¸ª web server</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ç”¨ nginx é•œåƒå¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œå‘½åä¸º webserverï¼Œå¹¶ä¸”æ˜ å°„äº† 80 ç«¯å£ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ç”¨æµè§ˆå™¨å»è®¿é—®è¿™ä¸ª nginx æœåŠ¡å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run --name webserver -d -p 80:80 nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿›å…¥containerå†…éƒ¨, æ‰“å¼€bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec -it webserver bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç”¨ &lt;h1&gt;Hello, Docker!&lt;/h1&gt; è¦†ç›–äº† /usr/share/nginx/html/index.html çš„å†…å®¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">echo &#x27;&lt;h1&gt;Hello, Docker!&lt;/h1&gt;&#x27; &gt; /usr/share/nginx/html/index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æµè§ˆå™¨è¾“å…¥è™šæ‹Ÿæœºçš„ipåœ°å€å³å¯è®¿é—®;(<code>docker-machine env</code>å¯ä»¥æŸ¥çœ‹è™šæ‹Ÿæœºip)</p><p>ç°åœ¨å¸Œæœ›commitè¿™ä¸ªæ–°çš„é•œåƒ</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å…ˆé€€å‡ºcontainer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># çœ‹ä¸‹å›¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker commit --author &quot;xy&lt;775000738@qq.com&gt;&quot; --message &quot;ä¿®æ”¹ index.html&quot; webserver nginx:v2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯åŠ¨ç¬¬äºŒä¸ªcontainer, æµè§ˆå™¨è®¿é—®81ç«¯å£;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‡³æ­¤, æ‰‹åŠ¨æ“ä½œç»™æ—§çš„é•œåƒæ·»åŠ äº†æ–°çš„ä¸€å±‚ï¼Œå½¢æˆæ–°çš„é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run --name test_1 -d -p 81:80 nginx:v2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>docker history nginx:v2</code> æŸ¥çœ‹æŸä¸ªRepositoryçš„å†å²æäº¤è®°å½•</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="76-ä»å‹ç¼©åŒ…å¯¼å…¥">7.6. ä»å‹ç¼©åŒ…å¯¼å…¥<a href="#76-ä»å‹ç¼©åŒ…å¯¼å…¥" class="hash-link" aria-label="7.6. ä»å‹ç¼©åŒ…å¯¼å…¥çš„ç›´æ¥é“¾æ¥" title="7.6. ä»å‹ç¼©åŒ…å¯¼å…¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ ¼å¼ï¼š<code>docker import [é€‰é¡¹] &lt;æ–‡ä»¶&gt;|&lt;URL&gt;|- [&lt;ä»“åº“å&gt;[:&lt;æ ‡ç­¾&gt;]]</code></p><p>eg:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># è¿™æ¡å‘½ä»¤è‡ªåŠ¨ä¸‹è½½äº† ubuntu-14.04-x86_64-minimal.tar.gz æ–‡ä»¶ï¼Œå¹¶ä¸”ä½œä¸ºæ ¹æ–‡ä»¶ç³»ç»Ÿå±•å¼€å¯¼å…¥ï¼Œå¹¶ä¿å­˜ä¸ºé•œåƒ openvz/ubuntu:14.04</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker import \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    http://download.openvz.org/template/precreated/ubuntu-14.04-x86_64-minimal.tar.gz \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    openvz/ubuntu:14.04</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="77-docker-save-å’Œ-docker-load">7.7. docker save å’Œ docker load<a href="#77-docker-save-å’Œ-docker-load" class="hash-link" aria-label="7.7. docker save å’Œ docker loadçš„ç›´æ¥é“¾æ¥" title="7.7. docker save å’Œ docker loadçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Docker è¿˜æä¾›äº† docker load å’Œ docker save å‘½ä»¤ï¼Œç”¨ä»¥å°†é•œåƒä¿å­˜ä¸ºä¸€ä¸ª tar æ–‡ä»¶ï¼Œç„¶åä¼ è¾“åˆ°å¦ä¸€ä¸ªä½ç½®ä¸Šï¼Œå†åŠ è½½è¿›æ¥ã€‚è¿™æ˜¯åœ¨æ²¡æœ‰ Docker Registry æ—¶çš„åšæ³•ï¼Œç°åœ¨å·²ç»ä¸æ¨èï¼Œé•œåƒè¿ç§»åº”è¯¥ç›´æ¥ä½¿ç”¨ Docker Registryï¼Œæ— è®ºæ˜¯ç›´æ¥ä½¿ç”¨ Docker Hub è¿˜æ˜¯ä½¿ç”¨å†…ç½‘ç§æœ‰ Registry </p><p><code>docker save alpine | gzip &gt; alpine-latest.tar.gz</code> ä¿å­˜ä¹‹åå¤åˆ¶åˆ°å…¶ä»–æœºå™¨, <code>docker load -i alpine-latest.tar.gz</code>åŠ è½½é•œåƒ</p><p><code>docker save &lt;é•œåƒå&gt; | bzip2 | pv | ssh &lt;ç”¨æˆ·å&gt;@&lt;ä¸»æœºå&gt; &#x27;cat | docker load&#x27;</code>ä»ä¸€ä¸ªæœºå™¨å°†é•œåƒè¿ç§»åˆ°å¦ä¸€ä¸ªæœºå™¨ï¼Œå¹¶ä¸”å¸¦è¿›åº¦æ¡çš„åŠŸèƒ½</p><h1>8. Dockerfile</h1><p>é€šè¿‡dockerfileæ¥buildå®šåˆ¶é•œåƒ</p><p>æ˜¯  ä¸€ç§æ„å»ºimageçš„ æ–‡ä»¶DSL</p><p>Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶å†…åŒ…å«äº†ä¸€æ¡æ¡çš„æŒ‡ä»¤(Instruction)ï¼Œ<code>æ¯ä¸€æ¡æŒ‡ä»¤æ„å»ºä¸€å±‚</code>ï¼Œå› æ­¤æ¯ä¸€æ¡æŒ‡ä»¤çš„å†…å®¹ï¼Œå°±æ˜¯æè¿°è¯¥å±‚åº”å½“å¦‚ä½•æ„å»ºã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="81-from">8.1. from<a href="#81-from" class="hash-link" aria-label="8.1. fromçš„ç›´æ¥é“¾æ¥" title="8.1. fromçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">FROM</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token literal-property property">æŒ‡ä»¤</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> æŒ‡å®šåŸºç¡€é•œåƒ</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> ä¸€ä¸ª </span><span class="token maybe-class-name">Dockerfile</span><span class="token plain"> ä¸­ </span><span class="token constant" style="color:rgb(129, 31, 63)">FROM</span><span class="token plain"> æ˜¯å¿…å¤‡çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token maybe-class-name">Docker</span><span class="token plain"> è¿˜å­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„é•œåƒï¼Œåä¸º scratchã€‚è¿™ä¸ªé•œåƒæ˜¯è™šæ‹Ÿçš„æ¦‚å¿µï¼Œå¹¶ä¸å®é™…å­˜åœ¨ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªç©ºç™½çš„é•œåƒ</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token property-access">å¦‚æœä½ ä»¥</span><span class="token plain"> scratch ä¸ºåŸºç¡€é•œåƒçš„è¯ï¼Œæ„å‘³ç€ä½ ä¸ä»¥ä»»ä½•é•œåƒä¸ºåŸºç¡€ï¼Œæ¥ä¸‹æ¥æ‰€å†™çš„æŒ‡ä»¤å°†ä½œä¸ºé•œåƒç¬¬ä¸€å±‚å¼€å§‹å­˜åœ¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    å¯ä»¥ </span><span class="token keyword module" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> xxx </span><span class="token keyword module" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> builder</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> åé¢å¯ä»¥åœ¨ scratch ä¸­å¼•ç”¨ $</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">builder</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> ä»¥ç¼©å° image ä½“ç§¯</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ç¼–å†™å®Œæ¯•, å¯ä»¥é”®å…¥æ„å»ºå‘½ä»¤: <code>docker build [é€‰é¡¹] &lt; ä¸Šä¸‹æ–‡è·¯å¾„/URL/- &gt;</code></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># åœ¨dockerfileæ‰€åœ¨çš„ç›®å½•è¿è¡Œ, -tè¡¨ç¤ºæŒ‡å®šæœ€ç»ˆé•œåƒåç§°, è¿™é‡Œçš„[.]è¡¨ç¤ºä¸Šä¸‹æ–‡è·¯å¾„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker build -t nginx:v3 .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="82-é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡context">8.2. é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡context<a href="#82-é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡context" class="hash-link" aria-label="8.2. é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡contextçš„ç›´æ¥é“¾æ¥" title="8.2. é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡contextçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>docker build å‘½ä»¤æ„å»ºé•œåƒï¼Œå…¶å®å¹¶éåœ¨æœ¬åœ°æ„å»ºï¼Œè€Œæ˜¯åœ¨æœåŠ¡ç«¯ï¼Œä¹Ÿå°±æ˜¯ Docker å¼•æ“ä¸­æ„å»ºçš„ã€‚é‚£ä¹ˆåœ¨è¿™ç§å®¢æˆ·ç«¯/æœåŠ¡ç«¯çš„æ¶æ„ä¸­ï¼Œå¦‚ä½•æ‰èƒ½è®©æœåŠ¡ç«¯è·å¾—æœ¬åœ°æ–‡ä»¶å‘¢ï¼Ÿ</p><p><code>docker build -t nginx:v3 .</code> è¿™é‡Œçš„<!-- -->[.]<!-- -->ä¸æ˜¯å‘½ä»¤å½“å‰æ‰€åœ¨çš„ç›®å½•, è€Œæ˜¯æŒ‡å®šdocker contextè·¯å¾„, Dockerfileä¸­çš„è·¯å¾„éƒ½æ˜¯ç›¸å¯¹äºè¿™ä¸ªcontxtè·¯å¾„æ¥è¯´çš„</p><p>ä¸€èˆ¬åº”è¯¥ä¼šå°† Dockerfile ç½®äºä¸€ä¸ªç©ºç›®å½•ä¸‹ï¼Œæˆ–è€…é¡¹ç›®æ ¹ç›®å½•ä¸‹ã€‚å¦‚æœè¯¥ç›®å½•ä¸‹æ²¡æœ‰æ‰€éœ€æ–‡ä»¶ï¼Œé‚£ä¹ˆåº”è¯¥æŠŠæ‰€éœ€æ–‡ä»¶å¤åˆ¶ä¸€ä»½è¿‡æ¥ã€‚å¦‚æœç›®å½•ä¸‹æœ‰äº›ä¸œè¥¿ç¡®å®ä¸å¸Œæœ›æ„å»ºæ—¶ä¼ ç»™ Docker å¼•æ“ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ .gitignore ä¸€æ ·çš„è¯­æ³•å†™ä¸€ä¸ª <code>.dockerignore</code>ï¼Œè¯¥æ–‡ä»¶æ˜¯ç”¨äºå‰”é™¤ä¸éœ€è¦ä½œä¸ºä¸Šä¸‹æ–‡ä¼ é€’ç»™ Docker å¼•æ“çš„ã€‚</p><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸é¢å¤–æŒ‡å®š Dockerfile çš„è¯ï¼Œä¼šå°†ä¸Šä¸‹æ–‡ç›®å½•ä¸‹çš„åä¸º Dockerfile çš„æ–‡ä»¶ä½œä¸º Dockerfile;å®é™…ä¸Š Dockerfile çš„æ–‡ä»¶åå¹¶ä¸è¦æ±‚å¿…é¡»ä¸º Dockerfileï¼Œè€Œä¸”å¹¶ä¸è¦æ±‚å¿…é¡»ä½äºä¸Šä¸‹æ–‡ç›®å½•ä¸­ï¼Œæ¯”å¦‚å¯ä»¥ç”¨ <code>-f ../Dockerfile.php</code> å‚æ•°æŒ‡å®šæŸä¸ªæ–‡ä»¶ä½œä¸º Dockerfileã€‚</p><p>docker buildè¿˜æ”¯æŒä»git repoä¸­æ‹‰å–æ–‡ä»¶æ„å»º<code>docker build https://github.com/twang2218/gitlab-ce-zh.git#:8.14</code>è¿™è¡Œå‘½ä»¤æŒ‡å®šäº†æ„å»ºæ‰€éœ€çš„ Git repoï¼Œå¹¶ä¸”æŒ‡å®šé»˜è®¤çš„ master åˆ†æ”¯ï¼Œæ„å»ºç›®å½•ä¸º /8.14/ï¼Œç„¶å Docker å°±ä¼šè‡ªå·±å» git clone è¿™ä¸ªé¡¹ç›®ã€åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ã€å¹¶è¿›å…¥åˆ°æŒ‡å®šç›®å½•åå¼€å§‹æ„å»º</p><p>è¿˜æ”¯æŒ<code>docker build http://server/context.tar.gz</code>ä»å‹ç¼©åŒ…æ„å»º</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="821-dockerignore">8.2.1. dockerignore<a href="#821-dockerignore" class="hash-link" aria-label="8.2.1. dockerignoreçš„ç›´æ¥é“¾æ¥" title="8.2.1. dockerignoreçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">similar </span><span class="token maybe-class-name">To</span><span class="token plain"> gitignore</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="83-copy-å’Œ-add">8.3. COPY å’Œ ADD<a href="#83-copy-å’Œ-add" class="hash-link" aria-label="8.3. COPY å’Œ ADDçš„ç›´æ¥é“¾æ¥" title="8.3. COPY å’Œ ADDçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å¤åˆ¶æ–‡ä»¶</p><p>å’Œ RUN æŒ‡ä»¤ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸¤ç§æ ¼å¼ï¼Œä¸€ç§ç±»ä¼¼äºå‘½ä»¤è¡Œï¼Œä¸€ç§ç±»ä¼¼äºå‡½æ•°è°ƒç”¨:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token constant" style="color:rgb(129, 31, 63)">COPY</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">source1</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">source2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">target</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">æºè·¯å¾„</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> å¯ä»¥æ˜¯å¤šä¸ªï¼Œç”šè‡³å¯ä»¥æ˜¯é€šé…ç¬¦ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³ </span><span class="token maybe-class-name">Go</span><span class="token plain"> çš„ filepath</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access maybe-class-name">Match</span><span class="token plain"> è§„åˆ™</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ç›®æ ‡è·¯å¾„</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> å¯ä»¥æ˜¯å®¹å™¨å†…çš„ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹äºå·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼ˆå·¥ä½œç›®å½•å¯ä»¥ç”¨ </span><span class="token constant" style="color:rgb(129, 31, 63)">WORKDIR</span><span class="token plain"> æŒ‡ä»¤æ¥æŒ‡å®šï¼‰</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> å¦‚æœä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ™å¿…é¡»ä½¿ç”¨</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ç»“æŸ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  è‹¥ source æ˜¯æ–‡ä»¶</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> target æ˜¯ </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> ç»“å°¾</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> åˆ™ docker ä¼šæŠŠ target è§†ä¸ºç›®å½•</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> source will be copied to the dir</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> target dir missing</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> will auto create</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  è‹¥ source æ˜¯æ–‡ä»¶</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> target ä¸æ˜¯ </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> ç»“å°¾</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">åˆ™ docker ä¼šæŠŠ target è§†ä¸ºæ–‡ä»¶</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> the target missing</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> it will be auto </span><span class="token function" style="color:rgb(0, 0, 255)">created</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">equal to source file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> the target exist</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> it will be override </span><span class="token keyword" style="color:rgb(0, 0, 255)">with</span><span class="token plain"> the source file content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> the source is a folder and the sources only contains one </span><span class="token function" style="color:rgb(0, 0, 255)">folder</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">æ–‡ä»¶å¤¹æœ¬èº«ä¼šè¢«å¤åˆ¶</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> å†…éƒ¨çš„æ–‡ä»¶ä¹Ÿä¼šè¢«å¤åˆ¶</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> and the target </span><span class="token function" style="color:rgb(0, 0, 255)">missing</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">æ— è®ºæ˜¯ä¸æ˜¯ </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> ç»“å°¾éƒ½ä¼šè§†ä¸ºæ–‡ä»¶å¤¹</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> the target will be auto created</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> the source is a folder and the sources contains more than one </span><span class="token function" style="color:rgb(0, 0, 255)">folder</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">æ–‡ä»¶å¤¹æœ¬èº«ä¸ä¼šè¢«å¤åˆ¶</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ä»…ä»…å†…éƒ¨æ–‡ä»¶å¤åˆ¶</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">eg</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token constant" style="color:rgb(129, 31, 63)">COPY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">package</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">json</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">app</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token constant" style="color:rgb(129, 31, 63)">COPY</span><span class="token plain"> hom</span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">mydir</span><span class="token regex regex-delimiter">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token constant" style="color:rgb(129, 31, 63)">COPY</span><span class="token plain"> hom</span><span class="token operator" style="color:rgb(0, 0, 0)">?.</span><span class="token plain">txt </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">mydir</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>addå‘½ä»¤: æ›´é«˜çº§çš„å¤åˆ¶å‘½ä»¤, ç±»ä¼¼ copy, è¿˜æ”¯æŒä» URL å¤åˆ¶æ–‡ä»¶, è¿˜æ”¯æŒå¤åˆ¶æœ¬åœ°taræ–‡ä»¶å¹¶è‡ªåŠ¨è§£å‹ç¼©</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="84-workdir-æŒ‡å®šå·¥ä½œç›®å½•">8.4. WORKDIR æŒ‡å®šå·¥ä½œç›®å½•<a href="#84-workdir-æŒ‡å®šå·¥ä½œç›®å½•" class="hash-link" aria-label="8.4. WORKDIR æŒ‡å®šå·¥ä½œç›®å½•çš„ç›´æ¥é“¾æ¥" title="8.4. WORKDIR æŒ‡å®šå·¥ä½œç›®å½•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ä½¿ç”¨ WORKDIR æŒ‡ä»¤å¯ä»¥æ¥æŒ‡å®šå·¥ä½œç›®å½•ï¼ˆæˆ–è€…ç§°ä¸ºå½“å‰ç›®å½•ï¼‰ï¼Œå°±æ˜¯å°†å½“å‰æ‰§è¡Œå‘½ä»¤çš„ç›®å½•å®šä¹‰ä¸ºç¡®å®šå€¼, ä»¥åå„å±‚çš„å½“å‰ç›®å½•å°±è¢«æ”¹ä¸ºæŒ‡å®šçš„ç›®å½•</p><p>æ ¼å¼ä¸º <code>WORKDIR &lt;absolutePath/relativePath&gt;</code>ã€‚(å¦‚è¯¥ç›®å½•ä¸å­˜åœ¨ï¼ŒWORKDIR ä¼šå¸®ä½ å»ºç«‹ç›®å½•, relative path: å®ƒå°†ç›¸å¯¹äºå‰ä¸€ä¸ª WORKDIR æŒ‡ä»¤çš„è·¯å¾„, ä¸ºäº†é¿å…å‡ºé”™ï¼Œæ¨èWORKDIRæŒ‡ä»¤ä¸­åªä½¿ç”¨ç»å¯¹è·¯å¾„)</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /a</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR b</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN pwd</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># è¾“å‡ºå°†ä¼šæ˜¯ /a/b/c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>WORKDIR æŒ‡ä»¤å¯ä»¥ä½¿ç”¨å‰é¢ ENV è®¾ç½®çš„ç¯å¢ƒå˜é‡</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ENV DIRPATH=/path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR $DIRPATH/$DIRNAME</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN pwd    </span><span class="token comment" style="color:rgb(0, 128, 0)"># /path/$DIRNAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="85-run-cmd-å’Œ-entrypoint-å®¹å™¨å¯åŠ¨å‘½ä»¤">8.5. run cmd å’Œ entrypoint å®¹å™¨å¯åŠ¨å‘½ä»¤<a href="#85-run-cmd-å’Œ-entrypoint-å®¹å™¨å¯åŠ¨å‘½ä»¤" class="hash-link" aria-label="8.5. run cmd å’Œ entrypoint å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç›´æ¥é“¾æ¥" title="8.5. run cmd å’Œ entrypoint å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="851-è®¾ç½®æ—¶åŒº">8.5.1. è®¾ç½®æ—¶åŒº<a href="#851-è®¾ç½®æ—¶åŒº" class="hash-link" aria-label="8.5.1. è®¾ç½®æ—¶åŒºçš„ç›´æ¥é“¾æ¥" title="8.5.1. è®¾ç½®æ—¶åŒºçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ENV TZ=Asia/Shanghai</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo Asia/Shanghai &gt; /etc/timezone</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å°†æ—¶åŒºè®¾ç½®ä¸ºä¸œå…«åŒºå¹¶å®‰è£…bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN echo &quot;https://mirrors.aliyun.com/alpine/v3.8/main/&quot; &gt; /etc/apk/repositories \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; echo &quot;https://mirrors.aliyun.com/alpine/v3.8/community/&quot; &gt;&gt; /etc/apk/repositories \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apk add --no-cache tzdata \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime  \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; echo Asia/Shanghai &gt; /etc/timezone \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apk del tzdata \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apk update \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apk upgrade \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apk add --no-cache bash \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bash-doc \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bash-completion \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; rm -rf /var/cache/apk/*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="852-å¸¸è§çš„é”™è¯¯ç”¨æ³•">8.5.2. å¸¸è§çš„é”™è¯¯ç”¨æ³•<a href="#852-å¸¸è§çš„é”™è¯¯ç”¨æ³•" class="hash-link" aria-label="8.5.2. å¸¸è§çš„é”™è¯¯ç”¨æ³•çš„ç›´æ¥é“¾æ¥" title="8.5.2. å¸¸è§çš„é”™è¯¯ç”¨æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># case1: pid çš„é—®é¢˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># shell æ ¼å¼åº•å±‚ä½¿ç”¨ /bin/sh -c æ¥æ‰§è¡Œ, è¿™ä¼šå¯¼è‡´å®¹å™¨ä¸­ PID ä¸º 1 çš„è¿›ç¨‹æ˜¯ /bin/sh è€Œä¸æ˜¯ ENTRYPOINT ä¸­æŒ‡å®šçš„ Java</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨ docker stop åœæ­¢å®¹å™¨æ—¶ï¼Œæ¥æ”¶åˆ° SIGTERM ä¿¡å·çš„æ˜¯ /bin/sh è€Œä¸æ˜¯ Javaï¼Œæˆ‘ä»¬çš„ Java è¿›ç¨‹å°±ä¸èƒ½ä¼˜é›…é€€å‡ºäº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT java -jar /app.java</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è§£å†³:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœä¸€å®šè¦ç”¨ shell æ ¼å¼, å¯ä»¥ä½¿ç”¨ exec</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT exec java -jar /app.java</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or (æ¨è)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># exec æ ¼å¼ å°±æ˜¯ä½¿ç”¨ exec æ¥æ‰§è¡Œçš„ï¼Œå¯ä»¥ç¡®ä¿å®¹å™¨ä¸­ PID ä¸º 1 çš„è¿›ç¨‹æ˜¯ ENTRYPOINT ä¸­æŒ‡å®šçš„è¿›ç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or Shell è„šæœ¬</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY run.sh run.sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN chmod +x run.sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT [&quot;./run.sh&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">exec java -jar /app.jar</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># case2: å˜é‡æ›¿æ¢çš„é—®é¢˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç›´æ¥ä½¿ç”¨ exec æ‰§è¡Œï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ Shell, ä¸æ”¯æŒå˜é‡æ›¿æ¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT [&quot;java&quot;, &quot;${JAVA_OPTS}&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è§£å†³:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é€šè¿‡ shell è„šæœ¬ (æ¨è)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">exec java ${JAVA_OPTS} -jar /app.jar ${@}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT [&quot;sh&quot;, &quot;-c&quot;, &quot;java ${JAVA_OPTS} -jar /app.jar&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="853-éƒ½æ”¯æŒä¸¤ç§æ ¼å¼-shell-å’Œ-exec-çš„åŒºåˆ«">8.5.3. éƒ½æ”¯æŒä¸¤ç§æ ¼å¼ shell å’Œ exec çš„åŒºåˆ«<a href="#853-éƒ½æ”¯æŒä¸¤ç§æ ¼å¼-shell-å’Œ-exec-çš„åŒºåˆ«" class="hash-link" aria-label="8.5.3. éƒ½æ”¯æŒä¸¤ç§æ ¼å¼ shell å’Œ exec çš„åŒºåˆ«çš„ç›´æ¥é“¾æ¥" title="8.5.3. éƒ½æ”¯æŒä¸¤ç§æ ¼å¼ shell å’Œ exec çš„åŒºåˆ«çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>shell æ ¼å¼ åœ¨å¯åŠ¨æ—¶æ˜¯ä½¿ç”¨ /bin/sh -c æ¥æ‰§è¡Œçš„ï¼Œè¿™ä¼šå¯¼è‡´å®¹å™¨ä¸­ PID ä¸º 1 çš„è¿›ç¨‹æ˜¯ /bin/sh è€Œä¸æ˜¯ ENTRYPOINT ä¸­æŒ‡å®šçš„ Javaï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨ docker stop åœæ­¢å®¹å™¨æ—¶ï¼Œæ¥æ”¶åˆ° SIGTERM ä¿¡å·çš„æ˜¯ /bin/sh è€Œä¸æ˜¯ Javaï¼Œæˆ‘ä»¬çš„ Java è¿›ç¨‹å°±ä¸èƒ½ä¼˜é›…é€€å‡ºäº†</p><blockquote><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨ shell æ ¼å¼æ—¶, ä¸€èˆ¬åœ¨æ‰§è¡Œçš„å‘½ä»¤å‰åŠ ä¸Š exec: <code>ENTRYPOINT exec java -jar /app.java</code></p></blockquote><p>è€Œ exec æ ¼å¼ å°±æ˜¯ä½¿ç”¨ exec æ¥æ‰§è¡Œçš„ï¼Œå¯ä»¥ç¡®ä¿å®¹å™¨ä¸­ PID ä¸º 1 çš„è¿›ç¨‹æ˜¯ ENTRYPOINT ä¸­æŒ‡å®šçš„è¿›ç¨‹ï¼Œ</p><blockquote><p>ä¸€èˆ¬æ¨èä½¿ç”¨è¿™ç§æ ¼å¼ï¼Œè€Œä¸”è¿˜å¯ä»¥é…åˆ CMD æŒ‡ä»¤å†…ç½®ç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•°ï¼Œshell æ ¼å¼ ä¸‹ CMD æ˜¯æ— æ•ˆçš„ã€‚</p></blockquote><blockquote><p>å½“ä»¥shellå½¢å¼æ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼Œç”±äºå®ƒä¼šè°ƒç”¨ <code>/bin/sh -c</code> å¹¶è¿›è¡Œæ­£å¸¸çš„shellå¤„ç†, ä¼šå‘ç”Ÿå˜é‡æ›¿æ¢, è€Œ exec æ ¼å¼å°±ä¸ä¼šæœ‰å˜é‡æ›¿æ¢</p></blockquote><div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ENV name John Dow</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT echo &quot;Hello, $name&quot;      # will replace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="854-run">8.5.4. run<a href="#854-run" class="hash-link" aria-label="8.5.4. runçš„ç›´æ¥é“¾æ¥" title="8.5.4. runçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><code>RUN</code>æŒ‡ä»¤: æ‰§è¡Œå‘½ä»¤ (æ¯ä¸€ä¸ª RUN éƒ½æ˜¯å¯åŠ¨ä¸€ä¸ªå®¹å™¨ -&gt; æ‰§è¡Œå‘½ä»¤ -&gt; ç„¶åæäº¤å­˜å‚¨å±‚æ–‡ä»¶å˜æ›´), ç”¨äºåœ¨æ–°å›¾å±‚ä¸­æ‰§è¡Œå‘½ä»¤å¹¶åˆ›å»ºæ–°å›¾åƒ</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    ä¸¤ç§æ ¼å¼ , shell æ ¼å¼ï¼šRUN &lt;å‘½ä»¤&gt;; å°±åƒç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‘½ä»¤ä¸€æ ·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # æ‰€æœ‰çš„å‘½ä»¤åªæœ‰ä¸€ä¸ªç›®çš„ï¼Œå°±æ˜¯ç¼–è¯‘ã€å®‰è£… redis å¯æ‰§è¡Œæ–‡ä»¶ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    FROM debian:jessie</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    RUN buildDeps=&#x27;gcc libc6-dev make&#x27; \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apt-get update \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apt-get install -y $buildDeps \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; wget -O redis.tar.gz &quot;http://download.redis.io/releases/redis-3.2.5.tar.gz&quot; \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; mkdir -p /usr/src/redis \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; make -C /usr/src/redis \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; make -C /usr/src/redis install \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # å¿…è¦çš„æ¸…ç†å·¥ä½œ, ä¿è¯æ¯ä¸€å±‚æ²¡æœ‰åƒåœ¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; rm -rf /var/lib/apt/lists/* \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; rm redis.tar.gz \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; rm -r /usr/src/redis \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apt-get purge -y --auto-remove $buildDeps</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    è¿˜æœ‰ä¸€ç§ exec æ ¼å¼ï¼šRUN [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;]ï¼Œè¿™æ›´åƒæ˜¯å‡½æ•°è°ƒç”¨ä¸­çš„æ ¼å¼</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8541-å…¸å‹é”™è¯¯">8.5.4.1. å…¸å‹é”™è¯¯<a href="#8541-å…¸å‹é”™è¯¯" class="hash-link" aria-label="8.5.4.1. å…¸å‹é”™è¯¯çš„ç›´æ¥é“¾æ¥" title="8.5.4.1. å…¸å‹é”™è¯¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>å¦‚ä¸‹, æ˜¯é”™è¯¯çš„, ä¸¤æ¡runå‘½ä»¤åœ¨å†…å­˜ä¸Šå®é™…æ˜¯æ²¡æœ‰è”ç³»çš„</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¸Œæœ›åœ¨ /app ä¸‹åˆ›å»ºæ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN cd /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN echo &quot;hello&quot; &gt; world.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä¿®æ”¹:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN echo &quot;hello&quot; &gt; world.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="855-cmdæŒ‡ä»¤">8.5.5. cmdæŒ‡ä»¤<a href="#855-cmdæŒ‡ä»¤" class="hash-link" aria-label="8.5.5. cmdæŒ‡ä»¤çš„ç›´æ¥é“¾æ¥" title="8.5.5. cmdæŒ‡ä»¤çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>CMD æŒ‡ä»¤å°±æ˜¯ç”¨äºæŒ‡å®šé»˜è®¤çš„å®¹å™¨ä¸»è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤, ç­‰æ•ˆäº å‘½ä»¤è¡Œä¸­ image åè·Ÿçš„å‘½ä»¤</p><blockquote><p>è‹¥å‘½ä»¤è¡Œ image åæ²¡æœ‰è·Ÿå‘½ä»¤, åˆ™æ‰§è¡Œ dockerfile ä¸­çš„ cmd, è‹¥ image åæœ‰å‘½ä»¤, åˆ™è¦†ç›– dockerfile ä¸­çš„ cmd</p><p>æ¯”å¦‚ï¼Œubuntu é•œåƒé»˜è®¤çš„ CMD æ˜¯ /bin/bashï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥<code> docker run -it ubuntu</code> çš„è¯ï¼Œä¼šç›´æ¥è¿›å…¥ bashã€‚
<code>docker run -it ubuntu cat /etc/os-release</code>ã€‚è¿™å°±æ˜¯ç”¨ cat /etc/os-release å‘½ä»¤æ›¿æ¢äº†é»˜è®¤çš„ /bin/bash å‘½ä»¤äº†ï¼Œè¾“å‡ºäº†ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ã€‚</p></blockquote><p>cmd ç»“æŸäº†, å®¹å™¨ä¹Ÿå°±é€€å‡ºäº†</p><blockquote><p>eg: <code>CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</code> ç›´æ¥æ‰§è¡Œ nginx å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ä¸”è¦æ±‚ä»¥å‰å°å½¢å¼è¿è¡Œ(CMD service nginx startæ˜¯é”™çš„, æ­¤æ—¶æ˜¯&quot;sh&quot;è¿™åªç¨‹åºä½œä¸ºä¸»ç¨‹åº, å®ƒè¿è¡Œç»“æŸ, å®¹å™¨å°±é€€å‡ºäº†)</p></blockquote><p>æ ¼å¼: </p><p><code>CMD [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;...]</code></p><p><code>CMD [&quot;param1&quot;,&quot;param2&quot;] </code> åœ¨ä½¿ç”¨ ENTRYPOINT æŒ‡å®šäº†èµ·å§‹å‘½ä»¤åï¼Œcmd è¯­æ³•å°±å˜äº†, å‚æ•°ä¼šä¼ é€’ç»™ entrypoint</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="856-entrypoint-å…¥å£ç‚¹">8.5.6. ENTRYPOINT å…¥å£ç‚¹<a href="#856-entrypoint-å…¥å£ç‚¹" class="hash-link" aria-label="8.5.6. ENTRYPOINT å…¥å£ç‚¹çš„ç›´æ¥é“¾æ¥" title="8.5.6. ENTRYPOINT å…¥å£ç‚¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æŒ‡å®šå®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤</p><blockquote><p>ç±»ä¼¼ cmd, åªæ˜¯ä¸€æ—¦å’Œ cmd ä¸€èµ·ä½¿ç”¨, å¯ä»¥å°†cmdå½“ä½œå‚æ•°ä¼ ç»™ enterpoint
(åˆ©ç”¨è¿™ç‚¹å¯ä»¥åˆ¶ä½œè¿™ç§é•œåƒ: å¯ä»¥å½“åšå¯æ‰§è¡Œæ–‡ä»¶è¿è¡Œçš„é•œåƒ, å³èƒ½å¤Ÿåœ¨é•œåƒååé¢ç›´æ¥è·Ÿå‚æ•°)</p></blockquote><p>ä½†æ˜¯ shell &amp; exec æ ¼å¼åŒºåˆ«å¾ˆå¤§:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token constant" style="color:rgb(129, 31, 63)">ENTRYPOINT</span><span class="token plain">çš„Execå½¢å¼å…è®¸æ‚¨è®¾ç½®å‘½ä»¤å’Œå‚æ•°ï¼Œç„¶åä½¿ç”¨</span><span class="token constant" style="color:rgb(129, 31, 63)">CMD</span><span class="token plain">æ¥è®¾ç½®æ›´å¯èƒ½æ›´æ”¹çš„å…¶ä»–å‚æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">å¦‚</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token constant" style="color:rgb(129, 31, 63)">ENTRYPOINT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/bin/echo&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Hello&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token constant" style="color:rgb(129, 31, 63)">CMD</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">     # è¿™é‡Œçš„å‘½ä»¤å¯ä»¥è¢«å‘½ä»¤è¡Œè¦†ç›–</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‹¥å‘½ä»¤è¡Œç›´æ¥è¿è¡Œ</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ä¼šæ­£å¸¸æ‰“å° </span><span class="token maybe-class-name">Hello</span><span class="token plain"> world</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> è‹¥å‘½ä»¤è¡Œåè·Ÿ xxx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ä¼šæ‰“å° </span><span class="token maybe-class-name">Hello</span><span class="token plain"> xxx </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><span class="token maybe-class-name">Shellå½¢å¼çš„</span><span class="token constant" style="color:rgb(129, 31, 63)">ENTRYPOINT</span><span class="token plain">å¿½ç•¥ä»»ä½•</span><span class="token constant" style="color:rgb(129, 31, 63)">CMD</span><span class="token plain">æˆ–è¿è¡Œå‘½ä»¤è¡Œå‚æ•°ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8561-eg-è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨">8.5.6.1. eg: è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨<a href="#8561-eg-è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨" class="hash-link" aria-label="8.5.6.1. eg: è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="8.5.6.1. eg: è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># è·å–è‡ªå·±çš„å…¬ç½‘ip, Dockerfileå¦‚ä¸‹:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å‘½ä»¤æ— æ³•åœ¨åé¢æ¥curlçš„å‚æ•°, æ¯”å¦‚ç›´æ¥åœ¨åé¢åŠ &quot;-i&quot;, ä¼šæŠŠé»˜è®¤çš„cmdæ•´ä¸ªæ›¿æ¢è€Œå‡ºé”™,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM ubuntu:16.04</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN apt-get update \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apt-get install -y curl \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [ &quot;curl&quot;, &quot;-s&quot;, &quot;http://ip.cn&quot; ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ„å»ºé•œåƒ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker build -t myip .</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æµ‹è¯•:æŸ¥è¯¢ip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run myip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#  ä¸å®Œç¾çš„è§£å†³æ–¹æ³•å¦‚ä¸‹: é€šè¿‡ curl -s http://ip.cn -i è¦†ç›–é•œåƒå†…çš„ curl -s http://ip.cn</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run myip curl -s http://ip.cn -i</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">## ä¸Šé¢çš„å‘½ä»¤å¤ªå•°å—¦äº†, æ­£ç¡®çš„æ–¹æ³•æ˜¯ä¿®æ”¹Dockerfile, ç”¨ENTERYPOINTä»£æ›¿CMD</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM ubuntu:16.04</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN apt-get update \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; apt-get install -y curl \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT [ &quot;curl&quot;, &quot;-s&quot;, &quot;http://ip.cn&quot; ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨&quot;-i&quot;å‚æ•°äº†, å‘½ä»¤è¡Œçš„å‚æ•°ä¼šç›´æ¥è·Ÿåœ¨entrypoint åé¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run myip -i</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8562-eg-åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œ">8.5.6.2. eg: åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œ<a href="#8562-eg-åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œ" class="hash-link" aria-label="8.5.6.2. eg: åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œçš„ç›´æ¥é“¾æ¥" title="8.5.6.2. eg: åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>(è¿™äº›å‡†å¤‡å·¥ä½œæ˜¯å’Œå®¹å™¨ CMD æ— å…³çš„ï¼Œæ— è®º CMD ä¸ºä»€ä¹ˆï¼Œéƒ½éœ€è¦äº‹å…ˆè¿›è¡Œä¸€ä¸ªé¢„å¤„ç†çš„å·¥ä½œã€‚</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œç„¶åæ”¾å…¥ ENTRYPOINT ä¸­å»æ‰§è¡Œï¼Œè€Œè¿™ä¸ªè„šæœ¬ä¼šå°†æ¥åˆ°çš„å‚æ•°ï¼ˆä¹Ÿå°±æ˜¯ <code>&lt;CMD&gt;</code>ï¼‰ä½œä¸ºå‘½ä»¤ï¼Œåœ¨è„šæœ¬æœ€åæ‰§è¡Œ)</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¯ä»¥çœ‹åˆ°å…¶ä¸­ä¸ºäº† redis æœåŠ¡åˆ›å»ºäº† redis ç”¨æˆ·ï¼Œå¹¶åœ¨æœ€åæŒ‡å®šäº† ENTRYPOINT ä¸º docker-entrypoint.sh è„šæœ¬ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM alpine:3.4</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN addgroup -S redis &amp;&amp; adduser -S -G redis redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENTRYPOINT [&quot;docker-entrypoint.sh&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">EXPOSE 6379</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [ &quot;redis-server&quot; ]  # è¿™é‡Œä¼šä½œä¸ºå‚æ•°ä¼ é€’ç»™ Entrypoint</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># docker-entrypoint.sh ,è¯¥è„šæœ¬çš„å†…å®¹å°±æ˜¯æ ¹æ® CMD çš„å†…å®¹æ¥åˆ¤æ–­ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœæ˜¯ redis-server çš„è¯ï¼Œåˆ™åˆ‡æ¢åˆ° redis ç”¨æˆ·èº«ä»½å¯åŠ¨æœåŠ¡å™¨ï¼Œå¦åˆ™ä¾æ—§ä½¿ç”¨ root èº«ä»½æ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># allow the container to be started with `--user`</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">if [ &quot;$1&quot; = &#x27;redis-server&#x27; -a &quot;$(id -u)&quot; = &#x27;0&#x27; ]; then</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    chown -R redis .</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    exec su-exec redis &quot;$0&quot; &quot;$@&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">exec &quot;$@&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="86-env-å’Œ-arg-è®¾ç½®å˜é‡">8.6. ENV å’Œ arg è®¾ç½®å˜é‡<a href="#86-env-å’Œ-arg-è®¾ç½®å˜é‡" class="hash-link" aria-label="8.6. ENV å’Œ arg è®¾ç½®å˜é‡çš„ç›´æ¥é“¾æ¥" title="8.6. ENV å’Œ arg è®¾ç½®å˜é‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>env æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡, å®šä¹‰å, å¯ä»¥åœ¨ dockerfile/å‘½ä»¤è¡Œ ä¸­ä½¿ç”¨, ä¹Ÿå¯ä»¥åœ¨ container å†…éƒ¨ä¾›ç¨‹åºä½¿ç”¨</p><p>æ ¼å¼æœ‰ä¸¤ç§ï¼š</p><ul><li><code>ENV &lt;key&gt; &lt;value&gt;</code></li><li><code>ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;...</code></li></ul><p>eg:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ENV VERSION=1.0 DEBUG=on \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    NAME=&quot;Happy Feet&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ENV NODE_VERSION 7.2.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN curl -SLO &quot;https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz&quot; \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  &amp;&amp; curl -SLO &quot;https://nodejs.org/dist/v$NODE_VERSION/SHASUMS256.txt.asc&quot; \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  &amp;&amp; gpg --batch --decrypt --output SHASUMS256.txt SHASUMS256.txt.asc \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  &amp;&amp; grep &quot; node-v$NODE_VERSION-linux-x64.tar.xz\$&quot; SHASUMS256.txt | sha256sum -c - \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  &amp;&amp; tar -xJf &quot;node-v$NODE_VERSION-linux-x64.tar.xz&quot; -C /usr/local --strip-components=1 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  &amp;&amp; rm &quot;node-v$NODE_VERSION-linux-x64.tar.xz&quot; SHASUMS256.txt.asc SHASUMS256.txt \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  &amp;&amp; ln -s /usr/local/bin/node /usr/local/bin/nodejs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ARG æ˜¯è®¾ç½®æ„å»ºå‚æ•°, ä»…ä»…ç”¨äº dockerfile/å‘½ä»¤è¡Œ ä¸­ä½¿ç”¨, åœ¨å°†æ¥å®¹å™¨è¿è¡Œæ—¶æ˜¯ä¸ä¼šå­˜åœ¨è¿™äº›ç¯å¢ƒå˜é‡çš„ </p><blockquote><p>ä½†æ˜¯ä¸è¦å› æ­¤å°±ä½¿ç”¨ ARG ä¿å­˜å¯†ç ä¹‹ç±»çš„ä¿¡æ¯ï¼Œå› ä¸º docker history è¿˜æ˜¯å¯ä»¥çœ‹åˆ°æ‰€æœ‰å€¼çš„</p></blockquote><p>å¯ä»¥åœ¨æ„å»ºå‘½ä»¤ docker build ä¸­ç”¨ <code>--build-arg &lt;å‚æ•°å&gt;=&lt;å€¼&gt;</code> æ¥è¦†ç›–ã€‚</p><blockquote><p>Define a variable that users can pass a value to at build-time with <code>docker build</code></p></blockquote><div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ARG JAR_FILE=target/*.jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="87-volume-å®šä¹‰åŒ¿åæ•°æ®å·">8.7. VOLUME å®šä¹‰åŒ¿åæ•°æ®å·<a href="#87-volume-å®šä¹‰åŒ¿åæ•°æ®å·" class="hash-link" aria-label="8.7. VOLUME å®šä¹‰åŒ¿åæ•°æ®å·çš„ç›´æ¥é“¾æ¥" title="8.7. VOLUME å®šä¹‰åŒ¿åæ•°æ®å·çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å¯¹äºæ•°æ®åº“ç±»éœ€è¦ä¿å­˜åŠ¨æ€æ•°æ®çš„åº”ç”¨ï¼Œå…¶æ•°æ®åº“æ–‡ä»¶/åŠ¨æ€æ•°æ®åº”è¯¥ä¿å­˜äºå·(volume)ä¸­, è€Œä¸è¦ç›´æ¥å†™å…¥å®¹å™¨å­˜å‚¨å±‚</p><p>ä¸ºäº†é˜²æ­¢è¿è¡Œæ—¶ç”¨æˆ·å¿˜è®°å°†åŠ¨æ€æ–‡ä»¶æ‰€ä¿å­˜ç›®å½•æŒ‚è½½ä¸ºå·ï¼Œåœ¨ Dockerfile ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº‹å…ˆæŒ‡å®šæŸäº›ç›®å½•æŒ‚è½½åˆ°åŒ¿åå·ï¼Œè¿™æ ·åœ¨è¿è¡Œæ—¶å¦‚æœç”¨æˆ·ä¸æŒ‡å®šæŒ‚è½½,åŠ¨æ€æ•°æ®ä¼šå†™å…¥åŒ¿åå·</p><p>æ ¼å¼ä¸ºï¼š</p><ul><li><code>VOLUME [&quot;&lt;è·¯å¾„1&gt;&quot;, &quot;&lt;è·¯å¾„2&gt;&quot;...]</code></li><li><code>VOLUME &lt;è·¯å¾„&gt;</code></li></ul><p><code>VOLUME /data</code> è¿™é‡Œçš„ /data ç›®å½•æ˜¯å®¹å™¨å†…çš„ç›®å½•, ä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æŒ‚è½½ä¸ºåŒ¿åå·ï¼Œä»»ä½•å‘ /data ä¸­å†™å…¥çš„ä¿¡æ¯éƒ½ä¸ä¼šè®°å½•è¿›å®¹å™¨å­˜å‚¨å±‚ï¼Œä»è€Œä¿è¯äº†å®¹å™¨å­˜å‚¨å±‚çš„æ— çŠ¶æ€åŒ–ã€‚å¯ä»¥è¿›å…¥ container, ä½¿ç”¨ <code>ll</code> æŸ¥çœ‹, ä¼šå‘ç°å®¹å™¨è‡ªåŠ¨åˆ›å»ºäº†ç›®å½• /data, å¹¶æŒ‚è½½ä¸ºåŒ¿åæ•°æ®å·</p><p>å½“ç„¶ï¼Œè¿è¡Œæ—¶å¯ä»¥è¦†ç›–è¿™ä¸ªæŒ‚è½½è®¾ç½®<code>docker run -d -v mydata:/data xxxx</code>åœ¨è¿™è¡Œå‘½ä»¤ä¸­ï¼Œå°±ä½¿ç”¨äº† mydata è¿™ä¸ªå‘½åå·æŒ‚è½½åˆ°äº† /data è¿™ä¸ªä½ç½®ï¼Œæ›¿ä»£äº† Dockerfile ä¸­å®šä¹‰çš„åŒ¿åå·çš„æŒ‚è½½é…ç½®</p><p>ä¸ºä»€ä¹ˆåœ¨ dockerfile ä¸­æ— æ³•ä½¿ç”¨ ç±»ä¼¼ <code>docker -run -v /host_path:/container_path</code> çš„æ•ˆæœ? è¿™æ—¶å‡ºäºå¯ç§»æ¤å’Œåˆ†äº«çš„è€ƒè™‘, å› ä¸ºä¸æ˜¯æ¯ä¸ª å®¿ä¸»æœºéƒ½ä¸€å®šæœ‰è¿™æ ·çš„ &quot;host_path&quot; ç‰¹å®šç›®å½•</p><p>åŒ¿åæ•°æ®å·çš„æ•°æ®åœ¨å®¿ä¸»æœºå“ªé‡Œå‘¢? <code>docker inspect &lt;container&gt;</code> å¯ä»¥åœ¨jsonçš„ volumes å€¼çœ‹åˆ°</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="88-expose-å£°æ˜ç«¯å£">8.8. EXPOSE å£°æ˜ç«¯å£<a href="#88-expose-å£°æ˜ç«¯å£" class="hash-link" aria-label="8.8. EXPOSE å£°æ˜ç«¯å£çš„ç›´æ¥é“¾æ¥" title="8.8. EXPOSE å£°æ˜ç«¯å£çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ ¼å¼ä¸º<code> EXPOSE &lt;ç«¯å£1&gt; [&lt;ç«¯å£2&gt;...]</code>ã€‚</p><p>EXPOSE æŒ‡ä»¤æ˜¯å£°æ˜è¿è¡Œæ—¶å®¹å™¨æä¾›æœåŠ¡çš„ç«¯å£, è¿™åªæ˜¯ä¸€ä¸ªå£°æ˜ï¼Œåœ¨è¿è¡Œæ—¶å¹¶ä¸ä¼šå› ä¸ºè¿™ä¸ªå£°æ˜åº”ç”¨å°±ä¼šå¼€å¯è¿™ä¸ªç«¯å£çš„æœåŠ¡ (å¿…é¡»ç¨‹åºå¼€é€šç«¯å£, è¿™é‡Œçš„å£°æ˜æ‰æœ‰æ•ˆ)</p><blockquote><p>è¦å°† EXPOSE å’Œåœ¨è¿è¡Œæ—¶ä½¿ç”¨<code> -p &lt;å®¿ä¸»ç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;</code> åŒºåˆ†å¼€æ¥ã€‚-pï¼Œæ˜¯æ˜ å°„å®¿ä¸»ç«¯å£å’Œå®¹å™¨ç«¯å£ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯å°†å®¹å™¨çš„å¯¹åº”ç«¯å£æœåŠ¡å…¬å¼€ç»™å¤–ç•Œè®¿é—®ï¼Œè€Œ EXPOSE ä»…ä»…æ˜¯å£°æ˜å®¹å™¨æ‰“ç®—ä½¿ç”¨ä»€ä¹ˆç«¯å£è€Œå·²ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨åœ¨å®¿ä¸»è¿›è¡Œç«¯å£æ˜ å°„</p></blockquote><p>é‚£æ—¢ç„¶åªæ˜¯ä¸€ä¸ªå£°æ˜, å¹¶æ²¡æœ‰å®é™…æš´éœ²ç«¯å£, æœ‰ä»€ä¹ˆç”¨å‘¢? åœ¨ Dockerfile ä¸­å†™å…¥è¿™æ ·çš„å£°æ˜æœ‰ä¸¤ä¸ªå¥½å¤„</p><ul><li>ä¸€ä¸ªæ˜¯å¸®åŠ©é•œåƒä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒæœåŠ¡çš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿é…ç½®æ˜ å°„ï¼›
</li><li>å¦ä¸€ä¸ªç”¨å¤„åˆ™æ˜¯åœ¨è¿è¡Œæ—¶ä½¿ç”¨éšæœºç«¯å£æ˜ å°„æ—¶ï¼Œä¹Ÿå°±æ˜¯ docker run -P æ—¶ï¼Œä¼šè‡ªåŠ¨éšæœºæ˜ å°„ EXPOSE çš„ç«¯å£</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="89-user-æŒ‡å®šå½“å‰ç”¨æˆ·">8.9. USER æŒ‡å®šå½“å‰ç”¨æˆ·<a href="#89-user-æŒ‡å®šå½“å‰ç”¨æˆ·" class="hash-link" aria-label="8.9. USER æŒ‡å®šå½“å‰ç”¨æˆ·çš„ç›´æ¥é“¾æ¥" title="8.9. USER æŒ‡å®šå½“å‰ç”¨æˆ·çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>USERæŒ‡ä»¤ç”¨äºæŒ‡å®šå®¹å™¨æ‰§è¡Œç¨‹åºçš„ç”¨æˆ·èº«ä»½ï¼Œé»˜è®¤æ˜¯ rootç”¨æˆ·ã€‚</p><p>åœ¨docker run ä¸­å¯ä»¥é€šè¿‡ -u é€‰é¡¹æ¥è¦†ç›–USERæŒ‡ä»¤çš„è®¾ç½®ã€‚</p><blockquote><p>eg: docker run -i -t -u mysql newmysqldb /bin/bash, å¯ä»¥å‘ç°æ˜¾ç¤ºçš„shellæç¤ºç¬¦æ˜¯ï¼š mysql@57cd57edba38:/$</p><p>dockerå®¹å™¨ä¸­çš„rootç”¨æˆ·å¯†ç æ˜¯éšæœºåˆ†é…çš„</p></blockquote><blockquote><p>USER æŒ‡ä»¤å’Œ WORKDIR ç›¸ä¼¼ï¼Œéƒ½æ˜¯æ”¹å˜ç¯å¢ƒçŠ¶æ€å¹¶å½±å“ä»¥åçš„å±‚ã€‚WORKDIR æ˜¯æ”¹å˜å·¥ä½œç›®å½•ï¼ŒUSER åˆ™æ˜¯æ”¹å˜ä¹‹åå±‚æ‰§è¡Œ RUN, CMD ä»¥åŠ ENTRYPOINT è¿™ç±»å‘½ä»¤çš„èº«ä»½</p></blockquote><p>æ ¼å¼ï¼š<code>USER &lt;ç”¨æˆ·å&gt;</code> </p><blockquote><p>è¿™ä¸ªç”¨æˆ·å¿…é¡»æ˜¯äº‹å…ˆå»ºç«‹å¥½çš„ï¼Œå¦åˆ™æ— æ³•åˆ‡æ¢ã€‚</p></blockquote><div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">RUN groupadd -r redis &amp;&amp; useradd -r -g redis redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">USER redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN [ &quot;redis-server&quot; ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>eg2:å¸Œæœ›ä»¥æŸä¸ªå·²ç»å»ºç«‹å¥½çš„ç”¨æˆ·æ¥è¿è¡ŒæŸä¸ªæœåŠ¡è¿›ç¨‹ï¼Œä¸è¦ä½¿ç”¨ su æˆ–è€… sudoï¼Œè¿™äº›éƒ½éœ€è¦æ¯”è¾ƒéº»çƒ¦çš„é…ç½®ï¼Œè€Œä¸”åœ¨ TTY ç¼ºå¤±çš„ç¯å¢ƒä¸‹ç»å¸¸å‡ºé”™ã€‚å»ºè®®ä½¿ç”¨ gosu</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å»ºç«‹ redis ç”¨æˆ·ï¼Œå¹¶ä½¿ç”¨ gosu æ¢å¦ä¸€ä¸ªç”¨æˆ·æ‰§è¡Œå‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN groupadd -r redis &amp;&amp; useradd -r -g redis redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸‹è½½ gosu</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN wget -O /usr/local/bin/gosu &quot;https://github.com/tianon/gosu/releases/download/1.7/gosu-amd64&quot; \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; chmod +x /usr/local/bin/gosu \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &amp;&amp; gosu nobody true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è®¾ç½® CMDï¼Œå¹¶ä»¥å¦å¤–çš„ç”¨æˆ·æ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [ &quot;exec&quot;, &quot;gosu&quot;, &quot;redis&quot;, &quot;redis-server&quot; ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="810-healthcheck-å¥åº·æ£€æŸ¥">8.10. HEALTHCHECK å¥åº·æ£€æŸ¥<a href="#810-healthcheck-å¥åº·æ£€æŸ¥" class="hash-link" aria-label="8.10. HEALTHCHECK å¥åº·æ£€æŸ¥çš„ç›´æ¥é“¾æ¥" title="8.10. HEALTHCHECK å¥åº·æ£€æŸ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>HEALTHCHECK æŒ‡ä»¤æ˜¯å‘Šè¯‰ Docker åº”è¯¥å¦‚ä½•è¿›è¡Œåˆ¤æ–­å®¹å™¨çš„çŠ¶æ€æ˜¯å¦æ­£å¸¸(æ¥è‡ª 1.12 ä¹‹åï¼ŒDocker æä¾›äº† HEALTHCHECK æŒ‡ä»¤ï¼Œé€šè¿‡è¯¥æŒ‡ä»¤æŒ‡å®šä¸€è¡Œå‘½ä»¤ï¼Œç”¨è¿™è¡Œå‘½ä»¤æ¥åˆ¤æ–­å®¹å™¨ä¸»è¿›ç¨‹çš„æœåŠ¡çŠ¶æ€æ˜¯å¦è¿˜æ­£å¸¸ï¼Œä»è€Œæ¯”è¾ƒçœŸå®çš„ååº”å®¹å™¨å®é™…çŠ¶æ€ã€‚)</p><p>ä¸ºä»€ä¹ˆå‡ºç°å‘¢? </p><p>åœ¨æ²¡æœ‰ HEALTHCHECK æŒ‡ä»¤å‰ï¼ŒDocker å¼•æ“åªå¯ä»¥é€šè¿‡å®¹å™¨å†…ä¸»è¿›ç¨‹æ˜¯å¦é€€å‡ºæ¥åˆ¤æ–­å®¹å™¨æ˜¯å¦çŠ¶æ€å¼‚å¸¸ã€‚å¾ˆå¤šæƒ…å†µä¸‹è¿™æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœç¨‹åºè¿›å…¥æ­»é”çŠ¶æ€ï¼Œæˆ–è€…æ­»å¾ªç¯çŠ¶æ€ï¼Œåº”ç”¨è¿›ç¨‹å¹¶ä¸é€€å‡ºï¼Œä½†æ˜¯è¯¥å®¹å™¨å·²ç»æ— æ³•æä¾›æœåŠ¡äº†ã€‚åœ¨ 1.12 ä»¥å‰ï¼ŒDocker ä¸ä¼šæ£€æµ‹åˆ°å®¹å™¨çš„è¿™ç§çŠ¶æ€ï¼Œä»è€Œä¸ä¼šé‡æ–°è°ƒåº¦ï¼Œå¯¼è‡´å¯èƒ½ä¼šæœ‰éƒ¨åˆ†å®¹å™¨å·²ç»æ— æ³•æä¾›æœåŠ¡äº†å´è¿˜åœ¨æ¥å—ç”¨æˆ·è¯·æ±‚</p><p>ç”Ÿæ•ˆçš„åŸç†: å½“åœ¨ä¸€ä¸ªé•œåƒæŒ‡å®šäº† HEALTHCHECK æŒ‡ä»¤åï¼Œç”¨å…¶å¯åŠ¨å®¹å™¨ï¼Œåˆå§‹çŠ¶æ€ä¼šä¸º <code>starting</code>ï¼Œåœ¨ HEALTHCHECK æŒ‡ä»¤æ£€æŸ¥æˆåŠŸåå˜ä¸º <code>healthy</code>ï¼Œå¦‚æœè¿ç»­ä¸€å®šæ¬¡æ•°å¤±è´¥ï¼Œåˆ™ä¼šå˜ä¸º <code>unhealthy</code>ã€‚</p><p>å’Œ CMD, ENTRYPOINT ä¸€æ ·ï¼ŒHEALTHCHECK åªå¯ä»¥å‡ºç°ä¸€æ¬¡ï¼Œå¦‚æœå†™äº†å¤šä¸ªï¼Œåªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆ</p><p>æ ¼å¼ï¼š</p><p><code>HEALTHCHECK [é€‰é¡¹] CMD &lt;å‘½ä»¤&gt;</code>ï¼šè®¾ç½®æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶å†µçš„å‘½ä»¤; å‘½ä»¤éƒ¨åˆ†çš„æ ¼å¼å’Œ ENTRYPOINT ä¸€æ ·ï¼Œåˆ†ä¸º shell æ ¼å¼ï¼Œå’Œ exec æ ¼å¼ã€‚å‘½ä»¤çš„è¿”å›å€¼å†³å®šäº†è¯¥æ¬¡å¥åº·æ£€æŸ¥çš„æˆåŠŸä¸å¦ï¼š0ï¼šæˆåŠŸï¼›1ï¼šå¤±è´¥</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># è®¾ç½®äº†æ¯ 5 ç§’æ£€æŸ¥ä¸€æ¬¡ï¼ˆè¿™é‡Œä¸ºäº†è¯•éªŒæ‰€ä»¥é—´éš”éå¸¸çŸ­ï¼Œå®é™…åº”è¯¥ç›¸å¯¹è¾ƒé•¿ï¼‰ï¼Œå¦‚æœå¥åº·æ£€æŸ¥å‘½ä»¤è¶…è¿‡ 3 ç§’æ²¡å“åº”å°±è§†ä¸ºå¤±è´¥ï¼Œå¹¶ä¸”ä½¿ç”¨ curl -fs http://localhost/ || exit 1 ä½œä¸ºå¥åº·æ£€æŸ¥å‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN apt-get update &amp;&amp; apt-get install -y curl &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">HEALTHCHECK --interval=5s --timeout=3s \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD curl -fs http://localhost/ || exit 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ”¯æŒå¦‚ä¸‹é€‰é¡¹:</p><ul><li><code>--interval=&lt;é—´éš”&gt;</code>ï¼šä¸¤æ¬¡å¥åº·æ£€æŸ¥çš„é—´éš”ï¼Œé»˜è®¤ä¸º 30 ç§’ï¼›</li><li><code>--timeout=&lt;æ—¶é•¿&gt;</code>ï¼šå¥åº·æ£€æŸ¥å‘½ä»¤è¿è¡Œè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œæœ¬æ¬¡å¥åº·æ£€æŸ¥å°±è¢«è§†ä¸ºå¤±è´¥ï¼Œé»˜è®¤ 30 ç§’ï¼›</li><li><code>--retries=&lt;æ¬¡æ•°&gt;</code>ï¼šå½“è¿ç»­å¤±è´¥æŒ‡å®šæ¬¡æ•°åï¼Œåˆ™å°†å®¹å™¨çŠ¶æ€è§†ä¸º unhealthyï¼Œé»˜è®¤ 3 æ¬¡ã€‚</li></ul><p>æŸ¥çœ‹å¥åº·æ£€æŸ¥æ—¥å¿—:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker inspect --format &#x27;{{json .State.Health}}&#x27; web | python -m json.tool</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;FailingStreak&quot;: 0,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;Log&quot;: [</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;End&quot;: &quot;2016-11-25T14:35:37.940957051Z&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;ExitCode&quot;: 0,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;Output&quot;: &quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Welcome to nginx!&lt;/title&gt;\n&lt;style&gt;\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;\n&lt;p&gt;If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.&lt;/p&gt;\n\n&lt;p&gt;For online documentation and support please refer to\n&lt;a href=\&quot;http://nginx.org/\&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;\nCommercial support is available at\n&lt;a href=\&quot;http://nginx.com/\&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;Start&quot;: &quot;2016-11-25T14:35:37.780192565Z&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;Status&quot;: &quot;healthy&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¦å¤–, <code>HEALTHCHECK NONE</code>ï¼šå¦‚æœåŸºç¡€é•œåƒæœ‰å¥åº·æ£€æŸ¥æŒ‡ä»¤ï¼Œä½¿ç”¨è¿™è¡Œå¯ä»¥å±è”½æ‰å…¶å¥åº·æ£€æŸ¥æŒ‡ä»¤</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="811-onbuild-ç»™åˆ«äººç”¨">8.11. ONBUILD ç»™åˆ«äººç”¨<a href="#811-onbuild-ç»™åˆ«äººç”¨" class="hash-link" aria-label="8.11. ONBUILD ç»™åˆ«äººç”¨çš„ç›´æ¥é“¾æ¥" title="8.11. ONBUILD ç»™åˆ«äººç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>æ ¼å¼ï¼š<code>ONBUILD &lt;å…¶å®ƒæŒ‡ä»¤&gt;</code></p><p>ONBUILD æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æŒ‡ä»¤ï¼Œå®ƒåé¢è·Ÿçš„æ˜¯å…¶å®ƒæŒ‡ä»¤ï¼Œæ¯”å¦‚ RUN, COPY ç­‰ï¼Œè€Œè¿™äº›æŒ‡ä»¤ï¼Œåœ¨å½“å‰é•œåƒæ„å»ºæ—¶å¹¶ä¸ä¼šè¢«æ‰§è¡Œã€‚åªæœ‰å½“ä»¥å½“å‰é•œåƒä¸ºåŸºç¡€é•œåƒï¼Œå»æ„å»ºä¸‹ä¸€çº§é•œåƒçš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œ</p><p>ä¸‹é¢ä»¥ä¸€ä¸ªä¾‹å­è¯´æ˜:</p><p>åˆ¶ä½œ Node.js æ‰€å†™çš„åº”ç”¨çš„é•œåƒ:  Node.js ä½¿ç”¨ npm è¿›è¡ŒåŒ…ç®¡ç†ï¼Œæ‰€æœ‰ä¾èµ–ã€é…ç½®ã€å¯åŠ¨ä¿¡æ¯ç­‰ä¼šæ”¾åˆ° package.json æ–‡ä»¶é‡Œã€‚åœ¨æ‹¿åˆ°ç¨‹åºä»£ç åï¼Œéœ€è¦å…ˆè¿›è¡Œ npm install æ‰å¯ä»¥è·å¾—æ‰€æœ‰éœ€è¦çš„ä¾èµ–ã€‚ç„¶åå°±å¯ä»¥é€šè¿‡ npm start æ¥å¯åŠ¨åº”ç”¨</p><p>Dockerfile:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">FROM node:slim</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN mkdir /app # å¯ä»¥çœæ‰?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY ./package.json /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN [ &quot;npm&quot;, &quot;install&quot; ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY . /app/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [ &quot;npm&quot;, &quot;start&quot; ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æŠŠè¿™ä¸ª Dockerfile æ”¾åˆ° Node.js é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ„å»ºå¥½é•œåƒåï¼Œå°±å¯ä»¥ç›´æ¥æ‹¿æ¥å¯åŠ¨å®¹å™¨è¿è¡Œã€‚</p><p>ç°åœ¨è€ƒè™‘è¿™æ ·çš„æƒ…æ™¯: </p><p>æˆ‘ä»¬è¿˜æœ‰ç¬¬äºŒä¸ª Node.js é¡¹ç›®, å’Œè¿™ä¸ªç±»ä¼¼, å¦‚æœéœ€è¦åˆ¶ä½œé•œåƒ, éœ€è¦å†å¤åˆ¶ä¸€ä»½Dockerfileåˆ°é¡¹ç›®æ ¹ç›®å½•, æ„å»º. è¿™é‡Œå°±æ¶‰åŠåˆ°é‡å¤äº†, å¦‚æœç¬¬ä¸€ä¸ªé¡¹ç›®æ–°å‘ç°æœ‰é—®é¢˜, ä¿®å¤å, ç¬¬äºŒä¸ªé¡¹ç›®ä¹Ÿéœ€è¦æ‰‹åŠ¨å†æ¬¡ä¿®å¤</p><p>åˆçº§æ”¹è¿›: åˆ¶ä½œä¸€ä»½åŸºç¡€é•œåƒ, åç»­çš„Dockerfile FROMè¿™ä¸ªé•œåƒ</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># åŸºç¡€é•œåƒ, åå­—ä¸º my-node</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM node:slim</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN mkdir /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [ &quot;npm&quot;, &quot;start&quot; ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…¶ä»–å­é•œåƒ, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åŸºç¡€é•œåƒå˜åŒ–åï¼Œå„ä¸ªé¡¹ç›®éƒ½ç”¨è¿™ä¸ª Dockerfile é‡æ–°æ„å»ºé•œåƒï¼Œä¼šç»§æ‰¿åŸºç¡€é•œåƒçš„æ›´æ–°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM my-node</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY ./package.json /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN [ &quot;npm&quot;, &quot;install&quot; ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COPY . /app/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ç°åœ¨è€ƒè™‘è¿™ä¸ªåœºæ™¯: å¦‚æœå­ Dockerfile é‡Œé¢æœ‰äº›ä¸œè¥¿éœ€è¦è°ƒæ•´å‘¢ï¼Ÿæ¯”å¦‚ npm install éœ€è¦åŠ ä¸€äº›å‚æ•°ï¼Œé‚£æ€ä¹ˆåŠï¼Ÿè¿™ä¸€è¡Œ RUN æ˜¯ä¸å¯èƒ½æ”¾å…¥åŸºç¡€é•œåƒçš„ï¼Œé‚£ä¹ˆåªèƒ½æ¯ä¸ª å­ dockerfile éƒ½ä¿®æ”¹ npm install è¿™æ¡å‘½ä»¤äº†, èƒ½å¦å°†å­fileä¸­çš„å‘½ä»¤æåˆ°å…¬å…±file ä¸­è€Œä¸æ‰§è¡Œå‘¢?</p><p>ONBUILD å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</p><p>åŸºç¡€é•œåƒ:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">FROM node:slim</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN mkdir /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸‹é¢ä¸‰è¡Œåœ¨å½“å‰ dockerfile æ„å»ºæ—¶å€™ä¸ä¼šæ‰§è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ONBUILD COPY ./package.json /app</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ONBUILD RUN [ &quot;npm&quot;, &quot;install&quot; ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ONBUILD COPY . /app/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [ &quot;npm&quot;, &quot;start&quot; ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ç„¶åå„ä¸ªå­é¡¹ç›®çš„ Dockerfile å°±å˜æˆäº†ç®€å•åœ°</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å½“åœ¨å„ä¸ªé¡¹ç›®ç›®å½•ä¸­ï¼Œç”¨è¿™ä¸ªåªæœ‰ä¸€è¡Œçš„ Dockerfile æ„å»ºé•œåƒæ—¶ï¼Œä¹‹å‰åŸºç¡€é•œåƒçš„é‚£ä¸‰è¡Œ ONBUILD å°±ä¼šå¼€å§‹æ‰§è¡Œï¼ŒæˆåŠŸçš„å°†å½“å‰é¡¹ç›®çš„ä»£ç å¤åˆ¶è¿›é•œåƒã€å¹¶ä¸”é’ˆå¯¹æœ¬é¡¹ç›®æ‰§è¡Œ npm installï¼Œç”Ÿæˆåº”ç”¨é•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM my-node</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="812-multi-stage-å¤šé˜¶æ®µæ„å»º">8.12. multi-stage å¤šé˜¶æ®µæ„å»º<a href="#812-multi-stage-å¤šé˜¶æ®µæ„å»º" class="hash-link" aria-label="8.12. multi-stage å¤šé˜¶æ®µæ„å»ºçš„ç›´æ¥é“¾æ¥" title="8.12. multi-stage å¤šé˜¶æ®µæ„å»ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ä¸€ç§æ–¹å¼æ˜¯å°†æ‰€æœ‰çš„æ„å»ºè¿‡ç¨‹åŒ…å«åœ¨ä¸€ä¸ª Dockerfile ä¸­ï¼ŒåŒ…æ‹¬é¡¹ç›®åŠå…¶ä¾èµ–åº“çš„ç¼–è¯‘ã€æµ‹è¯•ã€æ‰“åŒ…ç­‰æµç¨‹ï¼Œè¿™é‡Œå¯èƒ½ä¼šå¸¦æ¥çš„ä¸€äº›é—®é¢˜ï¼š</p><ul><li><p>Dockerfile ç‰¹åˆ«é•¿ï¼Œå¯ç»´æŠ¤æ€§é™ä½</p></li><li><p>é•œåƒå±‚æ¬¡å¤šï¼Œé•œåƒä½“ç§¯è¾ƒå¤§ï¼Œéƒ¨ç½²æ—¶é—´å˜é•¿</p></li><li><p>æºä»£ç å­˜åœ¨æ³„éœ²çš„é£é™©</p></li></ul><p>å¥½å¤„æ˜¯å¯ä»¥å‡å°é•œåƒä½“ç§¯</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8121-æ¸…ç†ç¼“å­˜çš„é•œåƒ">8.12.1. æ¸…ç†ç¼“å­˜çš„é•œåƒ<a href="#8121-æ¸…ç†ç¼“å­˜çš„é•œåƒ" class="hash-link" aria-label="8.12.1. æ¸…ç†ç¼“å­˜çš„é•œåƒçš„ç›´æ¥é“¾æ¥" title="8.12.1. æ¸…ç†ç¼“å­˜çš„é•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">crontab </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">e</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ¯å¤©å¤œé‡Œ</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">ç‚¹é’Ÿåˆ é™¤</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">å¤©ï¼ˆ48hï¼‰ä¹‹å‰çš„image</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> docker image prune </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">a </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">force </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">filter </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;until=48h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">systemctl restart crond</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>9. ä½¿ç”¨å®¹å™¨</h1><p>å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ï¼Œä»¥åŠå®ƒä»¬çš„è¿è¡Œæ€ç¯å¢ƒ</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="91-use-docker-in-github-action">9.1. use docker in github action<a href="#91-use-docker-in-github-action" class="hash-link" aria-label="9.1. use docker in github actionçš„ç›´æ¥é“¾æ¥" title="9.1. use docker in github actionçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://dev.to/mihinduranasinghe/using-docker-containers-in-jobs-github-actions-3eof" target="_blank" rel="noopener noreferrer">https://dev.to/mihinduranasinghe/using-docker-containers-in-jobs-github-actions-3eof</a></p><p><a href="https://yonatankra.com/2-ways-to-use-your-docker-image-in-github-actions/" target="_blank" rel="noopener noreferrer">https://yonatankra.com/2-ways-to-use-your-docker-image-in-github-actions/</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="92-æŸ¥çœ‹">9.2. æŸ¥çœ‹<a href="#92-æŸ¥çœ‹" class="hash-link" aria-label="9.2. æŸ¥çœ‹çš„ç›´æ¥é“¾æ¥" title="9.2. æŸ¥çœ‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><ul><li><code>docker container ls -a</code>or<code>docker ps -a</code> æŸ¥çœ‹æ‰€æœ‰, åŒ…æ‹¬å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨</li><li><code>docker container ls</code>or<code>docker ps</code> ä»…æŸ¥çœ‹è¿è¡ŒçŠ¶æ€çš„å®¹å™¨</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="93-å¯åŠ¨">9.3. å¯åŠ¨<a href="#93-å¯åŠ¨" class="hash-link" aria-label="9.3. å¯åŠ¨çš„ç›´æ¥é“¾æ¥" title="9.3. å¯åŠ¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å¯åŠ¨å®¹å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäºé•œåƒæ–°å»ºä¸€ä¸ªå®¹å™¨å¹¶å¯åŠ¨(å¸¸ç”¨)ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å°†åœ¨ç»ˆæ­¢çŠ¶æ€ï¼ˆstoppedï¼‰çš„å®¹å™¨é‡æ–°å¯åŠ¨ã€‚</p><p>æ–°å»ºå®¹å™¨å¹¶å¯åŠ¨: <code>docker run &lt;å®¹å™¨å:ç‰ˆæœ¬&gt; &lt;å‘½ä»¤&gt;</code>)</p><p>å¯åŠ¨å·²æœ‰çš„å®¹å™¨: <code>docker start &lt;container&gt;</code> or <code>docker container start/restart xxx</code></p><p>å½“åˆ©ç”¨ docker run æ¥åˆ›å»ºå®¹å™¨æ—¶ï¼ŒDocker åœ¨åå°è¿›è¡Œå¦‚ä¸‹æµç¨‹:</p><ul><li>æ£€æŸ¥æœ¬åœ°æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é•œåƒï¼Œä¸å­˜åœ¨å°±ä»å…¬æœ‰ä»“åº“ä¸‹è½½</li><li>åˆ©ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨</li><li>åˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å†™å±‚</li><li>ä»å®¿ä¸»ä¸»æœºé…ç½®çš„ç½‘æ¡¥æ¥å£ä¸­æ¡¥æ¥ä¸€ä¸ªè™šæ‹Ÿæ¥å£åˆ°å®¹å™¨ä¸­å»</li><li>ä»åœ°å€æ± é…ç½®ä¸€ä¸ª ip åœ°å€ç»™å®¹å™¨</li><li>æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åº (å¦‚æœæœ‰çš„è¯)</li><li>æ‰§è¡Œå®Œæ¯•åå®¹å™¨è¢«ç»ˆæ­¢</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="931--it-ç»´æŒäº¤äº’ç»ˆç«¯">9.3.1. -it ç»´æŒäº¤äº’ç»ˆç«¯<a href="#931--it-ç»´æŒäº¤äº’ç»ˆç«¯" class="hash-link" aria-label="9.3.1. -it ç»´æŒäº¤äº’ç»ˆç«¯çš„ç›´æ¥é“¾æ¥" title="9.3.1. -it ç»´æŒäº¤äº’ç»ˆç«¯çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>eg:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># è¾“å‡ºä¸€ä¸ª â€œHello Worldâ€ï¼Œä¹‹åç»ˆæ­¢å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run ubuntu:14.04 /bin/echo &#x27;Hello world&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Hello world</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯åŠ¨ä¸€ä¸ª bash ç»ˆç«¯ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œäº¤äº’</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…¶ä¸­ï¼Œ-t é€‰é¡¹è®©Dockeråˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼ˆpseudo-ttyï¼‰å¹¶ç»‘å®šåˆ°å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¸Šï¼Œ -i åˆ™è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€(ä»¥ä¾¿äº¤äº’å¼æ“ä½œ)ã€‚ -it ä¸€èˆ¬ä¸€èµ·ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -t -i ubuntu:14.04 /bin/bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@af8bae53bdd3:/#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="932--d-åå°è¿è¡Œ">9.3.2. -d åå°è¿è¡Œ<a href="#932--d-åå°è¿è¡Œ" class="hash-link" aria-label="9.3.2. -d åå°è¿è¡Œçš„ç›´æ¥é“¾æ¥" title="9.3.2. -d åå°è¿è¡Œçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å‰é¢éƒ½æ˜¯åœ¨å‰å°è¿è¡Œçš„, å¦‚ä½•ä»¥å®ˆæŠ¤çŠ¶æ€è¿è¡Œ? é€šè¿‡ <code>docker run -d</code></p><p>eg:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœä¸ä½¿ç”¨ -d å‚æ•°è¿è¡Œå®¹å™¨,å®¹å™¨ä¼šæŠŠè¾“å‡ºçš„ç»“æœ (STDOUT) æ‰“å°åˆ°å®¿ä¸»æœºä¸Šé¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run ubuntu:17.10 /bin/sh -c &quot;while true; do echo hello world; sleep 1; done&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">hello world</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">hello world</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">hello world</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">hello world</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœä½¿ç”¨äº† -d å‚æ•°è¿è¡Œå®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ­¤æ—¶å®¹å™¨ä¼šåœ¨åå°è¿è¡Œ, å®¿ä¸»æœºå™¨æ²¡æœ‰ä»»ä½•è¾“å‡º(è¾“å‡ºç»“æœå¯ä»¥ç”¨ docker logs æŸ¥çœ‹)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d ubuntu:17.10 /bin/sh -c &quot;while true; do echo hello world; sleep 1; done&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">77b2dc01fe0f3f1265df143181e7b9af5e05279a884f4776ee75350ea9d8017a</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker container logs &lt;container ID or NAMES&gt; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker logs &lt;container id or name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="933---privilegedtrue-èµ‹äºˆç‰¹æƒ">9.3.3. --privileged=true èµ‹äºˆç‰¹æƒ<a href="#933---privilegedtrue-èµ‹äºˆç‰¹æƒ" class="hash-link" aria-label="9.3.3. --privileged=true èµ‹äºˆç‰¹æƒçš„ç›´æ¥é“¾æ¥" title="9.3.3. --privileged=true èµ‹äºˆç‰¹æƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ˜¯å¦è®©docker åº”ç”¨å®¹å™¨ è·å–å®¿ä¸»æœºrootæƒé™</p><p>ä½¿ç”¨è¯¥å‚æ•°ï¼Œcontainerå†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™ã€‚
å¦åˆ™ï¼Œcontainerå†…çš„rootåªæ˜¯å¤–éƒ¨çš„ä¸€ä¸ªæ™®é€šç”¨æˆ·æƒé™ã€‚
privilegedå¯åŠ¨çš„å®¹å™¨ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šhostä¸Šçš„è®¾å¤‡ï¼Œå¹¶ä¸”å¯ä»¥æ‰§è¡Œmountã€‚
ç”šè‡³å…è®¸ä½ åœ¨dockerå®¹å™¨ä¸­å¯åŠ¨dockerå®¹å™¨ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="94-ç»ˆæ­¢container">9.4. ç»ˆæ­¢container<a href="#94-ç»ˆæ­¢container" class="hash-link" aria-label="9.4. ç»ˆæ­¢containerçš„ç›´æ¥é“¾æ¥" title="9.4. ç»ˆæ­¢containerçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><code>docker container stop &lt;xxx&gt;</code></p><p>æ­¤å¤–ï¼Œå½“ Docker å®¹å™¨ä¸­æŒ‡å®šçš„åº”ç”¨ç»ˆç»“æ—¶ï¼Œå®¹å™¨ä¹Ÿè‡ªåŠ¨ç»ˆæ­¢(ä¾‹å¦‚: åªå¯åŠ¨äº†ä¸€ä¸ªç»ˆç«¯çš„å®¹å™¨ï¼Œç”¨æˆ·é€šè¿‡ exit å‘½ä»¤æˆ– Ctrl+d æ¥é€€å‡ºç»ˆç«¯æ—¶ï¼Œæ‰€åˆ›å»ºçš„å®¹å™¨ç«‹åˆ»ç»ˆæ­¢ã€‚)</p><p><code>docker container ls -a</code> æŸ¥çœ‹æ‰€æœ‰çš„container, åŒ…æ‹¬åœæ­¢çš„container</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="95-åˆ é™¤container">9.5. åˆ é™¤container<a href="#95-åˆ é™¤container" class="hash-link" aria-label="9.5. åˆ é™¤containerçš„ç›´æ¥é“¾æ¥" title="9.5. åˆ é™¤containerçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>containerç»ˆæ­¢å, ä¸ä¼šåˆ é™¤, éœ€è¦æ‰‹åŠ¨åˆ é™¤</p><ul><li><code>docker container rm &lt;xxx&gt;</code> åˆ é™¤æŒ‡å®šcontainer(å®¹å™¨å¤„äºç»ˆæ­¢çŠ¶æ€)</li><li><code>docker container rm -f &lt;xxx&gt;</code>å¦‚æœè¦åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼Œå¯ä»¥æ·»åŠ  -f å‚æ•°ã€‚Docker ä¼šå‘é€ SIGKILL ä¿¡å·ç»™å®¹å™¨</li><li><code>docker container prune</code> åˆ é™¤æ‰€æœ‰ç»ˆæ­¢çš„å®¹å™¨</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="96-è¿›å…¥å®¹å™¨">9.6. è¿›å…¥å®¹å™¨<a href="#96-è¿›å…¥å®¹å™¨" class="hash-link" aria-label="9.6. è¿›å…¥å®¹å™¨çš„ç›´æ¥é“¾æ¥" title="9.6. è¿›å…¥å®¹å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>åœ¨ä½¿ç”¨ -d å‚æ•°æ—¶ï¼Œå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥åå°, æŸäº›æ—¶å€™éœ€è¦è¿›å…¥å®¹å™¨è¿›è¡Œæ“ä½œï¼ŒåŒ…æ‹¬ä½¿ç”¨ docker attach å‘½ä»¤æˆ– docker exec å‘½ä»¤(æ¨èåè€…, å› ä¸ºåè€…exitæ—¶ä¸ä¼šå¯¼è‡´å®¹å™¨é€€å‡º)</p><ul><li><p><code>docker attach &lt;xxx&gt;</code> è¿›å…¥container, å½“exitæ—¶, å®¹å™¨ä¹Ÿéšä¹‹ç»ˆæ­¢</p></li><li><p><code>docker exec -it &lt;xxx&gt; bash</code> è¿›å…¥container, é€€å‡ºæ—¶å®¹å™¨ä¸ä¼šç»ˆæ­¢(æ³¨æ„, åé¢è¦è·Ÿä¸€ä¸ªå‘½ä»¤bash)</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="97-å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡º">9.7. å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡º<a href="#97-å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡º" class="hash-link" aria-label="9.7. å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡ºçš„ç›´æ¥é“¾æ¥" title="9.7. å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡ºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å¯¼å‡º</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker container ls -a</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                    PORTS               NAMES</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">7691a814370e        ubuntu:14.04        &quot;/bin/bash&quot;         36 hours ago        Exited (0) 21 hours ago                       test</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker export 7691a814370e &gt; ubuntu.tar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™æ ·å°†å¯¼å‡ºå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°æ–‡ä»¶</p><p>å¯¼å…¥å®¹å™¨å¿«ç…§ä¸ºé•œåƒ:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ cat ubuntu.tar | docker import - test/ubuntu:v1.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker image ls</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">REPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">test/ubuntu         v1.0                9d37a6082e97        About a minute ago   171.3 MB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æˆ–è€…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker import http://example.com/exampleimage.tgz example/imagerepo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>docker importå’Œdocker loadæ¯”è¾ƒ: å®¹å™¨å¿«ç…§æ–‡ä»¶(docker import)å°†ä¸¢å¼ƒæ‰€æœ‰çš„å†å²è®°å½•å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆå³ä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶(docker load)å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯ä¹Ÿè¦å¤§ã€‚æ­¤å¤–ï¼Œä»å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="98-æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœº">9.8. æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœº<a href="#98-æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœº" class="hash-link" aria-label="9.8. æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœºçš„ç›´æ¥é“¾æ¥" title="9.8. æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><code>docker cp &lt;container_name&gt;:/path &lt;host_path&gt;</code></p><h1>10. è®¿é—®é•œåƒä»“åº“</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="101-dockerhub">10.1. dockerhub<a href="#101-dockerhub" class="hash-link" aria-label="10.1. dockerhubçš„ç›´æ¥é“¾æ¥" title="10.1. dockerhubçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><code>docker login</code>ç™»å½•
<code>docker logout</code> é€€å‡º</p><p><code>docker search &lt;xxx&gt;</code> æœç´¢
<code>docker pull &lt;xxx&gt;</code> ä¸‹è½½åˆ°æœ¬åœ°</p><p>æ¨é€é•œåƒåˆ°è‡ªå·±çš„ä»“åº“:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># æ ‡è®°æ–°çš„tagç”¨äºæ¨é€åˆ°è¿œç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å³ä¿®æ”¹é•œåƒåå­— (ä¸è¿‡ä¸€èˆ¬åœ¨ build image æ—¶å°±åº”è¯¥è§„èŒƒæŒ‡å®šå¥½æœ€ç»ˆåå­—)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker tag &lt;image_old_name/old_id&gt; xiaoyureed/ubuntu:17.10</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker image ls</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">REPOSITORY                                               TAG                    IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ubuntu                                                   17.10                  275d79972a86        6 days ago          94.6MB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">username/ubuntu                                          17.10                  275d79972a86        6 days ago          94.6MB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ¨é€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker push xiaoyureed/ubuntu:17.10</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç°åœ¨æœç´¢å¯ä»¥æœåˆ°äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker search username</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME                      DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">xiaoyureed/ubuntu</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ­¤å¤–, docker hub æ”¯æŒ è‡ªåŠ¨åˆ›å»º(Automated Builds), å¯¹äºéœ€è¦ç»å¸¸å‡çº§é•œåƒå†…ç¨‹åºæ¥è¯´ï¼Œååˆ†æ–¹ä¾¿ </p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1011-publish-by-using-github-action">10.1.1. publish by using github action<a href="#1011-publish-by-using-github-action" class="hash-link" aria-label="10.1.1. publish by using github actionçš„ç›´æ¥é“¾æ¥" title="10.1.1. publish by using github actionçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://twbhub.com/post/github-actions_publish_images/" target="_blank" rel="noopener noreferrer">https://twbhub.com/post/github-actions_publish_images/</a>
todo</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="102-ç§æœ‰ä»“åº“">10.2. ç§æœ‰ä»“åº“<a href="#102-ç§æœ‰ä»“åº“" class="hash-link" aria-label="10.2. ç§æœ‰ä»“åº“çš„ç›´æ¥é“¾æ¥" title="10.2. ç§æœ‰ä»“åº“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="allow-http">allow http<a href="#allow-http" class="hash-link" aria-label="allow httpçš„ç›´æ¥é“¾æ¥" title="allow httpçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æƒ³è®©æœ¬ç½‘æ®µçš„å…¶ä»–ä¸»æœºä¹Ÿèƒ½æŠŠé•œåƒæ¨é€åˆ°ç§æœ‰ä»“åº“ã€‚ä½ å°±å¾—æŠŠä¾‹å¦‚ 192.168.199.100:5000 è¿™æ ·çš„å†…ç½‘åœ°å€ä½œä¸ºç§æœ‰ä»“åº“åœ°å€ï¼Œè¿™æ—¶ä½ ä¼šå‘ç°æ— æ³•æˆåŠŸæ¨é€é•œåƒã€‚è¿™æ˜¯å› ä¸º Docker é»˜è®¤ä¸å…è®¸é HTTPS æ–¹å¼æ¨é€é•œåƒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Docker çš„é…ç½®é€‰é¡¹æ¥å–æ¶ˆè¿™ä¸ªé™åˆ¶:</p><p><code>/etc/docker/daemon.json</code></p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token property">&quot;registry-mirror&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://hub-mirror.c.163.com&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://mirror.baidubce.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token property">&quot;insecure-registries&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;192.168.199.100:5000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="harboræ¨è">harbor(æ¨è)<a href="#harboræ¨è" class="hash-link" aria-label="harbor(æ¨è)çš„ç›´æ¥é“¾æ¥" title="harbor(æ¨è)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><a href="https://github.com/goharbor/harbor" target="_blank" rel="noopener noreferrer">https://github.com/goharbor/harbor</a> , å¸¦ gui, user management</p><blockquote><p>ç”±VMWareåœ¨Docker Registryçš„åŸºç¡€ä¹‹ä¸Šè¿›è¡Œäº†äºŒæ¬¡å°è£…ï¼ŒåŠ è¿›å»äº†å¾ˆå¤šé¢å¤–ç¨‹åºï¼Œè€Œä¸”æä¾›äº†ä¸€ä¸ªéå¸¸æ¼‚äº®çš„webç•Œé¢ã€‚</p></blockquote><p>ä»ç§æœæ‹‰å–é•œåƒ: å…ˆç™»å½• <code> docker login -u admin -p xxx &lt;harbor ip&gt;</code>, å†æ‹‰å– <code>docker pull 182.168.xxx.xxx/org_name/img_name:v</code></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="k8s-é…ç½®harbor">k8s é…ç½®harbor<a href="#k8s-é…ç½®harbor" class="hash-link" aria-label="k8s é…ç½®harborçš„ç›´æ¥é“¾æ¥" title="k8s é…ç½®harborçš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>åœ¨ä»»æ„èŠ‚ç‚¹ docker ç™»å½• harbor å, <code>/root/.docker/config.json</code> èƒ½æŸ¥çœ‹å¯†ç , å°† json å†…å®¹ base64 ç¼–ç  <code>cat /root/.docker/config.json | base64 -w O</code>, åˆ›å»º secret.yml:</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Secret</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># å€¼ &quot;login&quot; ä¼šåœ¨ Deployment ä¸­ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> login</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> kubernetes.io/dockerconfigjson</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">.dockerconfigjson</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> &lt;base64_value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>kc apply -f secret.yml</code></p><p>åœ¨ deployment ä¸­å¦‚ä½•ä½¿ç”¨?</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> &lt;harbor url</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">/org/img_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">version</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">imagePullSecretes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)"># é…ç½®k8s ç™»å½• harbor æ—¶ä½¿ç”¨çš„ secret å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> login</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nexus">Nexus<a href="#nexus" class="hash-link" aria-label="Nexusçš„ç›´æ¥é“¾æ¥" title="Nexusçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>å¤šç”¨äº æ­å»º Maven repo, ä¹Ÿèƒ½å­˜å‚¨ docker image</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker-registry">docker-registry<a href="#docker-registry" class="hash-link" aria-label="docker-registryçš„ç›´æ¥é“¾æ¥" title="docker-registryçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>docker hub æä¾›, ä¸€ä¸ªé•œåƒå³å¯æ‹‰èµ·æ¥, æ²¡æœ‰ gui, ä½†æ˜¯ç¤¾åŒºæœ‰ gui</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker pull docker.io/registry:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker pull konradkleine/docker-registry-frontend:v2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d  -p 5000:5000  --restart=always  --name registry docker.io/registry:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d  --link registry:registry  --name registry-frontend  -e ENV_DOCKER_REGISTRY_HOST=registry  -e ENV_DOCKER_REGISTRY_PORT=5000  -p 9090:80  konradkleine/docker-registry-frontend:v2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>11. dockeræ•°æ®ç®¡ç†</h1><p>Docker container äº§ç”Ÿçš„æ•°æ®åœ¨ container åˆ é™¤åå°±ä¸¢å¤±äº†, é™¤é commit è¿™ä¸ª container ç”Ÿæˆæ–°çš„ image, é‚£ä¹ˆå¦‚ä½•ä¿å­˜è¿™äº›æ•°æ®å‘¢:</p><ul><li><p>æ•°æ®å·ï¼ˆVolumesï¼‰</p></li><li><p>æŒ‚è½½ä¸»æœºç›®å½• (Bind mounts)</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="111-æ•°æ®å·">11.1. æ•°æ®å·<a href="#111-æ•°æ®å·" class="hash-link" aria-label="11.1. æ•°æ®å·çš„ç›´æ¥é“¾æ¥" title="11.1. æ•°æ®å·çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>docker é»˜è®¤åœ¨ä¸»æœºä¸Šä¼šæœ‰ä¸€ä¸ªç‰¹å®šçš„åŒºåŸŸï¼ˆ/var/lib/docker/volumes/ Linuxï¼‰ï¼Œè¯¥åŒºåŸŸç”¨æ¥å­˜æ”¾ volumeã€‚volume åœ¨ç”Ÿæˆçš„æ—¶å€™å¦‚æœä¸æŒ‡å®šåç§°ï¼Œä¾¿ä¼šéšæœºç”Ÿæˆ</p><p>æ•°æ®å· æ˜¯è¢«è®¾è®¡ç”¨æ¥æŒä¹…åŒ–æ•°æ®çš„ , ç±»ä¼¼linuxä¸‹ç›®å½•çš„mount; å®ƒç»•è¿‡ UFSï¼Œå¯ä»¥æä¾›å¾ˆå¤šæœ‰ç”¨çš„ç‰¹æ€§ï¼š</p><ul><li><p>æ•°æ®å· å¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«å’Œé‡ç”¨</p></li><li><p>å¯¹ æ•°æ®å· çš„æ›´æ–°ï¼Œä¸ä¼šå½±å“é•œåƒ</p></li><li><p>æ•°æ®å· é»˜è®¤ä¼šä¸€ç›´å­˜åœ¨ï¼Œå³ä½¿å®¹å™¨è¢«åˆ é™¤</p><p>  å®ƒçš„ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹äºå®¹å™¨ï¼ŒDocker ä¸ä¼šåœ¨å®¹å™¨è¢«åˆ é™¤åè‡ªåŠ¨åˆ é™¤ æ•°æ®å·</p></li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">`docker volume create my-vol` åˆ›å»ºä¸€ä¸ªvolume</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">`docker volume ls` æŸ¥çœ‹æ‰€æœ‰çš„volume</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">`docker volume inspect my-vol` æŸ¥çœ‹æŒ‡å®šçš„volume</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">`docker inspect web` åœ¨å®¹å™¨ä¸­æŸ¥çœ‹volumeä¿¡æ¯(æ•°æ®å· ä¿¡æ¯åœ¨ &quot;Mounts&quot; Key ä¸‹é¢, è¿™é‡Œçš„webä¸ºcontainerå)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">`docker volume rm my-vol`åˆ é™¤volume</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">`docker volume prune` æ¸…ç†æ— ä¸»çš„volume</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker rm -v &lt;container_id&gt; åˆ é™¤å®¹å™¨åŒæ—¶åˆ é™¤ volume</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºä¸€ä¸ªcontaineråŒæ—¶æŒ‚è½½ä¸€ä¸ª/å¤šä¸ªæ•°æ®å·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºä¸€ä¸ªåä¸º web çš„å®¹å™¨ï¼Œå¹¶åŠ è½½ä¸€ä¸ª æ•°æ®å· åˆ°å®¹å™¨çš„ /webapp ç›®å½•ã€‚, å¦‚æœ/webappä¸­æœ‰å†…å®¹åˆ™æš‚æ—¶ä¼šè¢«å±è”½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -P \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --name web \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # -v my-vol:/wepapp \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # ç­‰åŒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --mount source=my-vol,target=/webapp \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    training/webapp \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    python app.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="112-æŒ‚è½½ä¸»æœºç›®å½•">11.2. æŒ‚è½½ä¸»æœºç›®å½•<a href="#112-æŒ‚è½½ä¸»æœºç›®å½•" class="hash-link" aria-label="11.2. æŒ‚è½½ä¸»æœºç›®å½•çš„ç›´æ¥é“¾æ¥" title="11.2. æŒ‚è½½ä¸»æœºç›®å½•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ä½¿ç”¨<code> --mount</code> æ ‡è®°å¯ä»¥æŒ‡å®šæŒ‚è½½ä¸€ä¸ªæœ¬åœ°ä¸»æœºçš„ç›®å½•åˆ°å®¹å™¨ä¸­å» (ä¹Ÿå¯ä»¥æŒ‚åœ¨æ•°æ®å·åˆ°å®¹å™¨ä¸­å»)</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># åŠ è½½ä¸»æœºçš„ /src/webapp ç›®å½•åˆ°å®¹å™¨çš„ /opt/webappç›®å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -P \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --name web \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # -v /src/webapp:/opt/webapp \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --mount type=bind,source=/src/webapp,target=/opt/webapp \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    training/webapp \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    python app.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™ä¸ªåŠŸèƒ½åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ååˆ†æ–¹ä¾¿ï¼Œæ¯”å¦‚ç”¨æˆ·å¯ä»¥æ”¾ç½®ä¸€äº›ç¨‹åºåˆ°æœ¬åœ°ç›®å½•ä¸­ï¼Œæ¥æŸ¥çœ‹å®¹å™¨æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚æœ¬åœ°ç›®å½•çš„è·¯å¾„å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„</p><p>Docker æŒ‚è½½ä¸»æœºç›®å½•çš„é»˜è®¤æƒé™æ˜¯ è¯»å†™ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡å¢åŠ  readonly æŒ‡å®šä¸º åªè¯»:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -P \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --name web \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # -v /src/webapp:/opt/webapp:ro \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --mount type=bind,source=/src/webapp,target=/opt/webapp,readonly \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    training/webapp \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    python app.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æŸ¥çœ‹ä½¿ç”¨<code>docker inspect &lt;container name&gt;</code>, æŒ‚è½½ä¸»æœºç›®å½• çš„é…ç½®ä¿¡æ¯åœ¨ &quot;Mounts&quot; Key ä¸‹é¢;</p><p>ä¹Ÿå¯ä»¥æŒ‚è½½ä¸»æœºå•ä¸ªæ–‡ä»¶</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker run --rm -it \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   # -v $HOME/.bash_history:/root/.bash_history \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   --mount type=bind,source=$HOME/.bash_history,target=/root/.bash_history \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   ubuntu:17.10 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@2affd44b4667:/# history</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1  ls</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2  diskutil list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™æ ·å°±å¯ä»¥è®°å½•åœ¨å®¹å™¨è¾“å…¥è¿‡çš„å‘½ä»¤äº†</p><p>--mount å’Œ -v åŒºåˆ«:</p><p><a href="http://einverne.github.io/post/2018/03/docker-v-and-mount.html" target="_blank" rel="noopener noreferrer">http://einverne.github.io/post/2018/03/docker-v-and-mount.html</a></p><ul><li><p>-v é€‰é¡¹å°†æ‰€æœ‰é€‰é¡¹é›†ä¸­åˆ°ä¸€ä¸ªå€¼, æ›´ç²¾ç®€</p><p>-v æˆ– --volume: åŒ…å«ä¸‰ä¸ª fieldï¼Œä½¿ç”¨ : æ¥åˆ†å‰²ï¼Œæ‰€æœ‰å€¼éœ€è¦æŒ‰ç…§æ­£ç¡®çš„é¡ºåºã€‚ç¬¬ä¸€ä¸ª field æ˜¯ volume çš„åå­—ï¼Œå¹¶ä¸”åœ¨å®¿ä¸»æœºä¸Šå”¯ä¸€ï¼Œå¯¹äºåŒ¿å volumeï¼Œç¬¬ä¸€ä¸ªfieldé€šå¸¸è¢«çœç•¥ï¼›ç¬¬äºŒä¸ªfieldæ˜¯å®¿ä¸»æœºä¸Šå°†è¦è¢«æŒ‚è½½åˆ°å®¹å™¨çš„pathæˆ–è€…æ–‡ä»¶ï¼›ç¬¬ä¸‰ä¸ªfieldå¯é€‰ï¼Œæ¯”å¦‚è¯´ ro</p></li><li><p>--mount é€‰é¡¹å°†å¯é€‰é¡¹åˆ†å¼€, æ›´å•°å—¦</p><p>--mount: åŒ…å«å¤šä¸ª key-value å¯¹ï¼Œä½¿ç”¨é€—å·åˆ†å‰²ã€‚--mount é€‰é¡¹æ›´åŠ å¤æ‚ï¼Œä½†æ˜¯å„ä¸ªå€¼ä¹‹é—´æ— éœ€è€ƒè™‘é¡ºåºã€‚</p><p>typeï¼Œå¯ä»¥ä¸º bind, volume, tmpfs, é€šå¸¸ä¸º volume
source ä¹Ÿå¯ä»¥å†™æˆ srcï¼Œå¯¹äº named volumesï¼Œå¯ä»¥è®¾ç½® volume çš„åå­—ï¼Œå¯¹äºåŒ¿å volumeï¼Œå¯ä»¥çœç•¥
destination å¯ä»¥å†™æˆ dstæˆ–è€… target è¯¥å€¼ä¼šæŒ‚è½½åˆ°å®¹å™¨
readonly å¯é€‰ï¼Œå¦‚æœä½¿ç”¨ï¼Œè¡¨ç¤ºåªè¯»
volume-opt å¯é€‰ï¼Œå¯ä»¥ä½¿ç”¨å¤šæ¬¡</p></li></ul><p>å¦‚:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker run -d \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --name=nginxtest \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --mount source=nginx-vol,destination=/usr/share/nginx/html \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  nginx:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --name=nginxtest \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -v nginx-vol:/usr/share/nginx/html \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  nginx:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="113-volume-çš„å…±äº«">11.3. volume çš„å…±äº«<a href="#113-volume-çš„å…±äº«" class="hash-link" aria-label="11.3. volume çš„å…±äº«çš„ç›´æ¥é“¾æ¥" title="11.3. volume çš„å…±äº«çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><code>--volume-from</code> ä¸ºå½“å‰åˆ›å»ºçš„å®¹å™¨æŒ‡å®šå…¶ä»–å®¹å™¨çš„ volume</p><p>æœ‰é•œåƒ imageA, æ´¾ç”Ÿå®¹å™¨ container1, æŒ‚è½½æœ‰åŒ¿åå· /data, <code>docker run --name container2 --volume-from container1 imageA</code> é‚£ä¹ˆ /data ç›®å½•ä¼šè¢«ä¸¤ä¸ª å®¹å™¨å…±äº«</p><h1>12. ç½‘ç»œäº’è”</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="121-docker-é»˜è®¤åˆå§‹åˆ›å»º3-ä¸ªç½‘ç»œ">12.1. docker é»˜è®¤åˆå§‹åˆ›å»º3 ä¸ªç½‘ç»œ<a href="#121-docker-é»˜è®¤åˆå§‹åˆ›å»º3-ä¸ªç½‘ç»œ" class="hash-link" aria-label="12.1. docker é»˜è®¤åˆå§‹åˆ›å»º3 ä¸ªç½‘ç»œçš„ç›´æ¥é“¾æ¥" title="12.1. docker é»˜è®¤åˆå§‹åˆ›å»º3 ä¸ªç½‘ç»œçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>docker å®‰è£…çš„æ—¶å€™ï¼Œä¼šåœ¨å®¿ä¸»æœºå»ºç«‹ä¸€å—è™šæ‹Ÿç½‘å¡ docker0 ä½œä¸ºç½‘æ¡¥ï¼Œ å®¿ä¸»æœº é€šè¿‡è¿™ä¸ªç½‘å¡ æ¡¥æ¥åˆ°äº†dockerå†…å±€åŸŸç½‘ã€‚åœ¨dockerå®¹å™¨å†…ï¼Œé€šè¿‡ docker0 çš„ IP åœ°å€å°±èƒ½è®¿é—®å®¿ä¸»æœºçš„æœåŠ¡äº†ã€‚</p><blockquote><p>å®¿ä¸»æ‰§è¡Œ ifconfig, <code>eth0, eth1 ...</code> ä»£è¡¨çœŸå®ç½‘å¡, <code>docker0</code> æ˜¯ docker æ–°å»ºçš„è™šæ‹Ÿç½‘å¡, ä½œä¸ºå®¹å™¨è®¿é—®å®¿ä¸»çš„ç½‘æ¡¥, <code>veth2ddf66cc, vethxxxxx ...</code> å’Œå®¹å™¨å†…çš„ eth0 ç»‘å®š</p></blockquote><p>Dockerå®‰è£…åï¼Œé»˜è®¤ä¼šåˆ›å»ºä¸‹é¢ä¸‰ä¸ª network, é™¤éå¦æœ‰æŒ‡å®šï¼Œå¦åˆ™æ–°å¯åŠ¨çš„å®¹å™¨ä¼šé“¾æ¥ bridge è¿™ä¸ª networkã€‚</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker network ls</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NETWORK ID     NAME        DRIVER       SCOPE</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">9781b1f585ae    bridge       bridge(é»˜è®¤)    local   --&gt; æ¡¥æ¥ç½‘ç»œ, é»˜è®¤, é‡å¯ä¸‹ï¼ŒDockerçš„IPåœ°å€å°±å˜äº†, åŒä¸ªé»˜è®¤æ¡¥æ¥ç½‘ç»œä¸‹çš„ä¸¤ä¸ªå®¹å™¨åªèƒ½é€šè¿‡dockerå†…éƒ¨ ip è®¿é—®, é™¤éåˆ›å»ºå®¹å™¨æ—¶å€™ä½¿ç”¨--linkæŒ‡å®šé“¾æ¥åˆ«å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ç”Ÿäº§ä¸€èˆ¬è‡ªå®šä¹‰ä¸€ä¸ªæ¡¥æ¥ç½‘ç»œ(å› ä¸ºè‡ªå®šä¹‰æ¡¥æ¥ç½‘ç»œä¼˜å…ˆçº§é«˜äºé»˜è®¤æ¡¥æ¥ç½‘ç»œ, ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é»˜è®¤ bridge network</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  é“¾æ¥åˆ°åŒä¸€ä¸ª è‡ªå®šä¹‰æ¡¥æ¥ç½‘ç»œçš„ä¸¤ä¸ªå®¹å™¨äº’ç›¸èƒ½å¤Ÿé€šè¿‡ å®¹å™¨åå­—è®¿é—®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1252da701e55    host        host        local     --&gt; ä¸»æœºç½‘ç»œ, å®¹å™¨çš„ç½‘ç»œä¼šé™„å±åœ¨ä¸»æœºä¸Šï¼Œä¸¤è€…æ˜¯äº’é€šçš„, æ²¡æœ‰éš”ç¦» (åœ¨å®¹å™¨ä¸­è¿è¡Œä¸€ä¸ªWebæœåŠ¡ï¼Œç›‘å¬8080ç«¯å£ï¼Œåˆ™ä¸»æœºçš„8080ç«¯å£å°±ä¼šè‡ªåŠ¨æ˜ å°„åˆ°å®¹å™¨ä¸­)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">237ea3d5cfbf    none        null        local     --&gt; æ— æŒ‡å®šç½‘ç»œ, docker å®¹å™¨å°±ä¸ä¼šåˆ†é…å±€åŸŸç½‘çš„IP</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="124-åˆ›å»ºå›ºå®šip">12.4. åˆ›å»ºå›ºå®šip<a href="#124-åˆ›å»ºå›ºå®šip" class="hash-link" aria-label="12.4. åˆ›å»ºå›ºå®šipçš„ç›´æ¥é“¾æ¥" title="12.4. åˆ›å»ºå›ºå®šipçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>è‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°çš„bridgeç½‘ç»œbridge1ï¼Œåœ¨åˆ›å»ºbridge1çš„æ—¶å€™åŒæ—¶åˆ›å»ºå­ç½‘ï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™æŒ‡å®šç½‘ç»œä¸ºbridge1å¹¶æŒ‡å®šipå³å¯</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºç½‘ç»œ, æŒ‡å®šç½‘æ®µ, é»˜è®¤æ˜¯ bridge ç±»å‹, æ‰€ä»¥å¯çœç•¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># --driver æˆ–è€… -d æŒ‡å®šç½‘ç»œç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network create [--driver bridge] --subnet=172.18.0.0/16 my-network </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -itd --name my-container --network my-network --ip 172.18.0.10 my-image &lt;/bin/bash &gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        * ç”¨ --network å‚æ•°ï¼Œå¯ä»¥æŒ‡å®šç½‘ç»œç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        * --ip 172.17.0.10æŒ‡å®šip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="125-æŸ¥çœ‹containerçš„ip">12.5. æŸ¥çœ‹containerçš„ip<a href="#125-æŸ¥çœ‹containerçš„ip" class="hash-link" aria-label="12.5. æŸ¥çœ‹containerçš„ipçš„ç›´æ¥é“¾æ¥" title="12.5. æŸ¥çœ‹containerçš„ipçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹docker0çš„ç½‘ç»œ(å®¿ä¸»æœºä¸Šæ“ä½œ)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ip addr show docker0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ°å®¹å™¨å†…éƒ¨æŸ¥çœ‹ip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ip addr show eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker inspect &lt;id,container_name&gt; | grep &quot;IPAddress&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="126-å¤–éƒ¨è®¿é—®å®¹å™¨">12.6. å¤–éƒ¨è®¿é—®å®¹å™¨<a href="#126-å¤–éƒ¨è®¿é—®å®¹å™¨" class="hash-link" aria-label="12.6. å¤–éƒ¨è®¿é—®å®¹å™¨çš„ç›´æ¥é“¾æ¥" title="12.6. å¤–éƒ¨è®¿é—®å®¹å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>å¦‚æœæ˜¯ bridge network, å¯ä½¿ç”¨ -p æš´éœ²æ¥å£</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">p </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">host port</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">container port</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> æŒ‡å®šç«¯å£æ˜ å°„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token constant" style="color:rgb(129, 31, 63)">P</span><span class="token plain">    ä½¿ç”¨å®¿ä¸»éšæœºç«¯å£æ˜ å°„åˆ°å®¹å™¨</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> å¯é€šè¿‡ docker ls æŸ¥çœ‹åˆ°åº•å“ªä¸ªç«¯å£</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¦‚æœæ˜¯ host network, åˆ™å®¹å™¨çš„ç«¯å£ä¼šè‡ªåŠ¨æš´éœ²åˆ°å®¿ä¸» (å®¿ä¸»è¿å®¹å™¨)</p><blockquote><p>æˆ–è€…æŸ¥è¯¢å®¿ä¸»æœº docker0 ç½‘å¡çš„åœ°å€ <code>ip addr show docker0</code> ä½œä¸º å®¿ä¸»åœ¨ docker å±€åŸŸç½‘çš„åœ°å€ (ç„¶åå®¹å™¨è¿å®¿ä¸»)</p></blockquote><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ç«¯å£è‡ªåŠ¨æ˜ å°„, éœ€è¦æ‰‹åŠ¨æŸ¥çœ‹ç«¯å£æ˜¯å¤šå°‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -P training/webapp python app.py</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker container ls -l</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CONTAINER ID  IMAGE                   COMMAND       CREATED        STATUS        PORTS                    NAMES</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bc533791f3f5  training/webapp:latest  python app.py 5 seconds ago  Up 2 seconds  0.0.0.0:49155-&gt;5000/tcp  nostalgic_morse</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ˜ å°„æ‰€æœ‰æ¥å£åœ°å€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½¿ç”¨ hostPort:containerPort æ ¼å¼æœ¬åœ°çš„ 5000 ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ 5000 ç«¯å£; æ­¤æ—¶é»˜è®¤ä¼šç»‘å®šæœ¬åœ°æ‰€æœ‰æ¥å£ä¸Šçš„æ‰€æœ‰åœ°å€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -p 5000:5000 training/webapp python app.py</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ˜ å°„åˆ°æŒ‡å®šåœ°å€çš„æŒ‡å®šç«¯å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯ä»¥ä½¿ç”¨ ip:hostPort:containerPort æ ¼å¼æŒ‡å®šæ˜ å°„ä½¿ç”¨ä¸€ä¸ªç‰¹å®šåœ°å€ï¼Œæ¯”å¦‚ localhost åœ°å€ 127.0.0.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -p 127.0.0.1:5000:5000 training/webapp python app.py</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ˜ å°„åˆ°æŒ‡å®šåœ°å€çš„éšæœºç«¯å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½¿ç”¨ ip::containerPort ç»‘å®š localhost çš„ä»»æ„ç«¯å£åˆ°å®¹å™¨çš„ 5000 ç«¯å£ï¼Œæœ¬åœ°ä¸»æœºä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªç«¯å£ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -p 127.0.0.1::5000 training/webapp python app.py</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿˜å¯ä»¥ä½¿ç”¨ udp æ ‡è®°æ¥æŒ‡å®š udp ç«¯å£, é»˜è®¤ä¸ºtcp</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -d -p 127.0.0.1:5000:5000/udp training/webapp python app.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æŸ¥çœ‹å½“å‰æ˜ å°„çš„ç«¯å£é…ç½®ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹åˆ°ç»‘å®šçš„åœ°å€:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker port &lt;container name&gt; [port]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">127.0.0.1:49155</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="127-å®¹å™¨äº’è”">12.7. å®¹å™¨äº’è”<a href="#127-å®¹å™¨äº’è”" class="hash-link" aria-label="12.7. å®¹å™¨äº’è”çš„ç›´æ¥é“¾æ¥" title="12.7. å®¹å™¨äº’è”çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ä¸€ä¸ªæ˜¯é€šè¿‡ docker network</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºä¸€ä¸ªå«åš my-bridge çš„ç½‘æ¡¥:     </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network create -d bridge my-bridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ˜¾ç¤ºæ‰€æœ‰ bridge   : </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network ls</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºå®¹å™¨mynginx2å¹¶æ·»åŠ åˆ° my-bridge ç½‘ç»œä¸­: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run --name mynginx2 --network my-bridge -p 8080:80 -d nginx:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½¿ç”¨ inspect æŸ¥çœ‹:    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker inspect mynginx2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹ my-bridge ç½‘ç»œé‡Œé¢çš„å®¹å™¨: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker inspect my-bridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰‹åŠ¨å°†æŸä¸ªè¿è¡Œç€çš„å®¹å™¨åŠ å…¥ç½‘æ¡¥:  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network connect my-bridage test2s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">############  å®ä¾‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># BusyBox </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ˜¯ä¸€ä¸ªé›†æˆäº†ä¸‰ç™¾å¤šä¸ªæœ€å¸¸ç”¨Linuxå‘½ä»¤å’Œå·¥å…·çš„è½¯ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºdockerç½‘ç»œ, å¯åŠ¨ä¸¤ä¸ªå®¹å™¨, åŠ å…¥ç½‘ç»œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker network create -d bridge my-net</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -it --rm --name busybox1 --network my-net busybox sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># éœ€è¦æ‰“å¼€æ–°çš„terminal</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -it --rm --name busybox2 --network my-net busybox sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æœ€ååœ¨å„è‡ªçš„terminalä¸­pingæµ‹è¯•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ping busybox2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ping busybox1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># MySQL</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network create -d bridge some-network</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name some-mysql --network some-network -e MYSQL_ROOT_PASSWORD=my-secret-pw mysql:tag</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯åŠ¨ä¸€ä¸ªä¸´æ—¶çš„ MySQL client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it --rm --network some-network mysql mysql -hsome-mysql -uexample-user -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä¸€ä¸ªæ˜¯é€šè¿‡ <code>--link</code> (ä¸æ¨è), docker run --linkå¯ä»¥ç”¨æ¥é“¾æ¥2ä¸ªå®¹å™¨ï¼Œä½¿å¾—æºå®¹å™¨ï¼ˆè¢«é“¾æ¥çš„å®¹å™¨ï¼‰å’Œæ¥æ”¶å®¹å™¨ï¼ˆä¸»åŠ¨å»é“¾æ¥çš„å®¹å™¨ï¼‰ä¹‹é—´å¯ä»¥äº’ç›¸é€šä¿¡ï¼Œå¹¶ä¸”æ¥æ”¶å®¹å™¨å¯ä»¥è·å–æºå®¹å™¨çš„ä¸€äº›æ•°æ®ï¼Œå¦‚æºå®¹å™¨çš„ç¯å¢ƒå˜é‡ã€‚</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#--link &lt;container_name&gt;:&lt;link_name&gt; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name node --link selenium_hub:hub selenium/node-chrome-debug</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec -it node /bin/bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ping hub # å¯ä»¥ ping é€š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ›´æ–¹ä¾¿çš„å®¹å™¨äº’è”ä½¿ç”¨<a href="#docker-compose"> Docker Compose</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="128-é…ç½®dns-å’Œ-ä¸»æœºå-hostname">12.8. é…ç½®dns å’Œ ä¸»æœºå hostname<a href="#128-é…ç½®dns-å’Œ-ä¸»æœºå-hostname" class="hash-link" aria-label="12.8. é…ç½®dns å’Œ ä¸»æœºå hostnameçš„ç›´æ¥é“¾æ¥" title="12.8. é…ç½®dns å’Œ ä¸»æœºå hostnameçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Docker åˆ©ç”¨è™šæ‹Ÿæ–‡ä»¶æ¥æŒ‚è½½å®¹å™¨çš„ 3 ä¸ªç›¸å…³é…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨å®¹å™¨ä¸­ä½¿ç”¨ mount å‘½ä»¤å¯ä»¥çœ‹åˆ°æŒ‚è½½ä¿¡æ¯:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ mount</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/disk/by-uuid/1fec...ebdf on /etc/hostname type ext4 ...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/disk/by-uuid/1fec...ebdf on /etc/hosts type ext4 ...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs on /etc/resolv.conf type tmpfs ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™ç§æœºåˆ¶å¯ä»¥è®©å®¿ä¸»ä¸»æœº DNS ä¿¡æ¯å‘ç”Ÿæ›´æ–°åï¼Œæ‰€æœ‰ Docker å®¹å™¨çš„ DNS é…ç½®é€šè¿‡ <code>/etc/resolv.conf</code> æ–‡ä»¶ç«‹åˆ»å¾—åˆ°æ›´æ–°</p><p>é…ç½®å…¨éƒ¨å®¹å™¨çš„ DNS ï¼Œä¹Ÿå¯ä»¥åœ¨<code> /etc/docker/daemon.json</code> æ–‡ä»¶ä¸­å¢åŠ ä»¥ä¸‹å†…å®¹æ¥è®¾ç½®:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token property">&quot;dns&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;114.114.114.114&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;8.8.8.8&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™æ ·æ¯æ¬¡å¯åŠ¨çš„å®¹å™¨ DNS è‡ªåŠ¨é…ç½®ä¸º 114.114.114.114 å’Œ 8.8.8.8ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è¯æ˜å…¶å·²ç»ç”Ÿæ•ˆ:<code>docker run -it --rm ubuntu:17.10  cat etc/resolv.conf</code></p><p>å¦‚æœç”¨æˆ·æƒ³è¦æ‰‹åŠ¨æŒ‡å®šå®¹å™¨çš„é…ç½®ï¼Œå¯ä»¥åœ¨ä½¿ç”¨ docker run å‘½ä»¤å¯åŠ¨å®¹å™¨æ—¶åŠ å…¥å¦‚ä¸‹å‚æ•°ï¼š</p><ul><li><p><code>-h HOSTNAME</code> æˆ–è€…<code> --hostname=HOSTNAME</code> è®¾å®šå®¹å™¨çš„ä¸»æœºåï¼Œå®ƒä¼šè¢«å†™åˆ°å®¹å™¨å†…çš„ /etc/hostname å’Œ /etc/hostsã€‚ä½†å®ƒåœ¨å®¹å™¨å¤–éƒ¨çœ‹ä¸åˆ°ï¼Œæ—¢ä¸ä¼šåœ¨ docker container ls ä¸­æ˜¾ç¤ºï¼Œä¹Ÿä¸ä¼šåœ¨å…¶ä»–çš„å®¹å™¨çš„ /etc/hosts çœ‹åˆ°ã€‚</p></li><li><p><code>--dns=IP_ADDRESS</code> æ·»åŠ  DNS æœåŠ¡å™¨åˆ°å®¹å™¨çš„ /etc/resolv.conf ä¸­ï¼Œè®©å®¹å™¨ç”¨è¿™ä¸ªæœåŠ¡å™¨æ¥è§£ææ‰€æœ‰ä¸åœ¨ /etc/hosts ä¸­çš„ä¸»æœºåã€‚</p></li><li><p><code>--dns-search=DOMAIN</code> è®¾å®šå®¹å™¨çš„æœç´¢åŸŸï¼Œå½“è®¾å®šæœç´¢åŸŸä¸º .example.com æ—¶ï¼Œåœ¨æœç´¢ä¸€ä¸ªåä¸º host çš„ä¸»æœºæ—¶ï¼ŒDNS ä¸ä»…æœç´¢ hostï¼Œè¿˜ä¼šæœç´¢ host.example.comã€‚</p></li></ul><h1>13. docker-compose</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="131-some-significant-materials">13.1. some significant materials<a href="#131-some-significant-materials" class="hash-link" aria-label="13.1. some significant materialsçš„ç›´æ¥é“¾æ¥" title="13.1. some significant materialsçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://www.composerize.com/" target="_blank" rel="noopener noreferrer">https://www.composerize.com/</a> convert docker command into docker-compose file</p><p><a href="https://github.com/docker/awesome-compose" target="_blank" rel="noopener noreferrer">https://github.com/docker/awesome-compose</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="132-composeç®€ä»‹">13.2. composeç®€ä»‹<a href="#132-composeç®€ä»‹" class="hash-link" aria-label="13.2. composeç®€ä»‹çš„ç›´æ¥é“¾æ¥" title="13.2. composeç®€ä»‹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>é€šä¿—çš„ç†è§£: å¯ä»¥åŒæ—¶å®šä¹‰å’Œè¿è¡Œå¤šä¸ª Docker å®¹å™¨. ç”¨æˆ·é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ docker-compose.yml æ¨¡æ¿æ–‡ä»¶ï¼ˆYAML æ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ä¸ºä¸€ä¸ªé¡¹ç›®ï¼ˆprojectï¼‰</p><blockquote><p>Docker Compose æ˜¯ Docker å®˜æ–¹ç¼–æ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£å¿«é€Ÿçš„éƒ¨ç½²åˆ†å¸ƒå¼åº”ç”¨</p><p>Compose é¡¹ç›®ç”± Python ç¼–å†™ï¼Œè°ƒç”¨äº† Docker æœåŠ¡æä¾›çš„ API æ¥å¯¹å®¹å™¨è¿›è¡Œç®¡ç†</p></blockquote><p>Compose ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š</p><ul><li><p>æœåŠ¡ (service)ï¼šä¸€ä¸ªåº”ç”¨çš„å®¹å™¨ï¼Œå®é™…ä¸Šå¯ä»¥åŒ…æ‹¬è‹¥å¹²è¿è¡Œç›¸åŒé•œåƒçš„å®¹å™¨å®ä¾‹ã€‚</p><p>Compose çš„é»˜è®¤ç®¡ç†å¯¹è±¡æ˜¯é¡¹ç›®ï¼Œé€šè¿‡å­å‘½ä»¤å¯¹é¡¹ç›®ä¸­çš„ä¸€ç»„å®¹å™¨è¿›è¡Œä¾¿æ·åœ°ç”Ÿå‘½å‘¨æœŸç®¡ç†</p></li><li><p>é¡¹ç›® (project)ï¼šç”±ä¸€ç»„å…³è”çš„åº”ç”¨å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡å•å…ƒï¼Œåœ¨ docker-compose.yml æ–‡ä»¶ä¸­å®šä¹‰ã€‚</p></li></ul><p>å®‰è£…å¸è½½</p><p><a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/install/</a></p><ol><li>é€šè¿‡ Python çš„åŒ…ç®¡ç†å·¥å…· pip è¿›è¡Œå®‰è£…ï¼Œ</li><li>ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½¿ç”¨ </li><li>èƒ½å¤Ÿç›´æ¥åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ</li></ol><blockquote><p>å‰ä¸¤ç§æ–¹å¼æ˜¯ä¼ ç»Ÿæ–¹å¼ï¼Œé€‚åˆæœ¬åœ°ç¯å¢ƒä¸‹å®‰è£…ä½¿ç”¨ï¼›æœ€åä¸€ç§æ–¹å¼åˆ™ä¸ç ´åç³»ç»Ÿç¯å¢ƒï¼Œæ›´é€‚åˆäº‘è®¡ç®—åœºæ™¯; </p></blockquote><p>Docker for Windows è‡ªå¸¦ docker-compose äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®‰è£… Docker ä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ç›´æ¥ä¸‹è½½å¯¹åº”çš„äºŒè¿›åˆ¶åŒ…(æ¨è)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ sudo curl -L https://github.com/docker/compose/releases/download/1.17.1/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ sudo chmod +x /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿˜å¯ä»¥ä½¿ç”¨pipå®‰è£…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ sudo pip install -U docker-compose</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å‘½ä»¤è¡¥å…¨åŠŸèƒ½éœ€è¦ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ curl -L https://raw.githubusercontent.com/docker/compose/1.8.0/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚ä½•åœ¨linuxä¸­æ‰§è¡Œ? ä¸‹è½½çš„run.shå®é™…æ˜¯ä¸‹è½½docker/compose é•œåƒå¹¶è¿è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ curl -L https://github.com/docker/compose/releases/download/1.8.0/run.sh &gt; /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ chmod +x /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ, ç¬¬ä¸€æ¬¡ä¼šä¸‹è½½composeé•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker-compose version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¸è½½:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœæ˜¯äºŒè¿›åˆ¶åŒ…æ–¹å¼å®‰è£…çš„ï¼Œåˆ é™¤äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ sudo rm /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœæ˜¯é€šè¿‡ pip å®‰è£…çš„ï¼Œåˆ™æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯åˆ é™¤ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ sudo pip uninstall docker-compose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>çœ‹ä¸€ä¸ª quick-start:</p><p>eg: ç”¨Python æ¥å»ºç«‹ä¸€ä¸ªèƒ½å¤Ÿè®°å½•é¡µé¢è®¿é—®æ¬¡æ•°çš„ web ç½‘ç«™</p><p>åœ¨æ–‡ä»¶å¤¹project/ä¸‹æ–°å»ºapp.py</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> flask </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> Flask</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> redis </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> Redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">app </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Flask</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">redis </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">host</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;redis&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> port</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">6379</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(4, 81, 165)">@app</span><span class="token decorator annotation punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token decorator annotation punctuation" style="color:rgb(4, 81, 165)">route</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">hello</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    count </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">incr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hits&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® {} æ¬¡ã€‚\n&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token builtin" style="color:rgb(0, 112, 193)">format</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;__main__&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    app</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">host</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;0.0.0.0&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> debug</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ–°å»º Dockerfile </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">FROM python:3.6-alpine</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ADD . /code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WORKDIR /code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RUN pip install redis flask</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMD [&quot;python&quot;, &quot;app.py&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ–°å»º docker-compose.yml</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># è¿™é‡Œçš„ç‰ˆæœ¬å’Œdocker-composeæœ‰å…³, å¦‚æœæŠ¥é”™, åˆ™æ”¹ä¸º&#x27;2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">web</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> . </span><span class="token comment" style="color:rgb(0, 128, 0)"># åœ¨å½“å‰ç›®å½•å¯»æ‰¾ dockerfileæ„å»º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;5000:5000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;redis:alpine&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿è¡Œ: <code>docker-compose up</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="133-å‘½ä»¤ä½¿ç”¨">13.3. å‘½ä»¤ä½¿ç”¨<a href="#133-å‘½ä»¤ä½¿ç”¨" class="hash-link" aria-label="13.3. å‘½ä»¤ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="13.3. å‘½ä»¤ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>é»˜è®¤çš„å‘½ä»¤å¯¹è±¡æ˜¯é¡¹ç›®ï¼Œè¿™æ„å‘³ç€é¡¹ç›®ä¸­æ‰€æœ‰çš„æœåŠ¡éƒ½ä¼šå—åˆ°å‘½ä»¤å½±å“</p><p>æ ¼å¼: <code>docker-compose [-f=&lt;arg&gt;...] [options] [COMMAND] [ARGS...]</code></p><p>optionsæœ‰è¿™äº›:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">file </span><span class="token constant" style="color:rgb(129, 31, 63)">FILE</span><span class="token plain"> æŒ‡å®šä½¿ç”¨çš„ </span><span class="token maybe-class-name">Compose</span><span class="token plain"> æ¨¡æ¿æ–‡ä»¶ï¼Œé»˜è®¤ä¸º docker</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">compose</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">ymlï¼Œå¯ä»¥å¤šæ¬¡æŒ‡å®šã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">project</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">name </span><span class="token constant" style="color:rgb(129, 31, 63)">NAME</span><span class="token plain"> æŒ‡å®šé¡¹ç›®åç§°ï¼Œé»˜è®¤å°†ä½¿ç”¨æ‰€åœ¨ç›®å½•åç§°ä½œä¸ºé¡¹ç›®åã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">x</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">networking ä½¿ç”¨ </span><span class="token maybe-class-name">Docker</span><span class="token plain"> çš„å¯æ‹”æ’ç½‘ç»œåç«¯ç‰¹æ€§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">x</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">network</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">driver </span><span class="token constant" style="color:rgb(129, 31, 63)">DRIVER</span><span class="token plain"> æŒ‡å®šç½‘ç»œåç«¯çš„é©±åŠ¨ï¼Œé»˜è®¤ä¸º bridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">verbose è¾“å‡ºæ›´å¤šè°ƒè¯•ä¿¡æ¯ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">version æ‰“å°ç‰ˆæœ¬å¹¶é€€å‡º</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1331-up">13.3.1. up<a href="#1331-up" class="hash-link" aria-label="13.3.1. upçš„ç›´æ¥é“¾æ¥" title="13.3.1. upçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><p>æ ¼å¼ä¸º docker-compose up <!-- -->[options][SERVICE...]</p></li><li><p>è¯¥å‘½ä»¤ååˆ†å¼ºå¤§ï¼Œå®ƒå°†å°è¯•è‡ªåŠ¨å®ŒæˆåŒ…æ‹¬ æ„å»º, å¯åŠ¨...</p></li><li><p>é»˜è®¤æƒ…å†µï¼Œ<code>docker-compose up</code> å¯åŠ¨çš„å®¹å™¨éƒ½åœ¨å‰å°ï¼Œæ§åˆ¶å°å°†ä¼šåŒæ—¶æ‰“å°æ‰€æœ‰å®¹å™¨çš„è¾“å‡ºä¿¡æ¯ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚</p><p>  å½“é€šè¿‡ Ctrl-C åœæ­¢å‘½ä»¤æ—¶ï¼Œæ‰€æœ‰å®¹å™¨å°†ä¼šåœæ­¢</p><p>  å¦‚æœä½¿ç”¨ <code>docker-compose up -d</code>ï¼Œå°†ä¼šåœ¨åå°å¯åŠ¨å¹¶è¿è¡Œæ‰€æœ‰çš„å®¹å™¨ã€‚ä¸€èˆ¬æ¨èç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨è¯¥é€‰é¡¹ (-d å¿…é¡»æ¥åœ¨ up ä¹‹åä¸èƒ½åœ¨ä¹‹å‰)</p></li><li><p><code>docker-compose up --no-recreate</code>åªä¼šå¯åŠ¨å¤„äºåœæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œè€Œå¿½ç•¥å·²ç»è¿è¡Œçš„æœåŠ¡</p><p>  é»˜è®¤æƒ…å†µï¼Œå¦‚æœæœåŠ¡å®¹å™¨å·²ç»å­˜åœ¨ï¼Œdocker-compose up å°†ä¼šå°è¯•åœæ­¢å®¹å™¨ï¼Œç„¶åé‡æ–°åˆ›å»º</p></li><li><p><code>docker-compose up --no-deps -d &lt;SERVICE_NAME&gt;</code> åªæƒ³é‡æ–°éƒ¨ç½²æŸä¸ªæœåŠ¡, é€šè¿‡è¿™ä¸ªå‘½ä»¤æ¥é‡æ–°åˆ›å»ºæœåŠ¡å¹¶åå°åœæ­¢æ—§æœåŠ¡ï¼Œå¯åŠ¨æ–°æœåŠ¡ï¼Œå¹¶ä¸ä¼šå½±å“åˆ°å…¶æ‰€ä¾èµ–çš„æœåŠ¡</p></li></ul><p>æ‰€æœ‰å¯ç”¨çš„é€‰é¡¹:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">-d åœ¨åå°è¿è¡ŒæœåŠ¡å®¹å™¨ã€‚(å¿…é¡»åœ¨ docker-compose [flags] &lt;command&gt; ä¸­çš„ command ä¹‹å, ä¸èƒ½åœ¨ä¹‹å‰)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-f æŒ‡å®š yml æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  docker-compose -f xxx.yml up [-d]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-p, --project-name ï¼šæŒ‡å®šå·¥ç¨‹åç§°ï¼Œé»˜è®¤ä½¿ç”¨ docker-compose.yml æ–‡ä»¶æ‰€åœ¨ç›®å½•çš„åç§°ï¼›</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--no-color ä¸ä½¿ç”¨é¢œè‰²æ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡çš„æ§åˆ¶å°è¾“å‡ºã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--no-deps ä¸å¯åŠ¨æœåŠ¡æ‰€é“¾æ¥çš„å®¹å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--force-recreate å¼ºåˆ¶é‡æ–°åˆ›å»ºå®¹å™¨ï¼Œä¸èƒ½ä¸ --no-recreate åŒæ—¶ä½¿ç”¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--no-recreate å¦‚æœå®¹å™¨å·²ç»å­˜åœ¨äº†ï¼Œåˆ™ä¸é‡æ–°åˆ›å»ºï¼Œä¸èƒ½ä¸ --force-recreate åŒæ—¶ä½¿ç”¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--no-build ä¸è‡ªåŠ¨æ„å»ºç¼ºå¤±çš„æœåŠ¡é•œåƒã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-t, --timeout TIMEOUT åœæ­¢å®¹å™¨æ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1332-run">13.3.2. run<a href="#1332-run" class="hash-link" aria-label="13.3.2. runçš„ç›´æ¥é“¾æ¥" title="13.3.2. runçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º <code>docker-compose run [options] [-p PORT...] [-e KEY=VAL...] SERVICE [COMMAND] [ARGS...]</code>ã€‚</p><p>åœ¨æŒ‡å®šæœåŠ¡ä¸Šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ã€‚</p><p>eg:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å°†ä¼šå¯åŠ¨ä¸€ä¸ª ubuntu æœåŠ¡å®¹å™¨ï¼Œå¹¶æ‰§è¡Œ ping docker.com å‘½ä»¤</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker-compose run ubuntu ping docker.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå­˜åœ¨å…³è”ï¼Œåˆ™æ‰€æœ‰å…³è”çš„æœåŠ¡å°†ä¼šè‡ªåŠ¨è¢«å¯åŠ¨ï¼Œé™¤éè¿™äº›æœåŠ¡å·²ç»åœ¨è¿è¡Œä¸­</p><p>å¦‚æœä¸å¸Œæœ›è‡ªåŠ¨å¯åŠ¨å…³è”çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ --no-deps é€‰é¡¹</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ä¸ä¼šå¯åŠ¨ web å®¹å™¨æ‰€å…³è”çš„å…¶å®ƒå®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker-compose run --no-deps web python manage.py shell</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¯¥å‘½ä»¤ç±»ä¼¼å¯åŠ¨å®¹å™¨åè¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œç›¸å…³å·ã€é“¾æ¥ç­‰ç­‰éƒ½å°†ä¼šæŒ‰ç…§é…ç½®è‡ªåŠ¨åˆ›å»º, ä½†æ˜¯æœ‰ä¸¤ä¸ªä¸åŒç‚¹</p><ol><li>ç»™å®šå‘½ä»¤å°†ä¼šè¦†ç›–åŸæœ‰çš„è‡ªåŠ¨è¿è¡Œå‘½ä»¤</li><li>ä¸ä¼šè‡ªåŠ¨åˆ›å»ºç«¯å£ï¼Œä»¥é¿å…å†²çª</li></ol><p>æ‰€æœ‰å¯é€‰çš„é€‰é¡¹:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">d åå°è¿è¡Œå®¹å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">name </span><span class="token constant" style="color:rgb(129, 31, 63)">NAME</span><span class="token plain"> ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåå­—ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">entrypoint </span><span class="token constant" style="color:rgb(129, 31, 63)">CMD</span><span class="token plain"> è¦†ç›–é»˜è®¤çš„å®¹å™¨å¯åŠ¨æŒ‡ä»¤ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">e </span><span class="token constant" style="color:rgb(129, 31, 63)">KEY</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token constant" style="color:rgb(129, 31, 63)">VAL</span><span class="token plain"> è®¾ç½®ç¯å¢ƒå˜é‡å€¼ï¼Œå¯å¤šæ¬¡ä½¿ç”¨é€‰é¡¹æ¥è®¾ç½®å¤šä¸ªç¯å¢ƒå˜é‡ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">u</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">user</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&quot;</span><span class="token plain"> æŒ‡å®šè¿è¡Œå®¹å™¨çš„ç”¨æˆ·åæˆ–è€… uidã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">no</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">deps ä¸è‡ªåŠ¨å¯åŠ¨å…³è”çš„æœåŠ¡å®¹å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">rm è¿è¡Œå‘½ä»¤åè‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼Œd æ¨¡å¼ä¸‹å°†å¿½ç•¥ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">publish</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> æ˜ å°„å®¹å™¨ç«¯å£åˆ°æœ¬åœ°ä¸»æœºã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">service</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ports é…ç½®æœåŠ¡ç«¯å£å¹¶æ˜ å°„åˆ°æœ¬åœ°ä¸»æœºã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain"> ä¸åˆ†é…ä¼ª ttyï¼Œæ„å‘³ç€ä¾èµ– tty çš„æŒ‡ä»¤å°†æ— æ³•è¿è¡Œã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1333-scale">13.3.3. scale<a href="#1333-scale" class="hash-link" aria-label="13.3.3. scaleçš„ç›´æ¥é“¾æ¥" title="13.3.3. scaleçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><p>æ ¼å¼ä¸º docker-compose scale <!-- -->[options][SERVICE=NUM...]<!-- -->ã€‚</p></li><li><p>è®¾ç½®æŒ‡å®šæœåŠ¡è¿è¡Œçš„å®¹å™¨ä¸ªæ•°ã€‚</p></li><li><p>é€šè¿‡ service=num çš„å‚æ•°æ¥è®¾ç½®æ•°é‡ã€‚ä¾‹å¦‚</p><ul><li><p>eg</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å°†å¯åŠ¨ 3 ä¸ªå®¹å™¨è¿è¡Œ web æœåŠ¡ï¼Œ2 ä¸ªå®¹å™¨è¿è¡Œ db æœåŠ¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker-compose scale web=3 db=2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>å½“æŒ‡å®šæ•°ç›®å¤šäºè¯¥æœåŠ¡å½“å‰å®é™…è¿è¡Œå®¹å™¨ï¼Œå°†æ–°åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼›åä¹‹ï¼Œå°†åœæ­¢å®¹å™¨</p></li></ul><p>å¯ç”¨é€‰é¡¹:</p><p>-t, --timeout TIMEOUT åœæ­¢å®¹å™¨æ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1334-start">13.3.4. start<a href="#1334-start" class="hash-link" aria-label="13.3.4. startçš„ç›´æ¥é“¾æ¥" title="13.3.4. startçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose start <!-- -->[SERVICE...]<!-- -->ã€‚</p><p>å¯åŠ¨å·²ç»å­˜åœ¨çš„æœåŠ¡å®¹å™¨</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1335-build">13.3.5. build<a href="#1335-build" class="hash-link" aria-label="13.3.5. buildçš„ç›´æ¥é“¾æ¥" title="13.3.5. buildçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><p>æ ¼å¼ä¸º docker-compose build <!-- -->[options][SERVICE...]</p></li><li><p>æ„å»ºï¼ˆé‡æ–°æ„å»ºï¼‰é¡¹ç›®ä¸­çš„æœåŠ¡å®¹å™¨</p></li><li><p>æœåŠ¡å®¹å™¨ä¸€æ—¦æ„å»ºåï¼Œå°†ä¼šå¸¦ä¸Šä¸€ä¸ªæ ‡è®°åï¼Œä¾‹å¦‚å¯¹äº web é¡¹ç›®ä¸­çš„ä¸€ä¸ª db å®¹å™¨ï¼Œå¯èƒ½æ˜¯ web_db</p></li><li><p>å¯ä»¥éšæ—¶åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ docker-compose build æ¥é‡æ–°æ„å»ºæœåŠ¡</p></li></ul><p>æ‰€æœ‰é€‰é¡¹:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">force</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">rm åˆ é™¤æ„å»ºè¿‡ç¨‹ä¸­çš„ä¸´æ—¶å®¹å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">no</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">cache æ„å»ºé•œåƒè¿‡ç¨‹ä¸­ä¸ä½¿ç”¨ cacheï¼ˆè¿™å°†åŠ é•¿æ„å»ºè¿‡ç¨‹ï¼‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">pull å§‹ç»ˆå°è¯•é€šè¿‡ pull æ¥è·å–æ›´æ–°ç‰ˆæœ¬çš„é•œåƒã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1336-config">13.3.6. config<a href="#1336-config" class="hash-link" aria-label="13.3.6. configçš„ç›´æ¥é“¾æ¥" title="13.3.6. configçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>éªŒè¯ Compose æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œè‹¥æ­£ç¡®åˆ™æ˜¾ç¤ºé…ç½®ï¼Œè‹¥æ ¼å¼é”™è¯¯æ˜¾ç¤ºé”™è¯¯åŸå› </p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1337-exec">13.3.7. exec<a href="#1337-exec" class="hash-link" aria-label="13.3.7. execçš„ç›´æ¥é“¾æ¥" title="13.3.7. execçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>è¿›å…¥æŒ‡å®šçš„å®¹å™¨</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1338-images">13.3.8. images<a href="#1338-images" class="hash-link" aria-label="13.3.8. imagesçš„ç›´æ¥é“¾æ¥" title="13.3.8. imagesçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>åˆ—å‡º Compose æ–‡ä»¶ä¸­åŒ…å«çš„é•œåƒã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1339-kill">13.3.9. kill<a href="#1339-kill" class="hash-link" aria-label="13.3.9. killçš„ç›´æ¥é“¾æ¥" title="13.3.9. killçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose kill <!-- -->[options][SERVICE...]</p><p>é€šè¿‡å‘é€ SIGKILL ä¿¡å·æ¥å¼ºåˆ¶åœæ­¢æœåŠ¡å®¹å™¨ã€‚</p><p>æ”¯æŒé€šè¿‡ -s å‚æ•°æ¥æŒ‡å®šå‘é€çš„ä¿¡å·ï¼Œä¾‹å¦‚é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤å‘é€ SIGINT ä¿¡å·ã€‚</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker-compose kill -s SIGINT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13310-down">13.3.10. down<a href="#13310-down" class="hash-link" aria-label="13.3.10. downçš„ç›´æ¥é“¾æ¥" title="13.3.10. downçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ­¤å‘½ä»¤å°†ä¼šåœæ­¢ up å‘½ä»¤æ‰€å¯åŠ¨çš„å®¹å™¨ï¼Œå¹¶ç§»é™¤ç½‘ç»œ</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13311-pause">13.3.11. pause<a href="#13311-pause" class="hash-link" aria-label="13.3.11. pauseçš„ç›´æ¥é“¾æ¥" title="13.3.11. pauseçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose pause <!-- -->[SERVICE...]<!-- -->ã€‚</p><p>æš‚åœä¸€ä¸ªæœåŠ¡å®¹å™¨ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13312-unpause">13.3.12. unpause<a href="#13312-unpause" class="hash-link" aria-label="13.3.12. unpauseçš„ç›´æ¥é“¾æ¥" title="13.3.12. unpauseçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose unpause <!-- -->[SERVICE...]<!-- -->ã€‚</p><p>æ¢å¤å¤„äºæš‚åœçŠ¶æ€ä¸­çš„æœåŠ¡ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13313-restart">13.3.13. restart<a href="#13313-restart" class="hash-link" aria-label="13.3.13. restartçš„ç›´æ¥é“¾æ¥" title="13.3.13. restartçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose restart <!-- -->[options][SERVICE...]<!-- -->ã€‚</p><p>é‡å¯é¡¹ç›®ä¸­çš„æœåŠ¡ã€‚</p><p>é€‰é¡¹ï¼š</p><p>-t, --timeout TIMEOUT æŒ‡å®šé‡å¯å‰åœæ­¢å®¹å™¨çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13314-stop">13.3.14. stop<a href="#13314-stop" class="hash-link" aria-label="13.3.14. stopçš„ç›´æ¥é“¾æ¥" title="13.3.14. stopçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose stop <!-- -->[options][SERVICE...]<!-- -->ã€‚</p><p>åœæ­¢å·²ç»å¤„äºè¿è¡ŒçŠ¶æ€çš„å®¹å™¨ï¼Œä½†ä¸åˆ é™¤å®ƒã€‚é€šè¿‡ docker-compose start å¯ä»¥å†æ¬¡å¯åŠ¨è¿™äº›å®¹å™¨ã€‚</p><p>é€‰é¡¹ï¼š</p><p>-t, --timeout TIMEOUT åœæ­¢å®¹å™¨æ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13315-rm">13.3.15. rm<a href="#13315-rm" class="hash-link" aria-label="13.3.15. rmçš„ç›´æ¥é“¾æ¥" title="13.3.15. rmçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose rm <!-- -->[options][SERVICE...]<!-- -->ã€‚</p><p>åˆ é™¤æ‰€æœ‰ï¼ˆåœæ­¢çŠ¶æ€çš„ï¼‰æœåŠ¡å®¹å™¨ã€‚æ¨èå…ˆæ‰§è¡Œ docker-compose stop å‘½ä»¤æ¥åœæ­¢å®¹å™¨ã€‚</p><p>é€‰é¡¹ï¼š</p><p>-f, --force å¼ºåˆ¶ç›´æ¥åˆ é™¤ï¼ŒåŒ…æ‹¬éåœæ­¢çŠ¶æ€çš„å®¹å™¨ã€‚ä¸€èˆ¬å°½é‡ä¸è¦ä½¿ç”¨è¯¥é€‰é¡¹ã€‚</p><p>-v åˆ é™¤å®¹å™¨æ‰€æŒ‚è½½çš„æ•°æ®å·ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13316-logs">13.3.16. logs<a href="#13316-logs" class="hash-link" aria-label="13.3.16. logsçš„ç›´æ¥é“¾æ¥" title="13.3.16. logsçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose logs <!-- -->[options][SERVICE...]<!-- -->ã€‚</p><p>æŸ¥çœ‹æœåŠ¡å®¹å™¨çš„è¾“å‡ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker-compose å°†å¯¹ä¸åŒçš„æœåŠ¡è¾“å‡ºä½¿ç”¨ä¸åŒçš„é¢œè‰²æ¥åŒºåˆ†ã€‚å¯ä»¥é€šè¿‡ --no-color æ¥å…³é—­é¢œè‰²ã€‚</p><p>è¯¥å‘½ä»¤åœ¨è°ƒè¯•é—®é¢˜çš„æ—¶å€™ååˆ†æœ‰ç”¨ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13317-top">13.3.17. top<a href="#13317-top" class="hash-link" aria-label="13.3.17. topçš„ç›´æ¥é“¾æ¥" title="13.3.17. topçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æŸ¥çœ‹å„ä¸ªæœåŠ¡å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13318-version">13.3.18. version<a href="#13318-version" class="hash-link" aria-label="13.3.18. versionçš„ç›´æ¥é“¾æ¥" title="13.3.18. versionçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose versionã€‚</p><p>æ‰“å°ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13319-port">13.3.19. port<a href="#13319-port" class="hash-link" aria-label="13.3.19. portçš„ç›´æ¥é“¾æ¥" title="13.3.19. portçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose port <!-- -->[options]<!-- --> SERVICE PRIVATE_PORTã€‚</p><p>æ‰“å°æŸä¸ªå®¹å™¨ç«¯å£æ‰€æ˜ å°„çš„å…¬å…±ç«¯å£ã€‚</p><p>é€‰é¡¹ï¼š</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">protocol</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">proto æŒ‡å®šç«¯å£åè®®ï¼Œtcpï¼ˆé»˜è®¤å€¼ï¼‰æˆ–è€… udpã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">index</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">index å¦‚æœåŒä¸€æœåŠ¡å­˜åœ¨å¤šä¸ªå®¹å™¨ï¼ŒæŒ‡å®šå‘½ä»¤å¯¹è±¡å®¹å™¨çš„åºå·ï¼ˆé»˜è®¤ä¸º </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">ï¼‰ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13320-ps">13.3.20. ps<a href="#13320-ps" class="hash-link" aria-label="13.3.20. psçš„ç›´æ¥é“¾æ¥" title="13.3.20. psçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose ps <!-- -->[options][SERVICE...]<!-- -->ã€‚</p><p>åˆ—å‡ºé¡¹ç›®ä¸­ç›®å‰çš„æ‰€æœ‰å®¹å™¨ã€‚</p><p>é€‰é¡¹ï¼š</p><p>-q åªæ‰“å°å®¹å™¨çš„ ID ä¿¡æ¯ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13321-pull">13.3.21. pull<a href="#13321-pull" class="hash-link" aria-label="13.3.21. pullçš„ç›´æ¥é“¾æ¥" title="13.3.21. pullçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ ¼å¼ä¸º docker-compose pull <!-- -->[options][SERVICE...]<!-- -->ã€‚</p><p>æ‹‰å–æœåŠ¡ä¾èµ–çš„é•œåƒã€‚</p><p>é€‰é¡¹ï¼š</p><p>--ignore-pull-failures å¿½ç•¥æ‹‰å–é•œåƒè¿‡ç¨‹ä¸­çš„é”™è¯¯ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13322-push">13.3.22. push<a href="#13322-push" class="hash-link" aria-label="13.3.22. pushçš„ç›´æ¥é“¾æ¥" title="13.3.22. pushçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ¨é€æœåŠ¡ä¾èµ–çš„é•œåƒåˆ° Docker é•œåƒä»“åº“ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="134-docker-composeyml">13.4. docker-compose.yml<a href="#134-docker-composeyml" class="hash-link" aria-label="13.4. docker-compose.ymlçš„ç›´æ¥é“¾æ¥" title="13.4. docker-compose.ymlçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://docs.docker.com/compose/compose-file/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/compose-file/</a> </p><p>é»˜è®¤çš„æ¨¡æ¿æ–‡ä»¶åç§°ä¸º docker-compose.yml</p><p>æ¨¡ç‰ˆä¸­çš„å‘½ä»¤åŸºæœ¬è·Ÿ docker run ä¸­å¯¹åº”å‚æ•°çš„åŠŸèƒ½ä¸€è‡´ã€‚</p><p>å¦‚æœå˜é‡åç§°æˆ–è€…å€¼ä¸­ç”¨åˆ° true|falseï¼Œyes|no ç­‰è¡¨è¾¾ å¸ƒå°” å«ä¹‰çš„è¯æ±‡ï¼Œæœ€å¥½æ”¾åˆ°å¼•å·é‡Œ, è¿™äº›ç¬¦å·åŒ…æ‹¬:</p><p>å¦‚æœå€¼çš„å«ä¹‰æ˜¯å¯†ç , åº”è¯¥ç”¨å¼•å·, ä¸ç®¡æ˜¯ä¸æ˜¯æ•°å­—</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">y</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">Y</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">yes</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token maybe-class-name">Yes</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">YES</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">N</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">no</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token maybe-class-name">No</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">NO</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token boolean">true</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token maybe-class-name">True</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">TRUE</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token boolean">false</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token maybe-class-name">False</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">FALSE</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">on</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token maybe-class-name">On</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">ON</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">off</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token maybe-class-name">Off</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token constant" style="color:rgb(129, 31, 63)">OFF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">webapp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šä¸ºé•œåƒåç§°æˆ–é•œåƒ IDã€‚å¦‚æœé•œåƒåœ¨æœ¬åœ°ä¸å­˜åœ¨ï¼ŒCompose å°†ä¼šå°è¯•æ‹‰å–è¿™ä¸ªé•œåƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ¯ä¸ªæœåŠ¡éƒ½å¿…é¡»é€šè¿‡ image æŒ‡ä»¤æŒ‡å®šé•œåƒæˆ– build æŒ‡ä»¤ï¼ˆéœ€è¦ Dockerfileï¼‰ç­‰æ¥è‡ªåŠ¨æ„å»ºç”Ÿæˆé•œåƒã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># å¯ä»¥ä¸åŠ å¼•å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;examples/web&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è‹¥æœå½“å‰ç›®å½•ä¸‹æœ‰ dockerfile, åˆ™æ˜¯ç”¨ dockerfile æ„å»ºå‡ºçš„é•œåƒ, æ­¤æ—¶ image å±æ€§å¯ä»¥ä¸è®¾ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> ./</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># å¦‚æœæ—¶å¤šæ¨¡å—é¡¹ç›®, xxx å°±æ˜¯å­æ¨¡å—ç›®å½•ç›®å½•å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">         </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä½¿ç”¨ build æŒ‡ä»¤ï¼Œåœ¨ Dockerfile ä¸­è®¾ç½®çš„é€‰é¡¹(ä¾‹å¦‚ï¼šCMD, EXPOSE, VOLUME, ENV ç­‰) å°†ä¼šè‡ªåŠ¨è¢«è·å–ï¼Œæ— éœ€åœ¨ docker-compose.yml ä¸­å†æ¬¡è®¾ç½®ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®š Dockerfile æ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼ˆå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œæˆ–è€…ç›¸å¯¹ docker-compose.yml æ–‡ä»¶çš„è·¯å¾„ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> ./dir_name</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;80:80&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># cap_add, cap_drop æŒ‡å®šå®¹å™¨çš„å†…æ ¸èƒ½åŠ›ï¼ˆcapacityï¼‰åˆ†é…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">cap_add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> ALL </span><span class="token comment" style="color:rgb(0, 128, 0)"># è®©å®¹å™¨æ‹¥æœ‰æ‰€æœ‰èƒ½åŠ›</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">cap_drop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> NET_ADMIN </span><span class="token comment" style="color:rgb(0, 128, 0)"># å»æ‰ NET_ADMIN èƒ½åŠ›</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è¦†ç›–å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> echo &quot;hello world&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä»…ç”¨äº Swarm mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">configs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä»…ç”¨äº Swarm mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">deploy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šçˆ¶ cgroup ç»„ï¼Œæ„å‘³ç€å°†ç»§æ‰¿è¯¥ç»„çš„èµ„æºé™åˆ¶; ä¾‹å¦‚ï¼Œåˆ›å»ºäº†ä¸€ä¸ª cgroup ç»„åç§°ä¸º cgroups_1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">cgroup_parent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> cgroups_1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šå®¹å™¨åç§°ã€‚é»˜è®¤å°†ä¼šä½¿ç”¨ é¡¹ç›®åç§°_æœåŠ¡åç§°_åºå· è¿™æ ·çš„æ ¼å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ³¨æ„: æŒ‡å®šå®¹å™¨åç§°åï¼Œè¯¥æœåŠ¡å°†æ— æ³•è¿›è¡Œæ‰©å±•ï¼ˆscaleï¼‰ï¼Œå› ä¸º Docker ä¸å…è®¸å¤šä¸ªå®¹å™¨å…·æœ‰ç›¸åŒçš„åç§°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">container_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> docker</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">web</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šè®¾å¤‡æ˜ å°„å…³ç³»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">devices</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/dev/ttyUSB1:/dev/ttyUSB0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è§£å†³å®¹å™¨çš„ä¾èµ–ã€å¯åŠ¨å…ˆåçš„é—®é¢˜ã€‚ä»¥ä¸‹ä¾‹å­ä¸­ä¼šå…ˆå¯åŠ¨ redis db å†å¯åŠ¨ webapp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ³¨æ„ï¼šwebapp æœåŠ¡ä¸ä¼šç­‰å¾… redis db ã€Œå®Œå…¨å¯åŠ¨ã€ä¹‹åæ‰å¯åŠ¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> db</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è‡ªå®šä¹‰ DNS æœåŠ¡å™¨ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># dns: 8.8.8.8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">dns</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> 8.8.8.8</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> 114.114.114.114</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># é…ç½® DNS æœç´¢åŸŸã€‚å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># dns_search: example.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">dns_search</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> domain1.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> domain2.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‚è½½ä¸€ä¸ª tmpfs æ–‡ä»¶ç³»ç»Ÿåˆ°å®¹å™¨ã€‚å¯ä»¥ä¸ºå•ä¸ª, ä¹Ÿå¯ä»¥ä¸ºåˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># tmpfs: /run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">tmpfs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> /run</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> /tmp</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä½ å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ä¸¤ç§æ ¼å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># åªç»™å®šåç§°çš„å˜é‡ä¼šè‡ªåŠ¨è·å–è¿è¡Œ Compose ä¸»æœºä¸Šå¯¹åº”å˜é‡çš„å€¼ï¼Œå¯ä»¥ç”¨æ¥é˜²æ­¢æ³„éœ²ä¸å¿…è¦çš„æ•°æ®ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># environment:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">#     RACK_ENV: development</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">#     SESSION_SECRET:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> RACK_ENV=development</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> SESSION_SECRET</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä»æ–‡ä»¶ä¸­è·å–ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä¸ºå•ç‹¬çš„æ–‡ä»¶è·¯å¾„æˆ–åˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># å¦‚æœé€šè¿‡ docker-compose -f FILE æ–¹å¼æ¥æŒ‡å®š Compose æ¨¡æ¿æ–‡ä»¶ï¼Œåˆ™ env_file ä¸­å˜é‡çš„è·¯å¾„ä¼šåŸºäºæ¨¡æ¿æ–‡ä»¶è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># å¦‚æœæœ‰å˜é‡åç§°ä¸ environment æŒ‡ä»¤å†²çªï¼Œåˆ™æŒ‰ç…§æƒ¯ä¾‹ï¼Œä»¥åè€…ä¸ºå‡†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ç¯å¢ƒå˜é‡æ–‡ä»¶ä¸­æ¯ä¸€è¡Œå¿…é¡»ç¬¦åˆæ ¼å¼(PROG_ENV=development)ï¼Œæ”¯æŒ # å¼€å¤´çš„æ³¨é‡Šè¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># env_file: .env</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">env_file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> ./common.env</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> ./apps/web.env</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> /opt/secrets.env</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æš´éœ²ç«¯å£ï¼Œä½†ä¸æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œåªè®©å†…éƒ¨çš„æœåŠ¡è®¿é—®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">expose</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;8000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æš´éœ²ç«¯å£ä¿¡æ¯ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä½¿ç”¨å®¿ä¸»ç«¯å£ï¼šå®¹å™¨ç«¯å£ (HOST:CONTAINER) æ ¼å¼ï¼Œæˆ–è€…ä»…ä»…æŒ‡å®šå®¹å™¨çš„ç«¯å£ï¼ˆå®¿ä¸»å°†ä¼šéšæœºé€‰æ‹©ç«¯å£ï¼‰éƒ½å¯ä»¥ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;8000:8000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;49100:22&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;127.0.0.1:8001:8001&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># é“¾æ¥åˆ° docker-compose.yml å¤–éƒ¨çš„å®¹å™¨ï¼Œç”šè‡³å¹¶é Compose ç®¡ç†çš„å¤–éƒ¨å®¹å™¨ã€‚ä¸å»ºè®®ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">external_links</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> redis_1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> project_db_1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">mysql</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> project_db_1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">postgresql</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ç±»ä¼¼ Docker ä¸­çš„ --add-host å‚æ•°ï¼ŒæŒ‡å®šé¢å¤–çš„ host åç§°æ˜ å°„ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä¼šåœ¨å¯åŠ¨åçš„æœåŠ¡å®¹å™¨ä¸­ /etc/hosts æ–‡ä»¶ä¸­æ·»åŠ hostæ˜ å°„æ¡ç›®8.8.8.8 googlednså’Œ52.1.157.61 dockerhub</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">extra_hosts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;googledns:8.8.8.8&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;dockerhub:52.1.157.61&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># é€šè¿‡å‘½ä»¤æ£€æŸ¥å®¹å™¨æ˜¯å¦å¥åº·è¿è¡Œã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">healthcheck</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;CMD&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;curl&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-f&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;http://localhost&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">interval</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> 1m30s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">timeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> 10s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">retries</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä¸ºå®¹å™¨æ·»åŠ  Docker å…ƒæ•°æ®ï¼ˆmetadataï¼‰ä¿¡æ¯ã€‚ä¾‹å¦‚å¯ä»¥ä¸ºå®¹å™¨æ·»åŠ è¾…åŠ©è¯´æ˜ä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">com.startupteam.description</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;webapp for a startup team&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">com.startupteam.department</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;devops department&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">com.startupteam.release</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;rc3 for v1.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># é…ç½®æ—¥å¿—é€‰é¡¹ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">logging</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">driver</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> syslog </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ”¯æŒä¸‰ç§æ—¥å¿—é©±åŠ¨ç±»å‹: &quot;json-file&quot;, &quot;syslog&quot;, &quot;none&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)"># é…ç½®æ—¥å¿—é©±åŠ¨çš„ç›¸å…³å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">options</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token key atrule">syslog-address</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;tcp://192.168.0.42:123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># éœ€è¦å…ˆå£°æ˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">networks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">network</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> other</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">network</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è®¾ç½®ç½‘ç»œæ¨¡å¼ã€‚ä½¿ç”¨å’Œ docker run çš„ --network å‚æ•°ä¸€æ ·çš„å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">network_mode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;bridge&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ”¯æŒ&quot;bridge&quot;, &quot;host&quot;, &quot;none&quot;, &quot;service:[service name]&quot;, &quot;container:[container name/id]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è·Ÿä¸»æœºç³»ç»Ÿå…±äº«è¿›ç¨‹å‘½åç©ºé—´ã€‚æ‰“å¼€è¯¥é€‰é¡¹çš„å®¹å™¨ä¹‹é—´ï¼Œä»¥åŠå®¹å™¨å’Œå®¿ä¸»æœºç³»ç»Ÿä¹‹é—´å¯ä»¥é€šè¿‡è¿›ç¨‹ ID æ¥ç›¸äº’è®¿é—®å’Œæ“ä½œã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">pid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;host&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šå®¹å™¨æ¨¡æ¿æ ‡ç­¾ï¼ˆlabelï¼‰æœºåˆ¶çš„é»˜è®¤å±æ€§ï¼ˆç”¨æˆ·ã€è§’è‰²ã€ç±»å‹ã€çº§åˆ«ç­‰ï¼‰ã€‚ä¾‹å¦‚é…ç½®æ ‡ç­¾çš„ç”¨æˆ·åå’Œè§’è‰²å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">security_opt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> label</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">USER</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> label</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">role</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">ROLE</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># è®¾ç½®å¦ä¸€ä¸ªä¿¡å·æ¥åœæ­¢å®¹å™¨ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯ SIGTERM åœæ­¢å®¹å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">stop_signal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> SIGUSR1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># é…ç½®å®¹å™¨å†…æ ¸å‚æ•°, ä¸¤ç§æ–¹å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctls:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">#     net.core.somaxconn: 1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">#     net.ipv4.tcp_syncookies: 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">sysctls</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> net.core.somaxconn=1024</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> net.ipv4.tcp_syncookies=0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šå®¹å™¨çš„ ulimits é™åˆ¶å€¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä¾‹å¦‚ï¼ŒæŒ‡å®šæœ€å¤§è¿›ç¨‹æ•°ä¸º 65535ï¼ŒæŒ‡å®šæ–‡ä»¶å¥æŸ„æ•°ä¸º 20000ï¼ˆè½¯é™åˆ¶ï¼Œåº”ç”¨å¯ä»¥éšæ—¶ä¿®æ”¹ï¼Œä¸èƒ½è¶…è¿‡ç¡¬é™åˆ¶ï¼‰ å’Œ 40000ï¼ˆç³»ç»Ÿç¡¬é™åˆ¶ï¼Œåªèƒ½ root ç”¨æˆ·æé«˜ï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">ulimits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">nproc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">65535</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">nofile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token key atrule">soft</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token key atrule">hard</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">40000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ•°æ®å·æ‰€æŒ‚è½½è·¯å¾„è®¾ç½®ã€‚å¯ä»¥è®¾ç½®å®¿ä¸»æœºè·¯å¾„ ï¼ˆHOST:CONTAINERï¼‰ æˆ–åŠ ä¸Šè®¿é—®æ¨¡å¼ ï¼ˆHOST:CONTAINER:roï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> /var/lib/mysql </span><span class="token comment" style="color:rgb(0, 128, 0)"># åŒ¿å volume</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> cache/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">/tmp/cache</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> ~/configs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">/etc/configs/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">ro</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> xxName</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">/tmp/data  </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä¸ºå®¹å™¨å†…çš„åŒ¿åvolume åä¸ºä¸º xxName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> ./dir</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># é…ç½®å®¹å™¨è¿æ¥çš„ç½‘ç»œã€‚æ³¨æ„è¿™é‡Œæ˜¯å¼•ç”¨å’ŒservicesåŒçº§çš„networksä¸‹çš„é¡¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">networks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> some</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">network</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> other</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">network</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># å­˜å‚¨æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚ mysql æœåŠ¡å¯†ç , æ³¨æ„è¿™é‡Œæ˜¯å¼•ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">secrets</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> db_root_password</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> my_other_secret</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># å¦ä¸€ç§æŒ‡å®šDockerfileçš„æ–¹å¼, è‡ªç”±åº¦æ›´é«˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> ./dir </span><span class="token comment" style="color:rgb(0, 128, 0)"># Dockerfileæ‰€åœ¨æ–‡ä»¶å¤¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">dockerfile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Dockerfile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">alternate </span><span class="token comment" style="color:rgb(0, 128, 0)"># Dockerfile æ–‡ä»¶å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šæ„å»ºé•œåƒæ—¶çš„å˜é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">args</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token key atrule">buildno</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token key atrule">cache_from</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># æŒ‡å®šæ„å»ºé•œåƒçš„ç¼“å­˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> alpine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> corp/web_app</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">3.14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># å£°æ˜ç½‘ç»œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">networks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">some-network</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">other-network</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">secrets</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">my_secret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> ./my_secret.txt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">my_other_secret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">external</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># å£°æ˜ä¸€ä¸ªå‘½åçš„ volume</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  xxName</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Compose æ¨¡æ¿æ–‡ä»¶æ”¯æŒåŠ¨æ€è¯»å–ä¸»æœºçš„ç³»ç»Ÿç¯å¢ƒå˜é‡å’Œå½“å‰ç›®å½•ä¸‹çš„ .env æ–‡ä»¶ä¸­çš„å˜é‡</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># å¦‚æœæ‰§è¡Œ MONGO_VERSION=3.2 docker-compose up åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª mongo:3.2 é•œåƒçš„å®¹å™¨ï¼›å¦‚æœæ‰§è¡Œ MONGO_VERSION=2.8 docker-compose up åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª mongo:2.8 é•œåƒçš„å®¹å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;mongo:${MONGO_VERSION}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è‹¥å½“å‰ç›®å½•å­˜åœ¨ .env æ–‡ä»¶ï¼Œæ‰§è¡Œ docker-compose å‘½ä»¤æ—¶å°†ä»è¯¥æ–‡ä»¶ä¸­è¯»å–å˜é‡</p><p>åœ¨å½“å‰ç›®å½•æ–°å»º .env æ–‡ä»¶å¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ã€‚</p><div class="language-props codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-props codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># æ”¯æŒ # å·æ³¨é‡Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">MONGO_VERSION=3.6</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ‰§è¡Œ docker-compose up åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª mongo:3.6 é•œåƒçš„å®¹å™¨</p><p>docker-compose.ymlæ¨¡ç‰ˆæ–‡ä»¶ä¸­çš„å…¶ä»–æŒ‡ä»¤:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">æŒ‡å®šæœåŠ¡å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å…¥å£æ–‡ä»¶ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">entrypoint: /code/entrypoint.sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æŒ‡å®šå®¹å™¨ä¸­è¿è¡Œåº”ç”¨çš„ç”¨æˆ·åã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">user: nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æŒ‡å®šå®¹å™¨ä¸­å·¥ä½œç›®å½•ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">working_dir: /code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æŒ‡å®šå®¹å™¨ä¸­æœç´¢åŸŸåã€ä¸»æœºåã€mac åœ°å€ç­‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">domainname: your_website.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">hostname: test</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mac_address: 08-00-27-00-0C-0A</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å…è®¸å®¹å™¨ä¸­è¿è¡Œä¸€äº›ç‰¹æƒå‘½ä»¤ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…è®¸containerå†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™, å¯ä»¥çœ‹åˆ°å¾ˆå¤šhostä¸Šçš„è®¾å¤‡ï¼Œå¹¶ä¸”å¯ä»¥æ‰§è¡Œmountã€‚ç”šè‡³å…è®¸ä½ åœ¨dockerå®¹å™¨ä¸­å¯åŠ¨dockerå®¹å™¨ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">privileged: true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#æŒ‡å®šå®¹å™¨é€€å‡ºåçš„é‡å¯ç­–ç•¥ä¸ºå§‹ç»ˆé‡å¯ã€‚è¯¥å‘½ä»¤å¯¹ä¿æŒæœåŠ¡å§‹ç»ˆè¿è¡Œååˆ†æœ‰æ•ˆï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ¨èé…ç½®ä¸º always æˆ–è€… unless-stoppedã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å‘½ä»¤è¡Œä¸­ --restart always, é‡å¯ç­–ç•¥æ˜¯é¢å‘ç”Ÿäº§ç¯å¢ƒçš„ä¸€ä¸ªå¯åŠ¨ç­–ç•¥ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥å¿½ç•¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…±æœ‰å¦‚ä¸‹ç­–ç•¥:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># noï¼Œé»˜è®¤ç­–ç•¥ï¼Œåœ¨å®¹å™¨é€€å‡ºæ—¶ä¸é‡å¯å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># on-failureï¼Œåœ¨å®¹å™¨éæ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€é0ï¼‰ï¼Œæ‰ä¼šé‡å¯å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># on-failure:3ï¼Œåœ¨å®¹å™¨éæ­£å¸¸é€€å‡ºæ—¶é‡å¯å®¹å™¨ï¼Œæœ€å¤šé‡å¯3æ¬¡, å¯è‡ªå·±æŒ‡å®š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># alwaysï¼Œåœ¨å®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># unless-stoppedï¼Œåœ¨å®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯å®¹å™¨ï¼Œä½†æ˜¯ä¸è€ƒè™‘åœ¨Dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶å°±å·²ç»åœæ­¢äº†çš„å®¹å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹å®¹å™¨é‡å¯æ¬¡æ•° docker inspect -f &quot;{{ .RestartCount }}&quot; ba-208</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹å®¹å™¨æœ€åä¸€æ¬¡çš„å¯åŠ¨æ—¶é—´ docker inspect -f &quot;{{ .State.StartedAt }}&quot; ba-208</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">restart: always</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä»¥åªè¯»æ¨¡å¼æŒ‚è½½å®¹å™¨çš„ root æ–‡ä»¶ç³»ç»Ÿï¼Œæ„å‘³ç€ä¸èƒ½å¯¹å®¹å™¨å†…å®¹è¿›è¡Œä¿®æ”¹ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">read_only: true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æ‰“å¼€æ ‡å‡†è¾“å…¥ï¼Œå¯ä»¥æ¥å—å¤–éƒ¨è¾“å…¥ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stdin_open: true</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æ¨¡æ‹Ÿä¸€ä¸ªä¼ªç»ˆç«¯ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tty: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>14. docker-machine</h1><p>Docker Machine æ˜¯ Docker å®˜æ–¹ç¼–æ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£åœ¨å¤šç§å¹³å°ä¸Šå¿«é€Ÿå®‰è£… Docker ç¯å¢ƒ, åŒ…æ‹¬è™šæ‹Ÿæœºã€æœ¬åœ°ä¸»æœºå’Œäº‘å¹³å°</p><p>linuxä¸Šå®‰è£…</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ sudo curl -L https://github.com/docker/machine/releases/download/v0.13.0/docker-machine-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-machine</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ sudo chmod +x /usr/local/bin/docker-machine</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">`docker-machine -v` # æŸ¥çœ‹ç‰ˆæœ¬</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä½¿ç”¨virtualboxé©±åŠ¨åˆ›å»ºæœ¬åœ°ä¸»æœºå®ä¾‹:</p><p><code>docker-machine create -d virtualbox test</code></p><h1>15. docker-swarm,swarm-mode</h1><p>Docker Swarm æ˜¯ Docker å®˜æ–¹ä¸‰å‰‘å®¢é¡¹ç›®ä¹‹ä¸€ï¼Œæä¾› Docker å®¹å™¨é›†ç¾¤æœåŠ¡ï¼Œæ˜¯ Docker å®˜æ–¹å¯¹å®¹å™¨äº‘ç”Ÿæ€è¿›è¡Œæ”¯æŒçš„æ ¸å¿ƒæ–¹æ¡ˆ; ä½¿ç”¨å®ƒï¼Œç”¨æˆ·å¯ä»¥å°†å¤šä¸ª Docker ä¸»æœºå°è£…ä¸ºå•ä¸ªå¤§å‹çš„è™šæ‹Ÿ Docker ä¸»æœºï¼Œå¿«é€Ÿæ‰“é€ ä¸€å¥—å®¹å™¨äº‘å¹³å°;Docker 1.12.0+ Swarm mode å·²ç»å†…åµŒå…¥ Docker å¼•æ“ï¼Œæˆä¸ºäº† docker å­å‘½ä»¤ docker swarm, å› æ­¤ä¸€èˆ¬ä½¿ç”¨dockerçš„swarm mode</p><h1>16. dockerå®è·µ</h1><p><a href="https://github.com/wenshunbiao/docker" target="_blank" rel="noopener noreferrer">https://github.com/wenshunbiao/docker</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nacos">nacos<a href="#nacos" class="hash-link" aria-label="nacosçš„ç›´æ¥é“¾æ¥" title="nacosçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://hub.docker.com/r/nacos/nacos-server" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/nacos/nacos-server</a></p><p><a href="https://hub.docker.com/r/zhusaidong/nacos-server-m1" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/zhusaidong/nacos-server-m1</a></p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker run </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">d </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">p </span><span class="token number" style="color:rgb(9, 134, 88)">8848</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token number" style="color:rgb(9, 134, 88)">8848</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">env </span><span class="token constant" style="color:rgb(129, 31, 63)">MODE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">standalone  </span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token plain">name nacos  zhusaidong</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">nacos</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">server</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">m1</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token number" style="color:rgb(9, 134, 88)">2.0</span><span class="token number" style="color:rgb(9, 134, 88)">.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="161-æ­å»ºæŒç»­é›†æˆç³»ç»Ÿ">16.1. æ­å»ºæŒç»­é›†æˆç³»ç»Ÿ<a href="#161-æ­å»ºæŒç»­é›†æˆç³»ç»Ÿ" class="hash-link" aria-label="16.1. æ­å»ºæŒç»­é›†æˆç³»ç»Ÿçš„ç›´æ¥é“¾æ¥" title="16.1. æ­å»ºæŒç»­é›†æˆç³»ç»Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹ç«¯å£å ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">lsof -i:8080</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹æŒ‡å®šç«¯å£çš„è¿›ç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">netstat -tunlp | grep 8000</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ­å»º jenkins</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆå§‹å¯†ç åˆ°jenkinså†…éƒ¨[/var/jenkins_home/secrets/initialAdminPassword]çœ‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># -u 0 è¡¨ç¤ºè¦†ç›–é•œåƒå†…éƒ¨çš„å¸å·, ä½¿ç”¨å¤–éƒ¨çš„root, ç”¨äºè§£å†³volumeæƒé™é—®é¢˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># -v xxx:yyy è¡¨ç¤º volume:containerä¸­çš„ç›®å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d -p 8090:8080 -p 50000:50000 -v /srv/docker/jenkins:/var/jenkins_home --name jenkins -u 0 jenkins</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æˆ–è€… ä½¿ç”¨docker-composeç¼–æ’</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># docker-compose.yml:(http://www.voidcn.com/article/p-keekrhyk-brk.html)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">version: &#x27;2&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  gitlab:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      image: gitlab/gitlab-ce:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      ports:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - &quot;20443:443&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - &quot;20080:80&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - &quot;20022:22&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - devops</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      volumes:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - /data/gitlab/config:/etc/gitlab</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - /data/gitlab/logs:/var/log/gitlab</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - /data/gitlab/data:/var/opt/gitlab</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  jenkins:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      image: jenkins:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      ports:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - &quot;28080:8080&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - &quot;50000:50000&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - devops</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      volumes:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - /data/jenkins:/var/jenkins_home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - /var/run/docker.sock:/var/run/docker.sock</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  sonarqube:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      image: sonarqube:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      ports:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - &quot;29000:9000&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - &quot;29092:9092&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          - devops</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  devops:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    driver: bridge</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ­å»ºgitlab, ä¸Šä¼ ä»£ç æ—¶å€™, <code>git remote add origin http://43.254.2.51:20080/root/rest-api-starter.git</code>, <code>git push --set-upstream origin master</code></p><p>è‡ªåŠ¨éƒ¨ç½²éœ€è¦jenkinsçš„æ’ä»¶ Publish over SSH;</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="162-dockerå’Œspringboot">16.2. dockerå’Œspringboot<a href="#162-dockerå’Œspringboot" class="hash-link" aria-label="16.2. dockerå’Œspringbootçš„ç›´æ¥é“¾æ¥" title="16.2. dockerå’Œspringbootçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>è€å¤–çš„ä¸€ç¯‡åšæ–‡: <a href="https://www.callicoder.com/spring-boot-docker-example/" target="_blank" rel="noopener noreferrer">https://www.callicoder.com/spring-boot-docker-example/</a>, å…ˆæ²¡æœ‰ä½¿ç”¨mavenå·¥å…·, ç„¶åå¼•å…¥mavenæ’ä»¶, ä¸¤ç§å®ç°</p><p>ä½¿ç”¨äº† maven æ’ä»¶: <a href="http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html" target="_blank" rel="noopener noreferrer">http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="163-oracle11g">16.3. oracle11g<a href="#163-oracle11g" class="hash-link" aria-label="16.3. oracle11gçš„ç›´æ¥é“¾æ¥" title="16.3. oracle11gçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://blog.csdn.net/qq_33982232/article/details/83133870" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_33982232/article/details/83133870</a>
<a href="https://www.35youth.cn/685.html" target="_blank" rel="noopener noreferrer">https://www.35youth.cn/685.html</a> (<a href="https://registry.hub.docker.com/r/jaspeen/oracle-11g" target="_blank" rel="noopener noreferrer">https://registry.hub.docker.com/r/jaspeen/oracle-11g</a>)</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="164-ä½¿ç”¨-mysql-é•œåƒ">16.4. ä½¿ç”¨ mysql é•œåƒ<a href="#164-ä½¿ç”¨-mysql-é•œåƒ" class="hash-link" aria-label="16.4. ä½¿ç”¨ mysql é•œåƒçš„ç›´æ¥é“¾æ¥" title="16.4. ä½¿ç”¨ mysql é•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker pull mysql</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=root -e MYSQL_DATABASE=raincloud-hello mysql</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mysql -h127.0.0.1 -uroot -p # password is &#x27;hello&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‹¥ local æ²¡æœ‰å®‰è£… MySQL client, åˆ™ä½¿ç”¨ container client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network create my-net</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker network connect my-net my-mysql</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it --network my-net --rm mysql mysql -hmy-mysql -uroot -p</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it --rm --link my-mysql:xxxhost mysql mysql -hxxxhost -uroot -p </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¤–éƒ¨å­˜å‚¨ volume</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># https://www.cnblogs.com/sablier/p/11605606.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># mysql8 (æ‰‹åŠ¨æ•²å…¥, ä¸è¦å¤åˆ¶ç²˜è´´, å®¹æ˜“å‡ºéæ³•å­—ç¬¦)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name mysql8 -p 3306:3306 -v /root/mysql/conf:/etc/mysql -v /root/mysql/logs:/var/log/mysql -v /root/mysql/data:/var/lib/mysql -v /root/mysql/mysql-files:/var/lib/mysql-files/ã€€-e MYSQL_ROOT_PASSWORD=123456 -e MYSQL_DATABASE=face mysql:latest --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci # utf8mb4_unicode_ci å¯ä»¥è€ƒè™‘æ›¿æ¢ä¸º æ›´å¿«çš„ utf8mb4_general_ci</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># mysql5.7</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name mysql5_7 -p 3306:3306 -v /root/mysql/conf:/etc/mysql -v /root/mysql/logs:/var/log/mysql -v /root/mysql/data:/var/lib/mysqlã€€-e MYSQL_ROOT_PASSWORD=123456 -e MYSQL_DATABASE=face mysql:5.7.34 --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://www.jianshu.com/p/530d00f97cbf" target="_blank" rel="noopener noreferrer">mysqlå®¹å™¨çš„æ•°æ®æŒä¹…åŒ–é—®é¢˜</a></p><p><a href="https://zhuanlan.zhihu.com/p/26129750" target="_blank" rel="noopener noreferrer">å¯¼å…¥å¯¼å‡º</a></p><p>åœ¨å®¿ä¸»æœºä¸Šè¿æ¥ MySQL å®¹å™¨, åœ°å€æ˜¯ 127.0.0.1:3306 , è€Œä¸æ˜¯ localhost, (æŸ¥container ipï¼š<code>cat /etc/hosts</code>)</p><p><code> Authentication plugin &#x27;caching_sha2_password&#x27; cannot be loaded</code> å¼‚å¸¸ - <a href="https://www.cnblogs.com/chuancheng/p/8964385.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/chuancheng/p/8964385.html</a></p><p><code>Access denied for user &#x27;root&#x27;@&#x27;172.19.0.1&#x27;</code> å¼‚å¸¸ - è¿›å…¥dockerså†…éƒ¨ <code>docker exec -it &lt;xxx&gt; bash</code>, <code>mysql -uroot -p</code> ç™»é™†MySQL, <code>update mysql.user set host = &#x27;%&#x27; where user = &#x27;root&#x27;;</code> ä¿®æ”¹rootç”¨æˆ·å…è®¸æ‰€æœ‰ipè®¿é—®, é»˜è®¤åªèƒ½localhostè®¿é—®; å¦‚æœè¿˜ä¸è¡Œ <code>ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;root&#x27;; flush privileges;</code> ä¿®æ”¹rootç”¨æˆ·çš„æƒé™ (<a href="https://blog.csdn.net/iw1210/article/details/54646093" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/iw1210/article/details/54646093</a>)</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3.2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">mysql</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> mysql</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> 3306</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ ¡æ­£æ—¶åŒº</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> TZ=Asia/Shanghai</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># è®¾ç½®ç¼–ç </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">character</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">server=utf8mb4 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">collation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">server=utf8mb4_unicode_ci</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># æ•°æ®å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> ./data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">/var/lib/mysql</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># root çš„å¯†ç , ä¸è¿‡è²Œä¼¼æ²¡æœ‰ç”Ÿæ•ˆ ä¸è¦ç´§ æ‰‹åŠ¨è®¾ç½®ä¹Ÿå¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> MYSQL_ROOT_PASSWORD=root</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>root, root ç™»é™†</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="165-ä½¿ç”¨postgresé•œåƒ">16.5. ä½¿ç”¨postgresé•œåƒ<a href="#165-ä½¿ç”¨postgresé•œåƒ" class="hash-link" aria-label="16.5. ä½¿ç”¨postgresé•œåƒçš„ç›´æ¥é“¾æ¥" title="16.5. ä½¿ç”¨postgresé•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><code>docker run -d --name Postgres -p 5432:5432 [-e POSTGRES_USER=dev] -e POSTGRES_PASSWORD=dev123 postgres:alpine</code></p><blockquote><p>If the db users is not been specified, the password will be setup on the head of &quot;postgres&quot; (the db user which has a root access)</p></blockquote><p>or</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">postgresdb</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> postgres</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">#- ./data:/var/lib/postgresql/data # æŒ‚è½½æœ¬åœ°ç›®å½•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)"># ä½¿ç”¨æ•°æ®å·</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> pgdata</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">/var/lib/postgresql/data </span><span class="token comment" style="color:rgb(0, 128, 0)"># data volume</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> 5432</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token number" style="color:rgb(9, 134, 88)">5432</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># data volume éœ€è¦åœ¨è¿™é‡Œå£°æ˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">pgdata</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¯èƒ½é”™è¯¯: data directory &quot;/var/lib/postgresql/data&quot; has wrong ownership</p><p>ref: <a href="https://stackoverflow.com/questions/49148754/docker-container-shuts-down-giving-data-directory-has-wrong-ownership-error-wh" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/49148754/docker-container-shuts-down-giving-data-directory-has-wrong-ownership-error-wh</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="166-ä½¿ç”¨-rabbitmqé•œåƒ">16.6. ä½¿ç”¨ rabbitmqé•œåƒ<a href="#166-ä½¿ç”¨-rabbitmqé•œåƒ" class="hash-link" aria-label="16.6. ä½¿ç”¨ rabbitmqé•œåƒçš„ç›´æ¥é“¾æ¥" title="16.6. ä½¿ç”¨ rabbitmqé•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">rabbitmq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> rabbitmq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">management</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;5672:5672&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;15672:15672&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="167-redisé•œåƒ">16.7. redisé•œåƒ<a href="#167-redisé•œåƒ" class="hash-link" aria-label="16.7. redisé•œåƒçš„ç›´æ¥é“¾æ¥" title="16.7. redisé•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token key atrule">redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> redis </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">container_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">server </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">requirepass 123456</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;6379:6379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain"> ./db/redis</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">/data</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker run -p 6379:6379 -d redis:latest redis-server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ•°æ®æŒä¹…åŒ–å­˜æ–¹å¼å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -p 6379:6379 -v $PWD/data:/data --name redis -d redis redis-server --appendonly yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‡ªå®šä¹‰é…ç½®æ–‡ä»¶, å…ˆåˆ›å»º /usr/local/docker/redis.conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -p 6379:6379 --name myredis -v /usr/local/docker/redis.conf:/etc/redis/redis.conf -v /usr/local/docker/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¸¦å¯†ç å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run --name redis_with_auth -p 6379:6379 -d --restart=always redis:latest redis-server --appendonly yes --requirepass &quot;@w-(*102Y613}-Redis&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># redis client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec -ti d0b86 redis-cli [-h localhost -p 6379]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># remote client</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec -it redis_image redis-cli -h 192.168.1.100 -p 6379 -a your_password #å¦‚æœæœ‰å¯†ç  ä½¿ç”¨ -aå‚æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>redis.conf</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">bind 127.0.0.1 #æ³¨é‡Šæ‰è¿™éƒ¨åˆ†ï¼Œè¿™æ˜¯é™åˆ¶redisåªèƒ½æœ¬åœ°è®¿é—®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…è®¸å¤–ç½‘è®¿é—®redis</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bind 0.0.0.0 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">protected-mode no #é»˜è®¤yesï¼Œå¼€å¯ä¿æŠ¤æ¨¡å¼ï¼Œä¼šé™åˆ¶ä¸ºæœ¬åœ°è®¿é—®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">daemonize no#é»˜è®¤noï¼Œæ”¹ä¸ºyesæ„ä¸ºä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼å¯åŠ¨ï¼Œå¯åå°è¿è¡Œï¼Œé™¤ékillè¿›ç¨‹ï¼Œæ”¹ä¸ºyesä¼šä½¿é…ç½®æ–‡ä»¶æ–¹å¼å¯åŠ¨rediså¤±è´¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">databases 16 #æ•°æ®åº“ä¸ªæ•°ï¼ˆå¯é€‰ï¼‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">dir ./ #è¾“å…¥æœ¬åœ°redisæ•°æ®åº“å­˜æ”¾æ–‡ä»¶å¤¹ï¼ˆå¯é€‰ï¼‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">appendonly yes #redisæŒä¹…åŒ–ï¼ˆå¯é€‰ï¼‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è®¾ç½®è®¿é—®redisçš„å¯†ç ä¸º123(å¯é€‰)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">requirepass 123 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>redis-commander: æä¾› redis web ç®¡ç†ç•Œé¢</p><p><code>docker run --rm -d --name redis-cmder -p 8081:8081 --link redis:re -e REDIS_HOSTS=re:6379 rediscommander/redis-commander</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="168-ubuntué•œåƒ">16.8. ubuntué•œåƒ<a href="#168-ubuntué•œåƒ" class="hash-link" aria-label="16.8. ubuntué•œåƒçš„ç›´æ¥é“¾æ¥" title="16.8. ubuntué•œåƒçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker pull ubuntu</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it ubuntu bash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">apt update</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å®‰è£… vim ping wget ifconfig</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">apt install vim iputils-ping wget net-tools zsh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># 2ã€æŠŠé»˜è®¤çš„Shellæ”¹æˆzsh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">chsh -s /bin/zsh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å®‰è£… oh-my-zsh éœ€è¦å…ˆè£…git</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">apt install git</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="169-zookeeper">16.9. zookeeper<a href="#169-zookeeper" class="hash-link" aria-label="16.9. zookeeperçš„ç›´æ¥é“¾æ¥" title="16.9. zookeeperçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker run --name some-zookeeper -d -p 2181:2181 zookeeper</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹æ—¥å¿—</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker logs -f --tail=10 some-zookeeper</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿›å…¥å‘½ä»¤è¡Œ client (è¿›å…¥å æ‰§è¡Œ zkCli.sh -server &lt;ip&gt;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it --rm --link some-zookeeper:zk zookeeper zkCli.sh -server zk</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">###### zookeeper client cmd</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ls / # æŸ¥çœ‹æ ¹èŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">get /zookeeper</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1610-kafka">16.10. kafka<a href="#1610-kafka" class="hash-link" aria-label="16.10. kafkaçš„ç›´æ¥é“¾æ¥" title="16.10. kafkaçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/lensesio/fast-data-dev" target="_blank" rel="noopener noreferrer">https://github.com/lensesio/fast-data-dev</a></p><p><a href="https://hub.docker.com/r/bitnami/kafka/" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/bitnami/kafka/</a>
<a href="https://flxdu.cn/2023/01/23/Kafka-in-Docker-%E5%8D%95%E8%8A%82%E7%82%B9-%E5%A4%9A%E8%8A%82%E7%82%B9/" target="_blank" rel="noopener noreferrer">https://flxdu.cn/2023/01/23/Kafka-in-Docker-%E5%8D%95%E8%8A%82%E7%82%B9-%E5%A4%9A%E8%8A%82%E7%82%B9/</a></p><p><a href="https://github.com/provectus/kafka-ui" target="_blank" rel="noopener noreferrer">https://github.com/provectus/kafka-ui</a></p><p>(å¯èƒ½ç¢°åˆ° springboot æ‰¾ä¸åˆ° å¡å¤«å¡çš„åœ°å€çš„é—®é¢˜, éœ€è¦å§ docker id å’Œ 127.0.0.1 åœ¨ host ä¸­æ˜ å°„)</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">version: &quot;3&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  kafka-tier:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    driver: bridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#  zookeeper:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#    image: docker.io/bitnami/zookeeper:3.8</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#    container_name: zookeeper</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#    networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#      - kafka-tier</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#    ports:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#      - &quot;2181:2181&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#    environment:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#      - ALLOW_ANONYMOUS_LOGIN=yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  kafka:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    image: docker.io/bitnami/kafka:3.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    container_name: kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      - &quot;9092:9092&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      - kafka-tier</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      - ALLOW_PLAINTEXT_LISTENER=yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  kafka-ui:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    container_name: kafka-ui</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    image: provectuslabs/kafka-ui:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    networks:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      - kafka-tier</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      - &quot;9093:8080&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    depends_on:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      - kafka</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      DYNAMIC_CONFIG_ENABLED: &#x27;true&#x27;  # not necessary, added for tests</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS: kafka:9092</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1611-rabbitmq">16.11. rabbitmq<a href="#1611-rabbitmq" class="hash-link" aria-label="16.11. rabbitmqçš„ç›´æ¥é“¾æ¥" title="16.11. rabbitmqçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># å¸¦ management çš„ç‰ˆæœ¬æœ‰ web ç•Œé¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker pull rabbitmq:3.8.3-management</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># 15672 ä¸º web ui ç«¯å£, ç™»å½• guest/guest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it --rm --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3-management</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name rabbitmq3.7.7 -p 5672:5672 -p 15672:15672 -v `pwd`/data:/var/lib/rabbitmq --hostname myRabbit -e RABBITMQ_DEFAULT_VHOST=my_vhost  -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=admin df80af9ca0c9</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1612-zipkin">16.12. zipkin<a href="#1612-zipkin" class="hash-link" aria-label="16.12. zipkinçš„ç›´æ¥é“¾æ¥" title="16.12. zipkinçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://zipkin.io/pages/quickstart.html" target="_blank" rel="noopener noreferrer">https://zipkin.io/pages/quickstart.html</a></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker run --name zipkin-x -d -p 9411:9411 openzipkin/zipkin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>http://localhost:9411/zipkin/</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1613-nginx">16.13. nginx<a href="#1613-nginx" class="hash-link" aria-label="16.13. nginxçš„ç›´æ¥é“¾æ¥" title="16.13. nginxçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://github.com/nginx-proxy/nginx-proxy" target="_blank" rel="noopener noreferrer">https://github.com/nginx-proxy/nginx-proxy</a> å®¹å™¨é‡Œçš„ nginx åå‘ä»£ç†</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ä¿è¯ nginx ä¸‹æœ‰ conf, conf æ–‡ä»¶å¤¹å¤åˆ¶è‡ª nginx docker å†…éƒ¨ (docker container cp nginx:/etc/nginx .)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name nginx -p 80:80 -v ~/docker_data/nginx/html:/usr/share/nginx/html -v ~/docker_data/nginx/logs:/var/nginx/logs -v ~/docker_data/nginx/conf:/etc/nginx nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1614-mongodb">16.14. mongodb<a href="#1614-mongodb" class="hash-link" aria-label="16.14. mongodbçš„ç›´æ¥é“¾æ¥" title="16.14. mongodbçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># --authï¼šéœ€è¦å¯†ç æ‰èƒ½è®¿é—®å®¹å™¨æœåŠ¡ã€‚(é»˜è®¤æ²¡æœ‰è´¦æˆ·å¯†ç )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name mongo -p 27017:27017 -v /Users/xiaoyu/one/docker_data/mongo/data:/data/db -v /Users/xiaoyu/one/docker_data/mongo/backup:/data/backup mongo:latest --auth</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec -it mongo mongo admin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºä¸€ä¸ªåä¸º adminï¼Œå¯†ç ä¸º 123456 çš„ç”¨æˆ·ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt;  db.createUser({ user:&#x27;admin&#x27;,pwd:&#x27;123456&#x27;,roles:[ { role:&#x27;userAdminAnyDatabase&#x27;, db: &#x27;admin&#x27;},&quot;readWriteAnyDatabase&quot;]});</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å°è¯•ä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ç”¨æˆ·ä¿¡æ¯è¿›è¡Œè¿æ¥ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&gt; db.auth(&#x27;admin&#x27;, &#x27;123456&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¤‡ä»½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker exec mongo sh -c &#x27;exec var=`date +%Y%m%d%H%M` &amp;amp;&amp;amp; mongodump -h localhost --port 27017 -u jsmith -p password -d dbname -o /data/backup/$var_test1.dat&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿œç¨‹è¿æ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -it --rm mongo mongo --host 192.168.10.130 --port 27017</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1615-gitlab">16.15. gitlab<a href="#1615-gitlab" class="hash-link" aria-label="16.15. gitlabçš„ç›´æ¥é“¾æ¥" title="16.15. gitlabçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># æ‹‰å–gitlabé•œåƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker pull beginor/gitlab-ce:11.0.1-ce.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»º volume ç›®å½•</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mkdir -p ./gitlab/etc ./gitlab/log ./gitlab/data</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¤åˆ¶é…ç½®æ–‡ä»¶åˆ°å®¿ä¸»çš„ volume ç›®å½•é‡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¯ä»¥æ‰‹åŠ¨å¤åˆ¶, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¹Ÿå¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªå®¹å™¨ç„¶åå…³é—­æ¥è¾¾åˆ°å¤åˆ¶çš„æ•ˆæœ (æ¨è)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run --rm --privileged=true -v /root/gitlab/etc:/etc/gitlab -v /root/gitlab/log:/var/log/gitlab -v /root/gitlab/data:/var/opt/gitlab beginor/gitlab-ce:11.0.1-ce.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># Ctrl+c å…³é—­, æ­¤æ—¶é…ç½®æ–‡ä»¶è¢«å¤åˆ¶åˆ°å®¿ä¸»çš„ volume ç›®å½•äº†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¿®æ”¹ gitlab.rb,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ·»åŠ  external_url &#x27;http://&lt;å®¿ä¸»æœº host&gt;:&lt;å®¿ä¸»æœº port&gt;&#x27; (æ„æ€æ˜¯å‘Šè¯‰å®¹å™¨å†…çš„ gitlab, åœ¨å®¹å™¨å†…éƒ¨ä¹Ÿè¦ä½¿ç”¨è¿™ä¸ªç«¯å£, ä»¥å’Œå®¿ä¸»æœºå‡†å¤‡æš´éœ²çš„ç«¯å£ä¿æŒç›¸åŒ. è‹¥å®¿ä¸»é‡‡ç”¨ 80 ä½œä¸º gitlab å¯¹å¤–ç«¯å£, åˆ™ external_url çš„ç«¯å£å¯çœç•¥, )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># attention!!! è¿™é‡Œç«¯å£é…ç½®ä¸ºa_port, é‚£ä¹ˆ docker run è¿è¡Œå®¹å™¨æ—¶ , éœ€è¦ -p a_port:a_port</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cd gitlab</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vim etc/gitlab.rb</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¿®æ”¹ gitlab.yml</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¿®æ”¹ gitlab.host: å®¿ä¸»æœºipåœ°å€, gitlab.port: å®¿ä¸»æœºæš´éœ²çš„ç«¯å£, gitlab.https: false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vim data/gitlab-rails/etc/gitlab.yml</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‹¥å®¿ä¸»å‡†å¤‡ä½¿ç”¨é»˜è®¤ç«¯å£ 80, é‚£ä¹ˆå¯ä»¥ -p 80:80 , æ­¤æ—¶ä¿®æ”¹ external_url æ—¶, å¯çœç•¥ç«¯å£ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name gitlab -p 8443:443 -p 80:80 --restart unless-stopped -v /root/gitlab/etc:/etc/gitlab -v /root/gitlab/log:/var/log/gitlab -v /root/gitlab/data:/var/opt/gitlab beginor/gitlab-ce:11.0.1-ce.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‡ªå®šä¹‰æš´éœ²ç«¯å£ä¸º 8090, åˆ™éœ€è¦ä¿®æ”¹ external_url æ—¶åŠ ä¸Šç«¯å£ 8090</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d --name gitlab -p 8443:443 -p 8090:8090 --privileged=true --restart unless-stopped -v /root/gitlab/etc:/etc/gitlab -v /root/gitlab/log:/var/log/gitlab -v /root/gitlab/data:/var/opt/gitlab beginor/gitlab-ce:11.0.1-ce.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1616-etcd">16.16. etcd<a href="#1616-etcd" class="hash-link" aria-label="16.16. etcdçš„ç›´æ¥é“¾æ¥" title="16.16. etcdçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker pull bitnami/etcd:latest</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å•èŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker run -p 2379:2379 -e ALLOW_NO_AUTH=yes --name Etcd bitnami/etcd</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1617-influxdb">16.17. influxdb<a href="#1617-influxdb" class="hash-link" aria-label="16.17. influxdbçš„ç›´æ¥é“¾æ¥" title="16.17. influxdbçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">docker run -d \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --name influxdb \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    -p 8086:8086 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    --volume $PWD:/var/lib/influxdb2 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    influxdb:2.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>17. vagrant</h1><p><a href="https://github.com/hashicorp/vagrant" target="_blank" rel="noopener noreferrer">https://github.com/hashicorp/vagrant</a></p><p><a href="https://github.com/utmapp/UTM" target="_blank" rel="noopener noreferrer">https://github.com/utmapp/UTM</a> ios å¹³å°, mac å¹³å°</p><p> firecracker, kata ä¹‹ç±»æ–°è½»é‡è™šæ‹Ÿæœº</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="171-åŸºæœ¬ä½¿ç”¨">17.1. åŸºæœ¬ä½¿ç”¨<a href="#171-åŸºæœ¬ä½¿ç”¨" class="hash-link" aria-label="17.1. åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥" title="17.1. åŸºæœ¬ä½¿ç”¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://www.vagrantup.com/downloads.html" target="_blank" rel="noopener noreferrer">https://www.vagrantup.com/downloads.html</a> ä¸‹è½½
<a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="noopener noreferrer">https://www.virtualbox.org/wiki/Downloads</a> virtualbox ä¸‹è½½
<a href="https://learn.hashicorp.com/collections/vagrant/getting-started" target="_blank" rel="noopener noreferrer">https://learn.hashicorp.com/collections/vagrant/getting-started</a> å…¥é—¨</p><p><a href="http://www.vagrantbox.es/" target="_blank" rel="noopener noreferrer">http://www.vagrantbox.es/</a> æœç´¢ box
<a href="https://app.vagrantup.com/boxes/search" target="_blank" rel="noopener noreferrer">https://app.vagrantup.com/boxes/search</a> æœç´¢ box
<a href="https://c4ys.com/archives/1230" target="_blank" rel="noopener noreferrer">https://c4ys.com/archives/1230</a> å›½å†…é•œåƒæ”¶é›† (<a href="http://mirrors.ustc.edu.cn/centos-cloud/centos/7/vagrant/x86_64/images/" target="_blank" rel="noopener noreferrer">æ¸…å centos</a>)</p><p>å¦‚ä½•æ‰‹åŠ¨ä¸‹è½½ box?
ä¾‹å¦‚ æ‰¾åˆ° kali çš„ box é¡µé¢ <a href="https://app.vagrantup.com/kalilinux/boxes/rolling" target="_blank" rel="noopener noreferrer">https://app.vagrantup.com/kalilinux/boxes/rolling</a>, ç‚¹è¿› æŒ‡å®šç‰ˆæœ¬çš„é¡µé¢ <a href="https://app.vagrantup.com/kalilinux/boxes/rolling/versions/2020.4.0" target="_blank" rel="noopener noreferrer">https://app.vagrantup.com/kalilinux/boxes/rolling/versions/2020.4.0</a> , é‚£ä¹ˆå¯ä»¥ <code>curl -L https://app.vagrantup.com/kalilinux/boxes/rolling/versions/2020.4.0/providers/virtualbox.box -O kali-2020.4.0.box</code></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># verify the installation</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant -v  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant box list # list all available vm</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸‹è½½å¥½ box æ–‡ä»¶ç„¶å</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åŠ è½½åˆ° vagrant</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant box add &lt;xxx_box_name&gt; &lt;box_file_Url_path&gt;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant init &lt;xxx_box_name&gt;         #åˆå§‹åŒ–, create a vagrantfile in current folder</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant up        # å¯åŠ¨ç¯å¢ƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¹Ÿå¯ä»¥ä¸ä¸‹è½½ box file, ç›´æ¥ init a box (box name can be find from some website), ä½†æ˜¯å¯èƒ½å¾ˆæ…¢</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant init centos/7</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant up # å¯åŠ¨çš„ç³»ç»Ÿ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½¿ç”¨ vagrant ç”¨æˆ·è¿æ¥ è™šæ‹Ÿæœº , ä¸ç”¨å¯†ç , è‹¥ä»…ä»…ä¸€ä¸ª machine, æ— éœ€æŒ‡å®š machine name</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ‡æ¢ root, ä¹Ÿå¯ä½¿ç”¨ root/vagrant ç™»å½• or : sudo su</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant ssh [machine_name]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant upload &lt;source&gt; [dest] [name|id] # ä¸Šä¼ æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant reload # é‡å¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant halt  # å…³é—­è™šæ‹Ÿæœº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant status  # æŸ¥çœ‹è™šæ‹Ÿæœºè¿è¡ŒçŠ¶æ€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant destroy  # é”€æ¯å½“å‰è™šæ‹Ÿæœº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰“åŒ…è‡ªå·±çš„ box è¿›è¡Œåˆ†å‘, æ‰“åŒ…å®Œæˆåä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸€ä¸ª package.box çš„æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant package</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸Šä¼ , é»˜è®¤ä¼ åˆ° vagrant home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vagrant upload xxx_file [dest_path]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="172-vagrant-è®¾ç½®-ip">17.2. vagrant è®¾ç½® ip<a href="#172-vagrant-è®¾ç½®-ip" class="hash-link" aria-label="17.2. vagrant è®¾ç½® ipçš„ç›´æ¥é“¾æ¥" title="17.2. vagrant è®¾ç½® ipçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>é…ç½®è™šæ‹Ÿæœºä¸ºå›ºå®š ip: ä¿®æ”¹ vagrantfile , é…ç½®ä¸ºç§æœ‰ç½‘ç»œ (éœ€è¦å…ˆä½¿ç”¨ virtualbox çš„ä¸»æœºç½‘ç»œç®¡ç†å™¨é…ç½®æ–°å¢ hostonly ç½‘ç»œ)</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">vm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">network</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;private_network&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">ip</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;virtualbox_host_only_ip&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>virtualbox_host_only_ip å°±æ˜¯ å®¿ä¸»æœº ä¸­ virtualbox çš„ hostonly ip, å¦‚ 192.168.56.1/24</p><p>å…¶å® Vagrant ä¸­ä¸€å…±æœ‰ä¸‰ç§ç½‘ç»œé…ç½®, </p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">ç«¯å£æ˜ å°„</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token maybe-class-name">Forwarded</span><span class="token plain"> port</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">vm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">forwarded_port</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">80</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8080</span><span class="token plain">   å°†è®¿é—®å®¿ä¸»è®¡ç®—æœº</span><span class="token number" style="color:rgb(9, 134, 88)">8080</span><span class="token plain">ç«¯å£çš„è¯·æ±‚éƒ½è½¬å‘åˆ°è™šæ‹Ÿæœºçš„</span><span class="token number" style="color:rgb(9, 134, 88)">80</span><span class="token plain">ç«¯å£ä¸Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">vm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">forwarded_port</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">80</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8080</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">protocol</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;udp&quot;</span><span class="token plain">    é»˜è®¤åªè½¬å‘</span><span class="token constant" style="color:rgb(129, 31, 63)">TCP</span><span class="token plain">åŒ…ï¼Œ</span><span class="token constant" style="color:rgb(129, 31, 63)">UDP</span><span class="token plain">éœ€è¦é¢å¤–æ·»åŠ ä»¥ä¸‹è¯­å¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">å¥½å¤„</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ç®€å•æ˜“ç†è§£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å®¹æ˜“å®ç°å¤–ç½‘è®¿é—®è™šæ‹Ÿæœº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">åå¤„</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å¦‚æœä¸€ä¸¤ä¸ªç«¯å£éœ€è¦æ˜ å°„å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯å¦‚æœæœ‰æœ‰å¾ˆå¤šç«¯å£ï¼Œæ¯”å¦‚MySQLï¼ŒMongoDBï¼Œtomcatç­‰æœåŠ¡ï¼Œç«¯å£æ¯”è¾ƒå¤šæ—¶ï¼Œå°±æ¯”è¾ƒéº»çƒ¦ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ä¸æ”¯æŒåœ¨å®¿ä¸»æœºå™¨ä¸Šä½¿ç”¨å°äº</span><span class="token number" style="color:rgb(9, 134, 88)">1024</span><span class="token plain">çš„ç«¯å£æ¥è½¬å‘ã€‚æ¯”å¦‚ï¼šä¸èƒ½ä½¿ç”¨</span><span class="token constant" style="color:rgb(129, 31, 63)">SSL</span><span class="token plain">çš„</span><span class="token number" style="color:rgb(9, 134, 88)">443</span><span class="token plain">ç«¯å£æ¥è¿›è¡Œhttpsè¿æ¥ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ç§æœ‰ç½‘ç»œï¼ˆPrivate networkï¼‰ï¼Œåªæœ‰ä¸»æœºå¯ä»¥è®¿é—®è™šæ‹Ÿæœºï¼Œå¦‚æœå¤šä¸ªè™šæ‹Ÿæœºè®¾å®šåœ¨åŒä¸€ä¸ªç½‘æ®µä¹Ÿå¯ä»¥äº’ç›¸è®¿é—®ï¼Œå½“ç„¶è™šæ‹Ÿæœºæ˜¯å¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œçš„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">vm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">network</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;private_network&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">ip</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;192.168.50.4&quot;</span><span class="token plain">   è¿™é‡Œ ip ä¸º å®¿ä¸»æœº ä¸Š virtualbox å¯¹åº”çš„ host only ip åœ°å€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">å¥½å¤„</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å®‰å…¨ï¼Œåªæœ‰è‡ªå·±èƒ½è®¿é—®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">åå¤„</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å› ä¸ºç§æœ‰çš„åŸå› ï¼Œæ‰€ä»¥å›¢é˜Ÿæˆå‘˜å…¶ä»–äººä¸èƒ½å’Œä½ å†™ä½œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">å…¬æœ‰ç½‘ç»œï¼ˆPublic networkï¼‰ï¼Œè™šæ‹Ÿæœºäº«å—å®ä½“æœºå™¨ä¸€æ ·çš„å¾…é‡ï¼Œä¸€æ ·çš„ç½‘ç»œé…ç½®ï¼Œvagrant1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">ç‰ˆæœ¬ä¹‹åä¹Ÿå¯ä»¥è®¾å®šé™æ€</span><span class="token constant" style="color:rgb(129, 31, 63)">IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">vm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">network</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;public_network&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">ip</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;192.168.1.120&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">å…¬æœ‰ç½‘ç»œä¸­è¿˜å¯ä»¥è®¾ç½®æ¡¥æ¥çš„ç½‘å¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">vm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">network</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;public_network&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token parameter">bridge</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;en1: Wi-Fi (AirPort)&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">å¥½å¤„</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">æ–¹ä¾¿å›¢é˜Ÿåä½œï¼Œåˆ«äººå¯ä»¥è®¿é—®ä½ çš„è™šæ‹Ÿæœº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token literal-property property">åå¤„</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">éœ€è¦æœ‰ç½‘ç»œï¼Œæœ‰è·¯ç”±å™¨åˆ†é…</span><span class="token constant" style="color:rgb(129, 31, 63)">IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="173-virtualboxå››ç§ç½‘ç»œæ¨¡å¼">17.3. VirtualBoxå››ç§ç½‘ç»œæ¨¡å¼<a href="#173-virtualboxå››ç§ç½‘ç»œæ¨¡å¼" class="hash-link" aria-label="17.3. VirtualBoxå››ç§ç½‘ç»œæ¨¡å¼çš„ç›´æ¥é“¾æ¥" title="17.3. VirtualBoxå››ç§ç½‘ç»œæ¨¡å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p><a href="https://blog.csdn.net/qq_28513801/article/details/90138491" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_28513801/article/details/90138491</a></p><h1>18. kali</h1><p><a href="http://uni.mirrors.163.com/kali-images/kali-2020.4/" target="_blank" rel="noopener noreferrer">http://uni.mirrors.163.com/kali-images/kali-2020.4/</a>
<a href="http://mirrors.ustc.edu.cn/kali-images/" target="_blank" rel="noopener noreferrer">http://mirrors.ustc.edu.cn/kali-images/</a>
<a href="http://old.kali.org/kali-images/kali-2020.4/" target="_blank" rel="noopener noreferrer">http://old.kali.org/kali-images/kali-2020.4/</a></p><p><a href="https://www.kali.org/docs/virtualization/install-virtualbox-guest-vm/" target="_blank" rel="noopener noreferrer">https://www.kali.org/docs/virtualization/install-virtualbox-guest-vm/</a></p><p>é»˜è®¤ç”¨æˆ·åæ˜¯ rootï¼Œé»˜è®¤å¯†ç æ˜¯ toor
kali/kali</p><h1>19. è™šæ‹Ÿç½‘å¡ macvlan</h1><p><a href="https://fuckcloudnative.io/posts/netwnetwork-virtualization-macvlan/" target="_blank" rel="noopener noreferrer">https://fuckcloudnative.io/posts/netwnetwork-virtualization-macvlan/</a></p><h1>20. Multipass</h1><p>ç±»ä¼¼ vagrant, å¿«é€Ÿè·å– Linux ç¯å¢ƒ</p><p><a href="https://www.chenmo.com.cn/402492" target="_blank" rel="noopener noreferrer">https://www.chenmo.com.cn/402492</a></p><h1>21. drone</h1><p>åŸºäº docker çš„æŒç»­é›†æˆ ci/cd å·¥å…·</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/docker">docker</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£åˆ†é¡µå¯¼èˆª"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/distributed-system"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">Distributed System åˆ†å¸ƒå¼</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/effective-java-reading-note"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">Effective Java é˜…è¯»ç¬”è®°</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#41-åŸºæœ¬æ¶æ„" class="table-of-contents__link toc-highlight">4.1. åŸºæœ¬æ¶æ„</a></li><li><a href="#42-ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„" class="table-of-contents__link toc-highlight">4.2. ä½¿ç”¨åœºæ™¯-å¾—åˆ°ä»€ä¹ˆå¥½å¤„</a></li><li><a href="#43-å®¹å™¨å®ç°çš„åŸç†" class="table-of-contents__link toc-highlight">4.3. å®¹å™¨å®ç°çš„åŸç†</a></li><li><a href="#51-ubuntu-22-install-docker" class="table-of-contents__link toc-highlight">5.1. ubuntu 22 install docker</a></li><li><a href="#52-ä½¿ç”¨å›½å†…é•œåƒ" class="table-of-contents__link toc-highlight">5.2. ä½¿ç”¨å›½å†…é•œåƒ</a></li><li><a href="#61-packaging-image-å¯¼å…¥å¯¼å‡º" class="table-of-contents__link toc-highlight">6.1. packaging image å¯¼å…¥å¯¼å‡º</a></li><li><a href="#62-ç‰ˆæœ¬å‘½åæ„ä¹‰" class="table-of-contents__link toc-highlight">6.2. ç‰ˆæœ¬å‘½åæ„ä¹‰</a></li><li><a href="#63-é•œåƒå®ç°åŸç†" class="table-of-contents__link toc-highlight">6.3. é•œåƒå®ç°åŸç†</a></li><li><a href="#64-è·å–é•œåƒ" class="table-of-contents__link toc-highlight">6.4. è·å–é•œåƒ</a></li><li><a href="#65-è¿è¡Œé•œåƒ" class="table-of-contents__link toc-highlight">6.5. è¿è¡Œé•œåƒ</a></li><li><a href="#66-åˆ—å‡ºé•œåƒ" class="table-of-contents__link toc-highlight">6.6. åˆ—å‡ºé•œåƒ</a></li><li><a href="#67-åˆ é™¤æœ¬åœ°é•œåƒ" class="table-of-contents__link toc-highlight">6.7. åˆ é™¤æœ¬åœ°é•œåƒ</a></li><li><a href="#71-work-with-golang" class="table-of-contents__link toc-highlight">7.1. work with golang</a></li><li><a href="#72-working-with-frontend" class="table-of-contents__link toc-highlight">7.2. working with frontend</a></li><li><a href="#73-æœ€ä½³å®è·µ-ä¼˜åŒ–ä½“ç§¯" class="table-of-contents__link toc-highlight">7.3. æœ€ä½³å®è·µ ä¼˜åŒ–ä½“ç§¯</a></li><li><a href="#74-é€šè¿‡-dockerfile-æ¥-build-é•œåƒ" class="table-of-contents__link toc-highlight">7.4. é€šè¿‡ dockerfile æ¥ build é•œåƒ</a></li><li><a href="#75-commitå®¹å™¨æˆä¸ºé•œåƒä¸æ¨è" class="table-of-contents__link toc-highlight">7.5. commitå®¹å™¨æˆä¸ºé•œåƒ(ä¸æ¨è)</a></li><li><a href="#76-ä»å‹ç¼©åŒ…å¯¼å…¥" class="table-of-contents__link toc-highlight">7.6. ä»å‹ç¼©åŒ…å¯¼å…¥</a></li><li><a href="#77-docker-save-å’Œ-docker-load" class="table-of-contents__link toc-highlight">7.7. docker save å’Œ docker load</a></li><li><a href="#81-from" class="table-of-contents__link toc-highlight">8.1. from</a></li><li><a href="#82-é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡context" class="table-of-contents__link toc-highlight">8.2. é•œåƒçš„æ„å»ºä¸Šä¸‹æ–‡context</a><ul><li><a href="#821-dockerignore" class="table-of-contents__link toc-highlight">8.2.1. dockerignore</a></li></ul></li><li><a href="#83-copy-å’Œ-add" class="table-of-contents__link toc-highlight">8.3. COPY å’Œ ADD</a></li><li><a href="#84-workdir-æŒ‡å®šå·¥ä½œç›®å½•" class="table-of-contents__link toc-highlight">8.4. WORKDIR æŒ‡å®šå·¥ä½œç›®å½•</a></li><li><a href="#85-run-cmd-å’Œ-entrypoint-å®¹å™¨å¯åŠ¨å‘½ä»¤" class="table-of-contents__link toc-highlight">8.5. run cmd å’Œ entrypoint å®¹å™¨å¯åŠ¨å‘½ä»¤</a><ul><li><a href="#851-è®¾ç½®æ—¶åŒº" class="table-of-contents__link toc-highlight">8.5.1. è®¾ç½®æ—¶åŒº</a></li><li><a href="#852-å¸¸è§çš„é”™è¯¯ç”¨æ³•" class="table-of-contents__link toc-highlight">8.5.2. å¸¸è§çš„é”™è¯¯ç”¨æ³•</a></li><li><a href="#853-éƒ½æ”¯æŒä¸¤ç§æ ¼å¼-shell-å’Œ-exec-çš„åŒºåˆ«" class="table-of-contents__link toc-highlight">8.5.3. éƒ½æ”¯æŒä¸¤ç§æ ¼å¼ shell å’Œ exec çš„åŒºåˆ«</a></li><li><a href="#854-run" class="table-of-contents__link toc-highlight">8.5.4. run</a><ul><li><a href="#8541-å…¸å‹é”™è¯¯" class="table-of-contents__link toc-highlight">8.5.4.1. å…¸å‹é”™è¯¯</a></li></ul></li><li><a href="#855-cmdæŒ‡ä»¤" class="table-of-contents__link toc-highlight">8.5.5. cmdæŒ‡ä»¤</a></li><li><a href="#856-entrypoint-å…¥å£ç‚¹" class="table-of-contents__link toc-highlight">8.5.6. ENTRYPOINT å…¥å£ç‚¹</a><ul><li><a href="#8561-eg-è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨" class="table-of-contents__link toc-highlight">8.5.6.1. eg: è®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨</a></li><li><a href="#8562-eg-åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œ" class="table-of-contents__link toc-highlight">8.5.6.2. eg: åº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œ</a></li></ul></li></ul></li><li><a href="#86-env-å’Œ-arg-è®¾ç½®å˜é‡" class="table-of-contents__link toc-highlight">8.6. ENV å’Œ arg è®¾ç½®å˜é‡</a></li><li><a href="#87-volume-å®šä¹‰åŒ¿åæ•°æ®å·" class="table-of-contents__link toc-highlight">8.7. VOLUME å®šä¹‰åŒ¿åæ•°æ®å·</a></li><li><a href="#88-expose-å£°æ˜ç«¯å£" class="table-of-contents__link toc-highlight">8.8. EXPOSE å£°æ˜ç«¯å£</a></li><li><a href="#89-user-æŒ‡å®šå½“å‰ç”¨æˆ·" class="table-of-contents__link toc-highlight">8.9. USER æŒ‡å®šå½“å‰ç”¨æˆ·</a></li><li><a href="#810-healthcheck-å¥åº·æ£€æŸ¥" class="table-of-contents__link toc-highlight">8.10. HEALTHCHECK å¥åº·æ£€æŸ¥</a></li><li><a href="#811-onbuild-ç»™åˆ«äººç”¨" class="table-of-contents__link toc-highlight">8.11. ONBUILD ç»™åˆ«äººç”¨</a></li><li><a href="#812-multi-stage-å¤šé˜¶æ®µæ„å»º" class="table-of-contents__link toc-highlight">8.12. multi-stage å¤šé˜¶æ®µæ„å»º</a><ul><li><a href="#8121-æ¸…ç†ç¼“å­˜çš„é•œåƒ" class="table-of-contents__link toc-highlight">8.12.1. æ¸…ç†ç¼“å­˜çš„é•œåƒ</a></li></ul></li><li><a href="#91-use-docker-in-github-action" class="table-of-contents__link toc-highlight">9.1. use docker in github action</a></li><li><a href="#92-æŸ¥çœ‹" class="table-of-contents__link toc-highlight">9.2. æŸ¥çœ‹</a></li><li><a href="#93-å¯åŠ¨" class="table-of-contents__link toc-highlight">9.3. å¯åŠ¨</a><ul><li><a href="#931--it-ç»´æŒäº¤äº’ç»ˆç«¯" class="table-of-contents__link toc-highlight">9.3.1. -it ç»´æŒäº¤äº’ç»ˆç«¯</a></li><li><a href="#932--d-åå°è¿è¡Œ" class="table-of-contents__link toc-highlight">9.3.2. -d åå°è¿è¡Œ</a></li><li><a href="#933---privilegedtrue-èµ‹äºˆç‰¹æƒ" class="table-of-contents__link toc-highlight">9.3.3. --privileged=true èµ‹äºˆç‰¹æƒ</a></li></ul></li><li><a href="#94-ç»ˆæ­¢container" class="table-of-contents__link toc-highlight">9.4. ç»ˆæ­¢container</a></li><li><a href="#95-åˆ é™¤container" class="table-of-contents__link toc-highlight">9.5. åˆ é™¤container</a></li><li><a href="#96-è¿›å…¥å®¹å™¨" class="table-of-contents__link toc-highlight">9.6. è¿›å…¥å®¹å™¨</a></li><li><a href="#97-å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡º" class="table-of-contents__link toc-highlight">9.7. å®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡º</a></li><li><a href="#98-æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœº" class="table-of-contents__link toc-highlight">9.8. æ‹·è´å®¹å™¨å†…æ–‡ä»¶åˆ°ä¸»æœº</a></li><li><a href="#101-dockerhub" class="table-of-contents__link toc-highlight">10.1. dockerhub</a><ul><li><a href="#1011-publish-by-using-github-action" class="table-of-contents__link toc-highlight">10.1.1. publish by using github action</a></li></ul></li><li><a href="#102-ç§æœ‰ä»“åº“" class="table-of-contents__link toc-highlight">10.2. ç§æœ‰ä»“åº“</a><ul><li><a href="#allow-http" class="table-of-contents__link toc-highlight">allow http</a></li><li><a href="#harboræ¨è" class="table-of-contents__link toc-highlight">harbor(æ¨è)</a><ul><li><a href="#k8s-é…ç½®harbor" class="table-of-contents__link toc-highlight">k8s é…ç½®harbor</a></li></ul></li><li><a href="#nexus" class="table-of-contents__link toc-highlight">Nexus</a></li><li><a href="#docker-registry" class="table-of-contents__link toc-highlight">docker-registry</a></li></ul></li><li><a href="#111-æ•°æ®å·" class="table-of-contents__link toc-highlight">11.1. æ•°æ®å·</a></li><li><a href="#112-æŒ‚è½½ä¸»æœºç›®å½•" class="table-of-contents__link toc-highlight">11.2. æŒ‚è½½ä¸»æœºç›®å½•</a></li><li><a href="#113-volume-çš„å…±äº«" class="table-of-contents__link toc-highlight">11.3. volume çš„å…±äº«</a></li><li><a href="#121-docker-é»˜è®¤åˆå§‹åˆ›å»º3-ä¸ªç½‘ç»œ" class="table-of-contents__link toc-highlight">12.1. docker é»˜è®¤åˆå§‹åˆ›å»º3 ä¸ªç½‘ç»œ</a></li><li><a href="#124-åˆ›å»ºå›ºå®šip" class="table-of-contents__link toc-highlight">12.4. åˆ›å»ºå›ºå®šip</a></li><li><a href="#125-æŸ¥çœ‹containerçš„ip" class="table-of-contents__link toc-highlight">12.5. æŸ¥çœ‹containerçš„ip</a></li><li><a href="#126-å¤–éƒ¨è®¿é—®å®¹å™¨" class="table-of-contents__link toc-highlight">12.6. å¤–éƒ¨è®¿é—®å®¹å™¨</a></li><li><a href="#127-å®¹å™¨äº’è”" class="table-of-contents__link toc-highlight">12.7. å®¹å™¨äº’è”</a></li><li><a href="#128-é…ç½®dns-å’Œ-ä¸»æœºå-hostname" class="table-of-contents__link toc-highlight">12.8. é…ç½®dns å’Œ ä¸»æœºå hostname</a></li><li><a href="#131-some-significant-materials" class="table-of-contents__link toc-highlight">13.1. some significant materials</a></li><li><a href="#132-composeç®€ä»‹" class="table-of-contents__link toc-highlight">13.2. composeç®€ä»‹</a></li><li><a href="#133-å‘½ä»¤ä½¿ç”¨" class="table-of-contents__link toc-highlight">13.3. å‘½ä»¤ä½¿ç”¨</a><ul><li><a href="#1331-up" class="table-of-contents__link toc-highlight">13.3.1. up</a></li><li><a href="#1332-run" class="table-of-contents__link toc-highlight">13.3.2. run</a></li><li><a href="#1333-scale" class="table-of-contents__link toc-highlight">13.3.3. scale</a></li><li><a href="#1334-start" class="table-of-contents__link toc-highlight">13.3.4. start</a></li><li><a href="#1335-build" class="table-of-contents__link toc-highlight">13.3.5. build</a></li><li><a href="#1336-config" class="table-of-contents__link toc-highlight">13.3.6. config</a></li><li><a href="#1337-exec" class="table-of-contents__link toc-highlight">13.3.7. exec</a></li><li><a href="#1338-images" class="table-of-contents__link toc-highlight">13.3.8. images</a></li><li><a href="#1339-kill" class="table-of-contents__link toc-highlight">13.3.9. kill</a></li><li><a href="#13310-down" class="table-of-contents__link toc-highlight">13.3.10. down</a></li><li><a href="#13311-pause" class="table-of-contents__link toc-highlight">13.3.11. pause</a></li><li><a href="#13312-unpause" class="table-of-contents__link toc-highlight">13.3.12. unpause</a></li><li><a href="#13313-restart" class="table-of-contents__link toc-highlight">13.3.13. restart</a></li><li><a href="#13314-stop" class="table-of-contents__link toc-highlight">13.3.14. stop</a></li><li><a href="#13315-rm" class="table-of-contents__link toc-highlight">13.3.15. rm</a></li><li><a href="#13316-logs" class="table-of-contents__link toc-highlight">13.3.16. logs</a></li><li><a href="#13317-top" class="table-of-contents__link toc-highlight">13.3.17. top</a></li><li><a href="#13318-version" class="table-of-contents__link toc-highlight">13.3.18. version</a></li><li><a href="#13319-port" class="table-of-contents__link toc-highlight">13.3.19. port</a></li><li><a href="#13320-ps" class="table-of-contents__link toc-highlight">13.3.20. ps</a></li><li><a href="#13321-pull" class="table-of-contents__link toc-highlight">13.3.21. pull</a></li><li><a href="#13322-push" class="table-of-contents__link toc-highlight">13.3.22. push</a></li></ul></li><li><a href="#134-docker-composeyml" class="table-of-contents__link toc-highlight">13.4. docker-compose.yml</a></li><li><a href="#nacos" class="table-of-contents__link toc-highlight">nacos</a></li><li><a href="#161-æ­å»ºæŒç»­é›†æˆç³»ç»Ÿ" class="table-of-contents__link toc-highlight">16.1. æ­å»ºæŒç»­é›†æˆç³»ç»Ÿ</a></li><li><a href="#162-dockerå’Œspringboot" class="table-of-contents__link toc-highlight">16.2. dockerå’Œspringboot</a></li><li><a href="#163-oracle11g" class="table-of-contents__link toc-highlight">16.3. oracle11g</a></li><li><a href="#164-ä½¿ç”¨-mysql-é•œåƒ" class="table-of-contents__link toc-highlight">16.4. ä½¿ç”¨ mysql é•œåƒ</a></li><li><a href="#165-ä½¿ç”¨postgresé•œåƒ" class="table-of-contents__link toc-highlight">16.5. ä½¿ç”¨postgresé•œåƒ</a></li><li><a href="#166-ä½¿ç”¨-rabbitmqé•œåƒ" class="table-of-contents__link toc-highlight">16.6. ä½¿ç”¨ rabbitmqé•œåƒ</a></li><li><a href="#167-redisé•œåƒ" class="table-of-contents__link toc-highlight">16.7. redisé•œåƒ</a></li><li><a href="#168-ubuntué•œåƒ" class="table-of-contents__link toc-highlight">16.8. ubuntué•œåƒ</a></li><li><a href="#169-zookeeper" class="table-of-contents__link toc-highlight">16.9. zookeeper</a></li><li><a href="#1610-kafka" class="table-of-contents__link toc-highlight">16.10. kafka</a></li><li><a href="#1611-rabbitmq" class="table-of-contents__link toc-highlight">16.11. rabbitmq</a></li><li><a href="#1612-zipkin" class="table-of-contents__link toc-highlight">16.12. zipkin</a></li><li><a href="#1613-nginx" class="table-of-contents__link toc-highlight">16.13. nginx</a></li><li><a href="#1614-mongodb" class="table-of-contents__link toc-highlight">16.14. mongodb</a></li><li><a href="#1615-gitlab" class="table-of-contents__link toc-highlight">16.15. gitlab</a></li><li><a href="#1616-etcd" class="table-of-contents__link toc-highlight">16.16. etcd</a></li><li><a href="#1617-influxdb" class="table-of-contents__link toc-highlight">16.17. influxdb</a></li><li><a href="#171-åŸºæœ¬ä½¿ç”¨" class="table-of-contents__link toc-highlight">17.1. åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#172-vagrant-è®¾ç½®-ip" class="table-of-contents__link toc-highlight">17.2. vagrant è®¾ç½® ip</a></li><li><a href="#173-virtualboxå››ç§ç½‘ç»œæ¨¡å¼" class="table-of-contents__link toc-highlight">17.3. VirtualBoxå››ç§ç½‘ç»œæ¨¡å¼</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">å†å²</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tags">æ ‡ç­¾</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">å½’æ¡£</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾äº¤åª’ä½“</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">å…³äºæˆ‘</a></li><li class="footer__item"><a href="https://github.com/xiaoyureed" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/xiaoyuhfq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/3fPgwd3naN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/friends">å‹é“¾</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/resource">å¯¼èˆª</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Xiaoyureed, Inc. Built with â¤ï¸ by xiaoyu.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fcfce0fe.js"></script>
<script src="/assets/js/main.c0b909ce.js"></script>
</body>
</html>