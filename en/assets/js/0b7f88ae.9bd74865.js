"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[5639],{3905:function(e,t,a){a.d(t,{Zo:function(){return s},kt:function(){return c}});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),u=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},s=function(e){var t=u(e.components);return r.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,p=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),d=u(a),c=n,k=d["".concat(p,".").concat(c)]||d[c]||m[c]||i;return a?r.createElement(k,l(l({ref:t},s),{},{components:a})):r.createElement(k,l({ref:t},s))}));function c(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,l=new Array(i);l[0]=d;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:n,l[1]=o;for(var u=2;u<i;u++)l[u]=a[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},93481:function(e,t,a){a.r(t),a.d(t,{assets:function(){return s},contentTitle:function(){return p},default:function(){return c},frontMatter:function(){return o},metadata:function(){return u},toc:function(){return m}});var r=a(83117),n=a(80102),i=(a(67294),a(3905)),l=["components"],o={title:"Task Schedule",tags:["schedule"],date:new Date("2016-05-01T22:38:07.000Z"),toc_min_heading_level:2,toc_max_heading_level:5},p=void 0,u={unversionedId:"task-schedule-note",id:"task-schedule-note",title:"Task Schedule",description:"\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf \u603b\u7ed3",source:"@site/docs/task-schedule-note.md",sourceDirName:".",slug:"/task-schedule-note",permalink:"/en/docs/task-schedule-note",draft:!1,tags:[{label:"schedule",permalink:"/en/docs/tags/schedule"}],version:"current",frontMatter:{title:"Task Schedule",tags:["schedule"],date:"2016-05-01T22:38:07.000Z",toc_min_heading_level:2,toc_max_heading_level:5},sidebar:"tutorialSidebar",previous:{title:"Spring MVC",permalink:"/en/docs/springmvc-note"},next:{title:"TCP IP",permalink:"/en/docs/tcp-ip-note"}},s={},m=[{value:"java.util.Timer",id:"javautiltimer",level:2},{value:"Quartz",id:"quartz",level:2},{value:"\u51c6\u5907\u5de5\u4f5c",id:"\u51c6\u5907\u5de5\u4f5c",level:3},{value:"task\u7ee7\u627f\u81ea\u7279\u5b9a\u57fa\u7c7b",id:"task\u7ee7\u627f\u81ea\u7279\u5b9a\u57fa\u7c7b",level:3},{value:"task\u65e0\u9700\u7ee7\u627f\u57fa\u7c7b",id:"task\u65e0\u9700\u7ee7\u627f\u57fa\u7c7b",level:3},{value:"spring task",id:"spring-task",level:2},{value:"\u662f\u4ec0\u4e48",id:"\u662f\u4ec0\u4e48",level:2},{value:"quick start",id:"quick-start",level:2},{value:"\u6709\u7528\u7684\u6ce8\u89e3",id:"\u6709\u7528\u7684\u6ce8\u89e3",level:2},{value:"trigger",id:"trigger",level:2},{value:"quartz Calendars",id:"quartz-calendars",level:3},{value:"SimpleTrigger",id:"simpletrigger",level:3},{value:"CronTrigger",id:"crontrigger",level:3},{value:"TriggerListeners and JobListeners",id:"triggerlisteners-and-joblisteners",level:2},{value:"SchedulerListeners",id:"schedulerlisteners",level:2},{value:"Job Stores",id:"job-stores",level:2}],d={toc:m};function c(e){var t=e.components,a=(0,n.Z)(e,l);return(0,i.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{align:"center"},"\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf \u603b\u7ed3 https://www.ibm.com/developerworks/cn/java/j-lo-taskschedule/index.html"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#%E5%88%86%E7%B1%BB"},"\u5206\u7c7b")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#cronexpression"},"cronExpression")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B"},"\u7528\u6cd5\u793a\u4f8b"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#javautiltimer"},"java.util.Timer")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#quartz"},"Quartz"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"},"\u51c6\u5907\u5de5\u4f5c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#task%E7%BB%A7%E6%89%BF%E8%87%AA%E7%89%B9%E5%AE%9A%E5%9F%BA%E7%B1%BB"},"task\u7ee7\u627f\u81ea\u7279\u5b9a\u57fa\u7c7b")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#task%E6%97%A0%E9%9C%80%E7%BB%A7%E6%89%BF%E5%9F%BA%E7%B1%BB"},"task\u65e0\u9700\u7ee7\u627f\u57fa\u7c7b")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#spring-task"},"spring task")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#quartz-1"},"Quartz"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#%E6%98%AF%E4%BB%80%E4%B9%88"},"\u662f\u4ec0\u4e48")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#quick-start"},"quick start")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#%E6%9C%89%E7%94%A8%E7%9A%84%E6%B3%A8%E8%A7%A3"},"\u6709\u7528\u7684\u6ce8\u89e3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#trigger"},"trigger"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#quartz-calendars"},"quartz Calendars")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#simpletrigger"},"SimpleTrigger")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#crontrigger"},"CronTrigger")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#triggerlisteners-and-joblisteners"},"TriggerListeners and JobListeners")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#schedulerlisteners"},"SchedulerListeners")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#job-stores"},"Job Stores")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#springboot%E5%92%8Cquartz%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE"},"springboot\u548cquartz\u5b9e\u73b0\u52a8\u6001\u914d\u7f6e"))),(0,i.kt)("h1",{id:"\u5206\u7c7b"},"\u5206\u7c7b"),(0,i.kt)("p",null,"\u4e3a\u4e86\u7406\u89e3\u65b9\u4fbf, \u505a\u4e00\u4e0b\u5206\u7c7b, \u6839\u636e\u5b9e\u73b0\u6280\u672f\u5206\u7c7b:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Java\u81ea\u5e26\u7684java.util.Timer\u7c7b\uff0c\u8fd9\u4e2a\u7c7b\u5141\u8bb8\u4f60\u8c03\u5ea6\u4e00\u4e2ajava.util.TimerTask\u4efb\u52a1\u3002\u4e0d\u80fd\u6307\u5b9a\u65f6\u95f4\uff0c\u53ea\u80fd\u6307\u5b9a\u9891\u7387\u3002")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u4f7f\u7528Quartz\uff0c\u8fd9\u662f\u4e00\u4e2a\u529f\u80fd\u6bd4\u8f83\u5f3a\u5927\u7684\u7684\u8c03\u5ea6\u5668\uff0c\u53ef\u4ee5\u6307\u5b9a\u65f6\u95f4\u3001\u9891\u7387\u3002")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Spring3.0\u4ee5\u540e\u81ea\u5e26\u7684task\uff0c\u53ef\u4ee5\u5c06\u5b83\u770b\u6210\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684Quartz\uff0c\u800c\u4e14\u4f7f\u7528\u7b80\u5355\u3002"))),(0,i.kt)("p",null,"\u6839\u636e\u4efb\u52a1\u7c7b\u7ee7\u627f\u65b9\u5f0f\u5206\u7c7b:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u4efb\u52a1\u7c7b\u9700\u8981\u7ee7\u627f\u81ea\u7279\u5b9a\u7684\u57fa\u7c7b"),(0,i.kt)("p",{parentName:"li"},"\u6bd4\u5982\uff1a\nQuartz\u4e2d\u9700\u8981\u7ee7\u627f\u81ea",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.scheduling.quartz.QuartzJobBean"),"\uff1bjava.util.Timer\u4e2d\u9700\u8981\u7ee7\u627f\u81ea",(0,i.kt)("inlineCode",{parentName:"p"},"java.util.TimerTask"),"\u3002")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u4e0d\u9700\u8981\u7ee7\u627f, \u4efb\u52a1\u7c7b\u5c31\u662f\u666e\u901a\u7c7b"))),(0,i.kt)("p",null,"\u6307\u5b9a\u65f6\u95f4 or \u6307\u5b9a\u9891\u7387 :"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u6bcf\u9694\u6307\u5b9a\u65f6\u95f4\u5219\u89e6\u53d1\u4e00\u6b21\uff0c\u5728Quartz\u4e2d\u5bf9\u5e94\u7684\u89e6\u53d1\u5668\u4e3a\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.scheduling.quartz.SimpleTriggerBean"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u6bcf\u5230\u6307\u5b9a\u65f6\u95f4\u5219\u89e6\u53d1\u4e00\u6b21\uff0c\u5728Quartz\u4e2d\u5bf9\u5e94\u7684\u8c03\u5ea6\u5668\u4e3a\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.scheduling.quartz.CronTriggerBean")))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u6ce8\uff1a\njava.util.TimerTask\u4efb\u52a1\u5c31\u53ea\u80fd\u4f7f\u7528\u7b2c\u4e00\u79cd\u89e6\u53d1\u6761\u4ef6\u3002\nQuartz\u548cspring task\u90fd\u53ef\u4ee5\u652f\u6301\u8fd9\u4e24\u79cd\u89e6\u53d1\u6761\u4ef6\u3002")),(0,i.kt)("h1",{id:"cronexpression"},"cronExpression"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://cron.qqe2.com/"},"https://cron.qqe2.com/")," \u5728\u7ebf\u751f\u6210 cron"),(0,i.kt)("p",null,"cron \u8868\u8fbe\u5f0f"),(0,i.kt)("p",null,"\u683c\u5f0f: ",(0,i.kt)("inlineCode",{parentName:"p"},"{\u79d2\u6570} {\u5206\u949f} {\u5c0f\u65f6} {\u65e5\u671f} {\u6708\u4efd} {\u661f\u671f} {\u5e74\u4efd(\u53ef\u4e3a\u7a7a)}")),(0,i.kt)("p",null,"\u5404\u4e2a\u5360\u4f4d\u7b26\u89e3\u91ca:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"',(0,i.kt)("em",{parentName:"p"},'" \u7528\u6765\u6307\u6240\u6709\u503c, \u6bd4\u5982: "'),'"\u5728"\u5206\u949f"\u7684\u5b57\u6bb5\u91cc\u8868\u793a"\u6bcf\u5206\u949f"')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"-" \u6307\u5b9a\u4e00\u4e2a\u8303\u56f4, \u5982: "10-12"\u5728"\u5c0f\u65f6"\u5b57\u6bb5\u8868\u793a"10\u70b9, 11\u70b9, 12\u70b9"')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"," \u5206\u9694\u591a\u4e2a\u503c, \u5982: "MON,WED,FRI" \u5728\u661f\u671f\u91cc\u8868\u793a"\u5468\u4e00,\u4e09,\u4e94"')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"?" \u53ea\u5728 "\u65e5\u671f", "\u661f\u671f"\u5b57\u6bb5\u4f7f\u7528, \u6307"\u4e0d\u660e\u786e\u7684\u503c"')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"L" \u6307\u5b9a\u5728"\u6708"or"\u661f\u671f"\u7684\u6700\u540e\u4e00\u5929(last\u7f29\u5199)')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"W" \u79bb\u6307\u5b9a\u65e5\u671f\u6700\u8fd1\u7684\u661f\u671f\u65e5, \u53ea\u80fd\u5728"\u6708\u4efd"\u4e2d\u4f7f\u7528')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"#" \u53ea\u662f\u7528\u5728\u661f\u671f\u5b57\u6bb5,')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'"/" \u5982: 1/20: \u4ece\u7b2c\u4e00\u5355\u4f4d\u5f00\u59cb, \u6bcf\u969420\u4e2a\u5355\u4f4d, \u5c31\u89e6\u53d1\u4e00\u6b21; 10-45/20 : \u5728\u7b2c10\u523045\u5355\u4f4d\u5185\uff0c\u6bcf\u969420\u5355\u4f4d\u89e6\u53d1\u4e00\u6b21\uff0c\u8d85\u8fc7\u7b2c45\u5355\u4f4d\uff0c\u5219\u65e0\u6548\u4e86'))),(0,i.kt)("p",null,"\u770b\u770b\u51e0\u4e2a cron \u8868\u8fbe\u5f0f demo:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'CRON\u8868\u8fbe\u5f0f                  \u542b\u4e49 \n"0 0 12 * * ?"          \u6bcf\u5929\u4e2d\u5348\u5341\u4e8c\u70b9\u89e6\u53d1 \n"0 15 10 ? * *"         \u6bcf\u5929\u65e9\u4e0a10\uff1a15\u89e6\u53d1 \n"0 15 10 * * ?"         \u6bcf\u5929\u65e9\u4e0a10\uff1a15\u89e6\u53d1 \n"0 15 10 * * ? *"       \u6bcf\u5929\u65e9\u4e0a10\uff1a15\u89e6\u53d1 \n"0 15 10 * * ? 2005"    2005\u5e74\u7684\u6bcf\u5929\u65e9\u4e0a10\uff1a15\u89e6\u53d1 \n"0 * 14 * * ?"          \u6bcf\u5929\u4ece\u4e0b\u53482\u70b9\u5f00\u59cb\u52302\u70b959\u5206\u6bcf\u5206\u949f\u4e00\u6b21\u89e6\u53d1\n"0 0/5 * * * ?"         \u6bcf5min\u89e6\u53d1\u4e00\u6b21\n\u201c10 0/5 * * * ?\u201d        \u6bcf5min\u4e00\u6b21\u89e6\u53d1, \u5728\u6bcf\u5206\u949f\u7684\u7b2c 10s \u5f00\u59cb\u89e6\u53d1\n"0 0/5 14 * * ?"        \u6bcf\u5929\u4ece\u4e0b\u53482\u70b9\u5f00\u59cb\u52302\uff1a55\u5206\u7ed3\u675f\u6bcf5\u5206\u949f\u4e00\u6b21\u89e6\u53d1 \n"0 0/5 14,18 * * ?"     \u6bcf\u5929\u7684\u4e0b\u53482\u70b9\u81f32\uff1a55\u548c6\u70b9\u81f36\u70b955\u5206\u4e24\u4e2a\u65f6\u95f4\u6bb5\u5185\u6bcf5\u5206\u949f\u4e00\u6b21\u89e6\u53d1 \n"0 0-5 14 * * ?"        \u6bcf\u592914:00\u81f314:05\u6bcf\u5206\u949f\u4e00\u6b21\u89e6\u53d1 \n\u201c0 30 10-13 ? * WED,FRI\u201d    fires at 10:30, 11:30, 12:30, and 13:30, on every Wednesday and Friday.\n"0 10,44 14 ? 3 WED"    \u4e09\u6708\u7684\u6bcf\u5468\u4e09\u768414\uff1a10\u548c14\uff1a44\u89e6\u53d1 \n"0 15 10 ? * MON-FRI"   \u6bcf\u4e2a\u5468\u4e00\u3001\u5468\u4e8c\u3001\u5468\u4e09\u3001\u5468\u56db\u3001\u5468\u4e94\u768410\uff1a15\u89e6\u53d1\n\u201c0 0/30 8-9 5,20 * ?\u201d   \u6bcf\u4e2a\u6708\u7684 5\u53f7, 20\u53f7 \u7684 8\u70b9-10\u70b9\u6ca130min\u89e6\u53d1\u4e00\u6b21\n\n')),(0,i.kt)("h1",{id:"\u7528\u6cd5\u793a\u4f8b"},"\u7528\u6cd5\u793a\u4f8b"),(0,i.kt)("h2",{id:"javautiltimer"},"java.util.Timer"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"java.util.Timer"),"\n",(0,i.kt)("inlineCode",{parentName:"p"},"java.util.TimerTask")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Timer\u662f\u4e00\u4e2a\u5b9a\u65f6\u5668\u7c7b\uff0c\u901a\u8fc7\u8be5\u7c7b\u53ef\u4ee5\u4e3a\u6307\u5b9a\u7684\u5b9a\u65f6\u4efb\u52a1\u8fdb\u884c\u914d\u7f6e\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"TimerTask\u7c7b\u662f\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\u7c7b\uff0c\u8be5\u7c7b\u5b9e\u73b0\u4e86Runnable\u63a5\u53e3\uff0c\u800c\u4e14\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,i.kt)("p",{parentName:"li"},"public abstract class TimerTask implements Runnable\n\u53ef\u4ee5\u901a\u8fc7\u7ee7\u627f\u8be5\u7c7b\uff0c\u6765\u5b9e\u73b0\u81ea\u5df1\u7684\u5b9a\u65f6\u4efb\u52a1\u3002"))),(0,i.kt)("p",null,"Timer\u5b9a\u65f6\u5668\u5b9e\u4f8b\u6709\u591a\u79cd\u6784\u9020\u65b9\u6cd5\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Timer() \u521b\u5efa\u4e00\u4e2a\u65b0\u8ba1\u65f6\u5668\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Timer(boolean isDaemon) \u521b\u5efa\u4e00\u4e2a\u65b0\u8ba1\u65f6\u5668\uff0c\u53ef\u4ee5\u6307\u5b9a\u5176\u76f8\u5173\u7684\u7ebf\u7a0b\u4f5c\u4e3a\u5b88\u62a4\u7a0b\u5e8f\u8fd0\u884c\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Timer(String name) \u521b\u5efa\u4e00\u4e2a\u65b0\u8ba1\u65f6\u5668\uff0c\u5176\u76f8\u5173\u7684\u7ebf\u7a0b\u5177\u6709\u6307\u5b9a\u7684\u540d\u79f0\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Timer(String name, boolean isDaemon) \u521b\u5efa\u4e00\u4e2a\u65b0\u8ba1\u65f6\u5668\uff0c\u5176\u76f8\u5173\u7684\u7ebf\u7a0b\u5177\u6709\u6307\u5b9a\u7684\u540d\u79f0\uff0c\u5e76\u4e14\u53ef\u4ee5\u6307\u5b9a\u4f5c\u4e3a\u5b88\u62a4\u7a0b\u5e8f\u8fd0\u884c\u3002"))),(0,i.kt)("p",null,"Timer \u65b9\u6cd5:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u5728\u7279\u5b9a\u65f6\u95f4\u6267\u884c\u4efb\u52a1\uff0c\u53ea\u6267\u884c\u4e00\u6b21"),(0,i.kt)("p",{parentName:"li"},"public void schedule(TimerTask task,Date time)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u5728\u7279\u5b9a\u65f6\u95f4\u4e4b\u540e\u6267\u884c\u4efb\u52a1\uff0c\u53ea\u6267\u884c\u4e00\u6b21"),(0,i.kt)("p",{parentName:"li"},"public void schedule(TimerTask task,long delay)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u6307\u5b9a\u7b2c\u4e00\u6b21\u6267\u884c\u7684\u65f6\u95f4\uff0c\u7136\u540e\u6309\u7167\u95f4\u9694\u65f6\u95f4\uff0c\u91cd\u590d\u6267\u884c"),(0,i.kt)("p",{parentName:"li"},"public void schedule(TimerTask task,Date firstTime,long period)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u5728\u7279\u5b9a\u5ef6\u8fdf\u4e4b\u540e\u7b2c\u4e00\u6b21\u6267\u884c\uff0c\u7136\u540e\u6309\u7167\u95f4\u9694\u65f6\u95f4\uff0c\u91cd\u590d\u6267\u884c"),(0,i.kt)("p",{parentName:"li"},"public void schedule(TimerTask task,long delay,long period)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u7b2c\u4e00\u6b21\u6267\u884c\u4e4b\u540e\uff0c\u7279\u5b9a\u9891\u7387\u6267\u884c\uff0c\u4e0e3\u540c"),(0,i.kt)("p",{parentName:"li"},"public void scheduleAtFixedRate(TimerTask task,Date firstTime,long period)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u5728delay\u6beb\u79d2\u4e4b\u540e\u7b2c\u4e00\u6b21\u6267\u884c\uff0c\u540e\u6309\u7167\u7279\u5b9a\u9891\u7387\u6267\u884c"),(0,i.kt)("p",{parentName:"li"},"public void scheduleAtFixedRate(TimerTask task,long delay,long period)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Timer\u6ce8\u9500\uff1atimer.cancle();"))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u6ce8:\nschedule() & scheduleAtFixedRate()\u4e24\u8005\u7684\u533a\u522b\uff1a\n<1>schedule()\u65b9\u6cd5\u66f4\u6ce8\u91cd\u4fdd\u6301\u95f4\u9694\u65f6\u95f4\u7684\u7a33\u5b9a\uff1a\u4fdd\u969c\u6bcf\u9694period\u65f6\u95f4\u53ef\u8c03\u7528\u4e00\u6b21\n<2>scheduleAtFixedRate()\u65b9\u6cd5\u66f4\u6ce8\u91cd\u4fdd\u6301\u6267\u884c\u9891\u7387\u7684\u7a33\u5b9a\uff1a\u4fdd\u969c\u591a\u6b21\u8c03\u7528\u7684\u9891\u7387\u8d8b\u8fd1\u4e8eperiod\u65f6\u95f4\n\u5982\u679c\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u5927\u4e8eperiod\uff0c\u4f1a\u5728\u4efb\u52a1\u6267\u884c\u4e4b\u540e\u9a6c\u4e0a\u6267\u884c\u4e0b\u4e00\u6b21\u4efb\u52a1")),(0,i.kt)("p",null,"demo:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * task1\n *\n * @version 0.1\n * @author xy\n * @date 2018\u5e747\u670827\u65e5 \u4e0b\u53484:33:36\n */\npublic class DemoTask extends TimerTask {\n    \n    @Override\n    public void run() {\n        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n        System.out.println("\u4efb\u52a1 \u89e6\u53d1...mmmm, \u65f6\u95f4\uff1a" + df.format(System.currentTimeMillis()));\n    }\n\n}\n\n/**\n * task2 \u68c0\u6d4b\u662f\u5426\u5230\u996d\u70b9\u4e86\n *\n * @version 0.1\n * @author xy\n * @date 2018\u5e747\u670827\u65e5 \u4e0b\u53485:40:23\n */\npublic class DemoTask2 extends TimerTask{\n    \n    private static List<Integer> eatTimes;\n    /**\n     * \u9759\u6001\u521d\u59cb\u5316\n     */\n    static {\n        initEatTimes();\n    }\n    \n    /**\n     * \u521d\u59cb\u5316\u5403\u996d\u65f6\u95f4\n     */\n    private static void initEatTimes(){\n        eatTimes = new ArrayList<Integer>();\n        eatTimes.add(8);\n        eatTimes.add(12);\n        eatTimes.add(18);\n    }\n\n\n    @Override\n    public void run() {\n        Calendar calendar = Calendar.getInstance();\n        int hour = calendar.get(Calendar.HOUR_OF_DAY);\n        if(eatTimes.contains(hour)) {\n            System.out.println("\u997f\u4e86\uff0c\u5403\u996d...");\n        }\n\n    }\n\n}\n\n\n/**\n * scheduler\n *\n * @version 0.1\n * @author xy\n * @date 2018\u5e747\u670827\u65e5 \u4e0b\u53484:37:15\n */\npublic class DemoScheduler {\n    \n    Timer timer = new Timer();\n    \n    /**\n     * \u6307\u5b9a\u65f6\u95f4\u70b9\u6267\u884c\n     * @param task\n     * @param ms\n     */\n    public void schedule(TimerTask task, long ms) {\n        timer.schedule(task, ms);\n    }\n    \n    /**\n     * \u95f4\u9694\u4e00\u6bb5\u65f6\u95f4\u6267\u884c\n     * @param task\n     * @param firstTime\n     * @param period\n     */\n    public void schedule (TimerTask task, Date firstTime, long period) {\n        timer.schedule(task, firstTime, period);\n    }\n    \n    public static void main(String[] args) {\n        \n//        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n//        \n//        new DemoScheduler().schedule(new DemoTask(), 1000);\n//        System.out.println("main thread: schedule\u6210\u529f\u8c03\u7528\uff0c time\uff1a" + df.format(System.currentTimeMillis()));\n        \n        new DemoScheduler().schedule(new DemoTask2(), Calendar.getInstance().getTime(), 1000*60*60);\n    }\n}\n\n')),(0,i.kt)("h2",{id:"quartz"},"Quartz"),(0,i.kt)("p",null,"\u5177\u4f53\u53c2\u89c1\uff1a",(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/defonds/article/details/49496895"},"https://blog.csdn.net/defonds/article/details/49496895")),(0,i.kt)("h3",{id:"\u51c6\u5907\u5de5\u4f5c"},"\u51c6\u5907\u5de5\u4f5c"),(0,i.kt)("p",null,"\u5bfc\u5165\u76f8\u5e94\u7684spring\u7684\u5305(\u56db\u4e2a\u6838\u5fc3\u5305\uff0c\u4e00\u4e2a\u4f9d\u8d56\u5305)\u4e0eQuartz\u7684\u5305"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5bfc\u5165Quartz\u7684\u5305")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5bfc\u5165Spring\u7684"),(0,i.kt)("p",{parentName:"li"},"Spring-context-support\u5305----\u4efb\u52a1\u7c7b\u57fa\u7c7b\nSpring-web\u5305--------spring web \u5f00\u53d1\uff08\u53d1\u73b0web.xml\uff0cListener\u7b49\uff09\nSpring-tx\u5305"))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u6ce8\uff1a\nspring\u7248\u672c\u4e3a3.2  quartz\u7248\u672c\u4e3a2.2.1  \u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u4f7f\u7528\u4e86quartz2.2.1 \u5219spring\u7248\u672c\u97003.1\u4ee5\u4e0a  ")),(0,i.kt)("h3",{id:"task\u7ee7\u627f\u81ea\u7279\u5b9a\u57fa\u7c7b"},"task\u7ee7\u627f\u81ea\u7279\u5b9a\u57fa\u7c7b"),(0,i.kt)("p",null,"task\u57fa\u7c7b: ",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.scheduling.quartz.QuartzJobBean"),"-----\u6765\u81ea context-support \u5305"),(0,i.kt)("h3",{id:"task\u65e0\u9700\u7ee7\u627f\u57fa\u7c7b"},"task\u65e0\u9700\u7ee7\u627f\u57fa\u7c7b"),(0,i.kt)("p",null,"\u80fd\u591f\u652f\u6301\u8fd9\u4e00\u7279\u6027, \u5f52\u529f\u4e8e ",(0,i.kt)("inlineCode",{parentName:"p"},"org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean")),(0,i.kt)("h2",{id:"spring-task"},"spring task"),(0,i.kt)("p",null,"Spring task \uff1a\u8f7b\u91cf\u7ea7\u7684Quartz\uff0c\u800c\u4e14\u4f7f\u7528\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u9664spring\u76f8\u5173\u7684\u5305\u5916\u4e0d\u9700\u8981\u989d\u5916\u7684\u5305\uff0c\u800c\u4e14\u652f\u6301\u6ce8\u89e3\u548c\u914d\u7f6e\u6587\u4ef6\u4e24\u79cd\uff0c\u4efb\u52a1\u7c7b\u5747\u4e3aPOJO"),(0,i.kt)("h1",{id:"quartz-1"},"Quartz"),(0,i.kt)("h2",{id:"\u662f\u4ec0\u4e48"},"\u662f\u4ec0\u4e48"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"http://www.quartz-scheduler.org/"},"http://www.quartz-scheduler.org/")),(0,i.kt)("p",null,"\u57fa\u4e8ejava\u5e73\u53f0\u7684\u4efb\u52a1\u8c03\u5ea6\u5e93, \u652f\u6301\u4e8b\u52a1, \u96c6\u7fa4"),(0,i.kt)("p",null,"\u6838\u5fc3\u6982\u5ff5/\u63a5\u53e3\u5c31\u8fd9\u51e0\u4e2a:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Scheduler - \u8c03\u5ea6\u7a0b\u5e8f (the main API for interacting with the scheduler.)"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Scheduler\u2019s life-cycle: \u4ece\u521b\u5efa\u5f00\u59cb, \u5230 shutdown() method \u7ed3\u675f")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u63d0\u4f9b add, remove, list Jobs and Triggers, pause trigger \u7b49\u7b49")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"scheduler \u5728\u4f7f\u7528 start() \u542f\u52a8\u524d, \u4e0d\u4f1a\u8d77\u4f5c\u7528")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Job - \u4efb\u52a1\u7c7b\u9700\u8981\u5b9e\u73b0\u5b83"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u63a5\u53e3\u53ea\u4e00\u4e2a\u65b9\u6cd5 public void execute(JobExecutionContext context), \u5f53 trigger \u88ab\u89e6\u53d1, scheduler\u2019s worker threads \u4f1a\u6267\u884c execute \u65b9\u6cd5")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JobExecutionContext \u53ef\u4ee5\u83b7\u53d6 scheduler, trigger, JobDetail ...")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"scheduler \u6bcf\u6b21\u8c03\u7528 Job \u7684 execute(), \u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Job \u5b9e\u4f8b, \u8c03\u7528\u7ed3\u675f, \u6307\u5411\u8fd9\u4e2a\u5b9e\u4f8b\u7684 references \u5c31\u88ab\u62ff\u6389\u4e86, \u5bf9\u8c61\u968f\u4e4b\u88ab\u56de\u6536, \u56e0\u6b64\u65e0\u6cd5\u5728 Job \u4e2d\u8bbe\u7f6e\u5c5e\u6027\u4fe1\u606f, \u53ea\u6709\u901a\u8fc7 JobDetail \u8bbe\u7f6e JobDataMap")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JobDetail - \u5b9a\u4e49\u4e00\u4e2a Job \u7684\u5c5e\u6027, \u6bd4\u5982 name, group..."),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4efb\u52a1\u7c7b\u6dfb\u52a0\u5b8c\u4e00\u4e9b\u5c5e\u6027\u540e\u6210\u4e3a JobDetail, \u7136\u540e\u548c trigger \u4e00\u8d77\u4ea4\u7ed9 scheduler")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JobDataMap - \u53ef\u4ee5\u5728 JobDetail \u4e2d\u4e3a Job \u8bbe\u7f6e\u4e00\u4e9b props \u7136\u540e\u518d\u5728 execute() \u4e2d\u4f7f\u7528 (\u53e6\u5916, \u89e6\u53d1\u5668\u8fd8\u53ef\u4ee5\u5177\u6709\u4e0e\u4e4b\u5173\u8054\u7684JobDataMaps)"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// define the job and tie it to our DumbJob class\nJobDetail job = newJob(DumbJob.class)\n    .withIdentity("myJob", "group1") // name "myJob", group "group1"\n    .usingJobData("jobSays", "Hello World!")\n    .usingJobData("myFloatValue", 3.141f)\n    .build();\n\n// use JobDataMap inside task class\npublic void execute(JobExecutionContext context)\n    throws JobExecutionException\n{\n    JobKey key = context.getJobDetail().getKey();\n\n    JobDataMap dataMap = context.getJobDetail().getJobDataMap();\n\n    String jobSays = dataMap.getString("jobSays");\n    float myFloatValue = dataMap.getFloat("myFloatValue");\n\n    System.err.println("Instance " + key + " of DumbJob says: " + jobSays + ", and val is: " + myFloatValue);\n}\n')),(0,i.kt)("p",{parentName:"li"},"\u6216\u8005\uff0c \u53ef\u4ee5\u901a\u8fc7 setter() \u5b9e\u73b0 \u81ea\u52a8\u6ce8\u5165 (\u89e6\u53d1\u5668\u89e6\u53d1\u65f6\uff0c\u5c06\u52a0\u8f7d\u4e0e\u5176\u5173\u8054\u7684JobDetail\uff08\u5b9e\u4f8b\u5b9a\u4e49\uff09\uff0c\u5e76\u901a\u8fc7Scheduler\u4e0a\u914d\u7f6e\u7684JobFactory\u5b9e\u4f8b\u5316\u5176\u5f15\u7528\u7684\u4f5c\u4e1a\u7c7b\u3002\u9ed8\u8ba4\u7684JobFactory\u53ea\u662f\u5728\u4f5c\u4e1a\u7c7b\u4e0a\u8c03\u7528newInstance\uff08\uff09\uff0c\u7136\u540e\u5c1d\u8bd5\u5728\u7c7b\u4e0a\u8c03\u7528\u4e0eJobDataMap\u4e2d\u7684\u952e\u540d\u5339\u914d\u7684setter\u65b9\u6cd5)"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class DumbJob implements Job {\n\n    String jobSays;\n    float myFloatValue;\n    ArrayList state;\n\n    public DumbJob() {\n    }\n\n    public void execute(JobExecutionContext context)\n    throws JobExecutionException\n    {\n    JobKey key = context.getJobDetail().getKey();\n\n    JobDataMap dataMap = context.getMergedJobDataMap();  // Note the difference from the previous example\n\n    state.add(new Date());\n\n    System.err.println("Instance " + key + " of DumbJob says: " + jobSays + ", and val is: " + myFloatValue);\n    }\n\n    public void setJobSays(String jobSays) {\n    this.jobSays = jobSays;\n    }\n\n    public void setMyFloatValue(float myFloatValue) {\n    myFloatValue = myFloatValue;\n    }\n\n    public void setState(ArrayList state) {\n    state = state;\n    }\n\n}\n\n'))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Trigger - \u5b9a\u4e49\u8c03\u5ea6\u89c4\u5219 ( a component that defines the schedule upon which a given Job will be executed)"),(0,i.kt)("p",{parentName:"li"},"  quartz \u9884\u5148\u5b9a\u4e49\u597d\u4e86\u5f88\u591a\u7c7b\u578b\u7684 trigger, \u5e38\u7528\u7684\u662f SimpleTrigger (\u7279\u5b9a\u65f6\u95f4\u6267\u884c\u4e00\u6b21 ","[\u7136\u540e\u91cd\u590d N \u6b21, \u6bcf\u6b21\u95f4\u9694 T]",") and CronTrigger (\u53ef\u4ee5\u4f7f\u7528\u66f4\u7075\u6d3b\u7684 cron expression)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u4f7f\u7528 Domain Specific Language (or DSL, also sometimes referred to as a \u201cfluent interface\u201d), \u89c1\u540e\u9762\u7684\u4ee3\u7801(\u9700\u8981 static import)"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JobBuilder - used to define/build JobDetail instances, which define instances of Jobs.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"TriggerBuilder - used to define/build Trigger instances."))))),(0,i.kt)("h2",{id:"quick-start"},"quick start"),(0,i.kt)("p",null,"\ud83d\udd17: xx"),(0,i.kt)("p",null,"\u6709\u5fc5\u8981\u63d0\u4e00\u4e0b, fluent api \u7684\u4f7f\u7528\u9700\u8981\u9996\u5148 static import \u4e00\u4e9b\u5305:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"import static org.quartz.JobBuilder.*;\nimport static org.quartz.SimpleScheduleBuilder.*;\nimport static org.quartz.CronScheduleBuilder.*;\nimport static org.quartz.CalendarIntervalScheduleBuilder.*;\nimport static org.quartz.TriggerBuilder.*;\nimport static org.quartz.DateBuilder.*;\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'package com.xiaoyu.learn.etc.schedule.quartz.simple.demo;\n\nimport org.quartz.JobDetail;\nimport org.quartz.Scheduler;\nimport org.quartz.Trigger;\nimport org.quartz.impl.StdSchedulerFactory;\nimport static org.quartz.JobBuilder.*;\nimport static org.quartz.TriggerBuilder.*;\nimport static org.quartz.SimpleScheduleBuilder.*;\n\nimport com.xiaoyu.learn.etc.schedule.quartz.simple.demo.job.HelloJob;\n\n/**\n * quartz simple demo\n *\n * @version 0.1\n * @author xy\n * @date 2018\u5e747\u670829\u65e5 \u4e0b\u534810:08:08\n */\npublic class QuartzTest {\n\n    public static void main(String[] args) throws Exception {\n        // // Grab the Scheduler instance from the Factory\n        Scheduler defaultScheduler = StdSchedulerFactory.getDefaultScheduler();\n        \n        // setup quartz properties\n        String qzPropsPath = Thread.currentThread().getContextClassLoader()\n                .getResource("quartz.properties").getPath().toString();\n        System.setProperty(\n                "org.quartz.properties", qzPropsPath);\n        System.out.println(">>>>> quartz config file path: " + qzPropsPath);\n        \n        // and start it off\n        defaultScheduler.start();\n        // -----------------------------do sth.------------------------------\n        // attention: static import needed\n     // define the job and tie it to our HelloJob class\n        JobDetail job = newJob(HelloJob.class)\n            .withIdentity("job1", "group1")// setup jobName and jobGroup\n            .build();\n\n        // Trigger the job to run now, and then repeat every 2 seconds\n        Trigger trigger = newTrigger()\n            .withIdentity("trigger1", "group1")\n            .startNow()\n                  .withSchedule(simpleSchedule()\n                    .withIntervalInSeconds(2)\n                    .repeatForever())            \n            .build();\n\n        // Tell quartz to schedule the job using our trigger\n        defaultScheduler.scheduleJob(job, trigger);\n        // ---------------------------------------------------------------\n        \n        Thread.sleep(60000);\n        \n        /**\n         * Once you obtain a scheduler using `StdSchedulerFactory.getDefaultScheduler()`,\n         * your application will not terminate until you call `scheduler.shutdown()`,\n         * because there will be active threads.\n         */\n        defaultScheduler.shutdown();\n    }\n}\n\n')),(0,i.kt)("h2",{id:"\u6709\u7528\u7684\u6ce8\u89e3"},"\u6709\u7528\u7684\u6ce8\u89e3"),(0,i.kt)("p",null,"\u53ef\u4ee5\u6dfb\u52a0\u5230 job class \u4e0a\u7528\u4e8e\u63a7\u5236 state \u548c\u5e76\u53d1"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@DisallowConcurrentExecution - \u89c4\u5b9a\u540c\u4e00\u4e2a\u65f6\u95f4\u6bb5\u5185, \u53ea\u80fd\u6709\u4e00\u4e2a job class\u5728\u6267\u884c, \u4f46\u662f\u53ef\u4ee5\u6709\u591a\u4e2a jobDetail \u5728\u6267\u884c;"),(0,i.kt)("p",{parentName:"li"},'  \u4e3e\u4e2a\ud83c\udf30:\n\u6709\u4e2a job class \u53eb "SalesReportJob", \u7136\u540e\u5728\u6b64\u57fa\u7840\u4e0a\u5b9a\u4e49\u4e24\u4e2a jobDetail "SalesReportForJoe" \u548c "SalesReportForMike" (\u901a\u8fc7\u4f20\u9012\u4e0d\u540c\u7684jobDateMap). \u5982\u679c SalesReportJob \u88ab\u6807\u6ce8, \u5219\u53ea\u80fd\u5728\u7ed9\u5b9a\u65f6\u95f4\u6267\u884c\u201cSalesReportForJoe\u201d\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u4f46\u5b83\u53ef\u4ee5\u4e0e\u201cSalesReportForMike\u201d\u5b9e\u4f8b\u540c\u65f6\u6267\u884c')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"@PersistJobDataAfterExecution - \u5b83\u544a\u8bc9Quartz\u5728execute\uff08\uff09\u65b9\u6cd5\u6210\u529f\u5b8c\u6210\u540e\uff08\u4e0d\u629b\u51fa\u5f02\u5e38\uff09\u66f4\u65b0JobDetail\u7684JobDataMap\u7684\u5b58\u50a8\u526f\u672c\uff0c\u4ee5\u4fbf\u4e0b\u4e00\u6b21\u6267\u884c\u76f8\u540c\u7684\u5de5\u4f5c\uff08 JobDetail\uff09\u63a5\u6536\u66f4\u65b0\u7684\u503c\u800c\u4e0d\u662f\u6700\u521d\u5b58\u50a8\u7684\u503c"),(0,i.kt)("p",{parentName:"li"},"  \u4e00\u822c\u548c @DisallowConcurrentExecution \u4e00\u8d77\u4f7f\u7528"))),(0,i.kt)("h2",{id:"trigger"},"trigger"),(0,i.kt)("p",null,"\u89e6\u53d1\u5668\u516c\u5171\u7684\u5c5e\u6027\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"TriggerKey ")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"jobKey")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"startTime -  java.util.Date, \u6307\u5b9a trigger\u2019s schedule \u4f55\u65f6\u9996\u6b21\u751f\u6548")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"endTime - trigger\u2019s schedule \u4f55\u65f6\u5931\u6548")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Priority - \u4e3a trigger \u8bbe\u7f6e\u4f18\u5148\u7ea7\uff0c \u5f53 worker thread \u4e0d\u591f\u7528\u7684\u65f6\u5019\u751f\u6548"))),(0,i.kt)("h3",{id:"quartz-calendars"},"quartz Calendars"),(0,i.kt)("p",null,"\u5728\u4e00\u4efd\u8ba1\u5212\u4e2d\uff0c \u6392\u9664\u67d0\u4e9b\u65e5\u671f"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'HolidayCalendar cal = new HolidayCalendar();\ncal.addExcludedDate( someDate );\ncal.addExcludedDate( someOtherDate );\n\nsched.addCalendar("myHolidays", cal, false);\n\n\nTrigger t = newTrigger()\n    .withIdentity("myTrigger")\n    .forJob("myJob")\n    .withSchedule(dailyAtHourAndMinute(9, 30)) // execute job daily at 9:30\n    .modifiedByCalendar("myHolidays") // but not on holidays\n    .build();\n\n// .. schedule job with trigger\n\nTrigger t2 = newTrigger()\n    .withIdentity("myTrigger2")\n    .forJob("myJob2")\n    .withSchedule(dailyAtHourAndMinute(11, 30)) // execute job daily at 11:30\n    .modifiedByCalendar("myHolidays") // but not on holidays\n    .build();\n\n// .. schedule job with trigger2\n')),(0,i.kt)("h3",{id:"simpletrigger"},"SimpleTrigger"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6ee1\u8db3\u8fd9\u6837\u7684\u9700\u6c42: \u5728\u7279\u5b9a\u7684\u65f6\u523b\u6267\u884c\u4e00\u6b21\u4efb\u52a1","[\u95f4\u9694\u4e00\u5b9a\u65f6\u95f4\u91cd\u590d\u6267\u884c\u8be5\u4efb\u52a1]")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5305\u542b\u8fd9\u4e9b\u5c5e\u6027: a start-time, and end-time, a repeat count, and a repeat interval.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4f7f\u7528\u9700\u8981 static import:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"import static org.quartz.TriggerBuilder.*;\nimport static org.quartz.SimpleScheduleBuilder.*;\nimport static org.quartz.DateBuilder.*:\n\n")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7279\u5b9a\u65f6\u523b\u89e6\u53d1, \u4e0d\u91cd\u590d"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'SimpleTrigger trigger = (SimpleTrigger) newTrigger()\n    .withIdentity("trigger1", "group1")\n    .startAt(myStartTime) // some Date \u6216\u8005 .startNow() \u9ed8\u8ba4\u5c31\u662fnow\n    .forJob("job1", "group1") // identify job with name, group strings\n    .build();\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7279\u5b9a\u65f6\u523b\u89e6\u53d1, \u95f4\u969410s, \u91cd\u590d 10+1 \u6b21"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'trigger = newTrigger()\n    .withIdentity("trigger3", "group1")\n    .startAt(myTimeToStartFiring)  // if a start time is not given (if this line were omitted), "now" is implied\n    .withSchedule(simpleSchedule()\n        .withIntervalInSeconds(10)\n        .withRepeatCount(10)) // note that 10 repeats will give a total of 11 firings\n    .forJob(myJob) // identify job with handle to its JobDetail itself\n    .build();\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"5min \u540e\u89e6\u53d1, \u4e0d\u91cd\u590d"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},' trigger = (SimpleTrigger) newTrigger()\n    .withIdentity("trigger5", "group1")\n    .startAt(futureDate(5, IntervalUnit.MINUTE)) // use DateBuilder to create a date in the future\n    .forJob(myJobKey) // identify job with its JobKey\n    .build();\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7acb\u5373\u89e6\u53d1, \u6bcf 5min \u91cd\u590d\u4e00\u6b21, \u76f4\u5230 22:00 \u70b9"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'trigger = newTrigger()\n    .withIdentity("trigger7", "group1")\n    .withSchedule(simpleSchedule()\n        .withIntervalInMinutes(5)\n        .repeatForever())\n    .endAt(dateOf(22, 0, 0))\n    .build();\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5728\u4e0b\u4e00\u4e2a\u6574\u70b9\u89e6\u53d1, \u7136\u540e\u95f4\u9694 2h, \u6c38\u8fdc\u91cd\u590d"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},' trigger = newTrigger()\n    .withIdentity("trigger8") // because group is not specified, "trigger8" will be in the default group\n    .startAt(evenHourDate(null)) // get the next even-hour (minutes and seconds zero ("00:00"))\n    .withSchedule(simpleSchedule()\n        .withIntervalInHours(2)\n        .repeatForever())\n    // note that in this example, \'forJob(..)\' is not called\n    //  - which is valid if the trigger is passed to the scheduler along with the job  \n    .build();\n\n    scheduler.scheduleJob(trigger, job);\n'))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'\u6267\u884c\u4efb\u52a1\u5931\u8d25, \u53ef\u4ee5\u7ed9 trigger \u8bbe\u5b9a"\u5931\u8d25\u6307\u4ee4" (',(0,i.kt)("a",{parentName:"p",href:"http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-05.html"},"ref"),")"))),(0,i.kt)("h3",{id:"crontrigger"},"CronTrigger"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"startTime , endTime")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"cronExpression \ud83d\udc49 ",(0,i.kt)("a",{parentName:"p",href:"#cronExpression"},"#coron\u8868\u8fbe\u5f0f"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u9700\u8981\u9759\u6001\u5f15\u5165"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"import static org.quartz.TriggerBuilder.*;\nimport static org.quartz.CronScheduleBuilder.*;\nimport static org.quartz.DateBuilder.*:\n")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6bcf\u5206\u949f\u89e6\u53d1\u4e00\u6b21, \u4e0a\u53485\u70b9\u5230\u4e0b\u53488\u70b9, \u6bcf\u5929"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'trigger = newTrigger()\n    .withIdentity("trigger3", "group1")\n    .withSchedule(cronSchedule("0 0/2 8-17 * * ?"))\n    .forJob("myJob", "group1")\n    .build();\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8bbe\u7f6e\u65f6\u533a"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'trigger = newTrigger()\n    .withIdentity("trigger3", "group1")\n    .withSchedule(cronSchedule("0 42 10 ? * WED"))\n    .inTimeZone(TimeZone.getTimeZone("America/Los_Angeles"))\n    .forJob(myJobKey)\n    .build();\n')))))),(0,i.kt)("h2",{id:"triggerlisteners-and-joblisteners"},"TriggerListeners and JobListeners"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-07.html"},"http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-07.html")),(0,i.kt)("h2",{id:"schedulerlisteners"},"SchedulerListeners"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-08.html"},"http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-08.html")),(0,i.kt)("h2",{id:"job-stores"},"Job Stores"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"RAMJobStore - \u5b58\u50a8\u5728\u5185\u5b58\u4e2d"),(0,i.kt)("p",{parentName:"li"},"  \u4f7f\u7528\u9700\u8981\u8fd9\u6837\u8bbe\u7f6e: ",(0,i.kt)("inlineCode",{parentName:"p"},"org.quartz.jobStore.class = org.quartz.simpl.RAMJobStore"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JDBCJobStore - \u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d"))),(0,i.kt)("h1",{id:"springboot\u548cquartz\u5b9e\u73b0\u52a8\u6001\u914d\u7f6e"},"springboot\u548cquartz\u5b9e\u73b0\u52a8\u6001\u914d\u7f6e"),(0,i.kt)("p",null,"ref: ",(0,i.kt)("a",{parentName:"p",href:"https://blog.csdn.net/liuchuanhong1/article/details/60873295"},"https://blog.csdn.net/liuchuanhong1/article/details/60873295")))}c.isMDXComponent=!0}}]);