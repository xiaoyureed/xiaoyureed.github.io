"use strict";(self.webpackChunkwiki_1=self.webpackChunkwiki_1||[]).push([[1867],{3905:(e,n,t)=>{t.d(n,{Zo:()=>k,kt:()=>m});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var i=a.createContext({}),s=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):p(p({},n),e)),t},k=function(e){var n=s(e.components);return a.createElement(i.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,i=e.parentName,k=o(e,["components","mdxType","originalType","parentName"]),c=s(t),d=l,m=c["".concat(i,".").concat(d)]||c[d]||u[d]||r;return t?a.createElement(m,p(p({ref:n},k),{},{components:t})):a.createElement(m,p({ref:n},k))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,p=new Array(r);p[0]=d;var o={};for(var i in n)hasOwnProperty.call(n,i)&&(o[i]=n[i]);o.originalType=e,o[c]="string"==typeof e?e:l,p[1]=o;for(var s=2;s<r;s++)p[s]=t[s];return a.createElement.apply(null,p)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},4275:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>p,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>s});var a=t(7462),l=(t(7294),t(3905));const r={title:"kubernetes-k8s \u2601\ufe0f",date:new Date("2019-04-06T00:00:00.000Z"),tags:["k8s"],toc_min_heading_level:2,toc_max_heading_level:5},p=void 0,o={unversionedId:"kubernetes-k8s",id:"kubernetes-k8s",title:"kubernetes-k8s \u2601\ufe0f",description:"https://dockone.io/article/2434304",source:"@site/docs/kubernetes-k8s.md",sourceDirName:".",slug:"/kubernetes-k8s",permalink:"/en/docs/kubernetes-k8s",draft:!1,editUrl:"https://github.com/xiaoyureed/xiaoyureed.github.io/tree/main/docs/kubernetes-k8s.md",tags:[{label:"k8s",permalink:"/en/docs/tags/k-8-s"}],version:"current",frontMatter:{title:"kubernetes-k8s \u2601\ufe0f",date:"2019-04-06T00:00:00.000Z",tags:["k8s"],toc_min_heading_level:2,toc_max_heading_level:5},sidebar:"tutorialSidebar",previous:{title:"kotlin",permalink:"/en/docs/kotlin"},next:{title:"\u9e1f\u54e5\u7684 Linux \u79c1\u623f\u83dc\u9605\u8bfb\u7b14\u8bb0",permalink:"/en/docs/linux-note"}},i={},s=[{value:"\u9762\u8bd5\u95ee\u9898",id:"\u9762\u8bd5\u95ee\u9898",level:2},{value:"what and why",id:"what-and-why",level:2},{value:"k8s \u662f\u505a\u4ec0\u4e48\u7684",id:"k8s-\u662f\u505a\u4ec0\u4e48\u7684",level:3},{value:"\u4e3a\u4ec0\u4e48\u4f7f\u7528:",id:"\u4e3a\u4ec0\u4e48\u4f7f\u7528",level:3},{value:"\u96c6\u7fa4\u7ed3\u6784",id:"\u96c6\u7fa4\u7ed3\u6784",level:2},{value:"\u4e00\u4e2a master \u8282\u70b9",id:"\u4e00\u4e2a-master-\u8282\u70b9",level:3},{value:"\u4e00\u7fa4worker\u8282\u70b9",id:"\u4e00\u7fa4worker\u8282\u70b9",level:3},{value:"\u903b\u8f91\u7ed3\u6784",id:"\u903b\u8f91\u7ed3\u6784",level:2},{value:"pod",id:"pod",level:3},{value:"volume",id:"volume",level:3},{value:"controllers",id:"controllers",level:3},{value:"service",id:"service",level:3},{value:"flannel",id:"flannel",level:3},{value:"ingress",id:"ingress",level:3},{value:"name namespace",id:"name-namespace",level:3},{value:"\u8d44\u6e90\u63cf\u8ff0\u6587\u4ef6",id:"\u8d44\u6e90\u63cf\u8ff0\u6587\u4ef6",level:2},{value:"\u901a\u8fc7\u547d\u4ee4\u751f\u6210 yml",id:"\u901a\u8fc7\u547d\u4ee4\u751f\u6210-yml",level:3},{value:"pod \u7684  yaml \u63cf\u8ff0\u6587\u4ef6",id:"pod-\u7684--yaml-\u63cf\u8ff0\u6587\u4ef6",level:3},{value:"deployment \u7684\u63cf\u8ff0\u6587\u4ef6",id:"deployment-\u7684\u63cf\u8ff0\u6587\u4ef6",level:3},{value:"service",id:"service-1",level:3},{value:"\u6807\u7b7e",id:"\u6807\u7b7e",level:2},{value:"\u6ce8\u89e3",id:"\u6ce8\u89e3",level:2},{value:"\u547d\u540d\u7a7a\u95f4",id:"\u547d\u540d\u7a7a\u95f4",level:2},{value:"pod \u7ba1\u7406",id:"pod-\u7ba1\u7406",level:2},{value:"\u63a2\u6d4b pod \u662f\u5426\u5065\u5eb7",id:"\u63a2\u6d4b-pod-\u662f\u5426\u5065\u5eb7",level:3},{value:"pod \u526f\u672c",id:"pod-\u526f\u672c",level:3},{value:"\u8fd0\u884c\u5355\u4e2a\u4efb\u52a1 Job",id:"\u8fd0\u884c\u5355\u4e2a\u4efb\u52a1-job",level:3},{value:"\u5b9a\u65f6\u4efb\u52a1 CronJob",id:"\u5b9a\u65f6\u4efb\u52a1-cronjob",level:3},{value:"pod \u901a\u4fe1",id:"pod-\u901a\u4fe1",level:2},{value:"proxy",id:"proxy",level:3},{value:"Service",id:"service-2",level:3},{value:"pod \u95f4\u901a\u4fe1",id:"pod-\u95f4\u901a\u4fe1",level:3},{value:"\u901a\u8fc7 Service \u8fde\u63a5\u5916\u90e8\u670d\u52a1",id:"\u901a\u8fc7-service-\u8fde\u63a5\u5916\u90e8\u670d\u52a1",level:3},{value:"\u901a\u8fc7\u624b\u52a8\u751f\u6210 endpoint",id:"\u901a\u8fc7\u624b\u52a8\u751f\u6210-endpoint",level:4},{value:"\u901a\u8fc7 externalName \u7c7b\u578b\u7684 Service",id:"\u901a\u8fc7-externalname-\u7c7b\u578b\u7684-service",level:4},{value:"\u5c06\u670d\u52a1\u66b4\u9732\u7ed9\u5916\u90e8",id:"\u5c06\u670d\u52a1\u66b4\u9732\u7ed9\u5916\u90e8",level:3},{value:"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210 NodePort",id:"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210-nodeport",level:4},{value:"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210LoadBalance",id:"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210loadbalance",level:4},{value:"\u521b\u5efa\u4e00 \u4e2aIngress\u8d44\u6e90",id:"\u521b\u5efa\u4e00-\u4e2aingress\u8d44\u6e90",level:4},{value:"\u547d\u4ee4",id:"\u547d\u4ee4",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"kind",id:"kind",level:3},{value:"minikube",id:"minikube",level:3},{value:"\u4f7f\u7528 kubectl",id:"\u4f7f\u7528-kubectl",level:3},{value:"\u57fa\u672c\u4fe1\u606f",id:"\u57fa\u672c\u4fe1\u606f",level:4},{value:"\u521b\u5efa create expose",id:"\u521b\u5efa-create-expose",level:4},{value:"\u6267\u884c\u547d\u4ee4\u5230\u5bb9\u5668 exec",id:"\u6267\u884c\u547d\u4ee4\u5230\u5bb9\u5668-exec",level:4},{value:"\u4fee\u6539",id:"\u4fee\u6539",level:4},{value:"\u8d44\u6e90\u5217\u8868 get",id:"\u8d44\u6e90\u5217\u8868-get",level:4},{value:"\u67e5\u8be2\u8be6\u7ec6\u63cf\u8ff0 describe",id:"\u67e5\u8be2\u8be6\u7ec6\u63cf\u8ff0-describe",level:4},{value:"\u67e5\u8be2\u65e5\u5fd7 logs",id:"\u67e5\u8be2\u65e5\u5fd7-logs",level:4},{value:"\u5220\u9664 delete",id:"\u5220\u9664-delete",level:4},{value:"kubeadmin",id:"kubeadmin",level:3},{value:"\u53ef\u89c6\u5316\u754c\u9762",id:"\u53ef\u89c6\u5316\u754c\u9762",level:2},{value:"vagrant \u642d\u5efa k8s \u73af\u5883",id:"vagrant-\u642d\u5efa-k8s-\u73af\u5883",level:2},{value:"cka \u8bc1\u4e66",id:"cka-\u8bc1\u4e66",level:2},{value:"k3s",id:"k3s",level:2},{value:"k0s",id:"k0s",level:2},{value:"rancher",id:"rancher",level:2},{value:"Harbor",id:"harbor",level:2},{value:"helm chart",id:"helm-chart",level:2}],k={toc:s},c="wrapper";function u(e){let{components:n,...t}=e;return(0,l.kt)(c,(0,a.Z)({},k,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://dockone.io/article/2434304"},"https://dockone.io/article/2434304")),(0,l.kt)("p",null,"\u719f\u7ec3\u638c\u63e1 k8s \uff0c\u81ea\u5df1\u642d\u4e2a\u96c6\u7fa4\uff0c\u4e4b\u540e\u5b66\u4e60 Kubernetes \u7684\u4e8c\u6b21\u5f00\u53d1\uff0cCRD \u4e0e operator "),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/fanux/sealos"},"https://github.com/fanux/sealos")," \u4e00\u952e\u5b89\u88c5"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/eip-work/kuboard-press"},"https://github.com/eip-work/kuboard-press")," \u9762\u677f, \u6559\u7a0b"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/derailed/k9s"},"https://github.com/derailed/k9s")," \u7ba1\u7406 k8s \u7684\u547d\u4ee4\u884c\u5de5\u5177"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/caicloud/kube-ladder"},"https://github.com/caicloud/kube-ladder")," \u5165\u95e8\u6307\u5357\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/jpetazzo/container.training"},"https://github.com/jpetazzo/container.training")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/kubernetes"},"https://github.com/kubernetes/kubernetes"),"\n",(0,l.kt)("a",{parentName:"p",href:"https://juejin.im/post/5db8c2b46fb9a020256692dc"},"https://juejin.im/post/5db8c2b46fb9a020256692dc")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.katacoda.com/courses/kubernetes/playground"},"https://www.katacoda.com/courses/kubernetes/playground")," k8s web playground\n",(0,l.kt)("a",{parentName:"p",href:"https://www.katacoda.com/courses/kubernetes"},"https://www.katacoda.com/courses/kubernetes")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://blog.csdn.net/qq_19734597/article/details/108337499"},"https://blog.csdn.net/qq_19734597/article/details/108337499")," \u547d\u4ee4\u884c\u7b80\u5199"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1-%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98"},".1. \u9762\u8bd5\u95ee\u9898")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#2-what-and-why"},".2. what and why"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#21-k8s-%E6%98%AF%E5%81%9A%E4%BB%80%E4%B9%88%E7%9A%84"},".2.1. k8s \u662f\u505a\u4ec0\u4e48\u7684")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#22-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8"},".2.2. \u4e3a\u4ec0\u4e48\u4f7f\u7528:")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#3-%E9%9B%86%E7%BE%A4%E7%BB%93%E6%9E%84"},".3. \u96c6\u7fa4\u7ed3\u6784"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#31-%E4%B8%80%E4%B8%AA-master-%E8%8A%82%E7%82%B9"},".3.1. \u4e00\u4e2a master \u8282\u70b9")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#32-%E4%B8%80%E7%BE%A4worker%E8%8A%82%E7%82%B9"},".3.2. \u4e00\u7fa4worker\u8282\u70b9")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#4-%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84"},".4. \u903b\u8f91\u7ed3\u6784"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#41-pod"},".4.1. pod")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#42-volume"},".4.2. volume")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#43-controllers"},".4.3. controllers")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#44-service"},".4.4. service")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#45-flannel"},".4.5. flannel")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#46-ingress"},".4.6. ingress")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#47-name-namespace"},".4.7. name namespace")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#5-%E8%B5%84%E6%BA%90%E6%8F%8F%E8%BF%B0%E6%96%87%E4%BB%B6"},".5. \u8d44\u6e90\u63cf\u8ff0\u6587\u4ef6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#51-%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E7%94%9F%E6%88%90-yml"},".5.1. \u901a\u8fc7\u547d\u4ee4\u751f\u6210 yml")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#52-pod-%E7%9A%84--yaml-%E6%8F%8F%E8%BF%B0%E6%96%87%E4%BB%B6"},".5.2. pod \u7684  yaml \u63cf\u8ff0\u6587\u4ef6")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#53-deployment-%E7%9A%84%E6%8F%8F%E8%BF%B0%E6%96%87%E4%BB%B6"},".5.3. deployment \u7684\u63cf\u8ff0\u6587\u4ef6")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#54-service"},".5.4. service")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#6-%E6%A0%87%E7%AD%BE"},".6. \u6807\u7b7e")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#7-%E6%B3%A8%E8%A7%A3"},".7. \u6ce8\u89e3")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#8-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"},".8. \u547d\u540d\u7a7a\u95f4")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#9-pod-%E7%AE%A1%E7%90%86"},".9. pod \u7ba1\u7406"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#91-%E6%8E%A2%E6%B5%8B-pod-%E6%98%AF%E5%90%A6%E5%81%A5%E5%BA%B7"},".9.1. \u63a2\u6d4b pod \u662f\u5426\u5065\u5eb7")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#92-pod-%E5%89%AF%E6%9C%AC"},".9.2. pod \u526f\u672c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#93-%E8%BF%90%E8%A1%8C%E5%8D%95%E4%B8%AA%E4%BB%BB%E5%8A%A1-job"},".9.3. \u8fd0\u884c\u5355\u4e2a\u4efb\u52a1 Job")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#94-%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1-cronjob"},".9.4. \u5b9a\u65f6\u4efb\u52a1 CronJob")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#10-pod-%E9%80%9A%E4%BF%A1"},".10. pod \u901a\u4fe1"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#101-proxy"},".10.1. proxy")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#102-service"},".10.2. Service")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#103-pod-%E9%97%B4%E9%80%9A%E4%BF%A1"},".10.3. pod \u95f4\u901a\u4fe1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#104-%E9%80%9A%E8%BF%87-service-%E8%BF%9E%E6%8E%A5%E5%A4%96%E9%83%A8%E6%9C%8D%E5%8A%A1"},".10.4. \u901a\u8fc7 Service \u8fde\u63a5\u5916\u90e8\u670d\u52a1"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1041-%E9%80%9A%E8%BF%87%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90-endpoint"},".10.4.1. \u901a\u8fc7\u624b\u52a8\u751f\u6210 endpoint")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1042-%E9%80%9A%E8%BF%87-externalname-%E7%B1%BB%E5%9E%8B%E7%9A%84-service"},".10.4.2. \u901a\u8fc7 externalName \u7c7b\u578b\u7684 Service")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#105-%E5%B0%86%E6%9C%8D%E5%8A%A1%E6%9A%B4%E9%9C%B2%E7%BB%99%E5%A4%96%E9%83%A8"},".10.5. \u5c06\u670d\u52a1\u66b4\u9732\u7ed9\u5916\u90e8"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1051-%E5%B0%86%E6%9C%8D%E5%8A%A1%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%AE%BE%E7%BD%AE%E6%88%90-nodeport"},".10.5.1. \u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210 NodePort")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1052-%E5%B0%86%E6%9C%8D%E5%8A%A1%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%AE%BE%E7%BD%AE%E6%88%90loadbalance"},".10.5.2. \u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210LoadBalance")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1053-%E5%88%9B%E5%BB%BA%E4%B8%80-%E4%B8%AAingress%E8%B5%84%E6%BA%90"},".10.5.3. \u521b\u5efa\u4e00 \u4e2aIngress\u8d44\u6e90")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#11-%E5%91%BD%E4%BB%A4"},".11. \u547d\u4ee4"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#111-%E5%AE%89%E8%A3%85"},".11.1. \u5b89\u88c5")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#112-kind"},".11.2. kind")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#113-minikube"},".11.3. minikube")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#114-%E4%BD%BF%E7%94%A8-kubectl"},".11.4. \u4f7f\u7528 kubectl"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1141-%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"},".11.4.1. \u57fa\u672c\u4fe1\u606f")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1142-%E5%88%9B%E5%BB%BA-create-expose"},".11.4.2. \u521b\u5efa create expose")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1143-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E5%88%B0%E5%AE%B9%E5%99%A8-exec"},".11.4.3. \u6267\u884c\u547d\u4ee4\u5230\u5bb9\u5668 exec")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1144-%E4%BF%AE%E6%94%B9"},".11.4.4. \u4fee\u6539")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1145-%E8%B5%84%E6%BA%90%E5%88%97%E8%A1%A8-get"},".11.4.5. \u8d44\u6e90\u5217\u8868 get")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1146-%E6%9F%A5%E8%AF%A2%E8%AF%A6%E7%BB%86%E6%8F%8F%E8%BF%B0-describe"},".11.4.6. \u67e5\u8be2\u8be6\u7ec6\u63cf\u8ff0 describe")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1147-%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97-logs"},".11.4.7. \u67e5\u8be2\u65e5\u5fd7 logs")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#1148-%E5%88%A0%E9%99%A4-delete"},".11.4.8. \u5220\u9664 delete")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#115-kubeadmin"},".11.5. kubeadmin")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#12-%E5%8F%AF%E8%A7%86%E5%8C%96%E7%95%8C%E9%9D%A2"},".12. \u53ef\u89c6\u5316\u754c\u9762")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#13-vagrant-%E6%90%AD%E5%BB%BA-k8s-%E7%8E%AF%E5%A2%83"},".13. vagrant \u642d\u5efa k8s \u73af\u5883")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#14-cka-%E8%AF%81%E4%B9%A6"},".14. cka \u8bc1\u4e66")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#15-k3s"},".15. k3s")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#16-k0s"},".16. k0s")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#17-rancher"},".17. rancher")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#18-harbor"},".18. Harbor")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#19-helm-chart"},".19. helm chart"))),(0,l.kt)("h2",{id:"\u9762\u8bd5\u95ee\u9898"},"\u9762\u8bd5\u95ee\u9898"),(0,l.kt)("p",null,"\u4e3a\u4ec0\u4e48\u9700\u8981 pod? \u4e3a\u4ec0\u4e48\u4e0d\u80fd\u7b80\u5355\u5730\u628a\u6240\u6709\u8fdb\u7a0b\u90fd\u653e\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u5bb9\u5668\u4e2d?"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5728\u5355\u4e2a\u5bb9\u5668\u4e2d\u8fd0\u884c\u591a\u4e2a\u4e0d\u76f8\u5173\u7684\u8fdb\u7a0b\uff0c \u90a3\u4e48\u4fdd\u6301\u6240\u6709\u8fdb\u7a0b\u8fd0\u884c(\u5982\u5931\u8d25\u91cd\u542f)\u3001 \u7ba1\u7406\u5b83\u4eec\u7684\u65e5\u5fd7\u4f1a\u56f0\u96be(\u65e5\u5fd7\u4f1a\u6df7\u5728\u4e00\u8d77)\u3002")),(0,l.kt)("p",null,"\u4e3a\u4ec0\u4e48\u8981\u5c06\u4e00\u4e2a app \u7684 \u524d\u7aef\u670d\u52a1\u5668 \u548c \u540e\u7aef\u670d\u52a1\u5668 \u5206\u4e3a \u4e24\u4e2a pod \u90e8\u7f72?"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9020\u6210\u8ba1\u7b97\u8d44\u6e90\u6d6a\u8d39: \u5982\u679c\u90e8\u7f72\u5230\u540c\u4e00\u4e2a pod, \u90a3\u4e48\u5bf9\u4e8e \u53cc\u8282\u70b9 k8s, \u5c06\u603b\u662f\u53ea\u80fd\u5229\u7528\u4e00\u4e2a\u8282\u70b9")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6269\u7f29\u5bb9\u4e0d\u4fbf: k8s \u6269\u5bb9\u57fa\u672c\u5355\u4f4d\u5c31\u662f pod, \u524d\u540e\u7aef\u82e5\u90e8\u7f72\u5230\u540c\u4e2a pod, \u4f1a\u9020\u6210\u6269\u7f29\u5bb9\u7c92\u5ea6\u592a\u5927. \u800c\u4e14\u5bf9\u4e8e \u6570\u636e\u5e93\u670d\u52a1\u5668, \u6269\u7f29\u5bb9\u65e0\u6cd5\u8fd9\u6837\u7b80\u5355\u5904\u7406"))),(0,l.kt)("p",null,"\u5982\u4f55\u51b3\u5b9a\u662f\u5426\u5c06\u591a\u4e2a container \u5212\u5206\u5230\u4e00\u4e2a pod?"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u6269\u7f29\u5bb9\u662f\u5426\u80fd\u591f\u4e00\u8d77\u8fdb\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u662f\u5426\u53ef\u4ee5\u5728\u540c\u4e2a\u4e3b\u673a\u8fd0\u884c")),(0,l.kt)("p",null,"11\u5e74\u8fd0\u7ef4\u5de5\u4f5c\u7ecf\u9a8c\uff0c\u73b0\u4ece\u4e8b\u817e\u8baf\u5de5\u4e1a\u4e92\u8054\u7f51\u8fd0\u7ef4\u5de5\u4f5c\uff1b\nDevOps\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u5f00\u6e90\u7231\u597d\u8005\uff1b\n3\u5e74+Kubernetes\u5e73\u53f0\u7ecf\u9a8c\uff0c\u5bf9Kubernetes\u751f\u6001\u6709\u81ea\u5df1\u7684\u8ba4\u8bc6\uff1b\n\u638c\u63e1Jenkins+Gitlab+Helm\u6301\u7eed\u96c6\u6210/\u6301\u7eed\u4ea4\u4ed8\u5de5\u5177\u94fe\uff1b\n\u5bf9\u6d88\u606f\u961f\u5217\uff0c\u7f13\u5b58\u7b49\u4e2d\u95f4\u4ef6\uff0c\u8f6f\u4ef6\u67b6\u6784\u4f53\u7cfb\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\uff1b\n\u719f\u7ec3\u638c\u63e1shell\u7f16\u7a0b\uff0c\u719f\u6089Python,Go\u8bed\u8a00\uff1b\nTODO"),(0,l.kt)("h2",{id:"what-and-why"},"what and why"),(0,l.kt)("h3",{id:"k8s-\u662f\u505a\u4ec0\u4e48\u7684"},"k8s \u662f\u505a\u4ec0\u4e48\u7684"),(0,l.kt)("p",null,"\u62bd\u8c61\u4e86\u6570\u636e\u4e2d\u5fc3\u7684\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\uff0c\u5bf9\u5916\u66b4\u9732\u7edf\u4e00\u7684\u63a5\u53e3\uff0c\u5177\u4f53\u5305\u62ec"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u8c03\u5ea6:  k8s \u81ea\u52a8\u51b3\u5b9a\u7ec4\u4ef6\u90e8\u7f72\u5230\u5177\u4f53\u7684\u54ea\u4e00\u53f0 \u670d\u52a1\u5668\u8282\u70b9\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u81ea\u52a8\u4fee\u590d: \u81ea\u52a8\u68c0\u67e5\u8282\u70b9\u7684\u5065\u5eb7\u72b6\u6001, \u5427\u7a0b\u5e8f\u8fc1\u79fb\u5230\u5065\u5eb7\u7684\u8282\u70b9\u4e0a"),(0,l.kt)("li",{parentName:"ul"},"\u6c34\u5e73\u4f38\u7f29:  \u81ea\u52a8\u68c0\u6d4b\u4e1a\u52a1\u7684\u8d1f\u8f7d\u60c5\u51b5, \u5982\u679c CPU \u8d1f\u8f7d\u592a\u9ad8, \u6216\u8005\u76f8\u5e94\u65f6\u95f4\u592a\u957f, \u4f1a\u81ea\u52a8\u8fdb\u884c\u6269\u5bb9")),(0,l.kt)("p",null,"\u53ea\u9700\u8981\u544a\u8bc9 k8s \u8981\u505a\u4ec0\u4e48 (\u6bd4\u5982\u4fdd\u6301\u67d0\u4e2a pod \u6709\u4e09\u4e2a\u526f\u672c), \u800c\u4e0d\u5fc5\u544a\u8bc9\u5b83\u600e\u4e48\u505a, \u5c31\u50cf sql \u53ea\u544a\u8bc9 \u6570\u636e\u5e93\u8981\u67e5\u8be2\u90a3\u4e9b\u6570\u636e, \u800c\u6ca1\u6709\u544a\u8bc9\u6570\u636e\u5e93\u600e\u4e48\u67e5\u6570\u636e"),(0,l.kt)("h3",{id:"\u4e3a\u4ec0\u4e48\u4f7f\u7528"},"\u4e3a\u4ec0\u4e48\u4f7f\u7528:"),(0,l.kt)("p",null,"\u5f53 container \u592a\u591a, \u9700\u8981\u7ba1\u7406, \u5355\u673a\u60c5\u51b5\u4e0b, \u8fd8\u80fd\u4f9d\u9760 docker-compose \u8fd9\u4e9b\u5de5\u5177, \u5f53\u6709\u5f88\u591a\u673a\u5668\u65f6, \u5c31\u5fc5\u987b\u901a\u8fc7 k8s \u6765\u5c06 \u5bb9\u5668\u5408\u7406\u5730\u5206\u914d\u5230\u8fd9\u4e9b\u673a\u5668\u4e2d\u53bb "),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u670d\u52a1\u53d1\u73b0\u548c\u8d1f\u8f7d\u5747\u8861"),(0,l.kt)("li",{parentName:"ul"},"\u81ea\u52a8\u90e8\u7f72 and \u56de\u6eda"),(0,l.kt)("li",{parentName:"ul"},"\u66ff\u6362\u5931\u8d25\u5bb9\u5668 (\u81ea\u6211\u4fee\u590d)")),(0,l.kt)("h2",{id:"\u96c6\u7fa4\u7ed3\u6784"},"\u96c6\u7fa4\u7ed3\u6784"),(0,l.kt)("h3",{id:"\u4e00\u4e2a-master-\u8282\u70b9"},"\u4e00\u4e2a master \u8282\u70b9"),(0,l.kt)("p",null,"master \u8282\u70b9\uff1a\u63a7\u5236 and \u7ba1\u7406\u6574\u4e2a\u96c6\u7fa4"),(0,l.kt)("p",null,"\u901a\u5e38\u4f1a\u6709\u591a\u4e2amaster node \u9ad8\u53ef\u7528 , \u6545\u969c\u8f6c\u79fb"),(0,l.kt)("p",null,"\u5305\u542b\u8fd9\u4e9b\u7ec4\u4ef6"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"etcd: \u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8. \u7528\u6765\u5b58\u50a8\u4e3b\u8282\u70b9\u7684\u6570\u636e (\u952e\u503c\u6570\u636e\u5e93)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"api server\uff1a\u7f51\u5173, \u548c\u5916\u754c\u4ea4\u4e92, \u4f9b\u5ba2\u6237\u7aef\u8c03\u7528")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"scheduler\uff1a\u8c03\u5ea6\uff0c \u51b3\u5b9a\u54ea\u4e2a pod \u90e8\u7f72\u5230\u54ea\u4e2a\u8282\u70b9; \u76d1\u89c6\u90a3\u4e9b\u65b0\u521b\u5efa\u7684\u672a\u6307\u5b9a\u8fd0\u884c\u8282\u70b9\u7684 Pod\uff0c\u5e76\u9009\u62e9\u8282\u70b9\u8ba9 Pod \u5728\u4e0a\u9762\u8fd0\u884c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"controller manager\uff1a\u6574\u4e2a\u96c6\u7fa4\u7684\u7ba1\u5bb6\uff0c\u7528\u6765\u7ba1\u7406\u8d44\u6e90\u5bf9\u8c61;\u5982 \u590d\u5236\u8282\u70b9\uff0c \u6301\u7eed\u8ddf\u8e2a\u5de5\u4f5c\u8282\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"node controller \u5728\u8282\u70b9\u51fa\u73b0\u6545\u969c\u65f6\u8fdb\u884c\u901a\u77e5\u548c\u54cd\u5e94"),(0,l.kt)("li",{parentName:"ul"},"Replication Controller \u7ef4\u62a4\u6b63\u786e\u6570\u91cf\u7684 Pod"),(0,l.kt)("li",{parentName:"ul"},"Endpoints Controller\u586b\u5145\u7aef\u70b9(Endpoints)\u5bf9\u8c61(\u5373\u52a0\u5165 Service \u4e0e Pod)")))),(0,l.kt)("p",null,"Minikube \u7ba1\u7406\u7684\u662f\u5355\u8282\u70b9 k8s\uff0c master node\uff0c \u548c worker node \u90fd\u5728\u4e00\u53f0\u7269\u7406\u4e3b\u673a\u4e0a"),(0,l.kt)("h3",{id:"\u4e00\u7fa4worker\u8282\u70b9"},"\u4e00\u7fa4worker\u8282\u70b9"),(0,l.kt)("p",null,"worker \u8282\u70b9\uff1a\u8fd0\u884c\u5b9e\u9645\u90e8\u7f72\u7684 \u5bb9\u5668"),(0,l.kt)("p",null,"\u53ef\u4ee5\u53ea\u6709\u4e00\u4e2a worker node"),(0,l.kt)("p",null,"\u5305\u542b\u8fd9\u4e9b\u7ec4\u4ef6    "),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"kubelet: \u548c master \u8282\u70b9\u7684 api server \u901a\u4fe1 and \u7ba1\u7406\u6240\u5728\u7684 \u8282\u70b9/\u673a\u5668\u4e0a\u7684 pod (\u521b\u5efa\u3001\u4fee\u6539\u3001\u76d1\u63a7\u3001\u5220\u9664)"),(0,l.kt)("p",{parentName:"li"},"  \u76f8\u5f53\u4e8e\u8282\u70b9\u7684\u4ee3\u7406, \u548c master \u8282\u70b9\u4ea4\u4e92")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"kube-proxy: \u8d1f\u8d23 pod \u95f4\u7684\u8d1f\u8f7d\u5747\u8861 \u7f51\u7edc\u4ee3\u7406")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Fluentd\uff0c\u4e3b\u8981\u8d1f\u8d23\u65e5\u5fd7\u6536\u96c6\u3001\u5b58\u50a8\u4e0e\u67e5\u8be2")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"container runtime (docker) \u521b\u5efa\u5bb9\u5668"))),(0,l.kt)("h2",{id:"\u903b\u8f91\u7ed3\u6784"},"\u903b\u8f91\u7ed3\u6784"),(0,l.kt)("h3",{id:"pod"},"pod"),(0,l.kt)("p",null,"pod: \u7531 \u4e00\u4e2a\u6216\u591a\u4e2a\u76f8\u4e92\u5173\u8054\u7684 container \u7ec4\u6210, \u662f k8s \u7ba1\u7406\u7684\u57fa\u672c\u5355\u4f4d, \u4ee3\u8868\u7740\u96c6\u7fa4\u4e2d\u7684\u4e00\u4e2a\u865a\u62df\u4e3b\u673a"),(0,l.kt)("p",null,"\u4e00\u4e2apod \u53ea\u53ef\u80fd\u5b58\u5728\u4e8e\u4e00\u4e2a worker node \u673a\u5668\u4e0a, \u4e0d\u53ef\u8de8\u8282\u70b9"),(0,l.kt)("p",null,"\u4e00\u4e2a pod \u5185\u7684\u6240\u6709\u5bb9\u5668\u5171\u4eab\u76f8\u540c\u7684 Linux network \u547d\u540d\u7a7a\u95f4. \u8fd9\u6837\u6bcf\u4e2a pod \u5c31\u50cf\u4e00\u53f0\u72ec\u7acb\u7684 \u4e3b\u673a, \u6709\u81ea\u5df1\u7684 ip (\u96c6\u7fa4\u5185\u90e8\u5730\u5740), \u4e3b\u673a\u540d, \u7aef\u53e3 (pod \u4e2d\u7684 containers \u5171\u4eab \u8be5 ip \u4ee5\u53ca \u7aef\u53e3\u7a7a\u95f4, \u5177\u6709\u76f8\u540c\u7684 loopback \u7f51\u7edc\u63a5\u53e3,\u53ef\u4f7f\u7528 localhost\u76f8\u4e92\u901a\u4fe1). "),(0,l.kt)("p",null,"\u53ef\u4ee5\u548c docker-compose \u542f\u52a8\u7684\u591a\u4e2a container \u7c7b\u6bd4"),(0,l.kt)("h3",{id:"volume"},"volume"),(0,l.kt)("p",null,"\u5728 pod \u4e2d\u53ef\u8bbf\u95ee\u7684\u6587\u4ef6\u76ee\u5f55"),(0,l.kt)("p",null,"\u53ef\u88ab\u6302\u8f7d\u5230 pod \u4e2d\u7684\u4e00\u4e2a/\u591a\u4e2a container \u7684\u6307\u5b9a\u8def\u5f84 \u4e0b"),(0,l.kt)("h3",{id:"controllers"},"controllers"),(0,l.kt)("p",null,"pod \u63a7\u5236\u5668, \u90e8\u7f72/\u7ba1\u7406 pods"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"replicaSet \u521b\u5efa/\u590d\u5236  pod \u5b9e\u4f8b, \u786e\u4fdd pod \u526f\u672c\u6570\u91cf, \u7528\u6765\u4ee3\u66ff replication Controller , \u4f46\u662f\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528Replica Sets\u8bbe\u7f6e\uff0c\u800c\u662f\u8981\u4f7f\u7528Deployments\u3002Deployments\u5305\u88c5\u4e86Replica Sets\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e\u5e76\u6dfb\u52a0\u56de\u6eda\u66f4\u65b0\u5347\u7ea7\u529f\u80fd")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Deployment \u65e0\u72b6\u6001\u5e94\u7528\u90e8\u7f72, \u6307\u5b9a\u4e00\u7ec4 pod \u7684\u526f\u672c\u6570\u91cf, \u7248\u672c; \u4e00\u6b21 deployment \u4f1a\u4ea7\u751f\u591a\u4e2a pods"),(0,l.kt)("p",{parentName:"li"},"  \u7ba1\u7406 ReplicaSet, \u652f\u6301\u6eda\u52a8\u66f4\u65b0")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"StatefulSet \u6709\u72b6\u6001\u5e94\u7528\u90e8\u7f72 (\u5982 MySQL)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"daemonset \u786e\u4fdd\u6bcf\u4e2a node  \u90fd\u8fd0\u884c\u4e00\u4e2a\u6307\u5b9a pod")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"job \u4e00\u6b21\u6027\u4efb\u52a1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"cronjob \u5b9a\u65f6\u4efb\u52a1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"replication Controller: \u7528\u4e8e\u521b\u5efa/\u590d\u5236  pod \u5b9e\u4f8b. \u786e\u4fdd pod \u5b9e\u4f8b\u6570\u7b26\u5408\u8981\u6c42"),(0,l.kt)("p",{parentName:"li"},"  ",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl run ...")," \u4f1a\u521b\u5efa\u4e00\u4e2a rc\uff0c \u7136\u540e rc \u521b\u5efa pod \uff08\u6240\u4ee5\u5220\u9664\u8fd9\u6837\u7684 pod\uff0c \u9700\u8981\u5148\u5220\u9664 rc\uff09"),(0,l.kt)("p",{parentName:"li"},"  \u5de5\u4f5c\u6d41\u7a0b\uff1a\u5bfb\u627e \u7b26\u5408 label selector \u7684pod\uff0c \u6bd4\u8f83\u627e\u5230\u7684 pod \u548c\u671f\u671b\u6570\u91cf\uff0c \u5c11\u4e86\u5c31\u4ece\u5f53\u524d\u6a21\u677f\u521b\u5efa\u65b0\u7684 pod \u526f\u672c \uff0c \u591a\u4e86\uff0c \u5c31\u5220\u9664\u591a\u7684 pod"),(0,l.kt)("p",{parentName:"li"},"  \u4e09\u4e2a\u90e8\u5206\uff1a"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"label selector\uff1a \u7528\u4e8e\u786e\u5b9aReplicationController\u4f5c\u7528\u57df\u4e2d\u6709\u54ea\u4e9b pod")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"replica count (\u526f\u672c\u4e2a\u6570\uff09\uff0c \u6307\u5b9a\u5e94\u8fd0\u884c\u7684pod \u6570\u91cf")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"pod template (pod\u6a21\u677f\uff09\uff0c \u7528\u4e8e\u521b\u5efa\u65b0\u7684pod \u526f\u672c"),(0,l.kt)("p",{parentName:"li"},"\u5728\u65b0\u7248\u7684 K8s \u4e2d\uff0c\u5efa\u8bae\u4f7f\u7528 ReplicaSet \u4f5c\u4e3a\u526f\u672c\u63a7\u5236\u5668\uff0cReplicationController \u4e0d\u518d\u4f7f\u7528\u4e86"))))),(0,l.kt)("h3",{id:"service"},"service"),(0,l.kt)("p",null,"\u66b4\u9732 \u96c6\u7fa4\u5185\u90e8\u7684\u4e00\u7ec4 pods \u7684\u5916\u90e8\u8bbf\u95ee\u63a5\u53e3, \u4f9b\u5916\u90e8\u8bbf\u95ee, \u4ee5\u8d1f\u8f7d\u5747\u8861. \u6709\u81ea\u5df1\u7684\u9759\u6001 ip"),(0,l.kt)("p",null,"\u7c7b\u4f3c \u7f51\u5173\u7684\u89d2\u8272, \u901a\u8fc7\u67d0\u4e2a service, \u53ef\u8bbf\u95ee\u4e00\u7ec4\u63d0\u4f9b\u76f8\u540c\u670d\u52a1\u7684 pods"),(0,l.kt)("p",null,"\u53e6\u4e00\u4e2a\u65b9\u6cd5\u662f\uff1a \u7aef\u53e3\u8f6c\u53d1 ",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl port-forward"),", \u7528\u4e8e\u4e34\u65f6\u8c03\u8bd5"),(0,l.kt)("h3",{id:"flannel"},"flannel"),(0,l.kt)("p",null,"\u662fCoreOS\u56e2\u961f\u9488\u5bf9Kubernetes\u8bbe\u8ba1\u7684\u4e00\u4e2a\u7f51\u7edc\u89c4\u5212\u670d\u52a1\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5b83\u7684\u529f\u80fd\u662f\u8ba9\u96c6\u7fa4\u4e2d\u7684\u4e0d\u540c\u8282\u70b9\u4e3b\u673a\u521b\u5efa\u7684Docker\u5bb9\u5668\u90fd\u5177\u6709\u5168\u96c6\u7fa4\u552f\u4e00\u7684\u865a\u62dfIP\u5730\u5740, \u8ba9\u5c5e\u4e8e\u4e0d\u540c\u8282\u70b9\u4e0a\u7684\u5bb9\u5668\u80fd\u591f\u76f4\u63a5\u901a\u8fc7\u5185\u7f51IP\u901a\u4fe1"),(0,l.kt)("h3",{id:"ingress"},"ingress"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://mritd.com/2017/03/04/how-to-use-nginx-ingress/"},"https://mritd.com/2017/03/04/how-to-use-nginx-ingress/")),(0,l.kt)("p",null,"\u7528\u6765\u8def\u7531\u591a\u4e2a service, \u76f8\u5f53\u4e8e nginx, \u5e38\u7528\u7684\u5b9e\u73b0\u662f ingress-nginx"),(0,l.kt)("p",null,"\u539f\u7406: Ingress Contronler \u901a\u8fc7\u4e0e Kubernetes API \u4ea4\u4e92\uff0c\u52a8\u6001\u7684\u53bb\u611f\u77e5\u96c6\u7fa4\u4e2d Ingress \u89c4\u5219\u53d8\u5316\uff0c\u7136\u540e\u8bfb\u53d6\u5b83\uff0c\u6309\u7167\u81ea\u5b9a\u4e49\u7684\u89c4\u5219\uff0c\u89c4\u5219\u5c31\u662f\u5199\u660e\u4e86\u54ea\u4e2a\u57df\u540d\u5bf9\u5e94\u54ea\u4e2aservice\uff0c\u751f\u6210\u4e00\u6bb5 Nginx \u914d\u7f6e\uff0c\u518d\u5199\u5230 Nginx-ingress-control\u7684 Pod \u91cc\uff0c\u8fd9\u4e2a Ingress Contronler \u7684pod\u91cc\u9762\u8fd0\u884c\u7740\u4e00\u4e2anginx\u670d\u52a1\uff0c\u63a7\u5236\u5668\u4f1a\u628a\u751f\u6210\u7684nginx\u914d\u7f6e\u5199\u5165/etc/nginx.conf\u6587\u4ef6\u4e2d\uff0c\u7136\u540e reload \u4e00\u4e0b \u4f7f\u7528\u914d\u7f6e\u751f\u6548\u3002\u4ee5\u6b64\u6765\u8fbe\u5230\u57df\u540d\u5206\u914d\u7f6e\u53ca\u52a8\u6001\u66f4\u65b0\u7684\u95ee\u9898\u3002"),(0,l.kt)("h3",{id:"name-namespace"},"name namespace"),(0,l.kt)("p",null,"k8s resources name , every resouece have its own name, kind, metadata, spec, status..."),(0,l.kt)("p",null,"namespace: isolate all all kinds of resources. resources of the same kind cannot have the same name in the same namespace"),(0,l.kt)("p",null,"default init namespece: default, kube-system"),(0,l.kt)("h2",{id:"\u8d44\u6e90\u63cf\u8ff0\u6587\u4ef6"},"\u8d44\u6e90\u63cf\u8ff0\u6587\u4ef6"),(0,l.kt)("h3",{id:"\u901a\u8fc7\u547d\u4ee4\u751f\u6210-yml"},"\u901a\u8fc7\u547d\u4ee4\u751f\u6210 yml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl create deployment tomcat6 --image=tomcat:6.0.53-jre8 --dry-run -o yaml > tomcat6.yml\n\nkubectl apply -f xxx.yaml\n\n\n")),(0,l.kt)("h3",{id:"pod-\u7684--yaml-\u63cf\u8ff0\u6587\u4ef6"},"pod \u7684  yaml \u63cf\u8ff0\u6587\u4ef6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion : v1 #(k8s api server version)\n# Deployment\u3001Job\u3001Ingress\u3001Service\nkind: Pod #(\u5bf9\u8c61\u7c7b\u578b)\nmetadata: #\u5305\u62ec\u540d\u79f0\u3001\u547d\u540d\u7a7a\u95f4\u3001\u6807\u7b7e\u548c\u5173\u4e8e\u8be5\u5bb9\u5668\u7684\u5176\u4ed6\u4fe1\u606f\n    name: kubia-manual\n    # optional, default ns: default\n    namespace: xxx\n    # optional\n    labels:\n        xxx_key: xxx\n        yyy_key: yyy\n# \u5305\u62ec\u4e00\u4e9bcontainer\uff0cstorage\uff0cvolume, \u63a2\u9488...\nspec: \n    containers:\n    - image: xxx\n      name: xxx\n      ports:\n      - containerPost: 8080 # \u5bb9\u5668\u4f1a\u76d1\u542c\u7684\u7aef\u53e3, \u4ec5\u4ec5\u662f\u5c55\u793a, \u6ca1\u6709 \u6307\u5b9a\u4f5c\u7528\n        protocal: TCP\n    resources:\n        requests:\n            cpu: 100m\n            memory: 100Mi\n    # \u5b58\u6d3b\u63a2\u9488\uff0c \u7528\u4e8e pod\n    # \u5728\u751f\u4ea7\u4e2d \u8fd0\u884c\u7684pod, \u4e00\u5b9a \u8981\u5b9a\u4e49 \u4e00 \u4e2a\u5b58 \u6d3b\u63a2\u9488\n#   optional\n    livenessProbe:\n    httpGet:\n        path: /\n        port: 8080\n    # \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u521d\u59cb\u5ef6\u8fdf\uff0c\u63a2\u9488\u5c06\u5728\u542f\u52a8\u65f6\u7acb\u5373\u5f00\u59cb\u63a2\u6d4b\u5bb9\u5668\uff0c \u8fd9\u901a\u5e38\u4f1a\u5bfc\u81f4\u63a2\u6d4b\u5931\u8d25\uff0c \u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u8fd8\u6ca1\u51c6\u5907\u597d\u5f00\u59cb\u63a5\u6536\u8bf7\u6c42\u3002 \u5982\u679c\u5931\u8d25\u6b21\u6570\u8d85\u8fc7\u9605\u503c\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\u80fd\u6b63\u786e\u54cd\u5e94\u8bf7\u6c42\u4e4b\u524d\uff0c \u5bb9\u5668\u5c31\u4f1a\u91cd\u542f\u3002\n    initialDelaySeconds: 15 # \u5728\u7b2c\u4e00\u6b21\u63a2\u6d4b\u524d\uff0c \u7b49\u5f85 15s\n    [delay: 0] # \u793a\u5728\u5bb9\u5668\u542f\u52a8\u540e\u7acb\u5373\u5f00\u59cb\u63a2\u6d4b\u3002\n    [timeout: 1] # \u5bb9\u5668\u5fc5\u987b\u57281\u79d2\u5185\u8fdb\u884c\u54cd\u5e94\uff0c \u4e0d\u7136\u8fd9\u6b21\u63a2\u6d4b\u8bb0\u4f5c\u5931\u8d25\n    [period: 10] # \u6bcf10\u79d2\u63a2\u6d4b\u4e00\u6b21\u5bb9\u5668\n    [failure: 3] # \u63a2\u6d4b\u8fde\u7eed\u4e09\u6b21\u5931\u8d25(#fa\u8fbdure= 3)\u540e\u91cd\u542f\u5bb9\u5668\n            \nstatus: #\u5305\u542b\u8fd0\u884c\u4e2d\u7684 po \u7684\u5f53\u524d\u4fe1\u606f\uff0c\u4f8b\u5982 po \u6240\u5904\u7684\u6761\u4ef6 \u6bcf\u4e2a\u5bb9\u5668\u7684\u63cf\u8ff0\u548c\u72b6\u6001\uff0c\u4ee5\u53ca\u5185\u90e8 IP \u548c\u5176\u4ed6\u57fa\u672c\u4fe1\u606f\n\n")),(0,l.kt)("h3",{id:"deployment-\u7684\u63cf\u8ff0\u6587\u4ef6"},"deployment \u7684\u63cf\u8ff0\u6587\u4ef6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  ## optional\n  nodeSelector:\n    gpu: "true" #\u4f7f\u7528 \u6807\u7b7e\u9009\u62e9\u5668\u4f7f\u5f97 pod \u53ea\u88ab\u8c03\u5ea6\u5230\u7b26\u5408\u8981\u6c42\u7684 worker node \n  # optional\n  # select pods that will be affected by this deployment\n  # have to match labels that specified in template.metadata.labels\n  selector:\n    matchLabels:\n      app: nginx\n  # optional\n  replicas: 2 # tells deployment to run 2 pods matching the template\n  # define pods\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:alpine\n        ports:\n        - containerPort: 80\n\n')),(0,l.kt)("h3",{id:"service-1"},"service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: v1\nkind: Service\nmetadata:\n    name: nginx-service\nspec:\n    type: LoadBalancer\n    ports:\n    - name: nginx\n      port: 80\n      targetPort: 80\n    selector:\n        app: nginx\n")),(0,l.kt)("h2",{id:"\u6807\u7b7e"},"\u6807\u7b7e"),(0,l.kt)("p",null,"\u6807\u7b7e (label)\uff1a\u6807\u7b7e\u662f\u53ef\u4ee5\u9644\u52a0\u5230\u8d44\u6e90 (pod, node ...) \u7684\u4efb\u610f\u952e\u503c\u5bf9. \u7528\u6765\u5bf9 \u8d44\u6e90\u8fdb\u884c \u5206\u7c7b\u7ba1\u7406"),(0,l.kt)("p",null,"\u6807\u7b7e\u9009\u62e9\u5668\uff1a\u53ef\u4ee5\u9009\u51fa\u7b26\u5408\u8981\u6c42\u7684 pod \u5b50\u96c6"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5305\u542b/\u4e0d\u5305\u542b \u7279\u5b9a key \u7684 \u8d44\u6e90"),(0,l.kt)("li",{parentName:"ul"},"\u5305\u542b\u7279\u5b9a key\uff0c value \u7684 \u8d44\u6e90"),(0,l.kt)("li",{parentName:"ul"},"\u5305\u542b \u7279\u5b9a key\uff0c \u4e14 value \u548c\u6307\u5b9a\u7684\u4e0d\u540c\u7684\u8d44\u6e90")),(0,l.kt)("h2",{id:"\u6ce8\u89e3"},"\u6ce8\u89e3"),(0,l.kt)("p",null,"\u6ce8\u89e3: TODO"),(0,l.kt)("h2",{id:"\u547d\u540d\u7a7a\u95f4"},"\u547d\u540d\u7a7a\u95f4"),(0,l.kt)("p",null,"K8S namespace: \u4e3a \u5bf9\u8c61\u8d44\u6e90\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4f5c\u7528\u57df, \u5728\u4e0d\u540c\u7684 \u4f5c\u7528\u57df\u4e2d\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u8d44\u6e90\u540d\uff0c \u4f46\u8fd9\u76f8\u540c\u7684\u8d44\u6e90\u540d\u4ee3\u8868\u4e86\u4e0d\u540c\u7684\u8d44\u6e90\u3002 \u7c7b\u6bd4 java package"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u901a\u8fc7 label \u5bf9 pod \u8fdb\u884c\u5206\u7ec4, \u6bcf\u4e2a \u7ec4 \u53ef\u80fd\u6709 pod \u91cd\u53e0, \u901a\u8fc7 k8s namespace \u5206\u7ec4\u53ef\u4ee5\u5b8c\u5168\u907f\u514d\u91cd\u53e0")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"ns \u53ea\u9694\u79bb\u8d44\u6e90\uff0c \u4e0d\u9694\u79bb\u8fd0\u884c\u7684\u5bf9\u8c61 \uff08\u8d44\u6e90\u5b9e\u4f8b\uff09\uff0c \u5982 \u4e0d\u540cns \u4e2d\u7684 pod \u4ecd\u7136\u53ef\u901a\u4fe1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9002\u7528\u4e8e\u591a\u7528\u6237 \u4f7f\u7528 k8s\uff0c \u9650\u5236\u67d0\u4e2a\u7528\u6237\u7684\u8d44\u6e90\u4f7f\u7528\u91cf"))),(0,l.kt)("p",null,"\u4ece ymal \u6587\u4ef6\u521b\u5efa ns\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind : Namespace\nmetadata:\n    name: custome-ns\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"kubectl create -f custom-ns.yaml")),(0,l.kt)("p",null,"\u901a\u8fc7\u547d\u4ee4\u521b\u5efans\uff1a ",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl create namespace custom-namespace")),(0,l.kt)("p",null,"\u5207\u6362 ns\uff1a ",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl config set-context $(kubectl config current-context) --namespace <other ns>")),(0,l.kt)("h2",{id:"pod-\u7ba1\u7406"},"pod \u7ba1\u7406"),(0,l.kt)("h3",{id:"\u63a2\u6d4b-pod-\u662f\u5426\u5065\u5eb7"},"\u63a2\u6d4b pod \u662f\u5426\u5065\u5eb7"),(0,l.kt)("p",null,"k8s \u4f1a\u4fdd\u6301 pod \u59cb\u7ec8\u6b63\u5e38\u8fd0\u884c\uff0c \u5982\u679c\u5bb9\u5668\u7684\u4e3b\u8fdb\u7a0b\u5d29\u6e83\uff0c Kubelet \u5c06\u91cd\u542f\u5bb9\u5668\u3002 \u5f53\u5bb9\u5668\u88ab\u5f3a\u884c\u7ec8\u6b62\u65f6\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a\u5168\u65b0\u7684\u5bb9\u5668\u2014-\u800c\u4e0d\u662f\u91cd\u542f\u539f\u6765\u7684\u5bb9\u5668"),(0,l.kt)("p",null,"\u4f46\u662f \u8fdb\u7a0b\u6ca1\u6709\u5d29\u6e83\uff0c \u6709\u65f6\u5e94\u7528\u7a0b\u5e8f\u4e5f\u4f1a\u505c\u6b62\u6b63\u5e38\u5de5\u4f5c\u3002 \u4f8b\u5982\uff0c \u5177\u6709\u5185\u5b58\u6cc4\u6f0f\u7684 Java \u5e94\u7528\u7a0b\u5e8f\u5c06\u5f00\u59cb\u629b\u51fa OutOfMemoryErrors, \u4f46 JVM \u8fdb\u7a0b\u4f1a\u4e00\u76f4\u8fd0\u884c"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u65b9\u6cd51: \u4ece app \u5185\u90e8\u81ea\u5df1\u68c0\u6d4b, \u53ef\u4ee5\u5728\u5e94\u7528\u4e2d\u6355\u83b7\u8fd9\u7c7b\u9519\u8bef\uff0c \u5e76\u5728\u9519\u8bef\u53d1\u751f\u65f6\u9000\u51fa\u8be5\u8fdb\u7a0b\u3002"),(0,l.kt)("p",{parentName:"li"},"  \u5b58\u5728\u95ee\u9898: \u5e94\u7528\u56e0\u4e3a\u65e0\u9650\u5faa\u73af\u6216\u6b7b\u9501\u800c\u505c\u6b62\u54cd\u5e94, \u8fd9\u4e2a\u65b9\u6cd5\u5c31\u65e0\u6548\u4e86")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u65b9\u6cd52: \u987b\u4ece\u5916\u90e8\u68c0\u67e5\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u72b6\u51b5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5b58\u6d3b\u63a2\u9488 (liveness probe) - \u68c0\u67e5\u5bb9\u5668\u662f\u5426\u8fd8\u5728\u8fd0\u884c"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"HTTP GET \u63a2\u9488, \u8fd4\u56de 2xx, 3xx \u5219\u4ee3\u8868\u6b63\u5e38, \u4e0d\u91cd\u542f")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"TCP\u5957\u63a5\u5b57\u63a2\u9488, \u548c pod \u6b63\u5e38\u5efa\u7acb \u94fe\u63a5, \u6b63\u5e38, \u4e0d\u91cd\u542f")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Exec\u63a2\u9488 , \u8fdb\u5165 pod \u67d0\u4e2a container, \u6267\u884c\u4efb\u610f\u547d\u4ee4, \u5e76\u68c0\u67e5\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801\u3002\u5982\u679c\u72b6\u6001\u7801\u662f 0, \u5219\u63a2\u6d4b\u6210\u529f"))))))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind : Pod\nmetadata:\n    name: custome-pod\nspec:\n    containers:\n        - image: xxx\n          name: xxx\n          livenessProbe:\n            httpGet:\n                path: /\n                port: 8080\n")),(0,l.kt)("h3",{id:"pod-\u526f\u672c"},"pod \u526f\u672c"),(0,l.kt)("p",null,"ReplicationController \u662f\u4e00\u79cdKubernetes\u8d44\u6e90\uff0c\u8d1f\u8d23\u521b\u5efa\u548c\u7ba1\u7406 pod \u526f\u672c"),(0,l.kt)("p",null,"\u88ab ReplicationController \u521b\u5efa\u7684 pod \u4e3a \u201c\u6258\u7ba1 pod\u201d\uff0c \u76f4\u63a5\u521b\u5efa\u7684 pod \u4e3a \u201c\u975e\u6258\u7ba1 pod\u201d\u3002\u6258\u7ba1 pod \u5f02\u5e38\u9000\u51fa \uff08\u5982 worker node \u5d29\u6e83\uff0c \u6216 \u8be5 pod \u5d29\u6e83\uff09\u540e\uff0c ReplicationController \u4f1a \u521b\u5efa\u65b0\u7684 pod \u4ee3\u66ff"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Replicationcontroller\nmetadata:\n    name: kubia\nspec:\n    replicas: 3\n    # \u5b9a\u4e49ReplicationController\u65f6\u4e0d\u8981\u6307\u5b9a \u9009\u62e9\u5668\uff0c\u8ba9Kubemetes\u4ecepod\u6a21\u677f\u4e2d\u63d0\u53d6\u5b83\u3002\u8fd9\u6837YAML\u66f4\u7b80\u77ed\u3002\n    # rc \u521b\u5efa\u540e\uff0c label selector \u4e0d\u4f1a\u518d\u66f4\u6539\n    # \u4e00\u822c\u521b\u5efa\u540e\u4f1a\u66f4\u6539 template\n    [selector:\n        app: kubia]\n    # \u521b\u5efa\u65b0 pod \u6240\u7528\u7684 \u6a21\u677f\n    template:\n        metadata:\n            # \u8fd9\u91cc\u7684 \u6807\u7b7e\u5fc5\u987b\u548c \u524d\u9762\u7684 \u6807\u7b7e\u9009\u62e9\u5668 \u5339\u914d\uff0c \u5426\u5219\u5c06\u65e0\u4f11\u6b62\u5730\u521b\u5efa\u65b0\u7684\u5bb9\u5668\n            labels:\n                app: kubia\n            spec:\n                containers:\n                    - name: kubia\n                      image: luksa/kubia\n                      ports:\n                        - containerPort: 8080\n\n\n")),(0,l.kt)("p",null,"kubectl create -f kubia-rc.yaml"),(0,l.kt)("p",null,"rc \u521b\u5efa\u540e\uff0c\u7531\u4e8e\u6ca1\u6709\u4efb\u4f55pod\u6709app=kubia\u6807\u7b7e\uff0c ReplicationController\u4f1a\u6839\u636epod\u6a21\u677f\u542f\u52a8\u4e09\u4e2a\u65b0\u7684pod"),(0,l.kt)("p",null,"\u7531ReplicationController\u521b\u5efa\u7684pod\u5e76\u4e0d\u662f\u7ed1\u5b9a\u5230ReplicationController\u3002 \u5728\u4efb\u4f55\u65f6\u523b\uff0c ReplicationController\u7ba1\u7406\u4e0e\u6807\u7b7e\u9009\u62e9\u5668\u5339\u914d\u7684pod\u3002 \u901a \u8fc7\u66f4\u6539pod\u7684\u6807\u7b7e\uff0c \u53ef\u4ee5\u5c06\u5b83 \u4eceReplicationController\u7684\u4f5c\u7528\u57df\u4e2d\u6dfb\u52a0\u6216\u5220\u9664 "),(0,l.kt)("p",null,"\u5c3d\u7ba1\u4e00\u4e2a pod \u6ca1\u6709\u7ed1\u5b9a\u5230\u4e00\u4e2a ReplicationController \uff0c\u4f46 pod \u5728 metadata.ownerReferences \u4e2d\u5f15\u7528\u5b83 \u4ee5\u8f7b\u677e\u4f7f\u7528\u5b83 \u6765\u627e\u5230\u4e00 pod \u7684 Replication controller"),(0,l.kt)("p",null,"\u5347\u7ea7 pod \u53ef\u4ee5\u8fd9\u4e48\u505a\uff1a\u7f16\u8f91 rc \u7684template \u540e\uff0c \u5220\u9664 \u6240\u6709\u8981\u5347\u7ea7\u7684 pod\uff0c rc \u4f1a\u81ea\u52a8\u521b\u5efa\u5347\u7ea7\u540e\u7684 pod"),(0,l.kt)("p",null,"================\u6c34\u5e73\u7f29\u6269\u5bb9\uff1a"),(0,l.kt)("p",null,"\u65b9\u6cd51\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl scale re kubia --replicas=3 ")," "),(0,l.kt)("p",null,"\u65b9\u6cd52\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl edit re kubia")," \u66f4\u65b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"spec.replicas")," \u503c"),(0,l.kt)("p",null,"======================\u65b0\u7684\u66ff\u4ee3\u8005 ReplicaSet"),(0,l.kt)("p",null,"ReplicaSet\uff1aReplicaSet \u7684\u884c\u4e3a\u4e0eReplicationController \u5b8c\u5168\u76f8\u540c\uff0c \u4f46\u6807\u7b7e\u9009\u62e9\u5668\u7684\u8868\u8fbe\u80fd\u529b\u66f4\u5f3a\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5355\u4e2a rc \u65e0\u6cd5\u5c06 pod \u4e0e \uff08 label env=prod \u548c env=dev \uff09 \u540c\u65f6\u5339\u914d\uff0c\u5b83\u53ea\u80fd\u5339\u914d\u5e26\u6709 env=devel \u6807\u7b7e\u7684 pod \u6216\u5e26\u6709env=dev \u6807\u7b7e\u7684 pod"),(0,l.kt)("li",{parentName:"ul"},"rs \u53ef\u4ee5\u4ec5\u4ec5\u6839\u636e \u662f\u5426\u6709 label key \u5b58\u5728 \u6765\u5339\u914d")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: apps/v1beta2\nkind: ReplicaSet\nmetadata:\n    name: kubia\nspec:\n    replicas: 3\n    selector:\n        # \u6307\u5b9a\u4e86\u591a\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5219\u6240\u6709\u8fd9\u4e9b\u8868\u8fbe\u5f0f\u90fd\u5fc5\u987b\u4e3atrue\u624d\u80fd\u4f7f\u9009\u62e9\u5668\u4e0e\n        # pod\u5339\u914d\u3002\u5982\u679c\u540c\u65f6\u6307\u5b9amatchLabels\u548cmatchExpressions, \u5219\u6240\u6709\u6807\u7b7e\u90fd\n        # \u5fc5\u987b\u5339\u914d\uff0c\u5e76\u4e14\u6240\u6709\u8868\u8fbe\u5f0f\u5fc5\u987b\u8ba1\u7b97\u4e3atrue\u4ee5\u4f7f\u8be5pod\u4e0e\u9009\u62e9\u5668\u5339\u914d\n        [matchLabels:\n            hah: hoo]\n        matchExpressions:\n            - key: hah # \u8981\u6c42 pod \u5305\u542b key \u4e3a hah \u7684 label\n              # \u8981\u6c42 label \u503c\u4e3a hoo\n              # operator \u53ef\u9009 In (label \u503c\u9700\u8981\u5339\u914d value \u4e2d\u7684\u4e00\u4e2a), NotIn \uff08label \u503c\u9700\u8981\u4e0d\u5728 values \u4e2d\uff09\uff0cExists \uff08label \u5fc5\u987b\u6709\u6307\u5b9a key\uff0c\u4e0d\u6307\u5b9a values\uff09\n              # DoesNotExist \uff08pod\u4e0d\u5f97\u5305\u542b\u6709\u6307\u5b9a\u540d\u79f0\u7684\u6807\u7b7e\u3002values\u5c5e\u6027\u4e0d\u5f97\u6307\u5b9a\uff09\n              operator: In \n              values: \n                - hoo\n    # \u521b\u5efa\u65b0 pod \u6240\u7528\u7684 \u6a21\u677f\n    template:\n        metadata:\n            # \u8fd9\u91cc\u7684 \u6807\u7b7e\u5fc5\u987b\u548c \u524d\u9762\u7684 \u6807\u7b7e\u9009\u62e9\u5668 \u5339\u914d\uff0c \u5426\u5219\u5c06\u65e0\u4f11\u6b62\u5730\u521b\u5efa\u65b0\u7684\u5bb9\u5668\n            labels:\n                hah: hoo\n            spec:\n                containers:\n                    - name: kubia\n                      image: luksa/kubia\n                      ports:\n                        - containerPort: 8080\n\n\n")),(0,l.kt)("p",null,"================ DaemonSet \u5728\u6bcf\u4e2a worker node \u4e0a\u90e8\u7f72\u4e00\u4e2a pod "),(0,l.kt)("p",null,"\u7528\u6765\u8fd0\u884c\u7cfb\u7edf\u670d\u52a1\uff0c\u5982 kube-proxy"),(0,l.kt)("p",null,"DaemonSet \u7ba1\u7406\u4e0b\u7684 pod \u4e0d\u662f\u968f\u673a\u5206\u5e03\u5728 worker node \u4e0a\uff0c \u800c\u662f\u4fdd\u8bc1 \u6bcf\u4e2a node \u53ea\u5b58\u5728\u4e00\u4e2a pod\u3002 "),(0,l.kt)("p",null,"\u82e5 node \u4e0b\u7ebf\uff0c DaemonSet \u4e0d\u4f1a\u5728\u5176\u4ed6\u5730\u65b9\u521b\u5efa\u65b0\u7684 pod\uff0c \u4f46\u662f\u5f53\u67d0\u4e2a node  \u7684 pod \u88ab\u610f\u5916\u5220\u9664\uff0c\u4f1a\u91cd\u65b0\u521b\u5efa\u65b0\u7684 pod \u4ee3\u66ff"),(0,l.kt)("p",null,"\u4f46\u662f \u5f53\u65b0\u7684 node \u6dfb\u52a0\u8fdb \u96c6\u7fa4\uff0c DaemonSet \u4f1a\u7acb\u5373\u90e8\u7f72\u4e00\u4e2a\u65b0 pod \u5230\u8fd9\u4e2a node\u3002"),(0,l.kt)("p",null,"\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"spec.nodeSelector")," (\u8282\u70b9\u9009\u62e9\u5668\uff0c\u539f\u7406\u662f\u7ed9 node \u6253\u6807\u7b7e) \u53ea\u5728\u7279\u5b9a node \u90e8\u7f72 pod"),(0,l.kt)("p",null,"======================= Deployment ======= \u66f4\u52a0\u65b9\u4fbf\u7684\u7ba1\u7406 Replica Set"),(0,l.kt)("p",null,"Deployment \u989d\u5916\u7684\u7279\u6027\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e8b\u4ef6\uff0c\u72b6\u6001\u67e5\u770b\uff1a\u53ef\u4ee5\u67e5\u770bDeployment\u7684\u5347\u7ea7\u8be6\u7ec6\u8fdb\u5ea6\u548c\u72b6\u6001")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u56de\u6eda\uff1a\u5f53\u5347\u7ea7pod\u955c\u50cf\u6216\u8005\u76f8\u5173\u53c2\u6570\u7684\u65f6\u5019\u53d1\u73b0\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u56de\u6eda\u64cd\u4f5c\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7a33\u5b9a\u7684\u7248\u672c\u6216\u8005\u6307\u5b9a\u7684\u7248\u672c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u7248\u672c\u8bb0\u5f55: \u6bcf\u4e00\u6b21\u5bf9Deployment\u7684\u64cd\u4f5c\uff0c\u90fd\u80fd\u4fdd\u5b58\u4e0b\u6765\uff0c\u7ed9\u4e88\u540e\u7eed\u53ef\u80fd\u7684\u56de\u6eda\u4f7f\u7528")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6682\u505c\u548c\u542f\u52a8\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u5347\u7ea7\uff0c\u90fd\u80fd\u591f\u968f\u65f6\u6682\u505c\u548c\u542f\u52a8")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u591a\u79cd\u5347\u7ea7\u65b9\u6848\uff1a"),(0,l.kt)("p",{parentName:"li"},"  Recreate\uff1a\u5220\u9664\u6240\u6709\u5df2\u5b58\u5728\u7684pod,\u91cd\u65b0\u521b\u5efa\u65b0\u7684; "),(0,l.kt)("p",{parentName:"li"},"  RollingUpdate\uff1a\u6eda\u52a8\u5347\u7ea7\uff0c\u9010\u6b65\u66ff\u6362\u7684\u7b56\u7565\uff0c\u540c\u65f6\u6eda\u52a8\u5347\u7ea7\u65f6\uff0c\u652f\u6301\u66f4\u591a\u7684\u9644\u52a0\u53c2\u6570\uff0c\u4f8b\u5982\u8bbe\u7f6e\u6700\u5927\u4e0d\u53ef\u7528pod\u6570\u91cf\uff0c\u6700\u5c0f\u5347\u7ea7\u95f4\u9694\u65f6\u95f4\u7b49\u7b49\u3002"))),(0,l.kt)("p",null,"================= HPA \u5f39\u6027\u4f38\u7f29 \u6839\u636e\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u81ea\u52a8\u7f29\u6269\u5bb9"),(0,l.kt)("h3",{id:"\u8fd0\u884c\u5355\u4e2a\u4efb\u52a1-job"},"\u8fd0\u884c\u5355\u4e2a\u4efb\u52a1 Job"),(0,l.kt)("p",null,"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c \u6211\u4eec\u53ea\u8c08\u8bba\u4e86\u9700\u8981\u6301\u7eed\u8fd0\u884c\u7684 pod\uff0c \u8fd9\u4e9b pod \u7531 rc\uff0c rs\uff0c ds \u7ba1\u7406\u3002 \u4f60\u4f1a\u9047\u5230\u53ea\u60f3\u8fd0\u884c\u5b8c\u6210\u5de5\u4f5c\u540e\u5c31\u7ec8\u6b62\u4efb\u52a1\u7684\u6e05\u51b5\uff0c \u8fd9\u79cd pod \u7531 Job \u7ba1\u7406"),(0,l.kt)("p",null,"\u8be5 pod \u5728\u5185\u90e8\u8fdb\u7a0b\u6210\u529f\u7ed3\u675f\u65f6\uff0c \u4e0d\u91cd\u542f\u5bb9\u5668\u3002\u4e00\u65e6\u4efb\u52a1\u5b8c\u6210\uff0c pod \u5c31\u88ab\u8ba4\u4e3a\u5904\u5343\u5b8c\u6210\u72b6\u6001"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: batch/v1\nkind: Job\nmetadata:\n    name: ba\u4e03ch-job\nspec:\n    [completions: 5] # \u987a\u5e8f\u8fd0\u884c 5 \u4e2a pod\n    [parallelism: 2] # \u6700\u591a\u53ef\u4ee5 2 \u4e2a pod \u5e76\u884c\u8fd0\u884c\n    [activeDeadlineSeconds: 120] # job \u8d85\u65f6\u65f6\u95f4\uff0c\u82e5 pod \u8d85\u65f6\u8fd8\u6ca1\u7ed3\u675f\uff0c\u7cfb\u7edf\u5c06\u7ec8\u6b62 pod\uff0c \u6807\u8bb0 job \u4e3a\u5931\u8d25\n    [backOffLimit: 6] # job \u6807\u8bb0\u4e3a\u5931\u8d25\u524d\u7684\u91cd\u8bd5\u6b21\u6570\uff0c \u9ed8\u8ba4 6\n    template:\n        metadata:\n            # Job \u7684 pod \u9009\u62e9\u5668 \u5c06\u81ea\u52a8\u6839\u636e\u8fd9\u91cc\u7684 labels \u521b\u5efa\n            labels:\n                app: batch-job\n        spec:\n            # \u91cd\u542f\u7b56\u7565\uff0c \u6307\u5b9a \u5bb9\u5668\u4e2d\u8fdb\u7a0b\u7ed3\u675f\u540e\uff0c k8s \u505a\u4ec0\u4e48\n            # \u4e0d\u80fd\u662f \u9ed8\u8ba4\u7684 Always\n            # \u8fd9\u91cc Never \u4ea6\u53ef\n            restartPolicy: OnFailure\n            containers:\n                - name: main\n                  image: luksa/batch-job\n\n")),(0,l.kt)("h3",{id:"\u5b9a\u65f6\u4efb\u52a1-cronjob"},"\u5b9a\u65f6\u4efb\u52a1 CronJob"),(0,l.kt)("p",null,"TODO"),(0,l.kt)("h2",{id:"pod-\u901a\u4fe1"},"pod \u901a\u4fe1"),(0,l.kt)("h3",{id:"proxy"},"proxy"),(0,l.kt)("h3",{id:"service-2"},"Service"),(0,l.kt)("p",null,"pods \u6709\u81ea\u5df1\u7684\u5185\u90e8\u5730\u5740, \u4f46\u662f\u65e0\u6cd5\u4ece cluster \u5916\u90e8\u8bbf\u95ee, \u901a\u8fc7 service \u53ef\u4ee5\u66b4\u9732\u5230 cluster \u5916\u90e8"),(0,l.kt)("p",null,"service \u662f\u4e00\u4e2a\u903b\u8f91\u7ed3\u6784, \u5b9a\u4e49\u4e00\u7cfb\u5217 pods, \u4ee5\u53ca\u4ed6\u4eec\u7684\u8bbf\u95ee\u7b56\u7565(\u901a\u8fc7\u7c7b\u578b\u6307\u5b9a)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ClusterIP (default): \u53ea\u80fd\u5728 cluster \u5185\u90e8\u8bbf\u95ee\u5230 service"),(0,l.kt)("li",{parentName:"ul"},"NodePort: \u5916\u90e8\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"<NodeIP>:<NodePort>")," \u8bbf\u95ee service"),(0,l.kt)("li",{parentName:"ul"},"LoadBalancer: \u7ed9 service \u5206\u914d\u4e00\u4e2a\u9759\u6001 ip, \u53ef\u4ee5\u8d1f\u8f7d\u5747\u8861\u591a\u4e2a pods"),(0,l.kt)("li",{parentName:"ul"},"ExternalName: \u901a\u8fc7\u968f\u673a\u540d\u5b57\u8bbf\u95ee service (\u53ef\u901a\u8fc7 externalName \u5728\u914d\u7f6e\u4e2d\u6307\u5b9a). This type requires v1.7 or higher of kube-dns.")),(0,l.kt)("p",null,"a default service named kubernetes will be created with type ClusterIP"),(0,l.kt)("p",null,"\u53ef\u4ee5\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6, \u6307\u5b9a\u6807\u7b7e\u9009\u62e9\u5668, \u9009\u62e9\u5305\u542b\u54ea\u4e9b pods"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"")),(0,l.kt)("h3",{id:"pod-\u95f4\u901a\u4fe1"},"pod \u95f4\u901a\u4fe1"),(0,l.kt)("p",null,"Service"),(0,l.kt)("p",null,"\u4f5c\u7528\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u670d\u52a1\u7684\u4e3b\u8981\u76ee\u6807\u5c31\u662f\u4f7f\u96c6\u7fa4\u5185\u90e8\u7684\u5176\u4ed6pod\u53ef\u4ee5\u8bbf\u95ee\u5f53\u524d\u8fd9\u7ec4pod"),(0,l.kt)("li",{parentName:"ul"},"\u5bf9\u5916\u66b4\u9732\u670d\u52a1")),(0,l.kt)("p",null,"\u5982\u4f55\u521b\u5efa\uff1f"),(0,l.kt)("p",null,"\u65b9\u5f0f1\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl expose rc kubia --type=LoadBalancer --name kubia-http")),(0,l.kt)("p",null,"\u65b9\u5f0f2\uff1a\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl create -f xxx-service.yml")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Service\nmetadata:\n    name: kubia\nspec:\n    # \u914d\u7f6e\u4f1a\u8bdd\u4eb2\u548c\u6027\n    # \u7279\u5b9a\u5ba2\u6237\u7aef\u4ea7\u751f\u7684\u6240\u6709\u8bf7\u6c42\u6bcf\u6b21\u90fd\u6307\u5411\u540c \u4e00\u4e2a pod\n    # \u8fd8\u53ef\u9009 None\uff0c \u9ed8\u8ba4\u503c\u3002\u4e0d\u652f\u6301 cookie\n    [sessionAffinity: ClientIP]\n    ports:\n      - port: 80 # service \u7684\u53ef\u7528\u7aef\u53e3\n        # \u53ef\u4ee5\u5f15\u7528 Pod \u4e2d \u7684 port name\n        targetPort: 8080 # service\u5c06\u94fe\u63a5\u8f6c\u53d1\u5230 \u5bb9\u5668\u7684\u7aef\u53e3\n        # \u4e0d\u662f\u5fc5\u987b\uff0c \u591a\u7aef\u53e3\u6620\u5c04\u5fc5\u987b\n        [name: xxx]\n    selector:\n        app: kubia\n")),(0,l.kt)("p",null,"\u591a\u7aef\u53e3\u6620\u5c04"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Service\nmetadata:\n    name: kubia\nspec:\n    # \u914d\u7f6e\u4f1a\u8bdd\u4eb2\u548c\u6027\n    # \u7279\u5b9a\u5ba2\u6237\u7aef\u4ea7\u751f\u7684\u6240\u6709\u8bf7\u6c42\u6bcf\u6b21\u90fd\u6307\u5411\u540c \u4e00\u4e2a pod\n    # \u8fd8\u53ef\u9009 None\uff0c \u9ed8\u8ba4\u503c\u3002\u4e0d\u652f\u6301 cookie\n    [sessionAffinity: ClientIP]\n    ports:\n      - port: 80 # service \u7684\u53ef\u7528\u7aef\u53e3\n        targetPort: 8080 # service\u5c06\u94fe\u63a5\u8f6c\u53d1\u5230 \u5bb9\u5668\u7684\u7aef\u53e3\n        name: xxx\n      - port: 443\n        targetPort: 8443\n        name: yyy\n    selector:\n        app: kubia\n")),(0,l.kt)("p",null,"\u5982\u4f55\u53d1\u73b0 service"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u53d1\u73b0\u670d\u52a1"),(0,l.kt)("p",{parentName:"li"},"  \u6bcf\u4e2a pod \u5185\u4f1a\u6709\u73af\u5883\u53d8\u91cf\u8868\u793a Service ip \uff08",(0,l.kt)("inlineCode",{parentName:"p"},"<pod name>_SERVICE_HOST"),"\uff09\uff0c port (",(0,l.kt)("inlineCode",{parentName:"p"},"<pod name>_SERVICE_PORT"),")")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u901a\u8fc7  dns"),(0,l.kt)("p",{parentName:"li"},"  kube-system ns \u4e2d\u6709\u4e2a pod \u4e3a kube-dns\uff0c\u5c31\u662f dns server\u3002\u5728\u96c6\u7fa4 \u4e2d\u7684\u5176\u4ed6 pod \u90fd\u88ab\u914d\u7f6e\u6210\u4f7f\u7528\u5176\u4f5c\u4e3a dns ( Kubemetes \u901a\u8fc7\u4fee\u6539\u5bb9\u5668\u7684 /etc/resolv.conf \u5b9e\u73b0\uff09\u3002\u8fd0\u884c\u5728 pod \u4e0a\u7684\u8fdb\u7a0b DNS \u67e5\u8be2\u90fd\u4f1a\u88ab Kubemetes \u81ea\u8eab\u7684 DNS \u52a1\u5668\u54cd\u5e94"),(0,l.kt)("p",{parentName:"li"},"  pod \u662f\u5426\u4f7f\u7528\u5185\u90e8\u7684 DNS \u670d\u52a1\u5668\u662f\u6839\u636e pod \u7684 spec.dnsPolicy \u5c5e\u6027\u6765\u51b3\u5b9a\u7684")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u901a\u8fc7 FQDN \uff08\u5168\u9650\u5b9a\u57df\u540d\uff09 \u8fde\u63a5\u670d\u52a1"),(0,l.kt)("p",{parentName:"li"},"  ",(0,l.kt)("inlineCode",{parentName:"p"},"curl http://kubia.default.svc.cluster.local ")))),(0,l.kt)("h3",{id:"\u901a\u8fc7-service-\u8fde\u63a5\u5916\u90e8\u670d\u52a1"},"\u901a\u8fc7 Service \u8fde\u63a5\u5916\u90e8\u670d\u52a1"),(0,l.kt)("p",null,"pod  \u5982\u4f55\u8bbf\u95ee k8s \u5916\u90e8 \u670d\u52a1\uff1f"),(0,l.kt)("h4",{id:"\u901a\u8fc7\u624b\u52a8\u751f\u6210-endpoint"},"\u901a\u8fc7\u624b\u52a8\u751f\u6210 endpoint"),(0,l.kt)("p",null,"Service \u548c pod \u4e2d\u95f4\u4e0d\u662f\u76f4\u63a5\u76f8\u8fde\uff0c \u800c\u662f\u63d2\u7740 Endpoint\uff0c\u5c31\u662f\u4e00\u4e2a ip:port \u5217\u8868\uff0c\u5728\u521b\u5efa Service \u65f6 \u6839\u636e \u8be5\u670d\u52a1\u7684 label selector \u4ea7\u751f"),(0,l.kt)("p",null,"\u5982\u679c Service \u6ca1\u6709\u6307\u5b9a pod selector\uff0c \u5c31\u4e0d\u4f1a\u81ea\u52a8\u751f\u6210 endpoints\uff0c\u9700\u8981\u624b\u52a8\u751f\u6210\uff0c\u8fd9\u65f6\u53ef\u4ee5\u6307\u5b9a\u5730\u5740\u4e3a\u4efb\u610f \u5916\u90e8\u7684 ip\uff1a"),(0,l.kt)("p",null,"demo-service.yml:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Service\nmetadata:\n    name: demo-service\nspec:\n    # \u6ca1\u6709\u914d\u7f6e selector\n\n    # \u5c06\u63a5\u6536\u7aef\u53e380\u4e0a\u7684\u4f20\u5165\u8fde\u63a5\n    ports:\n      - port: 80\n")),(0,l.kt)("p",null,"demo-service-endpoints.yml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Endpoints\nmetadata:\n    # Endpoint\u7684\u540d\u79f0\u5fc5\u987b\u548c service \u7684\u540d\u79f0\u76f8\u540c\n    name: demo-service\nsubsets:\n    # Service\u5c06\u628a\u8bf7\u6c42\u91cd\u5b9a\u5411\u5230 \u4e0b\u9762\u7684 \u5730\u5740\n    - addresses:\n        - ip: 11. 11. 11. 11\n        - ip: 22.22.22.22\n      ports:\n        - port: 80\n")),(0,l.kt)("p",null,"\u5982\u679c\u7a0d\u540e\u51b3\u5b9a\u5c06 \u5916\u90e8\u670d\u52a1\u8fc1\u79fb\u5230Kubemetes \u4e2d\u8fd0\u884c\u7684pod, \u53ef\u4ee5\u4e3a\u670d\u52a1\u6dfb\u52a0\u9009\u62e9\u5668\uff0c\u4ece\u800c\u5bf9Endpoint\u8fdb\u884c\u81ea\u52a8\u7ba1\u7406"),(0,l.kt)("h4",{id:"\u901a\u8fc7-externalname-\u7c7b\u578b\u7684-service"},"\u901a\u8fc7 externalName \u7c7b\u578b\u7684 Service"),(0,l.kt)("p",null,"\u53e6\u5916\u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\u5916\u90e8\u670d\u52a1\uff1a\u521b\u5efaExtemalName\u7c7b\u578b\u7684 Service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Service\nmetadata:\n    name: external-service\nspec:\n    # \u9ed8\u8ba4\u4e3a ClusterIP\uff0c\u53ea\u80fd pod \u95f4\u901a\u4fe1\n    # \u8fd8\u6709\u5f88\u591a\u79cd type\n    type: ExternalName\n    externalName: someapi.somecompany.com\n    ports:\n      - port: 80\n")),(0,l.kt)("p",null,"\u7136\u540e\u5728 pod \u4e2d\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"external-service[.default.svc.cluster.local]")," \u8bbf\u95ee  someapi.somecompany.com"),(0,l.kt)("p",null,"\u5728\u4ee5\u540e\u5982\u679c\u5c06\u5176\u6307\u5411\u4e0d\u540c\u7684\u670d\u52a1\uff0c\u53ea\u9700\u7b80\u5355\u5730\u4fee\u6539 externalName \u5c5e\u6027\uff0c\u6216\u8005\u5c06\u7c7b\u578b\u91cd\u65b0\u53d8\u56de ClusterIP \u5e76\u4e3a\u670d\u52a1\u521b\u5efa Endpoint"),(0,l.kt)("h3",{id:"\u5c06\u670d\u52a1\u66b4\u9732\u7ed9\u5916\u90e8"},"\u5c06\u670d\u52a1\u66b4\u9732\u7ed9\u5916\u90e8"),(0,l.kt)("h4",{id:"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210-nodeport"},"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210 NodePort"),(0,l.kt)("p",null,"\u6bcf\u4e2a\u96c6\u7fa4\u8282\u70b9\u90fd\u4f1a\u5728\u8282\u70b9\u4e0a\u6253\u5f00\u4e00\u4e2a\u7aef\u53e3(\u7aef\u53e3\u53f7\u76f8\u540c)\u3002\u5e76\u5c06\u4f20\u5165\u7684\u8fde\u63a5\u8f6c\u53d1\u7ed9 pod"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Service\nmetadata:\n    name: kubia-nodeport\nspec:\n    type: NodePort\n    ports:\n      - port: 80\n        targetPort: 8080\n        # \u901a\u8fc7 \u96c6\u7fa4\u4efb\u610f\u8282\u70b9\u7684 30123 \u7aef\u53e3\u53ef\u4ee5\u8bbf\u95ee \u8fd9\u4e2a service\n        # \u5982\u679c\u4e0d\u6307\u5b9a\uff0cKubernetes\u5c06\u9009\u62e9\u4e00\u4e2a\u968f\u673a\u7aef\u53e3\n        nodePort: 30123\n    selector:\n        app: kubia\n")),(0,l.kt)("p",null,"worker node ip \u5982\u4f55\u83b7\u53d6\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"kubectl get nodes -o jsonpath='...'")),(0,l.kt)("h4",{id:"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210loadbalance"},"\u5c06\u670d\u52a1\u7684\u7c7b\u578b\u8bbe\u7f6e\u6210LoadBalance"),(0,l.kt)("p",null,"NodePort\u7c7b\u578b\u7684\u4e00 \u79cd\u6269\u5c55, \u5728 client \u548c worker node \u95f4 \u653e\u4e86\u4e00\u4e2a LoadBalancer\uff0c \u9632\u6b62\u8282\u70b9\u5355\u70b9\u6545\u969c"),(0,l.kt)("p",null,"\u8d1f\u8f7d\u5747\u8861\u5668\u62e5\u6709\u81ea\u5df1\u72ec\u4e00\u65e0\u4e8c\u7684\u53ef\u516c\u5f00\u8bbf\u95ee\u7684 IP \u5730\u5740\uff0c \u5e76\u5c06\u6240\u6709\u8fde\u63a5\u91cd\u5b9a\u5411\u5230\u670d\u52a1\u3002\u53ef\u4ee5\u901a\u8fc7\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP \u5730\u5740\u8bbf\u95ee\u670d\u52a1"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: vl\nkind: Service\nme\u4e03adata:\n    name: kubia-loadbalancer\nspec:\n    type: LoadBalancer\n    # \u4ec5\u5c06\u5916\u90e8\u901a\u4fe1\u91cd\u5b9a\u5411\u5230\u63a5\u6536\u8fde\u63a5\u7684\u8282\u70b9\u4e0a\u8fd0\u884c\u7684pod\n    # \u5982\u679c\u6ca1\u6709\u672c\u5730pod\u5b58\u5728\uff0c \u5219\u8fde\u63a5\u5c06\u6302\u8d77\u3002\u56e0\u6b64\uff0c \u9700\u8981\u786e\u4fdd\u8d1f\u8f7d\u5e73\u8861\u5668\u5c06\u8fde\u63a5\u8f6c\u53d1\u7ed9\u81f3\u5c11\u5177\u6709\u4e00\u4e2apod\u7684\u8282\u70b9\u3002\n    # \u53ef\u907f\u514d\u989d\u5916\u7684\u7f51\u7edc\u8df3\u8f6c\u3002\u4f46\u662f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8de8\u8282\u70b9\u7684 pod \u7684\u8d1f\u8f7d\u5206\u5e03\u4e0d\u5747\u8861\n    [externalTrafficPolicy: Local ]\n    portS:\n        - port: 80\n          targetPort: 8080\n    selector:\n        app: kubia\n")),(0,l.kt)("h4",{id:"\u521b\u5efa\u4e00-\u4e2aingress\u8d44\u6e90"},"\u521b\u5efa\u4e00 \u4e2aIngress\u8d44\u6e90"),(0,l.kt)("p",null,"\u901a\u8fc7\u4e00 \u4e2aIP\u5730\u5740\u516c\u5f00\u591a\u4e2a\u670d\u52a1\uff0c\u5b83\u8fd0\u884c\u5728 HTTP \u5c42\uff08\u7f51\u7edc\u534f\u8bae\u7b2c7 \u5c42\uff09\u4e0a\uff0c \u56e0\u6b64\u53ef\u4ee5\u63d0\u4f9b\u6bd4\u5de5\u4f5c\u5728\u7b2c4\u5c42\u7684\u670d\u52a1\u66f4\u591a\u7684\u529f\u80fd"),(0,l.kt)("p",null,"\u4e3a\u4ec0\u4e48\u9700\u8981 Ingress\uff1a\u6bcf\u4e2a LoadBalancer \u670d\u52a1\u90fd\u9700\u8981\u81ea\u5df1\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u6bcf\u4e2a loadbalancer \u90fd\u9700\u8981\u81ea\u5df1\u7684 ip\uff0c \u800c Ingress \u53ea\u9700\u8981\u4e00\u4e2a\u516c\u7f51 IP \u5c31\u80fd\u4e3a\u8bb8\u591a\u670d\u52a1\u63d0\u4f9b\u8bbf\u95ee"),(0,l.kt)("p",null,"\u5f53\u5ba2\u6237\u7aef\u5411 Ingress \u53d1\u9001 HTTP \u8bf7\u6c42\u65f6\uff0c Ingress \u4f1a\u6839\u636e\u8bf7\u6c42\u7684\u4e3b\u673a\u540d\u548c\u8def\u5f84\u51b3\u5b9a\u8bf7\u6c42\u8f6c\u53d1\u5230\u7684\u670d\u52a1\u3002"),(0,l.kt)("p",null,"Ingress \u5de5\u4f5c\u5728 \u5e94\u7528\u5c42 \u57fa\u4e8e cookie \u7684\u4f1a\u8bdd\u4eb2\u548c\u6027 (session affinity)"),(0,l.kt)("p",null,"\u5df2\u7ecf\u786e\u8ba4\u96c6\u7fa4\u4e2d\u6b63\u5728\u8fd0\u884c Ingress \u63a7\u5236\u5668\uff0c \u56e0\u6b64\u73b0\u5728\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a Ingress \u8d44\u6e90\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"apiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n    name : kubia \nspec :\n    rules:\n        # Ingress \u5c06\u8fd9\u4e2a\u57df\u540d\u6620\u5c04\u5230\u4f60\u7684 service\n      - host: kubia . example.com\n        http :\n            paths:\n              # \u5c06\u8bf7\u6c42\u53d1\u9001\u5230  kubia-nodeport \u670d\u52a1\u7684 80 \u7aef\u53e3\n              - path: /\n                backend: \n                    serviceName: kubia-nodeport\n                    servicePort: 80\n\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"kubectl get ingresses ")," \u83b7\u53d6 Ingress \u63a7\u5236\u5668 \u5185\u7f51ip\uff0c\u914d\u7f6e\u5230 dns server "),(0,l.kt)("p",null,"\u4e3a ingress \u521b\u5efa tls \u8ba4\u8bc1 TODO"),(0,l.kt)("h2",{id:"\u547d\u4ee4"},"\u547d\u4ee4"),(0,l.kt)("h3",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"")),(0,l.kt)("h3",{id:"kind"},"kind"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/kubernetes-sigs/kind/"},"https://github.com/kubernetes-sigs/kind/")),(0,l.kt)("p",null,"\u5728 docker \u4e2d\u8fd0\u884c k8s, \u66f4\u5feb\u66f4\u65b9\u4fbf"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/laochiji/p/13813743.html"},"https://www.cnblogs.com/laochiji/p/13813743.html")," \u591a\u8282\u70b9"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"# install\n# install golang && install docker\ndocker pull kindest/node:v1.19.1\n\n\n# --name: specify a name for the cluster. default name : kind\n#  --wait 30s: wait until the cluster reaches a ready status\n# --wait 5m\n# --kubeconfig: specify cluster config file; default location : ${HOME}/.kube/config\nkind create cluster [--name kind] [--wait]\n\n# \u6784\u5efa\u955c\u50cf\ndocker build -t my-custom-image:unique-tag ./my-image-dir\n# \u52a0\u8f7d\u5230 kind\nkind load docker-image my-custom-image:unique-tag\nkubectl apply -f my-manifest-using-my-image:unique-tag\n\n# context name \u89c4\u5219: <kind>-<cluster_name>\n# \u4ec5\u4ec5\u4e00\u4e2a cluster \u65f6, \u53ef\u7701\u7565 context\nkubectl cluster-info [--context kind-kind]\n\n# \u9ed8\u8ba4\u5220\u9664 kind \u540d\u5b57\u7684 cluster\nkind delete cluster [--name kind]\n\n# \u52a0\u8f7d images \u5230 cluster\n# \u9ed8\u8ba4 \u5c06 \u955c\u50cf\u52a0\u8f7d\u5230 kind \u540d\u5b57\u7684 cluster\nkind load docker-image <img_name> [--name cluster_name]\n\n# \u8fdb\u5165 kind \u542f\u52a8\u7684 docker \u5185\u90e8, \u6267\u884c crictl images, \u53ef\u4ee5\u770b\n# \u5230\u7528\u6765\u6a21\u62df k8s \u7684\u4e00\u7cfb\u5217\u955c\u50cf\ndocker exec -it kind-control-plane crictl images\n")),(0,l.kt)("h3",{id:"minikube"},"minikube"),(0,l.kt)("p",null,"create single node k8s cluster for dev, \u539f\u7406\u662f \u521b\u5efa\u865a\u62df\u673a, "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"\nminikube version\n\nminikube start\n\n\nminikube dashboard\n\n# \u53ef\u7528\u7684\u6269\u5c55/\u63d2\u4ef6\nminikube addons list\n\n# \u5f00\u542f\u63d2\u4ef6\nminikube addons enable metrics-server\n# \u5173\u95ed\u63d2\u4ef6\nminikube addons disable metrics-server\n\n\nminikube stop\n\nminikube delete\n\n# \u5f53\u524d node ip\nminikube ip\n\n")),(0,l.kt)("h3",{id:"\u4f7f\u7528-kubectl"},"\u4f7f\u7528 kubectl"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"},"https://kubernetes.io/docs/tasks/tools/install-kubectl/")),(0,l.kt)("h4",{id:"\u57fa\u672c\u4fe1\u606f"},"\u57fa\u672c\u4fe1\u606f"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl version\nkubectl cluster-info\nkubectl get nodes\n# \u83b7\u53d6kube-scheduler\u548ckube-controller-manager\u7ec4\u4ef6\u72b6\u6001\nkubectl get cs # \u5065\u5eb7\u72b6\u51b5\n")),(0,l.kt)("h4",{id:"\u521b\u5efa-create-expose"},"\u521b\u5efa create expose"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"\n# create depend on a spec file.\nkubectl create -f xxx.yml\n\n\n\n# >>> deployment, \n\n# dep-name \u4e0d\u80fd\u968f\u4fbf\u8bbe\u7f6e, \u5fc5\u987b\u7b26\u5408\u57df\u540d\u547d\u540d\u89c4\u8303.\n# \u81ea\u52a8\u521b\u5efa\u7684 ReplicaSet \u540d\u5b57\u4e3a dep_name + random uuid\n# \u81ea\u52a8\u521b\u5efa pod \u540d\u5b57\u4e3a ReplicaSet-name + random uuid\n# \u955c\u50cf\u5730\u5740 include the full repository url\n# \u81ea\u52a8\u521b\u5efa label -> run={dep name}\n# auto  create selector -> run={dep name}\nkubectl create deployment <dep name> --image=k8s.gcr.io/echoserver:1.4\nkubectl create deployment tomcat6 --image=tomcat:6.0.53-jre8 # \u4e0d\u6307\u5b9a url \u524d\u7f00, \u9ed8\u8ba4\u4ece docker hub \u62c9\u53d6\n\n# >>> proxy\n\n#  pods \u9ed8\u8ba4\u4ec5\u4ec5\u80fd\u88ab \u540c\u4e2a\u96c6\u7fa4\u7684 pods, service  \u8bbf\u95ee\n# \u521b\u5efa\u4e34\u65f6\u7684 \u4ee3\u7406, \u53ef\u4ee5\u5c06\u5916\u90e8\u547d\u4ee4\u8f6c\u53d1\u5230 cluster \u5185\u90e8\u7684 pod\n# Ctrl +c \u5173\u95ed\nkubectl proxy\n# \u67e5 \u7248\u672c\ncurl http://localhost:8001/version\n# \u8bbf\u95ee\u6307\u5b9a pod \u7684\u670d\u52a1\ncurl http://localhost:8001/api/v1/namespaces/default/pods/$POD_NAME/proxy/\n\n\n\n# >>> pod\n\nkubectl run <pod name> --image=nginx --restart=Never --port=80\n# --generator=run/vl  \u8868\u793a\u540c\u65f6\u521b\u5efa rc \u7ba1\u7406 pod\nkubectl run <pod name> --image=luksa/kubia --port=8080 --generator=run/vl \n# \u4ece\u63cf\u8ff0\u6587\u4ef6\u521b\u5efa \u8d44\u6e90\uff0c \u53ef\u4ee5 pod\uff0c rc\u3002\u3002\u3002\uff0c \u53ef\u6307\u5b9a ns\uff0c \u9ed8\u8ba4 default\nkubectl create -f kubia-manual.yaml [-n xxx_ns]\n\n\n\n# >>> service\n\n# \u521b\u5efa service, \u540d\u5b57\u540c deployment\n# The LoadBalancer type makes the Service accessible through the minikube service command\n# Port 8080 is specified in image code, so cannot be other port here\n# --port : service \u66b4\u9732\u5728 cluster ip \u4e0b\u7684\u7aef\u53e3, \u901a\u8fc7\u8fd9\u4e2a\u7aef\u53e3,  \u53ef\u4ee5\u5728 cluster \u5185\u90e8\u8bbf\u95ee\u5230\u591a\u4e2a pod. \u901a\u8fc7\u8fd9\u4e2a service \u8d1f\u8f7d\u5747\u8861\u4e86 \u591a\u4e2a pod\n# --targetPort \u5bb9\u5668\u7684\u7aef\u53e3, \u9ed8\u8ba4=== port, \u4e0e\u5236\u4f5c\u955c\u50cf\u65f6\u66b4\u9732\u7684\u7aef\u53e3\u4e00\u81f4, \u4e0d\u80fd\u968f\u4fbf\u6307\u5b9a\n# --type: service \u7c7b\u578b, \n#       NodePort: \u521b\u5efa\u4e00\u4e2a service \u5e76\u66b4\u9732\u5230 cluster \u5916\u90e8, service \u7684\u7aef\u53e3\u8fd8\u662f --port \u6307\u5b9a, \u540c\u65f6 service \u6709\u81ea\u5df1\u7684 cluster url, node \u4f1a\u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u7aef\u53e3\u6620\u5c04\u5230 service \u7684 \u7aef\u53e3, \u82e5\u6307\u5b9a\u4e86 --nodePort, \u5c31\u7528\u6307\u5b9a\u7aef\u53e3\u6620\u5c04\u5230 service \u7aef\u53e3; \u5982 type=NodePort\uff0c\u800c\u4e14\u914d\u7f6e nodePort=30001, \u90a3\u4e48\u5916\u90e8\u673a\u5668 \u53ef\u4ee5 scheme://nodeIP:30001\u8bbf\u95ee\u5230\u8be5\u670d\u52a1\n#       LoadBalancer: \nkubectl expose deployment <dep name> --type=LoadBalancer --port=8080 \n\n# \u67e5\u627e\u66b4\u9732\u7684\u968f\u673a\u7aef\u53e3\nkubectl describe service mywebservice | grep NodePort\n\n# service port 80 will mapping to random node port ,and this service can be visited by someone outside cluster\n# \u82e5\u6269\u5bb9, \u5219\u5728\u5404\u4e2a\u6709 pod \u8fd0\u884c\u7684\u8282\u70b9\u90fd\u80fd\u901a\u8fc7 node \u7aef\u53e3\u8bbf\u95ee  \u8fd9\u4e2a service\nkubectl expose deploy tomcat6 --port=80 --target-port=8080 --type=NodePort\n\n# \u521b\u5efa\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u670d\u52a1 service \u5bf9\u8c61. \u53ef\u4ee5\u4ece\u5916\u90e8\u8bbf\u95ee pod\n# rc \u4e3a replicationController \u7f29\u5199\nkubectl expose rc <po name> --type=LoadBalancer --name kubia-http\n\n\n# >>> label\n\n# \u8bed\u6cd5: kubectl label <obj_type, eg: pod, service> <obj_name> <label, eg: app=v1>\nkubectl label pod $POD_NAME app=v1\n\n\n# >>> \u547d\u540d\u7a7a\u95f4 \n\n# \u521b\u5efa\nkubectl config set-context Kubernetes --namespace=beta\n# \u9a8c\u8bc1\nkubectl config view | grep namespace command\n")),(0,l.kt)("h4",{id:"\u6267\u884c\u547d\u4ee4\u5230\u5bb9\u5668-exec"},"\u6267\u884c\u547d\u4ee4\u5230\u5bb9\u5668 exec"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"# \u4ec5\u6709 \u4e00\u4e2a\u5bb9\u5668\u5728 pod, \u65e0\u9700\u6307\u5b9a\u5bb9\u5668\nkubectl exec [-c container_name] $POD_NAME env\n\n# \u8fdb\u5165 \u5bb9\u5668\u5185\u90e8\nkubectl exec -ti $POD_NAME bash\n")),(0,l.kt)("h4",{id:"\u4fee\u6539"},"\u4fee\u6539"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"\n# >>> \u6269\u5bb9\n\n# \u6307\u5b9a replicas \u53ef\u4ee5\u7f29\u6269\u5bb9\n$ kubectl scale deployments/<dep_name> --replicas=4\nkubectl scale deployment.apps/tomcat6 --replicas=2\nkubectl scale deployment tomcat6 --replicas=2\n\n\n# >>> \u6eda\u52a8\u66f4\u65b0\n\n# \u66f4\u65b0 image version\n$ kubectl set image deployments/<dep_name> <dep_name>=jocatalin/kubernetes-bootcamp:v2\n# \u9a8c\u8bc1\u66f4\u65b0\u662f\u5426\u6210\u529f\n$ kubectl rollout status deployments/kubernetes-bootcamp\n\n# >>> \u56de\u6eda\n\n# \u53d6\u6d88\u4e4b\u524d\u7684\u90e8\u7f72\uff0c\u8fd9\u5c06\u6267\u884c\u53cd\u5411\u64cd\u4f5c\uff0c\u5c06\u8d1f\u8f7d\u79fb\u52a8\u81f3\u4e4b\u524d\u7248\u672c\u7684\u5bb9\u5668\n$ kubectl rollout undo deployments/kubernetes-bootcamp\n")),(0,l.kt)("h4",{id:"\u8d44\u6e90\u5217\u8868-get"},"\u8d44\u6e90\u5217\u8868 get"),(0,l.kt)("p",null,"\u5355\u590d\u6570\u5747\u53ef"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"\n# \u6240\u6709\nkubectl get all\n\n\n# >>> deployment\n\nkubectl get deployments\n\n\n# >>> pods\n\n# --show-labels \u540c\u65f6\u663e\u793a\u6240\u6709\u6807\u7b7e\u3002 \n# -A \u67e5\u770b\u6240\u6709 pods, \u5305\u62ec kube-system \u547d\u540d\u7a7a\u95f4 \u4e0b\u7684 pods\n# --all-namespaces \u6240\u6709\u7a7a\u95f4\u7684 pods\nkubectl get pods [--show-labels]\n\n# -o \u8f93\u51fa\u683c\u5f0f; wide \u8868\u793a\u8f93\u51fa\u6587\u672c\u4fe1\u606f, \u5217\u51fa ip , \u8282\u70b9 name\n# -o yaml \nkubectl get pods -o wide\n\n# \u901a\u8fc7\u6807\u7b7e\u8fc7\u6ee4\nkubectl get pods -l <label>\n\n# \u83b7\u53d6 pod \u5b8c\u6574 yaml/json \u6587\u4ef6\n# \u7f29\u5199 po\nkubectl get po <pod name> -o yaml\nkubectl get po <pod name> -o json\nkubectl get node\n\n# \u6839\u636e\u6a21\u677f\u83b7\u53d6 \u4fe1\u606f\nexport POD_NAME=$(kubectl get pods -o go-template --template '{{range .items}}{{.metadata.name}}{{\"\\n\"}}{{end}}')\nexport NODE_PORT=$(kubectl get services/kubernetes-bootcamp -o go-template='{{(index .spec.ports 0).nodePort}}')\n\n\n# >>> service\n\n\n# \u67e5\u770b service  \u7684 endpoint \u5217\u8868\nkubectl get endpoints <service name>\n# \u67e5\u770b\u6240\u6709 svc\n# \u7f29\u5199 svc\nkubectl get services\n\n\n# >>> ReplicaSet\n\nkubectl get rs\n\n\n\n\n# \u7aef\u53e3\u8f6c\u53d1\uff0c \u5c06\u4f1a\u8fd0\u884c\u4e00\u4e2a\u7aef\u53e3\u8f6c\u53d1\u4ee3\u7406\n# \u5c06 local port 8888 \u8f6c\u53d1\u5230 pod \u7684 8080\nkubectl port-forward <pod name> 8888:8080\n\n# \u6807\u7b7e\n# \u5217\u51fa pods \u7684\u6240\u6709\u6807\u7b7e\nkubectl get pods --show-labels\n# \u53ea\u5217\u51fa\u611f\u5174\u8da3\u7684\u6807\u7b7e\uff0c \u6807\u7b7e\u6309\u7167\u5217\u5c55\u793a\nkubectl get po -L creation_method,env\n# \u6dfb\u52a0\nkubectl label po <pod name> creation_method=manual\n# \u4fee\u6539\nkubectl label po <pod name> creation_method=manual --override\n\n# \u6807\u7b7e\u9009\u62e9\u5668\nkubectl get po -1 creation_method=manual\nkubectl get po -1 creation_method!=manual\nkubectl get po -1 env\n# \u5217\u51fa\u6ca1\u6709 env \u7684pod\nkubectl get po -1 '!env'\n# \u9009\u62e9\u5e26\u6709env\u6807\u7b7e\u4e14\u503c\u4e3aprod\u6216devel\u7684pod\nkubectl get po -1 env in (prod, devel)\nkubectl get po -1 env notin (prod, devel)\n\n# \u4f7f\u7528 label \u5206\u7c7b worker node\nkubectl get nodes\nkubectl label node <node name> gpu=true # \u6bcf\u4e2a node \u90fd\u6709\u4e00\u4e2a\u9ed8\u8ba4 label\uff0c kubernetes.io/hostname:\u4e3b\u673a\u540d \nkubectl get nodes -l gpu=true\n\n# \u547d\u540d\u7a7a\u95f4\n# \u67e5\u770b\u6240\u6709 ns, \u6709 default\uff0c kube-public\uff0c kube-system\uff0c\u9ed8\u8ba4\u6211\u4eec\u4f7f\u7528\u7684\u662f default\nkubectl get ns \n# \u5217\u51fa\u53ea\u5c5e\u4e8e\u8be5\u547d\u540d\u7a7a\u95f4\u7684 pod, \u53ef\u4f7f\u7528 -n\nkubectl get po --namespace kube-system\n\n\n# \u7f16\u8f91 rc \u7684 yaml\n# \u4e00\u822c\u4ec5\u4ec5\u7f16\u8f91 rc \u7684 template\uff0c \u4e0d\u52a8 label selector\n# \u7528\u6765\u5347\u7ea7 pod\nkubectl edit rc kubia\n\n# \u589e\u52a0 \u526f\u672c\u6570\uff0c \u6c34\u5e73\u6269\u5bb9\nkubectl scale rc kubia --replicas=3 \n# \u7b49\u540c parallelism\nkubectl scale job xxx_job --replicas 3 \n\n# \u8fdc\u7a0b\u5728 pod \u4e2d\u67d0\u4e2a container \u6267\u884c\u547d\u4ee4\n# \u201c--\u201d \u8868\u793a kubectl \u547d\u4ee4\u7ed3\u675f\uff0c \u540e\u9762\u7684\u662f\u5728 pod \u5185\u6267\u884c\u7684\nkubectl exec <pod name> -- curl -s http://10.23... \n# \u5217\u51fa\u73af\u5883\u53d8\u91cf\uff0c\u5982 Service \u7684 ip\uff0c \u7aef\u53e3\nkubectl exec kubia-3inly env\n# \u5728 pod \u4e2d\u6267\u884c shell\nkubectl exec -it kubi-3inly bash\n\n\n# >>> \u914d\u7f6e\u6587\u4ef6\n\nkubectl config view\n\n\n\n# >>> \u4e8b\u4ef6\n\nkubectl get events\n\n# \u901a\u8fc7 describe \u4e5f\u80fd\u5f97\u5230 object \u76f8\u5173\u7684\u4e8b\u4ef6\n\n")),(0,l.kt)("h4",{id:"\u67e5\u8be2\u8be6\u7ec6\u63cf\u8ff0-describe"},"\u67e5\u8be2\u8be6\u7ec6\u63cf\u8ff0 describe"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"# >>> pods\n\n# \u67e5\u770b\u8d44\u6e90\u63cf\u8ff0\uff0c \u9644\u52a0\u4fe1\u606f\uff0c \u4f5c\u4e3a kubectl get xxx xxx \u8865\u5145, \u53ef\u7528\u4e8e\u6392\u67e5\u95ee\u9898\n# \u5982 pod \u662f\u5426\u6b63\u5728\u8fd0\u884c\uff0c \u91cd\u542f\u539f\u56e0\uff0c \u9000\u51fa\u7801 137\uff0c143 \u8868\u793a pod \u88ab\u8feb\u7ec8\u6b62\nkubectl describe pods [pod_name]\n\n\n# >>> service\n\nkubectl describe services/<srv name>\n\n# >>> deployment\n\n$ kubectl describe deployment\n\n\n")),(0,l.kt)("h4",{id:"\u67e5\u8be2\u65e5\u5fd7-logs"},"\u67e5\u8be2\u65e5\u5fd7 logs"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"# \u67e5\u6307\u5b9a pod \u4e0b\u7684 container \u65e5\u5fd7\n# \u82e5pod \u53ea\u6709\u4e00\u4e2a container, \u65e0\u9700\u6307\u5b9a container\nkubectl logs $POD_NAME\nkubectl logs -f POD-NAME\n\n\n# \u9700\u8981 ssh \u5230 pod \u6240\u5728\u7684 worker node\ndocker logs <container_id>\n# \u65e0\u9700 ssh, \u53ef\u6307\u5b9a\u67d0\u4e2a container\uff0c \u53ef\u6307\u5b9a\u770b\u91cd\u542f\u524d\u7684\u7248\u672c\u7684\u65e5\u5fd7\nkubectl logs <pod name> [-c container_name] [--previous]\n\n\n\n\n# \u67e5\u770b k8s \u8d44\u6e90\nkubectl explain pods\nkubectl explain pod.spec\n\n")),(0,l.kt)("h4",{id:"\u5220\u9664-delete"},"\u5220\u9664 delete"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"# delete by spec file\nkubectl delete -f flask.yaml\n\n# \u5220\u9664 pod\n# \u65e0\u6cd5\u76f4\u63a5\u5220\u9664, \u53ea\u8981 replicaSet \u6ca1\u6709\u5220\u9664, \u5220\u4e86 po, \u8fd8\u4f1a\u91cd\u73b0\u521b\u5efa po\n# \u53ef\u76f4\u63a5 \u901a\u8fc7\u5220\u9664 deployment \u5220\u9664\nkubectl delete po kubia-gpu [pod2 [pod3]]\n# \u5220\u9664\u5f53\u524d ns \u4e0b all pod\uff0c \u4fdd\u7559 ns\nkubectl delete po --all\n# \u6309\u7167\u6807\u7b7e\u5220\u9664\nkubectl delete po -1 creation_method=manual\n\nkubectl delete service hello-node\nkubectl delete deployment hello-node\n\n#  \u5220\u9664 ns, \u540c\u65f6\u4f1a\u5220\u9664 ns \u4e0b\u7684\u6240\u6709 pod\nkubectl delete ns custom-namespace\n# \u5220\u9664\u6240\u6709\u8d44\u6e90\uff0c \u5305\u62ec rc\uff0c pod\uff0c service\nkubectl delete all --all\n# \u5220\u9664 rc\uff0c rc \u7ba1\u7406\u7684 pods \u4e5f\u4f1a\u5220\u9664\nkubectl delete rc <rc name>\n# \u5220\u9664 rc\uff0c \u4f46\u662f\u4fdd\u7559 pods\nkubectl delete rc <rc name> --cascade=false\nkubectl dele\u4e03e rs kubia \n\n\n")),(0,l.kt)("h3",{id:"kubeadmin"},"kubeadmin"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"kubeadm init # create a master node\n\nkubeadm join <master_id:port> # add a node to cluster\n")),(0,l.kt)("h2",{id:"\u53ef\u89c6\u5316\u754c\u9762"},"\u53ef\u89c6\u5316\u754c\u9762"),(0,l.kt)("p",null,"kubernetes-dashboard"),(0,l.kt)("p",null,"\u66f4\u63a8\u8350 kubesphere, \u6253\u901a devops \u5168\u5957\u6d41\u6c34\u7ebf, \u5bf9 cluster \u8981\u6c42\u9ad8  ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/kubesphere/kubesphere"},"https://github.com/kubesphere/kubesphere")),(0,l.kt)("p",null,"(kuboard \u4e5f\u884c, \u5bf9 cluster \u8981\u6c42\u4e0d\u9ad8)"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.zhihu.com/question/348609092"},"https://www.zhihu.com/question/348609092")," rancher \u548c kubesphere\u5bf9\u6bd4"),(0,l.kt)("h2",{id:"vagrant-\u642d\u5efa-k8s-\u73af\u5883"},"vagrant \u642d\u5efa k8s \u73af\u5883"),(0,l.kt)("p",null,"\u4e00\u4e2a master node: docker, kubeadm, kubelet, kubectl\n\u4e24\u4e2a worker node: "),(0,l.kt)("p",null,"Vagrantfile:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vagrantfile"},'\nVagrant.configure("2") do |config|\n   (1..3).each do |i| \n        config.vm.define "k8s-node#{i}" do |node|\n            # \u8bbe\u7f6e\u865a\u62df\u673a\u7684Box \n            node.vm.box = "centos7"\n\n            # \u8bbe\u7f6e\u865a\u62df\u673a\u7684\u4e3b\u673a\u540d\n            node.vm.hostname="k8s-node#{i}"\n\n            # \u8bbe\u7f6e\u865a\u62df\u673a\u7684IP\n            # 192.168.56.xxx \u9700\u8981\u5728 virtualbox \u5148\u521b\u5efa host only network 192.168.56.1\n            node.vm.network "private_network", ip: "192.168.56.#{99+i}/24", netmask: "255.255.255.0"\n\n            # \u8bbe\u7f6e\u4e3b\u673a\u4e0e\u865a\u62df\u673a\u7684\u5171\u4eab\u76ee\u5f55\n            # node.vm.synced_folder "~/Documents/vagrant/share", "/home/vagrant/share"\n\n            # VirtaulBox\u76f8\u5173\u914d\u7f6e\n            node.vm.provider "virtualbox" do |v| \n                # \u8bbe\u7f6e\u865a\u62df\u673a\u7684\u540d\u79f0\n                v.name = "k8s-node#{i}"\n                # \u8bbe\u7f6e\u865a\u62df\u673a\u7684\u5185\u5b58\u5927\u5c0f\n                v.memory = 4096\n                # \u8bbe\u7f6e\u865a\u62df\u673a\u7684CPU\u4e2a\u6570\n                v.cpus = 4 \n            end \n        end \n   end \nend\n\n')),(0,l.kt)("p",null,"\u865a\u62df\u673a\u51c6\u5907"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"# \u767b\u5f55 machine sshd, \u4fdd\u8bc1\u53ef\u4ee5\u901a\u8fc7\u8d26\u53f7\u5bc6\u7801\u767b\u5f55 (\u9ed8\u8ba4\u4ec5\u4ec5 ssh \u767b\u5f55)\n# \u82e5\u4f7f\u7528 tmux + ssh config \u5219\u65e0\u9700\u65e0\u9700\u8fd9\u4e00\u6b65, \u76f4\u63a5\u901a\u8fc7 ssh \u767b\u5f55\u5373\u53ef\nvagrant ssh k8s-node1\nsudo su\nvi /etc/ssh/sshd_config # \u4fee\u6539 \u4e3a PasswordAuthentication yes\nservice sshd restart\n\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u7f51\u5361\n\n# show default SoftEther\n# We can find that the default soft ether is eth0, the three machine have the same eth0 ip.\n# This is because eth0 default to \u7f51\u7edc\u5730\u5740\u8f6c\u53d1(nat) \u7c7b\u578b. in order  to make the machines can \n# access to each other, etho should be type: Natnetwork\nip route show\n# \u64cd\u4f5c virtualbox \u56fe\u5f62\u754c\u9762, \u5168\u5c40\u65b0\u5efa natnetwork \u7f51\u7edc. \u4e3a\u6bcf\u4e2a machine \u9ed8\u8ba4\u7f51\u53611 \u5373 eth0 \u6307\u5b9a \u8fd9\u4e2a\u7c7b\u578b, \u5237\u65b0\u9ad8\u7ea7\u8bbe\u7f6e\n# \u91cc\u7684 \u7f51\u5361mac \u5730\u5740\n# \u7136\u540e\u5728\u5404\u4e2a machine \u5185 \u4e92\u76f8 ping \u662f\u5426\u901a\n\n# close firewall\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n# disable selinux (\u6c38\u4e45)\nsed -i 's/enforcing/disabled/' /etc/selinux/config # \u66ff\u6362\u4e86 enforcing \u4e3a disable\n# \u5f53\u524d\u4f1a\u8bdd\u5173\u95ed selinux (\u4e34\u65f6)\nsetenforce 0\n\n# \u5173\u95ed swap \u6c38\u4e45\nsed -ri 's/.*swap.*/#&/' /etc/fstab # \u5176\u5b9e\u5c31\u662f\u6ce8\u91ca\u6389\u4e00\u884c   #/swapfile none swap defaults 0 0\n# \u5173\u95ed swap (\u5185\u5b58\u4ea4\u6362) \u4e34\u65f6\nswapoff -a\n\n# \u6dfb\u52a0 \u4e3b\u673a\u540d and ip \u6620\u5c04\n# hostname \u4f1a\u663e\u793a \u4e3b\u673a\u540d k8s-node1/2/3\n# \u82e5 hostname \u663e\u793a\u4e0d\u6b63\u5e38\u53ef\u4ee5\u4fee\u6539: hostnamectl set-hostname <new hostname>\nvi /etc/hosts\n# eth0 \u7f51\u5361\u5c31\u662f \u9ed8\u8ba4\u7f51\u5361, \u7528\u6765machine \u4e92\u8054\u7684\n# <node1 eth0 ip> k8s-node1\n# <node2 eth0 ip> k8s-node2\n# <node3 eth0 ip> k8s-node3\n10.0.2.15 k8s-node1\n10.0.2.4 k8s-node2\n10.0.2.5 k8s-node3\n\n# \u5c06\u6865\u63a5\u7684 ipv4 \u7684\u6d41\u91cf\u4f20\u9012\u5230 iptables \u7684\u94fe\ncat > /etc/sysctl.d/k8s.conf << EOF\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\n# \u9a8c\u8bc1\nsysctl --system\n\n# \u540c\u6b65\u4e09\u53f0\u673a\u5668\u7684\u65f6\u95f4\nyum install ntpdate -y\nntpdate time.windows.com\n\n# \u5c06\u53ea\u8bfb\u6587\u4ef6\u7cfb\u7edf \u6539\u4e3a \u8bfb\u5199\nmount -o remount rw /\n\n")),(0,l.kt)("p",null,"\u5b89\u88c5 docker \u7b49"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"# docker\u53c2\u7167\u5b98\u7f51\u5373\u53ef\n\n# \u5b89\u88c5 k8s \u9700\u8981 aliyun \u955c\u50cf \u63a8\u8350\ncat <<EOF > /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=0\nrepo_gpgcheck=0\ngpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg\n        http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nEOF\n\n# ustc \u7684\u955c\u50cf\ncat <<EOF > /etc/apt/sources.list.d/kubernetes.list\ndeb http://mirrors.ustc.edu.cn/kubernetes/apt kubernetes-xenial main\nEOF\n# centos\ncat <<EOF > /etc/yum.repos.d/kubernetes.repo\ndeb http://mirrors.ustc.edu.cn/kubernetes/apt kubernetes-xenial main\nEOF\n\n\n\nsystemctl enable kubelet\nsystemctl start kubelet\n\n\n# >>> \u5728 master node \u4e0a\n\n# \u9700\u8981\u62c9\u53bb k8s \u76f8\u5173\u7684\u955c\u50cf, \u9ed8\u8ba4\u4ed3\u5e93 k8s.gcr.io \u80cc\u5899, \u8fd9\u91cc\u91cd\u65b0\u6307\u5b9a\n# service-cidr \u662f service \u95f4\u901a\u4fe1\u7684\u7f51\u6bb5/\u5b50\u7f51\n# pod network-cidr \u662f pod \u95f4\u901a\u4fe1\u7f51\u6bb5/\u5b50\u7f51\nkubeadm init --apiserver-advertise-address=<master node eth0 ip> \\\n--image-repository registry.cn-hangzhou.aliyuncs.com/google_containers \\\n--kubernetes-version v1.19.4 \\\n--service-cidr=10.96.0.0/16 \\\n--pod-network-cidr=10.244.0.0/16\n\n# \u6309\u7167 \u8f93\u51fa\u63d0\u793a, \u5982\u4e0b\u6b65\u9aa4\u9700\u8981\u505a:\nmkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n\n# master \u751f\u6210\u7684 \u547d\u4ee4, \u5728 worker node \u6267\u884c\u5373\u53ef\u52a0\u5165 cluster.\n# 2h \u5185\u6709\u6548\nkubeadm join 10.0.2.15:6443 --token 0tpws3.y1uhbzg0rgal4okz \\\n    --discovery-token-ca-cert-hash sha256:0a25a082e0babbc18d1646ebfa9954d82838fa86ec66ee3d88c0d57fc9c0f35e \n# \u8fc7\u671f\u4e4b\u540e, \u5982\u4e0b\u751f\u6210\u6c38\u4e45\u7684 token\nkubeadm token create --print-join-command\nkubeadm token create --ttl 0 --print-join-command # \u590d\u5236\u751f\u6210\u7684 token \u5230\u4e0a\u9762\u547d\u4ee4\u5373\u53ef\n\n# \u521b\u5efa\u7f51\u7edc\n# \u8fd9\u91cc\u9009\u5b9a flannel \u63d0\u4f9b\u7684\u7f51\u7edc\u6269\u5c55\u63d2\u4ef6 (addons)\n# \u5177\u4f53\u6709\u54ea\u4e9b\u53ef\u7528\u7684\u63d2\u4ef6: https://kubernetes.io/docs/concepts/cluster-administration/addons/\ncurl -L https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml -o flannel_network.yml\n# \u4e0a\u4f20\u5230 master node\nscp ~/flanel.yml root@xxx/root\n# \u5b50\u8282\u70b9\u52a0\u5165\u5230 cluster \u540e, master \u4f1a\u540c\u6b65 flanel \u76f8\u5173\u7684 pod \u5230 \u5b50\u8282\u70b9\u4e0a, \u53ef\u4ee5\u76d1\u63a7, \u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u518d\u67e5\u770b nodes\nkubectl apply -f flannel.yml\n# \u67e5\u770b flanel \u76f8\u5173 \u7684 pods \u662f\u5426\u542f\u52a8\nkubectl get po --all-namespaces\n# \u5982\u679c\u662f \u5931\u8d25\u7684, \u90a3\u4e48\u5c0f\u66ff\u6362 flanel.yml \u4e2d image \u76f8\u5173\u5730\u5740, \u5230 docker hub \u4e0a\u627e, \u5982 https://hub.docker.com/r/easzlab/flannel\n# \u5220\u9664 , \u91cd\u65b0\u521b\u5efa\nkubectl delete -f flannel.yml\n\n \n# \u6b64\u65f6\u53ef\u4ee5\u5728\u5b50\u8282\u70b9\u4e0a\u6267\u884c\u6dfb\u52a0 node \u547d\u4ee4\u4e86   >>> \u5728 worker node \u4e0a\n\n\n# \u76d1\u63a7 \u6240\u6709\u8282\u70b9\u4e0a\u7684 \u6307\u5b9ans \u7684 pod\n# \u7b49\u5f85 \u6240\u6709\u8282\u70b9 \u4e0a flanel \u76f8\u5173\u7684 pod \u90fd\u6b63\u5e38\u542f\u52a8\u540e\u518d\u5728 master \u4e0a\u67e5\u770b nodes \u72b6\u6001, \u4fdd\u8bc1\u6240\u6709 node \u72b6\u6001\u4e3a ready \u5219 cluster \u642d\u5efa\u6210\u529f\nwatch kubectl get po -n kube-system -o wide\n\n# \u5b89\u88c5 ingress controller, \n# \u6709\u591a\u91cd\u5b9e\u73b0, \u9009\u62e9\u4e00\u79cd\u5373\u53ef https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/\n# \u8fd9\u91cc\u9009\u62e9 ingress-nginx https://kubernetes.io/docs/concepts/services-networking/ingress/\n# ref: https://www.cnblogs.com/minseo/p/12455320.html\n\n\n")),(0,l.kt)("h2",{id:"cka-\u8bc1\u4e66"},"cka \u8bc1\u4e66"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://training.linuxfoundation.cn/certificate/details/1"},"https://training.linuxfoundation.cn/certificate/details/1")," \u4e2d\u56fd\u533a"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://zhuanlan.zhihu.com/p/138796893"},"https://zhuanlan.zhihu.com/p/138796893"),"\n",(0,l.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/629525af31c4"},"https://www.jianshu.com/p/629525af31c4"),"\n",(0,l.kt)("a",{parentName:"p",href:"https://www.kubernetes.org.cn/peixun"},"https://www.kubernetes.org.cn/peixun")," \u8003\u8bd5\u8981\u70b9\n",(0,l.kt)("a",{parentName:"p",href:"https://zhuanlan.zhihu.com/p/138796893"},"https://zhuanlan.zhihu.com/p/138796893")," , ",(0,l.kt)("a",{parentName:"p",href:"https://www.zhihu.com/zvideo/1302356091591372800"},"https://www.zhihu.com/zvideo/1302356091591372800")," \u771f\u9898"),(0,l.kt)("h2",{id:"k3s"},"k3s"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/k3s-io/k3s"},"https://github.com/k3s-io/k3s")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://oldj.net/article/2022/04/17/install-k3s-and-rancher/"},"https://oldj.net/article/2022/04/17/install-k3s-and-rancher/")),(0,l.kt)("p",null,"\u8f7b\u91cf\u7ea7\u7684 k8s, \u5185\u6838\u673a\u5236\u8fd8\u662f\u548c K8s \u4e00\u6837\uff0c\u4f46\u662f\u5254\u9664\u4e86\u5f88\u591a\u5916\u90e8\u4f9d\u8d56\u4ee5\u53ca K8s \u7684 alpha\u3001beta \u7279\u6027"),(0,l.kt)("p",null,"\u5c06\u5176\u5e94\u7528\u4e8e IoT \u8bbe\u5907\uff08\u6bd4\u5982\u6811\u8393\u6d3e\uff09"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://rancher.com/docs/k3s/latest/en/"},"https://rancher.com/docs/k3s/latest/en/")," \u5b98\u7f51"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.rancher.cn/k3s/"},"https://www.rancher.cn/k3s/")," \u4e2d\u6587\u5b98\u7f51"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://zhuanlan.zhihu.com/p/269556628"},"https://zhuanlan.zhihu.com/p/269556628")," \u7b80\u4ecb"),(0,l.kt)("h2",{id:"k0s"},"k0s"),(0,l.kt)("h2",{id:"rancher"},"rancher"),(0,l.kt)("p",null,"\u90e8\u7f72 k8s \u96c6\u7fa4 "),(0,l.kt)("h2",{id:"harbor"},"Harbor"),(0,l.kt)("h2",{id:"helm-chart"},"helm chart"),(0,l.kt)("p",null,"\u4f7f\u7528 helm chart \u4e00\u952e\u62c9\u8d77\u6574\u5957\u73af\u5883, \u53ef\u4ee5\u4f7f\u7528 helm chart \u5e94\u7528\u5546\u5e97"))}u.isMDXComponent=!0}}]);