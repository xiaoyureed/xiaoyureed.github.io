"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[914],{3905:function(e,n,a){a.d(n,{Zo:function(){return c},kt:function(){return d}});var t=a(67294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function o(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?o(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function p(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=t.createContext({}),l=function(e){var n=t.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},c=function(e){var n=l(e.components);return t.createElement(s.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=l(a),d=r,g=u["".concat(s,".").concat(d)]||u[d]||m[d]||o;return a?t.createElement(g,i(i({ref:n},c),{},{components:a})):t.createElement(g,i({ref:n},c))}));function d(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=u;var p={};for(var s in n)hasOwnProperty.call(n,s)&&(p[s]=n[s]);p.originalType=e,p.mdxType="string"==typeof e?e:r,i[1]=p;for(var l=2;l<o;l++)i[l]=a[l];return t.createElement.apply(null,i)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},5376:function(e,n,a){a.r(n),a.d(n,{assets:function(){return c},contentTitle:function(){return s},default:function(){return d},frontMatter:function(){return p},metadata:function(){return l},toc:function(){return m}});var t=a(83117),r=a(80102),o=(a(67294),a(3905)),i=["components"],p={title:"Spring",date:new Date("2014-01-16T17:11:56.000Z"),tags:["spring"],toc_min_heading_level:2,toc_max_heading_level:5},s=void 0,l={unversionedId:"spring-note",id:"spring-note",title:"Spring",description:"references\uff1a 1, 2, 3",source:"@site/docs/spring-note.md",sourceDirName:".",slug:"/spring-note",permalink:"/en/docs/spring-note",draft:!1,tags:[{label:"spring",permalink:"/en/docs/tags/spring"}],version:"current",frontMatter:{title:"Spring",date:"2014-01-16T17:11:56.000Z",tags:["spring"],toc_min_heading_level:2,toc_max_heading_level:5},sidebar:"tutorialSidebar",previous:{title:"shell-bash\u811a\u672c\u6536\u96c6",permalink:"/en/docs/shell-bash-note"},next:{title:"Spring Cloud \u7b14\u8bb0\ud83c\udf08",permalink:"/en/docs/springcloud-note"}},c={},m=[{value:"1.1. classpath*\u533a\u522b",id:"11-classpath\u533a\u522b",level:2},{value:"1.2. \u5404\u79cd\u6ce8\u89e3\u600e\u4e48\u7406\u89e3",id:"12-\u5404\u79cd\u6ce8\u89e3\u600e\u4e48\u7406\u89e3",level:2},{value:"2.1. core \u90e8\u5206",id:"21-core-\u90e8\u5206",level:2},{value:"2.2. aop \u90e8\u5206",id:"22-aop-\u90e8\u5206",level:2},{value:"2.3. data access \u90e8\u5206",id:"23-data-access-\u90e8\u5206",level:2},{value:"2.4. web \u90e8\u5206",id:"24-web-\u90e8\u5206",level:2},{value:"2.5. test \u90e8\u5206&amp;context-support",id:"25-test-\u90e8\u5206context-support",level:2},{value:"2.6. spring4 \u65b0\u589e",id:"26-spring4-\u65b0\u589e",level:2},{value:"2.7. \u7ec4\u4ef6\u7ed3\u6784",id:"27-\u7ec4\u4ef6\u7ed3\u6784",level:2},{value:"2.7.1. ioc-container",id:"271-ioc-container",level:3},{value:"5.1. \u57fa\u4e8e xml",id:"51-\u57fa\u4e8e-xml",level:2},{value:"5.1.1. xml \u4e2d\u7684\u914d\u7f6e\u9879",id:"511-xml-\u4e2d\u7684\u914d\u7f6e\u9879",level:3},{value:"5.1.2. \u51e0\u79cd\u6ce8\u5165-\u5b9e\u4f8b\u5316\u65b9\u5f0f",id:"512-\u51e0\u79cd\u6ce8\u5165-\u5b9e\u4f8b\u5316\u65b9\u5f0f",level:3},{value:"5.1.2.1. \u901a\u8fc7\u6784\u9020\u51fd\u6570",id:"5121-\u901a\u8fc7\u6784\u9020\u51fd\u6570",level:4},{value:"5.1.2.1.1. \u901a\u8fc7\u9759\u6001\u5de5\u5382\u65b9\u6cd5",id:"51211-\u901a\u8fc7\u9759\u6001\u5de5\u5382\u65b9\u6cd5",level:5},{value:"5.1.2.1.2. \u901a\u8fc7\u5b9e\u4f8b\u5de5\u5382\u65b9\u6cd5",id:"51212-\u901a\u8fc7\u5b9e\u4f8b\u5de5\u5382\u65b9\u6cd5",level:5},{value:"5.1.2.2. \u901a\u8fc7 setter \u6ce8\u5165",id:"5122-\u901a\u8fc7-setter-\u6ce8\u5165",level:4},{value:"5.1.2.3. \u901a\u8fc7 MethodInvokingFactoryBean \u6ce8\u5165\u65b9\u6cd5\u7684\u8fd4\u56de\u503c",id:"5123-\u901a\u8fc7-methodinvokingfactorybean-\u6ce8\u5165\u65b9\u6cd5\u7684\u8fd4\u56de\u503c",level:4},{value:"5.1.2.4. @Autowired \u6ce8\u5165",id:"5124-autowired-\u6ce8\u5165",level:4},{value:"5.1.3. springEL \u8868\u8fbe\u5f0f,\u6ce8\u5165\u8868\u8fbe\u5f0f",id:"513-springel-\u8868\u8fbe\u5f0f\u6ce8\u5165\u8868\u8fbe\u5f0f",level:3},{value:"5.1.4. \u96c6\u5408\u7684\u6ce8\u5165",id:"514-\u96c6\u5408\u7684\u6ce8\u5165",level:3},{value:"5.2. \u57fa\u4e8e\u6ce8\u89e3",id:"52-\u57fa\u4e8e\u6ce8\u89e3",level:2},{value:"5.3. xml \u548c\u6ce8\u89e3\u6df7\u7528",id:"53-xml-\u548c\u6ce8\u89e3\u6df7\u7528",level:2},{value:"8.1. aop \u6982\u5ff5",id:"81-aop-\u6982\u5ff5",level:2},{value:"8.2. aop \u8054\u76df\u89c4\u8303",id:"82-aop-\u8054\u76df\u89c4\u8303",level:2},{value:"8.2.1. \u901a\u77e5\u7c7b\u578b",id:"821-\u901a\u77e5\u7c7b\u578b",level:3},{value:"8.2.2. Joinpoint \u8fde\u63a5\u70b9",id:"822-joinpoint-\u8fde\u63a5\u70b9",level:3},{value:"8.3. \u4e0d\u548c spring \u96c6\u6210(\u5355\u72ec\u4f7f\u7528\u52a8\u6001\u4ee3\u7406)",id:"83-\u4e0d\u548c-spring-\u96c6\u6210\u5355\u72ec\u4f7f\u7528\u52a8\u6001\u4ee3\u7406",level:2},{value:"8.3.1. \u901a\u8fc7 jdk \u52a8\u6001\u751f\u6210\u4ee3\u7406",id:"831-\u901a\u8fc7-jdk-\u52a8\u6001\u751f\u6210\u4ee3\u7406",level:3},{value:"8.3.2. \u901a\u8fc7 cglib \u52a8\u6001\u751f\u6210\u4ee3\u7406",id:"832-\u901a\u8fc7-cglib-\u52a8\u6001\u751f\u6210\u4ee3\u7406",level:3},{value:"8.4. \u901a\u8fc7 ProxyFactoryBean \u751f\u6210\u4ee3\u7406(\u534a\u81ea\u52a8)",id:"84-\u901a\u8fc7-proxyfactorybean-\u751f\u6210\u4ee3\u7406\u534a\u81ea\u52a8",level:2},{value:"8.5. \u5168\u81ea\u52a8\u5b9e\u73b0",id:"85-\u5168\u81ea\u52a8\u5b9e\u73b0",level:2},{value:"8.6. \u4f7f\u7528 AspectJ \u6846\u67b6\u751f\u6210\u4ee3\u7406(\u548c spring \u96c6\u6210)",id:"86-\u4f7f\u7528-aspectj-\u6846\u67b6\u751f\u6210\u4ee3\u7406\u548c-spring-\u96c6\u6210",level:2},{value:"8.6.1. \u51c6\u5907\u5de5\u4f5c",id:"861-\u51c6\u5907\u5de5\u4f5c",level:3},{value:"8.6.2. AspectJ \u901a\u77e5\u7c7b\u578b",id:"862-aspectj-\u901a\u77e5\u7c7b\u578b",level:3},{value:"8.6.3. AspectJ \u7f16\u7a0b,\u57fa\u4e8e xml",id:"863-aspectj-\u7f16\u7a0b\u57fa\u4e8e-xml",level:3},{value:"8.6.4. AspectJ \u7f16\u7a0b,\u57fa\u4e8e\u6ce8\u89e3",id:"864-aspectj-\u7f16\u7a0b\u57fa\u4e8e\u6ce8\u89e3",level:3},{value:"9.1. \u6570\u636e\u5e93\u8fde\u63a5\u6c60",id:"91-\u6570\u636e\u5e93\u8fde\u63a5\u6c60",level:2},{value:"9.1.1. C3P0",id:"911-c3p0",level:3},{value:"9.1.2. DBCP",id:"912-dbcp",level:3},{value:"9.1.3. Druid",id:"913-druid",level:3},{value:"9.1.4. BoneCP",id:"914-bonecp",level:3},{value:"9.1.5. HikariCP",id:"915-hikaricp",level:3},{value:"9.2. JdbcTemplate",id:"92-jdbctemplate",level:2},{value:"9.2.1. quickstart",id:"921-quickstart",level:3},{value:"9.2.2. Dao \u5b9e\u73b0\u7c7b\u7ee7\u627f JdbcDaoSupport \u652f\u6301\u7c7b",id:"922-dao-\u5b9e\u73b0\u7c7b\u7ee7\u627f-jdbcdaosupport-\u652f\u6301\u7c7b",level:3},{value:"9.2.3. \u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u653e\u5165 Properties \u6587\u4ef6",id:"923-\u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u653e\u5165-properties-\u6587\u4ef6",level:3},{value:"10.1. \u4e8b\u52a1\u5b9e\u73b0\u539f\u7406",id:"101-\u4e8b\u52a1\u5b9e\u73b0\u539f\u7406",level:2},{value:"10.3. \u4e8b\u52a1\u76f8\u5173 api",id:"103-\u4e8b\u52a1\u76f8\u5173-api",level:2},{value:"10.3.1. PlatformTransactionManager",id:"1031-platformtransactionmanager",level:3},{value:"10.3.2. TransactionStatus",id:"1032-transactionstatus",level:3},{value:"10.3.3. \u4f7f\u7528 jdbc \u64cd\u4f5c\u4e8b\u52a1",id:"1033-\u4f7f\u7528-jdbc-\u64cd\u4f5c\u4e8b\u52a1",level:3},{value:"10.4. \u4e8b\u52a1\u76f8\u5173\u6848\u4f8b-\u8f6c\u8d26",id:"104-\u4e8b\u52a1\u76f8\u5173\u6848\u4f8b-\u8f6c\u8d26",level:2},{value:"10.4.1. \u51c6\u5907",id:"1041-\u51c6\u5907",level:3},{value:"10.4.2. \u624b\u52a8\u5f00\u53d1\u4e8b\u52a1",id:"1042-\u624b\u52a8\u5f00\u53d1\u4e8b\u52a1",level:3},{value:"10.4.3. \u534a\u81ea\u52a8\u4e8b\u52a1(\u751f\u6210\u4ee3\u7406)",id:"1043-\u534a\u81ea\u52a8\u4e8b\u52a1\u751f\u6210\u4ee3\u7406",level:3},{value:"10.4.4. \u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e xml",id:"1044-\u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e-xml",level:3},{value:"10.4.5. \u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e\u6ce8\u89e3",id:"1045-\u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e\u6ce8\u89e3",level:3},{value:"15.1. BeanNameAware\u3001ApplicationContextAware \u548c BeanFactoryAware",id:"151-beannameawareapplicationcontextaware-\u548c-beanfactoryaware",level:2},{value:"15.2. BeanPostProcessor \u63a5\u53e3",id:"152-beanpostprocessor-\u63a5\u53e3",level:2},{value:"15.3. InitialingBean \u548c DisposableBean",id:"153-initialingbean-\u548c-disposablebean",level:2},{value:"15.4. FactoryBean \u63a5\u53e3",id:"154-factorybean-\u63a5\u53e3",level:2},{value:"15.4.1. FactoryBean \u89e3\u91ca",id:"1541-factorybean-\u89e3\u91ca",level:3},{value:"15.4.2. FactoryBean \u63a5\u53e3\u7684 api",id:"1542-factorybean-\u63a5\u53e3\u7684-api",level:3},{value:"15.4.3. FactoryBean \u7b80\u5355\u7684\u4f7f\u7528\u793a\u4f8b",id:"1543-factorybean-\u7b80\u5355\u7684\u4f7f\u7528\u793a\u4f8b",level:3},{value:"15.4.4. factoryBean \u5728 mabatis-spring \u96c6\u6210\u4e2d\u7684\u5e94\u7528",id:"1544-factorybean-\u5728-mabatis-spring-\u96c6\u6210\u4e2d\u7684\u5e94\u7528",level:3},{value:"15.4.5. factoryBean \u6848\u4f8b-dao \u5207\u6362",id:"1545-factorybean-\u6848\u4f8b-dao-\u5207\u6362",level:3},{value:"15.5. BeanFactory \u63a5\u53e3",id:"155-beanfactory-\u63a5\u53e3",level:2},{value:"15.5.1. BeanFactory \u89e3\u91ca",id:"1551-beanfactory-\u89e3\u91ca",level:3},{value:"15.5.2. api \u6709\u54ea\u4e9b",id:"1552-api-\u6709\u54ea\u4e9b",level:3},{value:"15.6. BeanFactoryPostProcessor",id:"156-beanfactorypostprocessor",level:2},{value:"15.7. InstantiationAwareBeanPostProcessor",id:"157-instantiationawarebeanpostprocessor",level:2},{value:"16.1. \u52a8\u6001\u6ce8\u518c\u573a\u666f",id:"161-\u52a8\u6001\u6ce8\u518c\u573a\u666f",level:2},{value:"16.2. \u52a8\u6001\u6ce8\u518c api",id:"162-\u52a8\u6001\u6ce8\u518c-api",level:2},{value:"16.3. \u600e\u4e48\u4f7f\u7528\u52a8\u6001\u6ce8\u518c",id:"163-\u600e\u4e48\u4f7f\u7528\u52a8\u6001\u6ce8\u518c",level:2},{value:"16.3.1. \u901a\u8fc7 BeanFactoryPostProcessor \u5b9e\u73b0\u52a8\u6001\u6ce8\u518c",id:"1631-\u901a\u8fc7-beanfactorypostprocessor-\u5b9e\u73b0\u52a8\u6001\u6ce8\u518c",level:3},{value:"16.3.2. \u901a\u8fc7 BeanDefinitionRegistry \u5728\u666e\u901a bean \u4e2d\u6ce8\u518c",id:"1632-\u901a\u8fc7-beandefinitionregistry-\u5728\u666e\u901a-bean-\u4e2d\u6ce8\u518c",level:3},{value:"16.3.3. \u901a\u8fc7 ImportBeanDefinitionRegistrar",id:"1633-\u901a\u8fc7-importbeandefinitionregistrar",level:3}],u={toc:m};function d(e){var n=e.components,a=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,t.Z)({},u,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"references\uff1a ",(0,o.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring/docs/5.1.2.RELEASE/spring-framework-reference/web.html#filters"},"1"),", ",(0,o.kt)("a",{parentName:"p",href:"https://lfvepclr.gitbooks.io/spring-framework-5-doc-cn/content/32/32-1.html"},"2"),", ",(0,o.kt)("a",{parentName:"p",href:"https://waylau.gitbooks.io/spring-framework-4-reference/"},"3")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/huifer/spring-analysis"},"https://github.com/huifer/spring-analysis")," \u6e90\u7801\u5206\u6790"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1-%E6%8B%BE%E9%81%97"},"1. \u62fe\u9057"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#11-classpath%E5%8C%BA%E5%88%AB"},"1.1. classpath","*","\u533a\u522b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#12-%E5%90%84%E7%A7%8D%E6%B3%A8%E8%A7%A3%E6%80%8E%E4%B9%88%E7%90%86%E8%A7%A3"},"1.2. \u5404\u79cd\u6ce8\u89e3\u600e\u4e48\u7406\u89e3")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#2-%E8%AE%A4%E8%AF%86"},"2. \u8ba4\u8bc6"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#21-core-%E9%83%A8%E5%88%86"},"2.1. core \u90e8\u5206")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#22-aop-%E9%83%A8%E5%88%86"},"2.2. aop \u90e8\u5206")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#23-data-access-%E9%83%A8%E5%88%86"},"2.3. data access \u90e8\u5206")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#24-web-%E9%83%A8%E5%88%86"},"2.4. web \u90e8\u5206")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#25-test-%E9%83%A8%E5%88%86context-support"},"2.5. test \u90e8\u5206\\&context-support")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#26-spring4-%E6%96%B0%E5%A2%9E"},"2.6. spring4 \u65b0\u589e")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#27-%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84"},"2.7. \u7ec4\u4ef6\u7ed3\u6784"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#271-ioc-container"},"2.7.1. ioc-container")))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#3-api-%E4%BD%BF%E7%94%A8"},"3. api \u4f7f\u7528")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#4-quickstart"},"4. quickstart")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#5-%E9%85%8D%E7%BD%AE%E7%9A%84%E6%96%B9%E5%BC%8F"},"5. \u914d\u7f6e\u7684\u65b9\u5f0f"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#51-%E5%9F%BA%E4%BA%8E-xml"},"5.1. \u57fa\u4e8e xml"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#511-xml-%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E9%A1%B9"},"5.1.1. xml \u4e2d\u7684\u914d\u7f6e\u9879")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#512-%E5%87%A0%E7%A7%8D%E6%B3%A8%E5%85%A5-%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%96%B9%E5%BC%8F"},"5.1.2. \u51e0\u79cd\u6ce8\u5165-\u5b9e\u4f8b\u5316\u65b9\u5f0f"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#5121-%E9%80%9A%E8%BF%87%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"},"5.1.2.1. \u901a\u8fc7\u6784\u9020\u51fd\u6570"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#51211-%E9%80%9A%E8%BF%87%E9%9D%99%E6%80%81%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95"},"5.1.2.1.1. \u901a\u8fc7\u9759\u6001\u5de5\u5382\u65b9\u6cd5")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#51212-%E9%80%9A%E8%BF%87%E5%AE%9E%E4%BE%8B%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95"},"5.1.2.1.2. \u901a\u8fc7\u5b9e\u4f8b\u5de5\u5382\u65b9\u6cd5")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#5122-%E9%80%9A%E8%BF%87-setter-%E6%B3%A8%E5%85%A5"},"5.1.2.2. \u901a\u8fc7 setter \u6ce8\u5165")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#5123-%E9%80%9A%E8%BF%87-methodinvokingfactorybean-%E6%B3%A8%E5%85%A5%E6%96%B9%E6%B3%95%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"},"5.1.2.3. \u901a\u8fc7 MethodInvokingFactoryBean \u6ce8\u5165\u65b9\u6cd5\u7684\u8fd4\u56de\u503c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#5124-autowired-%E6%B3%A8%E5%85%A5"},"5.1.2.4. @Autowired \u6ce8\u5165")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#513-springel-%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5%E8%A1%A8%E8%BE%BE%E5%BC%8F"},"5.1.3. springEL \u8868\u8fbe\u5f0f,\u6ce8\u5165\u8868\u8fbe\u5f0f")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#514-%E9%9B%86%E5%90%88%E7%9A%84%E6%B3%A8%E5%85%A5"},"5.1.4. \u96c6\u5408\u7684\u6ce8\u5165")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#52-%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3"},"5.2. \u57fa\u4e8e\u6ce8\u89e3")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#53-xml-%E5%92%8C%E6%B3%A8%E8%A7%A3%E6%B7%B7%E7%94%A8"},"5.3. xml \u548c\u6ce8\u89e3\u6df7\u7528")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#6-junit-%E6%95%B4%E5%90%88"},"6. JUnit \u6574\u5408")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#7-ioc"},"7. IoC")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#8-aop"},"8. AOP"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#81-aop-%E6%A6%82%E5%BF%B5"},"8.1. aop \u6982\u5ff5")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#82-aop-%E8%81%94%E7%9B%9F%E8%A7%84%E8%8C%83"},"8.2. aop \u8054\u76df\u89c4\u8303"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#821-%E9%80%9A%E7%9F%A5%E7%B1%BB%E5%9E%8B"},"8.2.1. \u901a\u77e5\u7c7b\u578b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#822-joinpoint-%E8%BF%9E%E6%8E%A5%E7%82%B9"},"8.2.2. Joinpoint \u8fde\u63a5\u70b9")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#83-%E4%B8%8D%E5%92%8C-spring-%E9%9B%86%E6%88%90%E5%8D%95%E7%8B%AC%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"},"8.3. \u4e0d\u548c spring \u96c6\u6210(\u5355\u72ec\u4f7f\u7528\u52a8\u6001\u4ee3\u7406)"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#831-%E9%80%9A%E8%BF%87-jdk-%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E4%BB%A3%E7%90%86"},"8.3.1. \u901a\u8fc7 jdk \u52a8\u6001\u751f\u6210\u4ee3\u7406")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#832-%E9%80%9A%E8%BF%87-cglib-%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E4%BB%A3%E7%90%86"},"8.3.2. \u901a\u8fc7 cglib \u52a8\u6001\u751f\u6210\u4ee3\u7406")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#84-%E9%80%9A%E8%BF%87-proxyfactorybean-%E7%94%9F%E6%88%90%E4%BB%A3%E7%90%86%E5%8D%8A%E8%87%AA%E5%8A%A8"},"8.4. \u901a\u8fc7 ProxyFactoryBean \u751f\u6210\u4ee3\u7406(\u534a\u81ea\u52a8)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#85-%E5%85%A8%E8%87%AA%E5%8A%A8%E5%AE%9E%E7%8E%B0"},"8.5. \u5168\u81ea\u52a8\u5b9e\u73b0")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#86-%E4%BD%BF%E7%94%A8-aspectj-%E6%A1%86%E6%9E%B6%E7%94%9F%E6%88%90%E4%BB%A3%E7%90%86%E5%92%8C-spring-%E9%9B%86%E6%88%90"},"8.6. \u4f7f\u7528 AspectJ \u6846\u67b6\u751f\u6210\u4ee3\u7406(\u548c spring \u96c6\u6210)"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#861-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"},"8.6.1. \u51c6\u5907\u5de5\u4f5c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#862-aspectj-%E9%80%9A%E7%9F%A5%E7%B1%BB%E5%9E%8B"},"8.6.2. AspectJ \u901a\u77e5\u7c7b\u578b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#863-aspectj-%E7%BC%96%E7%A8%8B%E5%9F%BA%E4%BA%8E-xml"},"8.6.3. AspectJ \u7f16\u7a0b,\u57fa\u4e8e xml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#864-aspectj-%E7%BC%96%E7%A8%8B%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3"},"8.6.4. AspectJ \u7f16\u7a0b,\u57fa\u4e8e\u6ce8\u89e3")))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#9-jdbc"},"9. JDBC"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#91-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"},"9.1. \u6570\u636e\u5e93\u8fde\u63a5\u6c60"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#911-c3p0"},"9.1.1. C3P0")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#912-dbcp"},"9.1.2. DBCP")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#913-druid"},"9.1.3. Druid")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#914-bonecp"},"9.1.4. BoneCP")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#915-hikaricp"},"9.1.5. HikariCP")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#92-jdbctemplate"},"9.2. JdbcTemplate"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#921-quickstart"},"9.2.1. quickstart")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#922-dao-%E5%AE%9E%E7%8E%B0%E7%B1%BB%E7%BB%A7%E6%89%BF-jdbcdaosupport-%E6%94%AF%E6%8C%81%E7%B1%BB"},"9.2.2. Dao \u5b9e\u73b0\u7c7b\u7ee7\u627f JdbcDaoSupport \u652f\u6301\u7c7b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#923-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE%E6%94%BE%E5%85%A5-properties-%E6%96%87%E4%BB%B6"},"9.2.3. \u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u653e\u5165 Properties \u6587\u4ef6")))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#10-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"},"10. \u4e8b\u52a1\u7ba1\u7406"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#101-%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"},"10.1. \u4e8b\u52a1\u5b9e\u73b0\u539f\u7406")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#103-%E4%BA%8B%E5%8A%A1%E7%9B%B8%E5%85%B3-api"},"10.3. \u4e8b\u52a1\u76f8\u5173 api"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1031-platformtransactionmanager"},"10.3.1. PlatformTransactionManager")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1032-transactionstatus"},"10.3.2. TransactionStatus")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1033-%E4%BD%BF%E7%94%A8-jdbc-%E6%93%8D%E4%BD%9C%E4%BA%8B%E5%8A%A1"},"10.3.3. \u4f7f\u7528 jdbc \u64cd\u4f5c\u4e8b\u52a1")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#104-%E4%BA%8B%E5%8A%A1%E7%9B%B8%E5%85%B3%E6%A1%88%E4%BE%8B-%E8%BD%AC%E8%B4%A6"},"10.4. \u4e8b\u52a1\u76f8\u5173\u6848\u4f8b-\u8f6c\u8d26"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1041-%E5%87%86%E5%A4%87"},"10.4.1. \u51c6\u5907")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1042-%E6%89%8B%E5%8A%A8%E5%BC%80%E5%8F%91%E4%BA%8B%E5%8A%A1"},"10.4.2. \u624b\u52a8\u5f00\u53d1\u4e8b\u52a1")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1043-%E5%8D%8A%E8%87%AA%E5%8A%A8%E4%BA%8B%E5%8A%A1%E7%94%9F%E6%88%90%E4%BB%A3%E7%90%86"},"10.4.3. \u534a\u81ea\u52a8\u4e8b\u52a1(\u751f\u6210\u4ee3\u7406)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1044-%E5%85%A8%E8%87%AA%E5%8A%A8%E4%BA%8B%E5%8A%A1%E5%9F%BA%E4%BA%8E-xml"},"10.4.4. \u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e xml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1045-%E5%85%A8%E8%87%AA%E5%8A%A8%E4%BA%8B%E5%8A%A1%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3"},"10.4.5. \u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e\u6ce8\u89e3")))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#11-spring-web-%E5%BC%80%E5%8F%91"},"11. spring web \u5f00\u53d1")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#12-%E5%87%A0%E7%A7%8D%E5%8A%A0%E8%BD%BD-xml-%E6%96%B9%E5%BC%8F"},"12. \u51e0\u79cd\u52a0\u8f7d xml \u65b9\u5f0f")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#13-spring-%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"},"13. spring \u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#14-spring-bean-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"},"14. spring bean \u751f\u547d\u5468\u671f")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#15-%E5%B8%B8%E7%94%A8%E7%9A%84-spring-bean-%E6%8B%93%E5%B1%95%E6%8E%A5%E5%8F%A3"},"15. \u5e38\u7528\u7684 spring bean \u62d3\u5c55\u63a5\u53e3"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#151-beannameawareapplicationcontextaware-%E5%92%8C-beanfactoryaware"},"15.1. BeanNameAware\u3001ApplicationContextAware \u548c BeanFactoryAware")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#152-beanpostprocessor-%E6%8E%A5%E5%8F%A3"},"15.2. BeanPostProcessor \u63a5\u53e3")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#153-initialingbean-%E5%92%8C-disposablebean"},"15.3. InitialingBean \u548c DisposableBean")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#154-factorybean-%E6%8E%A5%E5%8F%A3"},"15.4. FactoryBean \u63a5\u53e3"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1541-factorybean-%E8%A7%A3%E9%87%8A"},"15.4.1. FactoryBean \u89e3\u91ca")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1542-factorybean-%E6%8E%A5%E5%8F%A3%E7%9A%84-api"},"15.4.2. FactoryBean \u63a5\u53e3\u7684 api")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1543-factorybean-%E7%AE%80%E5%8D%95%E7%9A%84%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"},"15.4.3. FactoryBean \u7b80\u5355\u7684\u4f7f\u7528\u793a\u4f8b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1544-factorybean-%E5%9C%A8-mabatis-spring-%E9%9B%86%E6%88%90%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8"},"15.4.4. factoryBean \u5728 mabatis-spring \u96c6\u6210\u4e2d\u7684\u5e94\u7528")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1545-factorybean-%E6%A1%88%E4%BE%8B-dao-%E5%88%87%E6%8D%A2"},"15.4.5. factoryBean \u6848\u4f8b-dao \u5207\u6362")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#155-beanfactory-%E6%8E%A5%E5%8F%A3"},"15.5. BeanFactory \u63a5\u53e3"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1551-beanfactory-%E8%A7%A3%E9%87%8A"},"15.5.1. BeanFactory \u89e3\u91ca")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1552-api-%E6%9C%89%E5%93%AA%E4%BA%9B"},"15.5.2. api \u6709\u54ea\u4e9b")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#156-beanfactorypostprocessor"},"15.6. BeanFactoryPostProcessor")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#157-instantiationawarebeanpostprocessor"},"15.7. InstantiationAwareBeanPostProcessor")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#16-%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C-bean"},"16. \u52a8\u6001\u6ce8\u518c bean"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#161-%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C%E5%9C%BA%E6%99%AF"},"16.1. \u52a8\u6001\u6ce8\u518c\u573a\u666f")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#162-%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C-api"},"16.2. \u52a8\u6001\u6ce8\u518c api")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#163-%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C"},"16.3. \u600e\u4e48\u4f7f\u7528\u52a8\u6001\u6ce8\u518c"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1631-%E9%80%9A%E8%BF%87-beanfactorypostprocessor-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C"},"16.3.1. \u901a\u8fc7 BeanFactoryPostProcessor \u5b9e\u73b0\u52a8\u6001\u6ce8\u518c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1632-%E9%80%9A%E8%BF%87-beandefinitionregistry-%E5%9C%A8%E6%99%AE%E9%80%9A-bean-%E4%B8%AD%E6%B3%A8%E5%86%8C"},"16.3.2. \u901a\u8fc7 BeanDefinitionRegistry \u5728\u666e\u901a bean \u4e2d\u6ce8\u518c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#1633-%E9%80%9A%E8%BF%87-importbeandefinitionregistrar"},"16.3.3. \u901a\u8fc7 ImportBeanDefinitionRegistrar")))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#17-%E5%9B%BD%E9%99%85%E5%8C%96-and-%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C"},"17. \u56fd\u9645\u5316 and \u53c2\u6570\u6821\u9a8c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#18-spring5-%E6%96%B0%E7%89%B9%E6%80%A7"},"18. spring5 \u65b0\u7279\u6027"))),(0,o.kt)("h1",{id:"1-\u62fe\u9057"},"1. \u62fe\u9057"),(0,o.kt)("h2",{id:"11-classpath\u533a\u522b"},"1.1. classpath","*","\u533a\u522b"),(0,o.kt)("p",null,"classpath \u662f\u6307 WEB-INF \u6587\u4ef6\u5939\u4e0b\u7684 classes \u76ee\u5f55"),(0,o.kt)("p",null,"\u7f16\u8bd1\u540e, src \u4e0b\u7684\u4ee3\u7801&\u914d\u7f6e\u6587\u4ef6 \u90fd\u4f1a\u88ab\u590d\u5236\u5230 ",(0,o.kt)("inlineCode",{parentName:"p"},"/WEB-INF/classes")," \u6587\u4ef6\u5939\u4e0b, \u90e8\u7f72\u5230\u670d\u52a1\u5668\u540e\u771f\u6b63\u4f7f\u7528\u7684\u914d\u7f6e\u6587\u4ef6\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"WEB-INF/web.xml")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"classpath")," \uff1a\u53ea\u4f1a\u5230\u4f60\u7684 class \u8def\u5f84\u4e2d\u67e5\u627e\u627e\u6587\u4ef6; ",(0,o.kt)("inlineCode",{parentName:"p"},"classpath*"),"\uff1a\u4e0d\u4ec5\u5305\u542b class \u8def\u5f84\uff0c\u8fd8\u5305\u62ec jar \u6587\u4ef6\u4e2d\uff08class \u8def\u5f84\uff09\u8fdb\u884c\u67e5\u627e\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\u5982\u679capplicationContext.xml\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u5728src\u76ee\u5f55\u4e0b\uff0c\u5c31\u597d\u6bd4\u4e0a\u9762\u7684\u4ee3\u7801\u7ed3\u6784\u4e2d\u7684\u5b58\u653e\u4f4d\u7f6e\uff0c\u90a3\u4e48\u5728web.xml\u4e2d\u7684\u914d\u7f6e\u5c31\u5982\u4e0b\u6240\u793a\uff1a\n\n    <context-param>\n        <param-name>contextConfigLocation</param-name>\n        <param-value>classpath:applicationContext.xml</param-value> \x3c!--classpath\u524d\u7f00\u8868\u793a "/WEB-INF/classes"--\x3e\n    </context-param>\n\n\u5982\u679capplicationContext.xml\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u5728WEB-INF\u4e0b\u9762\uff0c\u90a3\u4e48\u5728web.xml\u4e2d\u7684\u914d\u7f6e\u5c31\u5982\u4e0b\u6240\u793a\uff1a\n\n    <context-param>\n        <param-name>contextConfigLocation</param-name>\n        <param-value>WEB-INF/applicationContext*.xml</param-value>\n    </context-param>\n\n')),(0,o.kt)("h2",{id:"12-\u5404\u79cd\u6ce8\u89e3\u600e\u4e48\u7406\u89e3"},"1.2. \u5404\u79cd\u6ce8\u89e3\u600e\u4e48\u7406\u89e3"),(0,o.kt)("p",null,"references: ",(0,o.kt)("a",{parentName:"p",href:"http://blog.leanote.com/post/sheng91666@163.com/spring%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%B1%87%E6%80%BB"},"\u5e38\u7528\u6ce8\u89e3\u5206\u7c7b\u6c47\u603b")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'<context:component-scan base-package="cn.test"/>')," \u5f00\u542f\u6ce8\u89e3\u626b\u63cf"),(0,o.kt)("p",null,"\u8981\u8ba9 JSR-250 \u7684\u6ce8\u91ca\u751f\u6548\uff0c\u9664\u4e86\u5728 Bean \u7c7b\u4e2d\u6807\u6ce8\u8fd9\u4e9b\u6ce8\u91ca\u5916\uff0c\u8fd8\u9700\u8981\u5728 Spring \u5bb9\u5668\u4e2d\u6ce8\u518c\u4e00\u4e2a\u8d1f\u8d23\u5904\u7406\u8fd9\u4e9b\u6ce8\u91ca\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"org.springframework.context.annotation.CommonAnnotationBeanPostProcessor")," bean, \u65e0\u9700 bean id"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'\n-> Bean \u58f0\u660e\n\nComponent\nController\nService\nRepository\n\n-> Bean\u7684\u521d\u59cb\u5316\u548c\u9500\u6bc1\n\n@Bean           \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a,\u58f0\u660e\u5f53\u524d\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u4e3a\u4e00\u4e2abean; eg: @Bean(initMethod="init",destroyMethod="destory") \u6ce8\u518c\u524d\u6267\u884cinit\u65b9\u6cd5, \u9500\u6bc1\u524d\u6267\u884cdestroy\u65b9\u6cd5\u3002\n\n    JSR-250\u89c4\u8303\n\n@PostConstruct  \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a, \u5728\u6784\u9020\u51fd\u6570\u6267\u884c\u540e\u6267\u884c\n@PreDestroy     \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a, \u5728Bean\u9500\u6bc1\u4e4b\u524d\u6267\u884c\n@DependsOn      \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a, \u5b9a\u4e49Bean\u521d\u59cb\u5316\u53ca\u9500\u6bc1\u65f6\u7684\u987a\u5e8f\n\n-> bean\u6ce8\u5165\n\n    spring\u539f\u751f\u63d0\u4f9b\n\n@Autowired   \u6309\u7167\u7c7b\u578b\u88c5\u914d, \u6309\u540d\u79f0\u88c5\u914d\uff0c\u53ef\u4ee5\u7ed3\u5408@Qualifier \u6ce8\u89e3\u4e00\u8d77\u4f7f\u7528\n\n    JSR250\u63d0\u4f9b\u7684\u6ce8\u89e3\n\n@Resource    \u9ed8\u8ba4\u6309\u540d\u79f0\u88c5\u914d\uff0c\u5f53\u627e\u4e0d\u5230\u4e0e\u540d\u79f0\u5339\u914d\u7684bean\u624d\u4f1a\u6309\u7c7b\u578b\u88c5\u914d\n\n    JSR330\n\n@Inject  \u6839\u57fa\u7c7b\u578b\u88c5\u914d\n\n\n\n-> Java\u914d\u7f6e\n\n@EnableAutoConfiguration  \u6839\u636e\u6dfb\u52a0\u7684jar\u4f9d\u8d56\u731c\u6d4b\u4f60\u60f3\u5982\u4f55\u914d\u7f6eSpring\uff0c\u5982\u679c\u53d1\u73b0\u5e94\u7528\u4e86\u4f60\u4e0d\u60f3\u8981\u7684\u7279\u5b9a\u81ea\u52a8\u914d\n                        \u7f6e\u7c7b\uff0c\u53ef\u4ee5\u4f7f\u7528 @EnableAutoConfiguration \u6ce8\u89e3\u7684exclude\u5c5e\u6027\u6765\u7981\u7528\u5b83\u4eec\n                        eg\uff1a@EnableAutoConfiguration(exclude = {MetricFilterAutoConfiguration.class, MetricRepositoryAutoConfiguration.class})\n                        @SpringBootApplication \u5305\u542b\u5b83\n@Configuration   \u58f0\u660e\u5f53\u524d\u7c7b\u662f\u4e00\u4e2a\u914d\u7f6e\u7c7b\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2aSpring\u914d\u7f6e\u7684xml\u6587\u4ef6\u3002 \u548c@Bean \u642d\u914d\u4f7f\u7528\n                \u7406\u89e3: \u672c\u8d28\u4e0a\u8fd8\u662f @Component; \u901a\u5e38\u9009\u5b9a\u4e00\u4e2a\u4e3bconfig\u7c7b, \u901a\u8fc7 import\u5c5e\u6027\u5bfc\u5165\u5176\u4ed6\u914d\u7f6e\u7c7b (\u751a\u81f3\n                \u53ef\u4ee5\u662fxml\u914d\u7f6e\u7c7b, \u901a\u8fc7@ImportResource \u6ce8\u89e3\u52a0\u8f7dXML\u914d\u7f6e\u6587\u4ef6)\n                @SpringBootApplication \u5305\u542b\u5b83\n@Bean            \u58f0\u660e\u5f53\u524d\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u4e3a\u4e00\u4e2aBean, \u7528@Bean\u6807\u6ce8\u65b9\u6cd5\u7b49\u4ef7\u4e8eXML\u4e2d\u914d\u7f6ebean\n@ComponentScan   \u81ea\u52a8\u626b\u63cf\u5305\u540d\u4e0b\u6240\u6709\u4f7f\u7528@Service\u3001@Compent\u3001@Repository\u3001@Controller \u7684\u7c7b\uff08\u4e3b@configuration \u7c7b\n                \u9700\u8981\u5728root\u76ee\u5f55\u4e0b\uff09\uff0c\u5e76\u6ce8\u518c\u4e3aBean, \u4e00\u822c\u5728\u4e3b@configuration \u7c7b\u4e0a\u4f7f\u7528\n                    \u901a\u8fc7@autowired \u81ea\u52a8\u6ce8\u5165\uff1b @springbootapplication\u5305\u542b\u5b83\n@Lazy(true)      \u8868\u793a\u5ef6\u8fdf\u521d\u59cb\u5316\n@Primary         \u81ea\u52a8\u88c5\u914d\u65f6\u5f53\u51fa\u73b0\u591a\u4e2aBean\u5019\u9009\u8005\u65f6\uff0c\u88ab\u6ce8\u89e3\u4e3a@Primary\u7684Bean\u5c06\u4f5c\u4e3a\u9996\u9009\u8005\uff0c\u5426\u5219\u5c06\u629b\u51fa\u5f02\u5e38\n\n@Scope           \u63cf\u8ff0\u7684\u662fSpring\u5bb9\u5668\u5982\u4f55\u65b0\u5efaBean\u7684\u5b9e\u4f8b\u7684\u3002\u5b9e\u4f8b\uff1aScope("Prototype")\n@Order           \u8c03\u6574\u914d\u7f6e\u7c7b\u52a0\u8f7d\u987a\u5e8f\u3002\n\n@Import          \u5f15\u5165\u53e6\u5916\u7684@configuration\u7c7b,  @Import @ImportResource\u90fd\u9700\u8981\u914d\u5408@Configuration\u4f7f\u7528\n@ImportResource  \u7528\u6765\u5f15\u5165\u5916\u7f6e\u7684\u914d\u7f6e\u6587\u4ef6,\n                eg: @ImportResource({"classpath:datasource.xml"})\n@PropertySource  springboot\u9ed8\u8ba4\u53ea\u4f1a\u52a0\u8f7dapplication.properties\u4e2d\u7684\u5c5e\u6027, @PropertySource\u7528\u4e8e\u52a0\u8f7d\u53e6\u5916\u7684\u5c5e\u6027\u914d\u7f6e\u6587\u4ef6\n                eg: @PropertySource(value = {"classpath:person.properties"}),\n                \u4e00\u822c\u548c@ConfigurationProperties(prefix = "person")\u4e00\u8d77\u7528\n@Value           \u6ce8\u89e3\u5728\u53d8\u91cf\u4e0a, \u8c03\u7528\u8d44\u6e90\uff08\u666e\u901a\u6587\u4ef6\uff0c\u7f51\u5740\uff0c\u914d\u7f6e\u6587\u4ef6\uff0c\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u7b49\uff09,\u548c @component \u5408\u7528\n                eg\uff1a @Value("${com.neo.title}")\n\n-> aop\n\n@Aspect         \u6ce8\u89e3\u5728\u7c7b\u4e0a, \u58f0\u660e\u662f\u4e00\u4e2a\u5207\u9762\u3002\n@After          \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a, \u58f0\u660e\u5efa\u8a00\n@Before         \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a, \u58f0\u660e\u5efa\u8a00\n@Around         \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a, \u58f0\u660e\u5efa\u8a00\n@PointCut       \u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a, \u5b9a\u4e49\u62e6\u622a\u89c4\u5219\uff0c\u58f0\u660e\u5207\u70b9\u3002\n\n@EnableAspectJAutoProxy      \u4f5c\u7528\u5728\u914d\u7f6e\u7c7b\u4e0a, \u5f00\u542f\u5bf9AspectJ\u81ea\u52a8\u4ee3\u7406\u7684\u652f\u6301\u3002\n\n-> Spring EL \u548c \u8d44\u6e90\u8c03\u7528\n\n@PropertySource  \u89c1\u2191\n\n@EnbaleConfigurationProperties   \u5f00\u542f\u5bf9@ConfigurationProperties \u6ce8\u89e3\u914d\u7f6eBean\u7684\u652f\u6301\n                                eg: @EnableConfigurationProperties({LiquibaseProperties.class, ApplicationProperties.class})\n@ConfigurationProperties         \u6ce8\u89e3\u5728\u7c7b\u4e0a, \u6620\u5c04\u914d\u7f6e\u6587\u4ef6\uff08\u652f\u6301 yml\uff09\u5230JavaBean eg\uff1a@ConfigurationProperties(prefix="myProps")\n                        \u8fd8\u53ef\u4ee5\u5728@Bean\u65b9\u6cd5\u4e0a\u4f7f\u7528\uff0c \u4f5c\u7528\u7c7b\u4f3c\u6ce8\u89e3\u5728\u7c7b\u4e0a\n                                \u53e6\u5916\uff0c \u5f53\u4e00\u4e2a @ConfigurationProperties bean \u50cf\u5982\u4e0a\u8fd9\u6837\u6ce8\u518c\uff0c\u8fd9\u4e2abean\u5c31\u6709\u4e86\u4e00\u4e2a\u540d\u5b57\uff0c\u89c4\n                                \u8303\u662f\u8fd9\u6837\uff1a`<prefix>-<fqn>`, \u5373\uff1a\u524d\u7f00-\u5168\u9650\u5b9a\u540d\uff0c\u5982 : myProps-com.xy.PropertiesBean\n\n-> \u4e8b\u52a1,\u7f13\u5b58\n\n@EnableTransactionManagement                    \u5f00\u542f\u6ce8\u89e3\u5f0f\u4e8b\u52a1\u7684\u652f\u6301, \u53ef\u80fd\u9700\u8981 proxyTargetClass = true, \u8868\u793a\u521b\u5efa\u57fa\u4e8e\u5b50\u7c7b\u7684\u4ee3\u7406\n@Transactional(transactionManager="xxx" ...)     \u65b9\u6cd5or\u7c7b\u4e0a, \u4f7f\u7528\u4e8b\u52a1\u7ba1\u7406 ;@TransactionConfiguration \u8fc7\u65f6\u4e86, \u88ab @Transactional \u4ee3\u66ff\n\n@EnableCaching                                  \u5f00\u542f\u6ce8\u89e3\u5f0f\u7684\u7f13\u5b58\u652f\u6301\n\n-> \u5f02\u6b65,\u591a\u7ebf\u7a0b\n\n@EnableAsync    \u6ce8\u89e3\u5728\u914d\u7f6e\u7c7b\u4e0a, \u5f00\u542f\u5bf9\u5f02\u6b65\u4efb\u52a1\u7684\u652f\u6301\n@Async          \u5728\u5b9e\u9645\u6267\u884c\u7684Bean\u7684\u65b9\u6cd5\u4e0a, \u58f0\u660e\u8fd9\u662f\u4e00\u4e2a\u5f02\u6b65\u4efb\u52a1\n\n-> \u5b9a\u65f6\u4efb\u52a1\n\nEnableScheduling    \u6ce8\u89e3\u5728\u914d\u7f6e\u7c7b\u4e0a, \u5f00\u542f\u5bf9\u8ba1\u5212\u4efb\u52a1\uff08\u5b9a\u65f6\u4efb\u52a1\uff09\u7684\u652f\u6301\nScheduled           \u5b9e\u9645\u6267\u884c\u7684\u65b9\u6cd5\u4e0a, \u5305\u542b\uff1acron \u3001fixDelay\u3001fixRate\u7b49\u7c7b\u578b\n                    eg: @Scheduled \uff08cron="0 25 11 \uff1f * *"\uff09\n                    @Scheduled \uff08fixedDelay=5000\uff09\u5ef6\u8fdf5\u79d2\u6267\u884c\n                    @Scheduled \uff08fixedRate=5000\uff09\u6bcf\u96945\u79d2\u6267\u884c\u4e00\u6b21\n\n-> \u6761\u4ef6\u6ce8\u89e3\n\nConditional         \u7528\u5728\u914d\u7f6e\u7c7b\u4e2d, \u6839\u636e\u6ee1\u8db3\u67d0\u4e00\u4e2a\u7279\u5b9a\u6761\u4ef6\u521b\u5efa\u4e00\u4e2a\u7279\u5b9a\u7684Bean\u3002\uff08Spring4\u63d0\u4f9b\uff09\n\n-> WebMVC\n\nEnableWebMvc        \u5f00\u542fweb mvc\u7684\u914d\u7f6e\u652f\u6301\nController          \u58f0\u660e\u4e00\u4e2a\u7c7b\u4e3a mvc \u91cc\u7684 controller, Dispatcher Servlet\u4f1a\u81ea\u52a8\u626b\u63cf\u6ce8\u89e3\u4e86\u6b64\u6ce8\u89e3\u7684\u7c7b\uff0c\u5e76\u5c06Web\u8bf7\u6c42\u6620\u5c04\u5230@RequestMappin\u7684\u65b9\u6cd5\u4e0a\nRestController      \u7ec4\u5408\u6ce8\u89e3 =@Controller+@ResponseBody, \u7528\u6765\u521b\u5efaREST\u7c7b\u578b\u7684\u63a7\u5236\u5668\nRequestMapping      \u7c7bor\u65b9\u6cd5\u4e0a\nResponseBody        \u7c7bor\u65b9\u6cd5or\u65b9\u6cd5\u8fd4\u56de\u503c\u4e0a; \u5c06\u8fd4\u56de\u7c7b\u578b\u76f4\u63a5\u8f93\u5165\u5230HTTP response body\u4e2d\u3002json\u683c\u5f0f\nRequestBody         \u53c2\u6570\u4e0a; \u8bbe\u7f6e\u53c2\u6570\u5728\u8bf7\u6c42\u4f53\u5185\n@RequestParam       \u53c2\u6570\u4e0a;\u5c06\u8bf7\u6c42\u7684\u53c2\u6570\u7ed1\u5b9a\u5230\u65b9\u6cd5\u4e2d\u7684\u53c2\u6570\u4e0a\nPathVariable        \u53c2\u6570\u4e0a, \u652f\u6301\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f,\u80fd\u5728\u8def\u5f84\u6a21\u677f\u4e2d\u4f7f\u7528\u5360\u4f4d\u7b26; \u63a5\u53d7\u8def\u5f84\u53c2\u6570\nInitBinder          \u7528\u6765\u8bbe\u7f6eWebDataBinder\uff0cWebDataBinder\u7528\u6765\u81ea\u52a8\u7ed1\u5b9a\u524d\u53f0\u8bf7\u6c42\u53c2\u6570\u5230Model\u4e2d\u3002\nModelAttribute      \u65b9\u6cd5or\u65b9\u6cd5\u53c2\u6570;\nHttpEntity\n\nControllerAdvice    \u7c7b\u4e0a; \u5c06\u5bf9\u4e8e\u63a7\u5236\u5668\u7684\u5168\u5c40\u4ee3\u7801\u653e\u5728\u540c\u4e00\u4e2a\u4f4d\u7f6e\nExceptionHandler    \u65b9\u6cd5\u4e0a; \u5168\u5c40\u5904\u7406\u63a7\u5236\u5668\u91cc\u7684\u5f02\u5e38\n\n-> test \u6d4b\u8bd5\u76f8\u5173\n\n@RunWith(SpringJUnit4ClassRunner.class)  \u542f\u52a8 Spring \u5bf9\u6d4b\u8bd5\u7c7b\u7684\u652f\u6301\n@ContextConfiguration                    \u6ce8\u91ca\u6807\u7b7e\u6765\u6307\u5b9a Spring \u914d\u7f6e\u6587\u4ef6\u6216\u8005\u914d\u7f6e\u7c7b\u7684\u4f4d\u7f6e\n@Rollback(value=false)                  \u4e8b\u52a1\u56de\u6eda\n\n')),(0,o.kt)("h1",{id:"2-\u8ba4\u8bc6"},"2. \u8ba4\u8bc6"),(0,o.kt)("p",null,"spring \u7684\u4f53\u7cfb\u7ed3\u6784"),(0,o.kt)("p",null,"\u5148\u770b\u770b spring3 \u7684:"),(0,o.kt)("p",null,"spring4: (\u53bb\u6389\u4e86 spring3 \u7684 struts\uff0c\u6dfb\u52a0\u4e86 messaging \u548c websocket\uff0c\u5176\u4ed6\u6a21\u5757\u4fdd\u6301\u4e0d\u53d8)"),(0,o.kt)("p",null,"\u81f3\u4e8e spring5 \u7684\u65b0\u7279\u6027, \u53c2\u89c1: ",(0,o.kt)("a",{parentName:"p",href:"https://www.ibm.com/developerworks/cn/java/j-whats-new-in-spring-framework-5-theedom/index.html"},"https://www.ibm.com/developerworks/cn/java/j-whats-new-in-spring-framework-5-theedom/index.html")),(0,o.kt)("h2",{id:"21-core-\u90e8\u5206"},"2.1. core \u90e8\u5206"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u56db\u4e2a\u6838\u5fc3 jar"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Spring core"),(0,o.kt)("p",{parentName:"li"},"\u8fd9\u4e2a jar \u6587\u4ef6\u5305\u542b Spring \u6846\u67b6\u57fa\u672c\u7684\u6838\u5fc3\u5de5\u5177\u7c7b\u3002Spring \u5176\u5b83\u7ec4\u4ef6\u8981\u90fd\u8981\u4f7f\u7528\u5230\u8fd9\u4e2a\u5305\u91cc\u7684\u7c7b\uff0c\u662f\u5176\u5b83\u7ec4\u4ef6\u7684\u57fa\u672c\u6838\u5fc3"),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},"Spring core \u7684\u8fd0\u884c\u4f9d\u8d56 Commons Logging \u5305"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Spring Beans"),(0,o.kt)("p",{parentName:"li"},"\u8fd9\u4e2a jar \u6587\u4ef6\u662f\u6240\u6709\u5e94\u7528\u90fd\u8981\u7528\u5230\u7684\uff0c\u5b83\u5305\u542b\u8bbf\u95ee\u914d\u7f6e\u6587\u4ef6\u3001\u521b\u5efa\u548c\u7ba1\u7406 bean \u4ee5\u53ca\u8fdb\u884c IOC/DI (\u63a7\u5236\u53cd\u8f6c/\u4f9d\u8d56\u6ce8\u5165)\u64cd\u4f5c\u76f8\u5173\u7684\u6240\u6709\u7c7b"),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},"\u5982\u679c\u53ea\u9700\u57fa\u672c\u7684 IOC/DI \u652f\u6301\uff0c\u5f15\u5165 spring-core.jar \u53ca spring-beans.jar \u6587\u4ef6\u5c31\u53ef\u4ee5\u4e86\u3002\n\u5982\u679c\u662f maven \u5de5\u7a0b, \u4ec5\u4ec5\u9700\u8981 Spring Context \u5373\u53ef"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Spring AOP"),(0,o.kt)("p",{parentName:"li"},"\u8fd9\u4e2a jar \u6587\u4ef6\u5305\u542b\u5728\u5e94\u7528\u4e2d\u4f7f\u7528 Spring \u7684 AOP \u7279\u6027\u65f6\u6240\u9700\u7684\u7c7b\u548c\u6e90\u7801\u7ea7\u5143\u6570\u636e\u652f\u6301\u3002\u4f7f\u7528\u57fa\u4e8e AOP \u7684 Spring \u7279\u6027\uff0c\u5982\u58f0\u660e\u578b\u4e8b\u52a1\u7ba1\u7406\uff08Declarative Transaction Management\uff09\uff0c\u4e5f\u8981\u5728\u5e94\u7528\u91cc\u5305\u542b\u8fd9\u4e2a jar \u5305")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Spring Context"),(0,o.kt)("p",{parentName:"li"},"\u8fd9\u4e2a jar \u6587\u4ef6\u4e3a Spring \u6838\u5fc3\u63d0\u4f9b\u4e86\u5927\u91cf\u6269\u5c55\u3002\u53ef\u4ee5\u627e\u5230\u4f7f\u7528 Spring ApplicationContext \u7279\u6027\u65f6\u6240\u9700\u7684\u5168\u90e8\u7c7b\uff0cJDNI \u6240\u9700\u7684\u5168\u90e8\u7c7b\uff0cinstrumentation \u7ec4\u4ef6\u4ee5\u53ca\u6821\u9a8c Validation \u65b9\u9762\u7684\u76f8\u5173\u7c7b\u3002"),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},"\u6ce8:\nspring-context-support: context \u62d3\u5c55\u5305, \u5305\u542b\u652f\u6301 mvc \u76f8\u5173, \u7f13\u5b58 Cache\uff08ehcache\uff09\u3001JCA\u3001JMX\u3001 \u90ae\u4ef6\u670d\u52a1\uff08Java Mail\u3001COS Mail\uff09\u3001\u4efb\u52a1\u8ba1\u5212 Scheduling\uff08Timer\u3001Quartz\uff09\u65b9\u9762\u7684\u7c7b")))))),(0,o.kt)("h2",{id:"22-aop-\u90e8\u5206"},"2.2. aop \u90e8\u5206"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-aop\uff1a\u9762\u5411\u5207\u9762\u7f16\u7a0b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-aspects\uff1a\u96c6\u6210 AspectJ"))),(0,o.kt)("h2",{id:"23-data-access-\u90e8\u5206"},"2.3. data access \u90e8\u5206"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-jdbc\uff1ajdbc \u7684\u652f\u6301")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-tx\uff1a\u4e8b\u52a1\u63a7\u5236")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-orm\uff1a\u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\uff0c\u96c6\u6210 orm \u6846\u67b6")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-oxm\uff1a\u5bf9\u8c61 xml \u6620\u5c04")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-jms\uff1ajava \u6d88\u606f\u670d\u52a1"))),(0,o.kt)("h2",{id:"24-web-\u90e8\u5206"},"2.4. web \u90e8\u5206"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-web\uff1a\u57fa\u7840 web \u529f\u80fd\uff0c\u5982\u6587\u4ef6\u4e0a\u4f20")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-webmvc\uff1amvc \u5b9e\u73b0"))),(0,o.kt)("h2",{id:"25-test-\u90e8\u5206context-support"},"2.5. test \u90e8\u5206&context-support"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-test\uff1aspring \u6d4b\u8bd5\uff0c\u63d0\u4f9b junit \u4e0e mock \u6d4b\u8bd5\u529f\u80fd")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-context-support\uff1aspring \u989d\u5916\u652f\u6301\u5305\uff0c\u6bd4\u5982\u90ae\u4ef6\u670d\u52a1\u3001\u89c6\u56fe\u89e3\u6790\u7b49"))),(0,o.kt)("h2",{id:"26-spring4-\u65b0\u589e"},"2.6. spring4 \u65b0\u589e"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-websocket\uff1a\u4e3a web \u5e94\u7528\u63d0\u4f9b\u7684\u9ad8\u6548\u901a\u4fe1\u5de5\u5177")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring-messaging\uff1a\u7528\u4e8e\u6784\u5efa\u57fa\u4e8e\u6d88\u606f\u7684\u5e94\u7528\u7a0b\u5e8f"))),(0,o.kt)("h2",{id:"27-\u7ec4\u4ef6\u7ed3\u6784"},"2.7. \u7ec4\u4ef6\u7ed3\u6784"),(0,o.kt)("h3",{id:"271-ioc-container"},"2.7.1. ioc-container"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'BeanFactory - \u9876\u7ea7\u63a5\u53e3\n    ApplicationContext - \u4ee3\u8868\u4e86  Spring IoC \u5bb9\u5668\n        ClassPathXmlApplicationContext -\n        FileSystemXmlApplicationContext\n\nFactoryBean - \u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\u7684bean \u65f6\u7279\u6b8a\u7684 "\u5de5\u5382bean", getObject() \u7528\u6765\u8fd4\u56de\u751f\u4ea7\u7684\u5bf9\u8c61\n\n')),(0,o.kt)("h1",{id:"3-api-\u4f7f\u7528"},"3. api \u4f7f\u7528"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public class TestDI {\n    @Test\n    public void demo01(){\n        //\u4f9d\u8d56\u6ce8\u5165\n        String xmlPath = "config/beans.xml";\n        //\u52a0\u8f7d\u5b8c\u914d\u7f6e\u6587\u4ef6\u5c31\u6784\u9020\u4e86BookService\u5bf9\u8c61\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        BookService bookService = applicationContext.getBean("bookServiceId",BookService.class);\n        bookService.addBook();\n    }\n    @Test\n    public void demo02(){\n        //beanFactory\n        String xmlPath = "config/beans.xml";\n        //Resource \u5728 beanFactory\u4e2d\u7528\u4e8e\u63cf\u8ff0\u6587\u4ef6\u4f4d\u7f6e\n        // * ClassPathResource \u63cf\u8ff0\u7c7b\u8def\u5f84\n        // * FileSystemResource \u63cf\u8ff0\u6307\u5b9a\u76d8\u7b26\n        BeanFactory beanFactory = new XmlBeanFactory(new ClassPathResource(xmlPath));\n        //\u8c03\u7528getBean()\u65f6\uff0c\u624d\u6784\u9020BookService\u5bf9\u8c61\n        BookService bookService = beanFactory.getBean("bookServiceId",BookService.class);\n        bookService.addBook();\n    }\n\n}\n\n')),(0,o.kt)("h1",{id:"4-quickstart"},"4. quickstart"),(0,o.kt)("p",null,"\u5f15\u5165\u4f9d\u8d56"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- **************spring start******************************* --\x3e\n      \x3c!-- https://mvnrepository.com/artifact/org.springframework/spring-core --\x3e\n      <dependency>\n          <groupId>org.springframework</groupId>\n          <artifactId>spring-core</artifactId>\n          <version>${springframework.version}</version>\n      </dependency>\n      \x3c!-- https://mvnrepository.com/artifact/org.springframework/spring-beans --\x3e\n      <dependency>\n          <groupId>org.springframework</groupId>\n          <artifactId>spring-beans</artifactId>\n          <version>${springframework.version}</version>\n      </dependency>\n      \x3c!-- https://mvnrepository.com/artifact/org.springframework/spring-context --\x3e\n      <dependency>\n          <groupId>org.springframework</groupId>\n          <artifactId>spring-context</artifactId>\n          <version>${springframework.version}</version>\n      </dependency>\n      \x3c!-- https://mvnrepository.com/artifact/org.springframework/spring-context-support --\x3e\n      <dependency>\n          <groupId>org.springframework</groupId>\n          <artifactId>spring-context-support</artifactId>\n          <version>${springframework.version}</version>\n      </dependency>\n      \x3c!-- https://mvnrepository.com/artifact/org.springframework/spring-web --\x3e\n        <dependency>\n            <groupId>org.springframework</groupId>\n            <artifactId>spring-web</artifactId>\n            <version>${springframework.version}</version>\n        </dependency>\n\n      \x3c!-- ****************spring end******************** --\x3e\n")),(0,o.kt)("p",null,"\u521b\u5efa applicationContext.xml (\u9ed8\u8ba4\u540d\u79f0)"),(0,o.kt)("p",null,"\u4ece Spring \u6587\u6863 copy \u914d\u7f6e\u6587\u4ef6\u7684\u7ea6\u675f"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\nhttp://www.springframework.org/schema/beans/spring-beans.xsd">\n\n</beans>\n\n')),(0,o.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!--\n    * id\u5c5e\u6027\u53ef\u4ee5\u81ea\u52a8\u63d0\u793a(\u4e00\u822c\u4f7f\u7528id\u5c5e\u6027), name\u5c5e\u6027\u5219\u6ca1\u6709\n    * id\u53ea\u80fd\u6709\u4e00\u4e2a\u503c, name\u53ef\u4ee5\u6709\u591a\u4e2a(\u9017\u53f7\u5206\u9694)\n    * \u6807\u8bc6bean\u7684\u4f5c\u7528\u57df  <bean id="" class="", scope=""></bean>\n     --\x3e\n    <bean id="userServiceId" class="com.xiaoyu.spring.learn.UserService"></bean>\n\n</beans>\n\n')),(0,o.kt)("p",null,"\u4ee3\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public class UserService {\n    public void addUser(){\n        System.out.println("a_hello addUser");\n    }\n}\npublic class TestHello {\n    @Test\n    public void demo01(){     //\u8fd9\u662f\u539f\u6765\u7684\u5199\u6cd5\n        UserService userService = new UserService();\n        userService.addUser();\n    }\n    @Test\n    public void demo02(){\n        //1 \u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\n        String xmlPath = "config/applicationContext.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        //2 \u4ece\u5bb9\u5668\u83b7\u5f97\u5bf9\u8c61\n        UserService userService = (UserService) applicationContext.getBean("userServiceId");\n    //\u6216\u8005\u8fd9\u6837\u5199\n     UserService userService = applicationContext.getBean("userServiceId", UserService.class);\n        userService.addUser();\n    }\n\n}\n\n')),(0,o.kt)("p",null,"\u770b\u4e00\u4e2a DI \u7684\u4f8b\u5b50"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!--beans.xml :--\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!--\n        \u4f9d\u8d56\u6ce8\u5165\uff1aspring\u63d0\u4f9b <property> \u7528\u4e8e\u914d\u7f6esetter\u65b9\u6cd5\u8fdb\u884c\u64cd\u4f5c\n            \u683c\u5f0f\uff1a<property name="" ref="">\n                name \u5f53\u524d\u64cd\u4f5c\u5bf9\u8c61\u5c5e\u6027\u540d\uff08\u5373\u901a\u8fc7setter\u65b9\u6cd5\u83b7\u5f97\uff09\n                ref \u9700\u8981\u8bbe\u7f6e\u5bf9\u8c61\u7684bean \u540d\u79f0\u5f15\u7528\uff08\u5373<bean>\u6807\u7b7e\u7684id\u503c\uff09\u3002\n    --\x3e\n    \x3c!-- spring \u521b\u5efadao --\x3e\n    <bean id="bookDaoId" class="com.xiaoyu.spring.learn.BookDaoImpl"></bean>\n\n    \x3c!-- spring \u521b\u5efaservice ,\n        * \u5355\u5b9e\u4f8b\u53ef\u4ee5\u901a\u8fc7lazy-init=\u201dtrue\u201d\uff0c\u5728getBean\u65f6\u8fdb\u884c\u5b9e\u4f8b\u5316\n        * \u5bf9\u4e8eprototype\uff0c\u5219\u662f\u5728getBean\u7684\u65f6\u5019\u88ab\u5b9e\u4f8b\u5316\u7684\u3002\n        * \u5728beans\u91cc\u9762default-lazy-init=\u201dtrue\u201d\u5bf9\u6240\u6709bean\u8fdb\u884c\u5ef6\u8fdf\u5904\u7406\n        * init-method\u3000\u5728bean\u88ab\u5b9e\u4f8b\u5316\u4e4b\u540e\u6267\u884c\u8d44\u6e90\u64cd\u4f5c\u7b49\u65b9\u6cd5\n        * destroy-method \u5728bean\u9500\u6bc1\u4e4b\u524d\u6267\u884c\u7684\u65b9\u6cd5(\u4ec0\u4e48\u65f6\u5019\u88ab\u9500\u6bc1\uff1f\u968f\u7740spring\u5bb9\u5668\u88ab\u5173\u95ed\u65f6\u88ab\u9500\u6bc1\u3002\u8c03\u7528spring\u5bb9\u5668\u7684close\u65b9\u6cd5\u6765\u6b63\u5e38\u5173\u95ed\u3002\u4ee5\u524d\u662f\u968f\u7740\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u5b8c\u800c\u5173\u95ed\u3002)\n        * InitializingBean\u63a5\u53e3\u3001Disposable\u63a5\u53e3\u5e95\u5c42\u4f7f\u7528\u7c7b\u578b\u5f3a\u8f6c.\u65b9\u6cd5\u540d()\u8fdb\u884c\u76f4\u63a5\u65b9\u6cd5\u8c03\u7528\uff0cinit-method\u3001destory-method\u5e95\u5c42\u4f7f\u7528\u53cd\u5c04\uff0c\u524d\u8005\u548cSpring\u8026\u5408\u7a0b\u5ea6\u66f4\u9ad8\u4f46\u6548\u7387\u9ad8\uff0c\u540e\u8005\u89e3\u9664\u4e86\u548cSpring\u4e4b\u95f4\u7684\u8026\u5408\u4f46\u662f\u6548\u7387\u4f4e\n    --\x3e\n    <bean id="bookServiceId" class="com.xiaoyu.spring.learn.BookServiceImpl" lazy-init="true" init-method="init" destroy-method="destory">\n        \x3c!-- \u6ce8\u5165\u5c5e\u6027\u503c, \u5fc5\u987b\u8981\u6709setter --\x3e\n        \x3c!-- <property> \u6ce8\u5165\uff08\u8bbe\u7f6e\uff09\u6570\u636e\n            * name \u4f7f\u7528\u5c5e\u6027\u540d\n            * value \u8bbe\u7f6e\u666e\u901a\u6570\u636e\n            * ref \u5f15\u7528\u7c7b\u578b\uff08\u53e6\u4e00\u4e2abean id\u503c\uff09\n    --\x3e\n        <property name="bookDao" ref="bookDaoId"></property>  \x3c!-- \u8868\u793aBookService\u91cc\u9762\u7684bookDao\u5c5e\u6027 --\x3e\n        <property name="name" value="123"/>\n        \x3c!-- \u4e0b\u9762\u662f\u53e6\u4e00\u79cd\u65b9\u5f0f\u6ce8\u5165 --\x3e\n         \x3c!--\n        <constructor-arg> \u914d\u7f6e\u6784\u9020\u65b9\u6cd5\u7684\u4e00\u4e2a\u53c2\u6570\n            * name :\u53c2\u6570\u7684\u540d\u79f0 \uff0c\u4e00\u822c\u4e0d\u4f7f\u7528\n                <constructor-arg name="username" value="jack"></constructor-arg>\n                <constructor-arg name="age" value="18"></constructor-arg>\n            * index : \u53c2\u6570\u7684\u7d22\u5f15\uff0c\u4ece0\u5f00\u59cb\n            * type : \u53c2\u6570\u7c7b\u578b\n            ## \u5f00\u53d1\u4e2d\u4e00\u822cindex\u548ctype\u7ed3\u5408\u4f7f\u7528\n            * value \u666e\u901a\u6570\u636e\n            * ref \u5f15\u7528\u6570\u636e\uff08\u53e6\u4e00\u4e2abean id\u503c\uff09\n        --\x3e\n        \x3c!-- \u5bf9\u5e94\u6784\u9020\u65b9\u6cd5\n        public PersonServiceBean(String name, IDaoBean personDao) {\n            this.name = name;\n            this.personDao = personDao;\n        } --\x3e\n        <constructor-arg index="0" value="\u6784\u9020\u6ce8\u5165\u7684name" />\n        <constructor-arg index="1" type="com.persia.IDaoBean" ref="personDao"/>\n\n\n        \x3c!-- \u96c6\u5408\u7684\u6ce8\u5165 --\x3e\n        \x3c!-- Set\u7684\u6ce8\u5165 --\x3e\n        <property name="sets">\n        <set>\n            <value>sets\uff1a\u7b2c\u4e00\u4e2a\u503c</value>\n            <value>sets\uff1a\u7b2c\u4e8c\u4e2a\u503c</value>\n            <value>sets\uff1a\u7b2c\u4e09\u4e2a\u503c</value>\n        </set>\n        </property>\n\n        \x3c!-- List\u7684\u6ce8\u5165 --\x3e\n\n        <property name="lists">\n        <list>\n            <value>lists\uff1a\u7b2c\u4e00\u4e2a\u503c</value>\n            <value>lists\uff1a\u7b2c\u4e8c\u4e2a\u503c</value>\n            <value>lists\uff1a\u7b2c\u4e09\u4e2a\u503c</value>\n        </list>\n        </property>\n\n        \x3c!-- Properties\u7684\u6ce8\u5165 --\x3e\n\n        <property name="properties">\n        <props>\n            <prop key="props-key1">\uff1a\u7b2c\u4e00\u4e2a\u503c</prop>\n            <prop key="props-key2">\uff1a\u7b2c\u4e8c\u4e2a\u503c</prop>\n            <prop key="props-key3">\uff1a\u7b2c\u4e09\u4e2a\u503c</prop>\n        </props>\n        </property>\n\n        \x3c!-- Map\u7684\u6ce8\u5165 --\x3e\n\n        <property name="maps">\n        <map>\n            <entry key="maps-key1" value="\uff1a\u7b2c\u4e00\u4e2a\u503c" />\n            <entry key="maps-key2" value="\uff1a\u7b2c\u4e8c\u4e2a\u503c" />\n            <entry key="maps-key3" value="\uff1a\u7b2c\u4e09\u4e2a\u503c" />\n        </map>\n        </property>\n\n    </bean>\n\n</beans>\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// BookDaoImpl & BookDao\npublic interface BookDao {\n        public void save();\n}\npublic class BookDaoImpl implements BookDao {\n        @Override\n        public void save() {\n                System.out.println("b_di  book save");\n        }\n}\n\n\n// BookService & BookServiceImpl\npublic interface BookService {\n        public void addBook();\n}\npublic class BookServiceImpl implements BookService {\n    public BookServiceImpl() {\n        System.out.println("\u4f60\u751f\u4e86");\n    }\n\n    //\u4e4b\u540e\u7f16\u7a0b\n    private BookDao bookDao;\n    public void setBookDao(BookDao bookDao) {\n        this.bookDao = bookDao;\n    }\n    @Override\n    public void addBook() {\n        bookDao.save();\n    }\n}\n\n\n// \u6d4b\u8bd5\uff1a\n@Test\npublic void demo01(){\n    //\u4f9d\u8d56\u6ce8\u5165\n    String xmlPath = "config/applicationContext.xml";\n    //\u52a0\u8f7d\u5b8c\u914d\u7f6e\u6587\u4ef6\u5c31\u6784\u9020\u4e86BookService\u5bf9\u8c61\n    ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n    BookService bookService = applicationContext.getBean("bookServiceId",BookService.class);\n    bookService.addBook();\n}\n\n')),(0,o.kt)("h1",{id:"5-\u914d\u7f6e\u7684\u65b9\u5f0f"},"5. \u914d\u7f6e\u7684\u65b9\u5f0f"),(0,o.kt)("h2",{id:"51-\u57fa\u4e8e-xml"},"5.1. \u57fa\u4e8e xml"),(0,o.kt)("h3",{id:"511-xml-\u4e2d\u7684\u914d\u7f6e\u9879"},"5.1.1. xml \u4e2d\u7684\u914d\u7f6e\u9879"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"id \u5c5e\u6027\u53ef\u4ee5\u81ea\u52a8\u63d0\u793a(\u4e00\u822c\u4f7f\u7528 id \u5c5e\u6027), name \u5c5e\u6027\u5219\u6ca1\u6709")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"id \u53ea\u80fd\u6709\u4e00\u4e2a\u503c, name \u53ef\u4ee5\u6709\u591a\u4e2a(\u9017\u53f7\u5206\u9694)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u6807\u8bc6 bean \u7684\u4f5c\u7528\u57df ",(0,o.kt)("inlineCode",{parentName:"p"},'<bean scope=""></bean>')),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"singleton - \u6574\u4e2a\u5bb9\u5668\u4e2d\uff0c\u5c06\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\uff0c \u5bf9\u4e8e\u90a3\u4e9b\u65e0\u4f1a\u8bdd\u72b6\u6001\u7684 Bean\uff08\u5982\u8f85\u52a9\u5de5\u5177\u7c7b\u3001DAO \u7ec4\u4ef6\u3001\u4e1a\u52a1\u903b\u8f91\u7ec4\u4ef6\u7b49\uff09\u662f\u6700\u7406\u60f3\u7684\u9009\u62e9\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"prototype - \u6bcf\u6b21\u901a\u8fc7\u5bb9\u5668\u7684 getBean \u65b9\u6cd5\u83b7\u53d6\u5b9a\u4e49\u7684 Bean \u65f6\uff0c\u90fd\u5c06\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684 Bean \u5b9e\u4f8b\uff0c \u9002\u7528\u4e8e\u90a3\u4e9b\u9700\u8981\u4fdd\u6301\u4f1a\u8bdd\u72b6\u6001\u7684 Bean \u5b9e\u4f8b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"request - \u5bf9\u4e8e\u6bcf\u6b21 HTTP request\uff0c\u5b9a\u4e49\u7684 Bean \u90fd\u5c06\u4ea7\u751f\u4e00\u4e2a\u65b0\u5b9e\u4f8b\uff1b \u53ea\u5728 web app \u4e2d\u6709\u6548")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"session - \u5bf9\u4e8e\u6bcf\u6b21 HTTP Session\uff0c\u5b9a\u4e49\u7684 Bean \u90fd\u5c06\u4ea7\u751f\u4e00\u4e2a\u65b0\u5b9e\u4f8b\u3002\u540c\u6837\u53ea\u53ea\u5728 web app \u4e2d\u6709\u6548")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"globalsession\uff1a\u5b58\u7591 //todo"))))),(0,o.kt)("h3",{id:"512-\u51e0\u79cd\u6ce8\u5165-\u5b9e\u4f8b\u5316\u65b9\u5f0f"},"5.1.2. \u51e0\u79cd\u6ce8\u5165-\u5b9e\u4f8b\u5316\u65b9\u5f0f"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/a909301740/article/details/78379720"},"https://blog.csdn.net/a909301740/article/details/78379720")),(0,o.kt)("h4",{id:"5121-\u901a\u8fc7\u6784\u9020\u51fd\u6570"},"5.1.2.1. \u901a\u8fc7\u6784\u9020\u51fd\u6570"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"public class UserService implements IUserService {\n\n    private IUserDao userDao;\n\n    public UserService(IUserDao userDao) {\n        this.userDao = userDao;\n    }\n\n    public void loginUser() {\n        userDao.loginUser();\n    }\n\n}\n\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u6ce8\u518cuserService\n    \u591a\u4e2a field \u6ce8\u5165 \u901a\u8fc7 name \u5c5e\u6027\u6307\u5b9a\n--\x3e\n<bean id="userService" class="com.lyu.spring.service.impl.UserService">\n    <constructor-arg ref="userDaoJdbc"></constructor-arg>\n</bean>\n\x3c!-- \u6ce8\u518cjdbc\u5b9e\u73b0\u7684dao --\x3e\n<bean id="userDaoJdbc" class="com.lyu.spring.dao.impl.UserDaoJdbc"></bean>\n\n')),(0,o.kt)("h5",{id:"51211-\u901a\u8fc7\u9759\u6001\u5de5\u5382\u65b9\u6cd5"},"5.1.2.1.1. \u901a\u8fc7\u9759\u6001\u5de5\u5382\u65b9\u6cd5"),(0,o.kt)("p",null,"\u5c5e\u4e8e\u6784\u9020\u51fd\u6570\u6ce8\u5165"),(0,o.kt)("p",null,"\u4f7f\u7528\u573a\u666f: \u4e0e\u5176\u4ed6\u6846\u67b6\u6574\u5408\u65f6\u7528"),(0,o.kt)("p",null,"\u7c7b\u4f3c\u53c2\u8003 ",(0,o.kt)("a",{parentName:"p",href:"#%E7%89%B9%E6%AE%8A%E7%9A%84bean-FactoryBean"},"\u7279\u6b8a\u7684 bean-FactoryBean")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// PersonService\uff1a\npublic class PersonService {\n    public void addPerson(){\n        System.out.println("Personservice  addPerson");\n    }\n\n}\n\n// \u9759\u6001\u5de5\u5382\uff1a\u914d\u7f6e\u5230 bean#class\npublic class MyBeanFactory {\n    // \u6240\u6709\u65b9\u6cd5\u90fd\u662f\u9759\u6001\u65b9\u6cd5: \u65b9\u6cd5\u540d\u914d\u7f6e\u5230 bean#factory-method\n    public static PersonService createPerson(){\n        return new PersonService();\n    }\n}\n\n// \u6d4b\u8bd5\uff1a\npublic class TestStatic {\n    @Test\n    public void demo01(){\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        PersonService personService = (PersonService) applicationContext.getBean("personServiceId");\n        personService.addPerson();\n    }\n}\n\n')),(0,o.kt)("p",null,"xml \u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\x3c!--  id\u8868\u793a\u9759\u6001\u5de5\u5382\u8981\u751f\u4ea7\u7684bean --\x3e\n\x3c!--  class\u8868\u793a\u9759\u6001\u5de5\u5382\u7c7b --\x3e\n\x3c!-- factory-method \u8868\u793a\u9759\u6001\u5de5\u5382\u751f\u4ea7\u672cbean\u7684\u9759\u6001\u65b9\u6cd5 --\x3e\n\n    <bean id="personServiceId"\n        class="com.xiaoyu.spring.learn.MyBeanFactory"\n        factory-method="createPerson">\n    </bean>\n\n    \x3c!--test: static factory construct \u5de5\u5382\u65b9\u6cd5\u5e26\u6709\u53c2\u6570--\x3e\n    <bean id="bean3" class="spring.BeanFactory" factory-method="createBean3">\n        \x3c!--factory method args\uff0c bean\u53ef\u4ee5\u901a\u8fc7 ref \u6ce8\u5165\u5230\u65b9\u6cd5\u53c2\u6570\u4e2d--\x3e\n        <constructor-arg name="bean4" ref="bean4"></constructor-arg>\n        <constructor-arg name="str" value="haha" />\n    </bean>\n\n</beans>\n\n')),(0,o.kt)("h5",{id:"51212-\u901a\u8fc7\u5b9e\u4f8b\u5de5\u5382\u65b9\u6cd5"},"5.1.2.1.2. \u901a\u8fc7\u5b9e\u4f8b\u5de5\u5382\u65b9\u6cd5"),(0,o.kt)("p",null,"\u5c5e\u4e8e\u6784\u9020\u51fd\u6570\u6ce8\u5165"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// studentService\uff1a\npublic class StudentService {\n    public void addStudent(){\n        System.out.println("StudentService  addStudent");\n    }\n}\n// \u5b9e\u4f8b\u5de5\u5382\uff1a\npublic class MyBeanFactory2 {\n    /**\n     * \u975e\u9759\u6001\u65b9\u6cd5\n     * @return\n     */\n    public StudentService createStudent(){\n        return new StudentService();\n    }\n}\n\n// \u6d4b\u8bd5\uff1a\npublic class TestFactory {\n    @Test\n    public void demo01(){\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n//\u76f4\u63a5\u83b7\u5f97studentService\u5b9e\u4f8b\uff0c\u5b9e\u4f8b\u5de5\u5382\u7684\u5b9e\u4f8b\u5bf9\u8c61spring\u81ea\u52a8\u521b\u5efa\n        StudentService studentService = (StudentService) applicationContext.getBean("studentServiceId");\n        studentService.addStudent();\n    }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!-- \u914d\u7f6e\u5de5\u5382\u5b9e\u4f8b --\x3e\n    <bean id="myFactoryId" class="com.xiaoyu.spring.learn.MyBeanFactory2"></bean>\n\n    \x3c!-- \u914d\u7f6e studentService\u5b9e\u4f8b --\x3e\n    <bean id="studentServiceId" factory-bean="myFactoryId"  factory-method="createStudent" ></bean>\n\n    <bean id="instanceFac" class="spring.InstanceFactory" />\n    <bean id="bean3" factory-bean="instanceFac" factory-method="createBean3" >\n        <constructor-arg name="bean4" ref="bean4" />\n        <constructor-arg name="str" value="hoho" />\n    </bean>\n</beans>\n\n')),(0,o.kt)("h4",{id:"5122-\u901a\u8fc7-setter-\u6ce8\u5165"},"5.1.2.2. \u901a\u8fc7 setter \u6ce8\u5165"),(0,o.kt)("p",null,"(setter injection)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u6ce8\u518cuserService --\x3e\n<bean id="userService" class="com.lyu.spring.service.impl.UserService">\n \x3c!-- \u5199\u6cd5\u4e00 --\x3e\n \x3c!-- <property name="UserDao" ref="userDaoMyBatis"></property> --\x3e\n \x3c!-- \u5199\u6cd5\u4e8c --\x3e\n <property name="userDao" ref="userDaoMyBatis"></property>\n</bean>\n\n\x3c!-- \u6ce8\u518cmybatis\u5b9e\u73b0\u7684dao --\x3e\n<bean id="userDaoMyBatis" class="com.lyu.spring.dao.impl.UserDaoMyBatis"></bean>\n\n')),(0,o.kt)("p",null,'\u4e0a\u9762\u8fd9\u4e24\u79cd\u5199\u6cd5\u90fd\u53ef\u4ee5,spring \u4f1a\u5c06 name \u503c\u7684\u6bcf\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u8f6c\u6362\u6210\u5927\u5199\uff0c\u7136\u540e\u518d\u5728\u524d\u9762\u62fc\u63a5\u4e0a"set"\u6784\u6210\u4e00\u4e2a\u65b9\u6cd5\u540d,\u7136\u540e\u53bb\u5bf9\u5e94\u7684\u7c7b\u4e2d\u67e5\u627e\u8be5\u65b9\u6cd5,',(0,o.kt)("inlineCode",{parentName:"p"},"\u901a\u8fc7\u53cd\u5c04\u8c03\u7528"),",\u5b9e\u73b0\u6ce8\u5165"),(0,o.kt)("p",null,"\u5982\u679c\u901a\u8fc7 set \u65b9\u6cd5\u6ce8\u5165\u5c5e\u6027\uff0c\u90a3\u4e48 spring \u4f1a\u901a\u8fc7\u9ed8\u8ba4\u7684\u7a7a\u53c2\u6784\u9020\u65b9\u6cd5\u6765\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u6240\u4ee5\u5982\u679c\u5728\u7c7b\u4e2d\u5199\u4e86\u4e00\u4e2a\u5e26\u6709\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"\u4e00\u5b9a\u8981\u628a\u7a7a\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u5199\u4e0a"),"\uff0c\u5426\u5219 spring \u6ca1\u6709\u529e\u6cd5\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u5bfc\u81f4\u62a5\u9519"),(0,o.kt)("p",null,"xml \u914d\u7f6e\u65b9\u5f0f\u4e4b\u5916, \u8fd8\u63d0\u4f9b\u6ce8\u89e3\u7684\u65b9\u5f0f, \u4e5f\u662f\u9700\u8981 setter \u65b9\u6cd5;"),(0,o.kt)("h4",{id:"5123-\u901a\u8fc7-methodinvokingfactorybean-\u6ce8\u5165\u65b9\u6cd5\u7684\u8fd4\u56de\u503c"},"5.1.2.3. \u901a\u8fc7 MethodInvokingFactoryBean \u6ce8\u5165\u65b9\u6cd5\u7684\u8fd4\u56de\u503c"),(0,o.kt)("p",null,"MethodInvokingFactoryBean \u53ef\u4ee5\u6ce8\u518c\u67d0\u4e2a\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u5230 spring \u4e2d, \u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u662f\u5b9e\u4f8b\u65b9\u6cd5, \u4e5f\u53ef\u4ee5\u662f\u9759\u6001\u65b9\u6cd5;"),(0,o.kt)("p",null,"\u5f53\u7136\u4e5f\u53ef\u4ee5\u5c31\u4f7f\u7528\u666e\u901a\u7684\u9759\u6001\u5de5\u5382\u6ce8\u5165 or \u5b9e\u4f8b\u5de5\u5382\u6ce8\u5165\uff0c \u4f46\u662f\u4e0d\u591f\u7075\u6d3b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"import org.springframework.context.MessageSource;\n\nimport plm.common.exceptions.CheckException;\n\n// \u7c7b\u65e0\u9700\u6807\u6ce8\u4e3a component\npublic class CheckUtil {\n\n  private static MessageSource resources;\n\n    // \u6ce8\u5165\u5230\u8fd9\u4e2a\u65b9\u6cd5\u7684\u53c2\u6570\u4e2d\u4e86\n    // \u6ca1\u6709\u4f7f\u7528\u8fd4\u56de\u503c\n  public static void setResources(MessageSource resources) {\n    CheckUtil.resources = resources;\n  }\n\n  public static void check(boolean condition, String msgKey, Object... args) {\n    if (!condition) {\n      fail(msgKey, args);\n    }\n  }\n\n  public static void notEmpty(String str, String msgKey, Object... args) {\n    if (str == null || str.isEmpty()) {\n      fail(msgKey, args);\n    }\n  }\n\n  public static void notNull(Object obj, String msgKey, Object... args) {\n    if (obj == null) {\n      fail(msgKey, args);\n    }\n  }\n\n  private static void fail(String msgKey, Object... args) {\n    throw new CheckException(resources.getMessage(msgKey, args, UserUtil.getLocale()));\n  }\n}\n\n")),(0,o.kt)("p",null,"xml \u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<bean\n  class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">\n  <property name="staticMethod" value="plm.common.utils.CheckUtil.setResources" />\n  \x3c!-- \u8fd9\u91cc\u914d\u7f6e\u65b9\u6cd5\u53c2\u6570 --\x3e\n  <property name="arguments" ref="messageSource">\n  </property>\n</bean>\n\n\x3c!-- \u56fd\u9645\u5316 --\x3e\n<bean id="messageSource"\n  class="org.springframework.context.support.ResourceBundleMessageSource">\n  <property name="basenames">\n    <list>\n      <value>format</value>\n      <value>exceptions</value>\n      <value>windows</value>\n    </list>\n  </property>\n</bean>\n\n')),(0,o.kt)("p",null,"\u6216\u8005\u4e0d\u901a\u8fc7 xml \u914d\u7f6e\uff0c \u4f7f\u7528\u4ee3\u7801\u914d\u7f6e\uff1a"),(0,o.kt)("p",null,"\u5728 Configuration class \u4e2d"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'/**\n    * inject messageSource into I18nUtils\n    */\n@Bean\npublic MethodInvokingFactoryBean methodInvokingFactoryBean() {\n    MethodInvokingFactoryBean methodInvokingFactoryBean = new MethodInvokingFactoryBean();\n    methodInvokingFactoryBean.setStaticMethod("io.github.xiaoyureed.core.util.I18nUtils.setMessageSource");\n                                // \u8fd9\u91cc\u8bbe\u7f6e\u4f7f\u7528\u54ea\u4e2a\u65b9\u6cd5\u6ce8\u5165\n    methodInvokingFactoryBean.setArguments(this.messageSource());// \u5728\u8fd9\u91cc\u8bbe\u7f6e\u6ce8\u5165\u7684\u53c2\u6570\n    return methodInvokingFactoryBean;\n}\n\n')),(0,o.kt)("h4",{id:"5124-autowired-\u6ce8\u5165"},"5.1.2.4. @Autowired \u6ce8\u5165"),(0,o.kt)("p",null,"\u5e95\u5c42\u662f\u4f7f\u7528\u4e86\u53cd\u5c04, \u4e0d\u4f9d\u8d56\u6784\u9020\u51fd\u6570, \u4e0d\u4f9d\u8d56 setter"),(0,o.kt)("p",null,"@Autowired \u6709\u4e2a\u5c5e\u6027\u4e3a required\uff0c\u53ef\u4ee5\u914d\u7f6e\u4e3a false (\u9ed8\u8ba4 true)\uff0c\u5982\u679c\u914d\u7f6e\u4e3a false \u4e4b\u540e\uff0c\u5f53\u6ca1\u6709\u627e\u5230\u76f8\u5e94 bean \u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u4e0d\u4f1a\u629b\u9519"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"@Resource\u9ed8\u8ba4\u662f\u6309\u7167\u540d\u79f0\u6765\u88c5\u914d\u6ce8\u5165\u7684\uff0c\u53ea\u6709\u5f53\u627e\u4e0d\u5230\u4e0e\u540d\u79f0\u5339\u914d\u7684bean\u624d\u4f1a\u6309\u7167\u7c7b\u578b\u6765\u88c5\u914d\u6ce8\u5165\uff1b\n\n@Autowired\u9ed8\u8ba4\u662f\u6309\u7167\u7c7b\u578b\u88c5\u914d\u6ce8\u5165\u7684, \u82e5\u540c\u7c7b\u578bbean\u6709\u591a\u4e2a\u5219\u6309\u7167\u540d\u79f0\u6ce8\u5165\uff0c\u5982\u679c\u60f3\u76f4\u63a5\u6309\u7167\u540d\u79f0\u6765\u8f6c\u914d\u6ce8\u5165\uff0c\u5219\u9700\u8981\u7ed3\u5408@Qualifier\u4e00\u8d77\u4f7f\u7528\uff1b\n\n@Resource\u6ce8\u89e3\u662f\u53c8J2EE\u63d0\u4f9b\uff0c\u800c@Autowired\u662f\u7531Spring\u63d0\u4f9b\uff0c\u6545\u51cf\u5c11\u7cfb\u7edf\u5bf9spring\u7684\u4f9d\u8d56\u5efa\u8bae\u4f7f\u7528@Resource\u7684\u65b9\u5f0f\uff1b\n\n@Resource\u548c@Autowired\u90fd\u53ef\u4ee5\u4e66\u5199\u6807\u6ce8\u5728\u5b57\u6bb5\u6216\u8005\u8be5\u5b57\u6bb5\u7684setter\u65b9\u6cd5\u4e4b\u4e0a\u3002\n\n@Inject\u662fJSR330\u89c4\u8303\u5b9e\u73b0\u7684, \u6839\u636e\u7c7b\u578b\u8fdb\u884c\u81ea\u52a8\u88c5\u914d\u7684\uff0c\u5982\u679c\u9700\u8981\u6309\u540d\u79f0\u8fdb\u884c\u88c5\u914d\uff0c\u5219\u9700\u8981\u914d\u5408@Named\n")),(0,o.kt)("h3",{id:"513-springel-\u8868\u8fbe\u5f0f\u6ce8\u5165\u8868\u8fbe\u5f0f"},"5.1.3. springEL \u8868\u8fbe\u5f0f,\u6ce8\u5165\u8868\u8fbe\u5f0f"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// \u5b9e\u4f53\u7c7bPerson\uff1a\npublic class Person {\n    private String name = "jack";\n    private Double pi; //java.lang.Math\u7c7b\u4e2d\u7684\u9759\u6001\u5e38\u91cf\n    private Address homeAddress;\n\n//    setters&getters..\n\n    @Override\n    public String toString() {\n        return "Person [name=" + name + ", pi=" + pi + ", homeAddress="\n                + homeAddress + "]";\n    }\n\n}\n// Person\u4e2d\u7684Address\u7c7b\uff1a\npublic class Address {\n    private String addr;\n    private String tel;\n\n//    getters&setters\n\n    @Override\n    public String toString() {\n        return "Address [addr=" + addr + ", tel=" + tel + "]";\n    }\n}\n\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!-- \u8868\u8fbe\u5f0f\n        * #{\u6570\u5b57} \u3001#{\'\u5b57\u7b26\u4e32\'} : \u5e38\u91cf\n        * #{bean\u7684id\u503c} : \u83b7\u5f97\u5f15\u7528\n        * #{\u5bf9\u8c61.\u5c5e\u6027}  \uff1a\u83b7\u5f97\u5c5e\u6027\u503c\n        * #{\u5bf9\u8c61.\u65b9\u6cd5()}  \uff1a \u6267\u884c\u65b9\u6cd5\n        * #{\u5bf9\u8c61.\u65b9\u6cd5()?.\u65b9\u6cd5()} : \u6267\u884c\u65b9\u6cd5, \u907f\u514dnull\u5f02\u5e38\n        * #{T{\u7c7b}.\u65b9\u6cd5() | \u5c5e\u6027} \uff1a\u9759\u6001\u8d44\u6e90\n    --\x3e\n    <bean id="personId" class="com.xiaoyu.spring.learn.Person">\n        <property name="name" value="#{personId.name.toUpperCase()}"></property>\n        <property name="pi" value="#{T(java.lang.Math).PI}"></property>\n        <property name="homeAddress" value="#{addressId}"></property>\n    </bean>\n\n    <bean id="addressId" class="com.xiaoyu.spring.learn.Address"></bean>\n</beans>\n\n')),(0,o.kt)("h3",{id:"514-\u96c6\u5408\u7684\u6ce8\u5165"},"5.1.4. \u96c6\u5408\u7684\u6ce8\u5165"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// \u5b9e\u4f53\u7c7b\uff1a\npublic class CollBean {\n    private List<String> dataList;\n    private String[] dataArray;\n    private Set<String> dataSet;\n    private Map<String, String> dataMap;\n    private Properties dataProps;\n\n   getters&setters\n\n    @Override\n    public String toString() {\n        return "CollBean [\\ndataList=" + dataList + ", \\ndataArray="\n                + Arrays.toString(dataArray) + ", \\ndataSet=" + dataSet\n                + ", \\ndataMap=" + dataMap + ", \\ndataProps=" + dataProps + "\\n]";\n    }\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestColl {\n    @Test\n    public void demo01() throws Exception{\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        CollBean collBean = (CollBean) applicationContext.getBean("collBeanId");\n        System.out.println(collBean);\n    }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!--\n<property name="">\n* \u5982\u679c\u8981\u6ce8\u5165\u6570\u636e\u8fdb\u96c6\u5408\uff0c\u4e14\u8be5\u96c6\u5408\u53ea\u6709\u4e00\u4e2a\u503c\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528<property value="">\u6807\u7b7e\u7684value\u5c5e\u6027\u8d4b\u503c\n* <property> \u63d0\u4f9b\u5b50\u6807\u7b7e\n    <value> \u5b50\u6807\u7b7e \u7b49\u6548 value\u5c5e\u6027 <property value="">\n    <ref> \u5b50\u6807\u7b7e \u7b49\u6548ref\u5c5e\u6027\n    <list>\u5b50\u6807\u7b7e list\u96c6\u5408\n    <array>\n    <set>\n    <map> map\u96c6\u5408\n        \u65b9\u5f0f1\uff1a\n        <entry key="ds" value="\u5c4c\u4e1d"></entry>\n        \u65b9\u5f0f2\uff1a\n        <entry>\n            <key><value>dzd</value></key>\n            <value>\u5c4c\u4e2d\u5c4c</value>\n        </entry>\n    <props> Properties\u5bf9\u8c61\n        <prop key="\u952e">\u503c</prop>\n    --\x3e\n    <bean id="collBeanId" class="com.xiaoyu.spring.learn.CollBean">\n        <property name="dataList">\n            <list>\n                <value>a</value>\n                <value>b</value>\n                <value>c</value>\n            </list>\n        </property>\n        <property name="dataArray">\n            <array>\n                <value>a</value>\n                <value>b</value>\n                <value>c</value>\n            </array>\n        </property>\n        <property name="dataSet">\n            <set>\n                <value>\u5b32</value>\n                <value>\u5ad0</value>\n                <value>\u630a</value>\n                <value>\u9f98</value>\n            </set>\n        </property>\n        <property name="dataMap">\n            <map>\n                <entry key="ds" value="efe"></entry>\n                <entry>\n                    <key><value>dzd</value></key>\n                    <value>dfd</value>\n                </entry>\n            </map>\n        </property>\n        <property name="dataProps">\n            <props>\n                <prop key="DG1">dg</prop>\n                <prop key="DG2">dg</prop>\n                <prop key="DG3">dg</prop>\n            </props>\n        </property>\n    </bean>\n\n</beans>\n\n')),(0,o.kt)("h2",{id:"52-\u57fa\u4e8e\u6ce8\u89e3"},"5.2. \u57fa\u4e8e\u6ce8\u89e3"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u6dfb\u52a0\u7ea6\u675f: \u5373 context schema,\u5728 xsd-config.xml \u4e2d\u627e")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5f00\u542f\u6ce8\u89e3\u7c7b\u626b\u63cf",(0,o.kt)("inlineCode",{parentName:"p"},'<context:component-scan base-package="xxxxpackage"></context:component-scan>')),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u529f\u80fd\u662f\u5c06@component \u4e4b\u7c7b\u7684\u6ce8\u89e3\u6807\u6ce8\u7684 bean \u6ce8\u518c\u5230 spring \u4e2d")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"annotation-config \u5904\u7406@autowired \u4e4b\u7c7b\u7684\u6ce8\u89e3\uff08\u5171\u6709\u56db\u7c7b\uff09 \u524d\u63d0\u662f\u6ce8\u89e3\u4f5c\u7528\u7684\u7c7b\u5df2\u7ecf\u88ab\u6ce8\u518c\u5230 spring \u5bb9\u5668\u91cc\uff08bean id=\u201c\u201d class=\u201c\u201d\uff09 ;component-scan \u9664\u4e86\u5305\u542b annotation-config \u7684\u4f5c\u7528\u5916\uff0c\u8fd8\u80fd\u81ea\u52a8\u626b\u63cf\u548c\u6ce8\u518c base-package \u4e0b\u6709@component \u4e4b\u7c7b\u6ce8\u89e3\u7684\u7c7b\uff0c\u5c06\u5176\u4f5c\u4e3a bean \u6ce8\u518c\u5230 spring \u5bb9\u5668\u91cc; \u6240\u4ee5\u914d\u7f6e\u6587\u4ef6\u5982\u679c\u6709 component-scan \u5c31\u4e0d\u9700\u8981 annotation-config \u4e86\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u4e5f\u53ef\u4ee5 scan \u6392\u9664:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<context:component-scan base-package="com.baobaotao">\n    <context:include-filter type="regex"\n        expression="com\\.baobaotao\\.service\\..*"/>\n    <context:exclude-filter type="aspectj"\n        expression="com.baobaotao.util..*"/>\n</context:component-scan>\n\n')))))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5206\u5c42 web \u5f00\u53d1\u4e2d\u7684\u6ce8\u89e3: @Controller--web \u5c42, @Service--service \u5c42, @Repository--dao \u5c42, @component--\u7b3c\u7edf\u7684")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u4f9d\u8d56\u6ce8\u5165\u76f8\u5173\u6ce8\u89e3:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u6309\u7167\u7c7b\u578b\u6ce8\u5165: @Autowire, \u4f7f\u7528\u5728\u6210\u5458\u5c5e\u6027 or setter \u65b9\u6cd5\u4e0a")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},'\u6309\u7167\u540d\u79f0\u6ce8\u5165 : @Qualified \u548c@Autowired \u7ed3\u5408\u4f7f\u7528, @Qualified("userDaoId") \u3010\u524d\u63d0\u662f UserDao \u914d\u7f6e\u4e86@Repository("userDaoId") \u3011')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u6309\u7167\u540d\u79f0\u6ce8\u5165\uff08\u7b80\u5316\uff09\uff1a@Resource\uff08name=\u201c\u540d\u79f0\u201d\uff09")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u666e\u901a\u6210\u5458\u5c5e\u6027\u6ce8\u5165\uff1a@Value\uff08\u201c\u503c\u201d\uff09 \u76f4\u63a5\u7ed9\u6210\u5458\u5c5e\u6027\u6ce8\u5165\u666e\u901a\u503c"))))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u521d\u59cb\u5316\uff0c\u9500\u6bc1\uff0c\u4f5c\u7528\u57df\u6ce8\u89e3"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u521d\u59cb\u5316\u548c\u9500\u6bc1: @PostConstruct, @PreDestroy")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},'\u4f5c\u7528\u57df: @Scope("singleton"), @Scope("prototype")'))))),(0,o.kt)("p",null,"\u5206\u5c42\u5f00\u53d1:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// UserDao\uff1a\n@Repository("userDaoId")\npublic class UserDao {\n\n    @Value("jack")  //\u76f4\u63a5\u8bbe\u7f6e\u503c\n    private String username ;\n    public void save() {\n        System.out.println("web dao user --\x3e" + username);\n    }\n\n}\n// UserService\uff1a\n@Service\npublic class UserService {\n    //\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u914d\u7f6e\u3010\u6210\u5458\u5c5e\u6027\u4e0a\u914d\u7f6e@Autowired\u3011\n    private UserDao userDao;\n    //\u65b9\u5f0f1\n    @Autowired//---\u3010\u6839\u636e\u7c7b\u578b\u5339\u914d\uff0c\u53ef\u5355\u72ec\u4f7f\u7528\u3011\uff1a\u5982\u679c\u662f\u914d\u7f6e@Autowired\u3010\u540e\u9762\u4e0d\u7528\u8ddf\u503c\u3011\uff0c\u5219UserDao\u7c7b\u53ea\u9700\u8981\u914d\u7f6e@Repository\u3010\u4e0d\u7528\u8ddf\u503c\u3011\n    @Qualifier("userDaoId")//---\u3010\u6839\u636e\u540d\u5b57\u5339\u914d\uff0c\u5fc5\u987b\u548c@Autowired\u4e00\u8d77\u4f7f\u7528\u3011\uff1aUserDao\u7c7b\u914d\u7f6e\u4e86@Repository("userDaoId")\uff0c\u5219\u8981\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\n    //\u65b9\u5f0f2\uff1a\n    @Resource(name="userDaoId")            //--\u4e00\u4e2a\u9876\u4fe9\u3010\u4e00\u4e2a@Resource(name="userDaoId")\u53ef\u9876@Autowired&&@Qualifier("userDaoId")\u3011\n    public void setUserDao(UserDao userDao) {\n        this.userDao = userDao;\n    }\n\n    public void saveUser() {\n        System.out.println("web user service");\n        userDao.save();\n    }\n\n}\n// UserAction\uff1a\n@Controller("userActionId")\npublic class UserAction {\n    @Autowired  //\u76f8\u5f53\u4e8e <property  name="" ref="xxx">\n    private UserService userService;\n    //\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u914d\u7f6e@Autowired \uff0c\u548c\u5728\u6210\u5458\u5c5e\u6027\u4e0a\u914d\u7f6e\u6548\u679c\u4e00\u6837\n    public void setUserService(UserService userService) {\n        this.userService = userService;\n    }\n\n    public void addUser() {\n        System.out.println("action add user");\n        userService.saveUser();\n    }\n\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestAnnoWeb {\n    @Test\n    public void demo01() throws Exception{\n        String xmlPath = "com/itheima/h_annotation/b_web/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        UserAction userAction = (UserAction) applicationContext.getBean("userActionId");\n        userAction.addUser();\n    }\n}\n\n')),(0,o.kt)("p",null,"\u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\u914d\u7f6e\uff1a\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/context\n                           http://www.springframework.org/schema/context/spring-context.xsd">\n\n    \x3c!-- \u6ce8\u89e3\u7c7b\u626b\u63cf\uff1a\u901a\u77e5spring\uff0c\u54ea\u4e9b\u7c7b\u6dfb\u52a0\u6ce8\u89e3,\u5c5e\u4e8e\u63a7\u5236\u53cd\u8f6c --\x3e\n    <context:component-scan base-package="com.itheima.h_annotation.b_web"></context:component-scan>\n</beans>\n\n')),(0,o.kt)("p",null,"\u521d\u59cb\u5316, \u9500\u6bc1, \u4f5c\u7528\u57df:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// CategoryService\uff1a\n@Component("categoryServiceId")\n@Scope("prototype")                  //-------------\u4f5c\u7528\u57df\u6ce8\u89e3\npublic class CategoryService {\n\n    public void addCategory(){\n        System.out.println("c_other addCategory");\n    }\n    @PostConstruct //--------\u521d\u59cb\u5316\u6ce8\u89e3\n    public void myInit(){\n        System.out.println("anno \u521d\u59cb\u5316");\n    }\n    @PreDestroy //------------\u9500\u6bc1\u6ce8\u89e3\n    public void myDestroy(){\n        System.out.println("anno \u9500\u6bc1");\n    }\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestAnnoHello {\n    @Test\n    public void demo01() throws Exception{\n        String xmlPath = "config/beans.xml";\n        ClassPathXmlApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        CategoryService categoryService1 = (CategoryService) applicationContext.getBean("categoryServiceId");\n        categoryService1.addCategory();\n        CategoryService categoryService2 = (CategoryService) applicationContext.getBean("categoryServiceId");\n        categoryService2.addCategory();\n        System.out.println(categoryService1);\n        System.out.println(categoryService2);//\u7ed9CategoryService\u7c7b\u52a0\u4e86\u6ce8\u89e3@Scope("prototype")\uff1b\u53d8\u6210\u4e86\u591a\u4f8b\uff1b\u6253\u5370\u7ed3\u679c\u662f\u4e24\u8005\u5730\u5740\u4e0d\u540c\n        applicationContext.close();  //\u9700\u8981\u624b\u52a8\u5173\u95edapplicationContext\uff0c\u9500\u6bc1\u6ce8\u89e3\u624d\u4f1a\u751f\u6548\n    }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/context\n                           http://www.springframework.org/schema/context/spring-context.xsd">\n    \x3c!-- \u6ce8\u89e3\u7c7b\u626b\u63cf\uff1a\u901a\u77e5spring\uff0c\u54ea\u4e9b\u7c7b\u6dfb\u52a0\u6ce8\u89e3 --\x3e\n    <context:component-scan base-package="com.xiaoyu.spring.learn"></context:component-scan>\n</beans>\n\n')),(0,o.kt)("h2",{id:"53-xml-\u548c\u6ce8\u89e3\u6df7\u7528"},"5.3. xml \u548c\u6ce8\u89e3\u6df7\u7528"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"xml \u8d1f\u8d23\u914d\u7f6e bean(\u6240\u4ee5\u53ef\u4ee5\u53bb\u6389",(0,o.kt)("inlineCode",{parentName:"li"},"context:component-scan"),"\u914d\u7f6e), \u6ce8\u89e3\u8d1f\u8d23\u914d\u7f6e\u6ce8\u5165(\u6240\u4ee5\u5f00\u542f",(0,o.kt)("inlineCode",{parentName:"li"},"<context:annotation-config/>"),")")),(0,o.kt)("p",null,"\u89c1 ",(0,o.kt)("a",{parentName:"p",href:"#%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3"},"\u57fa\u4e8e\u6ce8\u89e3")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// UserDao:\npublic class UserDao {\n    @Value("jack")\n    private String username ;\n    public void save() {\n        System.out.println("web dao user --\x3e" + username);\n    }\n}\n// UserService:\npublic class UserService {\n    private UserDao userDao;\n    //\u65b9\u5f0f1\uff1a\uff08\u638c\u63e1\uff09\u503c\u4e3abean id\u503c\n    @Autowired\n    @Qualifier("userDaoId")\n    //\u65b9\u5f0f2\uff1a\n//  @Resource(name="userDaoId")\n    public void setUserDao(UserDao userDao) {\n        this.userDao = userDao;\n    }\n    public void saveUser() {\n        System.out.println("web user service");\n        userDao.save();\n    }\n}\n// UserAction:\npublic class UserAction {\n    @Autowired  //\u53d6\u4ee3 <property  name="" ref="\u6309\u7167\u7c7b\u578b\u914d\u7f6e">\n    private UserService userService;\n    public void setUserService(UserService userService) {\n        this.userService = userService;\n    }\n    public void addUser() {\n        System.out.println("action add user");\n        userService.saveUser();\n    }\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestAnnoWeb {\n    @Test\n    public void demo01() throws Exception{\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        UserAction userAction = (UserAction) applicationContext.getBean("userActionId");\n        userAction.addUser();\n    }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/context\n                           http://www.springframework.org/schema/context/spring-context.xsd">\n    \x3c!--\n        \u5df2\u7ecf\u914d\u7f6ebean\uff0c\u4e0d\u9700\u8981\u626b\u63cfpackage\u4e86\uff0c\n    <context:component-scan base-package="com.itheima.h_annotation.b_web"></context:component-scan>\n    --\x3e\n    \x3c!-- \u3010xml&\u6ce8\u89e3\u6df7\u7528\u65f6\u8981\u7279\u522b\u914d\u7f6e\u3011\uff1a\u914d\u7f6e\u4f7f\u5f97\u6ce8\u89e3\u5f0f\u6ce8\u5165\u53ef\u4ee5\u4f7f\u7528 --\x3e\n    <context:annotation-config></context:annotation-config>\n    \x3c!-- dao --\x3e\n    <bean id="userDaoId" class="com.xiaoyu.spring.learn.UserDao"></bean>\n    \x3c!-- service --\x3e\n    <bean id="userServiceId" class="com.xiaoyu.spring.learn.UserService"></bean>\n    \x3c!-- action --\x3e\n    <bean id="userActionId" class="com.xiaoyu.spring.learn.UserAction" scope="prototype"></bean>\n</beans>\n\n')),(0,o.kt)("h1",{id:"6-junit-\u6574\u5408"},"6. JUnit \u6574\u5408"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.ibm.com/developerworks/cn/java/j-lo-springunitest/index.html"},"https://www.ibm.com/developerworks/cn/java/j-lo-springunitest/index.html")),(0,o.kt)("p",null,"\u5f15\u5165\u4f9d\u8d56: ",(0,o.kt)("a",{parentName:"p",href:"http://mvnrepository.com/artifact/org.springframework/spring-test"},"http://mvnrepository.com/artifact/org.springframework/spring-test")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// UserService\uff1a\npublic class UserService {\n    public void addUser(){\n        System.out.println("a_hello addUser");\n    }\n}\n// \u6d4b\u8bd5\uff1a\n@RunWith(SpringJUnit4ClassRunner.class)  //junit spring \u6574\u5408\n@ContextConfiguration(locations="classpath:config/beans.xml")  //\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6 \u201cclasspath:\u201d\u8868\u793a\u5728/src\u76ee\u5f55\u4e0b\uff08\u4e5f\u5c31\u662f\u5728WEB-INF/classes\u4e0b\uff09\n@Transactional//insert \u4e4b\u540e\u4e0d\u5fc5\u6e05\u7406\u6570\u636e\u5e93, \u4f1a\u81ea\u52a8 rollback\npublic class TestJunit {\n    @Autowired  //\u6574\u5408junit \u81ea\u52a8\u6ce8\u5165(\u4ee5\u7c7b\u578b\u65b9\u5f0f\u6ce8\u5165)\uff0c\u201c\u6ce8\u5165\u201d\u4e0d\u9700\u8981\u518d\u5728xml\u914d\u7f6e\u3010\u3011\n    private UserService userService;\n    @Test\n    public void demo02(){\n        //1 \u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\n//      String xmlPath = "com/itheima/i_test/beans.xml";\n//      ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n//\n//      //2 \u4ece\u5bb9\u5668\u83b7\u5f97\u5bf9\u8c61\n//      UserService userService = (UserService) applicationContext.getBean("userServiceId");\n\n        userService.addUser();//\u73b0\u5728\u7b80\u5355\u4e00\u6b65\u641e\u5b9a\n    }\n}\n\n')),(0,o.kt)("p",null,"\u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\x3c!--\n    \u8fd9\u91cc\u662f\u914d\u7f6e\u7684UserService\u8fd9\u4e2abean\uff0c\u4e0d\u662f\u914d\u7f6e\u7684\u5c5e\u6027\u6ce8\u5165\n--\x3e\n    <bean id="userServiceId" class="com.xiaoyu.spring.learn.UserService"></bean>\n\n</beans>\n\n')),(0,o.kt)("h1",{id:"7-ioc"},"7. IoC"),(0,o.kt)("p",null,"Spring \u4e2d\u7684 IoC \u7684\u5b9e\u73b0\u539f\u7406\u5c31\u662f\u5de5\u5382\u6a21\u5f0f\u52a0\u53cd\u5c04\u673a\u5236\u3002"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.zhihu.com/question/23277575/answer/169698662"},"ioc \u6709\u4ec0\u4e48\u597d\u5904")),(0,o.kt)("h1",{id:"8-aop"},"8. AOP"),(0,o.kt)("h2",{id:"81-aop-\u6982\u5ff5"},"8.1. aop \u6982\u5ff5"),(0,o.kt)("p",null,"\u5728\u4e0d\u4fee\u6539\u6e90\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b, \u589e\u5f3a\u67d0\u4e2a\u65b9\u6cd5, \u6bd4\u5982\u5728\u8fd9\u4e2a\u65b9\u6cd5\u903b\u8f91\u6267\u884c\u4e4b\u524d, \u4e4b\u540e, \u524d\u540e, \u8fd4\u56de\u503c\u8fd4\u56de\u4e4b\u540e, \u629b\u51fa\u5f02\u5e38\u4e4b\u540e"),(0,o.kt)("p",null,"\u76ee\u524d\u4e3b\u6d41\u6709\u4e24\u79cd\u65b9\u6cd5"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Spring AOP:\u4f7f\u7528\u7eaf Java \u5b9e\u73b0\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"\u4e0d\u9700\u8981\u4e13\u95e8\u7684\u7f16\u8bd1\u5668"),"\uff0c\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"\u8fd0\u884c\u671f"),"\u901a\u8fc7\u52a8\u6001\u751f\u6210\u4ee3\u7406\u7c7b, \u5982\u679c\u7c7b\u5b9e\u73b0\u4e86\u63a5\u53e3, \u4f7f\u7528 jdk \u81ea\u5e26\u7684\u52a8\u6001\u4ee3\u7406, \u5982\u679c\u7c7b\u6ca1\u6709\u5b9e\u73b0\u4efb\u4f55\u63a5\u53e3, \u4f7f\u7528 cglib \u751f\u6210\u52a8\u6001\u4ee3\u7406;Spring AOP \u867d\u7136\u4f7f\u7528\u4e86 AspectJ \u7684 Annotation, \u4f46\u662f\u4e24\u8005\u662f\u4e0d\u540c\u7684")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"AspectJ: \u662f\u4e00\u4e2a\u57fa\u4e8e Java \u8bed\u8a00\u7684 AOP \u6846\u67b6,\u53ef\u4ee5\u5355\u72ec\u4f7f\u7528\uff0cSpring 2.0 \u5f00\u59cb\uff0cSpring \u5f15\u5165\u5bf9 AspectJ \u7684\u652f\u6301\uff0cAspectJ \u6269\u5c55\u4e86 Java \u8bed\u8a00\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"\u4e13\u95e8\u7684\u7f16\u8bd1\u5668"),"(\u76f8\u5f53\u4e8e javac \u7684\u589e\u5f3a\u7248\u672c)\uff0c\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"\u7f16\u8bd1\u65f6\u7ec7\u5165"),", \u800c\u4e0d\u662f\u8fd0\u884c\u662f\u52a8\u6001\u751f\u6210;"))),(0,o.kt)("p",null,"\u7ecf\u5178\u5e94\u7528"),(0,o.kt)("p",null,"\u6743\u9650\u7ba1\u7406, \u9519\u8bef\u5904\u7406, \u61d2\u52a0\u8f7d, \u6027\u80fd\u76d1\u89c6\u3001\u4e8b\u52a1\u7ba1\u7406\u3001\u5b89\u5168\u68c0\u67e5\u3001\u7f13\u5b58 \u3001\u65e5\u5fd7"),(0,o.kt)("p",null,"\u540d\u8bcd\u6982\u5ff5"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"1.target \u76ee\u6807\u7c7b \uff0c\u88ab\u589e\u5f3a\u7c7b\u3002\n\n2.JoinPoint \u8fde\u63a5\u70b9\uff0c\u76ee\u6807\u7c7b\u4e0a\u90a3\u4e9b\u6709\u53ef\u80fd\u88ab\u589e\u5f3a\u7684\u65b9\u6cd5\u3002\uff08\u4e00\u822c\u6307\u6240\u6709\u65b9\u6cd5\uff09\n\n3.PointCut \u5207\u5165\u70b9\uff0c\u76ee\u6807\u7c7b\u88ab\u589e\u5f3a\u7684\u65b9\u6cd5\uff0c\u88ab\u589e\u5f3a\u7684\u8fde\u63a5\u70b9\u3002\n\n4.Advice \u589e\u5f3a/\u901a\u77e5\uff0c\u589e\u5f3a\u7684\u90a3\u4e9b\u5185\u5bb9\n\n5.weaving \u7ec7\u5165\uff0c\u5c06\u901a\u77e5\uff08\u589e\u5f3a\uff09\u5e94\u7528\u5230\u8fde\u63a5\u70b9\u4e0a\uff0c\u751f\u6210\u4ee3\u7406\u7684\u8fc7\u7a0b\u3002\n\n6.proxy \u4ee3\u7406\n\n7.aspect \u5207\u9762\uff0c\u5207\u5165\u70b9 \u548c \u901a\u77e5 \u7ed3\u5408\n\n")),(0,o.kt)("h2",{id:"82-aop-\u8054\u76df\u89c4\u8303"},"8.2. aop \u8054\u76df\u89c4\u8303"),(0,o.kt)("h3",{id:"821-\u901a\u77e5\u7c7b\u578b"},"8.2.1. \u901a\u77e5\u7c7b\u578b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"1\uff09 aop\u8054\u76df \u5b9a\u4e49 aop\u901a\u77e5\u7c7b\u578b\uff0cspring \u5bf9 aop\u8054\u76df\u89c4\u8303\u652f\u6301\u3002\n\n2\uff09 aop\u8054\u76df\u5b9a\u4e495\u79cd\u901a\u77e5\n\n    \u524d\u7f6e\u901a\u77e5 org.springframework.aop.MethodBeforeAdvice\n        \u5728\u76ee\u6807\u65b9\u6cd5\u6267\u884c\u524d\u5b9e\u65bd\u589e\u5f3a\n\n    \u540e\u7f6e\u901a\u77e5 org.springframework.aop.AfterReturningAdvice\n        \u5728\u76ee\u6807\u65b9\u6cd5\u6267\u884c\u540e\u5b9e\u65bd\u589e\u5f3a\n\n    \u73af\u7ed5\u901a\u77e5 org.aopalliance.intercept.MethodInterceptor \u3010\u6ce8\u610f\uff1a\u8fd9\u4e2a\u63a5\u53e3\u662faop\u8054\u76df\u7684\u3011\n        \u5728\u76ee\u6807\u65b9\u6cd5\u6267\u884c\u524d\u540e\u5b9e\u65bd\u589e\u5f3a\n\n    \u5f02\u5e38\u629b\u51fa\u901a\u77e5 org.springframework.aop.ThrowsAdvice\n        \u5728\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u540e\u5b9e\u65bd\u589e\u5f3a\n\n    \u5f15\u4ecb\u901a\u77e5 org.springframework.aop.IntroductionInterceptor\u5bf9\u4e00\u4e2a\u7c7b\u8fdb\u884c\u589e\u5f3a\uff08\u6dfb\u52a0\u65b9\u6cd5\u6216\u5c5e\u6027\u7b49\uff09\n        \u5728\u76ee\u6807\u7c7b\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u65b0\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\n            try{\n               \u524d\u7f6e\n               \u73af\u7ed5\n               \u540e\u7f6e\n            } catch{\n               \u5f02\u5e38\u629b\u51fa\n            }\n\n3\uff09 \u5982\u679c\u4f7f\u7528aop\u8054\u76df\u89c4\u8303\u8fdb\u884caop\u5f00\u53d1\uff0c\u6240\u6709\u7684\u901a\u77e5\u5fc5\u987b\u5b9e\u73b0\u63a5\u53e3\u3002\uff08\u5e95\u5c42\u4e3a\u4e86\u786e\u5b9a\u901a\u77e5\u65b9\u6cd5\u540d\u79f0\uff09\n\n")),(0,o.kt)("h3",{id:"822-joinpoint-\u8fde\u63a5\u70b9"},"8.2.2. Joinpoint \u8fde\u63a5\u70b9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"1\uff09 JoinPoint\u8fde\u63a5\u70b9\u7684\u4fe1\u606f\n2\uff09 \u63a5\u53e3\uff1aorg.aspectj.lang.JoinPoint\n    \u2022 \u83b7\u5f97\u76ee\u6807\u5bf9\u8c61(\u88ab\u4ee3\u7406\u5bf9\u8c61)\uff1agetTarget()\n    \u2022 \u83b7\u5f97\u88ab\u589e\u5f3a\u65b9\u6cd5\u7b7e\u540d\uff1agetSignature()\n    \u2022 \u83b7\u5f97\u88ab\u589e\u5f3a\u65b9\u6cd5\u540d\u79f0\uff1agetSignature().getName()\n    * \u83b7\u53d6\u88ab\u589e\u5f3a\u65b9\u6cd5\u5bf9\u8c61\u672c\u8eab: getSignature().getMethod()\n    \u2022 \u83b7\u5f97\u5b9e\u9645\u53c2\u6570\uff1agetArgs()\n    \u2022 \u83b7\u5f97\u5f53\u524d\u6307\u5b9a\u65b9\u6cd5\u7684\u7c7b\u578b\uff1agetKind()\n        method-execution \u65b9\u6cd5\u6267\u884c\u3001\n        constructor-execution\u6784\u9020\u65b9\u6cd5\u6267\u884c\n        field-get get\u65b9\u6cd5\n    * proceed() \u6267\u884c\u539f\u59cb\u65b9\u6cd5\n")),(0,o.kt)("h2",{id:"83-\u4e0d\u548c-spring-\u96c6\u6210\u5355\u72ec\u4f7f\u7528\u52a8\u6001\u4ee3\u7406"},"8.3. \u4e0d\u548c spring \u96c6\u6210(\u5355\u72ec\u4f7f\u7528\u52a8\u6001\u4ee3\u7406)"),(0,o.kt)("h3",{id:"831-\u901a\u8fc7-jdk-\u52a8\u6001\u751f\u6210\u4ee3\u7406"},"8.3.1. \u901a\u8fc7 jdk \u52a8\u6001\u751f\u6210\u4ee3\u7406"),(0,o.kt)("p",null,"spring \u5bf9\u4e8e\u5b9e\u73b0\u4e86\u63a5\u53e3\u7684\u7c7b, \u4f1a\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u751f\u6210\u4ee3\u7406"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'/**\n\u6b65\u9aa4\uff1a\n1. \u63a5\u53e3 + \u5b9e\u73b0\u7c7b\n2. \u7f16\u5199\u5207\u9762\u7c7b MyAspect \uff0c\u5e76\u63d0\u4f9b\u901a\u77e5\n3. \u7f16\u5199\u5de5\u5382\uff0c\u751f\u6210\u4ee3\u7406\n4. \u6d4b\u8bd5\n\n*/\n// \u63a5\u53e3\uff1a\npublic interface UserService {\n    public void addUser();\n    public void updateUser();\n\n}\n// \u5b9e\u73b0\u7c7b\uff1a\npublic class UserServiceImpl implements UserService {\n\n    @Override\n    public void addUser() {\n        System.out.println("a_jdk addUser()");\n    }\n\n    @Override\n    public void updateUser() {\n        System.out.println("a_jdk updateUser()");\n    }\n\n}\n// \u5207\u9762\u7c7b\uff1a\n/**\n * \u5207\u9762\u7c7b\uff0c\u5b58\u653e\u6240\u6709\u7684\u901a\u77e5\uff08\u589e\u5f3a\uff09\n */\npublic class MyAspect {\n    public void myBefore(){\n        System.out.println(" a_proxy.a_jdk  \u524d");\n    }\n    public void myAfter(){\n        System.out.println(" a_proxy.a_jdk  \u540e");\n    }\n\n}\n// \u5de5\u5382\u7c7b\uff1a\npublic class MyFactory {\n    /**\n     *  JDK \u52a8\u6001\u4ee3\u7406  Object obj = Proxy.newProxyInstance(....)\uff1b\n     *  1.\u53c2\u65701\uff1aClassLoader loader ,\u786e\u5b9a\u7c7b\u52a0\u8f7d\u5668\u3002\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u521b\u5efa\u7c7b\uff0c\u9700\u8981\u7c7b\u52a0\u8f7d\u52a0\u8f7d\u5230\u5185\u5b58\u3002\u7c7b\u52a0\u8f7d\u5668\u4f5c\u7528\uff1aclass\u6587\u4ef6 --\x3e Class\u5bf9\u8c61\n     *      * \u4e00\u822c\u60c5\u51b5\u4f7f\u7528\u90fd\u662f\u5f53\u524d\u7c7b\u7684\u7c7b\u52a0\u8f7d\u5668\n     *      * \u7c7b\u52a0\u8f7d\u5668\u83b7\u5f97\u65b9\u5f0f\uff1aMyFactory.class.getClassLoader();\n     *  2.\u53c2\u65702\uff1aClass[] interfaces  \u4ee3\u7406\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3\u4eec\uff08\u53ef\u80fd\u6709\u591a\u4e2a\uff09\n     *      * \u65b9\u5f0f1\uff1auserService.getClass().getInterfaces()\u3010\u6b64\u65b9\u5f0f\u53ea\u80fd\u5728\u4ee3\u7406\u5bf9\u8c61\u548c\u63a5\u53e3\u662f\u7236\u5b50\u5173\u7cfb\u65f6\u4f7f\u7528\u3011\n     *      * \u65b9\u5f0f2\uff1anew Class[]{UserService.class}\u3010\u5f53\u88ab\u4ee3\u7406\u5bf9\u8c61\u548c\u5176\u5b9e\u73b0\u63a5\u53e3\u4e4b\u95f4\u662f\u9694\u4ee3\u5173\u7cfb\u65f6\uff08\u5373\u7956\u5b59\u5173\u7cfb\uff09\u5fc5\u987b\u4f7f\u7528\u65b9\u5f0f2\u83b7\u53d6\u63a5\u53e3\u4eec\u3011\n     *  3.\u53c2\u65703\uff1aInvocationHandler h \u8bf7\u6c42\u5904\u7406\u7c7b\uff0c\u4ee3\u7406\u7c7b\u65b9\u6cd5\u6267\u884c\u65f6\uff0c\u9700\u8981\u8bf7\u6c42\u5904\u7406\u7c7b\u6765\u5904\u7406\u3002\n     *      * \u4e00\u822c\u91c7\u7528\u533f\u540d\u5185\u90e8\u7c7b\uff1anew InvocationHandler(){}\n     *      * \u5b9e\u73b0\u65b9\u6cd5 invoke \uff0c\u4ee3\u7406\u7c7b\u6bcf\u4e00\u4e2a\u65b9\u6cd5\u6267\u884c\u4e00\u6b21\uff0c\u5c06\u8c03\u7528\u4e00\u6b21invoke\n     *          \u53c2\u65701.1\uff1aObject proxy ,\u4ee3\u7406\u6210\u529f\u5bf9\u8c61\uff08\u5373 proxyService\uff0c\u4e0d\u662f\u201c\u4ee3\u7406\u4e4b\u524d\u5bf9\u8c61\u201d\uff09\uff0c\u4e00\u822c\u6ca1\u7528\u3002\n     *          \u53c2\u65702.2\uff1aMethod method \uff0c\u5f53\u524d\u6267\u884c\u7684\u65b9\u6cd5\n     *              * \u5f53\u524d\u8c03\u7528\u65b9\u6cd5\u540d\uff1amethod.getName();\n     *              * \u6267\u884c\u76ee\u6807\u7c7b\u65b9\u6cd5\uff1aObject obj = method.invoke(\u4ee3\u7406\u4e4b\u524d\u5bf9\u8c61 , args)\n     *          \u53c2\u65703.3\uff1aObject[] args\n     *              * \u5f53\u524d\u65b9\u6cd5\u5b9e\u9645\u53c2\u6570\n     */\n    public static UserService createService(){\n        //1 \u521b\u5efa\u76ee\u6807\n        final UserService userService = new UserServiceImpl();\n        //2 \u5207\u9762\u7c7b\uff08\u901a\u77e5\uff09\n        final MyAspect myAspect = new MyAspect();\n        //3 \u7f16\u5199\u4ee3\u7406\uff0c\u5c06\u901a\u77e5 \u5e94\u7528 \u5230\u76ee\u6807\u7c7b\u65b9\u6cd5\u4e0a\n        UserService proxyService = (UserService)Proxy.newProxyInstance(\n                MyFactory.class.getClassLoader(),\n                userService.getClass().getInterfaces(),\n                new InvocationHandler(){\n                    @Override\n                    public Object invoke(Object proxy, Method method,\n                            Object[] args) throws Throwable {\n                        //\u524d\u901a\u77e5\n                        myAspect.myBefore();\n                        //\u6267\u884c\u76ee\u6807\u7c7b\u7684\u65b9\u6cd5, \u6ce8\u610f\u7528\u7684\u4e0d\u662f proxy\u5bf9\u8c61\u800c\u662f\u539f\u59cb\u5bf9\u8c61\n                        Object obj = method.invoke(userService, args);\n                        //\u540e\u901a\u77e5\n                        myAspect.myAfter();\n                        return obj;\n                    }\n                });\n        return proxyService;\n    }\n\n}\n\n')),(0,o.kt)("h3",{id:"832-\u901a\u8fc7-cglib-\u52a8\u6001\u751f\u6210\u4ee3\u7406"},"8.3.2. \u901a\u8fc7 cglib \u52a8\u6001\u751f\u6210\u4ee3\u7406"),(0,o.kt)("p",null,"spring \u5bf9\u4e8e\u6ca1\u6709\u5b9e\u73b0\u63a5\u53e3\u7684\u7c7b, \u4f1a\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u751f\u6210\u4ee3\u7406"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"cglib\uff1a\u5b57\u8282\u7801\u589e\u5f3a\u6846\u67b6\uff08spring \u5b57\u8282\u7801\u589e\u5f3a\u6846\u67b6\uff0c\u9ed8\u8ba4\u4f7f\u7528 cglib\uff09\uff0c\u8fd0\u884c\u65f6\u91c7\u7528\u52a8\u6001\u751f\u6210\u5b50\u7c7b\u65b9\u5f0f\uff0c\u5b50\u7c7b\u5c31\u662f\u4ee3\u7406\u7c7b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring \u5c06 asm \u548c cglib \u5185\u7f6e\u5230 spring-core...jar\u3010spring \u4e2d\u4f7f\u7528\u65f6\u5bfc\u5165\u8fd9\u4e2a jar \u5305\u3011"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// UserService\uff1a\npublic class UserService {\n    public void addUser() {\n        System.out.println("b_cglib addUser()");\n    }\n\n    public void updateUser() {\n        System.out.println("b_cglib updateUser()");\n    }\n}\n// \u5207\u9762\u7c7b\uff1a\n/**\n * \u5207\u9762\u7c7b\uff0c\u5b58\u653e\u6240\u6709\u7684\u901a\u77e5\uff08\u589e\u5f3a\uff09\n */\npublic class MyAspect {\n    public void myBefore(){\n        System.out.println(" b_cglib  \u524d");\n    }\n    public void myAfter(){\n        System.out.println(" b_cglib  \u540e");\n    }\n}\n// \u5de5\u5382\u7c7b\uff1a\npublic class MyFactory {\n\n    public static UserService createService() {\n        //1 \u76ee\u6807\u7c7b  \u7c7b = new \u7c7b\n        final UserService userService = new UserService();\n        //2 \u5207\u9762\u7c7b\n        final MyAspect myAspect = new MyAspect();\n        //3 \u4ee3\u7406\u7c7b --cglib (\u4ee3\u7406\u7c7b\u3010\u5b50\u3011 \u548c \u76ee\u6807\u7c7b\u3010\u7236\u3011 \u7236\u5b50\u5173\u7cfb)\n        // 3.1 \u521b\u5efa\u6838\u5fc3\u7c7b\uff08Enhancer \u589e\u5f3a\uff09\n        Enhancer enhancer = new Enhancer();\n        // 3.2 \u786e\u5b9a\u5373\u76ee\u6807\u7c7b\n        enhancer.setSuperclass(userService.getClass());// \u56e0\u4e3a\u4ee3\u7406\u7c7b\u5c31\u662ftarget class \u7684 sub class\n        // 3.3 \u8bbe\u7f6e\u56de\u8c03\uff0c\u7c7b\u4f3cJDK\u4ee3\u7406\u4e2dInvocationHandler\n        // ** CallBack \u63a5\u53e3\u5904\u7406\u6240\u6709\u5185\u5bb9\uff0c\u8fd9\u91cc\u4f7f\u7528\u5b83\u7684\u5b50\u63a5\u53e3\n        // ** \u5b50\u63a5\u53e3 MethodInterceptor \u7528\u4e8e\u5904\u7406\u65b9\u6cd5\n        enhancer.setCallback(new MethodInterceptor() {\n            /**\n             * intercept() \u7b49\u6548 jdk invoke()\u65b9\u6cd5\n             *  * \u53c2\u65701\u3001\u53c2\u65702\u3001\u53c2\u65703\uff1a\u4e0einvoke\u4e00\u6837\u7684\n             *  * \u53c2\u65704\uff1amethodProxy---\u8868\u793a\u5c5e\u4e8e\u4ee3\u7406\u5bf9\u8c61\u7684\u65b9\u6cd5\n             */\n            @Override\n            public Object intercept(Object proxy, Method method, Object[] args,\n                    MethodProxy methodProxy) throws Throwable {\n                //\u524d\n                myAspect.myBefore();\n                //\u6267\u884c\u76ee\u6807\u7c7b\u7684\u5f53\u524d\u65b9\u6cd5\n                Object obj = method.invoke(userService, args);\n                // ******** \u901a\u8fc7\u4ee3\u7406\u7c7b\u6267\u884c\u201c\u4ee3\u7406\u7c7b\u7684\u7236\u7c7b\u201d\u3010\u5373\u76ee\u6807\u7c7b\u3011\u7684\u5f53\u524d\u65b9\u6cd5\uff0c\u548c\u4e0a\u53e5\u7b49\u6548\n                // methodProxy.invokeSuper(proxy, args);\n                //\u540e\n                myAspect.myAfter();\n                return obj;\n            }\n        });\n        // 3.4 \u521b\u5efa\u4ee3\u7406\n        UserService proxyService = (UserService)enhancer.create();\n        return proxyService;\n    }\n\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestCglib {\n    @Test\n    public void demo01(){\n        UserService userService = new UserService();\n        userService.addUser();\n        userService.updateUser();\n    }\n    @Test\n    public void demo02(){\n        UserService userService = MyFactory.createService();\n        userService.addUser();\n        userService.updateUser();\n    }\n}\n\n')),(0,o.kt)("h2",{id:"84-\u901a\u8fc7-proxyfactorybean-\u751f\u6210\u4ee3\u7406\u534a\u81ea\u52a8"},"8.4. \u901a\u8fc7 ProxyFactoryBean \u751f\u6210\u4ee3\u7406(\u534a\u81ea\u52a8)"),(0,o.kt)("p",null,"\u6dfb\u52a0 aop \u5f00\u53d1\u5305: ",(0,o.kt)("a",{parentName:"p",href:"http://mvnrepository.com/artifact/org.aopalliance/com.springsource.org.aopalliance/1.0.0"},"http://mvnrepository.com/artifact/org.aopalliance/com.springsource.org.aopalliance/1.0.0"),", \u8fd8\u6709\u5b9e\u73b0\u7c7b spring-aop"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// \u63a5\u53e3\uff1a\npublic interface UserService {\n    public void addUser();\n    public void updateUser();\n\n}\n// \u5b9e\u73b0\u7c7b\uff1a\npublic class UserServiceImpl implements UserService {\n\n    @Override\n    public void addUser() {\n        System.out.println("b_factory_bean addUser()");\n    }\n\n    @Override\n    public void updateUser() {\n        System.out.println("b_factory_bean updateUser()");\n    }\n\n}\n// \u5207\u9762\u7c7b\uff1a\n/**\n * \u5207\u9762\u7c7b\uff0c\u5b58\u653e\u6240\u6709\u7684\u901a\u77e5\uff0c\u4f7f\u7528spring \u8054\u76df\u63d0\u4f9b\u89c4\u8303\uff0c\u5fc5\u987b\u5b9e\u73b0\u76f8\u5e94\u63a5\u53e3\uff0c\u8fd9\u91cc\u5b9e\u73b0\u7684\u662f\u73af\u7ed5\u901a\u77e5\u7684\u63a5\u53e3\n * * \u73af\u7ed5\u901a\u77e5\u5fc5\u987b\u624b\u52a8\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n */\npublic class MyAspect implements MethodInterceptor {\n\n    @Override\n    public Object invoke(MethodInvocation mi) throws Throwable {\n        System.out.println("\u524d");\n        //\u5fc5\u987b\u624b\u52a8\u7684\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n        Object obj = mi.proceed();\n        System.out.println("\u540e");\n        return obj;\n    }\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestFactoryBean {\n    @Test\n    public void demo01(){\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        //\u4ecespring\u83b7\u5f97\u666e\u901abean\u6570\u636e\n        UserService userService = (UserService) applicationContext.getBean("userServiceId");\n        userService.addUser();\n        userService.updateUser();\n    }\n    @Test\n    public void demo02(){\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        //\u4ecespring \u624b\u52a8 \u83b7\u5f97\u4ee3\u7406bean\uff0c\u79f0\u4e3a\u534a\u81ea\u52a8\u5c31\u662f\u56e0\u4e3a\u8fd9\u91cc\uff0c\u4e00\u65e6\u5220\u53bb\u4ee3\u7406\u5bf9\u8c61\u7684\u76f8\u5173\u914d\u7f6e\u5c31\u62a5\u9519\n        UserService userService = (UserService) applicationContext.getBean("proxyServiceId");\n        userService.addUser();\n        userService.updateUser();\n    }\n\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    \x3c!-- 1 \u76ee\u6807\u7c7b --\x3e\n    <bean id="userServiceId" class="com.xiaoyu.spring.learn.UserServiceImpl"></bean>\n    \x3c!-- 2 \u5207\u9762\u7c7b --\x3e\n    <bean id="myAspectId" class="com.xiaoyu.spring.learn.MyAspect"></bean>\n    \x3c!-- 3 \u751f\u6210\u4ee3\u7406\u5bf9\u8c61\uff1a\u901a\u77e5\uff08\u589e\u5f3a\uff09 \u548c\u76ee\u6807\u7c7b \u7ed3\u5408\n    * ProxyFactoryBean\uff08\u4ee3\u7406\u5de5\u5382bean\uff09 \u7528\u4e8e\u751f\u6210\u4e00\u4e2a\u4e13\u95e8\u751f\u4ea7\u4ee3\u7406bean\u7684\u5de5\u5382bean\u3002\n        target \u786e\u5b9a\u76ee\u6807\u7c7b\n        interceptorNames \u786e\u5b9a\u6240\u6709\u5207\u9762\u7c7b\uff0c\u7c7b\u578bString[],\u9700\u8981\u5207\u9762\u7c7b\u7684bean id\u503c\uff0c\u8fd9\u91cc\u53ea\u6709\u4e00\u4e2a\u503c\uff0c\u53ef\u76f4\u63a5\u7528<property>\u7684value\u5c5e\u6027\u8d4b\u503c\n        proxyInterfaces \u786e\u5b9a\u4ee3\u7406\u7c7b\u9700\u8981\u5b9e\u73b0\u63a5\u53e3\n        optimize \u5f3a\u5236\u662f\u5426\u4f7f\u7528cglib\u3010\u914d\u7f6e\u4e3atrue\u5219\u914d\u7f6e\u7684\u63a5\u53e3\u5c5e\u6027\uff08proxyInterfaces\uff09\u53ef\u4ee5\u7701\u7565\u3011\n    --\x3e\n    <bean id="proxyServiceId" class="org.springframework.aop.framework.ProxyFactoryBean">\n        <property name="target" ref="userServiceId"></property>\n        <property name="interceptorNames" value="myAspectId"></property>\n        <property name="proxyInterfaces" value="com.xiaoyu.spring.learn.UserService"></property>\n        <property name="optimize" value="true"></property>\n    </bean>\n</beans>\n\n')),(0,o.kt)("h2",{id:"85-\u5168\u81ea\u52a8\u5b9e\u73b0"},"8.5. \u5168\u81ea\u52a8\u5b9e\u73b0"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u914d\u7f6e\u6587\u4ef6\u4e2d\u52a0\u5165\u7ea6\u675f(\u4f7f\u7528 aop \u7f16\u7a0b\uff0c\u5fc5\u987b\u4f7f\u7528 aop schema\uff08\u5f15\u7528 aop \u547d\u540d\u7a7a\u95f4\uff09\uff0c\u5728 index-config.html \u4e2d\u627e)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5728\u534a\u81ea\u52a8\u7684 pom \u57fa\u7840\u4e0a\u6dfb\u52a0: ",(0,o.kt)("a",{parentName:"p",href:"http://www.mvnrepository.com/artifact/org.aspectj/com.springsource.org.aspectj.weaver"},"http://www.mvnrepository.com/artifact/org.aspectj/com.springsource.org.aspectj.weaver")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// \u63a5\u53e3\uff1a\npublic interface UserService {\n    public void addUser();\n    public void updateUser();\n}\n// \u5b9e\u73b0\u7c7b\uff1a\npublic class UserServiceImpl implements UserService {\n\n    @Override\n    public void addUser() {\n        System.out.println("c_aop addUser()");\n    }\n\n    @Override\n    public void updateUser() {\n        System.out.println("c_aop updateUser()");\n    }\n\n}\n// \u5207\u9762\u7c7b\uff1a\n/**\n * \u5207\u9762\u7c7b\uff0c\u5b58\u653e\u6240\u6709\u7684\u901a\u77e5\uff0c\u4f7f\u7528spring \u8054\u76df\u63d0\u4f9b\u89c4\u8303\uff0c\u5fc5\u987b\u5b9e\u73b0\u63a5\u53e3MethodInterceptor\n * * \u73af\u7ed5\u901a\u77e5\u5fc5\u987b\u624b\u52a8\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n */\npublic class MyAspect implements MethodInterceptor {\n\n    @Override\n    public Object invoke(MethodInvocation mi) throws Throwable {\n        System.out.println("c_aop \u524d");\n        //\u5fc5\u987b\u624b\u52a8\u7684\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n        Object obj = mi.proceed();\n        System.out.println("c_aop \u540e");\n        return obj;\n    }\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestAOP {\n    @Test\n    public void demo01(){\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        //\u7ecf\u8fc7\u914d\u7f6e\uff0c\u6309\u7167\u4ee5\u524d\u7684\u666e\u901a\u65b9\u5f0f\u83b7\u5f97bean\u6570\u636e\uff0c\u5c31\u662f\u4ee3\u7406bean\u5bf9\u8c61\n        UserService userService = (UserService) applicationContext.getBean("userServiceId");\n        userService.addUser();\n        userService.updateUser();\n    }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:aop="http://www.springframework.org/schema/aop"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/aop\n                           http://www.springframework.org/schema/aop/spring-aop.xsd">\n\n    \x3c!-- 1 \u76ee\u6807\u7c7b --\x3e\n    <bean id="userServiceId" class="com.xiaoyu.spring.learn.UserServiceImpl"></bean>\n    \x3c!-- 2 \u5207\u9762\u7c7b\uff08\u901a\u77e5\uff09 --\x3e\n    <bean id="myAspectId" class="com.xiaoyu.spring.learn.MyAspect"></bean>\n    \x3c!-- 3 spring aop \u7f16\u7a0b \u914d\u7f6e\n    * aop\u7f16\u7a0b <aop:config>\n            proxy-target-class="true" \u8868\u793a\u5f3a\u5236\u4f7f\u7528cglib\n    * <aop:pointcut> \uff1a\u914d\u7f6e\u5207\u5165\u70b9,\u786e\u5b9a\u76ee\u6807\u7c7b\u4e0a\u90a3\u4e9b\u65b9\u6cd5\u9700\u8981\u589e\u5f3a\n        expression \uff1a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u91c7\u7528aspectJ\uff08\u4e00\u79cdAOP\u89c4\u8303\uff09\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\n            execution(* com.xiaoyu.spring.learn.UserServiceImpl.addUser())  \u6307\u5b9a\u4e00\u79cd\u65b9\u6cd5\u589e\u5f3a\n            execution(* com.xiaoyu.spring.learn.UserServiceImpl.*())      \u6240\u6709\u4ee3\u7406\u5bf9\u8c61\u65b9\u6cd5\u589e\u5f3a\n        id : \u5207\u5165\u70b9\u540d\u79f0\uff0c\u63d0\u4f9b\u7ed9\u522b\u4eba\u4f7f\u7528\u3002\n    * <aop:advisor>: \u8fd9\u662f\u4e00\u4e2a\u7279\u6b8a\u5207\u9762\uff0c\u3010\u4e00\u4e2a\u901a\u77e5 \u548c \u4e00\u4e2a\u5207\u5165\u70b9 \u7ed3\u5408\u3011\n            advice-ref \u901a\u77e5\u7684\u5f15\u7528\n            pointcut-ref \u5207\u5165\u70b9\u7684\u5f15\u7528\n    --\x3e\n    <aop:config proxy-target-class="true">\n        <aop:pointcut id="myPointCut" expression="execution(* com.xiaoyu.spring.learn.UserServiceImpl.*())" />\n        <aop:advisor advice-ref="myAspectId" pointcut-ref="myPointCut"/>\n    </aop:config>\n</beans>\n\n')),(0,o.kt)("h2",{id:"86-\u4f7f\u7528-aspectj-\u6846\u67b6\u751f\u6210\u4ee3\u7406\u548c-spring-\u96c6\u6210"},"8.6. \u4f7f\u7528 AspectJ \u6846\u67b6\u751f\u6210\u4ee3\u7406(\u548c spring \u96c6\u6210)"),(0,o.kt)("h3",{id:"861-\u51c6\u5907\u5de5\u4f5c"},"8.6.1. \u51c6\u5907\u5de5\u4f5c"),(0,o.kt)("p",null,"\u5f15\u5165 jar \u5305"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://www.mvnrepository.com/artifact/org.aspectj/aspectjrt"},"http://www.mvnrepository.com/artifact/org.aspectj/aspectjrt")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://www.mvnrepository.com/artifact/org.aspectj/aspectjweaver"},"http://www.mvnrepository.com/artifact/org.aspectj/aspectjweaver"))),(0,o.kt)("p",null,"\u5bfc\u5165\u7684 jar \u5305\u8fd8\u6709\u53e6\u4e00\u79cd\u8bf4\u6cd5, \u5bf9\u9519\u5b58\u7591:\n","[aop \u8054\u76df\u89c4\u8303]","(",(0,o.kt)("a",{parentName:"p",href:"http://mvnrepository.com/artifact/org.aopalliance/com.springsource.org.aopalliance/1.0.0"},"http://mvnrepository.com/artifact/org.aopalliance/com.springsource.org.aopalliance/1.0.0"),", \u8fd8\u6709\u5b9e\u73b0\u7c7b spring-aop), \u5bf9\u5e94\u7684 spring-aop \u5b9e\u73b0"),(0,o.kt)("h3",{id:"862-aspectj-\u901a\u77e5\u7c7b\u578b"},"8.6.2. AspectJ \u901a\u77e5\u7c7b\u578b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\u5b9a\u4e496\u4e2d\u901a\u77e5\u7c7b\u578b\uff0c\u3002\n    \u2022 before:\u524d\u7f6e\u901a\u77e5(\u5e94\u7528\uff1a\u5404\u79cd\u6821\u9a8c)\n            \u5728\u65b9\u6cd5\u6267\u884c\u524d\u6267\u884c\uff0c\u5982\u679c\u901a\u77e5\u629b\u51fa\u5f02\u5e38\uff0c\u963b\u6b62\u65b9\u6cd5\u8fd0\u884c\n    \u2022 afterReturning:\u540e\u7f6e\u901a\u77e5(\u5e94\u7528\uff1a\u5e38\u89c4\u6570\u636e\u5904\u7406)\n            \u65b9\u6cd5\u6b63\u5e38\u8fd4\u56de\u540e\u6267\u884c\uff0c\u5982\u679c\u65b9\u6cd5\u4e2d\u629b\u51fa\u5f02\u5e38\uff0c\u901a\u77e5\u65e0\u6cd5\u6267\u884c\n            \u5fc5\u987b\u5728\u65b9\u6cd5\u6267\u884c\u540e\u624d\u6267\u884c\uff0c\u6240\u4ee5\u53ef\u4ee5\u83b7\u5f97\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u3002\n    \u2022 around:\u73af\u7ed5\u901a\u77e5(\u5e94\u7528\uff1a\u5341\u5206\u5f3a\u5927\uff0c\u53ef\u4ee5\u505a\u4efb\u4f55\u4e8b\u60c5)\n            \u65b9\u6cd5\u6267\u884c\u524d\u540e\u5206\u522b\u6267\u884c\uff0c\u53ef\u4ee5\u963b\u6b62\u65b9\u6cd5\u7684\u6267\u884c\n    \u2022 afterThrowing:\u629b\u51fa\u5f02\u5e38\u901a\u77e5(\u5e94\u7528\uff1a\u5305\u88c5\u5f02\u5e38\u4fe1\u606f)\n            \u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u540e\u6267\u884c\uff0c\u5982\u679c\u65b9\u6cd5\u6ca1\u6709\u629b\u51fa\u5f02\u5e38\uff0c\u65e0\u6cd5\u6267\u884c\n    \u2022 after:\u6700\u7ec8\u901a\u77e5(\u5e94\u7528\uff1a\u6e05\u7406\u73b0\u573a)\n            \u65b9\u6cd5\u6267\u884c\u5b8c\u6bd5\u540e\u6267\u884c\uff0c\u65e0\u8bba\u65b9\u6cd5\u4e2d\u662f\u5426\u51fa\u73b0\u5f02\u5e38\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"try{\n   //\u524d\u7f6e\n   Object = //\u73af\u7ed5--\u624b\u52a8\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n   //\u540e\u7f6e(\u53ef\u4ee5\u83b7\u5f97\u8fd4\u56de\u503c)\n} catch(){\n   //\u629b\u51fa\u5f02\u5e38\n} finally{\n   //\u6700\u7ec8\n}\n\n")),(0,o.kt)("h3",{id:"863-aspectj-\u7f16\u7a0b\u57fa\u4e8e-xml"},"8.6.3. AspectJ \u7f16\u7a0b,\u57fa\u4e8e xml"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'/**\n1.\u76ee\u6807\u7c7b\n2.\u5207\u9762\u7c7b\uff08\u4e0d\u9700\u8981\u5b9e\u73b0\u63a5\u53e3\uff09\n3.spring\u914d\u7f6e\n4.\u6d4b\u8bd5\n*/\n// \u63a5\u53e3\uff1a\npublic interface UserService {\n    public void addUser();\n    public String updateUser();\n}\n// \u5b9e\u73b0\u7c7b\uff1a\npublic class UserServiceImpl implements UserService {\n    @Override\n    public void addUser() {\n        System.out.println("d_aspectj.a_xml addUser()");\n    }\n    @Override\n    public String updateUser() {\n        System.out.println("d_aspectj.a_xml updateUser()");\n        //int i = 1/ 0;\n        return "xxxxx";\n    }\n}\n// \u5207\u9762\u7c7b\uff1a\n/**\n * \u5207\u9762\u7c7b\uff0c\u5b9a\u4e49\u9700\u8981\u901a\u77e5\uff0c\u4e0d\u7528\u5b9e\u73b0\u4efb\u4f55\u63a5\u53e3\uff0c\u4f46\u4e4b\u540e\u9700\u8981\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u786e\u5b9a\u5177\u4f53\u901a\u77e5\u7c7b\u578b\n */\npublic class MyAspect{\n    //\u524d\u7f6e\u901a\u77e5\u65b9\u6cd5\u53c2\u6570\u7c7b\u578b\uff1aorg.aspectj.lang.JoinPoint\uff0c\u53ef\u4ee5\u83b7\u5f97\u65b9\u6cd5\u540d\u7b49\u5185\u5bb9\n    public void myBefore(JoinPoint joinPoint){\n        System.out.println("\u524d\u7f6e\u901a\u77e5 :" + joinPoint.getSignature().getName());\n    }\n//  \u53c2\u65701\uff0c\u7c7b\u578b JoinPoint \u83b7\u5f97\u5f53\u524d\u64cd\u4f5c\u8fde\u63a5\u70b9\u8be6\u7ec6\u5185\u5bb9\n//  \u53c2\u65702\uff1a\u7c7b\u578bObject\uff0c\u76ee\u6807\u5bf9\u8c61\u88ab\u589e\u5f3a\u65b9\u6cd5\u8fd4\u56de\u503c\uff1b\u540d\u79f0\u901a\u8fc7 returning\u5c5e\u6027 \u786e\u5b9a\u3010\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u3011\n    public void myAfterReturning(JoinPoint joinPoint,Object ret){\n        System.out.println("\u540e\u7f6e\u901a\u77e5\uff1a" + joinPoint.getSignature().getName() + " , " + ret);\n    }\n\n//\u73af\u7ed5\u901a\u77e5\u7684\u589e\u5f3a\u5185\u5bb9\u65b9\u6cd5\u7b7e\u540d\u6709\u89c4\u5b9a\uff1a\n// 1.\u4fee\u9970\u7b26\uff1apublic\uff1b 2.\u8fd4\u56de\u503c\uff1aObject\uff1b 3.\u65b9\u6cd5\u53c2\u6570\uff1aProceedingJoinPoint joinPoint\uff1b 4.\u629b\u51fa\u5f02\u5e38\uff1athrows Throwable\n// 5.\u624b\u52a8\u6267\u884c\u76ee\u6807\u5bf9\u8c61\u7684\u88ab\u589e\u5f3a\u65b9\u6cd5\n    public Object myAround(ProceedingJoinPoint joinPoint) throws Throwable{\n        System.out.println("\u73af\u7ed5\u524d");\n        //\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n        Object obj = joinPoint.proceed();\n        System.out.println("\u73af\u7ed5\u540e");\n        return obj;\n    }\n\n//   \u53c2\u65701\uff1a\u7c7b\u578b JoinPoint\n//   \u53c2\u65702\uff1a\u7c7b\u578b Throwable \uff0c\u540d\u79f0\u901a\u8fc7 throwing\u5c5e\u6027\u786e\u5b9a\u540d\u79f0\n    public void myAfterThrowing(JoinPoint joinPoint, Throwable e){\n        System.out.println("\u629b\u51fa\u5f02\u5e38\u901a\u77e5\uff1a" + joinPoint.getSignature().getName() + " , " + e.getMessage());\n    }\n    public void myAfter(JoinPoint joinPoint){\n        System.out.println("\u6700\u7ec8"+ joinPoint.getSignature().getName() );\n    }\n\n}\n// \u6d4b\u8bd5\uff1a\npublic class TestXml {\n    @Test\n    public void demo01(){\n        String xmlPath = "config/beans.xml";\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);\n        //\u6b63\u5e38\u4ecespring\u83b7\u5f97bean\u6570\u636e\u5373\u53ef\n        UserService userService = (UserService) applicationContext.getBean("userServiceId");\n        userService.addUser();\n        userService.updateUser();\n    }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:aop="http://www.springframework.org/schema/aop"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/aop\n                           http://www.springframework.org/schema/aop/spring-aop.xsd">\n\n    \x3c!-- 1 \u76ee\u6807\u7c7b --\x3e\n    <bean id="userServiceId" class="com.xiaoyu.spring.learn.UserServiceImpl"></bean>\n    \x3c!-- 2 \u5207\u9762\u7c7b\uff08\u901a\u77e5\uff09 --\x3e\n    <bean id="myAspectId" class="com.xiaoyu.spring.learn.MyAspect"></bean>\n\n    <aop:config>\n    \x3c!-- 3 <aop:aspect> \u8fdb\u884caspectj\u7f16\u7a0b\n            * ref \u6307\u5b9a\u5207\u9762\u7c7b\n    --\x3e\n        <aop:aspect ref="myAspectId">\n            \x3c!--\n                1 \u5b9a\u4e49\u201c\u5207\u5165\u70b9\u201d\uff0c\u786e\u5b9a\u76ee\u6807\u7c7b\u4e0a\uff0c\u6700\u540e\u9700\u8981\u589e\u5f3a\u7684\u65b9\u6cd5\n                2 aspect\u5207\u9762\u5b9a\u4e49\uff0c\u786e\u5b9a\u5207\u9762\u7c7b\u6240\u6709\u7684\u901a\u77e5\n                3 \u5c06\u901a\u77e5 \u5e94\u7528\u5230 \u5207\u5165\u70b9\u4e0a\n             --\x3e\n            \x3c!-- \u5207\u5165\u70b9 --\x3e\n            <aop:pointcut expression="execution(* com.itheima.d_aspectj.a_xml.*.*(..))" id="myPointcut"/>\n            \x3c!-- \u5177\u4f53\u901a\u77e5\n                1\uff09 \u524d\u7f6e\u901a\u77e5\n                    \u683c\u5f0f1\uff1a<aop:before method="\u65b9\u6cd5\u540d\u79f0" pointcut-ref="\u5207\u5165\u70b9\u5f15\u7528"/>\n                    \u683c\u5f0f2\uff1a<aop:before method="\u65b9\u6cd5\u540d\u79f0" pointcut="\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"/>\n                    \uff08\u524d\u7f6e\u901a\u77e5\u65b9\u6cd5\u53c2\u6570\u7c7b\u578b\uff1aorg.aspectj.lang.JoinPoint\uff0c\u53ef\u4ee5\u83b7\u5f97\u65b9\u6cd5\u540d\u7b49\u5185\u5bb9\u3002\uff09\n                    \u4f8b\u5982\uff1a\n                        <aop:before method="myBefore" pointcut-ref="myPointcut" />\n                2\uff09 \u540e\u7f6e\u901a\u77e5\n                    \u683c\u5f0f\uff1a<aop:after-returning method="" pointcut-ref="" returning="\u53c2\u65702\u540d\u79f0"/>\n                    \u4f8b\u5982\uff1a<aop:after-returning method="myAfterReturning" pointcut-ref="myPointcut" returning="ret"/>\n                    \u901a\u77e5\u65b9\u6cd5\u53c2\u6570\uff1a\n                        \u53c2\u65701\uff0c\u7c7b\u578b JoinPoint \u83b7\u5f97\u5f53\u524d\u64cd\u4f5c\u8fde\u63a5\u70b9\u8be6\u7ec6\u5185\u5bb9\n                        \u53c2\u65702\uff1a\u7c7b\u578bObject\uff0c\u540d\u79f0\u901a\u8fc7 returning\u914d\u7f6e\u9879\u786e\u5b9a\u3010\u5373\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u3011\n                    public void myAfterReturning(JoinPoint joinPoint,Object ret)\n\n                3\uff09\u73af\u7ed5\u901a\u77e5,\u901a\u77e5\u65b9\u6cd5\u6709\u8981\u6c42\n                    \u73af\u7ed5\u5fc5\u987b\u624b\u52a8\u7684\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n                    \u683c\u5f0f\uff1a<aop:around method="" pointcut-ref=""/>\n                    \u901a\u77e5\u65b9\u6cd5\u8981\u6c42\n                        public Object myAround(ProceedingJoinPoint joinPoint) throws Throwable{\n\n                            // something...\n\n                            //\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n                            Object obj = joinPoint.proceed();\n\n                            // something...\n\n                            return obj;\n                        }\n                    \u4f8b\u5982\uff1a\n                        <aop:around method="myAround" pointcut-ref="myPointcut"/>\n                4\uff09\u629b\u51fa\u5f02\u5e38\u901a\u77e5\n                    \u683c\u5f0f\uff1a<aop:after-throwing method="" pointcut-ref="" throwing="\u53c2\u65702\u540d\u79f0"/>\n                    \u901a\u77e5\u65b9\u6cd5\u53c2\u6570\n                        \u53c2\u65701\uff1a\u7c7b\u578b JoinPoint\n                        \u53c2\u65702\uff1a\u7c7b\u578b Throwable \uff0c\u540d\u79f0\u901a\u8fc7 throwing\u5c5e\u6027\u786e\u5b9a\u540d\u79f0\n                        public void myAfterThrowing(JoinPoint joinPoint, Throwable e){}\n                    \u4f8b\u5982\uff1a\n                        <aop:after-throwing method="myAfterThrowing" pointcut-ref="myPointcut" throwing="e"/>\n                5\uff09\u6700\u7ec8\u901a\u77e5\n                    \u683c\u5f0f\uff1a<aop:after method="" pointcut-ref=""/>\n                    \u901a\u77e5\u65b9\u6cd5\u53c2\u6570\u7c7b\u578b JoinPoint\n            --\x3e\n            <aop:after method="myAfter" pointcut-ref="myPointcut"/>\n        </aop:aspect>\n    </aop:config>\n</beans>\n\n')),(0,o.kt)("h3",{id:"864-aspectj-\u7f16\u7a0b\u57fa\u4e8e\u6ce8\u89e3"},"8.6.4. AspectJ \u7f16\u7a0b,\u57fa\u4e8e\u6ce8\u89e3"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'/**\n1. \u5f00\u542f\u5305\u626b\u63cf, \u626b\u63cf\u6ce8\u89e3\u7c7b\uff1a@Service \u3001@Component\n\u914d\u7f6e\u6587\u4ef6\u8981\u914d\u7f6e\uff1a<context:component-scan></context:component-scan>\n\n2. aspectj \u6ce8\u89e3\u81ea\u52a8\u4ee3\u7406\uff1a\n    @Aspect \u3001\u6807\u8bc6\u5207\u9762\u7c7b\n    @PointCut\u3001\u5b9a\u4e49\u53ef\u590d\u7528\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\n    @Before\u3001\u524d\u7f6e\n    @AfterReturning \u540e\u7f6e\n    @Around \u73af\u7ed5\n    @AfterThrowing \u629b\u51fa\u5f02\u5e38\n    @After \u6700\u7ec8\n3. \u6700\u540e\u8fd8\u8981\u914d\u7f6e\uff1a\n    <aop:aspectj-autoproxy></aop:aspectj-autoproxy>\n*/\n\n// \u63a5\u53e3\uff1a\npublic interface UserService {\n    public void addUser();\n    public String updateUser();\n}\n// \u5b9e\u73b0\u7c7b\uff1a\n@Service\npublic class UserServiceImpl implements UserService {\n    @Override\n    public void addUser() {\n        System.out.println("d_aspectj.a_xml addUser()");\n    }\n    @Override\n    public String updateUser() {\n        System.out.println("d_aspectj.a_xml updateUser()");\n        //int i = 1/ 0;\n        return "xxxx";\n    }\n}\n// \u5207\u9762\u7c7b\uff1a\n/**\n * \u5207\u9762\u7c7b\uff0c\u5b9a\u4e49\u9700\u8981\u901a\u77e5\uff0c\u4e4b\u540e\u9700\u8981\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u786e\u5b9a\u5177\u4f53\u901a\u77e5\u7c7b\u578b\n */\n@Component //\u5207\u9762\u7c7b\u4e0d\u5c5e\u4e8e\u4efb\u4f55\u5c42\uff0c\u6240\u4ee5\u7528\u901a\u7528\u7684\u6ce8\u89e3\n@Aspect    //\u8868\u793a\u6b64\u7c7b\u662f\u5207\u9762\u7c7b\npublic class MyAspect{\n\n    //\u5b9a\u4e49\u53ef\u590d\u7528\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u4f7f\u7528@Pointcut\u3002\u5176\u4ed6\u589e\u5f3a\u5185\u5bb9\u65b9\u6cd5\u7684\u6ce8\u89e3\u76f4\u63a5\u8c03\u7528\u65b9\u6cd5\u540dmyPointCut() eg\uff1a@before("myPointCut()")\n    @Pointcut("execution(* com.xiaoyu.spring.learn.*.*(..))")\n    private void myPointCut(){}\n\n    //  \u8fd9\u4e2a\u6ce8\u89e3\u53ea\u6709\u4e00\u4e2a\u5c5e\u6027value="",\u53ef\u4ee5\u7701\u7565\u5c5e\u6027\u540dvalue\uff0c\u76f4\u63a5\u5199\u503c\n    //@Before("execution(* com.xiaoyu.spring.learn.*.*(..))")\n    public void myBefore(JoinPoint joinPoint){\n        System.out.println("\u524d\u7f6e\u901a\u77e5 :" + joinPoint.getSignature().getName());\n    }\n\n    //\u8fd9\u4e2a\u6ce8\u89e3\u6709\u591a\u4e2a\u5c5e\u6027\uff0c\u4e0d\u80fd\u7701\u7565\u5c5e\u6027\u540d\n    //@AfterReturning(value="execution(* com.xiaoyu.spring.learn.*.*(..))",returning="ret")\n    public void myAfterReturning(JoinPoint joinPoint,Object ret){\n        System.out.println("\u540e\u7f6e\u901a\u77e5\uff1a" + joinPoint.getSignature().getName() + " , " + ret);\n    }\n\n    //\u8fd9\u91cc\u7684\u6ce8\u89e3\u76f4\u63a5\u8c03\u7528\u4e86\u53ef\u590d\u7528\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u76f4\u63a5\u8c03\u7528\u5bf9\u5e94\u7684\u65b9\u6cd5\n    //@Around("myPointCut()")\n    public Object myAround(ProceedingJoinPoint joinPoint) throws Throwable{\n        System.out.println("\u73af\u7ed5\u524d");\n        //\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n        Object obj = joinPoint.proceed();\n        System.out.println("\u73af\u7ed5\u540e");\n        return obj;\n    }\n\n    //\u6ce8\u89e3\u8c03\u7528\u7684\u662f\u53ef\u590d\u7528\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\n    //@AfterThrowing(value="myPointCut()",throwing="e")\n    public void myAfterThrowing(JoinPoint joinPoint, Throwable e){\n        System.out.println("\u629b\u51fa\u5f02\u5e38\u901a\u77e5\uff1a" + joinPoint.getSignature().getName() + " , " + e.getMessage());\n    }\n\n    @After("myPointCut()")\n    public void myAfter(JoinPoint joinPoint){\n        System.out.println("\u6700\u7ec8"+ joinPoint.getSignature().getName() );\n    }\n}\n// \u6d4b\u8bd5\uff1a\n//\u8981\u5f15\u5165spring-test\u7684jar\u5305\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations="classpath:config/beans.xml")\npublic class TestAnno {\n    @Autowired\n    private UserService userService;\n    @Test\n    public void demo01(){\n        userService.addUser();\n        userService.updateUser();\n    }\n}\n\n')),(0,o.kt)("p",null,"\u4e3a\u4e86\u8ba9\u6ce8\u89e3\u751f\u6548, \u9700\u8981\u914d\u7f6e\u6ce8\u89e3\u626b\u63cf"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:aop="http://www.springframework.org/schema/aop"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/aop\n                           http://www.springframework.org/schema/aop/spring-aop.xsd\n                           http://www.springframework.org/schema/context\n                           http://www.springframework.org/schema/context/spring-context.xsd">\n\n    \x3c!-- 1.1 \u7528\u6ce8\u89e3\u6807\u8bc6\u76ee\u6807\u7c7b\n            @Service      // service\u5c42\u6ce8\u89e3\n            public class UserServiceImpl\n    --\x3e\n    \x3c!-- 1.2 \u4e3a\u4e86\u8ba9\u6dfb\u52a0\u6ce8\u89e3\u7c7b\u751f\u6548\uff0c\u5fc5\u987b\u5f00\u542f\u5305\u626b\u63cf\u3002\u9700\u8981context\u547d\u540d\u7a7a\u95f4 --\x3e\n    <context:component-scan base-package="com.xiaoyu.spring.learn"></context:component-scan>\n    \x3c!-- 2 \u4f7f\u7528\u6ce8\u89e3\n        @Component  // \u5207\u9762\u7c7b\u4e0d\u5c5e\u4e8e\u4efb\u4f55\u5c42\uff0c\u4f7f\u7528\u901a\u7528\u6ce8\u89e3\n        public class MyAspect{\n    --\x3e\n    \x3c!-- 3\n        3.1 <aop:aspect ref="myAspectId">\n            @Component      \u5207\u9762\u7c7b\u4e0d\u5c5e\u4e8e\u4efb\u4f55\u5c42\n            @Aspect        \u6807\u8bc6\u5207\u9762\u7c7b\uff08\u8868\u793a\u8ba9\u5207\u9762\u7c7b\u6210\u4e3a\u5207\u9762\uff09\n            public class MyAspect{\n        3.2 \u786e\u5b9a\u901a\u77e5\n            \u524d\u7f6e\u901a\u77e5\n                @Before("\u5207\u5165\u70b9\u8868\u8fbe\u5f0f")  \u7b49\u6548\n                <aop:before method="\u65b9\u6cd5\u540d\u79f0" pointcut="\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"/>\n            \u540e\u7f6e\u901a\u77e5\n                @AfterReturning(value="\u8868\u8fbe\u5f0f",returning="\u53c2\u65702\u540d\u79f0")\n            \u73af\u7ed5\n                @Around("myPointCut()")\n            \u629b\u51fa\u5f02\u5e38\n                @AfterThrowing(value="myPointCut()",throwing="\u53c2\u65702\u540d\u79f0")\n            \u6700\u7ec8\n                @After("myPointCut()")\n        3.3 \u58f0\u660e\u516c\u5171\u5207\u5165\u70b9\u8868\u8fbe\u5f0f(\u53ef\u4ee5\u590d\u7528)\n            @Pointcut("execution(* com.itheima.d_aspectj.b_annotation.*.*(..))")\n            private void myPointCut(){}\n    --\x3e\n    \x3c!-- \u6807\u660e\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1aspectj \u5fc5\u987b\u8fdb\u884c\u7684\u914d\u7f6e --\x3e\n    <aop:aspectj-autoproxy></aop:aspectj-autoproxy>\n</beans>\n\n')),(0,o.kt)("h1",{id:"9-jdbc"},"9. JDBC"),(0,o.kt)("p",null,"references: ",(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/fysuccess/article/details/66972554"},"1")),(0,o.kt)("h2",{id:"91-\u6570\u636e\u5e93\u8fde\u63a5\u6c60"},"9.1. \u6570\u636e\u5e93\u8fde\u63a5\u6c60"),(0,o.kt)("h3",{id:"911-c3p0"},"9.1.1. C3P0"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n  <groupId>c3p0</groupId>\n  <artifactId>c3p0</artifactId>\n  <version>0.9.1.2</version>\n</dependency>\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">\n        <property name="jdbcUrl" value="${jdbc.url}" />\n        <property name="driverClass" value="${jdbc.driverClassName}" />\n        <property name="user" value="${jdbc.username}" />\n        <property name="password" value="${jdbc.password}" />\n        \x3c!--\u8fde\u63a5\u6c60\u4e2d\u4fdd\u7559\u7684\u6700\u5927\u8fde\u63a5\u6570\u3002Default: 15 --\x3e\n        <property name="maxPoolSize" value="100" />\n        \x3c!--\u8fde\u63a5\u6c60\u4e2d\u4fdd\u7559\u7684\u6700\u5c0f\u8fde\u63a5\u6570\u3002--\x3e\n        <property name="minPoolSize" value="1" />\n        \x3c!--\u521d\u59cb\u5316\u65f6\u83b7\u53d6\u7684\u8fde\u63a5\u6570\uff0c\u53d6\u503c\u5e94\u5728minPoolSize\u4e0emaxPoolSize\u4e4b\u95f4\u3002Default: 3 --\x3e\n        <property name="initialPoolSize" value="10" />\n        \x3c!--\u6700\u5927\u7a7a\u95f2\u65f6\u95f4,60\u79d2\u5185\u672a\u4f7f\u7528\u5219\u8fde\u63a5\u88ab\u4e22\u5f03\u3002\u82e5\u4e3a0\u5219\u6c38\u4e0d\u4e22\u5f03\u3002Default: 0 --\x3e\n        <property name="maxIdleTime" value="30" />\n        \x3c!--\u5f53\u8fde\u63a5\u6c60\u4e2d\u7684\u8fde\u63a5\u8017\u5c3d\u7684\u65f6\u5019c3p0\u4e00\u6b21\u540c\u65f6\u83b7\u53d6\u7684\u8fde\u63a5\u6570\u3002Default: 3 --\x3e\n        <property name="acquireIncrement" value="5" />\n        \x3c!--JDBC\u7684\u6807\u51c6\u53c2\u6570\uff0c\u7528\u4ee5\u63a7\u5236\u6570\u636e\u6e90\u5185\u52a0\u8f7d\u7684PreparedStatements\u6570\u91cf\u3002Default: 0--\x3e\n        <property name="maxStatements" value="0" />\n        \x3c!--\u6bcf60\u79d2\u68c0\u67e5\u6240\u6709\u8fde\u63a5\u6c60\u4e2d\u7684\u7a7a\u95f2\u8fde\u63a5\u3002Default: 0 --\x3e\n        <property name="idleConnectionTestPeriod" value="60" />\n        \x3c!--\u5b9a\u4e49\u5728\u4ece\u6570\u636e\u5e93\u83b7\u53d6\u65b0\u8fde\u63a5\u5931\u8d25\u540e\u91cd\u590d\u5c1d\u8bd5\u7684\u6b21\u6570\u3002Default: 30 --\x3e\n        <property name="acquireRetryAttempts" value="30" />\n        \x3c!--\u83b7\u53d6\u8fde\u63a5\u5931\u8d25\u5c06\u4f1a\u5f15\u8d77\u6240\u6709\u7b49\u5f85\u8fde\u63a5\u6c60\u6765\u83b7\u53d6\u8fde\u63a5\u7684\u7ebf\u7a0b\u629b\u51fa\u5f02\u5e38\u3002Default: false--\x3e\n        <property name="breakAfterAcquireFailure" value="true" />\n        \x3c!--\u56e0\u6027\u80fd\u6d88\u8017\u5927\u8bf7\u53ea\u5728\u9700\u8981\u7684\u65f6\u5019\u4f7f\u7528\u5b83\u3002Default: false --\x3e\n        <property name="testConnectionOnCheckout"  value="false" />\n    </bean>\n')),(0,o.kt)("h3",{id:"912-dbcp"},"9.1.2. DBCP"),(0,o.kt)("p",null,"\u5f15\u5165 jar"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n  <groupId>commons-dbcp</groupId>\n  <artifactId>commons-dbcp</artifactId>\n  <version>1.4</version>\n</dependency>\n<dependency>\n  <groupId>commons-collections</groupId>\n  <artifactId>commons-collections</artifactId>\n  <version>3.2.2</version>\n</dependency>\n<dependency>\n  <groupId>commons-pool</groupId>\n  <artifactId>commons-pool</artifactId>\n  <version>1.6</version>\n</dependency>\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">\n       <property name="driverClassName" value="${jdbc.driverClassName}"/>\n       <property name="url" value="${jdbc.url}"/>\n       <property name="username" value="${jdbc.username}"/>\n       <property name="password" value="${jdbc.password}"/>\n       \x3c!-- \u6c60\u542f\u52a8\u65f6\u521b\u5efa\u7684\u8fde\u63a5\u6570\u91cf --\x3e\n       <property name="initialSize" value="5"/>\n       \x3c!-- \u540c\u4e00\u65f6\u95f4\u53ef\u4ee5\u4ece\u6c60\u5206\u914d\u7684\u6700\u591a\u8fde\u63a5\u6570\u91cf\u3002\u8bbe\u7f6e\u4e3a0\u65f6\u8868\u793a\u65e0\u9650\u5236\u3002 --\x3e\n       <property name="maxActive" value="50"/>\n       \x3c!-- \u6c60\u91cc\u4e0d\u4f1a\u88ab\u91ca\u653e\u7684\u6700\u591a\u7a7a\u95f2\u8fde\u63a5\u6570\u91cf\u3002\u8bbe\u7f6e\u4e3a0\u65f6\u8868\u793a\u65e0\u9650\u5236\u3002 --\x3e\n       <property name="maxIdle" value="10"/>\n       \x3c!-- \u5728\u4e0d\u65b0\u5efa\u8fde\u63a5\u7684\u6761\u4ef6\u4e0b\uff0c\u6c60\u4e2d\u4fdd\u6301\u7a7a\u95f2\u7684\u6700\u5c11\u8fde\u63a5\u6570\u3002 --\x3e\n       <property name="minIdle" value="3"/>\n       \x3c!-- \u8bbe\u7f6e\u81ea\u52a8\u56de\u6536\u8d85\u65f6\u8fde\u63a5 --\x3e\n       <property name="removeAbandoned" value="true" />\n       \x3c!-- \u81ea\u52a8\u56de\u6536\u8d85\u65f6\u65f6\u95f4(\u4ee5\u79d2\u6570\u4e3a\u5355\u4f4d) --\x3e\n       <property name="removeAbandonedTimeout" value="200"/>\n       \x3c!-- \u8bbe\u7f6e\u5728\u81ea\u52a8\u56de\u6536\u8d85\u65f6\u8fde\u63a5\u7684\u65f6\u5019\u6253\u5370\u8fde\u63a5\u7684\u8d85\u65f6\u9519\u8bef  --\x3e\n       <property name="logAbandoned" value="true"/>\n       \x3c!-- \u7b49\u5f85\u8d85\u65f6\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff0c\u5728\u629b\u51fa\u5f02\u5e38\u4e4b\u524d\uff0c\u6c60\u7b49\u5f85\u8fde\u63a5\u88ab\u56de\u6536\u7684\u6700\u957f\u65f6\u95f4\uff08\u5f53\u6ca1\u6709\u53ef\u7528\u8fde\u63a5\u65f6\uff09\u3002\u8bbe\u7f6e\u4e3a-1\u8868\u793a\u65e0\u9650\u7b49\u5f85\u3002--\x3e\n       <property name="maxWait" value="100"/>\n     </bean>\n')),(0,o.kt)("h3",{id:"913-druid"},"9.1.3. Druid"),(0,o.kt)("p",null,"\u6570\u636e\u6e90\u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource" init-method="init" destroy-method="close">\n        \x3c!-- \u57fa\u672c\u5c5e\u6027 url\u3001user\u3001password --\x3e\n        <property name="url" value="${jdbc.url}" />\n        <property name="username" value="${jdbc.username}" />\n        <property name="password" value="${jdbc.password}" />\n        \x3c!-- \u914d\u7f6e\u521d\u59cb\u5316\u5927\u5c0f\u3001\u6700\u5c0f\u3001\u6700\u5927 --\x3e\n        <property name="initialSize" value="1" />\n        <property name="minIdle" value="1" />\n        <property name="maxActive" value="20" />\n        \x3c!-- \u914d\u7f6e\u83b7\u53d6\u8fde\u63a5\u7b49\u5f85\u8d85\u65f6\u7684\u65f6\u95f4 --\x3e\n        <property name="maxWait" value="60000" />\n        \x3c!-- \u914d\u7f6e\u95f4\u9694\u591a\u4e45\u624d\u8fdb\u884c\u4e00\u6b21\u68c0\u6d4b\uff0c\u68c0\u6d4b\u9700\u8981\u5173\u95ed\u7684\u7a7a\u95f2\u8fde\u63a5\uff0c\u5355\u4f4d\u662f\u6beb\u79d2 --\x3e\n        <property name="timeBetweenEvictionRunsMillis" value="60000" />\n        \x3c!-- \u914d\u7f6e\u4e00\u4e2a\u8fde\u63a5\u5728\u6c60\u4e2d\u6700\u5c0f\u751f\u5b58\u7684\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u6beb\u79d2 --\x3e\n        <property name="minEvictableIdleTimeMillis" value="300000" />\n        \x3c!-- \u6253\u5f00PSCache\uff0c\u5e76\u4e14\u6307\u5b9a\u6bcf\u4e2a\u8fde\u63a5\u4e0aPSCache\u7684\u5927\u5c0f --\x3e\n        <property name="poolPreparedStatements" value="true" />\n        <property name="maxPoolPreparedStatementPerConnectionSize" value="20" />\n        \x3c!-- \u914d\u7f6e\u76d1\u63a7\u7edf\u8ba1\u62e6\u622a\u7684filters\uff0c\u53bb\u6389\u540e\u76d1\u63a7\u754c\u9762sql\u65e0\u6cd5\u7edf\u8ba1 --\x3e\n        <property name="filters" value="stat" />\n    </bean>\n')),(0,o.kt)("p",null,"web.xml \u4e2d\u7684\u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!--druid WebStatFilter\u7528\u4e8e\u91c7\u96c6web-jdbc\u5173\u8054\u76d1\u63a7\u7684\u6570\u636e--\x3e\n      <filter>\n        <filter-name>DruidWebStatFilter</filter-name>\n        <filter-class>com.alibaba.druid.support.http.WebStatFilter</filter-class>\n        <init-param>\n          <param-name>exclusions</param-name>\n          <param-value>*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*</param-value>\n        </init-param>\n      </filter>\n      <filter-mapping>\n        <filter-name>DruidWebStatFilter</filter-name>\n        <url-pattern>/*</url-pattern>\n      </filter-mapping>\n      \x3c!--druid\u8bbf\u95ee\u76d1\u63a7\u754c\u9762 /druid/index.html--\x3e\n      <servlet>\n        <servlet-name>DruidStatView</servlet-name>\n        <servlet-class>com.alibaba.druid.support.http.StatViewServlet</servlet-class>\n      </servlet>\n      <servlet-mapping>\n        <servlet-name>DruidStatView</servlet-name>\n        <url-pattern>/druid/*</url-pattern>\n      </servlet-mapping>\n")),(0,o.kt)("h3",{id:"914-bonecp"},"9.1.4. BoneCP"),(0,o.kt)("p",null,"\u5f15\u5165 jar"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n  <groupId>com.jolbox</groupId>\n  <artifactId>bonecp-spring</artifactId>\n  <version>0.8.0.RELEASE</version>\n</dependency>\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- BoneCp Datasource --\x3e\n<bean id="dataSourceBoneCp" class="com.jolbox.bonecp.BoneCPDataSource" destroy-method="close">\n <property name="driverClass" value="${db.driverClass}" />\n <property name="jdbcUrl" value="${db.url}" />\n <property name="username" value="${db.username}" />\n <property name="password" value="${db.password}" />\n <property name="idleConnectionTestPeriodInMinutes" value="2" />\n <property name="idleMaxAgeInMinutes" value="2" />\n <property name="maxConnectionsPerPartition" value="2" />\n <property name="minConnectionsPerPartition" value="0" />\n <property name="partitionCount" value="2" />\n <property name="acquireIncrement" value="1" />\n <property name="statementsCacheSize" value="100" />\n <property name="lazyInit" value="true"/>\n <property name="maxConnectionAgeInSeconds" value="20"/>\n <property name="defaultReadOnly" value="true"/>\n</bean>\n')),(0,o.kt)("h3",{id:"915-hikaricp"},"9.1.5. HikariCP"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- Hikari Datasource --\x3e\n<bean id="dataSourceHikari" class="com.zaxxer.hikari.HikariDataSource"  destroy-method="shutdown">\n \x3c!-- <property name="driverClassName" value="${db.driverClass}" /> --\x3e \x3c!-- \u65e0\u9700\u6307\u5b9a\uff0c\u9664\u975e\u7cfb\u7edf\u65e0\u6cd5\u81ea\u52a8\u8bc6\u522b --\x3e\n <property name="jdbcUrl" value="jdbc:mysql://localhost:3306/test?useUnicode=true&characterEncoding=UTF-8" />\n <property name="username" value="${db.username}" />\n <property name="password" value="${db.password}" />\n  \x3c!-- \u8fde\u63a5\u53ea\u8bfb\u6570\u636e\u5e93\u65f6\u914d\u7f6e\u4e3atrue\uff0c \u4fdd\u8bc1\u5b89\u5168 --\x3e\n <property name="readOnly" value="false" />\n \x3c!-- \u7b49\u5f85\u8fde\u63a5\u6c60\u5206\u914d\u8fde\u63a5\u7684\u6700\u5927\u65f6\u957f\uff08\u6beb\u79d2\uff09\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u957f\u8fd8\u6ca1\u53ef\u7528\u7684\u8fde\u63a5\u5219\u53d1\u751fSQLException\uff0c \u7f3a\u7701:30\u79d2 --\x3e\n <property name="connectionTimeout" value="30000" />\n \x3c!-- \u4e00\u4e2a\u8fde\u63a5idle\u72b6\u6001\u7684\u6700\u5927\u65f6\u957f\uff08\u6beb\u79d2\uff09\uff0c\u8d85\u65f6\u5219\u88ab\u91ca\u653e\uff08retired\uff09\uff0c\u7f3a\u7701:10\u5206\u949f --\x3e\n <property name="idleTimeout" value="600000" />\n \x3c!-- \u4e00\u4e2a\u8fde\u63a5\u7684\u751f\u547d\u65f6\u957f\uff08\u6beb\u79d2\uff09\uff0c\u8d85\u65f6\u800c\u4e14\u6ca1\u88ab\u4f7f\u7528\u5219\u88ab\u91ca\u653e\uff08retired\uff09\uff0c\u7f3a\u7701:30\u5206\u949f\uff0c\u5efa\u8bae\u8bbe\u7f6e\u6bd4\u6570\u636e\u5e93\u8d85\u65f6\u65f6\u957f\u5c1130\u79d2\uff0c\u53c2\u8003MySQL wait_timeout\u53c2\u6570\uff08show variables like \'%timeout%\';\uff09 --\x3e\n <property name="maxLifetime" value="1800000" />\n \x3c!-- \u8fde\u63a5\u6c60\u4e2d\u5141\u8bb8\u7684\u6700\u5927\u8fde\u63a5\u6570\u3002\u7f3a\u7701\u503c\uff1a10\uff1b\u63a8\u8350\u7684\u516c\u5f0f\uff1a((core_count * 2) + effective_spindle_count) --\x3e\n <property name="maximumPoolSize" value="15" />\n</bean>\n')),(0,o.kt)("h2",{id:"92-jdbctemplate"},"9.2. JdbcTemplate"),(0,o.kt)("h3",{id:"921-quickstart"},"9.2.1. quickstart"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"jar \u5305: spring-jdbc, spring-tx, \u6570\u636e\u5e93\u9a71\u52a8, \u8fde\u63a5\u6c60 jar")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public class TestJDBCTemplate {\n\n    @Test\n    public void test1() {\n\n        // JDBC\u6a21\u677f\u4f9d\u8d56\u4e8e\u8fde\u63a5\u6c60\u6765\u83b7\u5f97\u6570\u636e\u7684\u8fde\u63a5\uff0c\u6240\u4ee5\u5fc5\u987b\u5148\u8981\u6784\u9020\u8fde\u63a5\u6c60\n        DriverManagerDataSource dataSource = new DriverManagerDataSource();\n        dataSource.setDriverClassName("com.mysql.jdbc.Driver");\n        dataSource.setUrl("jdbc:mysql://localhost:3306/spring");\n        dataSource.setUsername("root");\n        dataSource.setPassword("123456");\n\n        // \u521b\u5efaJDBC\u6a21\u677f\n        JdbcTemplate jdbcTemplate = new JdbcTemplate();\n        // \u8fd9\u91cc\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\n        jdbcTemplate.setDataSource(dataSource);\n\n        // sql\u8bed\u53e5\n        String sql = "select count(*)  from user";\n        Long num = (long) jdbcTemplate.queryForObject(sql, Long.class);\n\n        System.out.println(num);\n\n    }\n\n}\n')),(0,o.kt)("p",null,"\u4f7f\u7528 spring \u7684\u7279\u6027\u540e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xmlns:context="http://www.springframework.org/schema/context"\n    xmlns:aop="http://www.springframework.org/schema/aop"\n    xmlns:tx="http://www.springframework.org/schema/tx"\n    xsi:schemaLocation="http://www.springframework.org/schema/beans\n    http://www.springframework.org/schema/beans/spring-beans.xsd\n    http://www.springframework.org/schema/context\n    http://www.springframework.org/schema/context/spring-context.xsd\n    http://www.springframework.org/schema/aop\n    http://www.springframework.org/schema/aop/spring-aop.xsd\n    http://www.springframework.org/schema/tx\n    http://www.springframework.org/schema/tx/spring-tx.xsd">\n\n    \x3c!-- IOC\u548cDI\u7684\u6ce8\u89e3\u626b\u63cf --\x3e\n    <context:component-scan base-package="com.spring" ></context:component-scan>\n\n    \x3c!-- \u6253\u5f00AOP\u7684\u6ce8\u89e3 --\x3e\n    <aop:aspectj-autoproxy></aop:aspectj-autoproxy>\n    \x3c!-- c3p0\u6570\u636e\u6e90 --\x3e\n    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" >\n        <property name="jdbcUrl" value="jdbc:mysql://localhost:3306/spring_03"></property>\n        <property name="driverClass" value="com.mysql.jdbc.Driver"></property>\n        <property name="user" value="root"></property>\n        <property name="password" value="123456"></property>\n    </bean>\n\n    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n\n    <bean id="userDao" class="com.spring.dao.UserDao">\n        <property name="jdbcTemplate" ref="jdbcTemplate"></property>\n    </bean>\n\n    <bean id="userService" class="com.spring.service.UserService">\n        <property name="userDao" ref="userDao"></property>\n    </bean>\n\n</beans>\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public class UserDao {\n\n    private JdbcTemplate jdbcTemplate;\n\n    public JdbcTemplate getJdbcTemplate() {\n        return jdbcTemplate;\n    }\n\n    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {\n        this.jdbcTemplate = jdbcTemplate;\n    }\n\n    public void addUser(User user) {\n\n        String sql = "insert into user (username, password) values (?, ?)";\n\n        jdbcTemplate.update(sql, user.getUsername(), user.getPassword());\n\n    }\n\n}\n')),(0,o.kt)("h3",{id:"922-dao-\u5b9e\u73b0\u7c7b\u7ee7\u627f-jdbcdaosupport-\u652f\u6301\u7c7b"},"9.2.2. Dao \u5b9e\u73b0\u7c7b\u7ee7\u627f JdbcDaoSupport \u652f\u6301\u7c7b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// User:\npublic class User {\n    private Integer id;\n    private String username;\n    private String password;\n    getter&setter\n}\n// UserDao :\nimport org.springframework.jdbc.core.support.JdbcDaoSupport;\npublic class UserDao extends JdbcDaoSupport {\n    //\u7ee7\u627f\u4e86JdbcDaoSupport\u5de5\u5177\u7c7b\uff0c\u7701\u7565\u5982\u4e0b\u4ee3\u7801\uff0c\u76f8\u5e94\u914d\u7f6e\u8981\u66f4\u6539\n//  private JdbcTemplate jdbcTemplate;\n//  public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {\n//      this.jdbcTemplate = jdbcTemplate;\n//  }\n\n    public List<User> findAll(){\n        return getJdbcTemplate().query("select * from t_user", ParameterizedBeanPropertyRowMapper.newInstance(User.class));\n    }\n\n}\n// \u6d4b\u8bd5\uff1a\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations="classpath:config/beans.xml")\npublic class TestSupport {\n        @Autowired\n        @Qualifier("userDaoId")\n        private UserDao userDao;\n        @Test\n        public void demo01(){\n            List<User> findAll = userDao.findAll();\n            for (User user : findAll) {\n                System.out.println(user);\n            }\n        }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    \x3c!-- \u914d\u7f6e\u6570\u636e\u6e90 c3p0 --\x3e\n    <bean id="dataSourceId" class="com.mchange.v2.c3p0.ComboPooledDataSource">\n        <property name="driverClass" value="com.mysql.jdbc.Driver"></property>\n        <property name="jdbcUrl" value="jdbc:mysql:///spring_day02_db"></property>\n        <property name="user" value="root"></property>\n        <property name="password" value="1234"></property>\n    </bean>\n\n    \x3c!--\u8fd9\u91cc\u5220\u9664\u4e86JdbcTemplate\u7684bean--\x3e\n\n    \x3c!-- dao , \u5c06\u6570\u636e\u6e90DataSource \u6ce8\u5165\u7ed9dao\uff0cdao\u6ca1\u6709\u76f8\u5173\u5c5e\u6027\uff0c\u5c31\u7ed9\u5b83\u7684\u7236\u7c7b JdbcDaoSupport\uff0c\u800cJdbcDaoSupport\u5e95\u5c42\u4f7f\u7528\u6570\u636e\u6e90\u521b\u5efa\u4e86Jdbc\u6a21\u677f --\x3e\n    <bean id="userDaoId" class="com.itheima.e_jdbc.d_support.UserDao">\n        <property name="dataSource" ref="dataSourceId"></property>\n    </bean>\n</beans>\n\n')),(0,o.kt)("h3",{id:"923-\u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u653e\u5165-properties-\u6587\u4ef6"},"9.2.3. \u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u653e\u5165 Properties \u6587\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/context\n                           http://www.springframework.org/schema/context/spring-context.xsd">\n    \x3c!-- \u52a0\u8f7dproperties\u6587\u4ef6 --\x3e\n    <context:property-placeholder location="classpath:config/jdbc.properties"/>\n\n    \x3c!-- \u914d\u7f6e\u6570\u636e\u6e90 c3p0\uff0c\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u5185\u5bb9   ${key} --\x3e\n    <bean id="dataSourceId" class="com.mchange.v2.c3p0.ComboPooledDataSource">\n        <property name="driverClass" value="${jdbc.driverClass}"></property>\n        <property name="jdbcUrl" value="${jdbc.jdbcUrl}"></property>\n        <property name="user" value="${jdbc.user}"></property>\n        <property name="password" value="${jdbc.password}"></property>\n    </bean>\n\n    \x3c!-- dao , \u5c06\u6570\u636e\u6e90DataSource \u6ce8\u5165\u7ed9dao\u7236\u7c7b JdbcDaoSupport\uff0c\u5e95\u5c42\u4f7f\u7528\u6570\u636e\u6e90\u521b\u5efa\u6a21\u677f --\x3e\n    <bean id="userDaoId" class="com.itheima.e_jdbc.e_properties.UserDao">\n        <property name="dataSource" ref="dataSourceId"></property>\n    </bean>\n</beans>\n\n')),(0,o.kt)("p",null,"properties \u6587\u4ef6\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"jdbc.driverClass=com.mysql.jdbc.Driver\njdbc.jdbcUrl=jdbc:mysql:///spring_day02_db\njdbc.user=root\njdbc.password=1234\n")),(0,o.kt)("h1",{id:"10-\u4e8b\u52a1\u7ba1\u7406"},"10. \u4e8b\u52a1\u7ba1\u7406"),(0,o.kt)("h2",{id:"101-\u4e8b\u52a1\u5b9e\u73b0\u539f\u7406"},"10.1. \u4e8b\u52a1\u5b9e\u73b0\u539f\u7406"),(0,o.kt)("p",null,"Java \u4e2d\u6211\u4eec\u5e73\u65f6\u7528\u7684\u6700\u591a\u7684\u5c31\u662f\u5728 service \u5c42\u7684\u589e\u5220\u6539\u65b9\u6cd5\u4e0a\u6dfb\u52a0@Transactional \u6ce8\u89e3\uff0c\u8ba9 spring \u53bb\u5e2e\u6211\u4eec\u7ba1\u7406\u4e8b\u52a1\u3002"),(0,o.kt)("p",null,"\u5e95\u5c42\u4f1a\u7ed9\u6211\u4eec\u7684 service \u7ec4\u4ef6\u751f\u6210\u4e00\u4e2a\u5bf9\u5e94\u7684 proxy \u52a8\u6001\u4ee3\u7406\uff0c\u8fd9\u6837\u6240\u6709\u5bf9 service \u7ec4\u4ef6\u7684\u65b9\u6cd5\u90fd\u7531\u5b83\u5bf9\u5e94\u7684 proxy \u6765\u63a5\u7ba1\uff0c\u5f53 proxy \u5728\u8c03\u7528\u5bf9\u5e94\u4e1a\u52a1\u65b9\u6cd5\u6bd4\u5982 add()\u65f6\uff0cproxy \u5c31\u4f1a\u57fa\u4e8e AOP \u7684\u601d\u60f3\u5728\u8c03\u7528\u771f\u6b63\u7684\u4e1a\u52a1\u65b9\u6cd5\u524d\u6267\u884c setAutoCommit\uff08false\uff09\u6253\u5f00\u4e8b\u52a1\u3002"),(0,o.kt)("p",null,"\u7136\u540e\u5728\u4e1a\u52a1\u65b9\u6cd5\u6267\u884c\u5b8c\u540e\u6267\u884c commit \u63d0\u4ea4\u4e8b\u52a1\uff0c\u5f53\u5728\u6267\u884c\u4e1a\u52a1\u65b9\u6cd5\u7684\u8fc7\u7a0b\u4e2d\u53d1\u751f\u5f02\u5e38\u65f6\u5c31\u4f1a\u6267\u884c rollback \u6765\u56de\u6eda\u4e8b\u52a1\u3002"),(0,o.kt)("h2",{id:"103-\u4e8b\u52a1\u76f8\u5173-api"},"10.3. \u4e8b\u52a1\u76f8\u5173 api"),(0,o.kt)("p",null,"\u4e09\u4e2a\u9876\u7ea7\u63a5\u53e3(\u89c4\u8303)"),(0,o.kt)("p",null,"\u6d89\u53ca\u5230\u7684 jar: spring-tx, spring-jdbc, orm \u7684 jar"),(0,o.kt)("h3",{id:"1031-platformtransactionmanager"},"10.3.1. PlatformTransactionManager"),(0,o.kt)("p",null,"spring dao \u4f7f\u7528\u4e0d\u540c\u6280\u672f\uff0c\u9700\u8981\u7684\u4e8b\u52a1\u7ba1\u7406\u5668\u4e0d\u540c\u3002JDBC \u4e8b\u52a1\u7ba1\u7406\u5668\uff1aDataSourceTransactionManager, Hibernate \u4e8b\u52a1\u7ba1\u7406\u5668\uff1aHibernateTransactionManager"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"// \u4e8b\u52a1\u72b6\u6001 \u9700\u8981\u901a\u8fc7 \u201c\u4e8b\u52a1\u8be6\u60c5\u201d\u7684\u914d\u7f6e\uff0c\u4ece\u800c\u83b7\u5f97\u4e8b\u52a1\u72b6\u6001\uff0c\u901a\u8fc7\u72b6\u6001\u7ef4\u62a4\u4e8b\u52a1\u3002\nTransactionStatus getTransaction(TransactionDefinition definition);\nconn.setAutocommit(false) // jdbc\u5f00\u542f\u4e8b\u52a1\ncommit(TransactionStatus) //\u63d0\u4ea4\u4e8b\u52a1\nsession.beginTransaction() //hibernate\u5f00\u542f\u4e8b\u52a1\nrollback(TransactionStatus) //\u56de\u6eda\u4e8b\u52a1\n\n")),(0,o.kt)("h3",{id:"1032-transactionstatus"},"10.3.2. TransactionStatus"),(0,o.kt)("p",null,"\u4e8b\u52a1\u72b6\u6001\uff0c\u4e00\u822c\u662f spring \u5e95\u5c42\u81ea\u52a8\u4f7f\u7528"),(0,o.kt)("h3",{id:"1033-\u4f7f\u7528-jdbc-\u64cd\u4f5c\u4e8b\u52a1"},"10.3.3. \u4f7f\u7528 jdbc \u64cd\u4f5c\u4e8b\u52a1"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"// \u67d0\u4e2a\u4e8b\u52a1, \u5305\u62ecABCD \u56db\u4e2a\u6b65\u9aa4(\u4e00\u4e2a\u6574\u4f53\u4e8b\u52a1)\nConnection conn = null;\ntry{\n    // \u83b7\u5f97\u8fde\u63a5\n    conn = \u8fde\u63a5\u6c60\n    //#1 \u5f00\u542f\u4e8b\u52a1, \u624b\u52a8\u63d0\u4ea4\n    conn.setAutocommit(false);\n\n    A\n    B\n    C\n    D\n\n} catch(){\n    //#2 \u56de\u6eda\u4e8b\u52a1\n    conn.rollback();\n} finally{\n    //#3 \u63d0\u4ea4\u4e8b\u52a1\n    conn.commit();\n\n    //\u91ca\u653e\u8d44\u6e90\n}\n\n//--Savepoint \uff08\u4fdd\u5b58\u70b9/\u56de\u6eda\u70b9\uff09\n// \u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d, AB\uff08\u5fc5\u9009\uff09\uff0cCD\uff08\u53ef\u9009\uff09\nConnection conn = null;\nSavepoint savepoint = null;\ntry{\n    // \u83b7\u5f97\u8fde\u63a5\n    conn = \u8fde\u63a5\u6c60\n    //#1 \u5f00\u542f\u4e8b\u52a1, \u8bbe\u7f6e\u624b\u52a8\u63d0\u4ea4\n    conn.setAutocommit(false);\n\n    A\n    B\n\n    //#2 \u8bbe\u7f6e\u56de\u6eda\u70b9\n    savepoint = conn.setSavepoint();\n\n    C\n    D\n\n} catch(){\n    if(savepoint != null){\n        // savepoint \u4e0d\u4e3a\u7a7a, \u8bc1\u660e AB\u6210\u529f\uff0cCD\u5f02\u5e38\n        // \u56de\u6eda\u5230CD\u4e4b\u524d\n        conn.rollback(savepoint);\n    } else {\n        // AB\u5f02\u5e38\uff0c\u56de\u6eda\u5230\u5f00\u59cb\n        conn.rollback();\n    }\n} finally{\n    //#4 \u63d0\u4ea4\u4e8b\u52a1\n    conn.commit();\n\n    //\u91ca\u653e\u8d44\u6e90\n}\n\n\n")),(0,o.kt)("h2",{id:"104-\u4e8b\u52a1\u76f8\u5173\u6848\u4f8b-\u8f6c\u8d26"},"10.4. \u4e8b\u52a1\u76f8\u5173\u6848\u4f8b-\u8f6c\u8d26"),(0,o.kt)("h3",{id:"1041-\u51c6\u5907"},"10.4.1. \u51c6\u5907"),(0,o.kt)("p",null,"\u4f9d\u8d56:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"spring-core, spring-beans, spring-context, spring-context-support, (spring-web)"),(0,o.kt)("li",{parentName:"ul"},"spring-test"),(0,o.kt)("li",{parentName:"ul"},"spring-jdbc, spring-tx"),(0,o.kt)("li",{parentName:"ul"},"aop \u8054\u76df\u89c4\u8303\u63a5\u53e3, spring-aop(spring \u5b9e\u73b0); aspectj \u89c4\u8303\u63a5\u53e3, spring-aspect(spring \u5b9e\u73b0);"),(0,o.kt)("li",{parentName:"ul"},"\u6570\u636e\u5e93\u9a71\u52a8, \u8fde\u63a5\u6c60")),(0,o.kt)("p",null,"\u6ca1\u6709\u4e8b\u52a1\u7684\u4ee3\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'AccountDao\u63a5\u53e3\uff1a\npublic interface AccountDao {\n    /**\n     * \u6c47\u6b3e\n     * @param outer \u6c47\u6b3e\u4eba\n     * @param money\n     */\n    public void out(String outer , int money);\n    /**\n     * \u6536\u6b3e\n     * @param inner \u6536\u6b3e\u6536\u6b3e\u4eba\n     * @param money\n     */\n    public void in(String inner , int money);\n\n}\nAccountDao\u5b9e\u73b0\uff1a\npublic class AccountDaoImpl extends JdbcDaoSupport implements AccountDao {\n    @Override\n    public void out(String outer, int money) {\n        this.getJdbcTemplate().update("update account set money = money - ? where username = ?", money,outer);\n    }\n    @Override\n    public void in(String inner, int money) {\n        this.getJdbcTemplate().update("update account set money = money + ? where username = ?", money,inner);\n    }\n}\nAccountService\u63a5\u53e3\uff1a\npublic interface AccountService {\n    /**\n     * \u8f6c\u8d26\n     * @param outer \u6c47\u6b3e\u4eba\n     * @param inner \u6536\u6b3e\u4eba\n     * @param mo\n     */\n    public void transfer(String outer,String inner,int money);\n\n}\nAccountService\u5b9e\u73b0\uff1a\npublic class AccountServiceImpl implements AccountService {\n    private AccountDao accountDao;\n    public void setAccountDao(AccountDao accountDao) {\n        this.accountDao = accountDao;\n    }\n    @Override\n    public void transfer(String outer, String inner, int money) {\n        //\u4e24\u4e2a\u64cd\u4f5c\n        accountDao.out(outer, money);\n        // \u6a21\u62df\u65ad\u7535\n        //int i = 1/0;\n        accountDao.in(inner, money);\n    }\n}\n\n\u6d4b\u8bd5\uff1a\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations="classpath:applicationContext.xml")\npublic class TestApp {\n    @Autowired\n    private AccountService accountService;\n    @Test\n    public void demo01(){\n        accountService.transfer("jack", "rose", 100);\n    }\n\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    \x3c!-- 1.\u6570\u636e\u6e90 --\x3e\n    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">\n        <property name="driverClass" value="com.mysql.jdbc.Driver"></property>\n        <property name="jdbcUrl" value="jdbc:mysql:///spring_day03_db"></property>\n        <property name="user" value="root"></property>\n        <property name="password" value="1234"></property>\n    </bean>\n    \x3c!-- 2.dao\uff0c\u6570\u636e\u6e90\u914d\u7f6e\u7ed9dao--\x3e\n    <bean id="accountDao" class="com.itheima.dao.impl.AccountDaoImpl">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n    \x3c!-- 3.service--\x3e\n    <bean id="accountService" class="com.itheima.service.impl.AccountServiceImpl">\n        <property name="accountDao" ref="accountDao"></property>\n    </bean>\n</beans>\n\n')),(0,o.kt)("h3",{id:"1042-\u624b\u52a8\u5f00\u53d1\u4e8b\u52a1"},"10.4.2. \u624b\u52a8\u5f00\u53d1\u4e8b\u52a1"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'Dao\u63a5\u53e3\uff1a\npublic interface AccountDao {\n    /**\n     * \u6c47\u6b3e\n     * @param outer \u6c47\u6b3e\u4eba\n     * @param money\n     */\n    public void out(String outer , int money);\n    /**\n     * \u6536\u6b3e\n     * @param inner \u6536\u6b3e\u6536\u6b3e\u4eba\n     * @param money\n     */\n    public void in(String inner , int money);\n}\nDao\u5b9e\u73b0\u7c7b\uff1a\nimport org.springframework.jdbc.core.support.JdbcDaoSupport;\nimport com.itheima.dao.AccountDao;\npublic class AccountDaoImpl extends JdbcDaoSupport implements AccountDao {\n    @Override\n    public void out(String outer, int money) {\n        this.getJdbcTemplate().update("update account set money = money - ? where username = ?", money,outer);\n    }\n    @Override\n    public void in(String inner, int money) {\n        this.getJdbcTemplate().update("update account set money = money + ? where username = ?", money,inner);\n    }\n}\nService\u63a5\u53e3\uff1a\npublic interface AccountService {\n    /**\n     * \u8f6c\u8d26\n     * @param outer \u6c47\u6b3e\u4eba\n     * @param inner \u6536\u6b3e\u4eba\n     * @param mo\n     */\n    public void transfer(String outer,String inner,int money);\n}\nservice\u5b9e\u73b0\u7c7b\uff1a\npublic class AccountServiceImpl implements AccountService {\n    private AccountDao accountDao;\n    public void setAccountDao(AccountDao accountDao) {\n        this.accountDao = accountDao;\n    }\n    private TransactionTemplate transactionTemplate;\n    public void setTransactionTemplate(TransactionTemplate transactionTemplate) {\n        this.transactionTemplate = transactionTemplate;\n    }\n    @Override   //\u624b\u52a8\u5c06\u53c2\u6570\u6539\u6210final\u7684\uff1b\n    public void transfer(final String outer, final String inner, final int money) {\n        transactionTemplate.execute(new TransactionCallbackWithoutResult() {//\u6ca1\u6709\u8fd4\u56de\u7ed3\u679c\u7684\u4e8b\u52a1\u56de\u8c03\u5bf9\u8c61\uff0c\u533f\u540d\u5185\u90e8\u7c7b\n            @Override\n            public void doInTransactionWithoutResult(TransactionStatus ts) {//\u4e1a\u52a1\u4ee3\u7801\n                //\u4e24\u4e2a\u64cd\u4f5c\n                accountDao.out(outer, money);\n                // \u6a21\u62df\u65ad\u7535\n                //int i = 1/0;\n                accountDao.in(inner, money);\n            }\n        });\n    }\n}\n\u6d4b\u8bd5\uff1a\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations="classpath:applicationContext.xml")\npublic class TestApp {\n    @Autowired\n    private AccountService accountService;\n    @Test\n    public void demo01(){\n        accountService.transfer("jack", "rose", 100);\n    }\n}\n\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    \x3c!-- 1.\u6570\u636e\u6e90\uff0c\u8fde\u63a5\u6c60 --\x3e\n    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">\n        <property name="driverClass" value="com.mysql.jdbc.Driver"></property>\n        <property name="jdbcUrl" value="jdbc:mysql:///spring"></property>\n        <property name="user" value="root"></property>\n        <property name="password" value="1234"></property>\n    </bean>\n    \x3c!-- 2.dao--\x3e\n    <bean id="accountDao" class="com.xiaoyu.spring.learn.AccountDaoImpl">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n    \x3c!-- 3.service--\x3e\n    <bean id="accountService" class="com.xiaoyu.spring.learn.AccountServiceImpl">\n        <property name="accountDao" ref="accountDao"></property>\n        <property name="transactionTemplate" ref="transactionTemplate"></property>\n    </bean>\n    \x3c!-- 4 \u521b\u5efa\u6a21\u677f\uff0c\u9700\u8981\u6ce8\u5165txManager --\x3e\n    <bean id="transactionTemplate" class="org.springframework.transaction.support.TransactionTemplate">\n        <property name="transactionManager" ref="txManager"></property>\n    </bean>\n    \x3c!-- 5 \u914d\u7f6e\u4e8b\u52a1\u7ba1\u7406\u5668,\u9700\u8981Connection\u8fde\u63a5\uff0c\u8fde\u63a5\u4ece\u8fde\u63a5\u6c60 --\x3e\n    <bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n</beans>\n\n')),(0,o.kt)("h3",{id:"1043-\u534a\u81ea\u52a8\u4e8b\u52a1\u751f\u6210\u4ee3\u7406"},"10.4.3. \u534a\u81ea\u52a8\u4e8b\u52a1(\u751f\u6210\u4ee3\u7406)"),(0,o.kt)("p",null,"\u4ee3\u7801\u65e0\u9700\u6539\u52a8, \u5c31\u662f\u6ca1\u6709\u4e8b\u52a1\u7684\u4ee3\u7801"),(0,o.kt)("p",null,"\u4e3b\u8981\u4fee\u6539\u914d\u7f6e\u6587\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\u914d\u7f6e\uff1a\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    \x3c!-- 1.\u6570\u636e\u6e90 --\x3e\n    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">\n        <property name="driverClass" value="com.mysql.jdbc.Driver"></property>\n        <property name="jdbcUrl" value="jdbc:mysql:///spring"></property>\n        <property name="user" value="root"></property>\n        <property name="password" value="1234"></property>\n    </bean>\n    \x3c!-- 2.dao--\x3e\n    <bean id="accountDao" class="com.xiaoyu.spring.learn.AccountDaoImpl">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n    \x3c!-- 3.service--\x3e\n    <bean id="accountService" class="com.xiaoyu.spring.learn.service.impl.AccountServiceImpl">\n        <property name="accountDao" ref="accountDao"></property>\n    </bean>\n    \x3c!-- 4 \u624b\u52a8\u4ee3\u7406\n    * TransactionProxyFactoryBean \u751f\u4ea7\u4e00\u4e2a\u5177\u6709\u4e8b\u52a1\u7ba1\u7406\u80fd\u529b\u7684\u4ee3\u7406\u7c7b\u3002\n    ** 1) \u63d0\u4f9b\u4e8b\u52a1\u7ba1\u7406\uff0c\u7ba1\u7406\u4e8b\u52a1 \uff1atransactionManager\n    ** 2) \u63a5\u53e3\uff1aproxyInterfaces\n    ** 3) \u76ee\u6807\u7c7b\uff1atarget\n    ** 4) \u4e8b\u52a1\u8be6\u60c5\uff08\u4e8b\u52a1\u5c5e\u6027\uff09\uff1atransactionAttributes ,\u9700\u8981\u7c7b\u578bProperties\n        prop.key : \u7ed9\u6307\u5b9a\u65b9\u6cd5\u914d\u7f6e\u8be6\u60c5\uff0c\u76f4\u63a5\u7f16\u5199\u65b9\u6cd5\u540d\u79f0\u3010\u4e0d\u5e26\uff08\uff09\u3011\u3002\n            \u4f8b\u5982\uff1atransfer \u6307\u5b9a\u65b9\u6cd5\u540d\n        prop.text: \u8be6\u60c5\uff08\u8be6\u60c5\u9700\u8981\u683c\u5f0f\uff09\n            \u683c\u5f0f\uff1aPROPAGATION,ISOLATION,readOnly,-Exception,+Exception\n                \u4f20\u64ad\u884c\u4e3a        \u9694\u79bb\u7ea7\u522b        \u662f\u5426\u53ea\u8bfb    -\u6709\u5f02\u5e38\u5c31\u56de\u6eda     +\u6709\u5f02\u5e38\u4ecd\u7136\u63d0\u4ea4\n        \u4f8b\u5982\uff1a\n            <prop key="transfer">PROPAGATION_REQUIRED,ISOLATION_REPEATABLE_READ</prop>\n                \u4f20\u64ad\u884c\u4e3a\u548c\u9694\u79bb\u7ea7\u522b \u90fd\u662f\u9ed8\u8ba4\n    --\x3e\n    <bean id="proxyService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">\n        <property name="transactionManager" ref="txManager"></property>\n        <property name="proxyInterfaces" value="com.itheima.service.AccountService"></property>\n        <property name="target" ref="accountService"></property>\n        <property name="transactionAttributes">\n            <props>\n                <prop key="transfer">PROPAGATION_REQUIRED,ISOLATION_REPEATABLE_READ</prop>\n            </props>\n        </property>\n    </bean>\n    \x3c!-- 5 \u4e8b\u52a1\u7ba1\u7406\u5668 --\x3e\n    <bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n\n</beans>\n\n')),(0,o.kt)("h3",{id:"1044-\u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e-xml"},"10.4.4. \u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e xml"),(0,o.kt)("p",null,"\u540c\u6837\u4ee3\u7801\u65e0\u9700\u6539\u52a8, \u53ea\u9700\u8bbe\u7f6e\u597d\u914d\u7f6e\u6587\u4ef6"),(0,o.kt)("p",null,'\u914d\u7f6e\u6587\u4ef6\u9700\u8981\u6dfb\u52a0\u7ea6\u675f\nxmlns:aop="',(0,o.kt)("a",{parentName:"p",href:"http://www.springframework.org/schema/aop%22"},'http://www.springframework.org/schema/aop"'),'\nxmlns:tx="',(0,o.kt)("a",{parentName:"p",href:"http://www.springframework.org/schema/tx%22"},'http://www.springframework.org/schema/tx"')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:aop="http://www.springframework.org/schema/aop"\n       xmlns:tx="http://www.springframework.org/schema/tx"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/tx\n                           http://www.springframework.org/schema/tx/spring-tx.xsd\n                           http://www.springframework.org/schema/aop\n                           http://www.springframework.org/schema/aop/spring-aop.xsd">\n\n    \x3c!-- 1.\u6570\u636e\u6e90 --\x3e\n    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">\n        <property name="driverClass" value="com.mysql.jdbc.Driver"></property>\n        <property name="jdbcUrl" value="jdbc:mysql:///spring_day03_db"></property>\n        <property name="user" value="root"></property>\n        <property name="password" value="1234"></property>\n    </bean>\n    \x3c!-- 2.dao--\x3e\n    <bean id="accountDao" class="com.itheima.dao.impl.AccountDaoImpl">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n    \x3c!-- 3.service--\x3e\n    <bean id="accountService" class="com.itheima.service.impl.AccountServiceImpl">\n        <property name="accountDao" ref="accountDao"></property>\n    </bean>\n    \x3c!-- 4 \u4f7f\u7528aop\u8fdb\u884c\u4e8b\u52a1\u7ba1\u7406 --\x3e\n    \x3c!-- 4.1 \u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u9700\u8981\u6ce8\u5165\u6570\u636e\u6e90  --\x3e\n    <bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n    \x3c!-- 4.2 \u914d\u7f6e\u4e8b\u52a1\u8be6\u60c5\uff08\u4e8b\u52a1\u5c5e\u6027\uff09\n    * <tx:advice id="txAdvice" transaction-manager="txManagerd">\n        id \u901a\u77e5\u540d\u79f0\uff0c\u7528\u4e8eaop\u5f15\u7528\n        transaction-manager \u786e\u5b9a\u7ba1\u7406\u5668\n    * <tx:attributes> \u914d\u7f6e\u4e8b\u52a1\u8be6\u60c5\n        * <tx:method name="transfer" ...>\n            * name \uff1a \u76ee\u6807\u5bf9\u8c61\u88ab\u589e\u5f3a\u65b9\u6cd5\uff0c\u4e0d\u5e26\u62ec\u53f7\u3010\u5bf9\u9009\u4e2d\u7684\u5207\u5165\u70b9\u65b9\u6cd5\u4eec\uff0c\u6bcf\u4e2a\u5355\u72ec\u914d\u7f6e\uff0c\u4f8b\u5982\u5177\u4f53\u7684\u8bfb\u5199\u6743\u9650\u3011\n        \u4f8b\u5982\uff1a\n        1. <tx:method name="transfer" propagation="REQUIRED" isolation="DEFAULT"/>\n            \u4f20\u64ad\u884c\u4e3a\uff0c\u9694\u79bb\u7ea7\u522b \u9ed8\u8ba4\n        2. <tx:method name="transfer" propagation="REQUIRED" isolation="DEFAULT" read-only="true"/>\n            \u53ea\u8bfb\n        3\u3002 <tx:method name="transfer" propagation="REQUIRED" isolation="DEFAULT" no-rollback-for="java.lang.ArithmeticException" />\n            \u5982\u679c\u6709 ArithmeticException\u5f02\u5e38 \u4ecd\u63d0\u4ea4\n                rollback-for=""  \u76f8\u5f53\u4e8e  -Exception \u56de\u6eda\n                no-rollback-for="" \u76f8\u5f53\u4e8e +Exception \u63d0\u4ea4\n        * \u65b9\u6cd5\u540d\u79f0\u652f\u6301\u901a\u914d\u7b26*\n            <tx:method name="add*"/>\n            <tx:method name="update*"/>\n            <tx:method name="delete*"/>\n            <tx:method name="find*" read-only="true"/>\n    --\x3e\n    <tx:advice id="txAdvice" transaction-manager="txManager">\n        <tx:attributes>\n            <tx:method name="transfer" propagation="REQUIRED" isolation="DEFAULT" />\n        </tx:attributes>\n    </tx:advice>\n    \x3c!-- 4.3 AOP\u7f16\u7a0b\uff0c\u786e\u5b9a\u5207\u5165\u70b9\uff0c\u5e76\u5c06\u901a\u77e5\u5e94\u7528\u5230\u5207\u5165\u70b9 ## \u5207\u9762\n        * \u65b9\u4fbf\u7406\u89e3\uff1a\n            \u76ee\u6807\u7c7b\uff1aABCD (\u8fde\u63a5\u70b9)\n            \u4f7f\u7528AOP\uff1aABC(\u5207\u5165\u70b9)  ## AOP\u5728\u76ee\u6807\u7684\u65b9\u6cd5\u4e2d\u7b5b\u9009\u3002\n     --\x3e\n    <aop:config>\n        <aop:advisor advice-ref="txAdvice" pointcut="execution(* com.itheima.service..*.*(..))"/>\n    </aop:config>\n</beans>\n\n')),(0,o.kt)("h3",{id:"1045-\u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e\u6ce8\u89e3"},"10.4.5. \u5168\u81ea\u52a8\u4e8b\u52a1\u57fa\u4e8e\u6ce8\u89e3"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'Dao\u63a5\u53e3\uff1a\npublic interface AccountDao {\n    /**\n     * \u6c47\u6b3e\n     * @param outer \u6c47\u6b3e\u4eba\n     * @param money\n     */\n    public void out(String outer , int money);\n    /**\n     * \u6536\u6b3e\n     * @param inner \u6536\u6b3e\u6536\u6b3e\u4eba\n     * @param money\n     */\n    public void in(String inner , int money);\n}\nDao\u5b9e\u73b0\uff1a\nimport org.springframework.jdbc.core.support.JdbcDaoSupport;\nimport com.itheima.dao.AccountDao;\npublic class AccountDaoImpl extends JdbcDaoSupport implements AccountDao {\n    @Override\n    public void out(String outer, int money) {\n        this.getJdbcTemplate().update("update account set money = money - ? where username = ?", money,outer);\n    }\n    @Override\n    public void in(String inner, int money) {\n      this.getJdbcTemplate().update("update account set money=money-? where username=?",money,inner);\n    }\n}\nService\u63a5\u53e3\uff1a\npublic interface AccountService {\n    /**\n     * \u8f6c\u8d26\n     * @param outer \u6c47\u6b3e\u4eba\n     * @param inner \u6536\u6b3e\u4eba\n     * @param mo\n     */\n    public void transfer(String outer,String inner,int money);\n}\nService\u5b9e\u73b0\uff1a\n//\u6ce8\u89e3\u53ef\u52a0\u5728\u7c7b\u4e0a\uff0c\u53ef\u52a0\u5728\u67d0\u4e00\u4e2a\u65b9\u6cd5\u4e0a\n@Transactional(propagation=Propagation.REQUIRED , isolation=Isolation.DEFAULT)\npublic class AccountServiceImpl implements AccountService {\n    private AccountDao accountDao;\n    public void setAccountDao(AccountDao accountDao) {\n        this.accountDao = accountDao;\n    }\n    @Override\n    public void transfer(String outer, String inner, int money) {\n        //\u4e24\u4e2a\u64cd\u4f5c\n        accountDao.out(outer, money);\n        // \u6a21\u62df\u65ad\u7535\n        //int i = 1/0;\n        accountDao.in(inner, money);\n    }\n}\n\u6d4b\u8bd5\uff1a\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations="classpath:applicationContext.xml")\npublic class TestApp {\n    @Autowired\n    private AccountService accountService;\n    @Test\n    public void demo01(){\n        accountService.transfer("jack", "rose", 100);\n    }\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\u914d\u7f6e\uff1a\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"\n    xmlns:tx="http://www.springframework.org/schema/tx"\n    xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\n                           http://www.springframework.org/schema/tx\n                           http://www.springframework.org/schema/tx/spring-tx.xsd\n                           http://www.springframework.org/schema/aop\n                           http://www.springframework.org/schema/aop/spring-aop.xsd">\n\n    \x3c!-- 1.\u6570\u636e\u6e90 --\x3e\n    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">\n        <property name="driverClass" value="com.mysql.jdbc.Driver"></property>\n        <property name="jdbcUrl" value="jdbc:mysql:///spring_day03_db"></property>\n        <property name="user" value="root"></property>\n        <property name="password" value="1234"></property>\n    </bean>\n    \x3c!-- 2.dao --\x3e\n    <bean id="accountDao" class="com.itheima.dao.impl.AccountDaoImpl">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n    \x3c!-- 3.service --\x3e\n    <bean id="accountService" class="com.itheima.service.impl.AccountServiceImpl">\n        <property name="accountDao" ref="accountDao"></property>\n    </bean>\n    \x3c!-- 4.1 \u4e8b\u52a1\u7ba1\u7406\u5668 --\x3e\n    <bean id="txManager"\n        class="org.springframework.jdbc.datasource.DataSourceTransactionManager">\n        <property name="dataSource" ref="dataSource"></property>\n    </bean>\n    \x3c!-- 4.2 \u5c06\u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u4ea4\u4e88spring\uff0c\u65b9\u4fbf\u8fdb\u884c\u6ce8\u89e3\u7684\u4e8b\u52a1\u7ba1\u7406 --\x3e\n    <tx:annotation-driven transaction-manager="txManager" />\n</beans>\n\n')),(0,o.kt)("h1",{id:"11-spring-web-\u5f00\u53d1"},"11. spring web \u5f00\u53d1"),(0,o.kt)("p",null,"\u666e\u901a\u7684 spring \u7a0b\u5e8f\u901a\u8fc7 main \u51fd\u6570\u52a0\u8f7d xml \u5373\u53ef\u5b8c\u6210\u542f\u52a8"),(0,o.kt)("p",null,"web app \u4e0d\u540c:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u9700\u8981\u4f9d\u8d56 spring-web")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring \u5bb9\u5668\u5b58\u5728\u4e8e application \u4f5c\u7528\u57df(ServletContext), \u6240\u6709 servlet \u5171\u4eab")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5728 tomcat \u542f\u52a8\u65f6\u52a0\u8f7d xml \u914d\u7f6e, \u52a0\u8f7d\u65b9\u6848\u6709\u4e09\u79cd"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Filter --\x3e init()"),(0,o.kt)("li",{parentName:"ul"},"Listener --\x3e ServletContextListener","[spring \u9ed8\u8ba4\u4f7f\u7528\u76d1\u542c\u5668\u521d\u59cb\u5316, spring \u901a\u8fc7\u76d1\u542c\u5668\u52a0\u8f7d xml \u4e2d\u7684 ContextLoaderListener]"),(0,o.kt)("li",{parentName:"ul"},"Servlet --\x3e init()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u901a\u8fc7 web \u9879\u76ee\u7684\u521d\u59cb\u5316\u53c2\u6570 \u914d\u7f6e xml \u6587\u4ef6\u4f4d\u7f6e ",(0,o.kt)("inlineCode",{parentName:"p"},"contextConfigLocation"),", \u5982\u679c\u4e0d\u914d\u7f6e, \u9ed8\u8ba4\u52a0\u8f7d\u4f4d\u7f6e\u4e3a",(0,o.kt)("inlineCode",{parentName:"p"},"/WEB-INF/applicationContext.xml")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// UserService\u7c7b\uff1a\npublic class UserService {\n    public void addUser(){\n        System.out.println("addUser");\n    }\n}\n// HelloServlet\uff1a\u6ca1\u6709\u96c6\u6210springmvc\npublic class HelloServlet extends HttpServlet {\n    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        //\u83b7\u5f97spring\u5bb9\u5668\uff0c\n        // 1. ServletContext\u4f5c\u7528\u57df\u83b7\u5f97\u5185\u5bb9\n        // ** \u65b9\u5f0f1\n        ApplicationContext applicationContext = (ApplicationContext)\n                this.getServletContext().getAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE);\n        // **  \u65b9\u5f0f2 \u901a\u8fc7spring\u63d0\u4f9b\u5de5\u5177\u7c7b\u3010\u63a8\u8350\u3011\n        ApplicationContext applicationContext =\n                WebApplicationContextUtils.getWebApplicationContext(this.getServletContext());\n        //2.\u518d\u4ece\u5bb9\u5668\u83b7\u5f97service\n        UserService userService = (UserService) applicationContext.getBean("userService");\n        userService.addUser();\n    }\n    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        this.doGet(request, response);\n    }\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- web.xml\u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<web-app version="2.5"\n    xmlns="http://java.sun.com/xml/ns/javaee"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee\n    http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">\n  \x3c!-- \u914d\u7f6exml\u4f4d\u7f6e --\x3e\n  <context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>classpath:applicationContext.xml</param-value>\n  </context-param>\n  \x3c!-- \u914d\u7f6espring\u76d1\u542c\u5668\uff0c\u52a0\u8f7dxml\u914d\u7f6e\u6587\u4ef6 --\x3e\n  <listener>\n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n  </listener>\n  <servlet>\n    <servlet-name>HelloServlet</servlet-name>\n    <servlet-class>com.xiaoyu.spring.learn.web.servlet.HelloServlet</servlet-class>\n  </servlet>\n  <servlet-mapping>\n    <servlet-name>HelloServlet</servlet-name>\n    <url-pattern>/HelloServlet</url-pattern>\n  </servlet-mapping>\n</web-app>\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- applicationContext.xml\u914d\u7f6e\uff1a --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    <bean id="userService" class="com.xiaoyu.spring.learn.UserService"></bean>\n</beans>\n')),(0,o.kt)("h1",{id:"12-\u51e0\u79cd\u52a0\u8f7d-xml-\u65b9\u5f0f"},"12. \u51e0\u79cd\u52a0\u8f7d xml \u65b9\u5f0f"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public class Client {\n    @Test\n    public void test1() {\n        //\u5f15\u7528\u8d44\u6e90\n        Resource resource = new ClassPathResource("com/xy/xmltest/MyXml.xml");\n        // \u8fd9\u4e2a\u65b9\u6cd5\u8fc7\u65f6\u4e86, \u4e0d\u63a8\u8350\n        XmlBeanFactory factory = new XmlBeanFactory(resource);\n        XmlBean bean = factory.createBean(XmlBean.class);\n        System.out.println(bean);\n    }\n\n    @Test\n    public void test2() {\n        //\u7f16\u8bd1\u8def\u5f84\n        ApplicationContext factory=new ClassPathXmlApplicationContext("com/xy/xmltest/MyXml.xml");\n        // or\n        ApplicationContext factory=new ClassPathXmlApplicationContext(new String[] {"bean1.xml","bean2.xml"});\n        XmlBean bean = factory.getBean(XmlBean.class);\n        System.out.println(bean);\n    }\n\n    @Test\n    public void test3() {\n        //\u6587\u4ef6\u7cfb\u7edf\u7684\u8def\u5f84\n        ApplicationContext factory=new FileSystemXmlApplicationContext("src/com/xy/xmltest/MyXml.xml");\n        // or\n        //\u4f7f\u7528\u4e86  classpath:  \u524d\u7f00,\u4f5c\u4e3a\u6807\u5fd7,  \u8fd9\u6837,FileSystemXmlApplicationContext \u4e5f\u80fd\u591f\u8bfb\u5165classpath\u4e0b\u7684\u76f8\u5bf9\u8def\u5f84\n        ApplicationContext factory=new FileSystemXmlApplicationContext("classpath:appContext.xml");\n        XmlBean bean = factory.getBean(XmlBean.class);\n        System.out.println(bean);\n    }\n\n    @Test\n    public void test4() {\n        // \u9002\u7528\u4e8eWeb\u5de5\u7a0b\u3002\n        ServletContext servletContext = request.getSession().getServletContext();\n        ApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(servletContext );\n    }\n}\n')),(0,o.kt)("h1",{id:"13-spring-\u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f"},"13. spring \u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5de5\u5382\u6a21\u5f0f - BeanFactory, ApplicationContext \u90fd\u662f\u5de5\u5382"),(0,o.kt)("li",{parentName:"ul"},"\u5355\u4f8b - spring \u4e2d\u7684 bean \u6784\u9020\u9ed8\u8ba4\u90fd\u662f\u5355\u4f8b"),(0,o.kt)("li",{parentName:"ul"},"\u4ee3\u7406\u6a21\u5f0f - AOP"),(0,o.kt)("li",{parentName:"ul"},"\u88c5\u9970\u5668\u6a21\u5f0f - \u7c7b\u540d\u4e2d\u542b\u6709 Wrapper \u7684\u7c7b"),(0,o.kt)("li",{parentName:"ul"},"\u6a21\u677f\u6a21\u5f0f - jdbcTemplate, JpaTemplate, RedisTemplate"),(0,o.kt)("li",{parentName:"ul"},"\u89c2\u5bdf\u8005\u6a21\u5f0f - Spring \u4e2d Observer \u6a21\u5f0f\u5e38\u7528\u7684\u5730\u65b9\u662f listener \u7684\u5b9e\u73b0")),(0,o.kt)("h1",{id:"14-spring-bean-\u751f\u547d\u5468\u671f"},"14. spring bean \u751f\u547d\u5468\u671f"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/zrtqsk/p/3735273.html"},"\u8be6\u7ec6\u7684\u987a\u5e8f")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://crossoverjie.top/2018/03/21/spring/spring-bean-lifecycle/"},"https://crossoverjie.top/2018/03/21/spring/spring-bean-lifecycle/"),"\nTODO"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u9996\u5148\u5f53\u7136\u662f\u6784\u9020\u51fd\u6570\u5b9e\u4f8b\u5316 bean, \u8bbe\u7f6e\u5c5e\u6027;")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u7136\u540e\u662f Aware \u8fd9\u7c7b\u63a5\u53e3, \u7528\u4e8e\u5728\u5f53\u524d\u7c7b\u6ce8\u5165\u67d0\u4e2a\u6210\u5458"),(0,o.kt)("p",{parentName:"li"},"(\u5982\u679c\u5b9e\u73b0\u4e86\u8fd9\u7c7b\u63a5\u53e3\u7684\u8bdd, \u4f1a\u6267\u884c\u5bf9\u5e94\u7684\u65b9\u6cd5), \u6bd4\u5982 BeanNameAware.setBeanName(id), BeanFactoryAware.setBeanFactory, ApplicationContextAware.setApplicationContext")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"BeanPostProcessors \u4e2d\u7684\u65b9\u6cd5, postProcessBeforeInitialization ()"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u6ce8\u89e3@PostConstruct \u7684\u65b9\u6cd5"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"InitializingBean.afterPropertiesSet (Bean \u7684\u5168\u90e8\u5c5e\u6027\u8bbe\u7f6e\u6210\u529f\u540e\u6267\u884c\u7684\u521d\u59cb\u5316\u65b9\u6cd5, \u53ea\u6709\u8fd9\u4e00\u4e2a\u65b9\u6cd5)"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"\u6211\u4eec\u81ea\u5b9a\u4e49\u7684 init \u65b9\u6cd5, \u901a\u8fc7 ",(0,o.kt)("inlineCode",{parentName:"li"},"<bean> \u7684 init-method \u5c5e\u6027\u6307\u5b9a")))))))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"BeanPostProcessors \u4e2d\u7684\u65b9\u6cd5, postProcessAfterInitialization (\u662f\u5728 Bean \u521d\u59cb\u5316\u540e\u6267\u884c\u7684\uff0c\u65f6\u673a\u4e0d\u540c )"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"DisposableBean.destroy (\u9500\u6bc1\u524d\u6267\u884c)"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"<bean>\u7684destroy-method"),"\u5c5e\u6027\u6307\u5b9a\u7684\u65b9\u6cd5")))))),(0,o.kt)("h1",{id:"15-\u5e38\u7528\u7684-spring-bean-\u62d3\u5c55\u63a5\u53e3"},"15. \u5e38\u7528\u7684 spring bean \u62d3\u5c55\u63a5\u53e3"),(0,o.kt)("h2",{id:"151-beannameawareapplicationcontextaware-\u548c-beanfactoryaware"},"15.1. BeanNameAware\u3001ApplicationContextAware \u548c BeanFactoryAware"),(0,o.kt)("p",null,'"Aware"\u7684\u610f\u601d\u662f"\u611f\u77e5\u5230\u7684", \u90fd\u6709\u81ea\u5df1 setXXX(xxx) \u65b9\u6cd5\u9700\u8981\u8986\u76d6'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5b9e\u73b0 BeanNameAware \u63a5\u53e3\u7684 Bean\uff0c\u5728 Bean \u52a0\u8f7d\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5230\u8be5 Bean \u7684 id")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5b9e\u73b0 ApplicationContextAware \u63a5\u53e3\u7684 Bean\uff0c\u5728 Bean \u52a0\u8f7d\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5230 Spring \u7684 ApplicationContext\uff0c\u8fd9\u4e2a\u5c24\u5176\u91cd\u8981\uff0cApplicationContext \u662f Spring \u5e94\u7528\u4e0a\u4e0b\u6587\uff0c\u4ece ApplicationContext \u4e2d\u53ef\u4ee5\u83b7\u53d6\u5305\u62ec\u4efb\u610f\u7684 Bean \u5728\u5185\u7684\u5927\u91cf Spring \u5bb9\u5668\u5185\u5bb9\u548c\u4fe1\u606f")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5b9e\u73b0 BeanFactoryAware \u63a5\u53e3\u7684 Bean\uff0c\u5728 Bean \u52a0\u8f7d\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5230\u52a0\u8f7d\u8be5 Bean \u7684 BeanFactory"))),(0,o.kt)("p",null,"\u770b\u770b\u600e\u4e48\u4f7f\u7528"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public class AwareBean implements BeanNameAware, BeanFactoryAware, ApplicationContextAware{\n\n// \u5982\u679cBeanName\u3001ApplicationContext\u3001BeanFactory\u6709\u7528\uff0c\u90a3\u4e48\u5c31\u81ea\u5df1\u5b9a\u4e49\u4e00\u4e2a\u6210\u5458\u53d8\u91cf\u5c06\u5b83\u4eec\u4fdd\u5b58\u4e0b\u6765\uff0c\n// \u5982\u679c\u6ca1\u7528\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u5b9e\u73b0setXXX()\u65b9\u6cd5\uff0c\u7528\u4e00\u4e0bSpring\u6ce8\u5165\u8fdb\u6765\u7684\u53c2\u6570\u5373\u53ef\n\n    private String                     beanName;\n\n    private ApplicationContext        applicationContext;\n\n    private BeanFactory                beanFactory;\n\n    @Override\n    public void setBeanName(String beanName){\n        System.out.println("Enter AwareBean.setBeanName(), beanName = " + beanName + "\\n");\n        this.beanName = beanName;\n    }\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException{\n        System.out.println("Enter AwareBean.setApplicationContext(), applicationContext = " + applicationContext + "\\n");\n        this.applicationContext = applicationContext;\n    }\n\n    @Override\n    public void setBeanFactory(BeanFactory beanFactory) throws BeansException{\n        System.out.println("Enter AwareBean.setBeanFactory(), beanfactory = " + beanFactory + "\\n");\n        this.beanFactory = beanFactory;\n    }\n}\n')),(0,o.kt)("h2",{id:"152-beanpostprocessor-\u63a5\u53e3"},"15.2. BeanPostProcessor \u63a5\u53e3"),(0,o.kt)("p",null,"\u4e0d\u662f\u9488\u5bf9\u5355\u4e00 bean, \u800c\u662f\u9488\u5bf9\u6bcf\u4e2a Bean \u7684\u751f\u6210\u524d\u540e\u505a\u4e00\u4e9b\u903b\u8f91\u64cd\u4f5c, \u6709\u4e24\u4e2a\u65b9\u6cd5, \u8fd9\u4e24\u4e2a\u65b9\u6cd5\u662f\u6709\u8fd4\u56de\u503c\u7684\uff0c\u4e0d\u8981\u8fd4\u56de null \u5426\u5219",(0,o.kt)("inlineCode",{parentName:"p"},"getBean"),"\u7684\u65f6\u5019\u62ff\u4e0d\u5230\u5bf9\u8c61"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"postProcessBeforeInitialization\uff1a\u5728\u521d\u59cb\u5316 Bean \u4e4b\u524d"),(0,o.kt)("li",{parentName:"ul"},"postProcessAfterInitialization\uff1a\u5728\u521d\u59cb\u5316 Bean \u4e4b\u540e")),(0,o.kt)("p",null,"attention: PostProcessorBean \u672c\u8eab\u4e5f\u662f\u4e00\u4e2a Bean, \u4f1a\u5728\u521d\u59cb\u5316\u524d\u540e\u8c03\u7528\u524d\u7f6e\u540e\u7f6e\u65b9\u6cd5"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class MyBeanPostProcessor implements BeanPostProcessor {\n    //\u5b9e\u73b0BeanPostProcessor\u63a5\u53e3\u5fc5\u987b\u5b9e\u73b0\u4e24\u4e2a\u65b9\u6cd5\uff1a\n    //1.\u3010Object postProcessBeforeInitialization(final Object bean, String beanName)\u3011\n    //2.\u3010Object postProcessAfterInitialization(Object bean, String beanName)\u3011\n    @Override\n    public Object postProcessBeforeInitialization(final Object bean, String beanName)\n            throws BeansException {\n        System.out.println("\u521d\u59cb\u5316\u65b9\u6cd5\u524d");\n        // \u751f\u6210\u4ee3\u7406\u5bf9\u8c61 javaweb Proxy--jdk\u52a8\u6001\u4ee3\u7406\uff0c\u524d\u63d0\uff1a\u9700\u8981\u4f7f\u7528\u63a5\u53e3\n        return Proxy.newProxyInstance(\n                MyBeanPostProcessor.class.getClassLoader(),     //\u7c7b\u52a0\u8f7d\u5668\n                bean.getClass().getInterfaces(),                //\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3\n                new InvocationHandler(){                        //\u81ea\u5b9a\u4e49\u5904\u7406\u7c7b\n                    @Override\n                    public Object invoke(\n                            Object proxy,                       //\u4ee3\u7406\u5bf9\u8c61\u3010\u5373\u521b\u5efa\u7684\u52a8\u6001\u4ee3\u7406\u5bf9\u8c61\u3011\n                            Method method,                     //\u5f53\u524d\u6267\u884c\u65b9\u6cd5\n                            Object[] args) throws Throwable {  //\u65b9\u6cd5\u53c2\u6570\n                        String methodName = method.getName();\n                        //\u9700\u8981\u589e\u5f3a\u7684\u65b9\u6cd5\n                        if("addOrder".equals(methodName)){\n                            System.out.println("\u4ee3\u7406\u524d\u9762");\n                            // \u6267\u884c\u76ee\u6807\u7c7b\n                            Object obj = method.invoke(bean/*\u88ab\u4ee3\u7406\u7684\u5bf9\u8c61*/, args/*\u65b9\u6cd5\u53c2\u6570*/);\n                            System.out.println("\u4ee3\u7406\u540e\u9762");\n                            return obj;\n                        }\n                        //\u4e0d\u9700\u8981\u589e\u5f3a\u7684\u65b9\u6cd5\u76f4\u63a5return\n                        return method.invoke(bean, args);\n                    }\n                });\n    }\n\n    @Override\n    public Object postProcessAfterInitialization(Object bean, String beanName)\n            throws BeansException {\n        System.out.println("\u521d\u59cb\u5316\u65b9\u6cd5\u540e");\n        return bean;\n    }\n\n\n}\n\n')),(0,o.kt)("h2",{id:"153-initialingbean-\u548c-disposablebean"},"15.3. InitialingBean \u548c DisposableBean"),(0,o.kt)("p",null,"\u5b9e\u73b0\u8fd9\u4e24\u4e2a\u63a5\u53e3\u4ee5\u5728 bean \u6784\u9020\u524d\u540e\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u4ee3\u7801; \u5404\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u65b9\u6cd5, ",(0,o.kt)("inlineCode",{parentName:"p"},"afterPropertiesSet()"),"\u5728 Bean \u5c5e\u6027(setters())\u90fd\u8bbe\u7f6e\u5b8c\u6bd5\u540e\u8c03\u7528, \u505a\u4e00\u4e9b\u521d\u59cb\u5316\u7684\u5de5\u4f5c, ",(0,o.kt)("inlineCode",{parentName:"p"},"destory()"),"\u5728 Bean \u751f\u547d\u5468\u671f\u7ed3\u675f\u524d\u8c03\u7528 destory()\u65b9\u6cd5\u505a\u4e00\u4e9b\u6536\u5c3e\u5de5\u4f5c"),(0,o.kt)("p",null,"\u4f46\u662f,Spring \u5b98\u65b9\u4e0d\u63a8\u8350\u4f7f\u7528\u4e0a\u9762\u8fd9\u79cd\u65b9\u5f0f;\u56e0\u4e3a\u5b83\u4e0d\u5fc5\u8981\u5730\u5c06\u4ee3\u7801\u8026\u5408\u5230 Spring\u3002\u53e6\u5916\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528@PostConstruct\u6ce8\u89e3\u6216\u6307\u5b9abean\u5b9a\u4e49\u652f\u6301\u7684\u901a\u7528\u65b9\u6cd5;"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u548c xml \u914d\u7f6e ",(0,o.kt)("inlineCode",{parentName:"p"},"init-method"),"\u3001",(0,o.kt)("inlineCode",{parentName:"p"},"destory-method"),"\u4f5c\u7528\u7c7b\u4f3c. InitializingBean \u63a5\u53e3\u3001Disposable \u63a5\u53e3\u5e95\u5c42\u4f7f\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"\u7c7b\u578b\u5f3a\u8f6c.\u65b9\u6cd5\u540d()"),"\u8fdb\u884c\u76f4\u63a5\u65b9\u6cd5\u8c03\u7528\uff0cinit-method\u3001destory-method \u5e95\u5c42\u4f7f\u7528\u53cd\u5c04\uff0c\u524d\u8005\u548c Spring \u8026\u5408\u7a0b\u5ea6\u66f4\u9ad8\u4f46\u6548\u7387\u9ad8\uff0c\u540e\u8005\u89e3\u9664\u4e86\u548c Spring \u4e4b\u95f4\u7684\u8026\u5408\u4f46\u662f\u6548\u7387\u4f4e; \u5e76\u4e14 \u540c\u65f6\u914d\u7f6e\u7684\u60c5\u51b5\u4e0b, \u524d\u8005\u5148\u6267\u884c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u6216\u8005 JSR-250 \u4e3a\u521d\u59cb\u5316\u4e4b\u540e/\u9500\u6bc1\u4e4b\u524d\u65b9\u6cd5\u7684\u6307\u5b9a\u5b9a\u4e49\u4e86\u4e24\u4e2a\u6ce8\u91ca\u7c7b\uff0c\u5206\u522b\u662f @PostConstruct \u548c @PreDestroy;  Java 9 \u540e\u53ef\u80fd\u88ab\u5e9f\u5f03, \u82e5\u8fd8\u60f3\u4f7f\u7528, \u53ef\u4ee5\u5bfc\u5165 javax.annotation-api"),(0,o.kt)("p",{parentName:"li"},"\u8981\u8ba9 JSR-250 \u7684\u6ce8\u91ca\u751f\u6548\uff0c\u9664\u4e86\u5728 Bean \u7c7b\u4e2d\u6807\u6ce8\u8fd9\u4e9b\u6ce8\u91ca\u5916\uff0c\u8fd8\u9700\u8981\u5728 Spring \u5bb9\u5668\u4e2d\u6ce8\u518c\u4e00\u4e2a\u8d1f\u8d23\u5904\u7406\u8fd9\u4e9b\u6ce8\u91ca\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"org.springframework.context.annotation.CommonAnnotationBeanPostProcessor"),", \u65e0\u9700 id; \u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"<context:annotation-config/>")," \u7b80\u5316\u914d\u7f6e --\x3e \u8fdb\u4e00\u6b65\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},'<context:component-scan package="" />')))),(0,o.kt)("h2",{id:"154-factorybean-\u63a5\u53e3"},"15.4. FactoryBean \u63a5\u53e3"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://www.cnblogs.com/davidwang456/p/3688250.html"},"http://www.cnblogs.com/davidwang456/p/3688250.html")),(0,o.kt)("h3",{id:"1541-factorybean-\u89e3\u91ca"},"15.4.1. FactoryBean \u89e3\u91ca"),(0,o.kt)("p",null,"\u662f\u4e00\u4e2a\u7279\u6b8a\u7684 bean, \u800c\u4e0d\u662f\u5de5\u5382\u901a\u8fc7 getObject() \u53ef\u4ee5\u81ea\u5b9a\u4e49\u751f\u6210 bean \u7684\u903b\u8f91"),(0,o.kt)("p",null,"\u7c7b\u4f3c\u5de5\u5382\u6a21\u5f0f, spring \u63d0\u4f9b\u4e86\u4e00\u4e2a\u9876\u7ea7\u5de5\u5382\u63a5\u53e3, \u4f60\u81ea\u5df1\u5b9e\u73b0\u5177\u4f53\u7684\u5de5\u5382 bean;"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u901a\u5e38 Spring \u5bb9\u5668\u52a0\u8f7d\u4e00\u4e2a Bean \u7684\u6574\u4e2a\u8fc7\u7a0b\uff0c\u90fd\u662f\u7531 Spring \u63a7\u5236\u7684, \u5982\u679c\u5b9e\u73b0 FactoryBean \u63a5\u53e3, \u6211\u4eec\u53ef\u4ee5\u66f4\u5927\u7684\u81ea\u4e3b\u6743\u6765\u5b9a\u5236\u5b9e\u4f8b\u5316 bean, \u53ef\u901a\u8fc7 getObject() \u5b9a\u5236\u83b7\u53d6 bean \u7684\u903b\u8f91")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u6839\u636e\u8be5 FactoryBean \u7684 ID \u4ece BeanFactory \u4e2d\u83b7\u53d6\u7684\u5b9e\u9645\u4e0a\u662f FactoryBean \u7684 getObject()\u8fd4\u56de\u7684\u5bf9\u8c61\uff0c\u800c\u4e0d\u662f FactoryBean \u672c\u8eab\uff0c\u5982\u679c\u8981\u83b7\u53d6 FactoryBean \u5bf9\u8c61\uff0c\u8bf7\u5728 id \u524d\u9762\u52a0\u4e00\u4e2a&\u7b26\u53f7\u6765\u83b7\u53d6\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"FactoryBean \u8fd9\u4e2a\u63a5\u53e3\u5728 Spring \u5bb9\u5668\u4e2d\u6709\u5927\u91cf\u7684\u5b50\u5b9e\u73b0\u3002"))),(0,o.kt)("h3",{id:"1542-factorybean-\u63a5\u53e3\u7684-api"},"15.4.2. FactoryBean \u63a5\u53e3\u7684 api"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'T getObject() throws Exception;// context.getBean(id)\u65f6, \u5e95\u5c42\u5c31\u662f\u8c03\u7528\u7684\u8fd9\u4e2a\u65b9\u6cd5, id\u524d\u6dfb\u52a0"&"\u5219\u8fd4\u56de\u7684\u5c31\u662f\u8fd9\u4e2a\u5bf9\u8c61\u7684FactoryBean\nClass<?> getObjectType();\ndefault boolean isSingleton() {return true;}\n\n')),(0,o.kt)("h3",{id:"1543-factorybean-\u7b80\u5355\u7684\u4f7f\u7528\u793a\u4f8b"},"15.4.3. FactoryBean \u7b80\u5355\u7684\u4f7f\u7528\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// \u4e00\u4e2a\u63a5\u53e3\npublic interface Animal{\n    public void move();\n}\n\n// \u4e24\u4e2a\u5b9e\u73b0\u7c7b\npublic class Monkey implements Animal{\n    public void move()\n    {\n        System.out.println("Monkey move!");\n    }\n}\npublic class Tiger implements Animal{\n    public void move(){\n        System.out.println("Tiger move!");\n    }\n}\n\n// FactoryBean\u5b9e\u73b0\npublic class AnimalFactoryBean implements FactoryBean<Animal>{\n    private String    animal;\n\n    // \u6700\u91cd\u8981\u7684\uff0c\u63a7\u5236Bean\u7684\u5b9e\u4f8b\u5316\u8fc7\u7a0b\n    public Animal getObject() throws Exception{\n        if ("Monkey".equals(animal)){\n            return new Monkey();\n        }\n        else if ("Tiger".equals(animal)){\n            return new Tiger();\n        }\n        else{\n            return null;\n        }\n    }\n\n    // \u83b7\u53d6\u63a5\u53e3\u8fd4\u56de\u7684\u5b9e\u4f8b\u7684class\n    public Class<?> getObjectType(){\n        return Animal.class;\n    }\n\n    // \u8be5Bean\u662f\u5426\u4e3a\u4e00\u4e2a\u5355\u4f8b\u7684Bean\n    public boolean isSingleton(){\n        return true;\n    }\n\n    public void setAnimal(String animal){\n        this.animal = animal;\n    }\n}\n\n// \u6d4b\u8bd5\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = {\n        "classpath*:spring.xml",\n})\npublic class BaseTest{\n    @Resource\n    private Animal    animal;\n\n    @Test\n    public void aa(){\n        animal.move(); // \u7ed3\u679c: Tiger move!\n    }\n}\n')),(0,o.kt)("p",null,"\u5f53\u7136\u8fd8\u6709 xml \u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xsi:schemaLocation="http://www.springframework.org/schema/beans\n    http://www.springframework.org/schema/beans/spring-beans-4.1.xsd">\n    \x3c!-- \u6700\u540e\u5f97\u5230\u7684\u5e76\u4e0d\u662fFactoryBean\u672c\u8eab\uff0c\u800c\u662fFactoryBean\u7684\u6cdb\u578b\u5bf9\u8c61tiger --\x3e\n    <bean id="animal" class="org.xrq.bean.factory.AnimalFactoryBean">\n        <property name="animal" value="Tiger"/>\n    </bean>\n</beans>\n')),(0,o.kt)("h3",{id:"1544-factorybean-\u5728-mabatis-spring-\u96c6\u6210\u4e2d\u7684\u5e94\u7528"},"15.4.4. factoryBean \u5728 mabatis-spring \u96c6\u6210\u4e2d\u7684\u5e94\u7528"),(0,o.kt)("p",null,'\u7c7b\u4f3c spring \u4e2d\u7684 "\u9759\u6001\u5de5\u5382\u65b9\u6cd5\u6ce8\u5165"'),(0,o.kt)("p",null,"\u5f88\u591a\u5f00\u6e90\u9879\u76ee\u5728\u96c6\u6210 Spring \u65f6\u90fd\u4f7f\u7528\u5230 FactoryBean\uff0c\u6bd4\u5982 MyBatis3 \u63d0\u4f9b mybatis-spring \u9879\u76ee\u4e2d\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"org.mybatis.spring.SqlSessionFactoryBean"),"\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- spring\u548cMyBatis\u6574\u5408\uff0c\u4e0d\u9700\u8981mybatis\u7684\u914d\u7f6e\u6620\u5c04\u6587\u4ef6 --\x3e\n<bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">\n\n    \x3c!-- property \u5c06\u6ce8\u5165\u6210\u4e3a SqlSessionFactoryBean \u7684\u6210\u5458\u53d8\u91cf --\x3e\n\n    <property name="dataSource" ref="dataSource"/>\n    \x3c!-- \u81ea\u52a8\u626b\u63cfmapping.xml\u6587\u4ef6 --\x3e\n    <property name="mapperLocations" value="classpath:mapper/*.xml"></property>\n</bean>\n\n')),(0,o.kt)("h3",{id:"1545-factorybean-\u6848\u4f8b-dao-\u5207\u6362"},"15.4.5. factoryBean \u6848\u4f8b-dao \u5207\u6362"),(0,o.kt)("p",null,"\u770b\u4e00\u4e2a\u6848\u4f8b: ",(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/ykdsg/article/details/18733041"},"check here")),(0,o.kt)("p",null,"\u7cfb\u7edf\u53d1\u5c55\u5230\u4e00\u5b9a\u7a0b\u5ea6\u5c31\u4f1a\u9762\u4e34\u5206\u5e93\u5206\u8868\u7684\u95ee\u9898\uff0c\u6211\u4eec\u8981\u8003\u8651\u7684\u662f\u600e\u4e48\u8ba9\u7cfb\u7edf\u5e73\u6ed1\u7684\u4ece\u8001\u7684\u8868\u8fc1\u79fb\u5230\u65b0\u7684\u8868\u3002\u901a\u5e38\u65b0\u8868\u7684\u6570\u636e\u53ef\u4ee5\u901a\u8fc7 binlog \u540c\u6b65\u7684\u65b9\u5f0f\u540c\u6b65\u8001\u8868\u7684\u6570\u636e\uff0c\u5728\u67d0\u4e00\u4e2a\u65f6\u95f4\u70b9\u901a\u8fc7\u5f00\u5173\u7684\u65b9\u5f0f\u8ba9\u8bfb\u5199\u8001\u8868\u7684\u64cd\u4f5c\u5207\u6362\u5230\u65b0\u8868\u3002"),(0,o.kt)("p",null,'\u90a3\u8fd9\u91cc\u6709\u4e2a\u95ee\u9898: \u4e3a\u4ec0\u4e48 \u8981\u8bbe\u7f6e\u4e00\u4e2a"\u5f00\u5173" \u6765\u5207\u6362 \u65b0/\u65e7 dao \u5462? \u56e0\u4e3a\u5728\u6570\u636e\u8fc1\u79fb\u8fc7\u7a0b\u4e2d, \u7cfb\u7edf\u4e0d\u591f\u7a33\u5b9a, \u9700\u8981\u968f\u65f6\u5c06 \u65b0 dao \u6362\u56de \u65e7 dao \u4ee5\u4fdd\u8bc1\u7cfb\u7edf\u4e0d\u4f1a\u5d29. \u7b49\u5230\u6570\u636e\u8fc1\u79fb\u5168\u90e8\u5b8c\u6210, \u7cfb\u7edf\u7a33\u5b9a\u4e0b\u6765\u540e, \u53ef\u4ee5\u53bb\u6389\u5f00\u5173, \u76f4\u63a5\u7528 \u65b0 dao \u66ff\u6362\u6389 \u65e7 dao. \u6b64\u65f6\u65e7 dao \u4ee3\u7801 \u7684\u4eba\u751f\u4f7f\u547d \u5c31\u5b8c\u5168\u7ed3\u675f\u4e86.'),(0,o.kt)("p",null,"\u90a3\u4e48\u5177\u4f53\u600e\u4e48\u64cd\u4f5c\u5462 - \u901a\u8fc7 FactoryBean \u751f\u4ea7 \u65e7 dao \u7684\u4ee3\u7406 (\u4f5c\u4e3a \u65b0 dao), \u5728 InvocationHandler \u4e2d\u505a\u5f00\u5173\u7684\u903b\u8f91\u5224\u65ad"),(0,o.kt)("p",null,"\u6ce8\u5165\u7684\u914d\u7f6e\u65f6\u8fd9\u6837\u7684:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<bean id="oldDao" class="com.taobao.misc.auction.repository.ProxyBidRepo"/>\xa0\n<bean id="newDao" class="com.taobao.misc.auction.dao.impl.BidProxyDAOImpl"/>\n\n<bean id="oldDaoProxy" class="com.taobao.misc.auction.dao.impl.ProxyBidDAOProxyFactoryBean"/>\xa0\n\n')),(0,o.kt)("p",null,"\u8fd9\u6837\u7cfb\u7edf\u539f\u6765\u5f15\u7528 bidProxyDAO \u7684\u4ee3\u7801\u90fd\u4e0d\u9700\u8981\u52a8\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6839\u636e\u5f00\u5173\u6765\u5207\u6362\u65b0\u8001 DAO \u7684\u5b9e\u73b0\u3002\u7b49\u7cfb\u7edf\u4e0a\u7ebf\u7a33\u5b9a\u4e4b\u540e\u53ef\u4ee5\u5c06 \u65e7 dao \u5b8c\u5168\u66ff\u6362\u6389"),(0,o.kt)("p",null,"\u4ee3\u7801\u5982\u4e0b:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'/*\n- InvocationHandler - \u4ee3\u7406\u9700\u8981invocationhandler\n- FactoryBean       - \u5b9e\u73b0\u5176 getObject\uff08\uff09 \u65b9\u6cd5; \u5982\u679c\u4e00\u4e2a\u7c7b\u5b9e\u73b0\u4e86FactoryBean\u63a5\u53e3\uff0c\u90a3\u4e48context.getBean\u5f97\u5230\u7684\u4e0d\u662f\u4ed6\u672c\u8eab\u4e86\uff0c\u800c\u662f\u5b83\u6240\u4ea7\u751f\u7684\u5bf9\u8c61,\u5982\u679c\u5e0c\u671b\u5f97\u5230\u5b83\u672c\u8eab\uff0c\u53ea\u9700\u8981\u52a0\u4e0a&\u7b26\u53f7\u5373\u53ef\n*/\npublic class ProxyBidDAOProxyFactoryBean implements InvocationHandler, FactoryBean {\n\xa0\xa0\xa0 private static Logger log =\xa0 LoggerFactory.getLogger(ProxyBidDAOProxyFactoryBean.class);\n\xa0\xa0\xa0 /**\n\xa0\xa0\xa0\xa0 * \u65b0\u7684dao\n\xa0\xa0\xa0\xa0 */\n\xa0\xa0\xa0 @Resource\n\xa0\xa0\xa0 private BidProxyDAO bidProxyDAONew;\n\xa0\xa0\xa0 /**\n\xa0\xa0\xa0\xa0 * \u8001\u7684dao\n\xa0\xa0\xa0\xa0 */\n\xa0\xa0\xa0 @Resource\n\xa0\xa0\xa0 private BidProxyDAO proxyBidRepo;\n\n\xa0\xa0\xa0 @Resource\n\xa0\xa0\xa0 private DiamondSwitchConfig diamondSwitchConfig;\n\n\n\xa0\xa0\xa0 @Override\n\xa0\xa0\xa0 public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 //\u5982\u679c\u5f00\u5173\u6253\u5f00\u90a3\u4e48\u8c03\u7528\u65b0\u7684DAO\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 if(diamondSwitchConfig.isNewTableSwitch()){\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 log.warn("bid_proxy user new table..........................................");\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 return method.invoke(bidProxyDAONew, args);\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 }\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 return method.invoke(proxyBidRepo, args);\n\xa0\xa0\xa0 }\n\n\xa0\xa0\xa0 @Override\n\xa0\xa0\xa0 public Object getObject() throws Exception {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 Object proxyObj=Proxy.newProxyInstance(this.getClass().getClassLoader(), new Class[]{BidProxyDAO.class}, this);\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 return (BidProxyDAO) proxyObj;\n\xa0\xa0\xa0 }\n\n\xa0\xa0\xa0 @Override\n\xa0\xa0\xa0 public Class getObjectType() {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 return BidProxyDAO.class;\n\xa0\xa0\xa0 }\n\n\xa0\xa0\xa0 @Override\n\xa0\xa0\xa0 public boolean isSingleton() {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 return true;\n\xa0\xa0\xa0 }\n}\xa0\n\n')),(0,o.kt)("h2",{id:"155-beanfactory-\u63a5\u53e3"},"15.5. BeanFactory \u63a5\u53e3"),(0,o.kt)("h3",{id:"1551-beanfactory-\u89e3\u91ca"},"15.5.1. BeanFactory \u89e3\u91ca"),(0,o.kt)("p",null,"\u662f\u4e00\u4e2a\u63a5\u53e3, \u76f8\u5f53\u4e8e\u5bb9\u5668, \u7ba1\u7406\u6240\u6709\u7684 bean, \u5305\u62ec factory bean"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"spring \u63d0\u4f9b\u591a\u4e2a\u5b9e\u73b0, \u5e38\u7528\u7684 XmlBeanFactory")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"BeanFactory \u548c ApplicationContext(\u901a\u8fc7\u524d\u8005\u6d3e\u751f)\u5c31\u662f spring \u6846\u67b6\u7684\u4e24\u4e2a IOC \u5bb9\u5668\uff0c\u73b0\u5728\u4e00\u822c\u4f7f\u7528 ApplicationnContext\uff0c\u5176\u4e0d\u4f46\u5305\u542b\u4e86 BeanFactory \u7684\u4f5c\u7528\uff0c\u540c\u65f6\u8fd8\u8fdb\u884c\u66f4\u591a\u7684\u6269\u5c55\u3002"))),(0,o.kt)("h3",{id:"1552-api-\u6709\u54ea\u4e9b"},"15.5.2. api \u6709\u54ea\u4e9b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"\u3000\u3000boolean containsBean(String beanName) \u5224\u65ad\u5de5\u5382\u4e2d\u662f\u5426\u5305\u542b\u7ed9\u5b9a\u540d\u79f0\u7684bean\u5b9a\u4e49\uff0c\u82e5\u6709\u5219\u8fd4\u56detrue\n\u3000\u3000Object getBean(String) \u8fd4\u56de\u7ed9\u5b9a\u540d\u79f0\u6ce8\u518c\u7684bean\u5b9e\u4f8b\u3002\u6839\u636ebean\u7684\u914d\u7f6e\u60c5\u51b5\uff0c\u5982\u679c\u662fsingleton\u6a21\u5f0f\u5c06\u8fd4\u56de\u4e00\u4e2a\u5171\u4eab\u5b9e\u4f8b\uff0c\u5426\u5219\u5c06\u8fd4\u56de\u4e00\u4e2a\u65b0\u5efa\u7684\u5b9e\u4f8b\uff0c\u5982\u679c\u6ca1\u6709\u627e\u5230\u6307\u5b9abean,\u8be5\u65b9\u6cd5\u53ef\u80fd\u4f1a\u629b\u51fa\u5f02\u5e38\n\u3000\u3000Object getBean(String, Class) \u8fd4\u56de\u4ee5\u7ed9\u5b9a\u540d\u79f0\u6ce8\u518c\u7684bean\u5b9e\u4f8b\uff0c\u5e76\u8f6c\u6362\u4e3a\u7ed9\u5b9aclass\u7c7b\u578b\n\u3000\u3000Class getType(String name) \u8fd4\u56de\u7ed9\u5b9a\u540d\u79f0\u7684bean\u7684Class,\u5982\u679c\u6ca1\u6709\u627e\u5230\u6307\u5b9a\u7684bean\u5b9e\u4f8b\uff0c\u5219\u6392\u9664NoSuchBeanDefinitionException\u5f02\u5e38\n\u3000\u3000boolean isSingleton(String) \u5224\u65ad\u7ed9\u5b9a\u540d\u79f0\u7684bean\u5b9a\u4e49\u662f\u5426\u4e3a\u5355\u4f8b\u6a21\u5f0f\n\u3000\u3000String[] getAliases(String name) \u8fd4\u56de\u7ed9\u5b9abean\u540d\u79f0\u7684\u6240\u6709\u522b\u540d\n\n")),(0,o.kt)("h2",{id:"156-beanfactorypostprocessor"},"15.6. BeanFactoryPostProcessor"),(0,o.kt)("p",null,"\u5728\u6240\u6709\u7684 Bean \u521b\u5efa\u4e4b\u524d\uff0c\u8bfb\u53d6 Bean \u7684\u5143\u5c5e\u6027(Scope \u7b49\u7b49)\uff0c\u5e76\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u5bf9\u5143\u5c5e\u6027\u8fdb\u884c\u6539\u53d8 ---------- \u52a8\u6001\u6ce8\u518c, \u89c1\u4e0b\u6587"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"BeanFactoryPostProcessor \u7684\u6267\u884c\u5148\u4e8e BeanPostProcessor")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"BeanFactoryPostProcessor \u7684 postProcessBeanFactory()\u65b9\u6cd5\u53ea\u4f1a\u6267\u884c\u4e00\u6b21"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'public void postProcessBeanFactory(ConfigurableListableBeanFactory configurablelistablebeanfactory)\n            throws BeansException{\n    BeanDefinition beanDefinition = configurablelistablebeanfactory.getBeanDefinition("common0");\n    MutablePropertyValues beanProperty = beanDefinition.getPropertyValues();\n    System.out.println("scope before change\uff1a" + beanDefinition.getScope());\n    beanDefinition.setScope("singleton");\n    System.out.println("scope after change\uff1a" + beanDefinition.getScope());\n    System.out.println("beanProperty\uff1a" + beanProperty);\n}\n')),(0,o.kt)("h2",{id:"157-instantiationawarebeanpostprocessor"},"15.7. InstantiationAwareBeanPostProcessor"),(0,o.kt)("p",null,"\u7ee7\u627f\u81ea BeanPostProcessor \u63a5\u53e3"),(0,o.kt)("p",null,"bean \u5b9e\u4f8b\u5316\u524d\u540e\u505a\u4e00\u4e9b\u5904\u7406(\u533a\u522b\u4e8e bean \u521d\u59cb\u5316); 1\u3001\u5b9e\u4f8b\u5316----\u5b9e\u4f8b\u5316\u7684\u8fc7\u7a0b\u662f\u4e00\u4e2a\u521b\u5efa Bean \u7684\u8fc7\u7a0b\uff0c\u5373\u8c03\u7528 Bean \u7684\u6784\u9020\u51fd\u6570\uff0c\u5355\u4f8b\u7684 Bean \u653e\u5165\u5355\u4f8b\u6c60\u4e2d. 2\u3001\u521d\u59cb\u5316----\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u662f\u4e00\u4e2a\u8d4b\u503c\u7684\u8fc7\u7a0b\uff0c\u5373\u8c03\u7528 Bean \u7684 setter\uff0c\u8bbe\u7f6e Bean \u7684\u5c5e\u6027"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Bean \u6784\u9020\u51fa\u6765\u4e4b\u524d\u8c03\u7528 postProcessBeforeInstantiation()\u65b9\u6cd5"),(0,o.kt)("li",{parentName:"ul"},"Bean \u6784\u9020\u51fa\u6765\u4e4b\u540e\u8c03\u7528 postProcessAfterInstantiation()\u65b9\u6cd5")),(0,o.kt)("p",null,"\u901a\u5e38\u6765\u8bb2\uff0c\u6211\u4eec\u4e0d\u4f1a\u76f4\u63a5\u5b9e\u73b0 InstantiationAwareBeanPostProcessor \u63a5\u53e3\uff0c\u800c\u662f\u4f1a\u91c7\u7528\u7ee7\u627f InstantiationAwareBeanPostProcessorAdapter \u8fd9\u4e2a\u62bd\u8c61\u7c7b\u7684\u65b9\u5f0f\u6765\u4f7f\u7528\u3002"),(0,o.kt)("h1",{id:"16-\u52a8\u6001\u6ce8\u518c-bean"},"16. \u52a8\u6001\u6ce8\u518c bean"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/neweastsun/article/details/79222256"},"https://blog.csdn.net/neweastsun/article/details/79222256")),(0,o.kt)("h2",{id:"161-\u52a8\u6001\u6ce8\u518c\u573a\u666f"},"16.1. \u52a8\u6001\u6ce8\u518c\u573a\u666f"),(0,o.kt)("p",null,"\u7528\u6237\u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\uff0c\u800c\u63a5\u53e3\u7684\u5b9e\u73b0\u5219\u7531\u6846\u67b6\u751f\u6210\uff0c\u4e0d\u9700\u8981\u7528\u6237\u81ea\u884c\u7f16\u5199\uff0c\u6b64\u65f6\u5b9e\u73b0\u7c7b\u5c31\u9700\u8981\u52a8\u6001\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d"),(0,o.kt)("h2",{id:"162-\u52a8\u6001\u6ce8\u518c-api"},"16.2. \u52a8\u6001\u6ce8\u518c api"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Spring \u4e2d\u7684 bean \u5b9a\u4e49\u90fd\u4fdd\u5b58\u5728 ",(0,o.kt)("strong",{parentName:"p"},"BeanDefinitionRegistry")," \u63a5\u53e3\u4e2d\uff0c\u5355\u4f8b\u7684 bean \u7684\u5b9e\u4f8b\u90fd\u4fdd\u5b58\u5728 ",(0,o.kt)("strong",{parentName:"p"},"SingletonBeanRegistry")," \u63a5\u53e3\u4e2d\u3002"),(0,o.kt)("p",{parentName:"li"},"DefaultListableBeanFactory \u63a5\u53e3\u540c\u65f6\u5b9e\u73b0\u4e86\u8fd9\u4e24\u4e2a\u63a5\u53e3\uff0c\u5728\u5b9e\u8df5\u4e2d\u901a\u5e38\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u63a5\u53e3"),(0,o.kt)("p",{parentName:"li"},"\u8fd9\u79cd\u65b9\u5f0f\u6ce8\u518c\u7684 bean \u6ca1\u6709 aop \u652f\u6301")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u8fd8\u53ef\u4ee5\u901a\u8fc7 BeanFactoryPostProcessor \u8fdb\u884c\u52a8\u6001\u6ce8\u518c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"ImportBeanDefinitionRegistrar \u63a5\u53e3\u4ea6\u53ef"),(0,o.kt)("p",{parentName:"li"},"\u6240\u6709\u5b9e\u73b0\u4e86\u8be5\u63a5\u53e3\u7684\u7c7b\u7684\u90fd\u4f1a\u88ab ConfigurationClassPostProcessor \u5904\u7406\uff0cConfigurationClassPostProcessor \u5b9e\u73b0\u4e86 BeanFactoryPostProcessor \u63a5\u53e3\uff0c\u6240\u4ee5 ImportBeanDefinitionRegistrar \u4e2d\u52a8\u6001\u6ce8\u518c\u7684 bean \u662f\u4f18\u5148\u4e0e\u4f9d\u8d56\u5176\u7684 bean \u521d\u59cb\u5316\u7684\uff0c\u4e5f\u80fd\u88ab aop\u3001validator \u7b49\u673a\u5236\u5904\u7406\u3002"))),(0,o.kt)("h2",{id:"163-\u600e\u4e48\u4f7f\u7528\u52a8\u6001\u6ce8\u518c"},"16.3. \u600e\u4e48\u4f7f\u7528\u52a8\u6001\u6ce8\u518c"),(0,o.kt)("h3",{id:"1631-\u901a\u8fc7-beanfactorypostprocessor-\u5b9e\u73b0\u52a8\u6001\u6ce8\u518c"},"16.3.1. \u901a\u8fc7 BeanFactoryPostProcessor \u5b9e\u73b0\u52a8\u6001\u6ce8\u518c"),(0,o.kt)("p",null,"bean \u4e0d\u662f\u5728 BeanFactoryPostProcessor \u4e2d\u88ab\u6ce8\u518c\uff0c\u90a3\u4e48\u8be5 bean \u5219\u65e0\u6cd5\u88ab",(0,o.kt)("strong",{parentName:"p"},"BeanPostProcessor"),"\u5904\u7406\uff0c\u5373\u65e0\u6cd5\u5bf9\u5176\u5e94\u7528 aop\u3001Bean Validation \u7b49\u529f\u80fd\u3002"),(0,o.kt)("p",null,"BeanDefinitionRegistryPostProcessor"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@component\npublic class PersonBeanFactoryPostProcessor implements BeanFactoryPostProcessor {\n\n    @Override\n    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {\n        DefaultListableBeanFactory defaultListableBeanFactory\n                = (DefaultListableBeanFactory) beanFactory;\n\n        //\u6ce8\u518cBean\u5b9a\u4e49\uff0c\u5bb9\u5668\u6839\u636e\u5b9a\u4e49\u8fd4\u56debean\n        log.info("register personManager1>>>>>>>>>>>>>>>>");\n        // \u6784\u9020bean \u5b9a\u4e49\n        BeanDefinitionBuilder beanDefinitionBuilder =\n                BeanDefinitionBuilder.genericBeanDefinition(PersonManager.class);\n        // \u6784\u9020\u4f9d\u8d56\n        beanDefinitionBuilder.addPropertyReference("personDao", "personDao");\n        BeanDefinition personManagerBeanDefinition = beanDefinitionBuilder.getRawBeanDefinition();\n        // \u6ce8\u518c\n        defaultListableBeanFactory.registerBeanDefinition("personManager1", personManagerBeanDefinition);\n\n        //\u76f4\u63a5\u901a\u8fc7\u7f16\u7a0b\u5f0f\u6ce8\u518cbean\u5b9e\u4f8b\n        log.info("register personManager2>>>>>>>>>>>>>>>>");\n        PersonDao personDao = beanFactory.getBean(PersonDao.class);\n        PersonManager personManager = new PersonManager();\n        personManager.setPersonDao(personDao);\n        beanFactory.registerSingleton("personManager2", personManager);\n\n    }\n}\n\n')),(0,o.kt)("h3",{id:"1632-\u901a\u8fc7-beandefinitionregistry-\u5728\u666e\u901a-bean-\u4e2d\u6ce8\u518c"},"16.3.2. \u901a\u8fc7 BeanDefinitionRegistry \u5728\u666e\u901a bean \u4e2d\u6ce8\u518c"),(0,o.kt)("p",null,"bean \u4e0d\u662f\u5728 BeanFactoryPostProcessor \u4e2d\u88ab\u6ce8\u518c\uff0c\u90a3\u4e48\u8be5 bean \u5219\u65e0\u6cd5\u88ab",(0,o.kt)("strong",{parentName:"p"},"BeanPostProcessor"),"\u5904\u7406\uff0c\u5373\u65e0\u6cd5\u5bf9\u5176\u5e94\u7528 aop\u3001Bean Validation \u7b49\u529f\u80fd\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@RestController\n@Slf4j\npublic class PersonManagerRegisterController {\n\n    /**\n     * The Application context.\n     */\n    @Autowired\n    GenericApplicationContext applicationContext;\n\n    /**\n     * The Bean factory.\n     \u7ee7\u627f\u4e86 SingletonBeanRegistry\n     */\n    @Autowired\n    ConfigurableBeanFactory beanFactory;\n\n    /**\n     * \u52a8\u6001\u6ce8\u518cbean\uff0c\u6b64\u5904\u6ce8\u518c\u7684bean\u6ca1\u6709AOP\u7684\u652f\u6301\n     * curl http://localhost:8080/registerPersonManager\n     */\n    @GetMapping("/registerPersonManager")\n    public void registerPersonManager() {\n        PersonDao personDao = applicationContext.getBean(PersonDao.class);\n        PersonManager personManager = new PersonManager();\n        personManager.setPersonDao(personDao);\n        beanFactory.registerSingleton("personManager3", personManager);\n\n    }\n\n    ...\n\n')),(0,o.kt)("h3",{id:"1633-\u901a\u8fc7-importbeandefinitionregistrar"},"16.3.3. \u901a\u8fc7 ImportBeanDefinitionRegistrar"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/pkpk1234/registerbean-ImportBeanDefinitionRegistrar"},"https://github.com/pkpk1234/registerbean-ImportBeanDefinitionRegistrar")),(0,o.kt)("p",null,"\u9700\u6c42, \u601d\u8def:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'/*\n\u4e3b\u8981\u601d\u8def\u662f\u5229\u7528ClassPathScanningCandidateComponentProvider\u83b7\u53d6\u6807\u6ce8\u4e86HTTPUtil\u6ce8\u89e3\u7684\u63a5\u53e3\uff0c\u5e76\u4f7f\u7528JDK\u52a8\u6001\u4ee3\u7406\u751f\u6210\u4ee3\u7406\u5bf9\u8c61\u3002\n\u7136\u540e\u4f7f\u7528DefaultListableBeanFactory\u5c06\u4ee3\u7406\u5bf9\u8c61\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\n*/\n@Component\n@HTTPUtil\npublic interface IRequestDemo {\n    //\u8c03\u7528test1\u65f6\uff0c\u4f1a\u5bf9http://abc.com\u53d1\u9001get\u8bf7\u6c42\n    @HTTPRequest(url = "http://abc.com")\n    HttpResult<String> test1();\n\n    //\u8c03\u7528test2\u65f6\uff0c\u4f1a\u5bf9http://test2.com\u53d1\u9001post\u8bf7\u6c42\n    @HTTPRequest(url = "http://test2.com", httpMethod = HTTPMethod.POST)\n    HttpResult<String> test2();\n}\n\n')),(0,o.kt)("p",null,"\u5b9e\u73b0:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'// 1. \u9996\u5148\u7f16\u5199\u6838\u5fc3ImportBeanDefinitionRegistrar\u63a5\u53e3\n\n//ImportBeanDefinitionRegistrar\u9700\u8981\u914d\u5408@Configuration\u548c@Import\u6ce8\u89e3\n//@Configuration\u5b9a\u4e49Java\u683c\u5f0f\u7684Spring\u914d\u7f6e\u6587\u4ef6\uff0c@Import\u6ce8\u89e3\u5bfc\u5165\u5b9e\u73b0\u4e86ImportBeanDefinitionRegistrar\u63a5\u53e3\u7684\u7c7b\u3002\n\npublic class HTTPRequestRegistrar implements ImportBeanDefinitionRegistrar,\n       ResourceLoaderAware, BeanClassLoaderAware, EnvironmentAware, BeanFactoryAware {\n   @Override\n   public void registerBeanDefinitions(AnnotationMetadata annotationMetadata, BeanDefinitionRegistry beanDefinitionRegistry) {\n       registerHttpRequest(beanDefinitionRegistry);\n   }\n\n   /**\n    * \u6ce8\u518c\u52a8\u6001bean\u7684\u4e3b\u8981\u65b9\u6cd5\n    *\n    * @param beanDefinitionRegistry\n    */\n   private void registerHttpRequest(BeanDefinitionRegistry beanDefinitionRegistry) {\n       ClassPathScanningCandidateComponentProvider classScanner = getClassScanner();\n       classScanner.setResourceLoader(this.resourceLoader);\n       //\u6307\u5b9a\u53ea\u5173\u6ce8\u6807\u6ce8\u4e86@HTTPUtil\u6ce8\u89e3\u7684\u63a5\u53e3\n       AnnotationTypeFilter annotationTypeFilter = new AnnotationTypeFilter(HTTPUtil.class);\n       classScanner.addIncludeFilter(annotationTypeFilter);\n       //\u6307\u5b9a\u626b\u63cf\u7684\u57fa\u7840\u5305\n       String basePack = "com.example.registerbean";\n       Set<BeanDefinition> beanDefinitionSet = classScanner.findCandidateComponents(basePack);\n       for (BeanDefinition beanDefinition : beanDefinitionSet) {\n           if (beanDefinition instanceof AnnotatedBeanDefinition) {\n               registerBeans(((AnnotatedBeanDefinition) beanDefinition));\n           }\n       }\n   }\n\n   /**\n    * \u521b\u5efa\u52a8\u6001\u4ee3\u7406\uff0c\u5e76\u52a8\u6001\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\n    *\n    * @param annotatedBeanDefinition\n    */\n   private void registerBeans(AnnotatedBeanDefinition annotatedBeanDefinition) {\n       String className = annotatedBeanDefinition.getBeanClassName();\n       ((DefaultListableBeanFactory) this.beanFactory).registerSingleton(className, createProxy(annotatedBeanDefinition));\n   }\n\n   /**\n    * \u6784\u9020Class\u626b\u63cf\u5668\uff0c\u8bbe\u7f6e\u4e86\u53ea\u626b\u63cf\u9876\u7ea7\u63a5\u53e3\uff0c\u4e0d\u626b\u63cf\u5185\u90e8\u7c7b\n    *\n    * @return\n    */\n   private ClassPathScanningCandidateComponentProvider getClassScanner() {\n       return new ClassPathScanningCandidateComponentProvider(false, this.environment) {\n\n           @Override\n           protected boolean isCandidateComponent(\n                   AnnotatedBeanDefinition beanDefinition) {\n               if (beanDefinition.getMetadata().isInterface()) {\n                   try {\n                       Class<?> target = ClassUtils.forName(\n                               beanDefinition.getMetadata().getClassName(),\n                               classLoader);\n                       return !target.isAnnotation();\n                   } catch (Exception ex) {\n                       log.error("load class exception:", ex);\n                   }\n               }\n               return false;\n           }\n       };\n   }\n\n   /**\n    * \u521b\u5efa\u52a8\u6001\u4ee3\u7406\n    *\n    * @param annotatedBeanDefinition\n    * @return\n    */\n   private Object createProxy(AnnotatedBeanDefinition annotatedBeanDefinition) {\n       try {\n           AnnotationMetadata annotationMetadata = annotatedBeanDefinition.getMetadata();\n           Class<?> target = Class.forName(annotationMetadata.getClassName());\n           InvocationHandler invocationHandler = createInvocationHandler();\n           Object proxy = Proxy.newProxyInstance(HTTPRequest.class.getClassLoader(), new Class[]{target}, invocationHandler);\n           return proxy;\n       } catch (ClassNotFoundException e) {\n           log.error(e.getMessage());\n       }\n       return null;\n   }\n\n   /**\n    * \u521b\u5efaInvocationHandler\uff0c\u5c06\u65b9\u6cd5\u8c03\u7528\u5168\u90e8\u4ee3\u7406\u7ed9DemoHttpHandler\n    *\n    * @return\n    */\n   private InvocationHandler createInvocationHandler() {\n       return new InvocationHandler() {\n           private DemoHttpHandler demoHttpHandler = new DemoHttpHandler();\n\n           @Override\n           public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n\n               return demoHttpHandler.handle(method);\n           }\n       };\n   }\n    ... \u7701\u7565setter\u4ee3\u7801\n}\n\n////////////////////////////////////////////////////////////\n\n//2. \u7f16\u5199\u6ce8\u89e3\uff0c\u5e76\u5728\u5176\u4e2d\u4f7f\u7528@Import\u5bfc\u5165\u7b2c1\u6b65\u7f16\u5199\u7684HTTPRequestRegistrar\n//3.\u5c06@EnableHttpUtil\u6dfb\u52a0\u5230@Configuration\u6ce8\u89e3\u4e0b\n\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Import(HTTPRequestRegistrar.class)\npublic @interface EnableHttpUtil {\n}\n\n')),(0,o.kt)("h1",{id:"17-\u56fd\u9645\u5316-and-\u53c2\u6570\u6821\u9a8c"},"17. \u56fd\u9645\u5316 and \u53c2\u6570\u6821\u9a8c"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/shuangyidehudie/article/details/40586143"},"https://blog.csdn.net/shuangyidehudie/article/details/40586143"),"\n",(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/catoop/article/details/51284638"},"https://blog.csdn.net/catoop/article/details/51284638")),(0,o.kt)("h1",{id:"18-spring5-\u65b0\u7279\u6027"},"18. spring5 \u65b0\u7279\u6027"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.ibm.com/developerworks/cn/java/j-whats-new-in-spring-framework-5-theedom/index.html"},"https://www.ibm.com/developerworks/cn/java/j-whats-new-in-spring-framework-5-theedom/index.html")))}d.isMDXComponent=!0}}]);