<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-mongodb-note">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">MongoDB NotesğŸŒˆ - Xiaoyureed çš„ç½‘ç»œ Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xiaoyureed.github.io/en/img/logo.webp"><meta data-rh="true" name="twitter:image" content="https://xiaoyureed.github.io/en/img/logo.webp"><meta data-rh="true" property="og:url" content="https://xiaoyureed.github.io/en/docs/mongodb-note"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="xiaoyureed"><meta data-rh="true" name="keywords" content="blog, java, spring, microservice, python, rust, typescript, react, web"><meta data-rh="true" name="keywords" content=" åŠè·¯è½¬è¡Œçš„ç¼–ç¨‹çˆ±å¥½è€…, å†™è¿‡ Python, Rust, ç°åœ¨ä¸»æ”» Java åˆ†å¸ƒå¼ç³»ç»Ÿ"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MongoDB NotesğŸŒˆ - Xiaoyureed çš„ç½‘ç»œ Wiki"><meta data-rh="true" name="description" content="https://university.mongodb.com/ å®˜æ–¹è¯¾ç¨‹"><meta data-rh="true" property="og:description" content="https://university.mongodb.com/ å®˜æ–¹è¯¾ç¨‹"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xiaoyureed.github.io/en/docs/mongodb-note"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/en/docs/mongodb-note" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/mongodb-note" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/mongodb-note" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5SAMPKXTP9-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Xiaoyureed çš„ç½‘ç»œ Wiki" href="/en/opensearch.xml">


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f6da56a47f5085d1e0fedae39b8de00a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/en/rss.xml" title="xiaoyureed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/atom.xml" title="xiaoyureed Atom Feed">
<link rel="alternate" type="application/json" href="/en/feed.json" title="xiaoyureed JSON Feed">

<link rel="icon" href="/en/img/logo.webp">
<link rel="manifest" href="/en/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)">
<meta name="description" content="Xiaoyureed çš„ä¸ªäººåšå®¢"><link rel="stylesheet" href="/en/assets/css/styles.261d8673.css">
<link rel="preload" href="/en/assets/js/runtime~main.97306ba3.js" as="script">
<link rel="preload" href="/en/assets/js/main.8d84d9e1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><a href="/docs/rust-note" target="_blank">Rust æŒ‡åŒ—, æ¬¢è¿æŸ¥çœ‹...</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">kuizuo</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">èœå•</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/archive">åšå®¢</a></li><li><a class="dropdown__link" href="/en/docs/intro">æ•™ç¨‹</a></li><li><a class="dropdown__link" href="/en/resource">Links</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/en/"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"><b>kuizuo</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/SpringBoot-note">Spring Boot å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/autohotkey">Autohotkey è„šæœ¬</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/blockchain">blockchainåŒºå—é“¾</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/c-sharp-and-dot-net">C# &amp; .NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/chatgpt">Chatgpt Usage Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cpp">CPP and C å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cross-gfw">Cross The GFW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cs-note">Computer Science Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/css-pre-processor">å‡ ç§CSSé¢„å¤„ç†å™¨æ¯”è¾ƒé€‰å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/data-structure-and-algorithm">Data Structure and Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/design-pattern-note">Design Pattern ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/dev-resources">å¼€å‘è€…èµ„æº</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/distributed-system">Distributed System åˆ†å¸ƒå¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/docker-note-virtual-dev-env">Docker Note &amp; Other Virtual Develop Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/effective-java-reading-note">Effective Java é˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/elk-elastic-log">Distributed log collectionåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/english-note">è‹±è¯­å­¦ä¹ ğŸ”¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/extjs-note">Extjs ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/git-note">Git å¤‡å¿˜ ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/golang-note">Golang ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/gps-gis-tracing">åŸºäºåœ°ç†ä½ç½®å¼€å‘æŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/gradle">Gradle note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/greasy-monkey">æ²¹çŒ´æ’ä»¶&amp;ç¼–å†™è„šæœ¬ğŸ’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/groovy-note">groovy note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/health">Health å…³çˆ±ç¨‹åºå‘˜å¥åº·ğŸ¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/how-to-test-java-app">How to Test Java App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/interview-system-design">ç³»ç»Ÿè®¾è®¡ System design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/iot">Iot ç‰©è”ç½‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-code-clean">Java Clean Code Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-concurrent">Java ConcurrentğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-memory-model-jmm-jvm">JMM and GCğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-note">Java Core ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/js-tutorial">JavaScript tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/kotlin">kotlin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/kubernetes-k8s">kubernetes-k8s â˜ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/linux-note">é¸Ÿå“¥çš„ Linux ç§æˆ¿èœé˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/low-code-platform">å…³äºä½ä»£ç å¹³å°çš„è°ƒç ”</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mac">Mac å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/machine-learning-ml">machine-learning-ml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/marketing-seo">Marketing SEO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/maven-note">Maven NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/message-queue">Message QueueğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/money">Investment Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/en/docs/mongodb-note">MongoDB NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/monitor-system-grafana-prometheus-influxdb-hbase-time-serials-database">monitor-system-grafana-prometheusç›‘æ§ğŸ–¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mvc-mvvm">MVC to MVVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mybatis-note">MyBatis Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/netty-note">netty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/nlp-natural-language-processing">nlp-natural-language-processingğŸ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/nodejs-yarn-npm">Nodejs, Yarn, Npm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/oracle">Oracle å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-audio-video">Audio and Video development Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-big-data-introduce">å¤§æ•°æ®å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-cache">Cache ç¼“å­˜ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-computational-ad">è®¡ç®—å¹¿å‘Š Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-crawler-spider">ç½‘ç»œçˆ¬è™« Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-db-design-note">å…³ç³»å‹æ•°æ®åº“è¡¨è®¾è®¡ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-desktop-develop">æ¡Œé¢åº”ç”¨å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-http-restful">HTTP protocol Intro &amp; RESTful</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-reactive-programming">å“åº”å¼ç¼–ç¨‹ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-rpc">RPC Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-rule-engine-note">è§„åˆ™å¼•æ“ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/php-note">PHP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/postgres-note">Postgres noteğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/process-workflow-bpm-engine">å·¥ä½œæµå¼•æ“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/protect-your-app-authentication-oauth2-jwt-https">Protect Your App å®‰å…¨ä¿æŠ¤è®¤è¯é‰´æƒğŸ”‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/python-note">PythonğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/quant-money">é‡åŒ–äº¤æ˜“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/quarkus">Quarkus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/react-note">ReactğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/real-time-communication-protocol">å®æ—¶é€šä¿¡ Real-time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/redis-note">RedisğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/regex">Regular Expression æ­£åˆ™ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/rust-note">Rust ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/scala-akka-play-framework">Scala è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/serverless">Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/service-mesh">service mesh æœåŠ¡ç½‘æ ¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/servlet">Servlet Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/shell-bash-note">shell-bashè„šæœ¬æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/spring-note">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/springcloud-note">Spring Cloud ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/springmvc-note">Spring MVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/task-schedule-note">Task Schedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/tcp-ip-note-p2p">TCP IP, p2p</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/tomcat-jetty-nginx">Tomcat Jetty Nginx ç­‰ web å®¹å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/vertx">Vertx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/video-creator">æ‹æ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/vue">Vue Brief Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/webassembly">webassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/webpack-esbuild-vite-rollup">å‰ç«¯æ‰“åŒ…æ„å»ºå·¥å…·</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">MongoDB NotesğŸŒˆ</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>MongoDB NotesğŸŒˆ</h1></header><div align="center">https://university.mongodb.com/ å®˜æ–¹è¯¾ç¨‹<p><a href="https://mongoing.com/" target="_blank" rel="noopener noreferrer">https://mongoing.com/</a> ä¸­æ–‡ç¤¾åŒº
<a href="https://docs.mongoing.com/" target="_blank" rel="noopener noreferrer">https://docs.mongoing.com/</a> æ–‡æ¡£</p><p><a href="https://www.mongodb.com/cloud" target="_blank" rel="noopener noreferrer">https://www.mongodb.com/cloud</a> å…è´¹ç‰ˆäº‘æœåŠ¡</p><p><a href="https://zhuanlan.zhihu.com/p/24377636" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/24377636</a>
<a href="https://zhuanlan.zhihu.com/p/26483750" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/26483750</a>
<a href="https://www.zhihu.com/question/20059632/answer/14981332" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/20059632/answer/14981332</a>
<a href="https://www.zhihu.com/question/19882468/answer/18329680" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/19882468/answer/18329680</a></p></div><ul><li><a href="#1-what-is-mongodb">1. what is mongodb</a><ul><li><a href="#11-%E7%89%B9%E6%80%A7">1.1. ç‰¹æ€§</a></li><li><a href="#12-%E5%92%8C-mysql-%E6%A6%82%E5%BF%B5%E5%AF%B9%E6%AF%94">1.2. å’Œ MySQL æ¦‚å¿µå¯¹æ¯”</a></li><li><a href="#13-%E5%92%8C-es-%E5%AF%B9%E6%AF%94">1.3. å’Œ es å¯¹æ¯”</a></li><li><a href="#14-rdbms-%E5%92%8C-nosql">1.4. rdbms å’Œ nosql</a></li></ul></li><li><a href="#2-why-mongodb">2. why mongodb</a><ul><li><a href="#21-%E7%89%B9%E7%82%B9">2.1. ç‰¹ç‚¹</a></li><li><a href="#22-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">2.2. ä½¿ç”¨åœºæ™¯</a></li></ul></li><li><a href="#3-how">3. how</a><ul><li><a href="#31-%E5%AE%89%E8%A3%85">3.1. å®‰è£…</a><ul><li><a href="#311-docker-%E5%AE%89%E8%A3%85">3.1.1. docker å®‰è£…</a></li><li><a href="#312-%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%AE%89%E8%A3%85">3.1.2. å‹ç¼©åŒ…å®‰è£…</a></li></ul></li><li><a href="#32-%E4%BD%BF%E7%94%A8">3.2. ä½¿ç”¨</a><ul><li><a href="#321-%E5%92%8C-spring-boot-%E9%9B%86%E6%88%90">3.2.1. å’Œ spring boot é›†æˆ</a></li><li><a href="#322-%E4%BD%BF%E7%94%A8-%E5%91%BD%E4%BB%A4%E8%A1%8C">3.2.2. ä½¿ç”¨ å‘½ä»¤è¡Œ</a></li></ul></li></ul></li><li><a href="#4-%E7%B4%A2%E5%BC%95">4. ç´¢å¼•</a><ul><li><a href="#41-%E7%B4%A2%E5%BC%95%E4%BB%8B%E7%BB%8D">4.1. ç´¢å¼•ä»‹ç»</a></li><li><a href="#42-%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%AD%E6%93%8D%E4%BD%9C%E7%B4%A2%E5%BC%95">4.2. åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œç´¢å¼•</a></li><li><a href="#43-%E7%B4%A2%E5%BC%95%E8%AF%84%E4%BC%B0%E4%BC%98%E5%8C%96">4.3. ç´¢å¼•è¯„ä¼°ä¼˜åŒ–</a></li></ul></li><li><a href="#5-%E5%88%86%E7%89%87%E9%9B%86%E7%BE%A4-shard-cluster">5. åˆ†ç‰‡é›†ç¾¤ Shard Cluster</a><ul><li><a href="#51-%E6%9E%B6%E6%9E%84%E5%9B%BE">5.1. æ¶æ„å›¾</a></li><li><a href="#52-%E5%88%86%E7%89%87%E6%9C%BA%E5%88%B6">5.2. åˆ†ç‰‡æœºåˆ¶</a></li><li><a href="#53-%E5%89%AF%E6%9C%AC%E9%9B%86">5.3. å‰¯æœ¬é›†</a></li><li><a href="#54-mongo-%E4%B8%AD%E7%9A%84-cap-%E6%94%AF%E6%8C%81">5.4. mongo ä¸­çš„ cap æ”¯æŒ</a></li></ul></li></ul><h1>1. what is mongodb</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-ç‰¹æ€§">1.1. ç‰¹æ€§<a href="#11-ç‰¹æ€§" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>åŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”±C++è¯­è¨€ç¼–å†™</p><p>nosql (éå…³ç³»æ•°æ®åº“)</p><p>æ–‡æ¡£å‹ - mongo æœ¬è´¨æ˜¯ key-value å­˜å‚¨, keyéœ€è¦å”¯ä¸€, valueä¼šä»¥jsonçš„å½¢å¼å­˜å‚¨(json çš„ field å¯ä»¥ä¸åŒ), è€Œå…³ç³»å‹é€šè¿‡ä¸€æ¡æ¡è®°å½•(å…·æœ‰ç›¸åŒ column)æ¥å­˜å‚¨æ•°æ®</p><p>é«˜æ€§èƒ½è®¡ç®—ï¼Œæä¾›åŸºäºå†…å­˜çš„å¿«é€Ÿæ•°æ®æŸ¥è¯¢</p><p>å®¹æ˜“æ‰©å±•ï¼Œåˆ©ç”¨æ•°æ®åˆ†ç‰‡å¯ä»¥å®ç°åˆ†å¸ƒå¼å­˜å‚¨, å‰¯æœ¬é›†å¯ä»¥å®ç°é«˜å¯ç”¨é›†ç¾¤</p><p>ä¸°å¯Œçš„åŠŸèƒ½é›†ï¼Œæ”¯æŒäºŒçº§ç´¢å¼•ã€å¼ºå¤§çš„èšåˆç®¡é“åŠŸèƒ½ï¼Œä¸ºå¼€å‘è€…é‡èº«å®šåšçš„åŠŸèƒ½ï¼Œå¦‚æ•°æ®è‡ªåŠ¨è€åŒ–ã€å›ºå®šé›†åˆ</p><p>å­˜å‚¨æ–¹å¼ä¸ºè™šæ‹Ÿå†…å­˜+æŒä¹…åŒ–å­˜å‚¨ï¼ŒMongoå°†æ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†ç”±è™šæ‹Ÿå†…å­˜ç®¡ç†å™¨å°†å…¶æŒä¹…åŒ–åˆ°ç¡¬ç›˜ä¸­ï¼Œå› æ­¤å†™æ“ä½œä¼šæ¯”å…³ç³»å‹æ•°æ®åº“å¿«å¾ˆå¤š</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12-å’Œ-mysql-æ¦‚å¿µå¯¹æ¯”">1.2. å’Œ MySQL æ¦‚å¿µå¯¹æ¯”<a href="#12-å’Œ-mysql-æ¦‚å¿µå¯¹æ¯”" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><ul><li><p>æ•°æ®åº“ (databases): å’Œ MySQLç±»ä¼¼, ä¸€å°mongodbæœåŠ¡å™¨å¯ä»¥åŒ…å«å¤šä¸ªæ•°æ®åº“</p></li><li><p>é›†åˆ (collections): ç±»ä¼¼MySQLä¸­çš„è¡¨, å¯ä»¥åŒ…å«å¤šä¸ªæ–‡æ¡£, è¿™äº›æ–‡æ¡£æœ‰ç›¸å…³æ€§, ç»“æ„å¯ä»¥ä¸åŒ</p><p>  ä¸åŒä¹‹å¤„å°±åœ¨äºé›†åˆçš„ç»“æ„(schema)æ˜¯åŠ¨æ€çš„ï¼Œä¸éœ€è¦é¢„å…ˆå£°æ˜ä¸€ä¸ªä¸¥æ ¼çš„è¡¨ç»“æ„ã€‚</p><p>  æ›´é‡è¦çš„æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ MongoDB å¹¶ä¸ä¼šå¯¹å†™å…¥çš„æ•°æ®åšä»»ä½•schemaçš„æ ¡éªŒã€‚</p></li><li><p>æ–‡æ¡£ (documents):  å°±æ˜¯ä¸€ä¸ª json, å¤šä¸ª field ç»„æˆ, æ˜¯ mongo ç‹¬æœ‰çš„æ¦‚å¿µ,ç±»ä¼¼ MySQLçš„ row</p></li><li><p>å­—æ®µ (field ): json ä¸­çš„æŸä¸ª key, ç±»ä¼¼ MySQLçš„ column</p><p>  æ”¯æŒåµŒå¥—çš„æ–‡æ¡£ã€æ•°ç»„</p><p>  MongoDBä¸­å­—æ®µçš„ç±»å‹æ˜¯å›ºå®šçš„ã€åŒºåˆ†å¤§å°å†™ã€å¹¶ä¸”æ–‡æ¡£ä¸­çš„å­—æ®µä¹Ÿæ˜¯æœ‰åºçš„</p></li><li><p>_id ä¸»é”®:  é»˜è®¤ä½¿ç”¨ä¸€ä¸ª_id å­—æ®µæ¥ä¿è¯æ–‡æ¡£çš„å”¯ä¸€æ€§</p><p>  è‹¥ insert æ—¶ä¸æŒ‡å®š, ä¼šè‡ªåŠ¨ç”Ÿæˆ id, ç”±å®¢æˆ·ç«¯(Driver)ç”Ÿæˆ</p></li><li><p>reference å¼•ç”¨: ç±»ä¼¼ MySQLçš„å¤–é”®</p><p>  ä½†æ˜¯æ²¡æœ‰ä»»ä½•å¼ºåˆ¶çº¦æŸ, åªæ˜¯ç”¨äºæŸ¥è¯¢ä½¿ç”¨</p></li><li><p>view è§†å›¾: è§†å›¾æ˜¯åŸºäºè¡¨/é›†åˆä¹‹ä¸Šè¿›è¡ŒåŠ¨æ€æŸ¥è¯¢çš„ä¸€å±‚å¯¹è±¡ï¼Œå¯ä»¥æ˜¯è™šæ‹Ÿçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç‰©ç†çš„(ç‰©åŒ–è§†å›¾), ç±»ä¼¼ MySQL</p></li><li><p>index ç´¢å¼•: ä¸SQL çš„ç´¢å¼•ç›¸åŒ</p></li><li><p><code>$lookup</code>: èšåˆæ“ä½œç¬¦ï¼Œå¯ä»¥ç”¨äºå®ç°ç±»ä¼¼ SQL-join è¿æ¥çš„åŠŸèƒ½</p></li><li><p>transaction äº‹åŠ¡ï¼Œä» MongoDB 4.0 ç‰ˆæœ¬å¼€å§‹</p></li><li><p>aggregation èšåˆ: ç±»ä¼¼ MySQL çš„åˆ†ç»„æ“ä½œ</p><p>  MongoDB æä¾›äº†å¼ºå¤§çš„èšåˆè®¡ç®—æ¡†æ¶ï¼Œgroup by æ˜¯å…¶ä¸­çš„ä¸€ç±»èšåˆæ“ä½œ</p></li><li><p>mapreduce: </p></li><li><p>Projection (æŠ•å½±): ç±»ä¼¼ä¼ ç»Ÿçš„SQLè¯­æ³•ä¸­ï¼Œå¯ä»¥é™å®šè¿”å›çš„å­—æ®µ</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13-å’Œ-es-å¯¹æ¯”">1.3. å’Œ es å¯¹æ¯”<a href="#13-å’Œ-es-å¯¹æ¯”" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="https://www.zhihu.com/question/274485040/answer/1242910052" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/274485040/answer/1242910052</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="14-rdbms-å’Œ-nosql">1.4. rdbms å’Œ nosql<a href="#14-rdbms-å’Œ-nosql" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>å…³ç³»å‹ vs. éå…³ç³»å‹</p><ul><li><p>rdbms æ•°æ®éƒ½æ˜¯ç»“æ„åŒ–çš„ (æœ‰ä¸¥æ ¼çš„è¡Œ/åˆ—çº¦æŸ), nosql æ²¡æœ‰é¢„å®šä¹‰çš„çº¦æŸ</p></li><li><p>rdbms æ”¯æŒ sql</p><p>  mongodb åœ¨ client ä½¿ç”¨sql: mongoboosterã€studio3t</p></li><li><p>rdbms æ”¯æŒäº‹åŠ¡ , nosql ä¸æ”¯æŒ</p><p>  nosql æ”¾å¼ƒäº‹åŠ¡ï¼Œè¿½æ±‚é«˜æ€§èƒ½ã€é«˜å¯æ‰©å±•</p><p>  æœ€åˆ mongo ä»…ä»…æ”¯æŒ å•æ–‡æ¡£çš„äº‹åŠ¡, 4.0å, mongodb æ”¯æŒå¤šæ–‡æ¡£çš„äº‹åŠ¡ (äº‹åŠ¡ä¸­çš„æ“ä½œå¯ä»¥è·¨å‰¯æœ¬é›†, è·¨åˆ†ç‰‡)</p><p>  åœ¨äº‹åŠ¡çš„éš”ç¦»æ€§ä¸Šï¼ŒMongoDB æ”¯æŒå¿«ç…§(snapshot)çš„éš”ç¦»çº§åˆ«ï¼Œå¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚</p></li><li><p>rdbms æœ‰ä¸¥æ ¼çš„ä¸€è‡´æ€§, nosql ä»…ä»…æœ€ç»ˆä¸€è‡´æ€§</p></li></ul><h1>2. why mongodb</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21-ç‰¹ç‚¹">2.1. ç‰¹ç‚¹<a href="#21-ç‰¹ç‚¹" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>å¯ä»¥å’Œå…³ç³»å‹æ•°æ®åº“(MySQL)å¯¹æ¯”ç€çœ‹:</p><p>ä¼˜ç‚¹:</p><ul><li><p>æ²¡æœ‰schemaçº¦æŸ, å¯ä»¥è¿…é€Ÿå¼€å‘, ä¸å¿…å®šä¹‰å­—æ®µå, å­—æ®µç±»å‹ç­‰ç­‰</p></li><li><p>é€Ÿåº¦æ›´å¿«, mongoå­˜å‚¨æ–¹å¼æ˜¯ å…ˆå†™å†…å­˜, ç„¶ååˆ·å…¥ç£ç›˜</p><p>  ç”¨äºç¼“å­˜, ä¸è¿‡ä¸€èˆ¬ä¸è¿™ä¹ˆå¹², redis å°±å¤Ÿäº†</p></li><li><p>MongoDBè‡ªå¸¦å¤åˆ¶ã€åˆ†ç‰‡ç­‰é«˜å¯ç”¨æ–¹æ¡ˆ</p></li><li><p>æ”¯æŒäºŒç»´ç©ºé—´/åœ°ç†ä½ç½®ç´¢å¼•, å¯ä»¥å­˜å‚¨ç»çº¬åº¦</p></li><li><p>GridFS, å°†æ–‡ä»¶å­˜å‚¨åœ¨MongoDBé›†åˆä¸­</p></li><li><p>æ–‡æ¡£å¯ä»¥åµŒå¥—, è§£å†³äº† MySQL ä¸­å¤šè¡¨ joinæŸå¤±æ€§èƒ½çš„é—®é¢˜</p></li></ul><p>ç¼ºç‚¹: </p><ul><li><p>æ²¡æœ‰æ•°æ®å®Œæ•´æ€§æ£€æŸ¥, ç°åœ¨å·²ç»æœ‰äº† (Mongoose å¯ä»¥è§£å†³ä¸€åˆ‡çº¦æŸç¼ºå¤±é—®é¢˜)</p><p>  MongoDB æ”¯æŒæ¨¡å¼éªŒè¯</p></li><li><p>æ²¡æœ‰å¼ºåˆ¶çš„å¤–é”®çº¦æŸ</p></li><li><p>äº‹åŠ¡æ”¯æŒ (MongoDB ç›®å‰åªæ”¯æŒå•æ–‡æ¡£äº‹åŠ¡ï¼Œéœ€è¦å¤æ‚äº‹åŠ¡æ”¯æŒçš„åœºæ™¯æš‚æ—¶ä¸é€‚åˆ)</p></li><li><p>å¼€æºåè®®é—®é¢˜ (AGPLv3åˆ‡æ¢åˆ°SSPL)</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22-ä½¿ç”¨åœºæ™¯">2.2. ä½¿ç”¨åœºæ™¯<a href="#22-ä½¿ç”¨åœºæ™¯" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><ol><li><p>é€‚åˆ æ—¥å¿—ç³»ç»Ÿ, çˆ¬è™«çˆ¬å–çš„åŸå§‹æ•°æ®</p></li><li><p>é€‚åˆæ•°æ®è§„æ¨¡å·¨å¤§çš„ç³»ç»Ÿ (è‡ªå¸¦åˆ†ç‰‡, å¤åˆ¶åŠŸèƒ½, åˆ†å¸ƒå¼, é«˜å¯ç”¨å®ç°æ–¹ä¾¿)</p></li><li><p>o2o app, ç”¨äºåœ°ç†ä½ç½®å­˜å‚¨ (æŸ¥è¯¢é™„è¿‘çš„äºº, è·ç¦»ã€æˆ–è€…è®¢é¤ç³»ç»Ÿã€é…é€ç³»ç»Ÿç­‰)</p></li><li><p>ä½œä¸ºæ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ</p></li><li><p>è§£å†³ MySQL å¤šè¡¨ join çš„æ€§èƒ½é—®é¢˜</p><blockquote><p>å¦‚å°†åŸæœ¬åœ¨ MySQLä¸­éœ€è¦ join çš„æŸ¥è¯¢æ•°æ®, ä½œä¸ºä¸€ä¸ªæ–‡æ¡£, å­˜å…¥ MongoDB</p></blockquote></li></ol><blockquote><p>åº”ç”¨ä¸éœ€è¦äº‹åŠ¡åŠå¤æ‚ join æ”¯æŒ?
æ–°åº”ç”¨ï¼Œéœ€æ±‚ä¼šå˜ï¼Œæ•°æ®æ¨¡å‹æ— æ³•ç¡®å®šï¼Œæƒ³å¿«é€Ÿè¿­ä»£å¼€å‘ï¼Ÿ
åº”ç”¨éœ€è¦2000-3000ä»¥ä¸Šçš„è¯»å†™QPSï¼ˆæ›´é«˜ä¹Ÿå¯ä»¥ï¼‰ï¼Ÿ
åº”ç”¨éœ€è¦TBç”šè‡³ PB çº§åˆ«æ•°æ®å­˜å‚¨? åº”ç”¨å‘å±•è¿…é€Ÿï¼Œéœ€è¦èƒ½å¿«é€Ÿæ°´å¹³æ‰©å±•?
åº”ç”¨è¦æ±‚å­˜å‚¨çš„æ•°æ®ä¸ä¸¢å¤±?
åº”ç”¨éœ€è¦99.999%é«˜å¯ç”¨?
åº”ç”¨éœ€è¦å¤§é‡çš„åœ°ç†ä½ç½®æŸ¥è¯¢ã€æ–‡æœ¬æŸ¥è¯¢ï¼Ÿ</p></blockquote><p>å¦‚æœä¸Šè¿°æœ‰1ä¸ª Yesï¼Œå¯ä»¥è€ƒè™‘ MongoDBï¼Œ2ä¸ªåŠä»¥ä¸Šçš„ Yesï¼Œé€‰æ‹©MongoDBç»ä¸ä¼šåæ‚”</p><h1>3. how</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-å®‰è£…">3.1. å®‰è£…<a href="#31-å®‰è£…" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="311-docker-å®‰è£…">3.1.1. docker å®‰è£…<a href="#311-docker-å®‰è£…" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p><a href="https://www.jianshu.com/p/576a156f6877" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/576a156f6877</a>
<a href="https://www.cnblogs.com/yunquan/p/11174265.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/yunquan/p/11174265.html</a></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># https://hub.docker.com/_/mongo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç”±äºæ·»åŠ äº† env params, å¾€ admin æ•°æ®åº“ çš„ system.users é›†åˆä¸­ æ’å…¥äº†è®°å½•, å¼€å¯äº† auth</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run -d -p 27017:27017 --name mongodb -e MONGO_INITDB_ROOT_USERNAME=mongoadmin -e MONGO_INITDB_ROOT_PASSWORD=mongoadmin mongo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># check -&gt; http://localhost:8081/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">docker run --restart=always --name mongo-express --link mongodb:mongodb -d -p 8081:8081 -e ME_CONFIG_OPTIONS_EDITORTHEME=&quot;3024-night&quot; -e ME_CONFIG_BASICAUTH_USERNAME=&quot;mongoexpress&quot; -e ME_CONFIG_BASICAUTH_PASSWORD=&quot;mongoexpress&quot; -e ME_CONFIG_MONGODB_ADMINUSERNAME=&quot;mongoadmin&quot; -e ME_CONFIG_MONGODB_ADMINPASSWORD=&quot;mongoadmin&quot; -e ME_CONFIG_MONGODB_SERVER=&quot;mongodb&quot; mongo-express</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-å‹ç¼©åŒ…å®‰è£…">3.1.2. å‹ç¼©åŒ…å®‰è£…<a href="#312-å‹ç¼©åŒ…å®‰è£…" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>ä¸‹è½½ zip åŒ…, æ–°å»ºæ–‡ä»¶å¤¹ <code>data</code> ç”¨æ¥å­˜å‚¨æ•°æ®; æ–°å»º <code>daemon_start.sh</code> ä½œä¸ºserverå¯åŠ¨è„šæœ¬:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">cd D:\\program_green\\mongodb\\mongodb-win32-x86_64-2008plus-ssl-4.0.11\\bin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">./mongod.exe --dbpath D:\\program_green\\mongodb\\data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ–°å»º <code>client_start.sh</code> ä¸ºclientè„šæœ¬:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">cd D:\\program_green\\mongodb\\mongodb-win32-x86_64-2008plus-ssl-4.0.11\\bin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">./mongo localhost:27017</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>mongoDBé»˜è®¤å ç”¨ç«¯å£ä¸º27017</p><p>é»˜è®¤mongoå¯åŠ¨æ˜¯ä»¥testç”¨æˆ·, å³ <code>mongo localhost:27017/test</code>, å¯ä»¥ä»¥åˆ«çš„ç”¨æˆ·å¯åŠ¨ <code>mongo localhost:27017/admin</code></p><p>æ•°æ®å»ºæ¨¡æ—¶çš„åŒºåˆ«å¯ä»¥å‚è€ƒ: <a href="https://www.yiibai.com/mongodb/mongodb_data_modeling.html" target="_blank" rel="noopener noreferrer">https://www.yiibai.com/mongodb/mongodb_data_modeling.html</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32-ä½¿ç”¨">3.2. ä½¿ç”¨<a href="#32-ä½¿ç”¨" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="321-å’Œ-spring-boot-é›†æˆ">3.2.1. å’Œ spring boot é›†æˆ<a href="#321-å’Œ-spring-boot-é›†æˆ" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>spring boot data mongodb</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">use demo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#éœ€è¦åˆ›å»ºé admin çš„ user, å¦åˆ™ spring boot ä¼šæŠ¥è®¤è¯å¼‚å¸¸</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.createUser({&quot;user&quot;: &quot;tiger&quot;, &quot;pwd&quot;: &quot;tiger&quot;, &quot;roles&quot;: [{&quot;role&quot;: &quot;readWrite&quot;, &quot;db&quot;: &quot;demo&quot;}]})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>spring boot é…ç½®: ...uri: <code>mongodb://tiger:tiger@172.24.208.103:27017/demo</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="322-ä½¿ç”¨-å‘½ä»¤è¡Œ">3.2.2. ä½¿ç”¨ å‘½ä»¤è¡Œ<a href="#322-ä½¿ç”¨-å‘½ä»¤è¡Œ" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># è¿›å…¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¿œç¨‹è¿æ¥ä½¿ç”¨ mongo username:password@ip:port/dbname</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸å¸¦ username ä¹Ÿå¯è¿›å…¥, ä½†æ˜¯ä¸æ˜¯åŒä¸€ä¸ªç³»ç»Ÿ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mongo --username mongoadmin --password</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ä½¿ç”¨ -u -p äº¦å¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ˜¾ç¤ºå½“å‰db</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥çœ‹æ‰€æœ‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">show dbs  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½¿ç”¨/åˆ›å»ºæ•°æ®åº“, é»˜è®¤æ˜¯ä½¿ç”¨ test æ•°æ®åº“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¿…é¡»æ’å…¥æ•°æ®æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">use DATABASE_NAME</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ•°æ®åº“åä¸å­˜åœ¨è‡ªåŠ¨åˆ›å»ºæ–°æ•°æ®åº“</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å…¨å±€æ‰€æœ‰ç”¨æˆ·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.system.users.find().pretty()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å½“å‰ db ç”¨æˆ·</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">show users</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ·»åŠ  user</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.createUser(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       user: &quot;wenqiang&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       pwd: &quot;1438438&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       roles: [&quot;readWrite&quot;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.createUser(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       user: &quot;wenqiang&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       pwd: &quot;1438438&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       roles: [{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           &quot;role&quot;:&quot;readWrite&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           &quot;db&quot;: &quot;demo-db&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       }]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»ºç®¡ç†å‘˜ï¼Œèµ‹äºˆrootæƒé™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.createUser({user:&quot;admin&quot;,pwd:&quot;xiiasdfiik34&quot;,roles:[{role: &#x27;root&#x27;, db: &#x27;admin&#x27;}]})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.createUser({user:&quot;pmsfile_prod&quot;,pwd:&quot;pmsplatformP@ssword0&quot;,roles:[{role: &#x27;readWrite&#x27;, db: &#x27;pmsfile&#x27;}]})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.createUser({user:&quot;pmsplatform&quot;,pwd:&quot;pmsplatformP@ssword0&quot;,roles:[{role: &#x27;readWrite&#x27;, db: &#x27;pmsfile&#x27;}]})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.updateUser(&quot;pmsplatform_file&quot;, {roles: [{role: &quot;readWrite&quot;, db: &quot;admin&quot;}]})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤ user</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.dropUser(&#x27;username&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç™»å½•è®¤è¯æ–°user</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.auth(&quot;mutianwei&quot;, &quot;123568&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ˜¾ç¤ºè¡¨(é›†åˆ)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">show collections</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥è¯¢å½“å‰ db çš„é›†åˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.getCollectionNames()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ›å»º collections</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.createCollection(&quot;logs&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># create document</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.logs.insert( { name: &quot;wangwenqiang&quot;, age: 3} )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æŸ¥è¯¢ æ‰€æœ‰ document</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.logs.find([jsonå‚æ•°])</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.é›†åˆåç§°.find().limit(æ¡æ•°)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç»Ÿè®¡æ¡æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.é›†åˆåç§°.count([json å‚æ•°])</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ›´æ–° document</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># age &gt; 25 çš„ user çš„ status è®¾ç½®ä¸º c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.users.update(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    { age: { $gt: 25 } },</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    { $set: { status: &#x27;C&#x27; } },</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    { multi: true }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.book.update(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   {&quot;_id&quot; : ObjectId(&quot;5c61301c15338f68639e6802&quot;)},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   {&quot;$inc&quot;: {&quot;viewCount&quot;: 3} }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤ document</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.book.remove({&quot;_id&quot;:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     ObjectId(&quot;5c612b2f15338f68639e67d5&quot;)})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ é™¤é›†åˆä¸­å…¨éƒ¨æ•°æ®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.é›†åˆåç§°.remove({})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># projection (åªæŸ¥è¯¢æ˜¾ç¤ºæŒ‡å®šå­—æ®µ, 1 è¡¨ç¤ºæ˜¾ç¤º, 0 è¡¨ç¤ºä¸æ˜¾ç¤º, é»˜è®¤ 0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.book.find({&quot;author&quot;: &quot;James&quot;}, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {&quot;_id&quot;: 1, &quot;title&quot;: 1, &quot;author&quot;: 1})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åˆ†é¡µ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.book.find({})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    .sort({&quot;viewCount&quot; : -1})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    .skip(10).limit(5)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>4. ç´¢å¼•</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-ç´¢å¼•ä»‹ç»">4.1. ç´¢å¼•ä»‹ç»<a href="#41-ç´¢å¼•ä»‹ç»" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>ä½¿ç”¨ wiredTiger ä½œä¸ºé»˜è®¤çš„å¼•æ“ã€‚</p><p>ä½¿ç”¨äº† Bæ ‘çš„ç»“æ„ (mysql  ç”¨çš„æ˜¯ b+ æ ‘) - <a href="https://zhuanlan.zhihu.com/p/107228878" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/107228878</a> //todo</p><p>============= ç´¢å¼•åˆ†ç±»</p><p>é™¤äº†æ™®é€šç´¢å¼•ä¹‹å¤–ï¼ŒMongoDB æ”¯æŒçš„ç±»å‹è¿˜åŒ…æ‹¬ï¼š</p><ul><li><p>å“ˆå¸Œ(HASH)ç´¢å¼•ï¼Œå“ˆå¸Œæ˜¯å¦ä¸€ç§å¿«é€Ÿæ£€ç´¢çš„æ•°æ®ç»“æ„ï¼ŒMongoDB çš„ HASH ç±»å‹åˆ†ç‰‡é”®ä¼šä½¿ç”¨å“ˆå¸Œç´¢å¼•ã€‚</p></li><li><p>åœ°ç†ç©ºé—´ç´¢å¼•ï¼Œç”¨äºæ”¯æŒå¿«é€Ÿçš„åœ°ç†ç©ºé—´æŸ¥è¯¢ï¼Œå¦‚å¯»æ‰¾é™„è¿‘1å…¬é‡Œçš„å•†å®¶ã€‚</p><p>  å…¶çƒé¢ï¼ˆSphericalï¼‰å’Œå¹³é¢ï¼ˆFlatï¼‰ä¸¤ç§æ¨¡å¼ï¼Œ</p></li><li><p>æ–‡æœ¬ç´¢å¼•ï¼Œç”¨äºæ”¯æŒå¿«é€Ÿçš„å…¨æ–‡æ£€ç´¢</p></li><li><p>æ¨¡ç³Šç´¢å¼•(Wildcard Index)ï¼Œä¸€ç§åŸºäºåŒ¹é…è§„åˆ™çš„çµæ´»å¼ç´¢å¼•ï¼Œåœ¨4.2ç‰ˆæœ¬å¼€å§‹å¼•å…¥ã€‚</p></li></ul><p>å”¯ä¸€ç´¢å¼•ã€</p><p>äºŒçº§ç´¢å¼•ã€</p><p>TTLç´¢å¼•(é€šè¿‡åˆ›å»ºTTLç´¢å¼•ï¼Œå®ç°è‡ªåŠ¨åˆ é™¤è¿‡æœŸè®°å½•çš„åŠŸèƒ½, æ¯”å¦‚ä¿å­˜æ—¥å¿—)</p><p>MongoDBé›†åˆåœ¨åˆ›å»ºæ—¶é»˜è®¤å°±åŸºäº_idå­—æ®µåˆ›å»ºäº†å”¯ä¸€ç´¢å¼•ï¼Œæ•°æ®æ’å…¥æ—¶ä¼šæ£€æŸ¥_idå­—æ®µçš„å”¯ä¸€æ€§</p><p>åœ¨å†…å­˜è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œç´¢å¼•ä¼šè¢«åŠ è½½åˆ°Cacheä¸­ï¼Œå¦‚æœæ‰§è¡Œçš„æŸ¥è¯¢æ˜¯ç´¢å¼•è¦†ç›–çš„ï¼ˆQuery Optimizationï¼‰ï¼Œå…¶æ€§èƒ½ç”šè‡³å¯ä»¥åª²ç¾Redisç­‰å†…å­˜æ•°æ®åº“ç­‰</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œç´¢å¼•">4.2. åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œç´¢å¼•<a href="#42-åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œç´¢å¼•" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># ä¸ºé›†åˆå£°æ˜ä¸€ä¸ªæ™®é€šçš„ç´¢å¼•ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ•°å­— 1 ä»£è¡¨å‡åºï¼Œå¦‚æœæ˜¯é™åºåˆ™æ˜¯ -1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.book.ensureIndex({author: 1})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¤åˆå¼(compound)çš„ç´¢å¼• (å¯¹ type, published æ·»åŠ è”åˆç´¢å¼•)ï¼Œå¦‚ä¸‹ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åªæœ‰å¯¹äºå¤åˆå¼ç´¢å¼•æ—¶ï¼Œç´¢å¼•é”®çš„é¡ºåºæ‰å˜å¾—æœ‰æ„ä¹‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.book.ensureIndex({type: 1, published: 1})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å¦‚æœç´¢å¼•çš„å­—æ®µæ˜¯æ•°ç»„ç±»å‹ï¼Œè¯¥ç´¢å¼•å°±è‡ªåŠ¨æˆä¸ºæ•°ç»„(multikey)ç´¢å¼•ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># MongoDB å¯ä»¥åœ¨å¤åˆç´¢å¼•ä¸ŠåŒ…å«æ•°ç»„çš„å­—æ®µï¼Œä½†æœ€å¤šåªèƒ½åŒ…å«ä¸€ä¸ª</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.book.ensureIndex({tags: 1})</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¯ä»¥é€šè¿‡ä¸€äº›å‚æ•°åŒ–é€‰é¡¹æ¥ä¸ºç´¢å¼•èµ‹äºˆä¸€å®šçš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><p>unique=trueï¼Œè¡¨ç¤ºä¸€ä¸ªå”¯ä¸€æ€§ç´¢å¼•</p></li><li><p>expireAfterSeconds=3600ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªTTLç´¢å¼•ï¼Œå¹¶ä¸”æ•°æ®å°†åœ¨1å°æ—¶åè€åŒ–</p></li><li><p>sparse=trueï¼Œè¡¨ç¤ºç¨€ç–çš„ç´¢å¼•ï¼Œä»…ç´¢å¼•éç©º(non-null)å­—æ®µçš„æ–‡æ¡£</p></li><li><p>partialFilterExpression: { rating: { $gt: 5 }ï¼Œæ¡ä»¶å¼ç´¢å¼•ï¼Œå³æ»¡è¶³è®¡ç®—æ¡ä»¶çš„æ–‡æ¡£æ‰è¿›è¡Œç´¢å¼•</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43-ç´¢å¼•è¯„ä¼°ä¼˜åŒ–">4.3. ç´¢å¼•è¯„ä¼°ä¼˜åŒ–<a href="#43-ç´¢å¼•è¯„ä¼°ä¼˜åŒ–" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="https://docs.mongodb.com/manual/reference/explain-results/index.html" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/manual/reference/explain-results/index.html</a></p><p>ä½¿ç”¨ explain() å‘½ä»¤å¯ä»¥ç”¨äºæŸ¥è¯¢è®¡åˆ’åˆ†æ</p><p>hint() å¼ºåˆ¶æŸ¥è¯¢èµ°æŸä¸ªç´¢å¼•</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db.test.explain().find( { a : 5 } )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  &quot;queryPlanner&quot; : {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # é€šè¿‡ winningPlan å¯ä»¥çŸ¥é“æ˜¯å¦é«˜æ•ˆ: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # æœªèƒ½å‘½ä¸­ç´¢å¼•çš„ç»“æœï¼Œä¼šæ˜¾ç¤ºCOLLSCAN</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # å‘½ä¸­ç´¢å¼•çš„ç»“æœï¼Œä½¿ç”¨IXSCAN</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #å‡ºç°äº†å†…å­˜æ’åºï¼Œæ˜¾ç¤ºä¸º SORT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;winningPlan&quot; : { </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &quot;stage&quot; : &quot;FETCH&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &quot;inputStage&quot; : {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;stage&quot; : &quot;IXSCAN&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;keyPattern&quot; : {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            &quot;a&quot; : 5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;indexName&quot; : &quot;a_1&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;isMultiKey&quot; : false,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;direction&quot; : &quot;forward&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;indexBounds&quot; : {&quot;a&quot; : [&quot;[5.0, 5.0]&quot;]}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>5. åˆ†ç‰‡é›†ç¾¤ Shard Cluster</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-æ¶æ„å›¾">5.1. æ¶æ„å›¾<a href="#51-æ¶æ„å›¾" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">        application            </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                 </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">       </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                 v      v       v</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">                                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    mongos  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   mongos   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   mongos   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">             </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                                                                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                        </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">       </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">       </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">                  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   config primary    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                        </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">       </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">       </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                        v       v      v       v      v                  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                                                                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                             </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                             </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  config secondary  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    primary       </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  primary        </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                 </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                             </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  config secondary  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> secondary  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    secondary   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      secondary  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">secondary   </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                             </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                         </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                          </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                             </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain">        config server replSet </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">               shard0                             shard1                                             </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                                                                                                     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                                                                                                     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">                                                                                                     </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">--</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>æ•°æ®åˆ†ç‰‡ shards </p><p>  å­˜å‚¨çœŸæ­£çš„é›†ç¾¤æ•°æ®, å¯ä»¥æ˜¯ä¸€ä¸ªå•ç‹¬çš„ Mongodå®ä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‰¯æœ¬é›†</p><p>  ç”Ÿäº§ç¯å¢ƒä¸‹, Shardä¸€èˆ¬æ˜¯ä¸€ä¸ª Replica Setï¼Œä»¥é˜²æ­¢è¯¥æ•°æ®ç‰‡çš„å•ç‚¹æ•…éšœ</p><p>  å¯¹äºåˆ†ç‰‡é›†åˆ(sharded collection)æ¥è¯´ï¼Œæ¯ä¸ªåˆ†ç‰‡ä¸Šéƒ½å­˜å‚¨äº†é›†åˆçš„ä¸€éƒ¨åˆ†æ•°æ®(æŒ‰ç…§åˆ†ç‰‡é”®åˆ‡åˆ†)ï¼Œå¦‚æœé›†åˆæ²¡æœ‰åˆ†ç‰‡ï¼Œé‚£ä¹ˆè¯¥é›†åˆçš„æ•°æ®éƒ½å­˜å‚¨åœ¨æ•°æ®åº“çš„ Primary Shardä¸­</p></li><li><p>é…ç½®æœåŠ¡å™¨ config server </p><p>  ä¿å­˜é›†ç¾¤çš„å…ƒæ•°æ®ï¼ˆmetadataï¼‰ï¼ŒåŒ…å«å„ä¸ªShardçš„è·¯ç”±è§„åˆ™ï¼Œé…ç½®æœåŠ¡å™¨ç”±ä¸€ä¸ªå‰¯æœ¬é›†(ReplicaSet)ç»„æˆ</p></li><li><p>æŸ¥è¯¢è·¯ç”± mongos</p><p>  Mongosæ˜¯ Sharded Cluster çš„è®¿é—®å…¥å£ï¼Œå…¶æœ¬èº«å¹¶ä¸æŒä¹…åŒ–æ•°æ® ã€‚</p><p>  Mongoså¯åŠ¨åï¼Œä¼šä» Config Server åŠ è½½å…ƒæ•°æ®ï¼Œå¼€å§‹æä¾›æœåŠ¡ï¼Œå¹¶å°†ç”¨æˆ·çš„è¯·æ±‚æ­£ç¡®è·¯ç”±åˆ°å¯¹åº”çš„Shardã€‚</p><p>  Sharding é›†ç¾¤å¯ä»¥éƒ¨ç½²å¤šä¸ª Mongos ä»¥åˆ†æ‹…å®¢æˆ·ç«¯è¯·æ±‚çš„å‹åŠ›</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52-åˆ†ç‰‡æœºåˆ¶">5.2. åˆ†ç‰‡æœºåˆ¶<a href="#52-åˆ†ç‰‡æœºåˆ¶" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>åŸºäºåˆ†ç‰‡åˆ‡åˆ†åçš„æ•°æ®å—ç§°ä¸º chunkï¼Œä¸€ä¸ªåˆ†ç‰‡åçš„é›†åˆä¼šåŒ…å«å¤šä¸ª chunkï¼Œæ¯ä¸ª chunk ä½äºå“ªä¸ªåˆ†ç‰‡(Shard) åˆ™è®°å½•åœ¨ Config Server(é…ç½®æœåŠ¡å™¨)ä¸Šã€‚</p><p>Mongos åœ¨æ“ä½œåˆ†ç‰‡é›†åˆæ—¶ï¼Œä¼šè‡ªåŠ¨æ ¹æ®åˆ†ç‰‡é”®æ‰¾åˆ°å¯¹åº”çš„ chunkï¼Œå¹¶å‘è¯¥ chunk æ‰€åœ¨çš„åˆ†ç‰‡å‘èµ·æ“ä½œè¯·æ±‚ã€‚</p><p>===============æ•°æ®å¦‚ä½•åˆ‡åˆ†:</p><ul><li><p>èŒƒå›´åˆ†ç‰‡: æŒ‰ç…§åˆ†ç‰‡å­—æ®µä»å°åˆ°å¤§, åˆ†æˆå¤šä¸ªèŒƒå›´æ®µ, æ¯æ®µå°±æ˜¯ä¸€ä¸ª shard</p><p>  å¦‚: é›†åˆæ ¹æ®xå­—æ®µ (æ•´å‹) æ¥åˆ†ç‰‡ï¼Œxçš„å–å€¼èŒƒå›´ä¸º<!-- -->[minKey, maxKey]<!-- -->, å°†æ•´ä¸ªå–å€¼èŒƒå›´åˆ’åˆ†ä¸ºå¤šä¸ªchunkï¼Œæ¯ä¸ªchunkï¼ˆé»˜è®¤é…ç½®ä¸º64MBï¼‰åŒ…å«å…¶ä¸­ä¸€å°æ®µçš„æ•°æ®</p><p>  èƒ½å¾ˆå¥½çš„æ»¡è¶³èŒƒå›´æŸ¥è¯¢çš„éœ€æ±‚, å¦‚ æƒ³æŸ¥è¯¢xçš„å€¼åœ¨<!-- -->[-30, 10]<!-- -->ä¹‹é—´çš„æ‰€æœ‰æ–‡æ¡£ï¼Œè¿™æ—¶ Mongos ç›´æ¥èƒ½å°†è¯·æ±‚è·¯ç”±åˆ° Chunk2</p><p>  èŒƒå›´åˆ†ç‰‡çš„ç¼ºç‚¹åœ¨äºï¼Œå¦‚æœ ShardKey æœ‰æ˜æ˜¾é€’å¢ï¼ˆæˆ–è€…é€’å‡ï¼‰è¶‹åŠ¿ï¼Œåˆ™æ–°æ’å…¥çš„æ–‡æ¡£å¤šä¼šåˆ†å¸ƒåˆ°åŒä¸€ä¸ªchunkï¼Œæ— æ³•æ‰©å±•å†™çš„èƒ½åŠ›ï¼Œæ¯”å¦‚ä½¿ç”¨_idä½œä¸º ShardKeyï¼Œè€ŒMongoDBè‡ªåŠ¨ç”Ÿæˆçš„idé«˜ä½æ˜¯æ—¶é—´æˆ³ï¼Œæ˜¯æŒç»­é€’å¢çš„ã€‚</p></li><li><p>å“ˆå¸Œåˆ†ç‰‡: æ ¹æ®ç”¨æˆ·çš„ ShardKey å…ˆè®¡ç®—å‡ºhashå€¼ï¼ˆ64bitæ•´å‹ï¼‰ï¼Œå†æ ¹æ®hashå€¼æŒ‰ç…§èŒƒå›´åˆ†ç‰‡çš„ç­–ç•¥å°†æ–‡æ¡£åˆ†å¸ƒåˆ°ä¸åŒçš„ chunkã€‚</p><p>  ç”±äº hashå€¼çš„è®¡ç®—æ˜¯éšæœºçš„ï¼Œå› æ­¤ Hash åˆ†ç‰‡å…·æœ‰å¾ˆå¥½çš„ç¦»æ•£æ€§ï¼Œå¯ä»¥å°†æ•°æ®éšæœºåˆ†å‘åˆ°ä¸åŒçš„ chunk ä¸Š</p><p>  ä½†ä¸èƒ½é«˜æ•ˆçš„æœåŠ¡èŒƒå›´æŸ¥è¯¢ï¼Œæ‰€æœ‰çš„èŒƒå›´æŸ¥è¯¢è¦æŸ¥è¯¢å¤šä¸ª chunk æ‰èƒ½æ‰¾å‡ºæ»¡è¶³æ¡ä»¶çš„æ–‡æ¡£ã€‚</p></li></ul><p>================å¦‚ä½•ä¿è¯æ¯ä¸ª shard ä¸Š,  chunk éƒ½æ˜¯å‡è¡¡çš„å‘¢</p><ul><li><p>å…¨é¢„åˆ†é…ï¼Œchunk çš„æ•°é‡å’Œ shard éƒ½æ˜¯é¢„å…ˆå®šä¹‰å¥½çš„ï¼Œæ¯”å¦‚ 10ä¸ªshardï¼Œå­˜å‚¨1000ä¸ªchunkï¼Œé‚£ä¹ˆæ¯ä¸ªshard åˆ†åˆ«æ‹¥æœ‰100ä¸ªchunkã€‚</p></li><li><p>éé¢„åˆ†é…</p><p>  è¿™ç§æƒ…å†µåˆ™æ¯”è¾ƒå¤æ‚ï¼Œä¸€èˆ¬å½“ä¸€ä¸ª chunk å¤ªå¤§æ—¶ä¼šäº§ç”Ÿåˆ†è£‚(split)ï¼Œä¸æ–­åˆ†è£‚çš„ç»“æœä¼šå¯¼è‡´ä¸å‡è¡¡ï¼›</p><p>  æˆ–è€…åŠ¨æ€æ‰©å®¹å¢åŠ åˆ†ç‰‡æ—¶ï¼Œä¹Ÿä¼šå‡ºç°ä¸å‡è¡¡çš„çŠ¶æ€ã€‚ è¿™ç§ä¸å‡è¡¡çš„çŠ¶æ€ç”±é›†ç¾¤å‡è¡¡å™¨è¿›è¡Œæ£€æµ‹ï¼Œä¸€æ—¦å‘ç°äº†ä¸å‡è¡¡åˆ™æ‰§è¡Œ chunkæ•°æ®çš„æ¬è¿è¾¾åˆ°å‡è¡¡ã€‚</p><p>  æ•°æ®å‡è¡¡å™¨è¿è¡Œäº Primary Config Server(é…ç½®æœåŠ¡å™¨çš„ä¸»èŠ‚ç‚¹)ä¸Š</p><p>  MongoDB çš„æ•°æ®è¿ç§»å¯¹é›†ç¾¤æ€§èƒ½å­˜åœ¨ä¸€å®šå½±å“ï¼Œè¿™ç‚¹æ— æ³•é¿å…ï¼Œç›®å‰çš„è§„é¿æ‰‹æ®µåªèƒ½æ˜¯å°†å‡è¡¡çª—å£å¯¹é½åˆ°ä¸šåŠ¡é—²æ—¶æ®µã€‚</p></li></ul><p>============å¦‚ä½•åˆ¤æ–­ chunk æ˜¯å¦å‡è¡¡</p><p>å¯¹äºæ•°æ®çš„ä¸å‡è¡¡æ˜¯æ ¹æ®ä¸¤ä¸ªåˆ†ç‰‡ä¸Šçš„ Chunk ä¸ªæ•°å·®å¼‚æ¥åˆ¤å®šçš„, æœ‰è§„å®šçš„é˜ˆå€¼è¡¨,(è§„å®šäº†å¯¹äºå¤šå¤§è§„æ¨¡çš„ shard, chunk ä¸ªæ•°å·®å¼‚ä¸å¾—å¤§äºå¤šå°‘)</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="53-å‰¯æœ¬é›†">5.3. å‰¯æœ¬é›†<a href="#53-å‰¯æœ¬é›†" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>å‰¯æœ¬é›†å¯ä»¥ä½œä¸º Shard Cluster ä¸­çš„ä¸€ä¸ªShard(ç‰‡)ä¹‹å¤–ï¼Œå¯¹äºè§„æ¨¡è¾ƒå°çš„ä¸šåŠ¡æ¥è¯´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå•å‰¯æœ¬é›†çš„æ–¹å¼è¿›è¡Œéƒ¨ç½², ä¹‹åéšä¸šåŠ¡é‡å˜å¤§ç¼“æ…¢è¿‡åº¦åˆ° shard cluster (<a href="https://docs.mongodb.com/manual/tutorial/convert-replica-set-to-replicated-shard-cluster/" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/manual/tutorial/convert-replica-set-to-replicated-shard-cluster/</a>)</p><p>MongoDB çš„å‰¯æœ¬é›†é‡‡å–äº†ä¸€ä¸»å¤šä»çš„ç»“æ„ï¼Œå³ä¸€ä¸ªPrimary Node + N* Secondary Nodeçš„æ–¹å¼ï¼Œæ•°æ®ä»ä¸»èŠ‚ç‚¹å†™å…¥ï¼Œå¹¶å¤åˆ¶åˆ°å¤šä¸ªå¤‡èŠ‚ç‚¹ã€‚</p><p>åˆ©ç”¨å‰¯æœ¬é›†ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ï¼šï¼š</p><ul><li><p>æ•°æ®åº“é«˜å¯ç”¨ï¼Œ</p><p>  ä¸»èŠ‚ç‚¹å®•æœºåï¼Œç”±å¤‡èŠ‚ç‚¹è‡ªåŠ¨é€‰ä¸¾æˆä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼›</p></li><li><p>è¯»å†™åˆ†ç¦»ï¼Œ</p><p>  è¯»è¯·æ±‚å¯ä»¥åˆ†æµåˆ°å¤‡èŠ‚ç‚¹ï¼Œå‡è½»ä¸»èŠ‚ç‚¹çš„å•ç‚¹å‹åŠ›ã€‚</p><p>  è¯»å†™åˆ†ç¦»åªèƒ½å¢åŠ é›†ç¾¤&quot;è¯»&quot;çš„èƒ½åŠ›ï¼Œå¯¹äºå†™è´Ÿè½½éå¸¸é«˜çš„æƒ…å†µå´æ— èƒ½ä¸ºåŠ›ã€‚å¯¹æ­¤éœ€æ±‚ï¼Œä½¿ç”¨åˆ†ç‰‡é›†ç¾¤å¹¶å¢åŠ åˆ†ç‰‡ï¼Œæˆ–è€…æå‡æ•°æ®åº“èŠ‚ç‚¹çš„ç£ç›˜IOã€CPUèƒ½åŠ›å¯ä»¥å–å¾—ä¸€å®šæ•ˆæœã€‚</p></li></ul><p>=====================é€‰ä¸¾</p><p>é€šè¿‡ Raft ç®—æ³•æ¥å®Œæˆä¸»èŠ‚ç‚¹çš„é€‰ä¸¾ï¼Œè¿™ä¸ªç¯èŠ‚åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨å®Œæˆï¼Œå¦‚ä¸‹é¢çš„å‘½ä»¤ï¼š</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">config = {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    _id : &quot;my_replica_set&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    members : [</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {_id : 0, host : &quot;rs1.example.net:27017&quot;},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {_id : 1, host : &quot;rs2.example.net:27017&quot;},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        {_id : 2, host : &quot;rs3.example.net:27017&quot;},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># initiate å‘½ä»¤ç”¨äºå®ç°å‰¯æœ¬é›†çš„åˆå§‹åŒ–ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">rs.initiate(config)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åœ¨é€‰ä¸¾å®Œæˆåï¼Œé€šè¿‡ isMaster()å‘½ä»¤å°±å¯ä»¥çœ‹åˆ°é€‰ä¸¾çš„ç»“æœ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db.isMaster()</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;hosts&quot; : [</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;192.168.100.1:27030&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;192.168.100.2:27030&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;192.168.100.3:27030&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;setName&quot; : &quot;myReplSet&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;setVersion&quot; : 1,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;ismaster&quot; : true,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;secondary&quot; : false,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;primary&quot; : &quot;192.168.100.1:27030&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;me&quot; : &quot;192.168.100.1:27030&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;electionId&quot; : ObjectId(&quot;7fffffff0000000000000001&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;ok&quot; : 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä¸»èŠ‚ç‚¹çš„é€‰ä¸¾éœ€è¦æ»¡è¶³&quot;å¤§å¤šæ•°&quot;åŸåˆ™, ä¸ºäº†é¿å…å‡ºç°å¹³ç¥¨çš„æƒ…å†µï¼Œå‰¯æœ¬é›†çš„éƒ¨ç½²ä¸€èˆ¬é‡‡ç”¨æ˜¯åŸºæ•°ä¸ªèŠ‚ç‚¹ï¼Œæ¯”å¦‚3ä¸ª</p><p>=================å¿ƒè·³ failover</p><p>å‰¯æœ¬é›†ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½ä¼šå®šæ—¶å‘å…¶ä»–èŠ‚ç‚¹å‘é€å¿ƒè·³ï¼Œä»¥æ­¤æ¥æ„ŸçŸ¥å…¶ä»–èŠ‚ç‚¹çš„å˜åŒ–ï¼Œæ¯”å¦‚æ˜¯å¦å¤±æ•ˆã€æˆ–è€…è§’è‰²å‘ç”Ÿäº†å˜åŒ–ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒèŠ‚ç‚¹ä¼šæ¯2ç§’å‘å…¶ä»–èŠ‚ç‚¹å‘å‡ºå¿ƒè·³ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬äº†ä¸»èŠ‚ç‚¹ã€‚ å¦‚æœå¤‡èŠ‚ç‚¹åœ¨10ç§’å†…æ²¡æœ‰æ”¶åˆ°ä¸»èŠ‚ç‚¹çš„å“åº”å°±ä¼šä¸»åŠ¨å‘èµ·é€‰ä¸¾</p><p>åˆ©ç”¨å¿ƒè·³ï¼ŒMongoDB å‰¯æœ¬é›†å®ç°äº†è‡ªåŠ¨æ•…éšœè½¬ç§»çš„åŠŸèƒ½ failover (å³ primary node æŒ‚äº†, è‡ªåŠ¨é€‰ä¸¾æŸä¸ª slave node ä½œä¸ºæ–°çš„ primary node )</p><p>=================ä¸»å¤‡èŠ‚ç‚¹çš„æ•°æ®å¤åˆ¶ oplog</p><p>ä¸»èŠ‚ç‚¹å’Œå¤‡èŠ‚ç‚¹çš„æ•°æ®æ˜¯é€šè¿‡æ—¥å¿—(oplog)å¤åˆ¶æ¥å®ç°çš„ï¼Œè¿™å¾ˆç±»ä¼¼äº mysql çš„ binlog</p><p>åœ¨æ¯ä¸€ä¸ªå‰¯æœ¬é›†çš„èŠ‚ç‚¹ä¸­ï¼Œéƒ½ä¼šå­˜åœ¨ä¸€ä¸ªåä¸ºlocal.oplog.rsçš„ç‰¹æ®Šé›†åˆã€‚ å½“ Primary ä¸Šçš„å†™æ“ä½œå®Œæˆåï¼Œä¼šå‘è¯¥é›†åˆä¸­å†™å…¥ä¸€æ¡oplog; è€Œ Secondary åˆ™æŒç»­ä» Primary æ‹‰å–æ–°çš„ oplog å¹¶åœ¨æœ¬åœ°è¿›è¡Œå›æ”¾ä»¥è¾¾åˆ°åŒæ­¥çš„ç›®çš„</p><ul><li>oplog å¿…é¡»ä¿è¯æœ‰åºï¼Œé€šè¿‡ optime æ¥ä¿è¯ã€‚</li><li>oplog å¿…é¡»åŒ…å«èƒ½å¤Ÿè¿›è¡Œæ•°æ®å›æ”¾çš„å®Œæ•´ä¿¡æ¯ã€‚</li><li>oplog å¿…é¡»æ˜¯å¹‚ç­‰çš„ï¼Œå³å¤šæ¬¡å›æ”¾åŒä¸€æ¡æ—¥å¿—äº§ç”Ÿçš„ç»“æœç›¸åŒã€‚</li><li>oplog é›†åˆæ˜¯å›ºå®šå¤§å°çš„ï¼Œä¸ºäº†é¿å…å¯¹ç©ºé—´å ç”¨å¤ªå¤§ï¼Œæ—§çš„ oplog è®°å½•ä¼šè¢«æ»šåŠ¨å¼çš„æ¸…ç†</li></ul><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">{</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;ts&quot; : Timestamp(1446011584, 2),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;h&quot; : NumberLong(&quot;1687359108795812092&quot;),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;v&quot; : 2,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;op&quot; : &quot;i&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;ns&quot; : &quot;test.nosql&quot;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;o&quot; : { &quot;_id&quot; : ObjectId(&quot;563062c0b085733f34ab4129&quot;), &quot;name&quot; : &quot;mongodb&quot;, &quot;score&quot; : &quot;100&quot; }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ts æ“ä½œçš„ optimeï¼Œè¯¥å­—æ®µä¸ä»…ä»…åŒ…å«äº†æ“ä½œçš„æ—¶é—´æˆ³(timestamp)ï¼Œè¿˜åŒ…å«ä¸€ä¸ªè‡ªå¢çš„è®¡æ•°å™¨å€¼ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># h æ“ä½œçš„å…¨å±€å”¯ä¸€è¡¨ç¤º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># v oplog çš„ç‰ˆæœ¬ä¿¡æ¯</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># op æ“ä½œç±»å‹ï¼Œæ¯”å¦‚ i=insert,u=update..</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ns æ“ä½œé›†åˆï¼Œå½¢å¼ä¸º database.collection</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># o æŒ‡å…·ä½“çš„æ“ä½œå†…å®¹ï¼Œå¯¹äºä¸€ä¸ª insert æ“ä½œï¼Œåˆ™åŒ…å«äº†æ•´ä¸ªæ–‡æ¡£çš„å†…å®¹</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="54-mongo-ä¸­çš„-cap-æ”¯æŒ">5.4. mongo ä¸­çš„ cap æ”¯æŒ<a href="#54-mongo-ä¸­çš„-cap-æ”¯æŒ" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>å‚è€ƒ <a href="https://docs.mongodb.com/manual/applications/replication/" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/manual/applications/replication/</a></p><p>mongo çš„ shard cluster éœ€è¦ åœ¨ ä¸€è‡´æ€§ å’Œ å¯ç”¨æ€§ ä¸¤è€…æƒè¡¡, æ‰€ä»¥å…è®¸å®¢æˆ·ç«¯ä¸ºå…¶æ“ä½œè®¾å®šä¸€å®šçš„çº§åˆ«æˆ–è€…åå¥½ï¼ŒåŒ…æ‹¬è¿™äº›é…ç½®é¡¹ï¼š</p><ul><li><p>read preference</p><p>  è¯»å–åå¥½ï¼Œå¯æŒ‡å®šè¯»ä¸»èŠ‚ç‚¹ã€è¯»å¤‡èŠ‚ç‚¹ï¼Œæˆ–è€…æ˜¯ä¼˜å…ˆè¯»ä¸»ã€ä¼˜å…ˆè¯»å¤‡ã€å–æœ€è¿‘çš„èŠ‚ç‚¹</p><p>  è®¾ç½®ä¸º primaryï¼Œæ­¤æ—¶è¯»å†™éƒ½åœ¨ä¸»èŠ‚ç‚¹ä¸Šã€‚ è¿™ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä½†ä¸€æ—¦ä¸»èŠ‚ç‚¹å®•æœºä¼šå¯¼è‡´å¤±è´¥(å¯ç”¨æ€§é™ä½)</p><p>  è®¾ç½®ä¸º secondaryPreferedï¼Œæ­¤æ—¶å†™ä¸»ï¼Œä¼˜å…ˆè¯»å¤‡ï¼Œå¯ç”¨æ€§æé«˜äº†ï¼Œä½†æ•°æ®å­˜åœ¨å»¶è¿Ÿ(å‡ºç°ä¸ä¸€è‡´)</p></li><li><p>write concern</p><p>  å†™å…³æ³¨ï¼ŒæŒ‡å®šå†™å…¥ç»“æœè¾¾åˆ°ä»€ä¹ˆçŠ¶æ€æ—¶æ‰è¿”å›ï¼Œå¯ä»¥ä¸ºæ— åº”ç­”(none)ã€åº”ç­”(ack)ï¼Œæˆ–è€…æ˜¯å¤§å¤šæ•°èŠ‚ç‚¹å®Œæˆäº†æ•°æ®å¤åˆ¶ç­‰ç­‰</p><p>  å°†è¯»å†™å…³æ³¨éƒ½è®¾ç½®ä¸º majority(æ„æ€æ˜¯ å¤§å¤šæ•°)ï¼Œä¸€è‡´æ€§æå‡äº†ï¼Œä½†å¯ç”¨æ€§ä¹ŸåŒæ—¶é™ä½äº†(èŠ‚ç‚¹å¤±æ•ˆä¼šå¯¼è‡´å¤§å¤šæ•°å†™å¤±è´¥)</p></li><li><p>read concern</p><p>  è¯»å…³æ³¨ï¼ŒæŒ‡å®šè¯»å–çš„æ•°æ®ç‰ˆæœ¬å¤„äºæ€æ ·çš„çŠ¶æ€ï¼Œå¯ä»¥ä¸ºè¯»æœ¬åœ°ã€è¯»å¤§å¤šæ•°èŠ‚ç‚¹å†™å…¥ï¼Œæˆ–è€…æ˜¯çº¿æ€§è¯»(linearizable)ç­‰ç­‰ã€‚</p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/mongodb">mongodb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/nosql">nosql</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/db">db</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/money"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Investment Intro</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/monitor-system-grafana-prometheus-influxdb-hbase-time-serials-database"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">monitor-system-grafana-prometheusç›‘æ§ğŸ–¥</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#11-ç‰¹æ€§" class="table-of-contents__link toc-highlight">1.1. ç‰¹æ€§</a></li><li><a href="#12-å’Œ-mysql-æ¦‚å¿µå¯¹æ¯”" class="table-of-contents__link toc-highlight">1.2. å’Œ MySQL æ¦‚å¿µå¯¹æ¯”</a></li><li><a href="#13-å’Œ-es-å¯¹æ¯”" class="table-of-contents__link toc-highlight">1.3. å’Œ es å¯¹æ¯”</a></li><li><a href="#14-rdbms-å’Œ-nosql" class="table-of-contents__link toc-highlight">1.4. rdbms å’Œ nosql</a></li><li><a href="#21-ç‰¹ç‚¹" class="table-of-contents__link toc-highlight">2.1. ç‰¹ç‚¹</a></li><li><a href="#22-ä½¿ç”¨åœºæ™¯" class="table-of-contents__link toc-highlight">2.2. ä½¿ç”¨åœºæ™¯</a></li><li><a href="#31-å®‰è£…" class="table-of-contents__link toc-highlight">3.1. å®‰è£…</a><ul><li><a href="#311-docker-å®‰è£…" class="table-of-contents__link toc-highlight">3.1.1. docker å®‰è£…</a></li><li><a href="#312-å‹ç¼©åŒ…å®‰è£…" class="table-of-contents__link toc-highlight">3.1.2. å‹ç¼©åŒ…å®‰è£…</a></li></ul></li><li><a href="#32-ä½¿ç”¨" class="table-of-contents__link toc-highlight">3.2. ä½¿ç”¨</a><ul><li><a href="#321-å’Œ-spring-boot-é›†æˆ" class="table-of-contents__link toc-highlight">3.2.1. å’Œ spring boot é›†æˆ</a></li><li><a href="#322-ä½¿ç”¨-å‘½ä»¤è¡Œ" class="table-of-contents__link toc-highlight">3.2.2. ä½¿ç”¨ å‘½ä»¤è¡Œ</a></li></ul></li><li><a href="#41-ç´¢å¼•ä»‹ç»" class="table-of-contents__link toc-highlight">4.1. ç´¢å¼•ä»‹ç»</a></li><li><a href="#42-åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œç´¢å¼•" class="table-of-contents__link toc-highlight">4.2. åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œç´¢å¼•</a></li><li><a href="#43-ç´¢å¼•è¯„ä¼°ä¼˜åŒ–" class="table-of-contents__link toc-highlight">4.3. ç´¢å¼•è¯„ä¼°ä¼˜åŒ–</a></li><li><a href="#51-æ¶æ„å›¾" class="table-of-contents__link toc-highlight">5.1. æ¶æ„å›¾</a></li><li><a href="#52-åˆ†ç‰‡æœºåˆ¶" class="table-of-contents__link toc-highlight">5.2. åˆ†ç‰‡æœºåˆ¶</a></li><li><a href="#53-å‰¯æœ¬é›†" class="table-of-contents__link toc-highlight">5.3. å‰¯æœ¬é›†</a></li><li><a href="#54-mongo-ä¸­çš„-cap-æ”¯æŒ" class="table-of-contents__link toc-highlight">5.4. mongo ä¸­çš„ cap æ”¯æŒ</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">å†å²</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/en/archive">Archive</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social Media</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/about">About Me</a></li><li class="footer__item"><a href="https://github.com/xiaoyureed" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/xiaoyuhfq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/3fPgwd3naN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/en/friends">Friends</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/en/resource">Links</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p><a href="http://beian.miit.gov.cn/">é—½ICPå¤‡2020017848å·-2</a></p><p>Copyright Â© 2020 â€“ PRESENT kuizuo Built with Docusaurus.</p></div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.97306ba3.js"></script>
<script src="/en/assets/js/main.8d84d9e1.js"></script>
</body>
</html>