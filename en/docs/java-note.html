<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-java-note">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Java Core ç¬”è®° | Xiaoyureed&#x27;s ç½‘ç»œ Wiki </title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xiaoyureed.github.io/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xiaoyureed.github.io/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xiaoyureed.github.io/en/docs/java-note"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Java Core ç¬”è®° | Xiaoyureed&#x27;s ç½‘ç»œ Wiki "><meta data-rh="true" name="description" content="https://github.com/remkop/picocli å‘½ä»¤è¡Œå¼€å‘"><meta data-rh="true" property="og:description" content="https://github.com/remkop/picocli å‘½ä»¤è¡Œå¼€å‘"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xiaoyureed.github.io/en/docs/java-note"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/en/docs/java-note" hreflang="en"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/java-note" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/java-note" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Xiaoyureed&#39;s ç½‘ç»œ Wiki  RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Xiaoyureed&#39;s ç½‘ç»œ Wiki  Atom Feed"><link rel="stylesheet" href="/en/assets/css/styles.c6a654bf.css">
<link rel="preload" href="/en/assets/js/runtime~main.b94328d8.js" as="script">
<link rel="preload" href="/en/assets/js/main.fc98d8e0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.png" alt="xiaoyureed Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.png" alt="xiaoyureed Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Xiaoyureed</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/en/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/xiaoyureed" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/FreeMarker-note">FreeMarker Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/SpringBoot-note">Spring Boot å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/agile-development-user-story-scrum">æ•æ·å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/android">Android å¼€å‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/autohotkey">Autohotkey è„šæœ¬</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/blockchain">blockchainåŒºå—é“¾</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/c-sharp-and-dot-net">C# &amp; .NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/chatgpt">Chatgpt Usage Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cloud-native-platform">äº‘æœåŠ¡å¹³å°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cpp">CPP and C å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cross-gfw">Cross The GFW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cs-note">Computer Science Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/css-pre-processor">å‡ ç§CSSé¢„å¤„ç†å™¨æ¯”è¾ƒé€‰å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/data-structure-and-algorithm">Data Structure and Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/design-pattern-note">Design Pattern ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/dev-resources">å¼€å‘è€…èµ„æº</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/devops">DevOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/distributed-system">Distributed System åˆ†å¸ƒå¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/docker-note-virtual-dev-env">Docker Note &amp; Other Virtual Develop Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/effective-java-reading-note">Effective Java é˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/elk-elastic-log">Distributed log collectionåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/english-note">è‹±è¯­å­¦ä¹ ğŸ”¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/extjs-note">Extjs ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/flutter">flutter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/games-development-introduce">æ¸¸æˆå¼€å‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/git-note">Git å¤‡å¿˜ ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/github-starts">Github æ˜Ÿæ ‡â­ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/golang-note">Golang ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/gps-gis-tracing">åŸºäºåœ°ç†ä½ç½®å¼€å‘æŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/gradle">gradle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/greasy-monkey">æ²¹çŒ´æ’ä»¶&amp;ç¼–å†™è„šæœ¬ğŸ’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/groovy-note">groovy note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/health">Health å…³çˆ±ç¨‹åºå‘˜å¥åº·ğŸ¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/how-to-test-java-app">How to Test Java App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/html-note">HTML å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/idea-note">InteliJ idea tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/interview-system-design">ç»å…¸çš„ç³»ç»Ÿè®¾è®¡æ€è·¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/iot">Iot ç‰©è”ç½‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-code-clean">Java Clean Code Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-concurrent">Java ConcurrentğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-memory-model-jmm-jvm">JMM and GCğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/en/docs/java-note">Java Core ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/jquery-note">JQuery notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/js-tutorial">JavaScript tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/kotlin">kotlin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/kubernetes-k8s">kubernetes-k8s â˜ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/linux-note">é¸Ÿå“¥çš„ Linux ç§æˆ¿èœé˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mac">Mac å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/machine-learning-ml">machine-learning-ml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/maven-note">Maven NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/message-queue">Message QueueğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/money">Investment Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mongodb-note">MongoDB NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/monitor-system-grafana-prometheus-influxdb-hbase">monitor-system-grafana-prometheusç›‘æ§ğŸ–¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mvc-mvvm">MVC to MVVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mybatis-note">MyBatis Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/netty-note">netty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/nlp-natural-language-processing">nlp-natural-language-processingğŸ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/nodejs-yarn-npm">Nodejs, Yarn, Npm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/oracle">Oracle å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-audio-video">Audio and Video development Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-big-data-introduce">å¤§æ•°æ®å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-cache">Cache ç¼“å­˜ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-computational-ad">è®¡ç®—å¹¿å‘Š Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-crawler-spider">ç½‘ç»œçˆ¬è™« Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-db-design-note">å…³ç³»å‹æ•°æ®åº“è¡¨è®¾è®¡ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-desktop-develop">æ¡Œé¢åº”ç”¨å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-http">HTTP protocol Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-reactive-programming">å“åº”å¼ç¼–ç¨‹ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-rest-api">RESTful api åŠ å…¶ä»–webServiceæŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-rpc">RPC Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-rule-engine-note">è§„åˆ™å¼•æ“ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/php-note">PHP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/play-framework">Playæ¡†æ¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/postgres-note">Postgres noteğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/process-workflow-bpm-engine">å·¥ä½œæµå¼•æ“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/protect-your-app-authentication-oauth2-jwt-https">Protect Your App å®‰å…¨ä¿æŠ¤è®¤è¯é‰´æƒğŸ”‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/python-note">PythonğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/quant-money">é‡åŒ–äº¤æ˜“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/quarkus">Quarkus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/react-note">ReactğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/real-time-communication-protocol">å®æ—¶é€šä¿¡ Real-time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/redis-note">RedisğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/regex">Regular Expression æ­£åˆ™ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/rust-note">Rust ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/saas-paas-iaas-as-a-service">SaaS Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/serverless">Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/service-mesh">service mesh æœåŠ¡ç½‘æ ¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/servlet">Servlet Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/shell-bash-note">shell-bashè„šæœ¬æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/spring-note">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/springcloud-note">Spring Cloud ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/springmvc-note">Spring MVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/task-schedule-note">Task Schedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/tcp-ip-note">TCP IP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/tomcat-jetty-nginx">Tomcat Jetty Nginx ç­‰ web å®¹å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/vertx">Vertx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/video-creator">æ‹æ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/webassembly">webassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/webpack-esbuild-vite-rollup">å‰ç«¯æ‰“åŒ…æ„å»ºå·¥å…·</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/windows-sub-system-on-linux">WSL ä½¿ç”¨</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Java Core ç¬”è®°</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Java Core ç¬”è®°</h1></header><p><a href="https://github.com/remkop/picocli" target="_blank" rel="noopener noreferrer">https://github.com/remkop/picocli</a> å‘½ä»¤è¡Œå¼€å‘</p><p> sentry grafana prometheus youtrack</p><p><a href="https://github.com/akullpp/awesome-java" target="_blank" rel="noopener noreferrer">https://github.com/akullpp/awesome-java</a>
<a href="https://github.com/CodingDocs/awesome-java" target="_blank" rel="noopener noreferrer">https://github.com/CodingDocs/awesome-java</a> ä¸­æ–‡ç‰ˆ</p><p>Java core note.
<a href="https://docs.oracle.com/javase/tutorial/" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/tutorial/</a>
jdk 8u192 æ˜¯æœ€åçš„å…è´¹ç‰ˆæœ¬, ä¹‹åçš„éƒ½è¦æ”¶è´¹äº†</p><p><a href="https://www.jianshu.com/p/a06aa86c6b27" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/a06aa86c6b27</a> (Jodconvert , æ˜¯ä¸€ä¸ª java çš„æ–‡æ¡£è½¬æ¢å™¨, åˆ©ç”¨ openoffice æˆ– libreOffice æ¥è¿›è¡Œæ–‡æ¡£æ ¼å¼è½¬æ¢.)</p><p><a href="https://godbolt.org/" target="_blank" rel="noopener noreferrer">https://godbolt.org/</a> - åœ¨çº¿æœºå™¨ç è½¬æ¢</p><p><a href="https://github.com/qiurunze123" target="_blank" rel="noopener noreferrer">https://github.com/qiurunze123</a> - é«˜å¹¶å‘</p><p><a href="https://github.com/Snailclimb/awesome-java#%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F" target="_blank" rel="noopener noreferrer">https://github.com/Snailclimb/awesome-java#%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F</a> awesome java</p><ul><li><a href="#1-%E5%90%84%E4%B8%AA%E7%89%88%E6%9C%AC">1. å„ä¸ªç‰ˆæœ¬</a></li><li><a href="#2-%E6%B3%A8%E9%87%8A">2. æ³¨é‡Š</a></li><li><a href="#3-%E5%8F%8D%E5%B0%84reflect">3. åå°„reflect</a><ul><li><a href="#31-%E5%8F%8D%E5%B0%84%E7%9A%84-api">3.1. åå°„çš„ api</a></li><li><a href="#32-%E5%AE%9E%E7%8E%B0%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8%E6%9C%BA%E5%88%B6">3.2. å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶</a></li></ul></li><li><a href="#4-java-%E5%B9%B6%E5%8F%91-%E5%A4%9A%E7%BA%BF%E7%A8%8B">4. java å¹¶å‘-å¤šçº¿ç¨‹</a></li><li><a href="#5-%E9%9B%86%E5%90%88">5. é›†åˆ</a><ul><li><a href="#51-%E9%9B%86%E5%90%88%E7%9A%84%E4%BD%93%E7%B3%BB">5.1. é›†åˆçš„ä½“ç³»</a></li><li><a href="#52-%E8%AF%BB%E6%BA%90%E7%A0%81">5.2. è¯»æºç </a><ul><li><a href="#521-%E6%95%B0%E7%BB%84%E5%92%8C%E9%93%BE%E8%A1%A8%E5%8C%BA%E5%88%AB">5.2.1. æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«</a></li><li><a href="#522-%E5%8D%95%E9%93%BE%E8%A1%A8%E5%92%8C%E5%8F%8C%E9%93%BE%E8%A1%A8%E5%8C%BA%E5%88%AB">5.2.2. å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«</a></li><li><a href="#523-hashmap">5.2.3. HashMap</a></li><li><a href="#524-hashset">5.2.4. HashSet</a></li><li><a href="#525-hashtable">5.2.5. HashTable</a></li><li><a href="#526-linkedhashmap">5.2.6. LinkedHashMap</a></li><li><a href="#527-treemap">5.2.7. TreeMap</a></li><li><a href="#528-lindedhashset">5.2.8. LindedHashSet</a></li><li><a href="#529-arraylist-%E5%92%8C-vector">5.2.9. ArrayList å’Œ Vector</a></li><li><a href="#5210-linkedlist">5.2.10. LinkedList</a></li><li><a href="#5211-concurrenthashmap">5.2.11. ConcurrentHashMap</a></li></ul></li><li><a href="#53-collections-%E5%92%8C-arrays-%E5%B7%A5%E5%85%B7%E7%B1%BB">5.3. Collections å’Œ Arrays å·¥å…·ç±»</a></li><li><a href="#54-%E9%9B%86%E5%90%88%E6%8E%92%E5%BA%8F">5.4. é›†åˆæ’åº</a></li></ul></li><li><a href="#6-%E6%B3%9B%E5%9E%8B">6. æ³›å‹</a><ul><li><a href="#61-%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95-%E6%B3%9B%E5%9E%8B%E7%B1%BB-%E6%B3%9B%E5%9E%8B%E6%8E%A5%E5%8F%A3">6.1. æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£</a></li><li><a href="#62-%E6%B3%9B%E5%9E%8B%E5%8F%8D%E5%B0%84">6.2. æ³›å‹åå°„</a><ul><li><a href="#621-%E6%B3%9B%E5%9E%8B%E5%8F%8D%E5%B0%84-api">6.2.1. æ³›å‹åå°„ api</a></li><li><a href="#622-%E6%A1%88%E4%BE%8B-%E4%BC%98%E5%8C%96-basedao">6.2.2. æ¡ˆä¾‹-ä¼˜åŒ– BaseDao</a></li></ul></li></ul></li><li><a href="#7-%E6%B3%A8%E8%A7%A3">7. æ³¨è§£</a><ul><li><a href="#71-%E8%AF%AD%E6%B3%95">7.1. è¯­æ³•</a></li><li><a href="#72-%E5%85%83%E6%B3%A8%E8%A7%A3">7.2. å…ƒæ³¨è§£</a></li><li><a href="#73-%E6%B3%A8%E8%A7%A3%E5%8F%8D%E5%B0%84">7.3. æ³¨è§£åå°„</a></li><li><a href="#74-%E7%9C%8B%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%E4%BC%98%E5%8C%96-dao-%E8%A7%A3%E5%86%B3%E5%AD%97%E6%AE%B5%E5%92%8C%E5%B1%9E%E6%80%A7%E4%B8%8D%E4%B8%80%E8%87%B4">7.4. çœ‹ä¸€ä¸ªä¾‹å­ä¼˜åŒ– dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´</a><ul><li><a href="#741-%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E4%BC%98%E5%8C%96-javabean">7.4.1. é€šè¿‡æ³¨è§£ä¼˜åŒ– JavaBean</a></li><li><a href="#742-%E6%B3%9B%E5%9E%8B%E5%8F%8D%E5%B0%84%E4%BC%98%E5%8C%96-basedao">7.4.2. æ³›å‹åå°„ä¼˜åŒ– BaseDao</a></li><li><a href="#743-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%9C%E9%9B%86-handler">7.4.3. è‡ªå®šä¹‰ç»“æœé›† handler</a></li></ul></li></ul></li><li><a href="#8-io">8. io</a><ul><li><a href="#81-io%E6%80%BB%E7%BB%93">8.1. ioæ€»ç»“</a></li><li><a href="#82-socket-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B">8.2. socket ç½‘ç»œç¼–ç¨‹</a></li><li><a href="#83-%E9%98%BB%E5%A1%9E-io">8.3. é˜»å¡ io</a><ul><li><a href="#831-%E4%BB%80%E4%B9%88%E6%98%AF%E9%98%BB%E5%A1%9E-io">8.3.1. ä»€ä¹ˆæ˜¯é˜»å¡ io</a></li><li><a href="#832-io-%E4%BD%93%E7%B3%BB%E7%9A%84%E6%95%B4%E4%B8%AA%E6%A6%82%E8%A7%88">8.3.2. io ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ</a></li><li><a href="#833-paths-%E5%92%8C-files-%E7%9B%B8%E5%85%B3-api">8.3.3. Paths å’Œ Files ç›¸å…³ api</a><ul><li><a href="#8331-paths-%E7%9A%84%E8%8E%B7%E5%8F%96%E8%BD%AC%E5%8C%96">8.3.3.1. Paths çš„è·å–è½¬åŒ–</a></li><li><a href="#8332-%E9%80%9A%E8%BF%87-files-paths-%E8%AF%BB%E5%8F%96%E5%86%99%E5%85%A5">8.3.3.2. é€šè¿‡ Files Paths è¯»å–å†™å…¥</a></li><li><a href="#8333-%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E5%A4%B9">8.3.3.3. éå†æ–‡ä»¶å¤¹</a></li><li><a href="#8334-%E9%80%9A%E8%BF%87-files-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7">8.3.3.4. é€šè¿‡ files è·å–æ–‡ä»¶å±æ€§</a></li></ul></li><li><a href="#834-bio-tcp-%E5%AE%9E%E7%8E%B0%E9%80%9A%E4%BF%A1">8.3.4. bio tcp å®ç°é€šä¿¡</a></li></ul></li><li><a href="#84-%E9%9D%9E%E9%98%BB%E5%A1%9E-io">8.4. éé˜»å¡ io</a><ul><li><a href="#841-%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%9E%E9%98%BB%E5%A1%9E-io">8.4.1. ä»€ä¹ˆæ˜¯éé˜»å¡ io</a></li><li><a href="#842-%E5%90%8C%E6%AD%A5%E5%BC%82%E6%AD%A5%E5%92%8C%E9%98%BB%E5%A1%9E%E9%9D%9E%E9%98%BB%E5%A1%9E">8.4.2. åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡</a><ul><li><a href="#8421-%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%BC%82%E6%AD%A5">8.4.2.1. åŒæ­¥ä¸å¼‚æ­¥</a></li><li><a href="#8422-%E9%98%BB%E5%A1%9E%E4%B8%8E%E9%9D%9E%E9%98%BB%E5%A1%9E">8.4.2.2. é˜»å¡ä¸éé˜»å¡</a></li><li><a href="#8423-%E5%9B%9B%E7%A7%8D%E7%BB%84%E5%90%88">8.4.2.3. å››ç§ç»„åˆ</a></li></ul></li></ul></li><li><a href="#85-%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8-io-%E5%8D%B3-java-nio">8.5. å¤šè·¯å¤ç”¨ IO å³ java nio</a><ul><li><a href="#851-%E8%A7%A3%E9%87%8A%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8">8.5.1. è§£é‡Šå¤šè·¯å¤ç”¨</a></li><li><a href="#852-nio-%E5%92%8C-io-%E5%8C%BA%E5%88%AB">8.5.2. nio å’Œ io åŒºåˆ«</a></li><li><a href="#853-linux-%E4%B8%AD%E7%9A%84%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E6%94%AF%E6%8C%81">8.5.3. Linux ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ</a></li><li><a href="#854-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6">8.5.4. æ ¸å¿ƒç»„ä»¶</a><ul><li><a href="#8541-%E7%90%86%E8%A7%A3">8.5.4.1. ç†è§£</a></li><li><a href="#8542-channels">8.5.4.2. Channels</a></li><li><a href="#8543-buffers">8.5.4.3. Buffers</a></li><li><a href="#8544-selectors">8.5.4.4. Selectors</a></li></ul></li><li><a href="#855-nio-%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1">8.5.5. nio å®ç°ç½‘ç»œé€šä¿¡</a></li></ul></li><li><a href="#86-java-aio">8.6. java aio</a></li><li><a href="#87-%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0">8.7. æ–­ç‚¹ç»­ä¼ </a></li></ul></li><li><a href="#9-%E4%BB%A3%E7%90%86">9. ä»£ç†</a></li><li><a href="#10-java-%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B">10. Java å†…å­˜æ¨¡å‹</a></li><li><a href="#11-java8">11. java8</a><ul><li><a href="#111-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%A6%82%E5%BF%B5fp">11.1. å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µFP</a></li><li><a href="#112-java8-%E6%B7%BB%E5%8A%A0%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7">11.2. Java8 æ·»åŠ çš„æ–°ç‰¹æ€§</a><ul><li><a href="#1121-%E6%8E%A5%E5%8F%A3%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95">11.2.1. æ¥å£é»˜è®¤æ–¹æ³•</a></li><li><a href="#1122-functionalinterface-%E5%87%BD%E6%95%B0%E6%8E%A5%E5%8F%A3">11.2.2. @FunctionalInterface-å‡½æ•°æ¥å£</a></li><li><a href="#1123-%E6%96%B9%E6%B3%95%E7%9A%84%E5%BC%95%E7%94%A8">11.2.3. æ–¹æ³•çš„å¼•ç”¨</a></li><li><a href="#1124-lambda-%E8%A1%A8%E8%BE%BE%E5%BC%8F">11.2.4. Lambda è¡¨è¾¾å¼</a><ul><li><a href="#11241-lambda-%E4%BB%8B%E7%BB%8D">11.2.4.1. lambda ä»‹ç»</a></li><li><a href="#11242-lambda-%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%97%AE%E9%A2%98">11.2.4.2. Lambda ä½œç”¨åŸŸé—®é¢˜</a><ul><li><a href="#112421-%E8%AE%BF%E9%97%AE%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F">11.2.4.2.1. è®¿é—®å±€éƒ¨å˜é‡</a></li><li><a href="#112422-%E8%AE%BF%E9%97%AE%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F">11.2.4.2.2. è®¿é—®æˆå‘˜å˜é‡</a></li><li><a href="#112423-%E8%AE%BF%E9%97%AE%E9%BB%98%E8%AE%A4%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95">11.2.4.2.3. è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•</a></li></ul></li></ul></li></ul></li><li><a href="#113-java8-%E4%B8%AD%E7%9A%84%E5%B9%B6%E8%A1%8C%E6%B5%81">11.3. java8 ä¸­çš„å¹¶è¡Œæµ</a><ul><li><a href="#1131-%E4%BD%BF%E7%94%A8%E5%B9%B6%E8%A1%8C%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE">11.3.1. ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®</a></li><li><a href="#1132-%E4%BB%8E%E9%9B%86%E5%90%88%E5%BE%97%E5%88%B0%E5%B9%B6%E8%A1%8C%E6%B5%81">11.3.2. ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ</a></li><li><a href="#1133-%E5%B9%B6%E8%A1%8C%E6%8E%92%E5%BA%8F-%E7%BB%99%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC">11.3.3. å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼</a></li></ul></li><li><a href="#114-completablefuture-%E6%8E%A5%E5%8F%A3-%E5%A2%9E%E5%BC%BA%E7%9A%84-future">11.4. CompletableFuture æ¥å£-å¢å¼ºçš„ Future</a><ul><li><a href="#1141-java-%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B">11.4.1. java å¼‚æ­¥ç¼–ç¨‹</a></li><li><a href="#1142-%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D">11.4.2. åŸç†ä»‹ç»</a></li><li><a href="#1143-completablefuture-api">11.4.3. completablefuture api</a></li><li><a href="#1144-%E5%AE%8C%E6%88%90%E4%BA%86%E5%B0%B1%E9%80%9A%E7%9F%A5%E6%88%91-%E6%89%8B%E5%8A%A8%E5%A1%AB%E5%85%85%E7%BB%93%E6%9E%9C">11.4.4. å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ</a></li><li><a href="#1145-%E5%BC%82%E6%AD%A5%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1">11.4.5. å¼‚æ­¥æ‰§è¡Œä»»åŠ¡</a></li><li><a href="#1146-%E6%B5%81%E5%BC%8F%E8%B0%83%E7%94%A8%E7%BB%84%E5%90%88%E5%A4%9A%E4%B8%AA-function-%E5%92%8C-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">11.4.6. æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª function å’Œ å¼‚å¸¸å¤„ç†</a></li><li><a href="#1147-%E7%BB%84%E5%90%88%E5%A4%9A%E4%B8%AA-completablefuture">11.4.7. ç»„åˆå¤šä¸ª CompletableFuture</a></li></ul></li><li><a href="#115-stampedlock-%E8%AF%BB%E5%86%99%E9%94%81%E7%9A%84%E6%94%B9%E8%BF%9B">11.5. StampedLock-è¯»å†™é”çš„æ”¹è¿›</a></li><li><a href="#116-longadder-%E5%8E%9F%E5%AD%90%E7%B1%BB%E7%9A%84%E5%A2%9E%E5%BC%BA">11.6. LongAdder-åŸå­ç±»çš„å¢å¼º</a></li><li><a href="#117-java8-%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3">11.7. java8 å†…ç½®å‡½æ•°å¼æ¥å£</a><ul><li><a href="#1171-predicates%E8%B0%93%E8%AF%8D-%E6%96%AD%E5%AE%9A">11.7.1. Predicatesè°“è¯, æ–­å®š</a></li><li><a href="#1172-functions%E5%87%BD%E6%95%B0">11.7.2. Functionså‡½æ•°</a></li><li><a href="#1173-suppliers%E7%94%9F%E4%BA%A7%E8%80%85">11.7.3. Suppliersç”Ÿäº§è€…</a></li><li><a href="#1174-consumers%E6%B6%88%E8%B4%B9%E8%80%85">11.7.4. Consumersæ¶ˆè´¹è€…</a></li><li><a href="#1175-comparators%E6%AF%94%E8%BE%83%E5%99%A8">11.7.5. Comparatorsæ¯”è¾ƒå™¨</a></li><li><a href="#1176-optional">11.7.6. Optional</a></li></ul></li><li><a href="#118-streams%E7%AE%A1%E9%81%93">11.8. Streamsç®¡é“</a><ul><li><a href="#1181-stream-%E4%BB%8B%E7%BB%8D">11.8.1. stream ä»‹ç»</a></li><li><a href="#1182-%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8-stream">11.8.2. é‡å¤ä½¿ç”¨ stream</a></li><li><a href="#1183-map-%E5%92%8C-flatmap">11.8.3. map å’Œ flatMap</a></li><li><a href="#1184-%E5%8E%BB%E9%87%8D">11.8.4. å»é‡</a></li><li><a href="#1185-collect%E6%96%B9%E6%B3%95-%E5%A6%82%E4%BD%95%E6%94%B6%E9%9B%86%E5%A4%84%E7%90%86%E5%90%8E%E7%9A%84%E5%85%83%E7%B4%A0-%E5%88%86%E7%BB%84-%E5%8E%BB%E9%87%8D">11.8.5. collectæ–¹æ³• å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´  åˆ†ç»„ å»é‡</a></li><li><a href="#1186-stream-%E4%B8%AD%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">11.8.6. stream ä¸­å¼‚å¸¸å¤„ç†</a></li></ul></li><li><a href="#119-date-%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E6%96%B0%E7%9A%84-api">11.9. date æ—¶é—´æ—¥æœŸæ–°çš„ api</a><ul><li><a href="#1191-%E4%BB%8B%E7%BB%8D-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8">11.9.1. ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨</a></li><li><a href="#1192-%E4%BD%BF%E7%94%A8%E6%96%B0%E7%9A%84%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F-api">11.9.2. ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ api</a></li><li><a href="#1193-%E7%BB%9F%E8%AE%A1%E4%BB%A3%E7%A0%81%E8%80%97%E6%97%B6">11.9.3. ç»Ÿè®¡ä»£ç è€—æ—¶</a></li></ul></li><li><a href="#1110-%E5%8F%AF%E9%87%8D%E5%A4%8D%E7%9A%84-annotations">11.10. å¯é‡å¤çš„ Annotations</a></li><li><a href="#1111-base64-%E7%BC%96%E7%A0%81">11.11. base64 ç¼–ç </a></li><li><a href="#1112-map-%E6%98%A0%E5%B0%84%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95">11.12. map æ˜ å°„çš„æ–°æ–¹æ³•</a></li></ul></li><li><a href="#12-java11">12. java11</a><ul><li><a href="#121-java-module">12.1. java module</a></li><li><a href="#122-jshell">12.2. jshell</a></li><li><a href="#123-var-%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD">12.3. var ç±»å‹æ¨æ–­</a></li><li><a href="#124-jdk-api-enhencement">12.4. jdk api enhencement</a></li><li><a href="#125-%E6%94%B9%E8%BF%9B-java-%E7%A8%8B%E5%BA%8F%E5%9C%A8-docker-%E4%B8%AD%E7%9A%84%E8%A1%A8%E7%8E%B0">12.5. æ”¹è¿› java ç¨‹åºåœ¨ docker ä¸­çš„è¡¨ç°</a></li><li><a href="#126-%E6%96%B0%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8">12.6. æ–°çš„åƒåœ¾å›æ”¶å™¨</a></li></ul></li><li><a href="#13-classloader-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8">13. classloader ç±»åŠ è½½å™¨</a><ul><li><a href="#131-classloader-%E7%9A%84%E6%A6%82%E5%BF%B5">13.1. classloader çš„æ¦‚å¿µ</a></li><li><a href="#132-%E5%B1%82%E7%BA%A7%E7%BB%93%E6%9E%84">13.2. å±‚çº§ç»“æ„</a></li><li><a href="#133-%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B-and-%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%A8%A1%E5%BC%8F">13.3. å·¥ä½œè¿‡ç¨‹ and åŒäº²å§”æ´¾æ¨¡å¼</a></li><li><a href="#134-%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8-%E6%89%93%E4%B9%B1%E5%B1%82%E7%BA%A7%E7%BB%93%E6%9E%84">13.4. çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„</a></li><li><a href="#135-%E5%80%9F%E5%8A%A9-classloader-%E5%AE%9E%E7%8E%B0%E7%B1%BB%E9%9A%94%E7%A6%BB">13.5. å€ŸåŠ© classloader å®ç°ç±»éš”ç¦»</a></li><li><a href="#136-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E7%9B%B8%E5%85%B3%E7%9A%84%E5%BC%82%E5%B8%B8">13.6. ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸</a></li><li><a href="#137-%E8%87%AA%E5%AE%9A%E4%B9%89-classloader%E5%8A%A0%E8%BD%BD%E7%BD%91%E7%BB%9C%E4%B8%8A%E7%9A%84-class">13.7. è‡ªå®šä¹‰ classloaderåŠ è½½ç½‘ç»œä¸Šçš„ class</a></li></ul></li><li><a href="#14-%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98">14. è·¯å¾„é—®é¢˜</a><ul><li><a href="#141-%E8%8E%B7%E5%8F%96-classpath-%E5%92%8C-%E7%B3%BB%E7%BB%9F%E5%B1%9E%E6%80%A7-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">14.1. è·å– classpath å’Œ ç³»ç»Ÿå±æ€§ ç¯å¢ƒå˜é‡</a></li></ul></li><li><a href="#15-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">15. æ•°æ®ç±»å‹</a><ul><li><a href="#151-%E5%90%84%E4%B8%AA%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%8C%83%E5%9B%B4">15.1. å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´</a></li><li><a href="#152-double-%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8A%A0%E5%87%8F%E4%B9%98%E9%99%A4">15.2. double ç±»å‹çš„åŠ å‡ä¹˜é™¤</a></li></ul></li><li><a href="#16-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4">16. æ§åˆ¶å°å‘½ä»¤</a><ul><li><a href="#161-%E6%89%93-jar-%E5%8C%85">16.1. æ‰“ jar åŒ…</a></li><li><a href="#162-%E7%94%9F%E6%88%90%E6%B3%A8%E9%87%8A%E6%96%87%E6%A1%A3-javadoc">16.2. ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£ javadoc</a></li><li><a href="#163-%E7%BC%96%E8%AF%91%E5%92%8C%E5%8F%8D%E7%BC%96%E8%AF%91">16.3. ç¼–è¯‘å’Œåç¼–è¯‘</a></li></ul></li><li><a href="#17-%E9%87%8D%E8%A6%81%E7%9A%84%E5%AF%B9%E8%B1%A1">17. é‡è¦çš„å¯¹è±¡</a><ul><li><a href="#171-object">17.1. Object</a></li><li><a href="#172-string">17.2. String</a></li></ul></li><li><a href="#18-%E5%AD%97%E8%8A%82%E7%A0%81%E7%BC%96%E8%BE%91%E6%8A%80%E6%9C%AF">18. å­—èŠ‚ç ç¼–è¾‘æŠ€æœ¯</a><ul><li><a href="#181-javassist">18.1. javassist</a></li></ul></li><li><a href="#19-%E5%89%8D%E6%B2%BF">19. å‰æ²¿</a><ul><li><a href="#191-graalvm">19.1. graalvm</a></li><li><a href="#192-vertx">19.2. vertx</a></li><li><a href="#193-micronaut">19.3. Micronaut</a></li><li><a href="#194-quarkus">19.4. Quarkus</a></li></ul></li><li><a href="#20-%E6%8B%BE%E9%81%97">20. æ‹¾é—</a><ul><li><a href="#201-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-regex">20.1. æ­£åˆ™è¡¨è¾¾å¼ regex</a></li><li><a href="#202-%E9%9D%99%E6%80%81%E7%BB%91%E5%AE%9A%E5%92%8C%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A">20.2. é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š</a></li><li><a href="#203-%E9%87%8D%E8%BD%BD-and-%E9%87%8D%E5%86%99">20.3. é‡è½½ and é‡å†™</a></li><li><a href="#204-java-%E5%80%BC%E4%BC%A0%E9%80%92-or-%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92">20.4. java å€¼ä¼ é€’ or å¼•ç”¨ä¼ é€’</a></li><li><a href="#205-%E8%AE%BF%E9%97%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6-public-protect-default-private">20.5. è®¿é—®ä¿®é¥°ç¬¦ public-protect-default-private</a></li><li><a href="#206-getcontextclassloadergetclassloader-%E5%8C%BA%E5%88%AB">20.6. getcontextclassloader&amp;getclassloader åŒºåˆ«</a></li><li><a href="#207-getter-%E5%92%8C-setter-%E5%AD%98%E5%9C%A8%E7%9A%84%E6%84%8F%E4%B9%89">20.7. getter å’Œ setter å­˜åœ¨çš„æ„ä¹‰</a></li><li><a href="#208-%E4%B8%BA%E4%BB%80%E4%B9%88-service-%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E5%AE%9E%E7%8E%B0%E4%B9%9F%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E6%8E%A5%E5%8F%A3">20.8. ä¸ºä»€ä¹ˆ service åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£</a></li><li><a href="#209-static-%E5%85%B3%E9%94%AE%E5%AD%97">20.9. static å…³é”®å­—</a></li><li><a href="#2010-%E5%86%85%E9%83%A8%E7%B1%BB-or-%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB">20.10. å†…éƒ¨ç±» or é™æ€å†…éƒ¨ç±»</a><ul><li><a href="#20101-%E5%86%85%E9%83%A8%E7%B1%BB">20.10.1. å†…éƒ¨ç±»</a></li><li><a href="#20102-%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB">20.10.2. é™æ€å†…éƒ¨ç±»</a></li></ul></li><li><a href="#2011-java-%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%BA%E5%BA%8F">20.11. Java ç±»åˆå§‹åŒ–é¡ºåº</a></li><li><a href="#2012-random-%E9%9A%8F%E6%9C%BA%E6%95%B0">20.12. Random-éšæœºæ•°</a></li><li><a href="#2013-%E4%BD%8D%E8%BF%90%E7%AE%97">20.13. ä½è¿ç®—</a></li><li><a href="#2014-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8C%85%E5%90%8D%E9%83%BD%E5%B0%8F%E5%86%99">20.14. ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™</a></li><li><a href="#2015-%E5%A4%84%E7%90%86-unicode-%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98">20.15. å¤„ç† unicode ç¼–ç é—®é¢˜</a></li><li><a href="#2016-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E5%86%8D%E6%AC%A1%E8%B5%8B%E5%80%BC%E7%BB%99%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F">20.16. ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡</a></li><li><a href="#2017-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%AE%9A%E4%B9%89%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E4%B8%8D%E7%94%A8%E8%B5%8B%E5%80%BC%E8%80%8C%E5%AE%9A%E4%B9%89%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E5%BF%85%E9%A1%BB%E8%B5%8B%E5%80%BC">20.17. ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼</a></li></ul></li><li><a href="#21-%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE">21. å¼€æºé¡¹ç›®</a><ul><li><a href="#211-%E5%8D%9A%E5%AE%A2-cms-%E7%B3%BB%E7%BB%9F">21.1. åšå®¢ cms ç³»ç»Ÿ</a></li></ul></li><li><a href="#22-java-agent">22. java agent</a></li></ul><h1>1. å„ä¸ªç‰ˆæœ¬</h1><ul><li><p>jdk5: è‡ªåŠ¨è£…ç®±/æ‹†ç®±, æšä¸¾, é™æ€å¯¼å…¥(ä¸å®ç”¨), å¯å˜é•¿å‚æ•°(&quot;String... params&quot;), æ³›å‹, for-each å¾ªç¯, å¹¶å‘åº“(Concurrent)</p></li><li><p>jdk6: compiler api(åŠ¨æ€ç¼–è¯‘è¿è¡Œæ–‡æœ¬å½¢å¼çš„ Java ä»£ç ), console å¢å¼º(ç¼–å†™å‘½ä»¤è¡Œç¨‹åº, ä¸å®ç”¨), Desktop ç±»(æ‰“å¼€æµè§ˆå™¨, æ–‡ä»¶ç­‰ç­‰æ–¹æ³•)å’Œ SystemTray ç±», Http server api, script engine</p></li><li><p>jdk7: switch å¯¹ String æ”¯æŒ(æšä¸¾ä¹Ÿæ”¯æŒ), åˆ›å»ºæ³›å‹æ—¶çš„ç±»å‹æ¨æ–­(ä»å®šä¹‰çš„å˜é‡æ¨æ–­æ„é€ å‡½æ•°ä¸­çš„æ³›å‹), æ•è·å¤šç§å¼‚å¸¸(... catch (IOException | SQLException e) ...), æ•°å€¼ç±»å‹æ”¯æŒ&quot;<!-- -->_<!-- -->&quot;(å¦‚å®šä¹‰ 10s, ä½†æ˜¯å•ä½æ˜¯æ¯«ç§’: int mills = 10_000), try_auto_close_resource</p></li><li><p>jdk8: lambda express/å‡½æ•°å¼æ¥å£(@FunctionalInterface), æ¥å£é»˜è®¤æ–¹æ³•, æ¥å£é™æ€æ–¹æ³•, base64 å¢å¼º, Datetime å¢å¼º, Optional(é˜² null), Stream,</p></li></ul><p>long-term support: jdk8, 11, 17</p><h1>2. æ³¨é‡Š</h1><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä¸‹é¢è¿™è¡Œä¼šè¢«æ‰§è¡Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // \u000d sysout(&quot;hehe&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>3. åå°„(reflect)</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-åå°„çš„-api">3.1. åå°„çš„ api<a href="#31-åå°„çš„-api" class="hash-link" aria-label="Direct link to 3.1. åå°„çš„ api" title="Direct link to 3.1. åå°„çš„ api">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Class clazz1 = Class.forName(&quot;cn.itcast.reflect.Person&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class clazz2 = Person.class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class clazz3 = new Person(110,&quot;ç‹—å¨ƒ&quot;).getClass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Constructor[] constructors = clazz.getConstructors();// è·å–å…¬å¼€çš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Constructor[] constructors =  clazz.getDeclaredConstructors(); // è·å–æ‰€æœ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Constructor constructor = clazz.getConstructor(int.class,String.class);// æŒ‡å®š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">constructor.setAccessible(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Person p = (Person) constructor.newInstance(999,&quot;xiaoyu&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Method[] methods = clazz.getMethods();//å…¬å¼€çš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸åŒ…å«çˆ¶ç±»çš„æ–¹æ³•, æ²¡æ–¹æ³•, åˆ™è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º 0 çš„æ•°ç»„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Method m =clazz.getDeclaredMethod(&quot;sleep&quot;,int.class);// æ‰€æœ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Method m = clazz.getMethod(&quot;eat&quot;, int.class);//è·å–æŒ‡å®š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m.setAccessible(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m.invoke(null, 6);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Method m = clazz.getMethod(&quot;sum&quot;, int[].class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m.invoke(p,new int[]{12,5,9});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Field[] fields = clazz.getDeclaredFields();// æ‰€æœ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Field field = clazz.getDeclaredField(&quot;id&quot;);// æŒ‡å®š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">field.setAccessible(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">field.set(p, 110);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">getDeclaredAnnotation //getDeclaredAnnotationï¼ˆsï¼‰ï¼šè¿”å›ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šçš„æ‰€æœ‰æ³¨é‡Š, å¿½ç•¥ç»§æ‰¿çš„æ³¨é‡Š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">getAnnotationï¼ˆsï¼‰ï¼šè¿”å›æ­¤å…ƒç´ ä¸Šå­˜åœ¨çš„æ‰€æœ‰æ³¨é‡Š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶">3.2. å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶<a href="#32-å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶" class="hash-link" aria-label="Direct link to 3.2. å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶" title="Direct link to 3.2. å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*äº‹ä»¶å¤„ç†ç±»*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class EventHandler {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //äº‹ä»¶æº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Object sender;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //äº‹ä»¶å¤„ç†å‡½æ•°åç§°ï¼ˆç”¨äºåå°„ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String callback;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public EventHandler(Object sender, String callback){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.sender = sender;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.callback = callback;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //äº‹ä»¶è§¦å‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void emit(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Class senderType = this.sender.getClass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //è·å–å¹¶è°ƒç”¨äº‹ä»¶æºsenderçš„äº‹ä»¶å¤„ç†å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Method method = senderType.getMethod(this.callback);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        method.invoke(this.sender);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e2) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e2.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*äº‹ä»¶æº*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Button(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*å¯ä»¥åœ¨æ­¤è®¾ç½®Buttonç±»çš„ç›¸å…³å±æ€§ï¼Œæ¯”å¦‚åå­—ç­‰*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //äº‹ä»¶å¤„ç†å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void onClick(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;you just clicked me!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Button b = new Button();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if(/*æ”¶åˆ°æŒ‰é’®ç‚¹å‡»ä¿¡å·*/){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EventHandler e = new EventHandler(b, &quot;onClick&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    e.emit();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿˜æœ‰ä¸€ç§æ–¹å¼: è§‚å¯Ÿè€…æ¨¡å¼</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/*äº‹ä»¶ç±»*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Event {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ä¸äº‹ä»¶ç›¸å…³çš„äº‹ä»¶å¤„ç†å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ArrayList&lt;Callback&gt; callbackList;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //äº‹ä»¶è§¦å‘å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void emit(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for(Callback cb : callbackList){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cb.run();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //æ³¨å†Œäº‹ä»¶å¤„ç†å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public registerCallback(Callback cb){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        callbackList.add(cb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*äº‹ä»¶å¤„ç†å‡½æ•°ç±»*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface Callback {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void run();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public OnClick implements Callback {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void run(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;you just clicked me!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*å®ç°äº‹ä»¶é©±åŠ¨*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Event e = new Event();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//å°†OnClickäº‹ä»¶å¤„ç†å‡½æ•°æ³¨å†Œåˆ°äº‹ä»¶ä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e.registerCallback(new OnClick()); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//è§¦å‘äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e.emit();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>4. java å¹¶å‘-å¤šçº¿ç¨‹</h1><p>{% post_link java-concurrent ğŸ“š java-concurrent-reading-note %}</p><p>(è§ java-concurrent)</p><h1>5. é›†åˆ</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="51-é›†åˆçš„ä½“ç³»">5.1. é›†åˆçš„ä½“ç³»<a href="#51-é›†åˆçš„ä½“ç³»" class="hash-link" aria-label="Direct link to 5.1. é›†åˆçš„ä½“ç³»" title="Direct link to 5.1. é›†åˆçš„ä½“ç³»">â€‹</a></h2><p>(æ³¨: é›†åˆå’Œæ•°ç»„ä¸­å­˜æ”¾çš„éƒ½æ˜¯å¯¹è±¡çš„å¼•ç”¨è€Œéå¯¹è±¡æœ¬èº«;; ä»é›†åˆä¸­å–å‡ºå…ƒç´ æ˜¯ä½œä¸º Object å–å‡º, é™¤éæ³›å‹æŒ‡å®šäº†ç±»å‹)</p><ul><li><p>Collection å•åˆ—é›†åˆçš„æ ¹æ¥å£</p><ul><li><p>List å¦‚æœæ˜¯å®ç°äº† List æ¥å£çš„é›†åˆç±»ï¼Œ å…·å¤‡çš„ç‰¹ç‚¹ï¼šæœ‰åºï¼Œé‡å¤ã€‚</p><ul><li><p>ArraryList åº•å±‚ æ˜¯ä½¿ç”¨äº† Object æ•°ç»„å®ç°çš„ï¼Œç‰¹ç‚¹ï¼š æŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œå¢åˆ æ…¢ã€‚(å› ä¸ºå¢åˆ æ—¶å€™ä¼šæ¶‰åŠåˆ°æ•°ç»„æ‰©å®¹, æ‹·è´å…ƒç´ æ‰€ä»¥å¢åˆ æ…¢; æ•°ç»„å¯ä»¥æŒ‰ç…§ index æŸ¥æ‰¾å…ƒç´ , æ‰€ä»¥æŸ¥æ‰¾å¿«)</p></li><li><p>LinkedList åº•å±‚æ˜¯ä½¿ç”¨äº†åŒå‘é“¾è¡¨æ•°æ®ç»“æ„å®ç°çš„ï¼Œ ç‰¹ç‚¹ï¼š æŸ¥è¯¢é€Ÿåº¦æ…¢ï¼Œå¢åˆ å¿«ã€‚(å¢åˆ åªéœ€è¦æ”¹å˜æŸä¸€ä¸ªå…ƒç´ çš„ next å¼•ç”¨ä½¿å…¶æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ , æ‰€ä»¥å¢åˆ å¿«; æŸ¥è¯¢æ—¶å€™éœ€è¦ä¸€ä¸ªä¸ªéå†, æ‰€ä»¥æŸ¥è¯¢æ…¢)</p></li><li><p>Vector å®ç°ä¸ ArrayList æ˜¯ä¸€è‡´ï¼Œä½†æ˜¯æ˜¯çº¿ç¨‹å®‰å…¨ çš„ï¼Œæ“ä½œæ•ˆç‡ä½ã€‚</p></li></ul></li><li><p>Set å¦‚æœæ˜¯å®ç°äº† Set æ¥å£çš„é›†åˆç±»ï¼Œå…·å¤‡çš„ç‰¹ç‚¹ï¼šæ— åºï¼Œä¸å¯é‡å¤ã€‚</p><ul><li><p>HashSet åº•å±‚æ˜¯åŸºäº HashMap å®ç° (å“ˆå¸Œè¡¨)ï¼Œ ç‰¹ç‚¹ï¼šå­˜å–é€Ÿåº¦å¿«ã€‚ã€<!-- -->*<!-- -->ã€‘æ·»åŠ å…ƒç´ åŸç†: è°ƒç”¨å…ƒç´ çš„ hashcode() å¾—åˆ°å“ˆå¸Œç , è¿›è€Œè¿ç®—å¾—åˆ°å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®. <!-- -->[ä¸¤ç§æƒ…å†µ]<!-- --> å¦‚æœè¯¥ä½ç½®è¿˜æ²¡æœ‰å­˜ä»»ä½•å…ƒç´ , é‚£ä¹ˆç›´æ¥å­˜å‚¨; å¦‚æœè¯¥ä½ç½®æœ‰å…ƒç´ äº†åˆ™è°ƒç”¨å…ƒç´ çš„ equals() å’Œç›®æ ‡å…ƒç´ æ¯”å¯¹, <!-- -->[åˆåˆ†ä¸ºä¸¤ç§æƒ…å†µ]<!-- -->: å¦‚æœç›¸åŒ, ä¸å…è®¸å­˜å‚¨; å¦‚æœä¸åŒ, å°±å¯ä»¥å­˜å‚¨</p><ul><li>LinkedHashSet å†…éƒ¨ä½¿ç”¨ LindedHashMap, æœ‰åº, ä¸å’Œé‡å¤</li></ul></li><li><p>TreeSet åº•å±‚æ˜¯ä½¿ç”¨äº†çº¢é»‘æ ‘ï¼ˆäºŒå‰æ ‘ï¼‰æ•°æ®ç»“æ„å®ç°çš„ã€‚ ç‰¹ç‚¹ï¼š å¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œæ’åºå­˜å‚¨. å…ƒç´ å¿…é¡»æ˜¯å¯æ¯”è¾ƒçš„, å¦‚æœä¸å¯æ¯”è¾ƒ, éœ€è¦å®ç° Comparable æ¥å£(å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨åˆ›å»º Treeset å¯¹è±¡çš„æ—¶å€™ä¼ å…¥æ¯”è¾ƒå™¨(è‡ªå®šä¹‰ä¸€ä¸ªç±»å®ç° COmparator æ¥å£), æ¨è, å› ä¸ºè¿™ç§æ–¹å¼å¯ä»¥å¤ç”¨)</p></li></ul></li><li><p>Queue FIFO-å…ˆè¿›å…ˆå‡º</p><p>å¸¸ç”¨æ–¹æ³•:</p><p>ğŸ“Œ add å¢åŠ ä¸€ä¸ªå…ƒç´¢ å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª IIIegaISlabEepeplian å¼‚å¸¸
ğŸ“Œ remove ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª NoSuchElementException å¼‚å¸¸
ğŸ“Œ element è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª NoSuchElementException å¼‚</p><p>ğŸ“Œ offer å°†å…ƒç´ è¿½åŠ åˆ°é˜Ÿåˆ—æœ«å°¾å¹¶è¿”å› true å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™è¿”å› false
ğŸ“Œ poll åˆ é™¤å¹¶è¿”é—®é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› null
ğŸ“Œ peek è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ ä¸åˆ é™¤ å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› nul</p><p>ğŸ“Œ put æ·»åŠ ä¸€ä¸ªå…ƒç´  å¦‚æœé˜Ÿåˆ—æ»¡ï¼Œåˆ™é˜»å¡
ğŸ“Œ take ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™é˜»å¡</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  - Deque åŒå‘é˜Ÿåˆ—, å­æ¥å£, å¤´å°¾éƒ½å¯ä»¥poll, offer; å¦‚æœå°†Dequeé™åˆ¶ä¸ºåªèƒ½ä»ä¸€ç«¯å…¥é˜Ÿå’Œå‡ºé˜Ÿï¼Œåˆ™å¯å®ç°æ ˆçš„æ•°æ®ç»“æ„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - BlockingQueue é˜»å¡é˜Ÿåˆ—; è¿›å‡ºä¸¤ç«¯çš„threadä¼šé€šè¿‡é˜»å¡æ¥å®ç°å¹³è¡¡, å‡å°‘ä¸¤è¾¹çš„å¤„ç†é€Ÿåº¦å·®è·</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>Map key å”¯ä¸€ä¸å¯é‡å¤, value å¯é‡å¤</p><ul><li><p>HashMap ğŸ“Œ åº•å±‚æ˜¯ä¸€ä¸ª Entry æ•°ç»„, æ¯ä¸ª entry æ˜¯ä¸€ä¸ªé“¾è¡¨, å­˜å‚¨æ—¶, ä¼šæ ¹æ® hashCode() æ¥å†³å®šåœ¨æ•°ç»„ä¸­çš„ index, æ ¹æ® equals() å†³å®š åœ¨è¯¥ä½ç½®ä¸Šé“¾è¡¨ä¸­çš„ä½ç½®; ğŸ“Œ çº¿ç¨‹ä¸åŒæ­¥, è§£å†³æ–¹æ¡ˆæœ‰ Hashtable æˆ–è€… Collections.synchronizedMap(hashMap)ï¼Œè¿™ä¸¤ç§æ–¹å¼åŸºæœ¬éƒ½æ˜¯å¯¹æ•´ä¸ª hash è¡¨ç»“æ„åšé”å®šæ“ä½œçš„ï¼Œè¿™æ ·åœ¨é”è¡¨çš„æœŸé—´ï¼Œåˆ«çš„çº¿ç¨‹å°±éœ€è¦ç­‰å¾…äº†ï¼Œæ— ç–‘æ€§èƒ½ä¸é«˜ã€‚; ğŸ“Œ Key å’Œ value å¯ä»¥ä¸º null;</p><ul><li>LinkedHashMap åŸºäºå“ˆå¸Œè¡¨ä½†æ˜¯å†…éƒ¨ä¹Ÿç»´æŒäº†ä¸€ä¸ªåŒå‘é“¾è¡¨,å¯ä»¥ä¿æŒé¡ºåº(ä¿ç•™äº†æ’å…¥é¡ºåº, æ‰€ä»¥è¾“å‡ºé¡ºåºå’Œè¾“å…¥é¡ºåºç›¸åŒ)</li></ul></li><li><p>TreeMap åº•å±‚ä½¿ç”¨äºŒå‰æ ‘å®ç° å¯ä»¥æ ¹æ®é”®æ’åº(é»˜è®¤å‡åº) ã€<!-- -->*<!-- -->ã€‘</p></li><li><p>HashTable å­˜å‚¨çš„å†…å®¹æ˜¯é”®å€¼å¯¹(key-value)æ˜ å°„ã€‚å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒçš„ keyã€value éƒ½ä¸å¯ä»¥ä¸º null</p><ul><li>Properties é”®å€¼å¯¹ String--String å¦‚æœä½¿ç”¨äº†ä¸­æ–‡, åªèƒ½ä½¿ç”¨å­—ç¬¦æµ, ä¸èƒ½ä½¿ç”¨å­—èŠ‚æµ(å› ä¸ºå­—èŠ‚æµä½¿ç”¨ iso8859-1 ç¼–ç )</li></ul></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="52-è¯»æºç ">5.2. è¯»æºç <a href="#52-è¯»æºç " class="hash-link" aria-label="Direct link to 5.2. è¯»æºç " title="Direct link to 5.2. è¯»æºç ">â€‹</a></h2><p>references: <a href="http://wiki.jikexueyuan.com/project/java-collection/hashmap.html" target="_blank" rel="noopener noreferrer">http://wiki.jikexueyuan.com/project/java-collection/hashmap.html</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="521-æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«">5.2.1. æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«<a href="#521-æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«" class="hash-link" aria-label="Direct link to 5.2.1. æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«" title="Direct link to 5.2.1. æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«">â€‹</a></h3><p>æ•°ç»„é™æ€åˆ†é…å†…å­˜(å³, æ•°ç»„ä¸€æ—¦å®šä¹‰å°±å†…å­˜ä¸å¯å˜åŠ¨, è¦ä¿®æ”¹å°±å¿…é¡»æ¶‰åŠåˆ°æ•°ç»„çš„å¤åˆ¶)ï¼Œé“¾è¡¨åŠ¨æ€åˆ†é…å†…å­˜ï¼›</p><p>æ•°ç»„åœ¨å†…å­˜ä¸­è¿ç»­ï¼Œé“¾è¡¨ä¸è¿ç»­ï¼›</p><p>æ•°ç»„åˆ©ç”¨ä¸‹æ ‡å®šä½ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œé“¾è¡¨é€šè¿‡éå†å®šä½, å®šä½å…ƒç´ æ—¶é—´å¤æ‚åº¦ O(n)ï¼›</p><p>æ•°ç»„æ’å…¥æˆ–åˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ O(n)ï¼Œé“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦ O(1)ã€‚</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="522-å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«">5.2.2. å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«<a href="#522-å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«" class="hash-link" aria-label="Direct link to 5.2.2. å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«" title="Direct link to 5.2.2. å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«">â€‹</a></h3><ul><li><p>ä¸ºä»€ä¹ˆç›®å‰å¸‚åœºåº”ç”¨ä¸Šå•é“¾è¡¨çš„åº”ç”¨è¦æ¯”åŒé“¾è¡¨çš„åº”ç”¨è¦å¹¿æ³›çš„å¤šå‘¢ï¼Ÿ åŒé“¾è¡¨èŠ‚ç‚¹éœ€è¦å¤šç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆ</p></li><li><p>å­˜å‚¨æ•ˆç‡: å•é“¾è¡¨æ˜¯ &quot;æ—¶é—´æ¢ç©ºé—´&quot;, åŒé“¾è¡¨&quot;ç©ºé—´æ¢æ—¶é—´&quot;, æ¯”å¦‚: è€ƒè™‘é“¾è¡¨çš„ delete æ“ä½œ:</p><ul><li><p>å¯¹äºå•é“¾è¡¨, å…ˆå®šä½å¾…åˆ é™¤ node, å¾—åˆ°å¾…åˆ é™¤ node çš„ pre_node, ä¿®æ”¹ pre_node çš„ next æŒ‡é’ˆ;</p></li><li><p>è€Œå¾—åˆ° pre_node y æœ‰ä¸¤ç§æ–¹æ³•: ğŸ“Œ å®šä½ node_to_delete æ—¶å€™ä¸€è·¯ä¿å­˜å®ƒçš„å‰ä¸€ä¸ª node; ğŸ“Œ å®šä½åˆ° node_to_delete åé‡æ–°éå†é“¾è¡¨æ‰¾åˆ° è¿™ä¸ª pre_node; å®é™…ä¸Š è¿™ä¸¤ç§æ–¹æ³•çš„æ•ˆç‡æ˜¯ä¸€æ ·çš„ï¼ŒæŒ‡é’ˆçš„æ€»çš„ç§»åŠ¨æ“ä½œéƒ½ä¼šæœ‰ 2<!-- -->*<!-- -->i æ¬¡ã€‚è€Œå¦‚æœç”¨åŒå‘é“¾è¡¨ï¼Œåˆ™ä¸éœ€è¦å®šä½ pre_nodeã€‚å› æ­¤æŒ‡é’ˆæ€»çš„ç§»åŠ¨æ“ä½œä¸º i æ¬¡</p></li></ul></li><li><p>å†è€ƒè™‘ find æ“ä½œ: å¯ä»¥å€Ÿç”¨äºŒåˆ†æ³•çš„æ€è·¯ï¼Œä» headï¼ˆé¦–èŠ‚ç‚¹ï¼‰å‘åæŸ¥æ‰¾æ“ä½œå’Œ lastï¼ˆå°¾èŠ‚ç‚¹ï¼‰å‘å‰æŸ¥æ‰¾æ“ä½œåŒæ­¥è¿›è¡Œï¼Œè¿™æ ·åŒé“¾è¡¨çš„æ•ˆç‡å¯ä»¥æé«˜ä¸€å€</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="523-hashmap">5.2.3. HashMap<a href="#523-hashmap" class="hash-link" aria-label="Direct link to 5.2.3. HashMap" title="Direct link to 5.2.3. HashMap">â€‹</a></h3><p>HashMapå¯¹è±¡çš„keyã€valueå€¼å‡å¯ä¸ºnullã€‚ HahTableå¯¹è±¡çš„keyã€valueå€¼å‡ä¸å¯ä¸ºnullã€‚</p><p>çº¿ç¨‹ä¸å®‰å…¨ä½“ç°åœ¨å“ªé‡Œ? <a href="https://www.zhihu.com/question/28516433" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/28516433</a></p><p>TODO</p><p>jdk1.7 ç¤ºæ„å›¾: (<a href="https://www.draw.io/?lightbox=1&amp;highlight=0000ff&amp;edit=_blank&amp;layers=1&amp;nav=1&amp;title=Untitled%20Diagram.xml#R3Vrfb9s2EP5rCGwPDURRkqlHyVbWhxUo0AHbngbFYm2tsmjIdOL0r98df1hSJMdOaztZgCAmT8fj3XffHUUnhE1Xu9%2BafL38JAtREd8rdoTNiO%2FTwI%2FgAyWPRsKpZwSLpiysUiv4Un4XVujUtmUhNj1FJWWlynVfOJd1LeaqJ8ubRj701b7Kqr%2FrOl%2BIgeDLPK%2BG0j%2FLQi1tFP6klX8U5WLpdqZRbJ6scqdsI9ks80I%2BdEQsI2zaSKnMaLWbigrBc7iYdbcHnu4da0StTlngMnGfV1sbnHVMPbpoH5alEl%2FW%2BRznD5BRwtKlWlUwozCEENb4ZLVbYLZv7vJNOb%2BZV3Jb%2FAOQwaeye4hGid1BR%2Bk%2BfOCNkCuhmkdQsQtCLzRLLGUYswg%2BtAmIrWjZwT6ystymfLG33KICAwvMAZDCq4DE0pW8z%2B%2B0RVzTiE35vTuXKledOVSV6M5FUXanlvwdyRnSALDf9BNBPTZIBPXjYSYmwRkycTwRjdzWhUB9D0I%2BkpYzIEIdER0x%2BZCY1L8QM2kwiF8U0KrsVDZqKReyzquslaZ9hDpoiF2p%2FkIxpNjM%2FrZK%2FwqlHm0fzrdKgqi1%2FbuU6x6e6MLzaILHctvMrZYlkMqbhXBabBz0RlS5Ku%2F75n8GQfb2GAW97vUYFbw9PNjkNSvMOw7IT5TcZQuLDwsrvlJd8ZfwiF6nU%2Ft9HvmTIY%2F4CI3Cc9DohJPrzdIoHunPB6A%2BO4%2Fi%2FwGPvCvyiL59PGhwRTxOuL%2B82bqiYy8%2B4ZUKi77ozec6TPInP9ahWXgGPE645L06Hid2mrPgMey8WY02wpSEswE0EKTqx9%2B9vmJZrWVZK%2B2QscBSrKiNKS5ckFflooZxJb6iKUSuhLtxYsUKqy3dAN5lvfhDl96H4Dw4h4z1cGZBNMA5HMHZP0MHm5zQwOoiwW%2BtYDav8s2mnD%2B5t2FezMUtYtwJ8O5GbzzfzT%2BLpgTvRGPzcXrP6vYnPg7kEaCc7OQuZnf4jJzpnDSHbgLOhOmudpXf%2BdrrmCH2xJAJeWBIJ3Mf9mlfWQxP7Bpr5V0VEA1oH89w2KiCCxWQK5h3DbDPj3eoiwE8fFO4286%2FiXcG8b6ZuNdYf8jhSx0Co6dAVCECRXkPw4XSQRoRhF872cd8s%2FwErx7gRRaSNCFxqAeUcJ9kMeET%2FMkmJA5IwkkWkJQTiNQMkgQW9o51eBKhjdTDRWlKeKAlM5KEetEtjmGHZEZijo94rO2BzhTHuFWCq3zvm3j8YCIy3iW3JAUF%2BA2aU%2B0mGGHoJq4FHfAIDNKO%2FRDjeNbxnm2OkSdUuwPuR%2B1uFjvIRBe%2BjngE6CPYa1%2BmGC46nul9JziArTG4jPBwGIrYe91D6olkCXl12TDYw%2FKIpEwbzPSmIdrHGEPEL%2BFjqTNozVrT%2BAio4GsPp6jvTx2GkSYNGMnQIAZ169I%2BI1wbgQHsbsymSb0FGqMfnMQm9SlaR1Zk1umneexk%2F8l%2Bl8oQ1653Pd5HDFABX7BMqFYK0W%2BA%2BbnQ90DGyF1IMioD6fgvpiv%2B2poHS7g0QmNQf8hOMM%2BeIQe%2BkWl%2BjJADsuxrJnvDvUcSfcjSgWxfBH1DCK7LYobdoYXGMMYUfGQ148gpDDOil6SjoevWk6QuofoR9ineSb9zoN0aiklXCUoSknidLQYGXwbOezoVqdc%2FFYNo5FRkI8fiD3z5DtP2L9%2FmVbv9%2FwGW%2FQc%3D" target="_blank" rel="noopener noreferrer">online</a>)</p><p>å½“ Hash ç¢°æ’ä¸¥é‡æ—¶ï¼Œåœ¨ bucket ä¸Šå½¢æˆçš„é“¾è¡¨ä¼šå˜çš„è¶Šæ¥è¶Šé•¿ï¼Œè¿™æ ·åœ¨æŸ¥è¯¢æ—¶çš„æ•ˆç‡å°±ä¼šè¶Šæ¥è¶Šä½ï¼›æ—¶é—´å¤æ‚åº¦ä¸º O(N), 1.8 å°† bucket ç”±åŸæ¥çš„å•çº¯ LinkedList åŠ å…¥äº† çº¢é»‘æ ‘ çš„å®ç°</p><p>jdk1.8 ç¤ºæ„å›¾:</p><p>åˆå§‹å®¹é‡</p><p>åŠ è½½å› å­(Float loadFactor): ç»™å®šçš„é»˜è®¤å®¹é‡ä¸º 16ï¼Œè´Ÿè½½å› å­ä¸º 0.75ã€‚Map åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸æ–­çš„å¾€é‡Œé¢å­˜æ”¾æ•°æ®ï¼Œå½“æ•°é‡è¾¾åˆ°äº† 16 <!-- -->*<!-- --> 0.75 = 12 å°±éœ€è¦å°†å½“å‰ 16 çš„å®¹é‡è¿›è¡Œæ‰©å®¹ï¼Œè€Œæ‰©å®¹è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° rehashã€å¤åˆ¶æ•°æ®ç­‰æ“ä½œï¼Œæ‰€ä»¥éå¸¸æ¶ˆè€—æ€§èƒ½</p><p>Fail-Fast æœºåˆ¶</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- HashMapå®é™…ä¸Šæ˜¯ä¸€ä¸ªâ€œé“¾è¡¨æ•£åˆ—â€çš„æ•°æ®ç»“æ„ï¼Œå³æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆä½“; HashMap åº•å±‚å°±æ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹åˆæ˜¯ä¸€ä¸ªé“¾è¡¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- HashMap åº•å±‚é‡‡ç”¨ä¸€ä¸ª Entry[] æ•°ç»„æ¥ä¿å­˜æ‰€æœ‰çš„ key-value å¯¹ï¼Œå½“éœ€è¦å­˜å‚¨ä¸€ä¸ª Entry å¯¹è±¡æ—¶ï¼Œä¼šè®¡ç®—å¾…å­˜å‚¨entry çš„ key çš„ hash æ¥å†³å®šå…¶åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•, å¦‚æœè¯¥ä½ç½®ä¸ºnullåˆ™ç›´æ¥å­˜å‚¨ï¼Œå¦‚æœä¸ä¸ºnull, å°±éå†è¯¥ä½ç½®çš„é“¾è¡¨(bucket), å†æ¯”è¾ƒå¾…å­˜å‚¨ entryçš„ key å’Œ é“¾è¡¨ä¸­çš„ entryçš„ key(é€šè¿‡ equals æ–¹æ³•), å¦‚æœç›¸ç­‰, åˆ™è¦†ç›–, éå†åˆ°é“¾è¡¨æœ«å°¾è¿˜ä¸ç­‰åˆ™æ·»åŠ åˆ°æœ«å°¾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- æ‰©å®¹: å½“ HashMap ä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å° *loadFactor(é»˜è®¤0.75)æ—¶ï¼Œå°±ä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹; int threshold = (int)(capacity * loadFactor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º 16ï¼Œé‚£ä¹ˆå½“ HashMap ä¸­å…ƒç´ ä¸ªæ•°è¶…è¿‡ 16*0.75=12 çš„æ—¶å€™ï¼Œå°±æŠŠæ•°ç»„çš„å¤§å°æ‰©å±•ä¸º 2*16=32ï¼Œå³æ‰©å¤§ä¸€å€; æ‰€ä»¥åˆ›å»º HashMap æœ€å¥½æŒ‡å®šå®¹é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - è´Ÿè½½å› å­ loadFactor è¡¡é‡çš„æ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨çš„ç©ºé—´çš„ä½¿ç”¨ç¨‹åº¦ï¼Œè´Ÿè½½å› å­è¶Šå¤§è¡¨ç¤ºæ•£åˆ—è¡¨(å³æ•°ç»„)çš„è£…å¡«ç¨‹åº¦è¶Šé«˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- fail-fast æœºåˆ¶æ˜¯ java é›†åˆ(Collection)ä¸­çš„ä¸€ç§é”™è¯¯æœºåˆ¶ã€‚ å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿfail-fast äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ä¾‹å¦‚ï¼šå½“æŸä¸€ä¸ªçº¿ç¨‹ A é€šè¿‡ iteratorå»éå†æŸé›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œè‹¥è¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜äº†ï¼›é‚£ä¹ˆçº¿ç¨‹ A è®¿é—®é›†åˆæ—¶ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œäº§ç”Ÿ fail-fast äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - åŸç†: è¿™ä¸€ç­–ç•¥åœ¨æºç ä¸­çš„å®ç°æ˜¯é€šè¿‡ modCount åŸŸ(`transient int modCount;`) åœ¨è¿­ä»£å™¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¼šå°†è¿™ä¸ªå€¼èµ‹ç»™è¿­ä»£å™¨çš„ expectedModCount; åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­ modCount è·Ÿ expectedModCount æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰å°±è¡¨ç¤ºå·²ç»æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº† Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ„é€ å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public HashMap(int initialCapacity, float loadFactor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (initialCapacity &lt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new IllegalArgumentException(&quot;Illegal initial capacity: &quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                            initialCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        initialCapacity = MAXIMUM_CAPACITY;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new IllegalArgumentException(&quot;Illegal load factor: &quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                            loadFactor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Find a power of 2 &gt;= initialCapacity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int capacity = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while (capacity &lt; initialCapacity)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        capacity &lt;&lt;= 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.loadFactor = loadFactor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    threshold = (int)Math.min(capacity * loadFactor, MAXIMUM_CAPACITY + 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    table = new Entry[capacity]; // åˆ›å»ºä¸€ä¸ª Entry æ•°ç»„; æ¯ä¸ª Entry å…¶å®å°±æ˜¯ä¸€ä¸ª key-value å¯¹ï¼Œå®ƒæŒæœ‰ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œè¿™å°±æ„æˆäº†é“¾è¡¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    useAltHashing = sun.misc.VM.isBooted() &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (capacity &gt;= Holder.ALTERNATIVE_HASHING_THRESHOLD);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    init();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å­˜å‚¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public V put(K key, V value) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…¶å…è®¸å­˜æ”¾ null çš„ key å’Œ null çš„ valueï¼Œå½“å…¶ key ä¸º null æ—¶ï¼Œè°ƒç”¨putForNullKeyæ–¹æ³•ï¼Œæ”¾å…¥åˆ°table[0]çš„è¿™ä¸ªä½ç½®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (key == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return putForNullKey(value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å¾—åˆ°keyçš„ hashcode ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†å°½å¯èƒ½çš„è®©é”®å€¼å¯¹å¯ä»¥åˆ†å¸ƒåˆ°ä¸åŒçš„æ¡¶ä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int hash = hash(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //æ ¹æ®ä¸Šä¸€æ­¥éª¤ä¸­æ±‚å‡ºçš„hashå¾—åˆ°åœ¨æ•°ç»„ä¸­æ˜¯ç´¢å¼•i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int i = indexFor(hash, table.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å¦‚æœiå¤„çš„Entryä¸ä¸ºnullï¼Œåˆ™é€šè¿‡å…¶nextæŒ‡é’ˆä¸æ–­éå†eå…ƒç´ çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚, å¦‚æœæ‰¾åˆ°ä¸€ä¸ª entry, ä»–çš„ hash åŒ¹é…, key ä¹Ÿç›¸åŒ(equals), æ›¿æ¢ oldValue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Entry&lt;K,V&gt; e = table[i]; e != null; e = e.next) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object k;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) { // å¦‚æœ key å­˜åœ¨äº†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            V oldValue = e.value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.value = value; // æ–°çš„valueæ›¿ä»£ oldValue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.recordAccess(this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return oldValue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¦‚æœ i å¤„çš„ entry==null, æˆ–è€… bucketéå†å®Œäº†ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ç›¸åŒ key çš„ entry, ç›´æ¥æ·»åŠ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modCount++; // è¿™ä¸ªå˜é‡è®°å½• map ä¿®æ”¹æ¬¡æ•°, å®ç° fail-fast æœºåˆ¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    addEntry(hash, key, value, i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void addEntry(int hash, K key, V value, int bucketIndex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è¿™é‡Œå®Œå…¨æ²¡æœ‰è€ƒè™‘ Entry ä¸­çš„ valueï¼Œä»…ä»…åªæ˜¯æ ¹æ® key æ¥è®¡ç®—å¹¶å†³å®šæ¯ä¸ª Entry çš„å­˜å‚¨ä½ç½®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å½“ç³»ç»Ÿå†³å®šäº† key çš„å­˜å‚¨ä½ç½®ä¹‹åï¼Œvalue éšä¹‹ä¿å­˜åœ¨é‚£é‡Œå³å¯ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ((size &gt;= threshold) &amp;&amp; (null != table[bucketIndex])) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        resize(2 * table.length);  // æ‰©å®¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hash = (null != key) ? hash(key) : 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bucketIndex = indexFor(hash, table.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    createEntry(hash, key, value, bucketIndex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void createEntry(int hash, K key, V value, int bucketIndex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // è·å–æŒ‡å®š bucketIndex ç´¢å¼•å¤„çš„ Entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Entry&lt;K,V&gt; e = table[bucketIndex];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // å°†æ–°åˆ›å»ºçš„ Entry æ”¾å…¥ bucketIndex ç´¢å¼•å¤„ï¼Œå¹¶è®©æ–°çš„ Entry æŒ‡å‘åŸæ¥çš„ Entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        table[bucketIndex] = new Entry&lt;&gt;(hash, key, value, e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        size++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è·å–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public V get(Object key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (key == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return getForNullKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Entry&lt;K,V&gt; entry = getEntry(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null == entry ? null : entry.getValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final Entry&lt;K,V&gt; getEntry(Object key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int hash = (key == null) ? 0 : hash(key); // calculate hashCode according to key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Entry&lt;K,V&gt; e = table[indexFor(hash, table.length)]; // find element, traverse the bucket.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e != null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e = e.next) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object k;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (e.hash == hash &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return e;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="524-hashset">5.2.4. HashSet<a href="#524-hashset" class="hash-link" aria-label="Direct link to 5.2.4. HashSet" title="Direct link to 5.2.4. HashSet">â€‹</a></h3><p>å‡ ä¹å…¨éƒ¨å€ŸåŠ©äº HashMap æ¥å®ç°</p><p>æ‰€ä»¥ä¹Ÿè¦é‡å†™ hashCode(), equals() ä»¥ç¡®ä¿å…ƒç´ å”¯ä¸€æ€§</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- HashSetå†…éƒ¨çš„æ•°æ®ç»“æ„å°±æ˜¯ä¸€ä¸ª HashMapï¼Œå…¶æ–¹æ³•çš„å†…éƒ¨å‡ ä¹å°±æ˜¯åœ¨è°ƒç”¨ HashMap çš„æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////// field</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private transient HashMap&lt;E,Object&gt; map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ‰€æœ‰å†™å…¥ map çš„ value å€¼, key åˆ™æ˜¯ Hashset ä¸­å­˜å‚¨çš„å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static final Object PRESENT = new Object();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">////////////////////////////////////////// æ„é€ å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * é»˜è®¤çš„æ— å‚æ„é€ å™¨ï¼Œæ„é€ ä¸€ä¸ªç©ºçš„HashSetã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å®é™…åº•å±‚ä¼šåˆå§‹åŒ–ä¸€ä¸ªç©ºçš„HashMapï¼Œå¹¶ä½¿ç”¨é»˜è®¤åˆå§‹å®¹é‡ä¸º16å’ŒåŠ è½½å› å­0.75ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public HashSet() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    map = new HashMap&lt;E,Object&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public HashSet(int initialCapacity, float loadFactor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    map = new HashMap&lt;&gt;(initialCapacity, loadFactor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®š collection ä¸­çš„å…ƒç´ çš„æ–°setã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å®é™…åº•å±‚ä½¿ç”¨é»˜è®¤çš„åŠ è½½å› å­0.75å’Œè¶³ä»¥åŒ…å«æŒ‡å®š collection ä¸­æ‰€æœ‰å…ƒç´ çš„åˆå§‹å®¹é‡æ¥åˆ›å»ºä¸€ä¸ªH ashMapã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param c å…¶ä¸­çš„å…ƒç´ å°†å­˜æ”¾åœ¨æ­¤ set ä¸­çš„collectionã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public HashSet(Collection&lt;? extends E&gt; c) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    map = new HashMap&lt;E,Object&gt;(Math.max((int) (c.size()/.75f) + 1, 16));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    addAll(c);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ä»¥æŒ‡å®šçš„initialCapacity å’Œ loadFactor æ„é€ ä¸€ä¸ªç©ºçš„ HashSetã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å®é™…åº•å±‚ä»¥ç›¸åº”çš„å‚æ•°æ„é€ ä¸€ä¸ªç©ºçš„HashMapã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param initialCapacity åˆå§‹å®¹é‡ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param loadFactor åŠ è½½å› å­ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public HashSet(int initialCapacity, float loadFactor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    map = new HashMap&lt;E,Object&gt;(initialCapacity, loadFactor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ä»¥æŒ‡å®šçš„ initialCapacity æ„é€ ä¸€ä¸ªç©ºçš„ HashSetã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å®é™…åº•å±‚ä»¥ç›¸åº”çš„å‚æ•°åŠåŠ è½½å› å­loadFactorä¸º0.75æ„é€ ä¸€ä¸ªç©ºçš„HashMapã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param initialCapacity åˆå§‹å®¹é‡ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public HashSet(int initialCapacity) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    map = new HashMap&lt;E,Object&gt;(initialCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ä»¥æŒ‡å®šçš„initialCapacityå’ŒloadFactoræ„é€ ä¸€ä¸ªæ–°çš„ç©ºé“¾æ¥å“ˆå¸Œé›†åˆã€‚æ­¤æ„é€ å‡½æ•°ä¸ºåŒ…è®¿é—®æƒé™ï¼Œä¸å¯¹å¤–å…¬å¼€ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å®é™…åªæ˜¯æ˜¯å¯¹LinkedHashSetçš„æ”¯æŒã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å®é™…åº•å±‚ä¼šä»¥æŒ‡å®šçš„å‚æ•°æ„é€ ä¸€ä¸ªç©ºLinkedHashMapå®ä¾‹æ¥å®ç°ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param initialCapacity åˆå§‹å®¹é‡ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param loadFactor åŠ è½½å› å­ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param dummy æ ‡è®°ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HashSet(int initialCapacity, float loadFactor, boolean dummy) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    map = new LinkedHashMap&lt;E,Object&gt;(initialCapacity, loadFactor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">////////////////////////////////// æ·»åŠ æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ç”±äº HashMap çš„ put() æ–¹æ³•æ·»åŠ  key-value å¯¹æ—¶ï¼Œå½“æ–°æ”¾å…¥ HashMap çš„ key ä¸åŸæœ‰ key ç›¸åŒï¼ˆhashCode()è¿”å›å€¼ç›¸ç­‰ï¼Œé€šè¿‡ equals æ¯”è¾ƒä¹Ÿè¿”å› trueï¼‰ï¼Œæ–°æ·»åŠ çš„ Entry çš„ value å°†è¦†ç›–åŸæ¥ Entry çš„ valueï¼ˆä¹Ÿå°±æ˜¯ HashSet ä¸­çš„ value , éƒ½æ˜¯PRESENTï¼‰ï¼Œä½† key ä¸ä¼šæœ‰ä»»ä½•æ”¹å˜ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å› æ­¤å¦‚æœå‘ HashSet ä¸­æ·»åŠ ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å…ƒç´ æ—¶ï¼Œæ–°æ·»åŠ çš„é›†åˆå…ƒç´ å°†ä¸ä¼šè¢«æ”¾å…¥ HashMapä¸­ï¼ŒåŸæ¥çš„å…ƒç´ ä¹Ÿä¸ä¼šæœ‰ä»»ä½•æ”¹å˜ï¼Œè¿™ä¹Ÿå°±æ»¡è¶³äº† Set ä¸­å…ƒç´ ä¸é‡å¤çš„ç‰¹æ€§ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param e å°†æ·»åŠ åˆ°æ­¤setä¸­çš„å…ƒç´ ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @return å¦‚æœæ­¤setå°šæœªåŒ…å«æŒ‡å®šå…ƒç´ ï¼Œåˆ™è¿”å›trueã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public boolean add(E e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å°†å­˜æ”¾çš„å¯¹è±¡å½“åšäº† HashMap çš„å¥ï¼Œvalue éƒ½æ˜¯ç›¸åŒçš„ PRESENT ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ç”±äº HashMap çš„ key æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œæ‰€ä»¥æ¯å½“æœ‰é‡å¤çš„å€¼å†™å…¥åˆ° HashSet æ—¶, ä¹Ÿå°±æ˜¯ hashmap ä¸­çš„ key é‡å¤äº†ï¼Œé‚£ä¹ˆ value ä¼šè¢«è¦†ç›–ï¼Œä½† key ä¸ä¼šå—åˆ°å½±å“ï¼Œè¿™æ ·å°±ä¿è¯äº† HashSet ä¸­åªèƒ½å­˜æ”¾ä¸é‡å¤çš„å…ƒç´ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return map.put(e, PRESENT)==null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="525-hashtable">5.2.5. HashTable<a href="#525-hashtable" class="hash-link" aria-label="Direct link to 5.2.5. HashTable" title="Direct link to 5.2.5. HashTable">â€‹</a></h3><p>åŒæ­¥çš„ hashmap, key, value ä¸å…è®¸ä¸º null</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- å’Œ HashMap ä¸€æ ·ï¼ŒHashtable ä¹Ÿæ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨ï¼Œå®ƒå­˜å‚¨çš„å†…å®¹æ˜¯é”®å€¼å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Hashtable ä¸ HashMap çš„ç®€å•æ¯”è¾ƒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - HashTable åŸºäº Dictionary ç±»ï¼Œè€Œ HashMap æ˜¯åŸºäº AbstractMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -(Dictionary æ˜¯ä»»ä½•å¯å°†é”®æ˜ å°„åˆ°ç›¸åº”å€¼çš„ç±»çš„æŠ½è±¡çˆ¶ç±», è¿‡æ—¶äº†)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - HashMap çš„ key å’Œ value éƒ½å…è®¸ä¸º nullï¼Œè€Œ Hashtable çš„ key å’Œ value éƒ½ä¸å…è®¸ä¸º null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - Hashtable æ–¹æ³•æ˜¯åŒæ­¥ï¼Œè€ŒHashMapåˆ™ä¸æ˜¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æˆå‘˜å˜é‡ å’Œ HashMap ç±»ä¼¼ table, count, threshold, loadFactor, modCountã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ„é€ æ–¹æ³•å¤§åŒå°å¼‚, é»˜è®¤æ„é€ å‡½æ•°ï¼Œå®¹é‡ä¸º 11ï¼ŒåŠ è½½å› å­ä¸º 0.75</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ·»åŠ  çº¿ç¨‹å®‰å…¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">æ•´ä¸ªè¿‡ç¨‹:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- åˆ¤æ–­ value æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸ï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- è®¡ç®— key çš„ hash å€¼ï¼Œå¹¶æ ¹æ® hash å€¼è·å¾— key åœ¨ table æ•°ç»„ä¸­çš„ä½ç½® indexï¼Œå¦‚æœ table[index] å…ƒç´ ä¸ä¸ºç©ºï¼Œåˆ™è¿›è¡Œè¿­ä»£ï¼Œå¦‚æœé‡åˆ°ç›¸åŒçš„ keyï¼Œåˆ™ç›´æ¥æ›¿æ¢ï¼Œå¹¶è¿”å›æ—§ valueï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- table[index] ä¸ºç©ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ’å…¥åˆ° table[index] ä½ç½®ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public synchronized V put(K key, V value) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Make sure the value is not nullç¡®ä¿valueä¸ä¸ºnull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (value == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new NullPointerException();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Makes sure the key is not already in the hashtable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ç¡®ä¿keyä¸åœ¨hashtableä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //é¦–å…ˆï¼Œé€šè¿‡hashæ–¹æ³•è®¡ç®—keyçš„å“ˆå¸Œå€¼ï¼Œå¹¶è®¡ç®—å¾—å‡ºindexå€¼ï¼Œç¡®å®šå…¶åœ¨table[]ä¸­çš„ä½ç½®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…¶æ¬¡ï¼Œè¿­ä»£indexç´¢å¼•ä½ç½®çš„é“¾è¡¨ï¼Œå¦‚æœè¯¥ä½ç½®å¤„çš„é“¾è¡¨å­˜åœ¨ç›¸åŒçš„keyï¼Œåˆ™æ›¿æ¢valueï¼Œè¿”å›æ—§çš„value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Entry tab[] = table;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int hash = hash(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int index = (hash &amp; 0x7FFFFFFF) % tab.length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Entry&lt;K,V&gt; e = tab[index] ; e != null ; e = e.next) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if ((e.hash == hash) &amp;&amp; e.key.equals(key)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            V old = e.value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.value = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return old;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modCount++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (count &gt;= threshold) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Rehash the table if the threshold is exceeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //å¦‚æœè¶…è¿‡é˜€å€¼ï¼Œå°±è¿›è¡Œrehashæ“ä½œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rehash();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tab = table;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hash = hash(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        index = (hash &amp; 0x7FFFFFFF) % tab.length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Creates the new entry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å°†å€¼æ’å…¥ï¼Œè¿”å›çš„ä¸ºnull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Entry&lt;K,V&gt; e = tab[index];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // åˆ›å»ºæ–°çš„EntryèŠ‚ç‚¹ï¼Œå¹¶å°†æ–°çš„Entryæ’å…¥Hashtableçš„indexä½ç½®ï¼Œå¹¶è®¾ç½®eä¸ºæ–°çš„Entryçš„ä¸‹ä¸€ä¸ªå…ƒç´ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tab[index] = new Entry&lt;&gt;(hash, key, value, e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    count++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// get æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public synchronized V get(Object key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Entry tab[] = table;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int hash = hash(key); // calculate hashCode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int index = (hash &amp; 0x7FFFFFFF) % tab.length; //calculate index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Entry&lt;K,V&gt; e = tab[index] ; e != null ; e = e.next) { //éå†é“¾è¡¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if ((e.hash == hash) &amp;&amp; e.key.equals(key)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return e.value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="526-linkedhashmap">5.2.6. LinkedHashMap<a href="#526-linkedhashmap" class="hash-link" aria-label="Direct link to 5.2.6. LinkedHashMap" title="Direct link to 5.2.6. LinkedHashMap">â€‹</a></h3><p>å¯ä»¥æ’åºçš„ hashmap</p><p>ç”±ä¸€ä¸ªåŒå‘é“¾è¡¨æ‰€æ„æˆ, ä¿è¯äº†æœ‰åº (åœ¨ hashmap å†…éƒ¨çš„ entry åŸºç¡€ä¸Šæ·»åŠ äº† &quot;Entry&lt;K,V&gt; before, after;&quot; æ„æˆäº†åŒå‘é“¾è¡¨, )</p><p>æ’åºæ¨¡å¼: é€šè¿‡ <code>accessOrder</code> æ§åˆ¶</p><ul><li><p>æ ¹æ®å†™å…¥é¡ºåºæ’åº(é»˜è®¤)</p></li><li><p>æ ¹æ®è®¿é—®é¡ºåºæ’åº - æ¯æ¬¡ get éƒ½ä¼šå°†è®¿é—®çš„å€¼ç§»åŠ¨åˆ°é“¾è¡¨æœ«å°¾ï¼Œè¿™æ ·é‡å¤æ“ä½œå°±èƒ½å¾—åˆ°ä¸€ä¸ªæŒ‰ç…§è®¿é—®é¡ºåºæ’åºçš„é“¾è¡¨ã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§, ç”¨ LinkedHashMap æ„å»º LRU ç¼“å­˜</p></li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- LinkedHashMap æ˜¯ HashMap çš„ä¸€ä¸ªå­ç±»ï¼Œå®ƒä¿ç•™æ’å…¥çš„é¡ºåº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- å…è®¸ä½¿ç”¨ null å€¼å’Œ null é”®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- LinkedHashMap å®ç°ä¸ HashMap çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒLinkedHashMap ç»´æŠ¤ç€ä¸€ä¸ªåŒé‡é“¾æ¥åˆ—è¡¨ã€‚æ­¤é“¾æ¥åˆ—è¡¨å®šä¹‰äº†è¿­ä»£é¡ºåºï¼Œè¯¥è¿­ä»£é¡ºåºå¯ä»¥æ˜¯æ’å…¥é¡ºåºæˆ–è€…æ˜¯è®¿é—®é¡ºåº(å³è°ƒç”¨ get() åï¼Œä¼šå°†è¿™æ¬¡è®¿é—®çš„å…ƒç´ ç§»è‡³é“¾è¡¨ å°¾éƒ¨ï¼Œä¸æ–­è®¿é—®å¯ä»¥å½¢æˆæŒ‰è®¿é—®é¡ºåºæ’åºçš„é“¾è¡¨ã€‚)ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æˆå‘˜å˜é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private final boolean accessOrder; //å¦‚æœä¸ºtrueï¼Œåˆ™æŒ‰ç…§è®¿é—®é¡ºåºï¼›å¦‚æœä¸ºfalseï¼Œåˆ™æŒ‰ç…§æ’å…¥é¡ºåºã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private transient Entry&lt;K,V&gt; header;// the head(eldest) of the doubly linked list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private transient Entry&lt;K,V&gt; tail;// the tail(youngest) of the doubly linked list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* LinkedHashMapçš„Entryå…ƒç´ ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* ç»§æ‰¿HashMapçš„Entryå…ƒç´ ï¼Œåˆä¿å­˜äº†å…¶ä¸Šä¸€ä¸ªå…ƒç´ beforeå’Œä¸‹ä¸€ä¸ªå…ƒç´ afterçš„å¼•ç”¨ã€‚æ–°ç‰ˆæœ¬æœ‰å˜åŒ–äº†, ç»§æ‰¿ Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static class Entry&lt;K,V&gt; extends HashMap.Entry&lt;K,V&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Entry&lt;K,V&gt; before, after;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â€¦â€¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åˆå§‹åŒ–/æ„é€ å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public LinkedHashMap(int initialCapacity, float loadFactor,boolean accessOrder) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    super(initialCapacity, loadFactor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.accessOrder = accessOrder;//é»˜è®¤ä¸º falseï¼Œä»£è¡¨æŒ‰ç…§æ’å…¥é¡ºåºè¿›è¡Œè¿­ä»£ï¼›å½“ç„¶å¯ä»¥æ˜¾å¼è®¾ç½®ä¸º trueï¼Œä»£è¡¨ä»¥è®¿é—®é¡ºåºè¿›è¡Œè¿­ä»£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å­˜å‚¨æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LinkedHashMap å¹¶æœªé‡å†™çˆ¶ç±» HashMap çš„ put æ–¹æ³•ï¼Œè€Œæ˜¯é‡å†™äº†çˆ¶ç±» HashMap çš„ put æ–¹æ³•è°ƒç”¨çš„å­æ–¹æ³•void recordAccess(HashMap m) ï¼Œvoid addEntry(int hash, K key, V value, int bucketIndex) å’Œvoid createEntry(int hash, K key, V value, int bucketIndex)ï¼Œæä¾›äº†è‡ªå·±ç‰¹æœ‰çš„åŒå‘é“¾æ¥åˆ—è¡¨çš„å®ç°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// get æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LinkedHashMap é‡å†™äº†çˆ¶ç±» HashMap çš„ get æ–¹æ³•ï¼Œå®é™…åœ¨è°ƒç”¨çˆ¶ç±» getEntry() æ–¹æ³•å–å¾—æŸ¥æ‰¾çš„å…ƒç´ åï¼Œå†åˆ¤æ–­å½“æ’åºæ¨¡å¼ accessOrder ä¸º true æ—¶ï¼Œè®°å½•è®¿é—®é¡ºåºï¼Œå°†æœ€æ–°è®¿é—®çš„å…ƒç´ æ·»åŠ åˆ°åŒå‘é“¾è¡¨çš„è¡¨å¤´ï¼Œå¹¶ä»åŸæ¥çš„ä½ç½®åˆ é™¤ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// LRU æ˜¯ Least Recently Used çš„ç¼©å†™, æœ€è¿‘æœ€å°‘ä½¿ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// LinkedHashMap æœ¬èº«å·²ç»å®ç°äº†æŒ‰ç…§è®¿é—®é¡ºåºçš„å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€è¿‘è¯»å–çš„ä¼šæ”¾åœ¨æœ€å‰é¢ï¼Œæœ€æœ€ä¸å¸¸è¯»å–çš„ä¼šæ”¾åœ¨æœ€å;LinkedHashMap æœ¬èº«æœ‰ä¸€ä¸ªæ–¹æ³•ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦ç§»é™¤æœ€ä¸å¸¸è¯»å–çš„æ•°ï¼Œä½†æ˜¯ï¼ŒåŸå§‹æ–¹æ³•é»˜è®¤ä¸éœ€è¦ç§»é™¤ï¼ˆè¿™æ˜¯ï¼ŒLinkedHashMap ç›¸å½“äºä¸€ä¸ªlinkedlistï¼‰ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ override è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼Œä½¿å¾—å½“ç¼“å­˜é‡Œå­˜æ”¾çš„æ•°æ®ä¸ªæ•°è¶…è¿‡è§„å®šä¸ªæ•°åï¼Œå°±æŠŠæœ€ä¸å¸¸ç”¨çš„ç§»é™¤æ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * An LRU cache, based on &lt;code&gt;LinkedHashMap&lt;/code&gt;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * &lt;p&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * This cache has a fixed maximum number of elements (&lt;code&gt;cacheSize&lt;/code&gt;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * If the cache is full and another entry is added, the LRU (least recently</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * used) entry is dropped.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * &lt;p&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * This class is thread-safe. All methods of this class are synchronized.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * &lt;p&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Author: Christian d&#x27;Heureuse, Inventec Informatik AG, Zurich, Switzerland&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Multi-licensed: EPL / LGPL / GPL / AL / BSD.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class LRUCache&lt;K, V&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final float hashTableLoadFactor = 0.75f;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private LinkedHashMap&lt;K, V&gt; map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int cacheSize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Creates a new LRU cache. åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œnew LinkedHashMap&lt;K,V&gt;(hashTableCapacity,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * hashTableLoadFactor, true)ä¸­ï¼Œtrueä»£è¡¨ä½¿ç”¨è®¿é—®é¡ºåº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param cacheSize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *            the maximum number of entries that will be kept in this cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public LRUCache(int cacheSize) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.cacheSize = cacheSize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int hashTableCapacity = (int) Math</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .ceil(cacheSize / hashTableLoadFactor) + 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        map = new LinkedHashMap&lt;K, V&gt;(hashTableCapacity, hashTableLoadFactor,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (an anonymous inner class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            private static final long serialVersionUID = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            protected boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return size() &gt; LRUCache.this.cacheSize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Retrieves an entry from the cache.&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * The retrieved entry becomes the MRU (most recently used) entry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *            the key whose associated value is to be returned.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the value associated to this key, or null if no value with this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *         key exists in the cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public synchronized V get(K key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return map.get(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Adds an entry to this cache. The new entry becomes the MRU (most recently</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * used) entry. If an entry with the specified key already exists in the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * cache, it is replaced by the new entry. If the cache is full, the LRU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * (least recently used) entry is removed from the cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *            the key with which the specified value is to be associated.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *            a value to be associated with the specified key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public synchronized void put(K key, V value) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        map.put(key, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Clears the cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public synchronized void clear() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        map.clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Returns the number of used entries in the cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the number of entries currently in the cache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public synchronized int usedEntries() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return map.size();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Returns a &lt;code&gt;Collection&lt;/code&gt; that contains a copy of all cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * entries.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return a &lt;code&gt;Collection&lt;/code&gt; with a copy of the cache content.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public synchronized Collection&lt;Map.Entry&lt;K, V&gt;&gt; getAll() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new ArrayList&lt;Map.Entry&lt;K, V&gt;&gt;(map.entrySet());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Test routine for the LRUCache class.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LRUCache&lt;String, String&gt; c = new LRUCache&lt;String, String&gt;(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.put(&quot;1&quot;, &quot;one&quot;); // 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.put(&quot;2&quot;, &quot;two&quot;); // 2 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.put(&quot;3&quot;, &quot;three&quot;); // 3 2 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.put(&quot;4&quot;, &quot;four&quot;); // 4 3 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (c.get(&quot;2&quot;) == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new Error(); // 2 4 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.put(&quot;5&quot;, &quot;five&quot;); // 5 2 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.put(&quot;4&quot;, &quot;second four&quot;); // 4 5 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Verify cache content.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (c.usedEntries() != 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new Error();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!c.get(&quot;4&quot;).equals(&quot;second four&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new Error();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!c.get(&quot;5&quot;).equals(&quot;five&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new Error();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!c.get(&quot;2&quot;).equals(&quot;two&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new Error();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // List cache content.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (Map.Entry&lt;String, String&gt; e : c.getAll())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(e.getKey() + &quot; : &quot; + e.getValue());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="527-treemap">5.2.7. TreeMap<a href="#527-treemap" class="hash-link" aria-label="Direct link to 5.2.7. TreeMap" title="Direct link to 5.2.7. TreeMap">â€‹</a></h3><p>åŸºäºçº¢é»‘æ ‘çš„å¯æ’åº hashmap</p><p>éå†å’Œå¢åŠ åˆ é™¤çš„çš„æ•ˆç‡éƒ½æ˜¯O(logN)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="528-lindedhashset">5.2.8. LindedHashSet<a href="#528-lindedhashset" class="hash-link" aria-label="Direct link to 5.2.8. LindedHashSet" title="Direct link to 5.2.8. LindedHashSet">â€‹</a></h3><p>æœ‰åºçš„ hashset</p><p>ç»§æ‰¿ HashSetã€åˆåŸºäº LinkedHashMap æ¥å®ç°çš„</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ä¸HashSet çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒLinkedHashSet ç»´æŠ¤ç€ä¸€ä¸ªåŒé‡é“¾æ¥åˆ—è¡¨ã€‚æ­¤é“¾æ¥åˆ—è¡¨å®šä¹‰äº†è¿­ä»£é¡ºåºï¼Œè¯¥è¿­ä»£é¡ºåºå¯ä¸ºæ’å…¥é¡ºåºæˆ–æ˜¯è®¿é—®é¡ºåº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="529-arraylist-å’Œ-vector">5.2.9. ArrayList å’Œ Vector<a href="#529-arraylist-å’Œ-vector" class="hash-link" aria-label="Direct link to 5.2.9. ArrayList å’Œ Vector" title="Direct link to 5.2.9. ArrayList å’Œ Vector">â€‹</a></h3><p>æœ€é‡è¦çš„ä¸¤ä¸ªå±æ€§åˆ†åˆ«æ˜¯: <code>elementData</code> æ•°ç»„ï¼Œä»¥åŠ <code>size</code> å¤§å°, æ·»åŠ å…ƒç´ æ—¶å€™ é¦–å…ˆè¿›è¡Œ <code>æ‰©å®¹æ ¡éªŒ</code>, å¦‚æœå®¹é‡ä¸å¤Ÿäº†, ä¼šè¿›è¡Œæ•°ç»„çš„å¤åˆ¶. å¦å¤–åœ¨æ·»åŠ å…ƒç´ åˆ°æŒ‡å®šä½ç½®æ—¶ä¹Ÿæœ‰æ•°ç»„çš„å¤åˆ¶. æ‰€ä»¥<code>ä½¿ç”¨æ—¶æœ€å¥½æ˜¯æŒ‡å®šå¤§å°</code>, <code>å‡å°‘åœ¨æŒ‡å®šä½ç½®æ’å…¥æ•°æ®çš„æ“ä½œ</code></p><p>å®ç°äºä¸‹é¢ 2 ä¸ªæ¥å£</p><ul><li><p>List æ¥å£</p></li><li><p>RandomAccess æ¥å£: æ ‡è®°æ¥å£, è¡¨ç¤ºå¯ä»¥å¿«é€Ÿéšæœºè®¿é—®(é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡)</p></li></ul><p>Fail-Fast æœºåˆ¶: å¤šä¸ªçº¿ç¨‹ç«äº‰è®¿é—®ä¼šæŠ¥é”™</p><p>ç”±äº ArrayList æ˜¯åŸºäºæ•°ç»„å®ç°çš„ï¼Œæ‰€ä»¥<code>å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç©ºé—´éƒ½è¢«ä½¿ç”¨</code>ã€‚å› æ­¤ä½¿ç”¨äº† transient ä¿®é¥°ï¼Œå¯ä»¥é˜²æ­¢è¢«è‡ªåŠ¨åºåˆ—åŒ–, å› æ­¤ <code>ArrayList è‡ªå®šä¹‰äº†åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</code></p><p>Vector åº•å±‚æ•°æ®ç»“æ„å’Œ ArrayList ç±»ä¼¼,ä¹Ÿæ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„å­˜æ”¾æ•°æ®ã€‚ä¸è¿‡æ˜¯åœ¨ add() æ–¹æ³•çš„æ—¶å€™ä½¿ç”¨ synchronized è¿›è¡ŒåŒæ­¥å†™æ•°æ®ï¼Œä½†æ˜¯å¼€é”€è¾ƒå¤§ï¼Œæ‰€ä»¥ Vector æ˜¯ä¸€ä¸ªåŒæ­¥å®¹å™¨å¹¶ä¸æ˜¯ä¸€ä¸ªå¹¶å‘å®¹å™¨ã€‚</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- å®ƒå®ç° List æ¥å£ã€åº•å±‚ä½¿ç”¨æ•°ç»„ä¿å­˜æ‰€æœ‰å…ƒç´ ã€‚å…¶æ“ä½œåŸºæœ¬ä¸Šæ˜¯å¯¹æ•°ç»„çš„æ“ä½œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æˆå‘˜å˜é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private transient Object[] elementData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ·»åŠ  æœ‰å¤šç§æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public E set(int index, E element) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rangeCheck(index);//æ£€æŸ¥æ˜¯å¦è¶…å‡ºæ•°ç»„èŒƒå›´, å¦‚æœè¶…å‡º, æŠ›å¼‚å¸¸</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E oldValue = elementData(index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elementData[index] = element;// replace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return oldValue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void rangeCheck(int index) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (index &gt;= size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Appends the specified element to the end of the list.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @param e element to be appended to this list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @return &lt;tt&gt;true&lt;/tt&gt; (as specified by {@link Collection#add})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public boolean add(E e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //æ‰©å®¹æ ¡éªŒã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ensureCapacityInternal(size + 1);  // Increments modCount!!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elementData[size++] = e;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void ensureCapacityInternal(int minCapacity) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modCount++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // overflow-conscious code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (minCapacity - elementData.length &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        grow(minCapacity); //å½“å®¹é‡ä¸è¶³æ—¶ï¼Œä¼šè°ƒç”¨ grow æ–¹æ³•å¢é•¿å®¹é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void grow(int minCapacity) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // overflow-conscious code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int oldCapacity = elementData.length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (newCapacity - minCapacity &lt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        newCapacity = minCapacity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (newCapacity - MAX_ARRAY_SIZE &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        newCapacity = hugeCapacity(minCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // minCapacity is usually close to size, so this is a win:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ•°ç»„å¤åˆ¶,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public void add(int index, E element) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rangeCheckForAdd(index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ensureCapacityInternal(size + 1);  // Increments modCount!!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å¤åˆ¶ï¼Œå‘åç§»åŠ¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.arraycopy(elementData, index, elementData, index + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        size - index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elementData[index] = element;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    size++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¯»å–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public E get(int index) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rangeCheck(index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return (E) elementData[index];// returns the element at the specified position of the list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void rangeCheck(int index) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (index &gt;= size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è°ƒæ•´æ•°ç»„å®¹é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¼€å‘è€…å¯ä»¥é€šè¿‡ä¸€ä¸ª public çš„æ–¹æ³•ensureCapacity(int minCapacity)æ¥å¢åŠ  ArrayList çš„å®¹é‡ï¼Œè€Œåœ¨å­˜å‚¨å…ƒç´ ç­‰æ“ä½œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°å®¹é‡ä¸è¶³ï¼Œä¼šè°ƒç”¨priavteæ–¹æ³•private void ensureCapacityInternal(int minCapacity)å®ç°ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public void ensureCapacity(int minCapacity) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (minCapacity &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ensureCapacityInternal(minCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void ensureCapacityInternal(int minCapacity) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modCount++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // overflow-conscious code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (minCapacity - elementData.length &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        grow(minCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Increases the capacity to ensure that it can hold at least the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * number of elements specified by the minimum capacity argument.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @param minCapacity the desired minimum capacity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void grow(int minCapacity) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // overflow-conscious code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int oldCapacity = elementData.length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); //æ¯æ¬¡æ•°ç»„å®¹é‡çš„å¢é•¿å¤§çº¦æ˜¯å…¶åŸå®¹é‡çš„ 1.5 å€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (newCapacity - minCapacity &lt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        newCapacity = minCapacity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (newCapacity - MAX_ARRAY_SIZE &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        newCapacity = hugeCapacity(minCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // minCapacity is usually close to size, so this is a win:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5210-linkedlist">5.2.10. LinkedList<a href="#5210-linkedlist" class="hash-link" aria-label="Direct link to 5.2.10. LinkedList" title="Direct link to 5.2.10. LinkedList">â€‹</a></h3><p>å•å‘é“¾è¡¨</p><p>LinkedList æ’å…¥ï¼Œåˆ é™¤éƒ½æ˜¯ç§»åŠ¨æŒ‡é’ˆæ•ˆç‡å¾ˆé«˜ã€‚</p><p>æŸ¥æ‰¾éœ€è¦è¿›è¡Œéå†æŸ¥è¯¢ï¼Œæ•ˆç‡è¾ƒä½, ç‰¹åˆ«æ˜¯å½“ index è¶Šæ¥è¿‘ size çš„ä¸­é—´å€¼æ—¶å°¤å…¶ä½</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- LinkedList æ˜¯åŸºäºé“¾è¡¨å®ç°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æˆå‘˜å˜é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transient int size = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transient Node&lt;E&gt; first; //é“¾è¡¨çš„å¤´æŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transient Node&lt;E&gt; last; //å°¾æŒ‡é’ˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//å­˜å‚¨å¯¹è±¡çš„ç»“æ„ Node, LinkedListçš„å†…éƒ¨ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static class Node&lt;E&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E item;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Node&lt;E&gt; next; // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Node&lt;E&gt; prev; //æŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.item = element;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.next = next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.prev = prev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ ¸å¿ƒæ–¹æ³• linkBeforeã€linkLast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ·»åŠ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public boolean add(E e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    linkLast(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Links e as last element.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void linkLast(E e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final Node&lt;E&gt; l = last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    last = newNode;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (l == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        first = newNode;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        l.next = newNode; // ä»…ä»…æ˜¯æŒ‡é’ˆçš„ç§»åŠ¨, æ·»åŠ æ•ˆç‡é«˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    size++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modCount++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æŸ¥è¯¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public E get(int index) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    checkElementIndex(index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return node(index).item;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Node&lt;E&gt; node(int index) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // assert isElementIndex(index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¦‚æœå°äº sizeçš„ä¸€åŠ, å°±ä»èŠ‚ç‚¹å¤´éƒ¨éå†, å¦åˆ™å°±ä»èŠ‚ç‚¹å°¾éƒ¨å¼€å§‹éå†ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (index &lt; (size &gt;&gt; 1)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;E&gt; x = first;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; index; i++)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            x = x.next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return x;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;E&gt; x = last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = size - 1; i &gt; index; i--)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            x = x.prev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return x;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5211-concurrenthashmap">5.2.11. ConcurrentHashMap<a href="#5211-concurrenthashmap" class="hash-link" aria-label="Direct link to 5.2.11. ConcurrentHashMap" title="Direct link to 5.2.11. ConcurrentHashMap">â€‹</a></h3><p>ref: <a href="https://crossoverjie.top/2018/07/23/java-senior/ConcurrentHashMap/" target="_blank" rel="noopener noreferrer">https://crossoverjie.top/2018/07/23/java-senior/ConcurrentHashMap/</a></p><p><a href="https://github.com/ben-manes/concurrentlinkedhashmap" target="_blank" rel="noopener noreferrer">ä¸€ä¸ª concurrentlinkedhashmap å®ç°</a></p><p>é¢è¯•å¥—è·¯:</p><ul><li>è°ˆè°ˆä½ ç†è§£çš„ HashMapï¼Œè®²è®²å…¶ä¸­çš„ get put è¿‡ç¨‹ã€‚</li><li>1.8 åšäº†ä»€ä¹ˆä¼˜åŒ–ï¼Ÿ</li><li>æ˜¯çº¿ç¨‹å®‰å…¨çš„å˜›ï¼Ÿ</li><li>ä¸å®‰å…¨ä¼šå¯¼è‡´å“ªäº›é—®é¢˜ï¼Ÿ</li><li>å¦‚ä½•è§£å†³ï¼Ÿæœ‰æ²¡æœ‰çº¿ç¨‹å®‰å…¨çš„å¹¶å‘å®¹å™¨ï¼Ÿ</li><li>ConcurrentHashMap æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ 1.7ã€1.8 å®ç°æœ‰ä½•ä¸åŒï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿ
æ›¿æ¢äº†é”çš„å®ç°å§, ä½¿ç”¨äº† synchronized å’Œ cas æ“ä½œå§, å› ä¸º æ–°ç‰ˆæœ¬ synchronize åšäº†å¾ˆå¤šä¼˜åŒ–, æ€§èƒ½å·²ç»ä¸è¾“reentrantLock</li></ul><p>é’ˆå¯¹å¹¶å‘åœºæ™¯çš„ hashmap, æ¯” hashtable å¹¶å‘æ•ˆç‡æ›´é«˜</p><p>ä¿®æ”¹æ“ä½œ: é”å®šçš„ Segment è€Œä¸æ˜¯æ•´ä¸ª ConcurrentHashMap, æ›´æ–°æ“ä½œåªæ˜¯åœ¨è¿™ä¸ª Segment ä¸­å®Œæˆï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å¯¹æ•´ä¸ª ConcurrentHashMap åŠ é”, æ­¤æ—¶ï¼Œå…¶ä»–çš„çº¿ç¨‹ä¹Ÿå¯ä»¥å¯¹å¦å¤–çš„ Segment è¿›è¡Œ put æ“ä½œ
è¯»æ“ä½œå°±æ›´æ²¡ä»€ä¹ˆå½±å“äº†</p><p>Segment æ•°æ®ç»“æ„</p><p>æ•´ä¸ª ConcurrentHashMap æ•°æ®ç»“æ„</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- æ•°æ®ç»“æ„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - æˆå‘˜å˜é‡ä¸­ï¼ŒåŒ…å«äº†ä¸€ä¸ª Segment çš„æ•°ç»„ï¼ˆfinal Segment&lt;K,V&gt;[] segments;ï¼‰ï¼Œè€Œ Segment æ˜¯ ConcurrentHashMap çš„å†…éƒ¨ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - åœ¨ Segment è¿™ä¸ªç±»ä¸­ï¼ŒåŒ…å«äº†ä¸€ä¸ª HashEntry çš„æ•°ç»„ï¼ˆtransient volatile HashEntry&lt;K,V&gt;[] table;ï¼‰ã€‚è€Œ HashEntry ä¹Ÿæ˜¯ ConcurrentHashMap çš„å†…éƒ¨ç±»ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - HashEntry ä¸­ï¼ŒåŒ…å«äº† key å’Œ value ä»¥åŠ next æŒ‡é’ˆï¼ˆç±»ä¼¼äº HashMap ä¸­ Entryï¼‰ï¼Œæ‰€ä»¥ HashEntry å¯ä»¥æ„æˆä¸€ä¸ªé“¾è¡¨ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ConcurrentHashMap å’Œ HashTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ç›¸æ¯”äº HashTable å’Œç”¨åŒæ­¥åŒ…è£…å™¨åŒ…è£…çš„ HashMapï¼ˆCollections.synchronizedMap(new HashMap())ï¼‰ï¼ŒConcurrentHashMap æ‹¥æœ‰æ›´é«˜çš„å¹¶å‘æ€§ã€‚åœ¨å‰ä¸¤è€…ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„é”æ¥åŒæ­¥ä¸åŒçº¿ç¨‹é—´çš„å¹¶å‘è®¿é—®ã€‚åŒä¸€æ—¶é—´ç‚¹ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰é”ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨åŒä¸€æ—¶é—´ç‚¹ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®å®¹å™¨ã€‚è¿™è™½ç„¶ä¿è¯å¤šçº¿ç¨‹é—´çš„å®‰å…¨å¹¶å‘è®¿é—®ï¼Œä½†åŒæ—¶ä¹Ÿå¯¼è‡´å¯¹å®¹å™¨çš„è®¿é—®å˜æˆä¸²è¡ŒåŒ–çš„äº†ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ConcurrentHashMap çš„é«˜å¹¶å‘æ€§ä¸»è¦æ¥è‡ªäºä¸‰ä¸ªæ–¹é¢: (ç”±äºæ•£åˆ—æ˜ å°„è¡¨åœ¨å®é™…åº”ç”¨ä¸­å¤§å¤šæ•°æ“ä½œéƒ½æ˜¯æˆåŠŸçš„ è¯»æ“ä½œï¼Œæ‰€ä»¥ 2 å’Œ 3 æ—¢å¯ä»¥å‡å°‘è¯·æ±‚åŒä¸€ä¸ªé”çš„é¢‘ç‡ï¼Œä¹Ÿå¯ä»¥æœ‰æ•ˆå‡å°‘æŒæœ‰é”çš„æ—¶é—´)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ç”¨åˆ†ç¦»é”å®ç°å¤šä¸ªçº¿ç¨‹é—´çš„æ›´æ·±å±‚æ¬¡çš„å…±äº«è®¿é—®ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ç”¨ HashEntery å¯¹è±¡çš„ä¸å˜æ€§(finalä¿®é¥°)æ¥é™ä½æ‰§è¡Œè¯»æ“ä½œçš„çº¿ç¨‹åœ¨éå†é“¾è¡¨æœŸé—´å¯¹åŠ é”çš„éœ€æ±‚ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - é€šè¿‡å¯¹åŒä¸€ä¸ª Volatile å˜é‡çš„å†™ / è¯»è®¿é—®ï¼Œåè°ƒä¸åŒçº¿ç¨‹é—´è¯» / å†™æ“ä½œçš„å†…å­˜å¯è§æ€§ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// HashEntry å­˜å‚¨é”®å€¼å¯¹çš„è¿‡ç¨‹ä¸­ï¼Œæ•£åˆ—çš„æ—¶å€™å¦‚æœå‘ç”Ÿâ€œç¢°æ’â€ï¼Œå°†æŠŠç¢°æ’çš„ HashEntry å¯¹è±¡é“¾æ¥æˆä¸€ä¸ªé“¾è¡¨ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static final class HashEntry&lt;K,V&gt; {//ç±»æ¯”ç€ HashMap ä¸­çš„ Entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final int hash;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final K key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volatile V value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volatile HashEntry&lt;K,V&gt; next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HashEntry(int hash, K key, V value, HashEntry&lt;K,V&gt; next) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.hash = hash;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.key = key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.value = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.next = next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Segment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ç»§æ‰¿äº ReentrantLock ç±»ï¼Œä»è€Œä½¿å¾— Segment å¯¹è±¡å¯ä»¥å……å½“é”çš„è§’è‰²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Segment æ•°æ®ç»“æ„ç±»ä¼¼äº HashMapäº†ï¼Œéƒ½æ˜¯åŒ…å«äº†ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Segments are specialized versions of hash tables.  This</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * subclasses from ReentrantLock opportunistically, just to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * simplify some locking and avoid separate construction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static final class Segment&lt;K,V&gt; extends ReentrantLock implements Serializable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * The per-segment table. Elements are accessed via</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * entryAt/setEntryAt providing volatile semantics.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // å¦‚æœæ•£åˆ—æ—¶å‘ç”Ÿç¢°æ’ï¼Œç¢°æ’çš„ HashEntry å¯¹è±¡å°±ä»¥é“¾è¡¨çš„å½¢å¼é“¾æ¥æˆä¸€ä¸ªé“¾è¡¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transient volatile HashEntry&lt;K,V&gt;[] table;//Segment ä¸­åŒ…å«HashEntry çš„æ•°ç»„; ä½¿å¾— segment å¯ä»¥å¯ä»¥å®ˆæŠ¤å…¶åŒ…å«çš„è‹¥å¹²ä¸ªæ¡¶ï¼ˆHashEntryæ•°ç»„ä¸­çš„æ¯ä¸ªHashentryå…ƒç´ å³ä¸ºä¸€ä¸ª æ¡¶ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * The number of elements. Accessed only either within locks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * or among other volatile reads that maintain visibility.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transient int count;//count å˜é‡æ˜¯è®¡ç®—å™¨ï¼Œè¡¨ç¤ºæ¯ä¸ª Segment å¯¹è±¡ç®¡ç†çš„ table æ•°ç»„ï¼ˆè‹¥å¹²ä¸ª HashEntry çš„é“¾è¡¨); ä¹‹æ‰€ä»¥åœ¨æ¯ä¸ªSegmentå¯¹è±¡ä¸­åŒ…å«ä¸€ä¸ª count è®¡æ•°å™¨ï¼Œè€Œä¸åœ¨ ConcurrentHashMap ä¸­ä½¿ç”¨å…¨å±€çš„è®¡æ•°å™¨ï¼Œæ˜¯ä¸ºäº†é¿å…å‡ºç°â€œçƒ­ç‚¹åŸŸâ€è€Œå½±å“å¹¶å‘æ€§ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transient int modCount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * è£…è½½å› å­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final float loadFactor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¹¶å‘å†™æ“ä½œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Maps the specified key to the specified value in this table.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Neither the key nor the value can be null.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * &lt;p&gt; The value can be retrieved by calling the &lt;tt&gt;get&lt;/tt&gt; method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * with a key that is equal to the original key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @param key key with which the specified value is to be associated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @param value value to be associated with the specified key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @return the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @throws NullPointerException if the specified key or value is null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SuppressWarnings(&quot;unchecked&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public V put(K key, V value) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Segment&lt;K,V&gt; s;//é¦–å…ˆæœ‰ä¸€ä¸ª Segment çš„å¼•ç”¨ s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (value == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new NullPointerException();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int hash = hash(key);//hash() æ–¹æ³•å¯¹ key è¿›è¡Œè®¡ç®—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int j = (hash &gt;&gt;&gt; segmentShift) &amp; segmentMask;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ((s = (Segment&lt;K,V&gt;)UNSAFE.getObject          // nonvolatile; recheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (segments, (j &lt;&lt; SSHIFT) + SBASE)) == null) //  in ensureSegment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s = ensureSegment(j);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return s.put(key, hash, value, false);//è°ƒç”¨ Segment çš„ put(K key, int hash, V value, boolean onlyIfAbsent)æ–¹æ³•è¿›è¡Œå­˜å‚¨æ“ä½œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Segment çš„ put æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final V put(K key, int hash, V value, boolean onlyIfAbsent) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //åŠ é”ï¼Œè¿™é‡Œæ˜¯é”å®šçš„Segmentè€Œä¸æ˜¯æ•´ä¸ªConcurrentHashMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å› ä¸º put æ“ä½œåªæ˜¯åœ¨è¿™ä¸ª Segment ä¸­å®Œæˆï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å¯¹æ•´ä¸ª ConcurrentHashMap åŠ é”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //æ‰€ä»¥ï¼Œæ­¤æ—¶ï¼Œå…¶ä»–çš„çº¿ç¨‹ä¹Ÿå¯ä»¥å¯¹å¦å¤–çš„ Segment è¿›è¡Œ put æ“ä½œï¼Œå› ä¸ºè™½ç„¶è¯¥ Segment è¢«é”ä½äº†ï¼Œä½†å…¶ä»–çš„ Segment å¹¶æ²¡æœ‰åŠ é”ã€‚åŒæ—¶ï¼Œè¯»çº¿ç¨‹å¹¶ä¸ä¼šå› ä¸ºæœ¬çº¿ç¨‹çš„åŠ é”è€Œé˜»å¡ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HashEntry&lt;K,V&gt; node = tryLock() ? null :scanAndLockForPut(key, hash, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V oldValue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HashEntry&lt;K,V&gt;[] tab = table;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //å¾—åˆ°hashå¯¹åº”çš„tableä¸­çš„ç´¢å¼•index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int index = (tab.length - 1) &amp; hash;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //æ‰¾åˆ°hashå¯¹åº”çš„æ˜¯å…·ä½“çš„å“ªä¸ªæ¡¶ï¼Œä¹Ÿå°±æ˜¯å“ªä¸ªHashEntryé“¾è¡¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HashEntry&lt;K,V&gt; first = entryAt(tab, index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (HashEntry&lt;K,V&gt; e = first;;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (e != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                K k;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if ((k = e.key) == key ||</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    (e.hash == hash &amp;&amp; key.equals(k))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    oldValue = e.value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (!onlyIfAbsent) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        e.value = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ++modCount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                e = e.next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (node != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    node.setNext(first);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    node = new HashEntry&lt;K,V&gt;(hash, key, value, first);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                int c = count + 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (c &gt; threshold &amp;&amp; tab.length &lt; MAXIMUM_CAPACITY)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rehash(node);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    setEntryAt(tab, index, node);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ++modCount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                count = c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                oldValue = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //è§£é”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        unlock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return oldValue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="53-collections-å’Œ-arrays-å·¥å…·ç±»">5.3. Collections å’Œ Arrays å·¥å…·ç±»<a href="#53-collections-å’Œ-arrays-å·¥å…·ç±»" class="hash-link" aria-label="Direct link to 5.3. Collections å’Œ Arrays å·¥å…·ç±»" title="Direct link to 5.3. Collections å’Œ Arrays å·¥å…·ç±»">â€‹</a></h2><p>Collections æ–¹æ³•:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1ï¼Œå¯¹listè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å‰æè¯¥é›†åˆä¸€å®šè¦æœ‰åºã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int binarySearch(list,key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int binarySearch(list,key,Comparator);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2ï¼Œå¯¹listé›†åˆè¿›è¡Œæ’åºã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort(list);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort(list,comaprator);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//æŒ‰ç…§æŒ‡å®šæ¯”è¾ƒå™¨è¿›è¡Œæ’åº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3ï¼Œå¯¹é›†åˆå–æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max(Collection)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max(Collection,comparator)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">min(Collection)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">min(Collection,comparator)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4ï¼Œå¯¹listé›†åˆè¿›è¡Œåè½¬ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reverse(list);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8ï¼Œå¯ä»¥å°†ä¸åŒæ­¥çš„é›†åˆå˜æˆåŒæ­¥çš„é›†åˆã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Set synchronizedSet(Set&lt;T&gt; s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map synchronizedMap(Map&lt;K,V&gt; m)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List synchronizedList(List&lt;T&gt; list)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9.å¦‚æœæƒ³è¦å°†é›†åˆå˜æ•°ç»„ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¯ä»¥ä½¿ç”¨Collection ä¸­çš„toArray æ–¹æ³•ã€‚æ³¨æ„ï¼šæ˜¯Collectionä¸æ˜¯Collectionså·¥å…·ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ä¼ å…¥æŒ‡å®šçš„ç±»å‹æ•°ç»„å³å¯ï¼Œè¯¥æ•°ç»„çš„é•¿åº¦æœ€å¥½ä¸ºé›†åˆçš„sizeã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10. è¿”å› ç©ºé›†åˆ èŠ‚çœå†…å­˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">é€šè¿‡java.util.Collections.emptyList()æ–¹æ³•çš„ç›¸å…³æºç å¯ä»¥å¾—çŸ¥å®ƒå®é™…ä¸Šå°±æ˜¯è¿”å›äº†ä¸€ä¸ªç©ºçš„Listï¼Œä½†æ˜¯è¿™ä¸ªListå’Œæˆ‘ä»¬å¹³æ—¶å¸¸ç”¨çš„é‚£ä¸ªListæ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›çš„Listæ˜¯Collectionsç±»çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå®ƒç»§æ‰¿AbstractListåå¹¶æ²¡æœ‰å®ç°add()ã€remove()ç­‰æ–¹æ³•ï¼Œå› æ­¤è¿™ä¸ªè¿”å›å€¼Listå¹¶ä¸èƒ½å¢åŠ åˆ é™¤å…ƒç´ ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">æ—¢ç„¶è¿™ä¸ªListä¸èƒ½è¿›è¡Œå¢åˆ æ“ä½œï¼Œé‚£ä¹ˆå®ƒæœ‰ä½•æ„ä¹‰å‘¢ï¼Ÿ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">è¿™ä¸ªæ–¹æ³•ä¸»è¦ç›®çš„å°±æ˜¯è¿”å›ä¸€ä¸ªä¸å¯å˜çš„åˆ—è¡¨ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä½œä¸ºè¿”å›å€¼å°±ä¸éœ€è¦å†åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¯ä»¥å‡å°‘å†…å­˜å¼€é”€ã€‚å¹¶ä¸”è¿”å›ä¸€ä¸ªsizeä¸º0çš„Listï¼Œè°ƒç”¨è€…ä¸éœ€è¦æ ¡éªŒè¿”å›å€¼æ˜¯å¦ä¸ºnullï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿”å›å¯èƒ½ä¸ºç©ºçš„Listã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emptySet()ã€emptyMap()æ–¹æ³•åŒç†ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Arrays æ–¹æ³•:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1ï¼ŒäºŒåˆ†æŸ¥æ‰¾,æ•°ç»„éœ€è¦æœ‰åº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binarySearch(int[])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binarySearch(double[])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2ï¼Œæ•°ç»„æ’åº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort(int[])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort(char[])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. å¤åˆ¶æ•°ç»„ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">copyOf(oldArrayï¼ŒnewLength);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¤åˆ¶éƒ¨åˆ†æ•°ç»„ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">copyOfRange(oldArrayï¼ŒstartIndexï¼ŒendIndex)    è¿™é‡Œä¸åŒ…æ‹¬endIndexå¯¹åº”å€¼ï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4ï¼Œæ¯”è¾ƒä¸¤ä¸ªæ•°ç»„å¯¹åº”ä½ç½®çš„å…ƒç´ æ˜¯å¦ä¸€è‡´ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">equals(int[],int[]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5ï¼Œå°†æ•°ç»„å˜æˆé›†åˆã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List asList(T[]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">è¿™æ ·å¯ä»¥é€šè¿‡é›†åˆçš„æ“ä½œæ¥æ“ä½œæ•°ç»„ä¸­å…ƒç´ ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ä½†æ˜¯ä¸å¯ä»¥ä½¿ç”¨å¢åˆ æ–¹æ³•ï¼Œaddï¼Œremoveã€‚å› ä¸ºæ•°ç»„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œä¼šå‡ºç°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UnsupportOperationExcetionã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ï¼šcontainsï¼ŒindexOfã€‚ã€‚ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¦‚æœæ•°ç»„ä¸­å­˜å…¥çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆasListä¼šå°†æ•°ç»„å®ä½“ä½œä¸ºé›†åˆä¸­çš„å…ƒç´ ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¦‚æœæ•°ç»„ä¸­çš„å­˜å…¥çš„å¼•ç”¨æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆasListä¼šå°†æ•°ç»„ä¸­çš„å…ƒç´ ä½œä¸ºé›†åˆä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">çš„å…ƒç´ ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. å°†æ•°ç»„å˜æˆå­—ç¬¦ä¸²ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">toString(int[])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="54-é›†åˆæ’åº">5.4. é›†åˆæ’åº<a href="#54-é›†åˆæ’åº" class="hash-link" aria-label="Direct link to 5.4. é›†åˆæ’åº" title="Direct link to 5.4. é›†åˆæ’åº">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class Main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         List&lt;Boolean&gt; arr = Arrays.asList(true, false, false, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arr.sort((o1, o2) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if ((o1 &amp;&amp; o2) || (!o1 &amp;&amp; !o2)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return o2 ? 1 : -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // return o1 ? -1 : 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // if (onLine1 ^ onLine2) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //     return onLine1 ? -1 : 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //     return 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Arrays.toString(arr.toArray())); // true åœ¨å‰, false åœ¨å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>6. æ³›å‹</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="61-æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£">6.1. æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£<a href="#61-æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£" class="hash-link" aria-label="Direct link to 6.1. æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£" title="Direct link to 6.1. æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£">â€‹</a></h2><ul><li><p>æ³›å‹æ–¹æ³•ä¸­ çš„è‡ªå®šä¹‰æ³›å‹çš„å…·ä½“æ•°æ®ç±»å‹æ˜¯åœ¨<code>è°ƒç”¨è¯¥å‡½æ•°çš„æ—¶å€™ä¼ å…¥å®å‚æ—¶</code>ç¡®å®šçš„</p></li><li><p>æ³›å‹ç±»ä¸Šçš„è‡ªå®šä¹‰æ³›å‹æ˜¯åœ¨<code>ä½¿ç”¨è¯¥ç±»åˆ›å»ºå¯¹è±¡çš„æ—¶å€™</code> ç¡®å®šå…·ä½“çš„æ•°æ®ç±»å‹çš„</p></li><li><p>æ³›å‹æ¥å£ä¸Šçš„è‡ªå®šä¹‰æ³›å‹æ˜¯åœ¨<code>å®ç°è¯¥æ¥å£çš„æ—¶å€™</code>æŒ‡å®šå…·ä½“æ•°æ®ç±»å‹çš„ - å¦‚æœéœ€è¦<code>å»¶è¿Ÿç¡®å®šæ¥å£æ³›å‹</code>çš„å…·ä½“ç±»å‹, åœ¨åˆ›å»ºæ¥å£å®ç°ç±»å¯¹è±¡çš„æ—¶å€™æ‰æŒ‡å®šæ¥å£ä¸Šè‡ªå®šä¹‰æ³›å‹ï¼Œé‚£ä¹ˆéœ€è¦ä»¥ä¸‹æ ¼å¼ï¼š<code>class&lt;T&gt; ç±»å implements æ¥å£&lt;T&gt;</code></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="62-æ³›å‹åå°„">6.2. æ³›å‹åå°„<a href="#62-æ³›å‹åå°„" class="hash-link" aria-label="Direct link to 6.2. æ³›å‹åå°„" title="Direct link to 6.2. æ³›å‹åå°„">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="621-æ³›å‹åå°„-api">6.2.1. æ³›å‹åå°„ api<a href="#621-æ³›å‹åå°„-api" class="hash-link" aria-label="Direct link to 6.2.1. æ³›å‹åå°„ api" title="Direct link to 6.2.1. æ³›å‹åå°„ api">â€‹</a></h3><p>ParameterizedType å‚æ•°åŒ–ç±»å‹, æ¯”å¦‚: <code>ArrayList&lt;String&gt;</code>;</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// baseDaoç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class BaseDao&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å½“å‰è¿è¡Œç±»çš„ç±»å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Class&lt;T&gt; clazz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è¡¨å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String tableName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä¸»é”®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String id_primary;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ‹¿åˆ°å½“å‰è¿è¡Œç±»çš„å‚æ•°åŒ–ç±»å‹ä¸­å®é™…çš„ç±»å‹  ( BaseDao&lt;Admin&gt; ,  Admin.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BaseDao(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //**è·å–parentçš„å‚æ•°åŒ–ç±»å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Type type = this.getClass().getGenericSuperclass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ParameterizedType pt = (ParameterizedType) type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Type[] types = pt.getActualTypeArguments();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        clazz = (Class&lt;T&gt;) types[0];//åˆ°æ­¤, å·²ç»æ‹¿åˆ°ï¼š  Admin.class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /*******1. è·å–è¡¨å*******/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Table table = clazz.getAnnotation(Table.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tableName = table.tableName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /*******2. è·å–ä¸»é”®å­—æ®µ*******/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //è·å–å½“å‰è¿è¡Œç±»çš„æ‰€æœ‰å­—æ®µã€éå†ã€è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[] fs = clazz.getDeclaredFields();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (Field f : fs) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è®¾ç½®å¼ºåˆ¶è®¿é—®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            f.setAccessible(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Id anno_id = f.getAnnotation(Id.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (anno_id != null) {// ä¸ä¸ºnull, è¯æ˜æ—¶ä¸»é”®å­—æ®µ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Column column = f.getAnnotation(Column.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                id_primary = column.columnName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // è·³å‡ºå¾ªç¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;è¡¨ï¼š&quot; + tableName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;ä¸»é”®ï¼š&quot; + id_primary);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public T findById(int id){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String sql = &quot;select * from &quot; + tableName + &quot; where &quot; + id_primary +&quot;=?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * DbUtilsçš„å·²ç»å°è£…å¥½çš„å·¥å…·ç±»ï¼šBeanHandler?   å±æ€§=å­—æ®µ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return JdbcUtils.getQueryRunner().query(sql, new BeanHandler&lt;T&gt;(clazz), id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public List&lt;T&gt; getAll(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String sql = &quot;select * from &quot; + tableName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return JdbcUtils.getQuerrRunner().query(sql, new BeanListHandler&lt;T&gt;(clazz));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="622-æ¡ˆä¾‹-ä¼˜åŒ–-basedao">6.2.2. æ¡ˆä¾‹-ä¼˜åŒ– BaseDao<a href="#622-æ¡ˆä¾‹-ä¼˜åŒ–-basedao" class="hash-link" aria-label="Direct link to 6.2.2. æ¡ˆä¾‹-ä¼˜åŒ– BaseDao" title="Direct link to 6.2.2. æ¡ˆä¾‹-ä¼˜åŒ– BaseDao">â€‹</a></h3><p>è§ <a href="#%E7%9C%8B%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%E4%BC%98%E5%8C%96dao-%E8%A7%A3%E5%86%B3%E5%AD%97%E6%AE%B5%E5%92%8C%E5%B1%9E%E6%80%A7%E4%B8%8D%E4%B8%80%E8%87%B4">æ³¨è§£åå°„</a></p><h1>7. æ³¨è§£</h1><p><a href="https://blog.csdn.net/briblue/article/details/73824058" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/briblue/article/details/73824058</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="71-è¯­æ³•">7.1. è¯­æ³•<a href="#71-è¯­æ³•" class="hash-link" aria-label="Direct link to 7.1. è¯­æ³•" title="Direct link to 7.1. è¯­æ³•">â€‹</a></h2><p>æ³¨è§£æˆå‘˜å±æ€§ç±»å‹:</p><ul><li><p>æ‰€æœ‰åŸºæœ¬ç±»å‹</p></li><li><p>String</p></li><li><p>Class</p></li><li><p>Enum</p></li><li><p>Annotation</p></li><li><p>ä»¥ä¸Šç±»å‹çš„æ•°ç»„</p></li></ul><p>æ³¨è§£æœ¬èº«ä¸æ”¯æŒç»§æ‰¿, ä½†æ˜¯æ³¨è§£çš„å±æ€§å¯ä»¥æ˜¯å¦å¤–ä¸€ä¸ªæ³¨è§£(æ³¨è§£æ•°ç»„), è€Œä¸”æ³¨è§£æœ‰ä¸€ä¸ª ä¸€ä¸ªå…ƒæ³¨è§£ @Inherited</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å®šä¹‰ä¸€ä¸ªæœ€æ™®é€šçš„æ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public @interface Author {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * æ³¨è§£å±æ€§</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *       1. ä¿®é¥°ä¸ºé»˜è®¤æˆ–publicæ•ˆæœä¸€æ ·</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String name();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int age();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä½¿ç”¨:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Author(name = &quot;Jet&quot;, age = 30)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void save() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//          å¸¦é»˜è®¤å€¼çš„æ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public @interface Author {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String name();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int age() default 30;   // å¸¦é»˜è®¤å€¼çš„æ³¨è§£;  ä½¿ç”¨çš„æ—¶å€™å°±å¯ä»¥ä¸å†™æ­¤å±æ€§å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ³¨è§£çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æœ‰ç¡®å®šçš„å€¼ï¼Œè¦æƒ³è¡¨ç¤ºå…ƒç´ nullçš„çŠ¶æ€ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int age() default -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//      é»˜è®¤åç§°çš„æ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public @interface Author {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¦‚æœæ³¨è§£åç§°ä¸ºvalue,ä½¿ç”¨æ—¶å€™å¯ä»¥çœç•¥åç§°ï¼Œç›´æ¥ç»™å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // (ä¸”æ³¨è§£åªæœ‰ä¸€ä¸ªå±æ€§æ—¶å€™æ‰å¯ä»¥çœç•¥åç§°)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String value();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä½¿ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Author(&quot;Jet&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ç­‰ä»·äº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Author(value = &quot;Jet&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//      æ•°ç»„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public @interface Author {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String[] value() default {&quot;test1&quot;,&quot;test2&quot;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä½¿ç”¨ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Authorï¼ˆ{â€œâ€ï¼Œâ€œâ€}ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void save() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="72-å…ƒæ³¨è§£">7.2. å…ƒæ³¨è§£<a href="#72-å…ƒæ³¨è§£" class="hash-link" aria-label="Direct link to 7.2. å…ƒæ³¨è§£" title="Direct link to 7.2. å…ƒæ³¨è§£">â€‹</a></h2><p>è¡¨ç¤ºæ³¨è§£ä¸Šçš„æ³¨è§£ï¼Œ</p><p>ä¸€èˆ¬å¯ä»¥è¿™æ ·ä½¿ç”¨ å¯¼å…¥è‡ªåŠ¨é…ç½®</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Target(ElementType.TYPE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Retention(RetentionPolicy.RUNTIME)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Documented</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Import(RabbitBootstrapConfiguration.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public @interface EnableRabbit {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>é™¤äº†æ™®é€šæ³¨è§£ï¼Œ è¿˜æ”¯æŒä¸‹é¢å‡ ä¸ªç‰¹æ®Šçš„</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//      æŒ‡å®šæ³¨è§£çš„å¯ç”¨èŒƒå›´ @Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">æŒ‡å®šæ³¨è§£åœ¨ä»€ä¹ˆåœ°æ–¹ç”¨ï¼Œä¾‹å¦‚ç”¨äºä¸€ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªåŸŸ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Target({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TYPE,     ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FIELD,     å­—æ®µ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">METHOD,  æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PARAMETER,   å‚æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONSTRUCTOR, æ„é€ å™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LOCAL_VARIABLE  å±€éƒ¨å˜é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     æŒ‡å®šæ³¨è§£çš„å¯ç”¨å£°æ˜å‘¨æœŸ @Retention</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æŒ‡å®šæ³¨è§£åœ¨å“ªä¸€ä¸ªçº§åˆ«å¯ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Retention(RetentionPolicy.SOURCE)    //æ³¨è§£åªåœ¨æºç çº§åˆ«æœ‰æ•ˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Retention(RetentionPolicy.CLASS)      //æ³¨è§£åœ¨å­—èŠ‚ç çº§åˆ«æœ‰æ•ˆ(ç¼–è¯‘æˆå­—èŠ‚ç åè¿˜ä¿ç•™æ³¨è§£ä¿¡æ¯)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    // é»˜è®¤å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Retention(RetentionPolicy.RUNTIME)   æ³¨è§£åœ¨è¿è¡Œæ—¶æœŸæœ‰æ•ˆ(æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„å»è·å–æ³¨è§£ä¿¡æ¯, å¸¸ç”¨)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//      æ³¨è§£åŒ…å«è¿›javadocä¸­ @Documented</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Documented</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//      å…è®¸å­ç±»ç»§æ‰¿çˆ¶ç±»ä¸­çš„æ³¨è§£ @Inherited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¯¹äºè¢«æ ‡æ³¨çš„æ³¨è§£ï¼Œå…è®¸å­ç±»ç»§æ‰¿çˆ¶ç±»ä¸­çš„è¯¥æ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Inherited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//      æ‹“å±•: @Constraint(validatedBy = {XXXXValidator.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¯¹æ³¨è§£æ ‡æ³¨çš„å­—æ®µè¿›è¡Œæ ¡éªŒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="73-æ³¨è§£åå°„">7.3. æ³¨è§£åå°„<a href="#73-æ³¨è§£åå°„" class="hash-link" aria-label="Direct link to 7.3. æ³¨è§£åå°„" title="Direct link to 7.3. æ³¨è§£åå°„">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// æ³¨è§£åå°„è¦è®¾ç½®æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆï¼Œå³ï¼šåœ¨åˆ›å»ºæ³¨è§£æ—¶åŠ ä¸Šï¼š @Retention(RetentionPolicy.RUNTIME)   æ³¨è§£åœ¨è¿è¡Œæ—¶æœŸæœ‰æ•ˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Author(remark = &quot;ä¿å­˜ä¿¡æ¯ï¼ï¼ï¼&quot;, age = 19)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void save() throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è·å–æ³¨è§£ä¿¡æ¯ï¼š name/age/remark</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. å…ˆè·å–ä»£è¡¨æ–¹æ³•çš„Methodç±»å‹;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Class clazz = App_2.class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Method m = clazz.getMethod(&quot;save&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. å†è·å–æ–¹æ³•ä¸Šçš„æ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Author author = m.getAnnotation(Author.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è·å–è¾“å‡ºæ³¨è§£ä¿¡æ¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(author.authorName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(author.age());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(author.remark());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="74-çœ‹ä¸€ä¸ªä¾‹å­ä¼˜åŒ–-dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´">7.4. çœ‹ä¸€ä¸ªä¾‹å­(ä¼˜åŒ– dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´)<a href="#74-çœ‹ä¸€ä¸ªä¾‹å­ä¼˜åŒ–-dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´" class="hash-link" aria-label="Direct link to 7.4. çœ‹ä¸€ä¸ªä¾‹å­(ä¼˜åŒ– dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´)" title="Direct link to 7.4. çœ‹ä¸€ä¸ªä¾‹å­(ä¼˜åŒ– dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´)">â€‹</a></h2><p>è§£å†³ä¼˜åŒ–çš„é—®é¢˜ï¼š</p><ul><li><ol><li>å½“æ•°æ®åº“è¡¨åä¸ç±»åä¸ä¸€è‡´ã€</li></ol></li><li><ol start="2"><li>å­—æ®µä¸å±æ€§ä¸ä¸€æ ·ã€</li></ol></li><li><ol start="3"><li>ä¸»é”®ä¸å« id</li></ol></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="741-é€šè¿‡æ³¨è§£ä¼˜åŒ–-javabean">7.4.1. é€šè¿‡æ³¨è§£ä¼˜åŒ– JavaBean<a href="#741-é€šè¿‡æ³¨è§£ä¼˜åŒ–-javabean" class="hash-link" aria-label="Direct link to 7.4.1. é€šè¿‡æ³¨è§£ä¼˜åŒ– JavaBean" title="Direct link to 7.4.1. é€šè¿‡æ³¨è§£ä¼˜åŒ– JavaBean">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//adminç±»ï¼Œç»è¿‡æ³¨è§£ä¼˜åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Admin=a_adminè¡¨å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Table(tableName=&quot;a_admin&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Admin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Id//ä¸»é”®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Column(columnName = &quot;a_id&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int id;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Column(columnName = &quot;a_userName&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String userName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Column(columnName = &quot;a_pwd&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String pwd;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   getter&amp;setter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String toString() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;Admin [id=&quot; + id + &quot;, pwd=&quot; + pwd + &quot;, userName=&quot; + userName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                + &quot;]&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="742-æ³›å‹åå°„ä¼˜åŒ–-basedao">7.4.2. æ³›å‹åå°„ä¼˜åŒ– BaseDao<a href="#742-æ³›å‹åå°„ä¼˜åŒ–-basedao" class="hash-link" aria-label="Direct link to 7.4.2. æ³›å‹åå°„ä¼˜åŒ– BaseDao" title="Direct link to 7.4.2. æ³›å‹åå°„ä¼˜åŒ– BaseDao">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// baseDaoç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class BaseDao&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å½“å‰è¿è¡Œç±»çš„ç±»å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Class&lt;T&gt; clazz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è¡¨å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String tableName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä¸»é”®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String id_primary;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ‹¿åˆ°å½“å‰è¿è¡Œç±»çš„å‚æ•°åŒ–ç±»å‹ä¸­å®é™…çš„ç±»å‹  ( BaseDao&lt;Admin&gt; ,  Admin.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BaseDao(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //**è·å–parentçš„å‚æ•°åŒ–ç±»å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Type type = this.getClass().getGenericSuperclass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ParameterizedType pt = (ParameterizedType) type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Type[] types = pt.getActualTypeArguments();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        clazz = (Class&lt;T&gt;) types[0];//åˆ°æ­¤, å·²ç»æ‹¿åˆ°ï¼š  Admin.class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /*******1. è·å–è¡¨å*******/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Table table = clazz.getAnnotation(Table.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tableName = table.tableName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /*******2. è·å–ä¸»é”®å­—æ®µ*******/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //è·å–å½“å‰è¿è¡Œç±»çš„æ‰€æœ‰å­—æ®µã€éå†ã€è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[] fs = clazz.getDeclaredFields();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (Field f : fs) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è®¾ç½®å¼ºåˆ¶è®¿é—®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            f.setAccessible(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Id anno_id = f.getAnnotation(Id.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (anno_id != null) {// ä¸ä¸ºnull, è¯æ˜æ—¶ä¸»é”®å­—æ®µ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Column column = f.getAnnotation(Column.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                id_primary = column.columnName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // è·³å‡ºå¾ªç¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;è¡¨ï¼š&quot; + tableName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;ä¸»é”®ï¼š&quot; + id_primary);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public T findById(int id){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String sql = &quot;select * from &quot; + tableName + &quot; where &quot; + id_primary +&quot;=?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * DbUtilsçš„å·²ç»å°è£…å¥½çš„å·¥å…·ç±»ï¼šBeanHandler?   å±æ€§=å­—æ®µ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return JdbcUtils.getQueryRunner().query(sql, new BeanHandler&lt;T&gt;(clazz), id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public List&lt;T&gt; getAll(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String sql = &quot;select * from &quot; + tableName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return JdbcUtils.getQuerrRunner().query(sql, new BeanListHandler&lt;T&gt;(clazz));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="743-è‡ªå®šä¹‰ç»“æœé›†-handler">7.4.3. è‡ªå®šä¹‰ç»“æœé›† handler<a href="#743-è‡ªå®šä¹‰ç»“æœé›†-handler" class="hash-link" aria-label="Direct link to 7.4.3. è‡ªå®šä¹‰ç»“æœé›† handler" title="Direct link to 7.4.3. è‡ªå®šä¹‰ç»“æœé›† handler">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * è‡ªå®šä¹‰ç»“æœé›†ï¼šå°è£…å•ä¸ªBeanå¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class BeanHandler&lt;T&gt; implements ResultSetHandler&lt;T&gt;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä¿å­˜ä¼ å…¥çš„è¦å°è£…çš„ç±»çš„å­—èŠ‚ç </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Class&lt;T&gt; clazz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BeanHandler(Class&lt;T&gt; clazz) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.clazz = clazz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å°è£…ç»“æœé›†çš„æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public T handle(ResultSet rs) throws SQLException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // åˆ›å»ºè¦å°è£…çš„å¯¹è±¡  â€˜1â€™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            T t = clazz.newInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // å‘ä¸‹è¯»ä¸€è¡Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (rs.next()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // a. è·å–ç±»çš„æ‰€æœ‰çš„Fieldå­—æ®µæ•°ç»„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Field[] fs = clazz.getDeclaredFields();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // b. éå†ï¼Œ å¾—åˆ°æ¯ä¸€ä¸ªå­—æ®µç±»å‹ï¼šField</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for (Field f : fs) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // c. è·å–â€å±æ€§åç§°â€œï¼Œattention: ä¸æ˜¯æ³¨è§£é‡Œçš„å­—æ®µå</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    String fieldName = f.getName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // e. è·å–Fieldå­—æ®µä¸Šæ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Column column =  f.getAnnotation(Column.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 // æ•°æ®åº“ä¸­å­—æ®µ a_userName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    String columnName = column.columnName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // g. å­—æ®µå€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Object columnValue = rs.getObject(columnName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // è®¾ç½®ï¼ˆBeanUtilsç»„ä»¶ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    BeanUtils.copyProperty(t, fieldName, columnValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return t;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * è‡ªå®šä¹‰ç»“æœé›†ï¼šå°è£…å¤šä¸ªBeanå¯¹è±¡åˆ°Listé›†åˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class BeanListHandler&lt;T&gt; implements ResultSetHandler&lt;List&lt;T&gt;&gt;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è¦å°è£…çš„å•ä¸ªå¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Class&lt;T&gt; clazz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BeanListHandler(Class&lt;T&gt; clazz){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.clazz = clazz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æŠŠä»æ•°æ®åº“æŸ¥è¯¢åˆ°çš„æ²¡ä¸€è¡Œè®°å½•ï¼Œå°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå†æäº¤åˆ°listé›†åˆï¼Œ è¿”å›List&lt;T&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public List&lt;T&gt; handle(ResultSet rs) throws SQLException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;T&gt; list = new ArrayList&lt;T&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // å‘ä¸‹è¯»ä¸€è¡Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (rs.next()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // åˆ›å»ºè¦å°è£…çš„å¯¹è±¡  â€˜1â€™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                T t = clazz.newInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // a. è·å–ç±»çš„æ‰€æœ‰çš„Fieldå­—æ®µæ•°ç»„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Field[] fs = clazz.getDeclaredFields();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // b. éå†ï¼Œ å¾—åˆ°æ¯ä¸€ä¸ªå­—æ®µç±»å‹ï¼šField</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for (Field f : fs) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // c. è·å–â€å±æ€§åç§°â€œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    String fieldName = f.getName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // e. è·å–Fieldå­—æ®µä¸Šæ³¨è§£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Column column =  f.getAnnotation(Column.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // f. â€å­—æ®µåâ€œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    String columnName = column.columnName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // g. å­—æ®µå€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Object columnValue = rs.getObject(columnName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // è®¾ç½®ï¼ˆBeanUtilsç»„ä»¶ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    BeanUtils.copyProperty(t, fieldName, columnValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // å¯¹è±¡æ·»åŠ åˆ°é›†åˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                list.add(t);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return list;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>8. io</h1><p>æ“ä½œ io å­—èŠ‚åºåˆ—åŒ–åº“: <a href="https://github.com/EsotericSoftware/kryo" target="_blank" rel="noopener noreferrer">https://github.com/EsotericSoftware/kryo</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="81-ioæ€»ç»“">8.1. ioæ€»ç»“<a href="#81-ioæ€»ç»“" class="hash-link" aria-label="Direct link to 8.1. ioæ€»ç»“" title="Direct link to 8.1. ioæ€»ç»“">â€‹</a></h2><p>io æœ‰è¿™å‡ ç§ç”¨æ³•:</p><ul><li><p>åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¥å—ä¸€ä¸ªè¿æ¥ï¼Œè¯»å–æ•°æ®ï¼Œå¤„ç†ä¸šåŠ¡ï¼Œå†™å›ç»“æœï¼Œå†æ¥å—ä¸‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ˜¯åŒæ­¥é˜»å¡ã€‚è¿™ç§ç”¨æ³•å‡ ä¹æ²¡æœ‰ã€‚</p></li><li><p>ä¸€ä¸ªçº¿ç¨‹å’Œä¸€ä¸ªçº¿ç¨‹æ± ï¼Œçº¿ç¨‹è¿è¡Œselectorï¼Œå°†æ‰€æœ‰ channel æ³¨å†Œåˆ°å¤šè·¯å¤ç”¨é€‰æ‹©å™¨ä¸Šï¼Œå¦‚æœchannel ä¸­æœ‰æ•°æ®äº†, å°±ä»çº¿ç¨‹æ± ä¸­æ‹¿åˆ°ä¸€ä¸ªçº¿ç¨‹å¤„ç†, ä¹Ÿå°±æ˜¯å¤šè·¯å¤ç”¨ï¼Œè¿™æ˜¯åŒæ­¥éé˜»å¡ã€‚ä¹Ÿå°±æ˜¯ java nio çš„åŸç†</p></li><li><p>ä¸€ä¸ªçº¿ç¨‹å’Œä¸€ä¸ªçº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ³¨å†Œä¸€ä¸ªacceptå›è°ƒï¼Œç³»ç»Ÿå¸®æˆ‘ä»¬æ¥å—å¥½è¿æ¥åï¼Œæ‰è§¦å‘å›è°ƒåœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œæ‰§è¡Œæ—¶å†æ³¨å†Œreadå›è°ƒï¼Œç³»ç»Ÿå¸®æˆ‘ä»¬æ¥å—å¥½æ•°æ®åï¼Œæ‰è§¦å‘å›è°ƒåœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œå°±æ˜¯AIOï¼Œè¿™æ˜¯å¼‚æ­¥éé˜»å¡</p></li></ul><p>redisä¹Ÿæ˜¯å¤šè·¯å¤ç”¨ï¼Œä½†å®ƒåªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œselectæ“ä½œï¼Œå¤„ç†å°±ç»ªçš„è¿æ¥ï¼Œæ•´ä¸ªæ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ‰€ä»¥å¤©ç„¶ä¸å­˜åœ¨å¹¶å‘é—®é¢˜ã€‚åªèƒ½æŠŠå®ƒå½’ä¸ºåŒæ­¥é˜»å¡äº†ã€‚</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="82-socket-ç½‘ç»œç¼–ç¨‹">8.2. socket ç½‘ç»œç¼–ç¨‹<a href="#82-socket-ç½‘ç»œç¼–ç¨‹" class="hash-link" aria-label="Direct link to 8.2. socket ç½‘ç»œç¼–ç¨‹" title="Direct link to 8.2. socket ç½‘ç»œç¼–ç¨‹">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ç³»ç»Ÿé—´è¿›è¡Œé€šä¿¡ï¼Œ éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * - æ•°æ®ä¼ è¾“.  - å€ŸåŠ© tcp/ip ï¼ˆå¯é ï¼Œ æ€§èƒ½è¾ƒå·®ï¼‰, æˆ– udp/ip åè®® ï¼ˆæ•°æ®ä¸¢å¤±ï¼Œ ä¹±åºï¼Œ ä½†æ˜¯æ€§èƒ½æ›´å¥½ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * - æ•°æ®å¤„ç†ï¼ˆè¯»å–or å†™å…¥ï¼‰ - åŒæ­¥io æˆ–è€… å¼‚æ­¥io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *      - åŒæ­¥ioåˆ†ä¸º bio, nio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          bio - æŸä¸ª thread å½“å‘èµ·ioæ“ä½œ, ä¸ºé˜»å¡æ–¹å¼ ï¼ˆcpu ä¸€ç›´ç©ºé—²ç­‰å¾…ï¼‰ï¼Œç›´åˆ°è¯»å–åˆ° æµ or å°† æµå†™å…¥åˆ°æ“ä½œç³»ç»Ÿæ‰ä¼šé‡Šæ”¾èµ„æºï¼Œ æœŸé—´ç‹¬å èµ„æºï¼Œ å…¶ä»–éœ€è¦ä½¿ç”¨å…±äº«èµ„æºçš„threadå‡ç­‰å¾…</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          nio - åŸºäº&quot;äº‹ä»¶é©±åŠ¨&quot; æ€æƒ³ï¼Œ é€šè¿‡ Reactoræ¨¡å¼ å®ç° ã€‚ æŸä¸ª thread è¿›è¡Œ è¯» or å†™æ“ä½œ å‡ä¸º éé˜»å¡çš„ ï¼ˆcpu å»å¤„ç†å…¶ä»–ä»»åŠ¡ï¼‰ã€‚ å½“ socket æœ‰ stream å¯è¯» æˆ– æœ‰ stream å¾…è¢« å†™å…¥ socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          æ—¶, å‘å‡ºäº‹ä»¶(å¦‚ è¿æ¥å»ºç«‹äº‹ä»¶, æµè¯»å–äº‹ä»¶, æµå†™å…¥äº‹ä»¶), ç”±æ“ä½œç³»ç»Ÿé€šçŸ¥ appæ¥å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *      - å¼‚æ­¥io åˆ†ä¸º aio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          aio - åŒæ ·åŸºäºäº‹ä»¶é©±åŠ¨, é€šè¿‡ Proactoræ¨¡å¼å®ç°;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          å’Œnioå¯¹æ¯”, 1. ç®€åŒ–ç¼–ç¨‹, ioæ“ä½œç”±æ“ä½œç³»ç»Ÿå®Œæˆ, appåªè¦è°ƒç”¨apiå³å¯; 2. çœç•¥äº† nioä¸­éœ€è¦éå† äº‹ä»¶é€šçŸ¥é˜Ÿåˆ—(Selector)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          çš„æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * è¿™æ ·ç»„åˆçš„è¯, æœ‰å››ç§é€šä¿¡æ–¹å¼: tcp/ip + bio, tcp/ip  + nio, udp/ip + bio, udp/ip + nio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * *************************************************************************************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ä¸‹é¢æ˜¯ bio + tcp æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Client {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private String url = &quot;127.0.0.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private int port = 9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Socket socket;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private BufferedReader readerOnServer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private PrintWriter printerOnServer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private BufferedReader readerOnCli;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void init(String url, int port) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socket = new Socket(url, port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnServer = new BufferedReader(new InputStreamReader(socket.getInputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printerOnServer = new PrintWriter(socket.getOutputStream(), true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnCli   = new BufferedReader(new InputStreamReader(System.in));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void start() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String line = readerOnCli.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (testExit(line)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; send to server: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // send to server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            printerOnServer.println(line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // receive from server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String respLine = readerOnServer.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; receive from server: &quot; + respLine);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private boolean testExit(String test) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (StringUtils.isBlank(test) || &quot;exit&quot;.equalsIgnoreCase(test)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            printerOnServer.write(&quot;exit&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; client exit.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void close() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printerOnServer.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnCli.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnServer.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socket.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Client client = new Client();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        client.init(&quot;127.0.0.1&quot;, 9527);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        client.start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * è¿™ä¸ª server åªæ”¯æŒ å•ä¸ª client è¿æ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å¤šä¸ª client è¿æ¥ serveræ€ä¹ˆåŠ? é¦–å…ˆè¦ pass æ‰ &quot;åœ¨ server ä¸­ åˆ›å»ºå¤šä¸ª socket&quot;çš„æƒ³æ³•, å› ä¸º ç”Ÿæˆ socket æ˜¯éå¸¸é‡çš„æ“ä½œ, å </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ç”¨serverèµ„æºéå¸¸å¤š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * é€šå¸¸ç”¨é‡‡ç”¨ &quot;è¿æ¥æ± &quot;, å¥½å¤„æ˜¯ ğŸ¶ èƒ½å¤Ÿé™åˆ¶åˆ›å»ºçš„ socketä¸ªæ•°; ğŸ¶ é¿å…é‡å¤åˆ›å»º socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ä½†æ˜¯è¿™ç§æ–¹å¼è¿˜æ˜¯æœ‰é—®é¢˜: è¿æ¥æ± ä¸­ socket æ€»æ˜¯æœ‰é™çš„æ€»æœ‰ä¸å¤Ÿç”¨çš„æ—¶å€™; server éœ€è¦è®¾ç½®è¶…æ—¶æ—¶é—´, é˜²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * æ­¢ server è¿å¸¦ clientæŒ‚æ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å¦‚æœè¦æ”¯æŒå¤šä¸ª client è¿æ¥ï¼Œ å¯é‡‡ç”¨ çº¿ç¨‹æ± ï¼Œ æ¯ä¸ª socket æ–°å¼€ä¸€ä¸ª threadã€‚ è¿™ä¹ˆåšæœ‰ç¼ºç‚¹ï¼š æ— è®ºæ˜¯å¦æ˜¯æœ‰æ•ˆè¯·æ±‚ï¼Œ server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * éƒ½è¦è€—è´¹ä¸€ä¸ª thread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å‘³äº†é¿å… è¿‡å¤šçš„ thread è€—å°½ serverçš„èµ„æºï¼Œ çº¿ç¨‹æ± å¿…é¡»æ˜¯é™å®šå¤§å°çš„ã€‚ &lt;=&gt; é‡‡ç”¨ bio æ–¹å¼çš„ server æ”¯æ’‘çš„è¿æ¥æ•°æ˜¯æœ‰é™çš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private ServerSocket serverSocket;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private BufferedReader readerFromClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private PrintWriter writerToClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //public void initBlock(int port) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    this.serverSocket = new ServerSocket(port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    this.readerFromClient = new BufferedReader(new InputStreamReader(serverSocket.accept().getInputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException, InterruptedException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int port = 9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServerSocket socketServer = new ServerSocket(port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketServer.setSoTimeout(60 * 1000); // unit : milliseconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;&gt;&gt;&gt; server listen on port: &quot; + port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Socket socketClient = socketServer.accept(); // start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BufferedReader readerFromClient = new BufferedReader(new InputStreamReader(socketClient.getInputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //BufferedWriter writerToClient   = new BufferedWriter(new OutputStreamWriter(socketClient.getOutputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PrintWriter writerToClient = new PrintWriter(socketClient.getOutputStream(), true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String line = readerFromClient.readLine(); // start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (StringUtils.isBlank(line)) {// read nothing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread.sleep(100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                continue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (&quot;exit&quot;.equalsIgnoreCase(line)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                readerFromClient.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                writerToClient.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                socketServer.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;&gt;&gt;&gt; server exit&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; msg from client: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            writerToClient.println(line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; msg to client: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Thread.sleep(100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.exit(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * åŸºäºæ¶ˆæ¯çš„æ–¹å¼å®ç°é€šä¿¡;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * æ•°æ®ä¼ è¾“: tcp/ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * æ•°æ®å¤„ç†: nio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Client {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private Selector selector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //public void init(String ip, int port) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    SocketChannel socketChannel = SocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    socketChannel.configureBlocking(false); // configure channel as non blocking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    socketChannel.connect(new InetSocketAddress(ip, port));// å¯¹äº non blocking io, ç«‹å³è¿”å› false, è¡¨ç¤ºè¿æ¥å»ºç«‹ä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //                                            // ç”¨channel.finishConnect();æ‰èƒ½å®Œæˆè¿æ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    Selector selector = Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    socketChannel.register(selector, SelectionKey.OP_CONNECT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //public void listen() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String ip = &quot;127.0.0.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int port = 9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SocketChannel socketChannel = SocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel.configureBlocking(false); // configure channel as non blocking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ä¼šç«‹å³è¿”å› false, è¡¨ç¤ºè¿æ¥å»ºç«‹ä¸­; è°ƒç”¨channel.finishConnect()æ‰èƒ½å®Œæˆè¿æ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel.connect(new InetSocketAddress(ip, port));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // register socket channel with selector, å¹¶æŒ‡å®šåªå¯¹ è¿æ¥ æ„Ÿå…´è¶£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Selector selector = Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel.register(selector, SelectionKey.OP_CONNECT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BufferedReader readerOnCli = new BufferedReader(new InputStreamReader(System.in));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (socketChannel.isConnected()) {// connection is established; send msg to server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                String line = readerOnCli.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                socketChannel.write(StandardCharsets.UTF_8.encode(line));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (&quot;exit&quot;.equalsIgnoreCase(line)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    readerOnCli.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    socketChannel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    selector.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    System.out.println(&quot;&gt;&gt;&gt; client exit.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // receive from server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            selector.select(60 * 1000);// timeout = 60 s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (it.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SelectionKey key = it.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                it.remove();// remove current key from key set to avoid repetition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (key.isConnectable()) {// event: è¿æ¥äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    SocketChannel sc = (SocketChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sc.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // - è¿™æ—¶, sc å¯¹ read äº‹ä»¶ä¹Ÿæ„Ÿå…´è¶£äº†;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // - ä¸€èˆ¬ä¸ä¼šç›´æ¥æ³¨å†Œ write äº‹ä»¶ å› ä¸ºåœ¨ buffer æœªæ»¡æ—¶ä¸€ç›´æ˜¯å¯å†™çš„, å› æ­¤å¦‚æœåœ¨æ³¨å†Œäº† write äº‹ä»¶è€Œåˆä¸ä½¿ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //   å®ƒæ—¶ cpu æ¶ˆè€—å¯èƒ½ä¼š100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sc.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (sc.isConnectionPending()) {// å¦‚æœè¿æ¥è¿˜æ²¡å®Œæˆï¼Œåˆ™å®Œæˆè¿æ¥çš„å»ºç«‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        sc.finishConnect();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } else if (key.isReadable()) {// reading event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    SocketChannel sc = (SocketChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ByteBuffer    buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    int numRead = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int tmp = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            // read æ“ä½œæ˜¯ block çš„ï¼Œ è¯»å–åˆ°æœ«å°¾ï¼Œ è¿”å› -1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            while ((tmp = sc.read(buffer)) &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                numRead += tmp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (numRead &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            System.out.println(&quot;&gt;&gt;&gt; msg from server: &quot; + StandardCharsets.UTF_8.decode(buffer).toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            buffer = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (buffer != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            buffer.clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * tcp + nio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int                 port              = 9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        InetSocketAddress   inetSocketAddress = new InetSocketAddress(port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServerSocketChannel ssc               = ServerSocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ssc.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ssc.socket().bind(inetSocketAddress);// retrieve server socket and bind to port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // - register server socket channel with selector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //      - `selector.select()` will return directly instead of blocking if `OP_ACCEPT` occurred;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //      - OP_ACCEPT means the type of the registration; in this case, selector merely reports that a client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //          attempts a connection to the server; (Other possible options are: OP_CONNECT, which will be used by the client; OP_READ; and OP_WRITE.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Selector selector = Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ssc.register(selector, SelectionKey.OP_ACCEPT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;&gt;&gt;&gt; server listen on port: &quot; + port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outLoop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            selector.select(60 * 1000); // block, wait for events recorded on the selector; timeout: 60s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // work on selected keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (it.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SelectionKey key = it.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                it.remove();// prevent the same key coming up again</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (!key.isValid()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    continue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (key.isAcceptable()) {// event: the associated client request a connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // retrieve server socket channel from selector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ServerSocketChannel serverSocketChannel = (ServerSocketChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // create a socket channel which accepts the connection, creates a standard java socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    socketChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    System.out.println(&quot;&gt;&gt;&gt; connected to: &quot; + socketChannel.socket().getRemoteSocketAddress());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // register socket channel with selector, è¿™ä¸ª channelåªå¯¹ read æ„Ÿå…´è¶£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    socketChannel.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } else if (key.isReadable()) {// event: the server can read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    SocketChannel sc     = (SocketChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ByteBuffer    buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    int readBytes = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int tmp =  0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            while ((tmp = sc.read(buffer)) &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                readBytes += tmp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (readBytes &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            String data = StandardCharsets.UTF_8.decode(buffer).toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            System.out.println(&quot;&gt;&gt;&gt; receive from client: &quot; + data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            if (&quot;exit&quot;.equalsIgnoreCase(data)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                sc.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                selector.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                System.out.println(&quot;&gt;&gt;&gt; server closed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                break outLoop;  // æ¬åˆ°è¿™é‡Œå°±okäº†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            sc.write(StandardCharsets.UTF_8.encode(data));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            System.out.println(&quot;&gt;&gt;&gt; send to client: &quot; + data );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (buffer != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            buffer.clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //byte[] data = new byte[numRead];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //System.arraycopy(buffer, 0, data, 0, numRead);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //java.lang.String data = new java.lang.String(buffer.array());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //System.out.println(&quot;&gt;&gt;&gt; receive from client: &quot; + data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //if (&quot;exit&quot;.equalsIgnoreCase(data)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //    sc.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //    selector.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //    System.out.println(&quot;&gt;&gt;&gt; server closed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //    break outLoop;  // å­˜ç–‘ ä½¿ç”¨è¿™ç§æ–¹å¼ client å‘é€ exitï¼Œ è¿™é‡Œåé¢çš„ä»£ç ä»æ—§ä¼šæ‰§è¡Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // send msg to client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //sc.write(StandardCharsets.UTF_8.encode(data));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //System.out.println(&quot;&gt;&gt;&gt; send to client: &quot; + data );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * udp é€šä¿¡æ— éœ€å»ºç«‹è¿æ¥ï¼Œ æ‰€ä»¥æ— æ³•åŒå‘é€šä¿¡ï¼Œ å¦‚éœ€åŒå‘é€šä¿¡ï¼Œ ä¸¤ç«¯éƒ½å¿…é¡»æ˜¯ server, ä¹Ÿå°±æ˜¯ client ä¹Ÿè¦æœ‰ç›‘å¬ç«¯å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Client {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int            remotePort          = 9527;// è¿œç¨‹ server ç«¯å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int            listenPort         = 9528;// æœ¬åœ°ç›‘å¬ç«¯å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramSocket listenSocket  = new DatagramSocket(listenPort);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]         buffer        = new byte[65507];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramPacket receivePacket = new DatagramPacket(buffer, buffer.length);// æ¥æ”¶æ•°æ®æµå¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramSocket socket   = new DatagramSocket();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        InetAddress    remoteAddr   = InetAddress.getByName(&quot;localhost&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BufferedReader systemIn = new BufferedReader(new InputStreamReader(System.in));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;&gt;&gt;&gt; client listen on port : &quot; + listenPort);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String         line      = systemIn.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[]         lineBytes = line.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DatagramPacket packetToRemote    = new DatagramPacket(lineBytes, lineBytes.length, remoteAddr, remotePort);// ä¼ é€æ•°æ®æµå¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            socket.send(packetToRemote);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; send to server: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (&quot;exit&quot;.equalsIgnoreCase(line.trim())) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;&gt;&gt;&gt; Client quit!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                socket.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                listenSocket.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            listenSocket.receive(receivePacket);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String receiveResponse = new String(receivePacket.getData(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    0, receivePacket.getLength(), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; receive from server: &quot; + receiveResponse);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int            listenPort          =9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int            remotePort         =9528;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramSocket server        =new DatagramSocket(listenPort);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramSocket client        =new DatagramSocket();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        InetAddress    serverAddress =InetAddress.getByName(&quot;localhost&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]         buffer        =new byte[65507];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramPacket packet        =new DatagramPacket(buffer,buffer.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;&gt;&gt;&gt; server listen on port : &quot; + listenPort);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while(true){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            server.receive(packet);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String line=new String(packet.getData(),0,packet.getLength(), StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(&quot;exit&quot;.equalsIgnoreCase(line.trim())){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                server.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                client.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.exit(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;&gt;&gt;&gt; Message from client: &quot;+ line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                packet.setLength(buffer.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                byte[] lineBytes=line.getBytes(StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                DatagramPacket responsePacket=new DatagramPacket(lineBytes,lineBytes.length,serverAddress,remotePort);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                client.send(responsePacket);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;&gt;&gt;&gt; send to client: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread.sleep(100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * DatagramChannel è´Ÿè´£ç›‘å¬ç«¯å£andè¯»å†™; ByteBuffer æ•°æ®ä¼ è¾“</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Client {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int listenPort=9528;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int remotePort=9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramChannel receiveChannel=DatagramChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        receiveChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        receiveChannel.socket().bind(new InetSocketAddress(listenPort));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Selector selector= Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        receiveChannel.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramChannel sendChannel =DatagramChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sendChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sendChannel.connect(new InetSocketAddress(&quot;127.0.0.1&quot;,remotePort));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BufferedReader systemIn =new BufferedReader(new InputStreamReader(System.in));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while(true){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String command=systemIn.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendChannel.write(Charset.forName(&quot;UTF-8&quot;).encode(command));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(&quot;quit&quot;.equalsIgnoreCase(command.trim())){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                systemIn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendChannel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                selector.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;Client quit!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.exit(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int nKeys=selector.select(1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(nKeys&gt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for (SelectionKey key : selector.selectedKeys()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if(key.isReadable()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ByteBuffer buffer= ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        DatagramChannel dc=(DatagramChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        dc.receive(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        System.out.println(Charset.forName(&quot;UTF-8&quot;).decode(buffer).toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                selector.selectedKeys().clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int rport=9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int sport=9528;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramChannel sendChannel=DatagramChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sendChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SocketAddress target =new InetSocketAddress(&quot;127.0.0.1&quot;,sport);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sendChannel.connect(target);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramChannel receiveChannel =DatagramChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DatagramSocket  serverSocket   =receiveChannel.socket();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        serverSocket.bind(new InetSocketAddress(rport));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;Data receive listen on port: &quot;+rport);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        receiveChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Selector selector= Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        receiveChannel.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while(true){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int nKeys=selector.select(1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(nKeys&gt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for (SelectionKey key : selector.selectedKeys()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if(key.isReadable()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ByteBuffer buffer= ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        DatagramChannel dc=(DatagramChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        dc.receive(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        String message= Charset.forName(&quot;UTF-8&quot;).decode(buffer).toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        System.out.println(&quot;Message from client: &quot;+ message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if(&quot;quit&quot;.equalsIgnoreCase(message.trim())){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            dc.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            selector.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            sendChannel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            System.out.println(&quot;Server has been shutdown!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            System.exit(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        String outMessage=&quot;Server responseï¼š&quot;+message;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        sendChannel.write(Charset.forName(&quot;UTF-8&quot;).encode(outMessage));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                selector.selectedKeys().clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="83-é˜»å¡-io">8.3. é˜»å¡ io<a href="#83-é˜»å¡-io" class="hash-link" aria-label="Direct link to 8.3. é˜»å¡ io" title="Direct link to 8.3. é˜»å¡ io">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="831-ä»€ä¹ˆæ˜¯é˜»å¡-io">8.3.1. ä»€ä¹ˆæ˜¯é˜»å¡ io<a href="#831-ä»€ä¹ˆæ˜¯é˜»å¡-io" class="hash-link" aria-label="Direct link to 8.3.1. ä»€ä¹ˆæ˜¯é˜»å¡ io" title="Direct link to 8.3.1. ä»€ä¹ˆæ˜¯é˜»å¡ io">â€‹</a></h3><p>IO : æŒ‡çš„å°±æ˜¯åº”ç”¨ç¨‹åºè¯»å…¥/å†™å‡ºæ•°æ®çš„è¿‡ç¨‹ï¼Œå’Œç¨‹åºç­‰å¾…è¯»å…¥/å†™å‡ºæ•°æ®çš„è¿‡ç¨‹ã€‚ä¸€æ—¦æ‹¿åˆ°æ•°æ®åå°±å˜æˆäº†æ•°æ®æ“ä½œäº†ï¼Œå°±ä¸æ˜¯ IO äº†</p><p>é˜»å¡io: æ‹¿ç½‘ç»œ IO æ¥è¯´ï¼Œç­‰å¾…çš„è¿‡ç¨‹å°±æ˜¯æ•°æ®ä»ç½‘ç»œåˆ°ç½‘å¡å†åˆ°å†…æ ¸ç©ºé—´ã€‚è¯»å†™çš„è¿‡ç¨‹å°±æ˜¯å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„ç›¸äº’æ‹·è´. åº”ç”¨ç¨‹åºéƒ½æ˜¯è¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´çš„ï¼Œæ‰€ä»¥å®ƒä»¬èƒ½æ“ä½œçš„æ•°æ®ä¹Ÿéƒ½åœ¨ç”¨æˆ·ç©ºé—´ã€‚åªè¦æ•°æ®æ²¡æœ‰åˆ°è¾¾ç”¨æˆ·ç©ºé—´ï¼Œç”¨æˆ·çº¿ç¨‹å°±æ“ä½œä¸äº†. å¦‚æœæ­¤æ—¶ç”¨æˆ·çº¿ç¨‹å·²ç»å‚ä¸ï¼Œé‚£å®ƒä¸€å®šä¼šè¢«é˜»å¡åœ¨ IO ä¸Šã€‚è¿™å°±æ˜¯å¸¸è¯´çš„é˜»å¡ IOã€‚ç”¨æˆ·çº¿ç¨‹è¢«é˜»å¡åœ¨ç­‰å¾…æ•°æ®ä¸Šæˆ–æ‹·è´æ•°æ®ä¸Š.</p><p>éé˜»å¡ IO : å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¸å‚ä¸ä»¥ä¸Šä¸¤ä¸ªè¿‡ç¨‹(æ•°æ®ä¼ è¾“, æ•°æ®æ‹·è´)ï¼Œå³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œæ‰å»é€šçŸ¥ç”¨æˆ·çº¿ç¨‹ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®äº†</p><p>é˜»å¡io å’Œéé˜»å¡ioåŒºåˆ«å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¼šä¸ä¼šé˜»å¡åœ¨ç­‰å¾…æ•°æ®æˆ–è€…æ•°æ®æ‹·è´ä¸Š</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="832-io-ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ">8.3.2. io ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ<a href="#832-io-ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ" class="hash-link" aria-label="Direct link to 8.3.2. io ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ" title="Direct link to 8.3.2. io ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ">â€‹</a></h3><p>åŸºäºå­—èŠ‚æ“ä½œçš„ I/O æ¥å£ï¼šInputStream å’Œ OutputStream</p><p>åŸºäºå­—ç¬¦æ“ä½œçš„ I/O æ¥å£ï¼šWriter å’Œ Reader</p><p>å­—èŠ‚å­—ç¬¦è½¬æ¢æµ</p><p>åŸºäºç£ç›˜æ“ä½œçš„ I/O æ¥å£ï¼šFile</p><p>åŸºäºç½‘ç»œæ“ä½œçš„ I/O æ¥å£ï¼šSocket</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. å­—èŠ‚æµ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.1 å­—èŠ‚è¯»å–ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InputStream æ‰€æœ‰è¾“å…¥å­—èŠ‚æµçš„åŸºç±»  æŠ½è±¡ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileInputStream è¯»å–æ–‡ä»¶æ•°æ®çš„è¾“å…¥å­—èŠ‚æµ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BufferedInputStream  ç¼“å†²è¾“å…¥å­—ç¬¦æµ       è¯¥ç±»å‡ºç°çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜è¯»å–æ–‡ä»¶ æ•°æ®çš„æ•ˆç‡ã€‚ è¿™ä¸ªç±»å…¶å®åªä¸è¿‡æ˜¯åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª8kbçš„å­—èŠ‚æ•°ç»„è€Œå·²ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.2 å­—èŠ‚è¾“å‡ºï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OutputStream æ‰€æœ‰è¾“å‡ºå­—èŠ‚æµçš„åŸºç±»ã€‚  æŠ½è±¡ç±»ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileOutputStream å‘æ–‡ä»¶è¾“å‡ºæ•°æ®çš„è¾“å‡ºå­—èŠ‚æµ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BufferedOutputStream ç¼“å†²è¾“å‡ºå­—èŠ‚æµ   è¯¥ç±»å‡ºç°çš„ç›®çš„ä¹Ÿæ˜¯ä¸ºäº†æé«˜å‘æ–‡ä»¶å†™æ•°æ®çš„æ•ˆç‡ã€‚ è¿™ä¸ªç±»çš„ä¹Ÿåªä¸è¿‡æ˜¯åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª8kbçš„å­—èŠ‚æ•°ç»„è€Œå·²ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. å­—ç¬¦æµ : å­—ç¬¦æµ = å­—èŠ‚æµ + ç¼–ç ï¼ˆè§£ç ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.1 å­—ç¬¦è¯»å–:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reader æ‰€æœ‰è¾“å…¥å­—ç¬¦æµçš„åŸºç±»ã€‚ æŠ½è±¡ç±»ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileReader è¯»å–æ–‡ä»¶æ•°æ®çš„è¾“å…¥å­—ç¬¦æµã€‚    å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª1024å­—ç¬¦çš„å­—ç¬¦æ•°ç»„, è°ƒç”¨flushæˆ–è€…æ˜¯closeæ–¹æ³•æˆ–è€…æ˜¯å¡«æ»¡äº†å†…éƒ¨çš„å­—ç¬¦æ•°ç»„æ‰ä¼šçœŸæ­£å†™æ•°æ®åˆ°ç¡¬ç›˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BufferedReader ç¼“å†²è¾“å…¥å­—ç¬¦æµ           è¯¥ç±»å‡ºç°çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜è¯»å–æ–‡ä»¶æ•°æ®çš„æ•ˆç‡ä¸æ‹“å±•FileReaderçš„(readLine)åŠŸèƒ½ã€‚ è¿™ä¸ªç±»çš„ä¹Ÿåªä¸è¿‡æ˜¯åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª8kbçš„å­—ç¬¦æ•°ç»„è€Œå·²ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.2 å­—ç¬¦è¾“å‡º:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Writer æ‰€æœ‰è¾“å‡ºå­—ç¬¦æµçš„åŸºç±»ã€‚  æŠ½è±¡ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileWriter å‘æ–‡ä»¶è¾“å‡ºæ•°æ®çš„è¾“å‡ºå­—ç¬¦æµ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BufferedWriter ç¼“å†²è¾“å‡ºå­—ç¬¦æµ , æ‰‹åŠ¨ flush, æ‰‹åŠ¨ newLine()       è¯¥ç±»å‡ºç°çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜å†™æ–‡ä»¶æ•°æ®çš„æ•ˆç‡ä¸æ‹“å±•FileWriterçš„(newLine)åŠŸèƒ½.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PrintWriter æ‰“å°è¾“å‡ºæµ, å­—ç¬¦å­—èŠ‚å‡å¯, å¯è®¾ç½®è‡ªåŠ¨flush, è‡ªåŠ¨æ¢è¡Œ , å¯ä»£æ›¿ bufferwriter; (https://blog.csdn.net/lyhkmm/article/details/78260207)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. è½¬æ¢æµ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InputStreamReader   è¾“å…¥å­—èŠ‚æµçš„è½¬æ¢æµ ; ä½œç”¨ï¼šInputStream--------------------&gt; Reader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OutputStreamWriter  è¾“å‡ºå­—èŠ‚æµçš„è½¬æ¢æµ ; ä½œç”¨ï¼šOutputStream --------------------&gt; Writer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">è½¬æ¢æµçš„ä½œç”¨ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - å¯ä»¥æŠŠå­—èŠ‚æµè½¬æ¢æˆå­—ç¬¦æµä½¿ç”¨ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - FileReaderä¸FileWriteréƒ½æ˜¯å›ºå®šæ˜¯gbkç è¡¨è¿›è¡Œè¯»å†™æ•°æ®çš„ï¼Œè€Œè½¬æ¢æµå¯ä»¥æŒ‡å®šç è¡¨è¿›è¡Œè¯»å†™æ–‡ä»¶çš„æ•°æ®ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. File</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">File å¹¶ä¸ä»£è¡¨ä¸€ä¸ªçœŸå®å­˜åœ¨çš„æ–‡ä»¶å¯¹è±¡, è€Œä¸”å°±ç®—å­˜åœ¨è¿˜å¯èƒ½å¼æ–‡ä»¶orç›®å½•;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ä¸ºä½•è¦è¿™æ ·è®¾è®¡ï¼Ÿå› ä¸ºå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè¿™ä¸ªæ–‡ä»¶æ˜¯å¦çœŸçš„å­˜åœ¨ï¼Œè€Œæ˜¯å…³å¿ƒè¿™ä¸ªæ–‡ä»¶åˆ°åº•å¦‚ä½•æ“ä½œã€‚ä¾‹å¦‚æˆ‘ä»¬æ‰‹æœºé‡Œé€šå¸¸å­˜äº†å‡ ç™¾ä¸ªæœ‹å‹çš„ç”µè¯å·ç ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸å…³å¿ƒçš„æ˜¯æˆ‘æœ‰æ²¡æœ‰è¿™ä¸ªæœ‹å‹çš„ç”µè¯å·ç ï¼Œæˆ–è€…è¿™ä¸ªç”µè¯å·ç æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯è¿™ä¸ªç”µè¯å·ç åˆ°åº•èƒ½ä¸èƒ½æ‰“é€šï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯æ—¶æ—¶åˆ»åˆ»éƒ½å»æ£€æŸ¥ï¼Œè€Œåªæœ‰åœ¨çœŸæ­£è¦ç»™ä»–æ‰“ç”µè¯æ—¶æ‰ä¼šçœ‹è¿™ä¸ªç”µè¯èƒ½ä¸èƒ½ç”¨ã€‚ä¹Ÿå°±æ˜¯ä½¿ç”¨è¿™ä¸ªç”µè¯è®°å½•è¦æ¯”æ‰“è¿™ä¸ªç”µè¯çš„æ¬¡æ•°å¤šå¾ˆå¤š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Properties(é…ç½®æ–‡ä»¶ç±»)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ä½“ç³»ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -------| Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ------------| HashTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ----------------| Properties é…ç½®æ–‡ä»¶ç±»ã€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> store() ç”¨äºç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> load() åŠ è½½ä¸€ä¸ªé…ç½®æ–‡ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attention ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - å¦‚æœé…ç½®æ–‡ä»¶å­˜åœ¨ç€ä¸­æ–‡ï¼Œé‚£ä¹ˆç”Ÿæˆé…ç½®æ–‡ä»¶çš„æ—¶å€™è¦ä½¿ç”¨å­—ç¬¦æµï¼Œå¦åˆ™ä¼šå‡ºç°ä¹±ç ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - å¦‚æœéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œåº”è¯¥å…ˆåŠ è½½åŸæœ¬é…ç½®æ–‡ä»¶ï¼Œç„¶åå†ç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="833-paths-å’Œ-files-ç›¸å…³-api">8.3.3. Paths å’Œ Files ç›¸å…³ api<a href="#833-paths-å’Œ-files-ç›¸å…³-api" class="hash-link" aria-label="Direct link to 8.3.3. Paths å’Œ Files ç›¸å…³ api" title="Direct link to 8.3.3. Paths å’Œ Files ç›¸å…³ api">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8331-paths-çš„è·å–è½¬åŒ–">8.3.3.1. Paths çš„è·å–è½¬åŒ–<a href="#8331-paths-çš„è·å–è½¬åŒ–" class="hash-link" aria-label="Direct link to 8.3.3.1. Paths çš„è·å–è½¬åŒ–" title="Direct link to 8.3.3.1. Paths çš„è·å–è½¬åŒ–">â€‹</a></h4><p>jdk 1.7 æä¾›</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Paths.get(&quot;C:/&quot;, &quot;Xmp&quot;); å’Œ Paths.get(&quot;C:/Xmp&quot;); ç­‰åŒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path pathRoot = Paths.get(&quot;/&quot;);// è¡¨ç¤ºç£ç›˜æ ¹è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(pathRoot.toAbsolutePath());// D:\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FileSystems.getDefault().getPath(&quot;C:/&quot;, &quot;aa.log&quot;) // ä»æ“ä½œç³»ç»Ÿè·å–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paths.get(URI.create(&quot;file:///C:/Xmp/dd&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">new File(&quot;C:/aa.log&quot;).toPath()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¡¨ç¤ºå½“å‰é¡¹ç›®æ ¹è·¯å¾„, ç­‰åŒ System.getProperty(&quot;user.dir&quot;), ç­‰åŒ new File(&quot;&quot;).getAbsoblutePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ³¨æ„: system.getProperty(&quot;user.home&quot;)  è¡¨ç¤ºæ“ä½œç³»ç»Ÿ ç”¨æˆ·å®¶ç›®å½•, è€Œä¸æ˜¯å½“å‰é¡¹ç›®ç›®å½•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path pathA  = Paths.get(&quot;.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path pathB = pathA.toAbsolutePath();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(pathB);// D:\repo\repo_github\shared_already\xiaoyu-recipes\samples\java8-demo\.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path path1 = Paths.get(this.getClass().getResource(&quot;.&quot;).toURI());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(path1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//D:\repo\repo_github\shared_already\starter-demo\target\classes\io\github\xiaoyureed\starterdemo\util</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path path2 = Paths.get(this.getClass().getClassLoader().getResource(&quot;.&quot;).toURI());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(path2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//D:\repo\repo_github\shared_already\starter-demo\target\classes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è·å– class path æ¨èè¿™ç§æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path path3 = Paths.get(Thread.currentThread().getContextClassLoader().getResource(&quot;.&quot;).toURI());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(path3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//D:\repo\repo_github\shared_already\starter-demo\target\classes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8332-é€šè¿‡-files-paths-è¯»å–å†™å…¥">8.3.3.2. é€šè¿‡ Files Paths è¯»å–å†™å…¥<a href="#8332-é€šè¿‡-files-paths-è¯»å–å†™å…¥" class="hash-link" aria-label="Direct link to 8.3.3.2. é€šè¿‡ Files Paths è¯»å–å†™å…¥" title="Direct link to 8.3.3.2. é€šè¿‡ Files Paths è¯»å–å†™å…¥">â€‹</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private Path createFile(String dir, String file) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Path dirPath = Paths.get(dir);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (Files.notExists(dirPath)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Files.createDirectories(dirPath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Path filePath = Paths.get(dir, file);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (Files.notExists(filePath)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Files.createFile(filePath);// cannot create directory, only for file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return filePath;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * create a file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * write sth to the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * read from the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testPaths_2() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Set&lt;PosixFilePermission&gt; perms = PosixFilePermissions.fromString(&quot;rw-rw-rw-&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //FileAttribute&lt;Set&lt;PosixFilePermission&gt;&gt; attrs = PosixFilePermissions.asFileAttribute(perms);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Path file = this.createFile(&quot;d:/_test&quot;, &quot;aa.log&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ä¹Ÿèƒ½ç›´æ¥ files.newbufferreader/writer(Paths.get(&quot;xxx.json&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // reader.lines().collect(toList)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try (BufferedWriter bufferedWriter = Files.newBufferedWriter(file, StandardCharsets.UTF_8)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bufferedWriter.write(&quot;test writing file&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bufferedWriter.flush();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try (BufferedReader bufferedReader = Files.newBufferedReader(file, StandardCharsets.UTF_8);) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (;;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String s = bufferedReader.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (s == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8333-éå†æ–‡ä»¶å¤¹">8.3.3.3. éå†æ–‡ä»¶å¤¹<a href="#8333-éå†æ–‡ä»¶å¤¹" class="hash-link" aria-label="Direct link to 8.3.3.3. éå†æ–‡ä»¶å¤¹" title="Direct link to 8.3.3.3. éå†æ–‡ä»¶å¤¹">â€‹</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ²¡æœ‰é€’å½’çš„éå†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * åªä¼šéå†ç¬¬ä¸€å±‚ç›®å½•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testTraverse() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path path = Paths.get(&quot;d:/_learn/&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DirectoryStream&lt;Path&gt; dirStream = Files.newDirectoryStream(path);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!Files.isDirectory(path)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;path is not a dir, path = &quot; + path.toAbsolutePath().toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dirStream.forEach(p -&gt; System.out.println(p.getFileName()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ç­‰ä»·</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testTraverse_1() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path path = Paths.get(&quot;d:/_learn&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Stream&lt;Path&gt; dirStream = Files.list(path);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator&lt;Path&gt; it = dirStream.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (it.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Path next = it.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(next.getFileName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * é€’å½’éå†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testTraverse_2() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path path = Paths.get(&quot;d:/_learn&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArrayList&lt;Path&gt; result = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Files.walkFileTree(path, new SimpleFileVisitor&lt;Path&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (file.toString().endsWith(&quot;.php&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    result.add(file);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return super.visitFile(file, attrs);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result.forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * é€’å½’éå†, ç­‰ä»·ä¸Šé¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testTraverse_3() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path path = Paths.get(&quot;d:/_learn&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Stream&lt;Path&gt; stream = Files.walk(path);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;Path&gt; result = stream.map(p -&gt; p.toString().endsWith(&quot;.php&quot;) ? p : null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .distinct()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .collect(Collectors.toList());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result.forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8334-é€šè¿‡-files-è·å–æ–‡ä»¶å±æ€§">8.3.3.4. é€šè¿‡ files è·å–æ–‡ä»¶å±æ€§<a href="#8334-é€šè¿‡-files-è·å–æ–‡ä»¶å±æ€§" class="hash-link" aria-label="Direct link to 8.3.3.4. é€šè¿‡ files è·å–æ–‡ä»¶å±æ€§" title="Direct link to 8.3.3.4. é€šè¿‡ files è·å–æ–‡ä»¶å±æ€§">â€‹</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ–‡ä»¶å±æ€§</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testFileProperty() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path zip = Paths.get(&quot;d:/_test/aa.log&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Files.getLastModifiedTime(zip));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Files.size(zip));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Files.isSymbolicLink(zip));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Files.isDirectory(zip));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Files.readAttributes(zip, &quot;*&quot;));// map, æ‰€æœ‰å±æ€§</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 2019-05-22T14:34:24.320402Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // {lastAccessTime=2019-05-22T14:21:24.821534Z, lastModifiedTime=2019-05-22T14:34:24.320402Z, size=17, creationTime=2019-05-22T14:21:24.821534Z, isSymbolicLink=false, isRegularFile=true, fileKey=null, isOther=false, isDirectory=false}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="834-bio-tcp-å®ç°é€šä¿¡">8.3.4. bio tcp å®ç°é€šä¿¡<a href="#834-bio-tcp-å®ç°é€šä¿¡" class="hash-link" aria-label="Direct link to 8.3.4. bio tcp å®ç°é€šä¿¡" title="Direct link to 8.3.4. bio tcp å®ç°é€šä¿¡">â€‹</a></h3><p>(æ›´å¤šè§è¿™é‡Œ distributed-System#æ€ä¹ˆå®ç°å­ç³»ç»Ÿé—´çš„é€šä¿¡)</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ç³»ç»Ÿé—´è¿›è¡Œé€šä¿¡ï¼Œ éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * - æ•°æ®ä¼ è¾“.  - å€ŸåŠ© tcp/ip, æˆ– udp/ip åè®®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * - æ•°æ®å¤„ç†ï¼ˆè¯»å–or å†™å…¥ï¼‰ - åŒæ­¥io æˆ–è€… å¼‚æ­¥io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *      - åŒæ­¥ioåˆ†ä¸º bio, nio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          bio - å½“å‘èµ·ioæ“ä½œ, çº¿ç¨‹é—´ä¸ºé˜»å¡å…³ç³», å½“å‰ thread åªæœ‰å°†æµè¯»å–/å†™å…¥å®Œæ¯•æ‰ä¼šé‡Šæ”¾èµ„æºç»™å…¶ä»–ç­‰å¾…çš„ thread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          nio - åŸºäº&quot;äº‹ä»¶é©±åŠ¨&quot; é€šè¿‡ Reactoræ¨¡å¼ å®ç°   thread é—´éé˜»å¡, å½“ socket æœ‰ stream å¯è¯» æˆ– æœ‰ stream å¾…è¢« socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          å†™å…¥æ—¶, å‘å‡ºäº‹ä»¶(å¦‚ è¿æ¥å»ºç«‹äº‹ä»¶, æµè¯»å–äº‹ä»¶, æµå†™å…¥äº‹ä»¶), ç”±æ“ä½œç³»ç»Ÿé€šçŸ¥ appæ¥å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *      - å¼‚æ­¥io åˆ†ä¸º aio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          aio - åŒæ ·åŸºäºäº‹ä»¶é©±åŠ¨, é€šè¿‡ Proactoræ¨¡å¼å®ç°;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          å’Œnioå¯¹æ¯”, 1. ç®€åŒ–ç¼–ç¨‹, ioæ“ä½œç”±æ“ä½œç³»ç»Ÿå®Œæˆ, appåªè¦è°ƒç”¨apiå³å¯; 2. çœç•¥äº† nioä¸­éœ€è¦éå† äº‹ä»¶é€šçŸ¥é˜Ÿåˆ—(Selector)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *          çš„æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * è¿™æ ·ç»„åˆçš„è¯, æœ‰å››ç§é€šä¿¡æ–¹å¼: tcp/ip + bio, tcp/ip  + nio, udp/ip + bio, udp/ip + nio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * *************************************************************************************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ä¸‹é¢æ˜¯ bio + tcp æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Client {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private String url = &quot;127.0.0.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private int port = 9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Socket socket;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private BufferedReader readerOnServer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private PrintWriter printerOnServer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private BufferedReader readerOnCli;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void init(String url, int port) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socket = new Socket(url, port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnServer = new BufferedReader(new InputStreamReader(socket.getInputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printerOnServer = new PrintWriter(socket.getOutputStream(), true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnCli   = new BufferedReader(new InputStreamReader(System.in));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void start() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String line = readerOnCli.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (testExit(line)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; send to server: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // send to server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            printerOnServer.println(line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // receive from server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String respLine = readerOnServer.readLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; receive from server: &quot; + respLine);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private boolean testExit(String test) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (StringUtils.isBlank(test) || &quot;exit&quot;.equalsIgnoreCase(test)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            printerOnServer.write(&quot;exit&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; client exit.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void close() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printerOnServer.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnCli.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        readerOnServer.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socket.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Client client = new Client();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        client.init(&quot;127.0.0.1&quot;, 9527);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        client.start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * è¿™ä¸ª server åªæ”¯æŒ å•ä¸ª client è¿æ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å¤šä¸ª client è¿æ¥ serveræ€ä¹ˆåŠ? é¦–å…ˆè¦ pass æ‰ &quot;åœ¨ server ä¸­ åˆ›å»ºå¤šä¸ª socket&quot;çš„æƒ³æ³•, å› ä¸º ç”Ÿæˆ socket æ˜¯éå¸¸é‡çš„æ“ä½œ, å </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ç”¨serverèµ„æºéå¸¸å¤š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * é€šå¸¸ç”¨é‡‡ç”¨ &quot;è¿æ¥æ± &quot;, å¥½å¤„æ˜¯ ğŸ¶ èƒ½å¤Ÿé™åˆ¶åˆ›å»ºçš„ socketä¸ªæ•°; ğŸ¶ é¿å…é‡å¤åˆ›å»º socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ä½†æ˜¯è¿™ç§æ–¹å¼è¿˜æ˜¯æœ‰é—®é¢˜: è¿æ¥æ± ä¸­ socket æ€»æ˜¯æœ‰é™çš„æ€»æœ‰ä¸å¤Ÿç”¨çš„æ—¶å€™; server éœ€è¦è®¾ç½®è¶…æ—¶æ—¶é—´, é˜²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * æ­¢ server è¿å¸¦ clientæŒ‚æ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å¦‚æœè¦æ”¯æŒå¤šä¸ª client è¿æ¥ï¼Œ å¯é‡‡ç”¨ çº¿ç¨‹æ± ï¼Œ æ¯ä¸ª socket æ–°å¼€ä¸€ä¸ª threadã€‚ è¿™ä¹ˆåšæœ‰ç¼ºç‚¹ï¼š æ— è®ºæ˜¯å¦æ˜¯æœ‰æ•ˆè¯·æ±‚ï¼Œ server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * éƒ½è¦è€—è´¹ä¸€ä¸ª thread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å‘³äº†é¿å… è¿‡å¤šçš„ thread è€—å°½ serverçš„èµ„æºï¼Œ çº¿ç¨‹æ± å¿…é¡»æ˜¯é™å®šå¤§å°çš„ã€‚ &lt;=&gt; é‡‡ç”¨ bio æ–¹å¼çš„ server æ”¯æ’‘çš„è¿æ¥æ•°æ˜¯æœ‰é™çš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @since 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private ServerSocket serverSocket;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private BufferedReader readerFromClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //private PrintWriter writerToClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //public void initBlock(int port) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    this.serverSocket = new ServerSocket(port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    this.readerFromClient = new BufferedReader(new InputStreamReader(serverSocket.accept().getInputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException, InterruptedException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int port = 9527;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServerSocket socketServer = new ServerSocket(port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketServer.setSoTimeout(60 * 1000); // unit : milliseconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;&gt;&gt;&gt; server listen on port: &quot; + port);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Socket socketClient = socketServer.accept(); // start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BufferedReader readerFromClient = new BufferedReader(new InputStreamReader(socketClient.getInputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //BufferedWriter writerToClient   = new BufferedWriter(new OutputStreamWriter(socketClient.getOutputStream()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PrintWriter writerToClient = new PrintWriter(socketClient.getOutputStream(), true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String line = readerFromClient.readLine(); // start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (StringUtils.isBlank(line)) {// read nothing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread.sleep(100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                continue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (&quot;exit&quot;.equalsIgnoreCase(line)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                readerFromClient.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                writerToClient.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                socketServer.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;&gt;&gt;&gt; server exit&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; msg from client: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            writerToClient.println(line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;&gt;&gt;&gt; msg to client: &quot; + line);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Thread.sleep(100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.exit(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="84-éé˜»å¡-io">8.4. éé˜»å¡ io<a href="#84-éé˜»å¡-io" class="hash-link" aria-label="Direct link to 8.4. éé˜»å¡ io" title="Direct link to 8.4. éé˜»å¡ io">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="841-ä»€ä¹ˆæ˜¯éé˜»å¡-io">8.4.1. ä»€ä¹ˆæ˜¯éé˜»å¡ io<a href="#841-ä»€ä¹ˆæ˜¯éé˜»å¡-io" class="hash-link" aria-label="Direct link to 8.4.1. ä»€ä¹ˆæ˜¯éé˜»å¡ io" title="Direct link to 8.4.1. ä»€ä¹ˆæ˜¯éé˜»å¡ io">â€‹</a></h3><p>ç”¨æˆ·çº¿ç¨‹æ²¡æœ‰å› ä¸º IO çš„äº‹æƒ…å‡ºç°é˜»å¡ï¼Œè¿™å°±æ˜¯å¸¸è¯´çš„éé˜»å¡ IO, å³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œæ‰å»é€šçŸ¥ç”¨æˆ·çº¿ç¨‹ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®äº†ã€‚</p><p>ä¼ ç»Ÿ io(block io) ä¸ç®¡æ˜¯ç£ç›˜ I/O è¿˜æ˜¯ç½‘ç»œ I/Oï¼Œæ•°æ®åœ¨å†™å…¥ OutputStream æˆ–è€…ä» InputStream è¯»å–æ—¶ç”¨æˆ·çº¿ç¨‹éƒ½æœ‰å¯èƒ½ä¼šé˜»å¡, ä¸€æ—¦æœ‰çº¿ç¨‹é˜»å¡å°†ä¼šå¤±å» CPU çš„ä½¿ç”¨æƒ</p><p>nio ä½¿å¾— server ä½¿ç”¨ ä¸€ä¸ª thread å¯ä»¥å¤„ç†å¤šä¸ª client çš„è¯·æ±‚</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="842-åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡">8.4.2. åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡<a href="#842-åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡" class="hash-link" aria-label="Direct link to 8.4.2. åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡" title="Direct link to 8.4.2. åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8421-åŒæ­¥ä¸å¼‚æ­¥">8.4.2.1. åŒæ­¥ä¸å¼‚æ­¥<a href="#8421-åŒæ­¥ä¸å¼‚æ­¥" class="hash-link" aria-label="Direct link to 8.4.2.1. åŒæ­¥ä¸å¼‚æ­¥" title="Direct link to 8.4.2.1. åŒæ­¥ä¸å¼‚æ­¥">â€‹</a></h4><p>å½¢å®¹å¤šä¸ªäº‹ç‰©ä¹‹é—´çš„è¿è¡Œå…³ç³», å¯ä»¥å½¢å®¹ æ–¹æ³•, çº¿ç¨‹, cpu æŒ‡ä»¤...</p><p>åŒæ­¥å°±æ˜¯å¤šä¸ªäº‹ç‰©ä¸èƒ½åŒæ—¶å¼€å·¥ï¼Œå¼‚æ­¥å°±æ˜¯å¤šä¸ªäº‹ç‰©å¯ä»¥åŒæ—¶å¼€å·¥</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8422-é˜»å¡ä¸éé˜»å¡">8.4.2.2. é˜»å¡ä¸éé˜»å¡<a href="#8422-é˜»å¡ä¸éé˜»å¡" class="hash-link" aria-label="Direct link to 8.4.2.2. é˜»å¡ä¸éé˜»å¡" title="Direct link to 8.4.2.2. é˜»å¡ä¸éé˜»å¡">â€‹</a></h4><p>å½¢å®¹ä¸€ç§äº‹ç‰©çŠ¶æ€</p><p>çº¿ç¨‹é˜»å¡äº†, è¡¨æ˜çº¿ç¨‹è¢«æŒ‚èµ·, ä¸èƒ½åŠ¨äº†, è®©å‡ºäº† CPU</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8423-å››ç§ç»„åˆ">8.4.2.3. å››ç§ç»„åˆ<a href="#8423-å››ç§ç»„åˆ" class="hash-link" aria-label="Direct link to 8.4.2.3. å››ç§ç»„åˆ" title="Direct link to 8.4.2.3. å››ç§ç»„åˆ">â€‹</a></h4><ul><li><p>åŒæ­¥é˜»å¡, ç›¸å½“äºä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…</p><p>ä¾‹å¦‚ java bio, I/O æ€§èƒ½ä¸€èˆ¬å¾ˆå·®ï¼ŒCPU å¤§éƒ¨åˆ†åœ¨ç©ºé—²çŠ¶æ€ã€‚</p></li><li><p>åŒæ­¥éé˜»å¡, ç›¸å½“äºä¸€ä¸ªçº¿ç¨‹åœ¨æ­£å¸¸è¿è¡Œ</p><p>java nio</p></li><li><p>å¼‚æ­¥éé˜»å¡ - ç”¨æˆ·çº¿ç¨‹çš„ç»§ç»­æ‰§è¡Œï¼Œå’Œæ“ä½œç³»ç»Ÿå‡†å¤‡ IO æ•°æ®çš„è¿‡ç¨‹æ˜¯åŒæ—¶è¿›è¡Œçš„ï¼Œå› æ­¤æ‰å«åšå¼‚æ­¥ IO</p><p>java aio</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="85-å¤šè·¯å¤ç”¨-io-å³-java-nio">8.5. å¤šè·¯å¤ç”¨ IO å³ java nio<a href="#85-å¤šè·¯å¤ç”¨-io-å³-java-nio" class="hash-link" aria-label="Direct link to 8.5. å¤šè·¯å¤ç”¨ IO å³ java nio" title="Direct link to 8.5. å¤šè·¯å¤ç”¨ IO å³ java nio">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="851-è§£é‡Šå¤šè·¯å¤ç”¨">8.5.1. è§£é‡Šå¤šè·¯å¤ç”¨<a href="#851-è§£é‡Šå¤šè·¯å¤ç”¨" class="hash-link" aria-label="Direct link to 8.5.1. è§£é‡Šå¤šè·¯å¤ç”¨" title="Direct link to 8.5.1. è§£é‡Šå¤šè·¯å¤ç”¨">â€‹</a></h3><p>å¤šç§æ•°æ®ä¿¡å·æ··åˆåœ¨ä¸€èµ·, é€šè¿‡ä¸€æ¡é€šè·¯ä¼ è¾“, æœ€ç»ˆé€šè¿‡å„è‡ªç‰¹å®šçš„å¤„ç†å™¨å¤„ç†</p><p>æ¯”å¦‚ ç½‘ç»œ io, æœåŠ¡å™¨ç«¯çš„å·¥ä½œçº¿ç¨‹ä¸ä¼šæŠŠæ—¶é—´èŠ±åœ¨â€œç­‰å¾…æ•°æ®â€ä¸Š, ä½†æ˜¯ä¼šèŠ±åœ¨ç­‰å¾…â€œè¯»å–æ•°æ®â€è¿™ä¸ªè¿‡ç¨‹ä¸Š</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="852-nio-å’Œ-io-åŒºåˆ«">8.5.2. nio å’Œ io åŒºåˆ«<a href="#852-nio-å’Œ-io-åŒºåˆ«" class="hash-link" aria-label="Direct link to 8.5.2. nio å’Œ io åŒºåˆ«" title="Direct link to 8.5.2. nio å’Œ io åŒºåˆ«">â€‹</a></h3><p>1)IO æ˜¯é¢å‘æµçš„ï¼ŒNIO æ˜¯é¢å‘ç¼“å†²åŒºçš„ï¼›</p><p>2)IO æµæ˜¯é˜»å¡çš„ï¼ŒNIO æµæ˜¯ä¸é˜»å¡çš„;</p><p>3)NIO æœ‰é€‰æ‹©å™¨ï¼Œè€Œ IO æ²¡æœ‰ã€‚</p><p>é˜»å¡io: æ‹¿ç½‘ç»œ IO æ¥è¯´ï¼Œç­‰å¾…çš„è¿‡ç¨‹å°±æ˜¯æ•°æ®ä»ç½‘ç»œåˆ°ç½‘å¡å†åˆ°å†…æ ¸ç©ºé—´ã€‚è¯»å†™çš„è¿‡ç¨‹å°±æ˜¯å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„ç›¸äº’æ‹·è´. åº”ç”¨ç¨‹åºéƒ½æ˜¯è¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´çš„ï¼Œæ‰€ä»¥å®ƒä»¬èƒ½æ“ä½œçš„æ•°æ®ä¹Ÿéƒ½åœ¨ç”¨æˆ·ç©ºé—´ã€‚åªè¦æ•°æ®æ²¡æœ‰åˆ°è¾¾ç”¨æˆ·ç©ºé—´ï¼Œç”¨æˆ·çº¿ç¨‹å°±æ“ä½œä¸äº†. å¦‚æœæ­¤æ—¶ç”¨æˆ·çº¿ç¨‹å·²ç»å‚ä¸ï¼Œé‚£å®ƒä¸€å®šä¼šè¢«é˜»å¡åœ¨ IO ä¸Šã€‚è¿™å°±æ˜¯å¸¸è¯´çš„é˜»å¡ IOã€‚ç”¨æˆ·çº¿ç¨‹è¢«é˜»å¡åœ¨ç­‰å¾…æ•°æ®ä¸Šæˆ–æ‹·è´æ•°æ®ä¸Š.</p><p>éé˜»å¡ IO : å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¸å‚ä¸ä»¥ä¸Šä¸¤ä¸ªè¿‡ç¨‹(æ•°æ®ä¼ è¾“, æ•°æ®æ‹·è´)ï¼Œå³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œæ‰å»é€šçŸ¥ç”¨æˆ·çº¿ç¨‹ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®äº†</p><p>é˜»å¡io å’Œéé˜»å¡ioåŒºåˆ«å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¼šä¸ä¼šé˜»å¡åœ¨ç­‰å¾…æ•°æ®æˆ–è€…æ•°æ®æ‹·è´ä¸Š</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="853-linux-ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ">8.5.3. Linux ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ<a href="#853-linux-ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ" class="hash-link" aria-label="Direct link to 8.5.3. Linux ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ" title="Direct link to 8.5.3. Linux ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ">â€‹</a></h3><p>Linuxä¸‹çš„selectã€pollå’Œepollå°±æ˜¯å¹²è¿™ä¸ªçš„ã€‚å°†ç”¨æˆ·socketå¯¹åº”çš„fdæ³¨å†Œè¿›epollï¼Œç„¶åepollå¸®ä½ ç›‘å¬å“ªäº›socketä¸Šæœ‰æ¶ˆæ¯åˆ°è¾¾</p><p>è¿™æ ·ï¼Œæ•´ä¸ªè¿‡ç¨‹åªåœ¨è°ƒç”¨selectã€pollã€epollè¿™äº›è°ƒç”¨çš„æ—¶å€™æ‰ä¼šé˜»å¡ï¼Œæ”¶å‘å®¢æˆ·æ¶ˆæ¯æ˜¯ä¸ä¼šé˜»å¡çš„ï¼Œæ•´ä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹å°±è¢«å……åˆ†åˆ©ç”¨èµ·æ¥ï¼Œè¿™å°±æ˜¯äº‹ä»¶é©±åŠ¨ï¼Œæ‰€è°“çš„reactoræ¨¡å¼</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="854-æ ¸å¿ƒç»„ä»¶">8.5.4. æ ¸å¿ƒç»„ä»¶<a href="#854-æ ¸å¿ƒç»„ä»¶" class="hash-link" aria-label="Direct link to 8.5.4. æ ¸å¿ƒç»„ä»¶" title="Direct link to 8.5.4. æ ¸å¿ƒç»„ä»¶">â€‹</a></h3><p>java nio å°±æ˜¯ å¤šè·¯å¤ç”¨æ€æƒ³çš„å®ç°</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8541-ç†è§£">8.5.4.1. ç†è§£<a href="#8541-ç†è§£" class="hash-link" aria-label="Direct link to 8.5.4.1. ç†è§£" title="Direct link to 8.5.4.1. ç†è§£">â€‹</a></h4><p>Selector å¯ä»¥åŒæ—¶ç›‘å¬ä¸€ç»„é€šä¿¡ä¿¡é“ï¼ˆChannelï¼‰ä¸Šçš„ I/O çŠ¶æ€</p><p>selectionKeys è¡¨ç¤º å„ä¸ª client çš„è¯·æ±‚</p><p>å¦å¤– , å‚è€ƒè¿™é‡Œ: <a href="https://tech.meituan.com/nio.html" target="_blank" rel="noopener noreferrer">https://tech.meituan.com/nio.html</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8542-channels">8.5.4.2. Channels<a href="#8542-channels" class="hash-link" aria-label="Direct link to 8.5.4.2. Channels" title="Direct link to 8.5.4.2. Channels">â€‹</a></h4><p>NIO Channel é€šé“å’Œæµçš„åŒºåˆ«:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8543-buffers">8.5.4.3. Buffers<a href="#8543-buffers" class="hash-link" aria-label="Direct link to 8.5.4.3. Buffers" title="Direct link to 8.5.4.3. Buffers">â€‹</a></h4><p>å’Œ channel äº¤äº’</p><ul><li><p>ä» Channel ä¸­è¯»å–æ•°æ®åˆ° buffers é‡Œï¼Œä» Buffer æŠŠæ•°æ®å†™å…¥åˆ° Channelsï¼›</p></li><li><p>Buffer æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å—å†…å­˜åŒº</p></li><li><p>capacity å®¹é‡ã€position ä½ç½®ã€limit é™åˆ¶ã€‚</p></li></ul><p>api:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ByteBuffer buf = ByteBuffer.allocate(28);//ä»¥ByteBufferä¸ºä¾‹å­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int bytesRead = inChannel.read(buf); //read into buffer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buf.put(127);// put data into buf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8544-selectors">8.5.4.4. Selectors<a href="#8544-selectors" class="hash-link" aria-label="Direct link to 8.5.4.4. Selectors" title="Direct link to 8.5.4.4. Selectors">â€‹</a></h4><p>å…¶å®å¯¹äºé€‰æ‹©å™¨çš„ä¸ªæ•°ã€é€‰æ‹©å™¨è¿è¡Œåœ¨å“ªä¸ªçº¿ç¨‹é‡Œã€æ˜¯å¦ä½¿ç”¨æ–°çš„çº¿ç¨‹æ¥å¤„ç†è¯·æ±‚éƒ½æ²¡æœ‰è¦æ±‚ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µæ¥å®šã€‚</p><p>æ¯”å¦‚è¯´ redisï¼Œå’Œå¤„ç†è¯·æ±‚ç›¸å…³çš„å°±ä¸€ä¸ªçº¿ç¨‹ï¼Œé€‰æ‹©å™¨è¿è¡Œåœ¨é‡Œé¢ï¼Œå¤„ç†è¯·æ±‚çš„ç¨‹åºä¹Ÿè¿è¡Œåœ¨é‡Œé¢ï¼Œæ‰€ä»¥è¿™ä¸ªçº¿ç¨‹æ—¢æ˜¯ I/O çº¿ç¨‹ï¼Œä¹Ÿæ˜¯ Worker çº¿ç¨‹ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé€‰æ‹©å™¨ï¼Œä¸€ä¸ªå¤„ç† OP_ACCEPTï¼Œä¸€ä¸ªå¤„ç† OP_READï¼Œè®©å®ƒä»¬åˆ†åˆ«è¿è¡Œåœ¨ä¸¤ä¸ªå•ç‹¬çš„ I/O çº¿ç¨‹é‡Œã€‚å¯¹äºèƒ½å¿«é€Ÿå®Œæˆçš„æ“ä½œå¯ä»¥ç›´æ¥åœ¨ I/O çº¿ç¨‹é‡Œåšäº†ï¼Œå¯¹äºéå¸¸è€—æ—¶çš„æ“ä½œä¸€å®šè¦ä½¿ç”¨ Worker çº¿ç¨‹æ± æ¥å¤„ç†ã€‚</p><p>è¿™ç§å¤„ç†æ¨¡å¼å°±æ˜¯è¢«ç§°ä¸ºçš„å¤šè·¯å¤ç”¨ I/Oï¼Œå¤šè·¯æŒ‡çš„æ˜¯å¤šä¸ª Socket é€šé“ï¼Œå¤ç”¨æŒ‡çš„æ˜¯åªç”¨ä¸€ä¸ªçº¿ç¨‹æ¥ç®¡ç†å®ƒä»¬ã€‚</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="855-nio-å®ç°ç½‘ç»œé€šä¿¡">8.5.5. nio å®ç°ç½‘ç»œé€šä¿¡<a href="#855-nio-å®ç°ç½‘ç»œé€šä¿¡" class="hash-link" aria-label="Direct link to 8.5.5. nio å®ç°ç½‘ç»œé€šä¿¡" title="Direct link to 8.5.5. nio å®ç°ç½‘ç»œé€šä¿¡">â€‹</a></h3><p>ä»é€šé“è¿›è¡Œæ•°æ®è¯»å– ï¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åè¯·æ±‚é€šé“è¯»å–æ•°æ®ã€‚</p><p>ä»é€šé“è¿›è¡Œæ•°æ®å†™å…¥ ï¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œå¡«å……æ•°æ®ï¼Œå¹¶è¦æ±‚é€šé“å†™å…¥æ•°æ®ã€‚</p><p>çœ‹ä¸ªä¾‹å­ - nio + tcp å®ç°é€šä¿¡ (<a href="https://examples.javacodegeeks.com/core-java/nio/java-nio-socket-example/" target="_blank" rel="noopener noreferrer">https://examples.javacodegeeks.com/core-java/nio/java-nio-socket-example/</a>)</p><p>è§ distributed-System#æ€ä¹ˆå®ç°å­ç³»ç»Ÿé—´çš„é€šä¿¡</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nio å®ç°ç½‘ç»œé€šä¿¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class NioServer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static int clientCount = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static AtomicInteger counter = new AtomicInteger(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static SimpleDateFormat sdf = new SimpleDateFormat(&quot;HH:mm:ss&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Selector selector = Selector.open(); // å®šä¹‰ä¸€ä¸ªé€‰æ‹©å™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // å®šä¹‰ä¸€ä¸ªæœåŠ¡å™¨ç«¯å¥—æ¥å­—é€šé“</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // é…ç½®ä¸ºéé˜»å¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ServerSocketChannel ssc = ServerSocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ssc.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // æ³¨å†Œ ssc åˆ° é€‰æ‹©å™¨, æŒ‡å®š ssc å…³æ³¨çš„äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ssc.register(selector, SelectionKey.OP_ACCEPT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ssc.bind(new InetSocketAddress(&quot;localhost&quot;, 8080));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //è¿›å…¥æ­»å¾ªç¯, // è½®è¯¢, é€‰æ‹©å™¨ä¸æ—¶çš„è¿›è¡Œé€‰æ‹©</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        selector.select();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set&lt;SelectionKey&gt; keys = selector.selectedKeys();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator&lt;SelectionKey&gt; iterator = keys.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (iterator.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          SelectionKey key = iterator.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          iterator.remove();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          if (key.isAcceptable()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              //é€‰æ‹©å™¨ç»ˆäºé€‰æ‹©å‡ºäº†é€šé“</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ServerSocketChannel ssc1 = (ServerSocketChannel)key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SocketChannel sc = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((sc = ssc1.accept()) != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //æŠŠæ–°æ¥å—çš„é€šé“é…ç½®ä¸ºéé˜»å¡çš„ï¼Œå¹¶æŠŠå®ƒä¹Ÿæ³¨å†Œåˆ°äº†é€‰æ‹©å™¨ä¸Šï¼Œè¯¥é€šé“æ„Ÿå…´è¶£çš„æ“ä½œä¸ºOP_READã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              sc.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              sc.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              InetSocketAddress rsa = (InetSocketAddress)sc.socket().getRemoteSocketAddress();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              System.out.println(time() + &quot;-&gt;&quot; + rsa.getHostName() + &quot;:&quot; + rsa.getPort() + &quot;-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + (++clientCount));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          //é€‰æ‹©å™¨ç»ˆäºåˆé€‰æ‹©å‡ºäº†é€šé“ï¼Œè¿™æ¬¡å‘ç°é€šé“æ˜¯éœ€è¦Readableçš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          else if (key.isReadable()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å…ˆå°†â€œè¯»â€ä»æ„Ÿå…´è¶£æ“ä½œç§»å‡ºï¼Œå¾…æŠŠæ•°æ®ä»é€šé“ä¸­è¯»å®Œåï¼Œå†æŠŠâ€œè¯»â€æ·»åŠ åˆ°æ„Ÿå…´è¶£æ“ä½œä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å¦åˆ™ï¼Œè¯¥é€šé“ä¼šä¸€ç›´è¢«é€‰å‡ºæ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key.interestOps(key.interestOps() &amp; (~ SelectionKey.OP_READ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æŠŠè¿™ä¸ªé€šé“äº¤ç»™äº†ä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹å»å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            processWithNewThread((SocketChannel)key.channel(), key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static void processWithNewThread(SocketChannel sc, SelectionKey key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Runnable run = () -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      counter.incrementAndGet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String result = readBytes(sc);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //æŠŠâ€œè¯»â€åŠ è¿›å»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        key.interestOps(key.interestOps() | SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(time() + &quot;-&gt;&quot; + result + &quot;-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + counter.get());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sc.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      counter.decrementAndGet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new Thread(run).start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static String readBytes(SocketChannel sc) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long start = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int total = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int count = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ByteBuffer bb = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å¼€å§‹è¯»æ•°æ®çš„æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long begin = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while ((count = sc.read(bb)) &gt; -1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (start &lt; 1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //ç¬¬ä¸€æ¬¡è¯»åˆ°æ•°æ®çš„æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        start = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      total += count;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bb.clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //è¯»å®Œæ•°æ®çš„æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long end = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &quot;wait=&quot; + (start - begin) + &quot;ms,read=&quot; + (end - start) + &quot;ms,total=&quot; + total + &quot;bs&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static String time() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return sdf.format(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="86-java-aio">8.6. java aio<a href="#86-java-aio" class="hash-link" aria-label="Direct link to 8.6. java aio" title="Direct link to 8.6. java aio">â€‹</a></h2><p>æ²¡æœ‰é˜»å¡ç‚¹ï¼Œå½“å·¥ä½œçº¿ç¨‹å¯åŠ¨æ—¶ï¼Œæ•°æ®å·²ç»ï¼ˆè¢«ç³»ç»Ÿï¼‰å‡†å¤‡å¥½å¯ä»¥ç›´æ¥ç”¨äº†ã€‚</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class AioServer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static int clientCount = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static AtomicInteger counter = new AtomicInteger(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static SimpleDateFormat sdf = new SimpleDateFormat(&quot;HH:mm:ss&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AsynchronousServerSocketChannel assc = AsynchronousServerSocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assc.bind(new InetSocketAddress(&quot;localhost&quot;, 8080));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //éé˜»å¡æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯æ³¨å†Œäº†ä¸ªå›è°ƒï¼Œè€Œä¸”åªèƒ½æ¥å—ä¸€ä¸ªè¿æ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assc.accept(null, new CompletionHandler&lt;AsynchronousSocketChannel, Object&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void completed(AsynchronousSocketChannel asc, Object attachment) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          //å†æ¬¡æ³¨å†Œï¼Œæ¥å—ä¸‹ä¸€ä¸ªè¿æ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          assc.accept(null, this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InetSocketAddress rsa = (InetSocketAddress)asc.getRemoteAddress();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(time() + &quot;-&gt;&quot; + rsa.getHostName() + &quot;:&quot; + rsa.getPort() + &quot;-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + (++clientCount));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          readFromChannelAsync(asc);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void failed(Throwable exc, Object attachment) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //ä¸è®©ä¸»çº¿ç¨‹é€€å‡º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      synchronized (AioServer.class) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AioServer.class.wait();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static void readFromChannelAsync(AsynchronousSocketChannel asc) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ä¼šæŠŠæ•°æ®è¯»å…¥åˆ°è¯¥bufferä¹‹åï¼Œå†è§¦å‘å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œå›è°ƒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ByteBuffer bb = ByteBuffer.allocate(1024*1024*1 + 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long begin = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //éé˜»å¡æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯æ³¨å†Œäº†ä¸ªå›è°ƒï¼Œè€Œä¸”åªèƒ½æ¥å—ä¸€æ¬¡è¯»å–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    asc.read(bb, null, new CompletionHandler&lt;Integer, Object&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //ä»è¯¥è¿æ¥ä¸Šä¸€å…±è¯»åˆ°çš„å­—èŠ‚æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      int total = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       * @param count è¡¨ç¤ºæœ¬æ¬¡è¯»å–åˆ°çš„å­—èŠ‚æ•°ï¼Œ-1è¡¨ç¤ºæ•°æ®å·²è¯»å®Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public void completed(Integer count, Object attachment) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counter.incrementAndGet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (count &gt; -1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          total += count;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int size = bb.position();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(time() + &quot;-&gt;count=&quot; + count + &quot;,total=&quot; + total + &quot;bs,buffer=&quot; + size + &quot;bs-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + counter.get());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (count &gt; -1) {//æ•°æ®è¿˜æ²¡æœ‰è¯»å®Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          //å†æ¬¡æ³¨å†Œå›è°ƒï¼Œæ¥å—ä¸‹ä¸€æ¬¡è¯»å–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          asc.read(bb, null, this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {//æ•°æ®å·²è¯»å®Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            asc.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counter.decrementAndGet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public void failed(Throwable exc, Object attachment) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long end = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(time() + &quot;-&gt;exe read req,use=&quot; + (end -begin) + &quot;ms&quot; + &quot;-&gt;&quot; + Thread.currentThread().getId());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static String time() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return sdf.format(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="87-æ–­ç‚¹ç»­ä¼ ">8.7. æ–­ç‚¹ç»­ä¼ <a href="#87-æ–­ç‚¹ç»­ä¼ " class="hash-link" aria-label="Direct link to 8.7. æ–­ç‚¹ç»­ä¼ " title="Direct link to 8.7. æ–­ç‚¹ç»­ä¼ ">â€‹</a></h2><p><a href="https://github.com/ryanlijianchang/ResumeBrokenDownloads" target="_blank" rel="noopener noreferrer">https://github.com/ryanlijianchang/ResumeBrokenDownloads</a></p><h1>9. ä»£ç†</h1><ul><li><p>é™æ€ä»£ç†</p><ul><li><p>ä»£ç†ç±»å®ç°ç›®æ ‡æ¥å£, å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæ¥å£ç±»å‹çš„å¼•ç”¨), jdk åŸç”Ÿå®ç°</p></li><li><p>aspectj æ¡†æ¶, åœ¨ç¼–è¯‘æœŸå¢å¼º</p></li></ul></li><li><p>åŠ¨æ€ä»£ç†:</p><ul><li><p>jdk åŠ¨æ€ä»£ç†(åªèƒ½é’ˆå¯¹æ¥å£è¿›è¡Œä»£ç†), jdk åŸç”Ÿå®ç°</p></li><li><p>cglib åŠ¨æ€ä»£ç†(ç›´æ¥é’ˆå¯¹ç±»ä»£ç†, ç”Ÿæˆå­ç±», æ‰€ä»¥ç›®æ ‡ç±»ä¸èƒ½æ˜¯ final çš„ ), ä¾èµ– asm; </p><p>Spring aop åœ¨ç»™æŸä¸ªç±»æä¾›åŠ¨æ€ä»£ç†æ—¶ä¼šè‡ªåŠ¨åœ¨ jdk åŠ¨æ€ä»£ç†å’Œ cglib åŠ¨æ€ä»£ç†ä¸­åŠ¨æ€çš„é€‰æ‹©ã€‚</p></li><li><p>javaassist - javaassist æ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„åŠ¨æ€ä»£ç†å¼€æºåº“, æ— éœ€ç±»æ¥å£; javaassist çš„ ProxyFactory è¿˜æä¾›äº†æ–¹æ³•è¿‡æ»¤å™¨ï¼Œå®ƒå¯ä»¥é€‰æ‹©æ€§åœ°å¯¹ç‰¹å®šæ–¹æ³•è¿›è¡Œå¢å¼ºã€‚</p></li></ul></li></ul><h1>10. Java å†…å­˜æ¨¡å‹</h1><p>java-memory-model.md</p><h1>11. java8</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="111-å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µfp">11.1. å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ(FP)<a href="#111-å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µfp" class="hash-link" aria-label="Direct link to 11.1. å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ(FP)" title="Direct link to 11.1. å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ(FP)">â€‹</a></h2><p>vavr å¢å¼ºåº“ (<a href="https://blog.csdn.net/gening4014/article/details/124326753" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/gening4014/article/details/124326753</a>)</p><ul><li><p>å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦å¤–çš„å‡½æ•°, åœ¨ Java ä¸­æœ¬è´¨è¿˜æ˜¯åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åç±»</p></li><li><p>å‡½æ•°å¯ä»¥ä½œä¸ºå¦å¤–å‡½æ•°çš„è¿”å›å€¼</p></li><li><p>å‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨ - å‡½æ•°å’Œå¤–ç•Œäº¤äº’å”¯ä¸€é€”å¾„å°±æ˜¯ å‚æ•° å’Œ è¿”å›å€¼</p><p>å‰¯ä½œç”¨: å‡½æ•°åœ¨ call çš„è¿‡ç¨‹ä¸­, å½±å“äº†å‡½æ•°çš„å¤–éƒ¨çŠ¶æ€</p></li><li><p>Declaractive(ç”³æ˜å¼) ä»£æ›¿ Imperative(å‘½ä»¤å¼)</p></li><li><p>ä¸å˜çš„å¯¹è±¡ -- ç±»ä¼¼äº ä¸å˜æ¨¡å¼</p><p>å£°æ˜å¼çš„æ“ä½œä¸ä¼šæ”¹å˜åŸå§‹å¯¹è±¡</p></li><li><p>å®¹æ˜“ å¹¶è¡ŒåŒ– -- è¿™ä¹Ÿæ˜¯ &quot;ä¸å˜å¯¹è±¡&quot;çš„å¥½å¤„</p></li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Declaractive vs. Imperative:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static void imperative(int[] arr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (int i : arr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.print(i+&quot;, &quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static void declaractive(int[] arr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // jdk1.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Arrays.stream(arr).forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="112-java8-æ·»åŠ çš„æ–°ç‰¹æ€§">11.2. Java8 æ·»åŠ çš„æ–°ç‰¹æ€§<a href="#112-java8-æ·»åŠ çš„æ–°ç‰¹æ€§" class="hash-link" aria-label="Direct link to 11.2. Java8 æ·»åŠ çš„æ–°ç‰¹æ€§" title="Direct link to 11.2. Java8 æ·»åŠ çš„æ–°ç‰¹æ€§">â€‹</a></h2><ul><li>default methods for interface æ¥å£å†…å…è®¸é»˜è®¤å®ç°, å®ç° fluent api</li><li>Lambda expression<ul><li>lambda scope<ul><li>accessing local variables - final å¯ä»¥ä¸åŠ , æœ€å¥½åŠ ä¸Š, å¿…é¡»ä¿è¯å˜é‡åªè¯»</li><li>accessing fields and static variables - å¯è¯»å¯å†™</li><li>accessing default interface methods - lambda ä¸­æ— æ³•ä½¿ç”¨æ¥å£é»˜è®¤æ–¹æ³•</li></ul></li></ul></li><li>method/constructor reference<ul><li>é™æ€æ–¹æ³•å¼•ç”¨ -- ClassName:methodName</li><li>å®ä¾‹æ–¹æ³•å¼•ç”¨<ul><li>é€šè¿‡ç±»å‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- ClassName::methodName</li><li>é€šè¿‡å®ä¾‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- instance::methodName</li></ul></li><li>è¶…ç±»ä¸Šçš„æ–¹æ³•å¼•ç”¨ -- super::methodName</li><li>æ„é€ æ–¹æ³•å¼•ç”¨ -- ClassName::new</li><li>æ•°ç»„æ„é€ æ–¹æ³•å¼•ç”¨ -- TypeName[]::new</li></ul></li><li>functional interface<ul><li>built-in functional interface<ul><li>Predicates - accept one arg and produce a predicate (and, or, negtive, isquals), ä»£è¡¨ä¸€æ®µé€»è¾‘åˆ¤æ–­</li><li>Functions - accept one arg and produce a result (andThen ä¸€ä¸ªä¸€ä¸ªæ¥ç€æ‰§è¡Œ, compose ä»æœ€å†…å±‚å¼€å§‹æ‰§è¡Œ), ä»£è¡¨ä¸€ä¸ªåŠŸèƒ½<ul><li>BiFunction - æ¥æ”¶ ä¸¤ä¸ªå‚æ•°</li></ul></li><li>Suppliers - do not accept any arg, produce a object of a given type, è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡å·¥å‚</li><li>Consumers - accept one arg and perform some operations on it, æ¶ˆè´¹è€…</li><li>Comparators - æ¯”è¾ƒå™¨</li></ul></li></ul></li><li>optional - a container for a value, å¹¶é functional interface, ç”¨äºé˜²æ­¢ç©ºæŒ‡é’ˆå¼‚å¸¸</li><li>stream - represents a sequence of elements, on which some operations can be performed; stream opts are either ä¸­é—´æ“ä½œ and ç»ˆæ­¢æ“ä½œ; æµéƒ½æ˜¯ä¸€æ¬¡æ€§çš„, ä¸€æ—¦ terminal opts è°ƒç”¨, æµå°±å…³é—­äº†, å†ç”¨å°±ä¼šå¼‚å¸¸, å¯é€šè¿‡æ„é€ ä¸€ä¸ª Suplier æ¥é‡ç”¨ stream;<ul><li>ä¸­é—´æ“ä½œ(intermediate opts) - åªæœ‰å­˜åœ¨ terminal opts æ—¶æ‰ä¼šå®é™…æ‰§è¡Œ; å¹¶ä¸”æ˜¯æ¯ä¸ª element èµ°å®Œæ•´ä¸ªé“¾æ¡, æ‰ä¼šè¿›å…¥ä¸‹ä¸€ä¸ª element(åˆ©äºå‡å°‘æ“ä½œæ•°, æ¯”å¦‚å¯¹äº anyMatch æ“ä½œ, åªè¦ä¸€ä¸ªå…ƒç´ ç¬¦åˆå°±è¿”å›æœ€æ€»ç»“æœ true)<ul><li>Filter - accept a predicate and return a filtered stream - ä¸€èˆ¬æ”¾åœ¨é“¾æ¡é¦–ä½, å‡å°‘æ“ä½œæ•°</li><li>Sorted - accept a comparator or nothing and return a sorted view of stream; åªæ˜¯ç”Ÿæˆè§†å›¾, å¹¶ä¸æ”¹å˜åŸå§‹ collection</li><li>Map - accept a function and perform on each element of the stream</li></ul></li><li>ç»ˆç‚¹æ“ä½œ(terminal opts)<ul><li>forEach - accept a consumer to be executed for each element in the stream</li><li>Match - accept a predicate and return a boolean result; æ£€æŸ¥è¿™ä¸ª stream ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦ç¬¦åˆ predicate<ul><li>anyMatch ä»»ä½•ä¸€ä¸ªç¬¦åˆ return true</li><li>allMatch å…¨éƒ½ç¬¦åˆ return true</li><li>noneMatch æ²¡æœ‰ç¬¦åˆçš„å…ƒç´  return true</li></ul></li><li>Count - return the number of element as a long value</li><li>Reduce - accept a function and return a optional representing the reducing value;</li><li>Collect - accept a collector, transfer a stream to collection<ul><li>æœ‰è®¸å¤š builtin çš„ collector, å¦‚ Collectors.toList()...</li></ul></li></ul></li><li>sequential stream(ä¸²è¡Œæµ)<ul><li>å®ä¾‹æ–¹æ³• someList.stream()</li><li>é™æ€æ–¹æ³• Arrays.stream(arr)</li><li>é™æ€æ–¹æ³• Stream.of(...)</li></ul></li><li>Parallel Streams(å¹¶è¡Œæµ)<ul><li>someList.parallelStream()</li><li>Stream.parallel()</li></ul></li></ul></li><li>maps<ul><li><code>map.keySet().stream()</code>, <code>map.values().stream()</code> and <code>map.entrySet().stream()</code>.</li><li>putIfAbsent(key, value) - è‹¥ç¡®å®, åˆ™å­˜å…¥; ---&gt;  å¦‚æœ key æ²¡æœ‰åœ¨ map ä¸­, å­˜å…¥, å¦‚æœ key å­˜åœ¨ map äº†, è¿”å› oldValue; ä¸»è¦æ˜¯å…é™¤äº† null check</li><li>merge(key,  newValue, biFunction) - æ ¹æ® key æŸ¥ value, å¦‚æœæ²¡æŸ¥åˆ°, ä¿å­˜, å¦‚æœæŸ¥åˆ°äº†, æ ¹æ® biFunction æ„é€  newValue ä¿å­˜; biFunction(oldValue, newValue) è¿”å›è®¡ç®—åçš„å€¼</li><li>forEach - accept a consumer</li><li>computeIfPresent(key, biFunction) - æ¥æ”¶ä¸€ä¸ª key, ä¸€ä¸ª biFunction, æ£€æŸ¥ key æ˜¯å¦ null, æ‰¾åˆ°è¿™ä¸ª entry, æ ¹æ® biFunction è®¡ç®—å‡ºæ–°çš„ value é‡æ–° put è¿› map; biFunction(key, value) è¿”å›è®¡ç®—çš„å€¼</li><li>computeIfAbsent - å¦‚æœæ ¹æ® key è·å–ä¸åˆ° value, åˆ™è®¡ç®—æ–°çš„ value å¹¶ put è¿›å»</li><li>remove(key, value) - value ç¬¦åˆæ‰ç§»é™¤ key å¯¹åº”çš„å…ƒç´ </li><li>getOrDefault(key, def_value) - æ²¡æœ‰å°±è¿”å›é»˜è®¤å€¼</li></ul></li><li>Date api - java.time åŒ…ä¸‹, çº¿ç¨‹å®‰å…¨<ul><li>Clock - æ—¶é’Ÿ, æ—¶é—´ç»Ÿè®¡</li><li>Timezones - æ—¶åŒº</li><li>LocalTime - æ²¡æœ‰ time zone çš„æ—¶é—´</li><li>LocalDate - æ—¥æœŸ</li><li>LocalDateTime - æ—¥æœŸæ—¶é—´</li></ul></li><li>Annotations<ul><li>æ³¨è§£é‡Œé¢å…è®¸æ³¨è§£, å…è®¸é‡å¤</li><li>æ³¨è§£å…è®¸æ”¾åœ¨æ–°çš„åœ°æ–¹: ElementType.TYPE_PARAMETER, ElementType.TYPE_USE</li></ul></li><li>CompletableFuture - å¢å¼ºç‰ˆæœ¬çš„ Future<ul><li>future.get() è·å–æœ€ç»ˆç»“æœ, ä¼šé˜»å¡, ç­‰å¾…å®Œæˆ</li><li>future.complet(xxx) ä»»åŠ¡å®Œæˆ</li><li>CompletableFuture.supplyAsync(xxx) æ„é€  future, æœ‰è¿”å›å€¼</li><li>CompletableFuture.runAsync(xxx) æ„é€  future, æ— è¿”å›å€¼</li><li>æµå¼è°ƒç”¨</li><li>å¼‚å¸¸å¤„ç†</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1121-æ¥å£é»˜è®¤æ–¹æ³•">11.2.1. æ¥å£é»˜è®¤æ–¹æ³•<a href="#1121-æ¥å£é»˜è®¤æ–¹æ³•" class="hash-link" aria-label="Direct link to 11.2.1. æ¥å£é»˜è®¤æ–¹æ³•" title="Direct link to 11.2.1. æ¥å£é»˜è®¤æ–¹æ³•">â€‹</a></h3><p>java8 å†…ç½®çš„è®¸å¤šå‡½æ•°å¼æ¥å£ç”¨åˆ°äº†&quot;æ¥å£é»˜è®¤å®ç°&quot;, è¿™ä½¿å¾— Java8 æ‹¥æœ‰äº†ç±»ä¼¼ å¤šç»§æ‰¿çš„èƒ½åŠ›: ä¸€ä¸ªå¯¹è±¡å®ä¾‹, æ‹¥æœ‰å¤šä¸ªæ¥å£æä¾›çš„å®ä¾‹æ–¹æ³•</p><p>è€Œè¿™ä¹Ÿä½¿å¾—æ¥å£é»˜è®¤æ–¹æ³•ä¼šç¢°åˆ° å¤šç»§æ‰¿ä¸€æ ·çš„é—®é¢˜ -- å¦‚æœä¸¤ä¸ªçˆ¶ç±»æ‹¥æœ‰ç›¸åŒåç§°çš„æ–¹æ³•, å­ç±»ä¸çŸ¥é“ä»¥å“ªä¸ªçš„ä¸ºå‡†, ä¼šæŠ›å¼‚å¸¸</p><p>åˆ©ç”¨ æ¥å£é»˜è®¤æ–¹æ³•, å¯ä»¥å®ç°é¡ºç•…çš„ fluent api</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// å…¸å‹ Demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface Formula {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    double calculate(int a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    default double sqrt(int a) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Math.sqrt(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static void intConsumerAndThenTest() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IntConsumer println = System.out::println;// è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IntConsumer errPrintln = System.err::println;// è¾“å‡ºåˆ° é”™è¯¯è¾“å‡º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Arrays.stream(arr).forEach(println.andThen(errPrintln));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// IntConsumerçš„å®ç°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@FunctionalInterface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface IntConsumer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void accept(int value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…ˆè°ƒç”¨ accept, ç„¶åafter.accept()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    default IntConsumer andThen(IntConsumer after) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Objects.requireNonNull(after);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (int t) -&gt; { accept(t); after.accept(t); };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1122-functionalinterface-å‡½æ•°æ¥å£">11.2.2. @FunctionalInterface-å‡½æ•°æ¥å£<a href="#1122-functionalinterface-å‡½æ•°æ¥å£" class="hash-link" aria-label="Direct link to 11.2.2. @FunctionalInterface-å‡½æ•°æ¥å£" title="Direct link to 11.2.2. @FunctionalInterface-å‡½æ•°æ¥å£">â€‹</a></h3><p>ç”¨äºæ ‡æ³¨å‡½æ•°å¼æ¥å£ - è¿™ä¸ªæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•(attention: å…è®¸å­˜åœ¨å…¶ä»–çš„æ¥å£é»˜è®¤æ–¹æ³• or Object ä¸­åŒ…å«çš„æ–¹æ³•); æ˜¯å¦æ·»åŠ è¿™ä¸ªæ³¨è§£ä¸æ˜¯å¼ºåˆ¶æ€§çš„, ç±»ä¼¼ @Override, åªæ˜¯ä¸ºäº†æä¾›ç¼–è¯‘æ£€æŸ¥</p><p>æœ¬è´¨æ˜¯å»¶è¿Ÿäº†å‡½æ•°çš„å®šä¹‰, ä½¿ç”¨çš„æ—¶å€™å†æ¥å®šä¹‰å‡½æ•°çš„å…·ä½“å®ç°, æ–¹ä¾¿äº† lambda è¡¨è¾¾å¼</p><p>å‡½æ•°å¼æ¥å£çš„å®ä¾‹é€šè¿‡ &quot;æ–¹æ³•å¼•ç”¨&quot; å’Œ &quot;lambda&quot; æ„é€ </p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// å®šä¹‰å‡½æ•°å¼æ¥å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@FunctionalInterface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface Converter&lt;F, T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    T convert(F from);// åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@FunctionalInterface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface IntHandler {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void handl(int i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    boolean equals(Object obj);// equals() è¢« Object å®ç°äº†, è€ŒIntHandlerçš„å®ä¾‹é»˜è®¤ç»§æ‰¿è‡ªObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä½¿ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Converter&lt;String, Integer&gt; converter = (from) -&gt; Integer.valueOf(from);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Integer converted = converter.convert(&quot;123&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(converted);    // 123</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1123-æ–¹æ³•çš„å¼•ç”¨">11.2.3. æ–¹æ³•çš„å¼•ç”¨<a href="#1123-æ–¹æ³•çš„å¼•ç”¨" class="hash-link" aria-label="Direct link to 11.2.3. æ–¹æ³•çš„å¼•ç”¨" title="Direct link to 11.2.3. æ–¹æ³•çš„å¼•ç”¨">â€‹</a></h3><p>ç”¨æ¥ç®€åŒ– lambda è¡¨è¾¾å¼</p><ul><li>é™æ€æ–¹æ³•å¼•ç”¨ -- ClassName:methodName</li><li>å®ä¾‹æ–¹æ³•å¼•ç”¨<ul><li>é€šè¿‡ç±»å‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- ClassName::methodName</li><li>é€šè¿‡å®ä¾‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- instance::methodName</li></ul></li><li>è¶…ç±»ä¸Šçš„æ–¹æ³•å¼•ç”¨ -- super::methodName</li><li>æ„é€ æ–¹æ³•å¼•ç”¨ -- ClassName::new</li><li>æ•°ç»„æ„é€ æ–¹æ³•å¼•ç”¨ -- TypeName[]::new</li></ul><p>ä¸è¦è¯•å›¾ç”¨åœ¨é‡è½½æ–¹æ³•ä¸Š, ç¼–è¯‘å™¨ç¢°åˆ°å¤šä¸ªç›¸åŒçš„åç§°çš„æ–¹æ³•ä¼šæ„Ÿåˆ°å›°æƒ‘, æŠ›å‡ºå¼‚å¸¸</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class App {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final Logger log = LoggerFactory.getLogger(App.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main( String[] args ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println( &quot;java 8&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * :: æ™®é€šå‡½æ•°çš„å¼•ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void test3() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Person person = new Person(&quot;Peter&quot;, &quot;Parker&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String ret = person::sayAndReturn;//// ç¼–è¯‘æ— æ³•é€šè¿‡, [String ret ] æ— æ³•æ¥å—ä¸€ä¸ªå‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    // person::sayAndReturn è¿”å›çš„å¼æ–¹æ³•å¼•ç”¨, è€Œä¸æ˜¯ æ–¹æ³•æ‰§è¡Œçš„ç»“æœ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ç¼–è¯‘é€šè¿‡, testæ–¹æ³•ç¬¦åˆConverterä¸­çš„æ¥å£è§„èŒƒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Converter&lt;String, String&gt; converter = person::test;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Demo demo = new Demo();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Converter&lt;String, String&gt; converter2 = demo::startWith;// æ¥æ”¶ä¸€ä¸ªstring, è¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                // (strtWithçš„è¾“å…¥è¾“å‡ºè¦å’ŒConverterçš„å‡½æ•°å¼æ¥å£åŒ¹é…)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String firstLetter = converter2.convert(&quot;Java&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info(firstLetter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * :: constructor reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void test2() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PersonFactory&lt;Person&gt; personFac =  Person::new;// Person::newè¡¨ç¤ºPersonçš„æ„é€ å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        // çš„reference, ä¹Ÿæ˜¯ PersonFactory è¿™ä¸ªå‡½æ•°å¼æ¥å£çš„ä¸€ä¸ªå®ä¾‹;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        // åˆšå¥½ç”¨ personFac æ¥æ”¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Person person = personFac.create(&quot;Peter&quot;, &quot;Parker&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @FunctionalInterface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interface PersonFactory&lt;P extends Person&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        P create(String first, String last);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1124-lambda-è¡¨è¾¾å¼">11.2.4. Lambda è¡¨è¾¾å¼<a href="#1124-lambda-è¡¨è¾¾å¼" class="hash-link" aria-label="Direct link to 11.2.4. Lambda è¡¨è¾¾å¼" title="Direct link to 11.2.4. Lambda è¡¨è¾¾å¼">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="11241-lambda-ä»‹ç»">11.2.4.1. lambda ä»‹ç»<a href="#11241-lambda-ä»‹ç»" class="hash-link" aria-label="Direct link to 11.2.4.1. lambda ä»‹ç»" title="Direct link to 11.2.4.1. lambda ä»‹ç»">â€‹</a></h4><p>æœ¬è´¨å°±æ˜¯åŒ¿åç±»</p><p>lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨å¤–éƒ¨å˜é‡, ä½†æ˜¯ lambda ä¸€æ—¦å®šä¹‰, è¿™ä¸ªå¤–éƒ¨å˜é‡å°±ä¸èƒ½æ”¹å˜äº†, åº”è¯¥è§†ä¸º &quot;final&quot;</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;String&gt; names = Arrays.asList(&quot;peter&quot;, &quot;anna&quot;, &quot;mike&quot;, &quot;xenia&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// oldç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Collections.sort(names, new Comparator&lt;String&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int compare(String a, String b) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return b.compareTo(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Lambdaè¡¨è¾¾å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Collections.sort(names, (String a, String b) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return b.compareTo(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//æ›´ç®€å•1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Collections.sort(names, (String a, String b) -&gt; b.compareTo(a));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ›´ç®€å•2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Collections.sort(names, (a, b) -&gt; b.compareTo(a));// ç¼–è¯‘å™¨çŸ¥é“å‚æ•°ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥è·³è¿‡å®ƒä»¬ä¸å†™</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="11242-lambda-ä½œç”¨åŸŸé—®é¢˜">11.2.4.2. Lambda ä½œç”¨åŸŸé—®é¢˜<a href="#11242-lambda-ä½œç”¨åŸŸé—®é¢˜" class="hash-link" aria-label="Direct link to 11.2.4.2. Lambda ä½œç”¨åŸŸé—®é¢˜" title="Direct link to 11.2.4.2. Lambda ä½œç”¨åŸŸé—®é¢˜">â€‹</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="112421-è®¿é—®å±€éƒ¨å˜é‡">11.2.4.2.1. è®¿é—®å±€éƒ¨å˜é‡<a href="#112421-è®¿é—®å±€éƒ¨å˜é‡" class="hash-link" aria-label="Direct link to 11.2.4.2.1. è®¿é—®å±€éƒ¨å˜é‡" title="Direct link to 11.2.4.2.1. è®¿é—®å±€éƒ¨å˜é‡">â€‹</a></h5><p>å±€éƒ¨å˜é‡å¿…é¡»å£°æ˜ä¸º: final æˆ–è€…éšå¼ final</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//// è¿™æ ·å¯ä»¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final int num = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Converter&lt;Integer, String&gt; stringConverter = (from) -&gt; String.valueOf(from + num);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stringConverter.convert(2);     // 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// è¿™æ ·å¯ä»¥(éšå¼final)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int num = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Converter&lt;Integer, String&gt; stringConverter = (from) -&gt; String.valueOf(from + num);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stringConverter.convert(2);     // 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¿™æ ·æ— æ³•ç¼–è¯‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int num = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Converter&lt;Integer, String&gt; stringConverter = (from) -&gt; String.valueOf(from + num);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num = 3;// ä¸æ˜¯finalçš„äº†</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="112422-è®¿é—®æˆå‘˜å˜é‡">11.2.4.2.2. è®¿é—®æˆå‘˜å˜é‡<a href="#112422-è®¿é—®æˆå‘˜å˜é‡" class="hash-link" aria-label="Direct link to 11.2.4.2.2. è®¿é—®æˆå‘˜å˜é‡" title="Direct link to 11.2.4.2.2. è®¿é—®æˆå‘˜å˜é‡">â€‹</a></h5><p>å¾ˆæ™®é€š, å¯è¯»å¯å†™</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Lambda4 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static int outerStaticNum;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int outerNum;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void testScopes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Converter&lt;Integer, String&gt; stringConverter1 = (from) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outerNum = 23;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return String.valueOf(from);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Converter&lt;Integer, String&gt; stringConverter2 = (from) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outerStaticNum = 72;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return String.valueOf(from);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="112423-è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•">11.2.4.2.3. è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•<a href="#112423-è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•" class="hash-link" aria-label="Direct link to 11.2.4.2.3. è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•" title="Direct link to 11.2.4.2.3. è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•">â€‹</a></h5><p>ä¸èƒ½è®¿é—®</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">interface Formula {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    double calculate(int a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    default double sqrt(int a) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Math.sqrt(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ç¼–è¯‘ä¸é€šè¿‡,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Formula formula = (a) -&gt; sqrt( a * 100);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="113-java8-ä¸­çš„å¹¶è¡Œæµ">11.3. java8 ä¸­çš„å¹¶è¡Œæµ<a href="#113-java8-ä¸­çš„å¹¶è¡Œæµ" class="hash-link" aria-label="Direct link to 11.3. java8 ä¸­çš„å¹¶è¡Œæµ" title="Direct link to 11.3. java8 ä¸­çš„å¹¶è¡Œæµ">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1131-ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®">11.3.1. ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®<a href="#1131-ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®" class="hash-link" aria-label="Direct link to 11.3.1. ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®" title="Direct link to 11.3.1. ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®">â€‹</a></h3><p>parallel() - å¾—åˆ°å¹¶è¡Œæµ</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private static long countPrime() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // long count = IntStream.range(1, 5).filter(Lambdda::isPrime).count();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä½¿ç”¨å¹¶è¡Œæ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Lambdda::isPrime ä¼šè¢«å¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long count = IntStream.range(1, 10000).parallel().filter(Lambdda::isPrime).count();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return count;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * åˆ¤æ–­æ˜¯å¦è´¨æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * è´¨æ•°: åªèƒ½è¢« 1å’Œå®ƒæœ¬èº«æ•´é™¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @param target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static boolean isPrime(int target) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (target &lt; 2) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (int i = 2; i &lt;= Math.sqrt(target); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (target % i == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // System.out.println(&quot;prime: &quot; + target);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1132-ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ">11.3.2. ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ<a href="#1132-ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ" class="hash-link" aria-label="Direct link to 11.3.2. ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ" title="Direct link to 11.3.2. ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private static void average() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ArrayList&lt;Student&gt; stuList = new ArrayList&lt;Student&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stuList.add(new Student(1));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stuList.add(new Student(2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stuList.add(new Student(3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä»é›†åˆè·å–æµ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    double asDouble = stuList.stream().mapToInt(stu -&gt; stu.score).average().getAsDouble();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¹¶è¡Œæµ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    double asDouble2 = stuList.stream().parallel().mapToInt(stu -&gt; stu.score).average().getAsDouble();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(asDouble);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1133-å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼">11.3.3. å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼<a href="#1133-å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼" class="hash-link" aria-label="Direct link to 11.3.3. å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼" title="Direct link to 11.3.3. å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private static void parallelSort() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int[] bigArr = new int[100];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Arrays.setAll(bigArr, ele -&gt; new Random().nextInt(200));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¹¶è¡Œèµ‹å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Arrays.parallelSetAll(bigArr, ele -&gt; new Random().nextInt());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ’åº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Arrays.sort(bigArr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¹¶è¡Œæ’åº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Arrays.parallelSort(bigArr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Arrays.stream(bigArr).forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="114-completablefuture-æ¥å£-å¢å¼ºçš„-future">11.4. CompletableFuture æ¥å£-å¢å¼ºçš„ Future<a href="#114-completablefuture-æ¥å£-å¢å¼ºçš„-future" class="hash-link" aria-label="Direct link to 11.4. CompletableFuture æ¥å£-å¢å¼ºçš„ Future" title="Direct link to 11.4. CompletableFuture æ¥å£-å¢å¼ºçš„ Future">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1141-java-å¼‚æ­¥ç¼–ç¨‹">11.4.1. java å¼‚æ­¥ç¼–ç¨‹<a href="#1141-java-å¼‚æ­¥ç¼–ç¨‹" class="hash-link" aria-label="Direct link to 11.4.1. java å¼‚æ­¥ç¼–ç¨‹" title="Direct link to 11.4.1. java å¼‚æ­¥ç¼–ç¨‹">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/* </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¼‚æ­¥çš„å‡ ç§æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Thread æ–¹å¼: å¯¹è€—æ—¶çš„ä»»åŠ¡æ–°å¼€ä¸€ä¸ªçº¿ç¨‹, ä¸»çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ç¼ºç‚¹: åˆ›å»ºçº¿ç¨‹æ²¡æœ‰å¤ç”¨ (è¿™ä¸ªé—®é¢˜ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è§£å†³ã€‚)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            å¼‚æ­¥ä»»åŠ¡æ— æ³•è·å–æœ€ç»ˆçš„æ‰§è¡Œç»“æœ, ä½¿ç”¨  FutureTask å¯ä»¥è§£å†³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Guava åº“æä¾›çš„ ListenableFuture å’Œ Futures ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spring æ¡†æ¶æä¾›çš„ @Async ç­‰æ³¨è§£å®ç°å¼‚æ­¥å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FutureTask æ–¹å¼: è‡ª JDK 1.5 å¼€å§‹ï¼Œå¼•å…¥äº† Future æ¥å£å’Œå®ç° Future æ¥å£çš„ FutureTask ç±»æ¥è¡¨ç¤ºå¼‚æ­¥è®¡ç®—ç»“æœ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    å®ç°äº† Future æ¥å£è¿˜å®ç°äº† Runnable æ¥å£ï¼Œè¡¨ç¤ºä¸€ç§å¯ç”Ÿæˆç»“æœçš„ Runnable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ç¼ºç‚¹:ä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒå¤æ‚, å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„ç»„åˆæ¯”è¾ƒ, ä¾èµ–å…³ç³»æ¯”è¾ƒéš¾è¡¨è¾¾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CompletableFuture: è‡ª jdk1.8å¼•å…¥, å®ç°äº† Future å’Œ CompletionStage æ¥å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1142-åŸç†ä»‹ç»">11.4.2. åŸç†ä»‹ç»<a href="#1142-åŸç†ä»‹ç»" class="hash-link" aria-label="Direct link to 11.4.2. åŸç†ä»‹ç»" title="Direct link to 11.4.2. åŸç†ä»‹ç»">â€‹</a></h3><p>CompletableFuture æ˜¯è¶…å¤§å‹å·¥å…·ç±», æ–¹æ³•å·¨å¤š, å®ç°äº† Future , CompletionStage, ä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿å¤šçº¿ç¨‹å¼‚æ­¥ä»»åŠ¡çš„ç¼–æ’</p><p>Callableï¼Œæœ‰ç»“æœçš„åŒæ­¥è¡Œä¸ºï¼Œæ¯”å¦‚åšè›‹ç³•ï¼Œäº§ç”Ÿè›‹ç³•
Runnableï¼Œæ— ç»“æœçš„åŒæ­¥è¡Œä¸ºï¼Œæ¯”å¦‚å–ç‰›å¥¶ï¼Œä»…ä»…å°±æ˜¯å–
Futureï¼Œå¼‚æ­¥å°è£…Callable/Runnableï¼Œæ¯”å¦‚å§”æ‰˜ç»™å¸ˆå‚…ï¼ˆå…¶ä»–çº¿ç¨‹ï¼‰å»åšç³•ç‚¹
CompletableFutureï¼Œå°è£…Futureï¼Œä½¿å…¶æ‹¥æœ‰å›è°ƒåŠŸèƒ½ï¼Œæ¯”å¦‚è®©å¸ˆå‚…ä¸»åŠ¨å‘Šè¯‰æˆ‘è›‹ç³•åšå¥½äº†</p><p>åˆ›å»ºæ—¶éœ€è¦ä¼ é€’çº¿ç¨‹æ± , ä¸ä¼ åˆ™ä½¿ç”¨é»˜è®¤ pool</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1143-completablefuture-api">11.4.3. completablefuture api<a href="#1143-completablefuture-api" class="hash-link" aria-label="Direct link to 11.4.3. completablefuture api" title="Direct link to 11.4.3. completablefuture api">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åˆ›å»º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// supplyAsyncæ–¹æ³•, å…³æ³¨è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//ä½¿ç”¨é»˜è®¤å†…ç½®çº¿ç¨‹æ± ForkJoinPool.commonPool()ï¼Œæ ¹æ®supplieræ„å»ºæ‰§è¡Œä»»åŠ¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static &lt;U&gt; CompletableFuture&lt;U&gt; supplyAsync(Supplier&lt;U&gt; supplier)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//è‡ªå®šä¹‰çº¿ç¨‹ï¼Œæ ¹æ®supplieræ„å»ºæ‰§è¡Œä»»åŠ¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static &lt;U&gt; CompletableFuture&lt;U&gt; supplyAsync(Supplier&lt;U&gt; supplier, Executor executor)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// runAsyncæ–¹æ³•, ä¸æ”¯æŒä¸å…³æ³¨è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//ä½¿ç”¨é»˜è®¤å†…ç½®çº¿ç¨‹æ± ForkJoinPool.commonPool()ï¼Œæ ¹æ®runnableæ„å»ºæ‰§è¡Œä»»åŠ¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static CompletableFuture&lt;Void&gt; runAsync(Runnable runnable) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//è‡ªå®šä¹‰çº¿ç¨‹ï¼Œæ ¹æ®runnableæ„å»ºæ‰§è¡Œä»»åŠ¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static CompletableFuture&lt;Void&gt; runAsync(Runnable runnable,  Executor executor)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¼‚æ­¥å›è°ƒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åšå®Œç¬¬ä¸€ä¸ªä»»åŠ¡åï¼Œå†åšç¬¬äºŒä¸ªä»»åŠ¡ã€‚å‰åä¸¤ä¸ªä»»åŠ¡æ²¡æœ‰å‚æ•°ä¼ é€’(å³ä¸å…³å¿ƒä¸Šä¸ªä»»åŠ¡çš„ç»“æœ)ï¼Œç¬¬äºŒä¸ªä»»åŠ¡(å³è¿™é‡Œçš„ action)ä¹Ÿæ²¡æœ‰è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public CompletableFuture&lt;Void&gt; thenRun(Runnable action);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ç­‰æ•ˆthenRun, åŒºåˆ«:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¦‚æœä½ æ‰§è¡Œç¬¬ä¸€ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œä¼ å…¥äº†ä¸€ä¸ªè‡ªå®šä¹‰çº¿ç¨‹æ± ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è°ƒç”¨thenRunæ–¹æ³•æ‰§è¡Œç¬¬äºŒä¸ªä»»åŠ¡æ—¶ï¼Œåˆ™ç¬¬äºŒä¸ªä»»åŠ¡å’Œç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯å…±ç”¨åŒä¸€ä¸ªçº¿ç¨‹æ± ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è°ƒç”¨thenRunAsyncæ‰§è¡Œç¬¬äºŒä¸ªä»»åŠ¡æ—¶ï¼Œåˆ™ç¬¬ä¸€ä¸ªä»»åŠ¡ä½¿ç”¨çš„æ˜¯ä½ è‡ªå·±ä¼ å…¥çš„çº¿ç¨‹æ± ï¼Œç¬¬äºŒä¸ªä»»åŠ¡ä½¿ç”¨çš„æ˜¯ForkJoinçº¿ç¨‹æ± </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public CompletableFuture&lt;Void&gt; thenRunAsync(Runnable action);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¾èµ–ä¸Šä¸ªä»»åŠ¡çš„ç»“æœ, æœ‰ä¼ å‚, æ— è¿”å›å€¼ ( ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç¬¬äºŒä¸ªå›è°ƒæ–¹æ³•ä»»åŠ¡ï¼Œä¼šå°†è¯¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œä½œä¸ºå…¥å‚ï¼Œä¼ é€’åˆ°å›è°ƒæ–¹æ³•ä¸­ï¼Œä½†æ˜¯å›è°ƒæ–¹æ³•æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ã€‚)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thenAccept/thenAcceptAsync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¾èµ–ä¸Šä¸ªä»»åŠ¡ç»“æœ, æœ‰ä¼ å‚, æœ‰è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thenApply/thanApplyAsync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æŸä¸ªä»»åŠ¡å¼‚å¸¸, æ‰§è¡Œçš„å›è°ƒæ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exceptionally(e -&gt; {e.print...})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆå, æ‰§è¡Œçš„å›è°ƒæ–¹æ³•   , å›è°ƒæ–¹æ³•æ— è¿”å›å€¼, ä½†æ˜¯æ–¹æ³•æœ¬èº«æœ‰è¿”å›å€¼, è¿”å›ä¸Šä¸ªä»»åŠ¡çš„ç»“æœ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">whenComplete((last_result, e) -&gt; {no return_value})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//æŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆå, æ‰§è¡Œçš„å›è°ƒæ–¹æ³•   , å›è°ƒæ–¹æ³•æœ‰è¿”å›å€¼ , æ–¹æ³•æœ¬èº«è¿”å›å›è°ƒæ–¹æ³•çš„ result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle((last_result, e) -&gt; {return_value})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¤šä¸ªä»»åŠ¡ç»„åˆå¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// and çš„å…³ç³»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thenCombine / thenAcceptBoth / runAfterBoth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// éƒ½è¡¨ç¤ºï¼šå°†ä¸¤ä¸ªCompletableFutureç»„åˆèµ·æ¥ï¼Œåªæœ‰è¿™ä¸¤ä¸ªéƒ½æ­£å¸¸æ‰§è¡Œå®Œäº†ï¼Œæ‰ä¼šæ‰§è¡ŒæŸä¸ªä»»åŠ¡ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åŒºåˆ«åœ¨äºï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// thenCombineï¼šä¼šå°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ï¼Œä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œä¸”æœ‰è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// thenAcceptBoth: ä¼šå°†ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœä½œä¸ºæ–¹æ³•å…¥å‚ï¼Œä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œä¸”æ— è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// runAfterBoth ä¸ä¼šæŠŠæ‰§è¡Œç»“æœå½“åšæ–¹æ³•å…¥å‚ï¼Œä¸”æ²¡æœ‰è¿”å›å€¼ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// or çš„å…³ç³»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">applyToEither / acceptEither / runAfterEither </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// éƒ½è¡¨ç¤ºï¼šå°†ä¸¤ä¸ªCompletableFutureç»„åˆèµ·æ¥ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªæ‰§è¡Œå®Œäº†,å°±ä¼šæ‰§è¡ŒæŸä¸ªä»»åŠ¡ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åŒºåˆ«åœ¨äºï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// applyToEitherï¼šä¼šå°†å·²ç»æ‰§è¡Œå®Œæˆçš„ä»»åŠ¡ï¼Œä½œä¸ºæ–¹æ³•å…¥å‚ï¼Œä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œä¸”æœ‰è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// acceptEither: ä¼šå°†å·²ç»æ‰§è¡Œå®Œæˆçš„ä»»åŠ¡ï¼Œä½œä¸ºæ–¹æ³•å…¥å‚ï¼Œä¼ é€’åˆ°æŒ‡å®šæ–¹æ³•ä¸­ï¼Œä¸”æ— è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// runAfterEitherï¼š ä¸ä¼šæŠŠæ‰§è¡Œç»“æœå½“åšæ–¹æ³•å…¥å‚ï¼Œä¸”æ²¡æœ‰è¿”å›å€¼ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AllOf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆåï¼Œæ‰æ‰§è¡Œ allOfè¿”å›çš„CompletableFutureã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//å¦‚æœä»»æ„ä¸€ä¸ªä»»åŠ¡å¼‚å¸¸ï¼ŒallOfçš„CompletableFutureï¼Œæ‰§è¡Œgetæ–¹æ³•ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AnyOf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä»»æ„ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œï¼Œå°±æ‰§è¡ŒanyOfè¿”å›çš„CompletableFutureã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¦‚æœæ‰§è¡Œçš„ä»»åŠ¡å¼‚å¸¸ï¼ŒanyOfçš„CompletableFutureï¼Œæ‰§è¡Œgetæ–¹æ³•ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thenCompose/thenComposeAsync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åœ¨æŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå°†è¯¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœ,ä½œä¸ºæ–¹æ³•å…¥å‚,å»æ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°çš„CompletableFutureå®ä¾‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å’Œ thenApply åŒºåˆ«:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// thenApply()æ¥æ”¶çš„æ˜¯å‰ä¸€ä¸ªè°ƒç”¨è¿”å›çš„ç»“æœï¼Œç„¶åå¯¹è¯¥ç»“æœè¿›è¡Œå¤„ç†ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//          å®ƒçš„åŠŸèƒ½ç›¸å½“äºå°†CompletableFuture&lt;T&gt;è½¬æ¢æˆCompletableFuture&lt;U&gt;ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//          è½¬æ¢çš„æ˜¯æ³›å‹ä¸­çš„ç±»å‹ï¼Œæ˜¯åŒä¸€ä¸ªCompletableFuture</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// thenCompose()æ¥æ”¶çš„æ˜¯å‰ä¸€ä¸ªè°ƒç”¨çš„stageï¼Œè¿”å›flatä¹‹åçš„çš„CompletableFutureã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//          ä»–çš„åŠŸèƒ½æ˜¯ç”¨æ¥è¿æ¥ä¸¤ä¸ªCompletableFuture</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//          æ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„CompletableFuture</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ç®€å•ç‚¹æ¯”è¾ƒï¼Œä¸¤è€…å°±åƒæ˜¯mapå’ŒflatMapçš„åŒºåˆ«ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ³¨æ„:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Futureéœ€è¦è·å–è¿”å›å€¼ï¼Œæ‰èƒ½è·å–å¼‚å¸¸ä¿¡æ¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// CompletableFutureä»£ç ä¸­åˆä½¿ç”¨äº†é»˜è®¤çš„çº¿ç¨‹æ± ï¼Œå¤„ç†çš„çº¿ç¨‹ä¸ªæ•°æ˜¯ç”µè„‘CPUæ ¸æ•°-1ã€‚åœ¨å¤§é‡è¯·æ±‚è¿‡æ¥çš„æ—¶å€™ï¼Œå¤„ç†é€»è¾‘å¤æ‚çš„è¯ï¼Œå“åº”ä¼šå¾ˆæ…¢ã€‚ä¸€èˆ¬å»ºè®®ä½¿ç”¨è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œä¼˜åŒ–çº¿ç¨‹æ± é…ç½®å‚æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è‡ªå®šä¹‰çº¿ç¨‹æ± æ—¶ï¼Œæ³¨æ„é¥±å’Œç­–ç•¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// CompletableFutureçš„get()æ–¹æ³•æ˜¯é˜»å¡çš„ï¼Œæˆ‘ä»¬ä¸€èˆ¬å»ºè®®ä½¿ç”¨future.get(3, TimeUnit.SECONDS)ã€‚å¹¶ä¸”ä¸€èˆ¬å»ºè®®ä½¿ç”¨è‡ªå®šä¹‰çº¿ç¨‹æ± ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä½†æ˜¯å¦‚æœçº¿ç¨‹æ± æ‹’ç»ç­–ç•¥æ˜¯DiscardPolicyæˆ–è€…DiscardOldestPolicyï¼Œå½“çº¿ç¨‹æ± é¥±å’Œæ—¶ï¼Œä¼šç›´æ¥ä¸¢å¼ƒä»»åŠ¡ï¼Œä¸ä¼šæŠ›å¼ƒå¼‚å¸¸ã€‚å› æ­¤å»ºè®®ï¼ŒCompletableFutureçº¿ç¨‹æ± ç­–ç•¥æœ€å¥½ä½¿ç”¨AbortPolicyï¼Œç„¶åè€—æ—¶çš„å¼‚æ­¥çº¿ç¨‹ï¼Œåšå¥½çº¿ç¨‹æ± éš”ç¦»å“ˆ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1144-å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ">11.4.4. å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ<a href="#1144-å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ" class="hash-link" aria-label="Direct link to 11.4.4. å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ" title="Direct link to 11.4.4. å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ">â€‹</a></h3><p>å¯ä½œä¸ºå‡½æ•°è°ƒç”¨çš„å¥‘çº¦(çœŸå®è¿”å›å€¼çš„åŒ…è£…)</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * CompletableFutureDemo  å¤æ‚çš„è®¡ç®—åœ¨ main thread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CompletableFutureDemo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // block until main thread complete the complex compute, then print result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static class AskTask implements Runnable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private CompletableFuture&lt;Integer&gt; future;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public AskTask(CompletableFuture&lt;Integer&gt; future) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.future = future;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void run() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Integer integer = future.get();// é˜»å¡, CompletableFutureä¸º &quot;æœªå®Œæˆ&quot; çŠ¶æ€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(integer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } catch (InterruptedException | ExecutionException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws InterruptedException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CompletableFuture&lt;Integer&gt; future = new CompletableFuture&lt;Integer&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new Thread(new AskTask(future)).start();// å¯åŠ¨ç­‰å¾…çº¿ç¨‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // simulate complex compute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread.sleep(1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // å‘ŠçŸ¥è¿ç®—ç»“æœ: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        future.complete(100);// æ­¤æ—¶ä¸º &quot;å®Œæˆ&quot;çŠ¶æ€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1145-å¼‚æ­¥æ‰§è¡Œä»»åŠ¡">11.4.5. å¼‚æ­¥æ‰§è¡Œä»»åŠ¡<a href="#1145-å¼‚æ­¥æ‰§è¡Œä»»åŠ¡" class="hash-link" aria-label="Direct link to 11.4.5. å¼‚æ­¥æ‰§è¡Œä»»åŠ¡" title="Direct link to 11.4.5. å¼‚æ­¥æ‰§è¡Œä»»åŠ¡">â€‹</a></h3><p>è¿™ä¸ª demo åˆšå¥½å’Œä¸Šé¢çš„ demo ç›¸å, è´Ÿè´£çš„è®¡ç®—ä¸åœ¨ main thread</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) throws InterruptedException, ExecutionException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CompletableFuture&lt;Integer&gt; supplyAsync = CompletableFuture.supplyAsync(() -&gt; calculate(20));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    // supplyAsync() ç”¨äºéœ€è¦æœ‰è¿”å›å€¼çš„åœºæ™¯, å¯ä¼ é€’ pool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    // runAsync() ç”¨äºæ— éœ€è¿”å›å€¼çš„åœºæ™¯, å¯ä¼ é€’ pool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // do sth else;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(supplyAsync.get());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static Integer calculate(Integer param) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // simulate complex calculation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread.sleep(1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return param * param;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1146-æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª-function-å’Œ-å¼‚å¸¸å¤„ç†">11.4.6. æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª function å’Œ å¼‚å¸¸å¤„ç†<a href="#1146-æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª-function-å’Œ-å¼‚å¸¸å¤„ç†" class="hash-link" aria-label="Direct link to 11.4.6. æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª function å’Œ å¼‚å¸¸å¤„ç†" title="Direct link to 11.4.6. æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª function å’Œ å¼‚å¸¸å¤„ç†">â€‹</a></h3><p>çº¿ç¨‹ä¸²è¡ŒåŒ– (ç­‰å¾…å‰ç½® ä»»åŠ¡å®Œæˆåå†...)</p><p>thenapply() ç­‰å¾…å®Œæˆç„¶åå¤„ç†, æœ‰è¿”å›å€¼
thenrun() .... æ²¡æœ‰è¿”å›å€¼, æ²¡æœ‰ä¼ å…¥å‚æ•°
thenaccept() ç­‰å¾…å®Œæˆç„¶åæ¶ˆè´¹</p><p>å¸¦æœ‰ async çš„æ–¹æ³•åˆ™æ–°ä»»åŠ¡æ˜¯æ–°å¼€ä¸€ä¸ªthread æ‰§è¡Œ, ä¸å¸¦ async çš„æ–¹æ³•åˆ™æ–°ä»»åŠ¡æ˜¯å’Œå‰ç½®ä»»åŠ¡å…±ç”¨ thread</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private static void fluentApiDemo() throws InterruptedException, ExecutionException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(50))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .thenApply(i -&gt; Integer.toString(i)).thenApply(str -&gt; &quot;\&quot;&quot; + str + &quot;\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .thenAccept(System.out::println);// ç»“æœ: &quot;2500&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   ä¹Ÿå¯ä»¥åœ¨æµè°ƒç”¨ä¸­ä½¿ç”¨ whencomplete((resp, e) -&gt; {})    å¼‚å¸¸å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//                  ç±»ä¼¼ çš„ handle(( resp, e) -&gt; {return ...}), å¯ä»¥æœ‰è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    future.get(); // éœ€è¦è®© main thread é˜»å¡, ç­‰å¾… calculateæ‰§è¡Œå®Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(future.get());// é˜»å¡ // ç»“æœ: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static Integer calculate(Integer param) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // simulate complex calculation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread.sleep(1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return param * param;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¼‚å¸¸å¤„ç†</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private static void fluentApiDemo() throws InterruptedException, ExecutionException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(50))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //   ä¹Ÿå¯ä»¥åœ¨æµè°ƒç”¨ä¸­ä½¿ç”¨ whencomplete((resp, e) -&gt; {})    å¼‚å¸¸å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//                  ç±»ä¼¼ çš„ handle(( resp, e) -&gt; {return ...}), å¯ä»¥æœ‰è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .exceptionally(e -&gt; {           // å¯¹ calculate æ–¹æ³•çš„å¼‚å¸¸å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                e.printStackTrace(); // java.util.concurrent.CompletionException: java.lang.ArithmeticException: / by zero</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return 0; // æœ€ç»ˆå¤„ç†ç»“æœ : &quot;0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .thenApply(i -&gt; Integer.toString(i)).thenApply(str -&gt; &quot;\&quot;&quot; + str + &quot;\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .thenAccept(System.out::println);// ç»“æœ: &quot;2500&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    future.get(); // éœ€è¦è®© main thread é˜»å¡, ç­‰å¾… calculateæ‰§è¡Œå®Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(future.get());// é˜»å¡ // ç»“æœ: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static Integer calculate(Integer param) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int i = param/0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // simulate complex calculation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread.sleep(1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return param * param;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1147-ç»„åˆå¤šä¸ª-completablefuture">11.4.7. ç»„åˆå¤šä¸ª CompletableFuture<a href="#1147-ç»„åˆå¤šä¸ª-completablefuture" class="hash-link" aria-label="Direct link to 11.4.7. ç»„åˆå¤šä¸ª CompletableFuture" title="Direct link to 11.4.7. ç»„åˆå¤šä¸ª CompletableFuture">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// é¡ºåºå®Œæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static void composeCompletableFutureDemo() throws InterruptedException, ExecutionException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(20))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .thenCompose(i -&gt; CompletableFuture.supplyAsync(() -&gt; calculate(i)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // ç­‰å¾…ä¸Šä¸€ä¸ªfutureå¾—åˆ°ç»“æœ, ç„¶åå°†ä¸Šä¸€ä¸ª future çš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // ç»“æœä¼ å…¥(è¿™ä¿© future æ˜¯ä¾èµ–å…³ç³»), å†æ¬¡æ„é€ ä¸€ä¸ª future</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .thenApply(i -&gt; &quot;\&quot;&quot; + i + &quot;\&quot;&quot;).thenAccept(System.out::println);// ç»“æœ: &quot;160000&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    future.get();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¦ä¸€ç§ç»„åˆçš„æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ²¡æœ‰é¡ºåº, ä½†æ˜¯éƒ½è¦å®Œæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static void composeCompletableFutureDemo() throws InterruptedException, ExecutionException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(20))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // é¦–å…ˆå®Œæˆå‰ä¸€ä¸ª future  å’Œ è·Ÿç€çš„ future (è¿™ä¿©future æ²¡æœ‰ä»»ä½•å…³ç³»), ç„¶åå°†ä¸¤è€…ç»“æœè¿›è¡Œè®¡ç®—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .thenCombine(CompletableFuture.supplyAsync(() -&gt; calculate(10)), (i, j) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;i=&quot; + i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;j=&quot; + j);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return i + j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .thenApply(i -&gt; &quot;\&quot;&quot; + i + &quot;\&quot;&quot;).thenAccept(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // ç»“æœ:i=400 j=100 &quot;500&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    future.get();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ²¡æœ‰é¡ºåºçš„ç»„åˆæ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CompletableFuture.allOf(f1,f2).join();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åªè¦ä¸€ä¸ªå®Œæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">applyToEither() ä»»ä¸€å®Œæˆ, è·å–è¿”å›å€¼, å¤„ç†ç„¶ååˆæœ‰æ–°çš„è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accepttoeither() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runaftereither()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="115-stampedlock-è¯»å†™é”çš„æ”¹è¿›">11.5. StampedLock-è¯»å†™é”çš„æ”¹è¿›<a href="#115-stampedlock-è¯»å†™é”çš„æ”¹è¿›" class="hash-link" aria-label="Direct link to 11.5. StampedLock-è¯»å†™é”çš„æ”¹è¿›" title="Direct link to 11.5. StampedLock-è¯»å†™é”çš„æ”¹è¿›">â€‹</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="116-longadder-åŸå­ç±»çš„å¢å¼º">11.6. LongAdder-åŸå­ç±»çš„å¢å¼º<a href="#116-longadder-åŸå­ç±»çš„å¢å¼º" class="hash-link" aria-label="Direct link to 11.6. LongAdder-åŸå­ç±»çš„å¢å¼º" title="Direct link to 11.6. LongAdder-åŸå­ç±»çš„å¢å¼º">â€‹</a></h2><p>å†…éƒ¨ä»ç„¶ä½¿ç”¨ CAS æ“ä½œ, ä½†æ˜¯ä½¿ç”¨ &quot;çƒ­ç‚¹æ•°æ®åˆ†ç¦»&quot; çš„æ€æƒ³, ç±»ä¼¼ ConcurrentHashMap å°†å†…éƒ¨æ•°æ®åˆ†ç¦»åˆ°å¤šä¸ª segment</p><p>LongAdder å°† AtomicInteger å†…éƒ¨çš„æ ¸å¿ƒæ•°æ® value åˆ†è§£ä¸ºä¸€ä¸ª æ•°ç»„, æ¯ä¸ª thread è®¿é—®å°±é€šè¿‡ hash ç®—æ³•æ˜ å°„åˆ°æ•°ç»„å…¶ä¸­ä¸€ä¸ªå…ƒç´ è¿›è¡Œè®¡ç®—, æœ€ç»ˆçš„ç»“æœåˆ™æ˜¯è¿™ä¸ªæ•°ç»„çš„æ±‚å’Œç´¯åŠ </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="117-java8-å†…ç½®å‡½æ•°å¼æ¥å£">11.7. java8 å†…ç½®å‡½æ•°å¼æ¥å£<a href="#117-java8-å†…ç½®å‡½æ•°å¼æ¥å£" class="hash-link" aria-label="Direct link to 11.7. java8 å†…ç½®å‡½æ•°å¼æ¥å£" title="Direct link to 11.7. java8 å†…ç½®å‡½æ•°å¼æ¥å£">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1171-predicatesè°“è¯-æ–­å®š">11.7.1. Predicates(è°“è¯, æ–­å®š)<a href="#1171-predicatesè°“è¯-æ–­å®š" class="hash-link" aria-label="Direct link to 11.7.1. Predicates(è°“è¯, æ–­å®š)" title="Direct link to 11.7.1. Predicates(è°“è¯, æ–­å®š)">â€‹</a></h3><p><code>apply(T input): boolean</code> è¾“å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å› true æˆ–è€… false</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Predicate&lt;String&gt; predicateStr = (str) -&gt; str.length() &gt; 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean test = predicateStr.test(&quot;ssss&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(test+&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Predicate&lt;Boolean&gt; nonNull = Objects::nonNull;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Predicate&lt;Boolean&gt; isNull = Objects::isNull;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Predicate&lt;String&gt; isEmpty = String::isEmpty;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Predicate&lt;String&gt; isNotEmpty = isEmpty.negate();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1172-functionså‡½æ•°">11.7.2. Functions(å‡½æ•°)<a href="#1172-functionså‡½æ•°" class="hash-link" aria-label="Direct link to 11.7.2. Functions(å‡½æ•°)" title="Direct link to 11.7.2. Functions(å‡½æ•°)">â€‹</a></h3><p><code>apply(S input): T</code> Functions æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªç»“æœã€‚é»˜è®¤æ–¹æ³•å¯ä»¥å°†å¤šä¸ªå‡½æ•°ä¸²åœ¨ä¸€èµ·ï¼ˆcompse, andThenï¼‰</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Function&lt;String, Integer&gt; toInteger = Integer::valueOf;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function&lt;String, String&gt; backToString = toInteger.andThen(String::valueOf);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backToString.apply(&quot;123&quot;);     // &quot;123&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1173-suppliersç”Ÿäº§è€…">11.7.3. Suppliers(ç”Ÿäº§è€…)<a href="#1173-suppliersç”Ÿäº§è€…" class="hash-link" aria-label="Direct link to 11.7.3. Suppliers(ç”Ÿäº§è€…)" title="Direct link to 11.7.3. Suppliers(ç”Ÿäº§è€…)">â€‹</a></h3><p>å°±å¥½åƒä¸€ä¸ª bean å·¥å‚</p><p>Suppliers äº§ç”Ÿä¸€ä¸ªç»™å®šçš„æ³›å‹ç±»å‹çš„ç»“æœ, ä¸ Functional ä¸åŒçš„æ˜¯ Suppliers ä¸æ¥å—è¾“å…¥å‚æ•°ã€‚</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ç”±äºpersonSupplierä¸æ¥å—è¾“å…¥å‚æ•°, åˆ™è°ƒç”¨çš„æ˜¯personçš„æ— å‚æ•°Constructor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Supplier&lt;Person&gt; personSupplier = Person::new;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">personSupplier.get();   // new Person</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1174-consumersæ¶ˆè´¹è€…">11.7.4. Consumers(æ¶ˆè´¹è€…)<a href="#1174-consumersæ¶ˆè´¹è€…" class="hash-link" aria-label="Direct link to 11.7.4. Consumers(æ¶ˆè´¹è€…)" title="Direct link to 11.7.4. Consumers(æ¶ˆè´¹è€…)">â€‹</a></h3><p>Consumers ä»£è¡¨åœ¨ä¸€ä¸ªå•ä¸€çš„è¾“å…¥å‚æ•°ä¸Šæ‰§è¡Œæ“ä½œã€‚</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Consumer&lt;Person&gt; greeter = (p) -&gt; System.out.println(&quot;Hello, &quot; + p.name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greeter.accept(new Person(&quot;Luke&quot;, &quot;Skywalker&quot;));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1175-comparatorsæ¯”è¾ƒå™¨">11.7.5. Comparators(æ¯”è¾ƒå™¨)<a href="#1175-comparatorsæ¯”è¾ƒå™¨" class="hash-link" aria-label="Direct link to 11.7.5. Comparators(æ¯”è¾ƒå™¨)" title="Direct link to 11.7.5. Comparators(æ¯”è¾ƒå™¨)">â€‹</a></h3><p>Comparators åœ¨æ—§ç‰ˆæœ¬ Java ä¸­æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚Java8 å¢åŠ äº†å„ç§é»˜è®¤æ–¹æ³•çš„æ¥å£</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Comparator&lt;Person&gt; comparator = (p1, p2) -&gt; p1.name.compareTo(p2.name); // å‡åº, è‹¥ p2.name.compareTo(p1.name) åˆ™æ˜¯é™åº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åœ¨ stream ä¸­, stream.max(comparator) å–æœ€å¤§å€¼, éœ€è¦ comparator æ˜¯å‡åºæ’åºå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å‡åºæ’åº ä¹Ÿå¯ä»¥ç®€å†™ Comparator.comparing(o -&gt; Long.valueOf(o.getVersion()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Person p1 = new Person(&quot;John&quot;, &quot;Doe&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Person p2 = new Person(&quot;Alice&quot;, &quot;Wonderland&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">comparator.compare(p1, p2);             // &gt; 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">comparator.reversed().compare(p1, p2);  // &lt; 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1176-optional">11.7.6. Optional<a href="#1176-optional" class="hash-link" aria-label="Direct link to 11.7.6. Optional" title="Direct link to 11.7.6. Optional">â€‹</a></h3><p>å¯é€‰å¯¹è±¡, æ˜¯å¯¹ object çš„ä¸€å±‚åŒ…è£…</p><p>Optionals æ˜¯æ²¡æœ‰ä»»ä½•å‡½æ•°çš„æ¥å£ï¼Œå”¯ä¸€ä½œç”¨æ˜¯é˜²æ­¢ NullPointerException å¼‚å¸¸</p><p>Optional is a simple container for a value which may be null or non-null. Think of a method which may return a non-null result but sometimes return nothing. Instead of returning null you return an Optional in Java 8.
(Optional æ˜¯ä¸€ä¸ªç®€å•çš„å®¹å™¨ï¼Œè¿™ä¸ªå€¼å¯èƒ½æ˜¯ç©ºçš„æˆ–è€…éç©ºçš„ã€‚è€ƒè™‘åˆ°ä¸€ä¸ªæ–¹æ³•å¯èƒ½ä¼šè¿”å›ä¸€ä¸ª non-null çš„å€¼ï¼Œä¹Ÿå¯èƒ½è¿”å›ä¸€ä¸ªç©ºå€¼ã€‚ä¸ºäº†ä¸ç›´æ¥è¿”å› nullï¼Œæˆ‘ä»¬åœ¨ Java 8 ä¸­å°±è¿”å›ä¸€ä¸ª Optionalã€‚)</p><p>å¸¸ç”¨ api:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Optional.of()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Optional.ofNullable()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Optional.empty()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public&lt;U&gt; Optional&lt;U&gt; map(Function&lt;? super T, ? extends U&gt; mapper)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public T orElse(T other)       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è‹¥å†…éƒ¨ object ä¸ä¸º null, è¿”å› object, å¦åˆ™è¿”å› other</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //          ä¼ å…¥ä¸€ä¸ª method call, åˆ™è¿™ä¸ªæ–¹æ³•æ€»æ˜¯ä¼šæ‰§è¡Œ, æ— è®ºå†…éƒ¨ objectæ˜¯å¦ä¸º null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public T orElseGet(Supplier&lt;? extends T&gt; other)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //          method call åªä¼šåœ¨ å†…éƒ¨ object ä¸º null æ—¶æ‰§è¡Œ, æ›´æ¨èä½¿ç”¨è¿™ä¸ª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void ifPresent(Consumer&lt;? super T&gt; consumer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Optional&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public&lt;U&gt; Optional&lt;U&gt; flatMap(Function&lt;? super T, Optional&lt;U&gt;&gt; mapper)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ç±»ä¼¼ map(), åŒºåˆ«æ˜¯ flatMap è¿”å›çš„æ˜¯ä¸€ä¸ªæ²¡æœ‰åŒ…è£…çš„å€¼, map()è¿”å›çš„æ˜¯å¸¦åŒ…è£…çš„å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public &lt;X extends Throwable&gt; T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier) throws X</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* optional api ç¤ºä¾‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static void test5() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Optional&lt;String&gt; opt = Optional.of(&quot;mama&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä¸æ¨èä½¿ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.info(opt.isPresent()+&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.info(opt.get());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.info(opt.orElse(&quot;elseValue&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    opt.ifPresent((s) -&gt; log.info(s.charAt(0)+&quot;&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    opt.flatMap((input) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null; // è¿”å›çš„æ˜¯ä¸€ä¸ªOptionnal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    opt.map((input) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;// è¿”å›çš„æ˜¯ä¸€ä¸ªObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return user.orElse(null);  //è€Œä¸æ˜¯ return user.isPresent() ? user.get() : null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return user.orElse(UNKNOWN_USER);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eturn user.orElseGet(() -&gt; fetchAUserFromDatabase());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user.ifPresent(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return user.map(u -&gt; u.getOrders()).orElse(Collections.emptyList())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æœ€ä½³å®è·µ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> private String getName2(User_1 user_1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Optional.ofNullable(user_1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .map(user1 -&gt; user1.user_2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .map(user_2 -&gt; user_2.name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .orElseThrow(RuntimeException::new);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>optional ç›´æ¥ç”Ÿæˆ stream</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Optional&lt;String&gt; optional = Optional.of(&quot;ggg&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// java 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream&lt;String&gt; texts = optional.map(Stream::of).orElseGet(Stream::empty);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream&lt;String&gt; hello = Optional.of(new String[] {&quot;hello&quot;, &quot;aa&quot;, &quot;bb&quot;}).map(Stream::of).orElseGet(Stream::empty);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// java 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream&lt;String&gt; texts = optional.stream();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="118-streamsç®¡é“">11.8. Streams(ç®¡é“)<a href="#118-streamsç®¡é“" class="hash-link" aria-label="Direct link to 11.8. Streams(ç®¡é“)" title="Direct link to 11.8. Streams(ç®¡é“)">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1181-stream-ä»‹ç»">11.8.1. stream ä»‹ç»<a href="#1181-stream-ä»‹ç»" class="hash-link" aria-label="Direct link to 11.8.1. stream ä»‹ç»" title="Direct link to 11.8.1. stream ä»‹ç»">â€‹</a></h3><p><a href="https://github.com/biezhi/learn-java8/blob/master/java8-stream/README.md" target="_blank" rel="noopener noreferrer">https://github.com/biezhi/learn-java8/blob/master/java8-stream/README.md</a></p><ul><li><p><code>java.util.Stream</code></p></li><li><p>æµæ˜¯ä¸€ä¸ªæºäº§ç”Ÿçš„ï¼Œä¾‹å¦‚ java.util.Collection(æ¯”å¦‚:Collection.stream()æˆ– Collection.parallelStream())</p></li><li><p>æ“ä½œçš„éƒ½æ˜¯é›†åˆçš„è§†å›¾, åŸé›†åˆæ²¡æœ‰å˜åŒ–</p></li><li><p>Parallel Streams(å¹¶è¡Œç®¡é“): é€šè¿‡<code>list.parallelStream()</code>è·å– paralled stream, æ•ˆç‡æå¤§æå‡</p></li><li><p>stream åªèƒ½ä½¿ç”¨ä¸€æ¬¡, é‡å¤ä½¿ç”¨éœ€è¦æ„é€ ä¸€ä¸ª Supplier</p></li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">IntStream.range(1, 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Arrays.stream(new int[] {1, 2, 3})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(n -&gt; 2 * n + 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .average()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .ifPresent(System.out::println);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1182-é‡å¤ä½¿ç”¨-stream">11.8.2. é‡å¤ä½¿ç”¨ stream<a href="#1182-é‡å¤ä½¿ç”¨-stream" class="hash-link" aria-label="Direct link to 11.8.2. é‡å¤ä½¿ç”¨ stream" title="Direct link to 11.8.2. é‡å¤ä½¿ç”¨ stream">â€‹</a></h3><p>é€šè¿‡ supplier: (æœ¬è´¨å°±æ˜¯è°ƒç”¨ get() æ—¶ é‡æ–°ç”Ÿæˆäº†æµ, æ‰€ä»¥, æµç”Ÿæˆä¸èƒ½å†™åœ¨ supplier å¤–éƒ¨)</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Supplier&lt;Stream&lt;String&gt;&gt;  supplier = () -&gt; Stream.of(&quot;hello&quot;, &quot;aa&quot;, &quot;bb&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean        aa    = supplier.get().allMatch(s -&gt; s.equalsIgnoreCase(&quot;aa&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean        aa1   = supplier.get().anyMatch(s -&gt; s.equalsIgnoreCase(&quot;aa&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(aa);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(aa1);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1183-map-å’Œ-flatmap">11.8.3. map å’Œ flatMap<a href="#1183-map-å’Œ-flatmap" class="hash-link" aria-label="Direct link to 11.8.3. map å’Œ flatMap" title="Direct link to 11.8.3. map å’Œ flatMap">â€‹</a></h3><p>map æ¥æ”¶ä¸€ä¸ªå‡½æ•°, å‡½æ•°è¿”å›å¤„ç†åçš„ stream</p><p>flatmap, æ¥å—ä¸€ä¸ªå‡½æ•°, å‡½æ•°è¿”å› stream, æœ€åä¼šå°†å„ä¸ª stream åˆå¹¶ä¸ºä¸€ä¸ª stream</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1184-å»é‡">11.8.4. å»é‡<a href="#1184-å»é‡" class="hash-link" aria-label="Direct link to 11.8.4. å»é‡" title="Direct link to 11.8.4. å»é‡">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stream æœ‰ distinct()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">æ ¹æ®æŸä¸ª object å±æ€§å»é‡:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">studentList = studentList.stream().collect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      collectingAndThen(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        toCollection(() -&gt; new TreeSet&lt;&gt;(Comparator.comparing(Student::getName))), ArrayList::new)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1185-collectæ–¹æ³•-å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´ -åˆ†ç»„-å»é‡">11.8.5. collectæ–¹æ³• å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´  åˆ†ç»„ å»é‡<a href="#1185-collectæ–¹æ³•-å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´ -åˆ†ç»„-å»é‡" class="hash-link" aria-label="Direct link to 11.8.5. collectæ–¹æ³• å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´  åˆ†ç»„ å»é‡" title="Direct link to 11.8.5. collectæ–¹æ³• å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´  åˆ†ç»„ å»é‡">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// set , å»é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;,&quot;a&quot;).collect(Collectors.toSet()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è½¬æ¢ä¸ºç‰¹å®š é›†åˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TreeSet&lt;String&gt; treeSet = Stream.of(&quot;a&quot;, &quot;c&quot;, &quot;b&quot;, &quot;a&quot;).collect(Collectors.toCollection(TreeSet::new));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//å¯¹äºstringåˆ—è¡¨å»é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List stringListï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stringList = stringList.stream().distinct().collect(Collectors.toList());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¯¹äºå®ä½“ç±»çš„å»é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//é€šè¿‡hashcode()å’Œequals()æ–¹æ³•æ¥è·å–ä¸åŒå…ƒç´ ï¼Œå› æ­¤éœ€è¦å»é‡çš„ç±»å¿…é¡»å®ç°hashcode()å’Œequals()æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List studentListï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">studentList = studentList.stream().distinct().collect(Collectors.toList());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ ¹æ® List ä¸­ Object æŸä¸ªå±æ€§å»é‡(å§“åå»é‡)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List studentList;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">studentList = studentList.stream()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.collect(collectingAndThen(toCollection(() -&gt; new TreeSet&lt;&gt;(Comparator.comparing(Student::getName))), ArrayList::new));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//æ ¹æ®List ä¸­ Object å¤šä¸ªå±æ€§å»é‡(å§“åï¼Œå¹´é¾„å»é‡)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListstudentListï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">studentList=studentList.stream()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.collect(Collectors.collectingAndThen(Collectors.toCollection(() -&gt; new TreeSet&lt;&gt;(Comparator.comparing(o -&gt; o.getName() + â€œ;â€ + o.getAge()))), ArrayList::new));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//å‚æ•°:  toMap(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //     keyMapper,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //     valueMapper,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //     mergeFunction // biFunction(oldVal, newVal) è¡¨ç¤º è‹¥ æ„é€ å½“å‰é”®å€¼å¯¹æ—¶, key å¯¹åº”çš„ value å·²ç»å­˜åœ¨, åˆ™ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ç”Ÿæˆæ–°çš„ value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, String&gt; collect = Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;).collect(Collectors.toMap(x -&gt; x, x -&gt; x + x,(oldVal, newVal) -&gt; newVal)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Collectors.minBy(Integer::compare)ï¼šæ±‚æœ€å°å€¼ï¼Œç›¸å¯¹åº”çš„å½“ç„¶ä¹Ÿæœ‰maxByæ–¹æ³•ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Collectors.averagingInt(x-&gt;x)ï¼šæ±‚å¹³å‡å€¼ï¼ŒåŒæ—¶ä¹Ÿæœ‰averagingDoubleã€averagingLongæ–¹æ³•ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Collectors.summingInt(x -&gt; x))ï¼šæ±‚å’Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Collectors.summarizingDouble(x -&gt; x)ï¼šå¯ä»¥è·å–æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼ã€æ€»å’Œå€¼ã€æ€»æ•°ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DoubleSummaryStatistics summaryStatistics = Stream.of(1, 3, 4).collect(Collectors.summarizingDouble(x -&gt; x));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(summaryStatistics .getAverage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Collectors.groupingBy(x -&gt; x)ï¼šæœ‰ä¸‰ç§æ–¹æ³•ï¼ŒæŸ¥çœ‹æºç å¯ä»¥çŸ¥é“å‰ä¸¤ä¸ªæ–¹æ³•æœ€ç»ˆè°ƒç”¨ç¬¬ä¸‰ä¸ªæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤HashMap::new  ç¬¬ä¸‰ä¸ªå‚æ•°é»˜è®¤Collectors.toList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;Integer, List&lt;Integer&gt;&gt; map = Stream.of(1, 3, 3, 2).collect(Collectors.groupingBy(Function.identity()));//identity()æ˜¯Functionç±»çš„é™æ€æ–¹æ³•,å’Œ x-&gt;x æ˜¯ä¸€ä¸ªæ„æ€,å½“ä»…ä»…éœ€è¦è‡ªå·±è¿”å›è‡ªå·±æ—¶,ä½¿ç”¨identity()èƒ½æ›´æ¸…æ¥šçš„è¡¨è¾¾ä½œè€…çš„æ„æ€.å†™çš„å¤æ‚ä¸€ç‚¹,ç»•ä¸€ç‚¹,å¯¹ç†è§£å¾ˆæœ‰å¥½å¤„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;Integer, Integer&gt; map1 = Stream.of(1, 3, 3, 2).collect(Collectors.groupingBy(Function.identity(), Collectors.summingInt(x -&gt; x)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HashMap&lt;Integer, List&lt;Integer&gt;&gt; hashMap = Stream.of(1, 3, 3, 2).collect(Collectors.groupingBy(Function.identity(), HashMap::new, Collectors.mapping(x -&gt; x + 1, Collectors.toList())));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Collectors.partitioningBy(x -&gt; x &gt; 2)ï¼ŒæŠŠæ•°æ®åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œkeyä¸ºture/falseã€‚ç¬¬ä¸€ä¸ªæ–¹æ³•ä¹Ÿæ˜¯è°ƒç”¨ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸ºCollectors.toList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;Boolean, List&lt;Integer&gt;&gt; map = Stream.of(1, 3, 3, 2).collect(Collectors.partitioningBy(x -&gt; x &gt; 2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;Boolean, Long&gt; longMap = Stream.of(1, 3, 3, 2).collect(Collectors.partitioningBy(x -&gt; x &gt; 1, Collectors.counting()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Collectors.joining(&quot;,&quot;)ï¼šæ‹¼æ¥å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(Stream.of(&quot;1&quot;, &quot;3&quot;, &quot;3&quot;, &quot;2&quot;).collect(Collectors.joining(&quot;,&quot;)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Collectors.collectingAndThen(Collectors.toList(), x -&gt; x.size())ï¼šå…ˆæ‰§è¡Œcollectæ“ä½œåå†æ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°çš„è¡¨è¾¾å¼ã€‚è¿™é‡Œæ˜¯å…ˆå¡åˆ°é›†åˆï¼Œå†å¾—å‡ºé›†åˆé•¿åº¦ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Integer integer = Stream.of(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;).collect(Collectors.collectingAndThen(Collectors.toList(), x -&gt; x.size()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Collectors.mapping(...)ï¼šè·ŸStreamçš„mapæ“ä½œç±»ä¼¼ï¼Œåªæ˜¯å‚æ•°æœ‰ç‚¹åŒºåˆ«</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(Stream.of(1, 3, 5).collect(Collectors.mapping(x -&gt; x + 1, Collectors.toList())));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1186-stream-ä¸­å¼‚å¸¸å¤„ç†">11.8.6. stream ä¸­å¼‚å¸¸å¤„ç†<a href="#1186-stream-ä¸­å¼‚å¸¸å¤„ç†" class="hash-link" aria-label="Direct link to 11.8.6. stream ä¸­å¼‚å¸¸å¤„ç†" title="Direct link to 11.8.6. stream ä¸­å¼‚å¸¸å¤„ç†">â€‹</a></h3><p><a href="https://cloud.tencent.com/developer/article/1429208" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1429208</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="119-date-æ—¶é—´æ—¥æœŸæ–°çš„-api">11.9. date æ—¶é—´æ—¥æœŸæ–°çš„ api<a href="#119-date-æ—¶é—´æ—¥æœŸæ–°çš„-api" class="hash-link" aria-label="Direct link to 11.9. date æ—¶é—´æ—¥æœŸæ–°çš„ api" title="Direct link to 11.9. date æ—¶é—´æ—¥æœŸæ–°çš„ api">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1191-ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨">11.9.1. ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨<a href="#1191-ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨" class="hash-link" aria-label="Direct link to 11.9.1. ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨" title="Direct link to 11.9.1. ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨">â€‹</a></h3><p>å¸æ”¶äº† <a href="http://www.joda.org/joda-time/" target="_blank" rel="noopener noreferrer">joda date api</a> è¿™ä¸ªå¼€æºå®ç°</p><p>ä¸ºä»€ä¹ˆä½¿ç”¨å‘¢:</p><ul><li><p>Java8 ä¹‹å‰æˆ‘ä»¬å¸¸ç”¨ SimpleDateFormat, Date, Calander, ç¹ç, è€Œä¸”çº¿ç¨‹ä¸å®‰å…¨</p></li><li><p>Java8 ä»¥å‰ä½¿ç”¨ new Date()è·å–æœˆæ—¶ï¼Œä» 0 å¼€å§‹ï¼Œæ¯æ¬¡éƒ½è¦+1ã€‚è·å–æœ¬æœˆæœ€åä¸€å¤©ï¼Œè¦åˆ†æƒ…å†µåˆ¤æ–­ 28ï¼Œ29ï¼Œ30ï¼Œ31</p></li><li><p>æ—¶åŒºå¤„ç†ä¸æ–¹ä¾¿</p></li></ul><p>LocalDateï¼ŒLocalTimeï¼ŒLocalDateTime.... , ä½äº java.time åŒ…ä¸‹, final ä¸å¯ç»§æ‰¿</p><ul><li>ZoneId: æ—¶åŒº IDï¼Œç”¨æ¥ç¡®å®š Instant å’Œ LocalDateTime äº’ç›¸è½¬æ¢çš„è§„åˆ™</li><li>Instant: ç”¨æ¥è¡¨ç¤ºæ—¶é—´çº¿ä¸Šçš„ä¸€ä¸ªç‚¹</li><li>LocalDate: è¡¨ç¤ºæ²¡æœ‰æ—¶åŒºçš„æ—¥æœŸ, LocalDate æ˜¯ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„</li><li>LocalTime: è¡¨ç¤ºæ²¡æœ‰æ—¶åŒºçš„æ—¶é—´, LocalTime æ˜¯ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„</li><li>LocalDateTime: è¡¨ç¤ºæ²¡æœ‰æ—¶åŒºçš„æ—¥æœŸæ—¶é—´, LocalDateTime æ˜¯ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„</li><li>ZonedDateTimeï¼šæœ€å®Œæ•´çš„æ—¥æœŸæ—¶é—´ï¼ŒåŒ…å«æ—¶åŒºå’Œç›¸å¯¹UTCæˆ–æ ¼æ—å¨æ²»çš„æ—¶å·®
ZoneOffSetå’ŒZoneIdç±»</li><li>Clock: ç”¨äºè®¿é—®å½“å‰æ—¶åˆ»ã€æ—¥æœŸã€æ—¶é—´ï¼Œç”¨åˆ°æ—¶åŒº</li><li>Duration: ç”¨ç§’å’Œçº³ç§’è¡¨ç¤ºæ—¶é—´çš„æ•°é‡</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1192-ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ-api">11.9.2. ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ api<a href="#1192-ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ-api" class="hash-link" aria-label="Direct link to 11.9.2. ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ api" title="Direct link to 11.9.2. ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ api">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// æ„é€ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate.now();  // è·å–å½“å‰æ—¥æœŸ format: yyyy-MM-dd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalTime.now();  // è·å–å½“å‰æ—¶é—´ format: HH:mm:ss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime.now();  // è·å–å½“å‰æ—¥æœŸæ—¶é—´ format: yyyy-MM-ddTHH:mm:ss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate.of(2017, 07, 20);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime.of(2017, Month.JULY, 20, 15, 18);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime.parse(&quot;2017-07-20T15:18:00&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate.parse(&quot;2017-07-20&quot;); // å¯ä¼ å…¥ formatter æŒ‡å®šæ ¼å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalTime nowTime = LocalTime.parse(&quot;15:02&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalTime nowTime = LocalTime.of(15, 02);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åŠ å‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate tomorrow = LocalDate.now().plusDays(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate prevMonth = LocalDate.now().minus(1, ChronoUnit.MONTHS);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¸€ä¸ªå°æ—¶åçš„æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalTime nextHour = LocalTime.parse(&quot;15:02&quot;).plus(1, ChronoUnit.HOURS);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime tomorrow = now.plusDays(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;æ˜å¤©çš„è¿™ä¸ªæ—¶é—´: &quot; + tomorrow);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime minusTowHour = now.minusHours(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;ä¸¤å°æ—¶å‰: &quot; + minusTowHour);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//è·å–æ—¶é—´, æ—¥æœŸ, æœˆä»½, æ˜ŸæœŸ, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¸€ç³»åˆ—çš„getæ–¹æ³•æ¥è·å–ç‰¹å®šå•ä½:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate date = LocalDate.parse(&quot;2017-07-20&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ˜ŸæœŸ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DayOfWeek thursday = date.getDayOfWeek();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;å‘¨å››: &quot; + thursday);// å‘¨å››: THURSDAY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ—¥æœŸ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int twenty = LocalDate.parse(&quot;2017-07-20&quot;).getDayOfMonth();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;twenty: &quot; + twenty);// twenty: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æœˆä»½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int month = date.getMonthValue()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Month month = now.getMonth();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¹´ä»½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int year = date.getYear()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è·å–æœ¬æœˆç¬¬ä¸€å¤©</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate firstDayOfMonth = LocalDate.parse(&quot;2017-07-20&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .with(TemporalAdjusters.firstDayOfMonth());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;è¿™ä¸ªæœˆçš„ç¬¬ä¸€å¤©: &quot; + firstDayOfMonth);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firstDayOfMonth = firstDayOfMonth.withDayOfMonth(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;è¿™ä¸ªæœˆçš„ç¬¬ä¸€å¤©: &quot; + firstDayOfMonth);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int hour = LocalTime.parse(&quot;15:02&quot;).getHour();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;å°æ—¶: &quot; + hour);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int minute = LocalTime.parse(&quot;15:02&quot;).getMinute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;åˆ†é’Ÿ: &quot; + minute);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ¯å¤©çš„å¼€å§‹ç»“æŸ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(LocalTime.MAX);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(LocalTime.MIN);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 23:59:59.999999999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ¯”è¾ƒæ—¥æœŸ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ˜¯å¦ç›¸ç­‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate date1 = LocalDate.of(2014, 01, 14);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if(date1.equals(today)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.printf(&quot;Today %s and date1 %s are same date %n&quot;, today, date1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åˆ¤æ–­æ˜¯å¦ä¹‹å‰ä¹‹å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean notBefore = LocalDate.parse(&quot;2017-07-20&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .isBefore(LocalDate.parse(&quot;2017-07-22&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;notBefore: &quot; + notBefore);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean isAfter = LocalDate.parse(&quot;2017-07-20&quot;).isAfter(LocalDate.parse(&quot;2017-07-22&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;isAfter: &quot; + isAfter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åˆ¤æ–­å‘¨æœŸæ€§äº‹ä»¶ (ä¸å¸¦å¹´ä»½çš„æ—¥æœŸ)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ç”Ÿæ—¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//åˆ¤æ–­ä»Šå¤©æ˜¯å¦æ˜¯æˆ‘çš„ç”Ÿæ—¥ï¼Œä¾‹å¦‚æˆ‘çš„ç”Ÿæ—¥æ˜¯ 2009-07-20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate birthday = LocalDate.of(2009, 07, 20);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// monthday è¡¨ç¤º ä¸å¸¦å¹´çš„æ—¥æœŸ, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//å¯ä»¥ç”¨å®ƒåˆ¤æ–­æ¯å¹´éƒ½ä¼šå‘ç”Ÿäº‹ä»¶, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MonthDay birthdayMd = MonthDay.of(birthday.getMonth(), birthday.getDayOfMonth());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MonthDay today = MonthDay.from(LocalDate.now());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;ä»Šå¤©æ˜¯å¦æ˜¯æˆ‘çš„ç”Ÿæ—¥: &quot; + today.equals(birthdayMd));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¿¡ç”¨å¡åˆ°æœŸ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// YearMonth ä¸å¸¦æ—¶é—´çš„å¹´æœˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">YearMonth currentYearMonth = YearMonth.now();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.printf(&quot;current year-month is %s, has %d days&quot;, currentYearMonth, currentYearMonth.lengthOfMonth());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">YearMonth creditCardExpiry = YearMonth.of(2018, Month.FEBRUARY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.printf(&quot;Your credit card expires on %s &quot;, creditCardExpiry);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// current year-month is 2014-01: has 31 days</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Your credit card expires on 2018-02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ˜¯å¦é—°å¹´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean leapYear = LocalDate.now().isLeapYear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;æ˜¯å¦é—°å¹´: &quot; + leapYear);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">////////////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// é—´éš”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">////Periodç±»è¡¨ç¤ºä¸€æ®µæ—¶é—´, ç”¨äºä¿®æ”¹ç»™å®šæ—¥æœŸæˆ–è·å¾—çš„ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate initialDate = LocalDate.parse(&quot;2017-07-20&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate finalDate   = initialDate.plus(Period.ofDays(5));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;åˆå§‹åŒ–æ—¥æœŸ: &quot; + initialDate);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;åŠ æ—¥æœŸä¹‹å: &quot; + finalDate);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate java8Release = LocalDate.of(2014, Month.MARCH, 14);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Period periodToNextJavaRelease = Period.between(today, java8Release);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;Months left between today and Java 8 release : &quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   + periodToNextJavaRelease.getMonths() );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Months left between today and Java 8 release : 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final long duration = Duration.between(LocalDateTime.now(), latestTime.toInstant()).getSeconds();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//////////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">////////////////////////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ ¼å¼åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime now = LocalDateTime.now();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;é»˜è®¤æ ¼å¼åŒ–: &quot; + now);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;è‡ªå®šä¹‰æ ¼å¼åŒ–: &quot; + now.format(dateTimeFormatter));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime localDateTime = LocalDateTime.parse(&quot;2017-07-20 15:27:44&quot;, dateTimeFormatter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;å­—ç¬¦ä¸²è§£æ LocalDateTime: &quot; + localDateTime);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String dateString = dateTimeFormatter.format(LocalDate.now());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;æ—¥æœŸè½¬å­—ç¬¦ä¸²: &quot; + dateString);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¸é—ç•™ä»£ç è½¬æ¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Dateå’ŒInstantäº’ç›¸è½¬æ¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date date = Date.from(Instant.now());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Instant instant = date.toInstant();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Dateè½¬æ¢ä¸ºLocalDateTime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date startDate=new Date();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime localDateTime = startDate.toInstant()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .atZone(ZoneId.systemDefault())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .toLocalDateTime()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// LocalDateTimeè½¬Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date date =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// LocalDateè½¬Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date date =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Date.from(LocalDate.now().atStartOfDay().atZone(ZoneId.systemDefault()).toInstant());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Instant timestamp = Instant.now();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;What is value of this instant &quot; + timestamp);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// What is value of this instant 2014-01-14T08:33:33.379Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Clockæ—¶é’Ÿç±» </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//ç”¨äºè·å–å½“æ—¶çš„æ—¶é—´æˆ³ï¼Œæˆ–å½“å‰æ—¶åŒºä¸‹çš„æ—¥æœŸæ—¶é—´ä¿¡æ¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// System.currentTimeMillis()å’ŒTimeZone.getDefault()çš„åœ°æ–¹éƒ½å¯ç”¨Clockæ›¿æ¢ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void clock(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ ¹æ®ç³»ç»Ÿæ—¶é—´è¿”å›å½“å‰æ—¶é—´å¹¶è®¾ç½®ä¸ºUTCã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Clock clock = Clock.systemUTC();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;Clock : &quot; + clock);//Clock : SystemClock[Z]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ ¹æ®ç³»ç»Ÿæ—¶é’ŸåŒºåŸŸè¿”å›æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Clock defaultClock = Clock.systemDefaultZone();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;Clock : &quot; + clock);//Clock : SystemClock[Z]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //æŒ‡å®šæ—¶åŒº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LocalDate.now(clock)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///////////////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ—¶åŒºå’Œæ—¶å·®:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//æ—¶åŒº: ä»£è¡¨äº†åœ°çƒä¸ŠæŸä¸ªåŒºåŸŸå†…æ™®éä½¿ç”¨çš„æ ‡å‡†æ—¶é—´ã€‚æ¯ä¸ªæ—¶åŒºéƒ½æœ‰ä¸€ä¸ªä»£å·ï¼Œæ ¼å¼é€šå¸¸ç”±åŒºåŸŸ/åŸå¸‚æ„æˆï¼ˆAsia/Tokyoï¼‰ï¼Œåœ¨åŠ ä¸Šä¸æ ¼æ—å¨æ²»æˆ– UTCçš„æ—¶å·®ã€‚ä¾‹å¦‚ï¼šä¸œäº¬çš„æ—¶å·®æ˜¯+09:00ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//æ—¶å·®: OffsetDateTimeç±»å®é™…ä¸Šç»„åˆäº†LocalDateTimeç±»å’ŒZoneOffsetç±»ã€‚ç”¨æ¥è¡¨ç¤ºåŒ…å«å’Œæ ¼æ—å¨æ²»æˆ–UTCæ—¶å·®çš„å®Œæ•´æ—¥æœŸï¼ˆå¹´ã€æœˆã€æ—¥ï¼‰å’Œæ—¶é—´ï¼ˆæ—¶ã€åˆ†ã€ç§’ã€çº³ç§’ï¼‰ä¿¡æ¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// OffSetDateTimeæ˜¯å¯¹è®¡ç®—æœºå‹å¥½çš„ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ZoneDateTimeåˆ™å¯¹äººæ›´å‹å¥½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¤„ç†æ—¶åŒº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZoneId america = ZoneId.of(&quot;America/New_York&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime localtDateAndTime = LocalDateTime.now();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZonedDateTime dateAndTimeInNewYork  = ZonedDateTime.of(localtDateAndTime, america );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;Current date and time in a particular timezone : &quot; + dateAndTimeInNewYork);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Current date and time in a particular timezone : 2014-01-14T16:33:33.373-05:00[America/New_York]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ—¶å·®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime datetime = LocalDateTime.of(2014, Month.JANUARY, 14, 19, 30);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZoneOffset offset = ZoneOffset.of(&quot;+05:30&quot;);//å°åº¦ä¸GMTæˆ–UTCæ ‡å‡†æ—¶åŒºç›¸å·®+05:30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OffsetDateTime date = OffsetDateTime.of(datetime, offset);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;Date and Time with timezone offset in Java : &quot; + date);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Date and Time with timezone offset in Java : 2014-01-14T19:30+05:30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1193-ç»Ÿè®¡ä»£ç è€—æ—¶">11.9.3. ç»Ÿè®¡ä»£ç è€—æ—¶<a href="#1193-ç»Ÿè®¡ä»£ç è€—æ—¶" class="hash-link" aria-label="Direct link to 11.9.3. ç»Ÿè®¡ä»£ç è€—æ—¶" title="Direct link to 11.9.3. ç»Ÿè®¡ä»£ç è€—æ—¶">â€‹</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ä¸ç³»ç»Ÿæ—¶é—´å®Œå…¨æ— å…³ï¼Œç›®çš„ä¹Ÿæ­£æ˜¯ç”¨æ¥ç»Ÿè®¡ç¨‹åºè€—æ—¶çš„ã€‚nanoTime()è®°å½•çš„æ˜¯ä»æŸä¸ªå›ºå®šçš„æ—¶åˆ»èµ·ï¼Œåˆ°ç°åœ¨ç»è¿‡äº†å¤šå°‘çº³ç§’ã€‚ä½†æ˜¯è¿™ä¸ªå›ºå®šçš„æ—¶åˆ»ä¸æ˜¯Unixæ—¶é—´æˆ³çš„1970-1-1 00:00:00ï¼Œè€Œæ˜¯å¯åŠ¨è™šæ‹Ÿæœºæ—¶ç”Ÿæˆçš„ä¸€ä¸ªå›ºå®šæ—¶åˆ»ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºçš„ç”Ÿæˆçš„è¿™ä¸ªæ—¶é—´éƒ½æ˜¯ä¸åŒçš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nanoTime()è™½ç„¶ç²¾ç¡®åˆ°çº³ç§’ï¼Œä½†äº‹å®å¹¶ä¸æ˜¯æ¯çº³ç§’éƒ½è·³åŠ¨ä¸€æ ¼ï¼Œè€Œæ˜¯å¯èƒ½åœ¨3çº³ç§’ä¹‹åï¼Œä¸€ä¸‹è·³åŠ¨3æ ¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long start = System.nonoTime();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¸šåŠ¡é€»è¾‘ä»£ç ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long end = System.nonoTime();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long timeElapsed = finish - end; // å•ä½ä¸ºçº³ç§’</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Instant start = Instant.now();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¸šåŠ¡é€»è¾‘ä»£ç ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Instant end = Instant.now();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long timeElapsed = Duration.between(start, finish).toMillis(); // å•ä½ä¸ºæ¯«ç§’</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;version&gt;3.7&lt;/version&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StopWatch watch = new StopWatch();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">watch.start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¸šåŠ¡é€»è¾‘ä»£ç ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">watch.stop();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;Time Elapsed: &quot; + watch.getTime() + &quot;ms&quot;); // å•ä½ä¸ºæ¯«ç§’</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1110-å¯é‡å¤çš„-annotations">11.10. å¯é‡å¤çš„ Annotations<a href="#1110-å¯é‡å¤çš„-annotations" class="hash-link" aria-label="Direct link to 11.10. å¯é‡å¤çš„ Annotations" title="Direct link to 11.10. å¯é‡å¤çš„ Annotations">â€‹</a></h2><p>åœ¨ Java8 ä¸­æ³¨è§£æ˜¯å¯ä»¥é‡å¤çš„</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@interface Hint {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String value();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Target({ ElementType.METHOD, ElementType.FIELD, ElementType.ANNOTATION_TYPE, ElementType.CONSTRUCTOR,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ElementType.PARAMETER })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Retention(RetentionPolicy.RUNTIME)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Documented</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public @interface Hints {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Hint[] value();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ•ˆæœåŒä¸Š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Repeatable(Hints.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@interface Hint {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String value();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1111-base64-ç¼–ç ">11.11. base64 ç¼–ç <a href="#1111-base64-ç¼–ç " class="hash-link" aria-label="Direct link to 11.11. base64 ç¼–ç " title="Direct link to 11.11. base64 ç¼–ç ">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final Base64.Decoder decoder = Base64.getDecoder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final Base64.Encoder encoder = Base64.getEncoder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final String text = &quot;å­—ä¸²æ–‡å­—&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final byte[] textByte = text.getBytes(&quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//ç¼–ç </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final String encodedText = encoder.encodeToString(textByte);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(encodedText);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//è§£ç </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(new String(decoder.decode(encodedText), &quot;UTF-8&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1112-map-æ˜ å°„çš„æ–°æ–¹æ³•">11.12. map æ˜ å°„çš„æ–°æ–¹æ³•<a href="#1112-map-æ˜ å°„çš„æ–°æ–¹æ³•" class="hash-link" aria-label="Direct link to 11.12. map æ˜ å°„çš„æ–°æ–¹æ³•" title="Direct link to 11.12. map æ˜ å°„çš„æ–°æ–¹æ³•">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// &gt;&gt;&gt; compute å¯¹keyå­˜åœ¨çš„å…ƒç´ è¿›è¡ŒåŠ å·¥ï¼Œå¹¶è¿”å›åŠ å·¥åçš„å…ƒç´ ï¼ŒåŒæ—¶mapä¸­è¯¥å…ƒç´ ä¹Ÿè¢«æ›¿æ¢æˆåŠ å·¥åçš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue a1 = new KeyAndValue().setName(&quot;kevin&quot;).setValue(&quot;lee&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue a5 = new KeyAndValue().setName(&quot;kevin2&quot;).setValue(&quot;lee5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue a6 = new KeyAndValue().setName(&quot;kevin3&quot;).setValue(&quot;lee8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, KeyAndValue&gt; maps = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">maps.put(&quot;a&quot;,a1); //{a=KeyAndValue(name=kevin, value=lee)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//keyå­˜åœ¨æ—¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue compute1 = maps.compute(&quot;a&quot;, (k, old) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Optional.ofNullable(old).ifPresent(v -&gt; v.setValue(old.getValue().concat(&quot;__ddddd&quot;)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return v;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(compute1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// KeyAndValue(name=kevin, value=lee__ddddd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(maps);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// {a=KeyAndValue(name=kevin, value=lee__ddddd)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// keyä¸å­˜åœ¨æ—¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue compute = maps.compute(&quot;b&quot;, (k, v) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Optional.ofNullable(v).ifPresent(v1 -&gt; v1.setValue(v.getValue().concat(&quot;__ddddd&quot;)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return v;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(compute);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(maps);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// {a=KeyAndValue(name=kevin, value=lee__ddddd)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// &gt;&gt;&gt; é’ˆå¯¹valueä¸å­˜åœ¨å’Œå­˜åœ¨ï¼Œä¹Ÿæœ‰é’ˆå¯¹æ€§çš„æ–¹æ³•ï¼ˆcomputeIfAbsentå’ŒcomputeIfPresentï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//computeIfAbsent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// keyä¸å­˜åœ¨æˆ–nullï¼Œåˆ™ä¼šå¤„ç†ï¼Œè¿”å›å¤„ç†åç»“æœï¼Œå¹¶æ›´æ–°value (å³, key, å’Œ newValue ä¼š mapping ä¸Š)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// keyå­˜åœ¨ï¼Œåˆ™ä¸ä¼šè¿›è¡Œå¤„ç†ï¼Œè¿”å›valueï¼Œä¸æ›´æ–°map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//computeIfPresent ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// keyå­˜åœ¨åˆ™å¤„ç†ï¼Œè¿”å›å¤„ç†åç»“æœï¼Œå¹¶æ›´æ–°value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// keyä¸å­˜åœ¨æˆ–nullï¼Œåˆ™ä¸è¿›è¡Œå¤„ç†ï¼Œè¿”å›nullï¼Œä¸æ›´æ–°value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, KeyAndValue&gt; map = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(map);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue computeIfAbsent = map.computeIfAbsent(&quot;a&quot;, k -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return a6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(computeIfAbsent);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// KeyAndValue(name=kevin3, value=lee8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(map);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// {a=KeyAndValue(name=kevin3, value=lee8)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// &gt;&gt;&gt;merge:å¯¹keyå­˜åœ¨çš„å…ƒç´ è¿›è¡Œåˆå¹¶æ–°å…ƒç´ ï¼Œå¹¶è¿”å›åŠ å·¥åçš„å…ƒç´ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, KeyAndValue&gt; map = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;a&quot;,a1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(map);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// {a=KeyAndValue(name=kevin, value=lee)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//â€œaâ€æœ‰å€¼ï¼Œåˆ™åˆå¹¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//a6å°±æ˜¯åˆè¿›æ¥çš„æ–°å€¼ï¼Œa6å’ŒnewVæ˜¯åŒä¸€å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//oldVæ˜¯mapä¸­åŸæœ‰keyå¯¹åº”çš„å€¼ï¼ŒoldVæœ‰å€¼åˆ™åˆå¹¶ï¼Œæ— å€¼åˆ™æ–°å¢å¯¹åº”çš„kå’Œvalue=newVçš„é”®å€¼å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue merge = map.merge(&quot;a&quot;, a6, (oldV, newV) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    oldV.setValue(newV.getValue()+&quot;___&quot;+oldV.getValue());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return oldV;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(merge);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// KeyAndValue(name=kevin, value=lee8___lee)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(map);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// {a=KeyAndValue(name=kevin, value=lee8___lee)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//â€œbâ€æ— å€¼ï¼Œåˆ™æ–°å¢&quot;b&quot;:newV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyAndValue merge1 = map.merge(&quot;b&quot;, a5, (oldV, newV) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    oldV.setValue(oldV.getValue()+&quot;___&quot;+oldV.getValue());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return oldV;    //a5å°±æ˜¯åˆè¿›æ¥çš„æ–°å€¼ï¼Œa5å’ŒnewVæ˜¯åŒä¸€å¯¹è±¡ï¼Œæ‰€ä»¥newVå’Œa5å¯äº’æ¢ï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // oldVæ˜¯mapä¸­åŸæœ‰key=â€œbâ€å¯¹åº”çš„å€¼ï¼ŒoldVæœ‰å€¼åˆ™åˆå¹¶ï¼Œæ— å€¼åˆ™æ–°å¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(merge1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// KeyAndValue(name=kevin2, value=lee5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(map);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// {a=KeyAndValue(name=kevin, value=lee), b=KeyAndValue(name=kevin2, value=lee5)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>12. java11</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="121-java-module">12.1. java module<a href="#121-java-module" class="hash-link" aria-label="Direct link to 12.1. java module" title="Direct link to 12.1. java module">â€‹</a></h2><p>Java æ¨¡å—åŒ–å¼€å‘: å¢åŠ äº†æ›´é«˜çº§åˆ«çš„èšåˆï¼Œæ˜¯Packageçš„å°è£…ä½“</p><p>java9ä»¥å‰ ï¼špackage =&gt; class/interfaceã€‚
java9ä»¥å ï¼šmodule =&gt; package =&gt; class/interfaceã€‚</p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿ
å¤§å®¶éƒ½çŸ¥é“JREä¸­æœ‰ä¸€ä¸ªè¶…çº§å¤§çš„rt.jar(60å¤šM)ï¼Œtools.jarä¹Ÿæœ‰å‡ åå…†ï¼Œä»¥å‰è¿è¡Œä¸€ä¸ªhello worldä¹Ÿéœ€è¦ä¸Šç™¾å…†çš„ç¯å¢ƒã€‚</p><ul><li>æ›´åŠ å®¹æ˜“è½»é‡çº§éƒ¨ç½²</li><li>åœ¨ package ä¹‹ä¸Š, å¢åŠ äº†ä¸€ä¸ªæ›´é«˜å±‚çº§çš„å°è£…</li></ul><p><code>java --list-modules</code> æŸ¥çœ‹jdkè¢«åˆ†æ‹†ä¸ºå“ªäº› module</p><p>æ¨¡å—çš„æ˜¯é€šè¿‡module-info.javaè¿›è¡Œå®šä¹‰ï¼Œç¼–è¯‘åæ‰“åŒ…åï¼Œå°±æˆä¸ºä¸€ä¸ªæ¨¡å—çš„å®ä½“</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// open ç”¨æ¥æŒ‡å®šå¼€æ”¾æ¨¡å—,å¼€æ”¾æ¨¡å—çš„æ‰€æœ‰åŒ…éƒ½æ˜¯å…¬å¼€çš„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open module module.one {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¯¼å…¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // opens ç”¨æ¥æŒ‡å®šå¼€æ”¾çš„åŒ…</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    opens java.logging;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å£°æ˜ä¾èµ–å…³ç³», opens resuires xxx äº¦å¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requires java.logging;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module module.one {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> exports &lt;package&gt;;//exportsç”¨äºæŒ‡å®šæ¨¡å—ä¸‹çš„å“ªäº›åŒ…å¯ä»¥è¢«å…¶ä»–æ¨¡å—è®¿é—®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> exports &lt;package&gt; to &lt;module1&gt;, &lt;module2&gt;...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//usesè¯­å¥ä½¿ç”¨æœåŠ¡æ¥å£çš„åå­—,å½“å‰æ¨¡å—å°±ä¼šå‘ç°å®ƒ,ä½¿ç”¨java.util.ServiceLoaderç±»è¿›è¡ŒåŠ è½½,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module module.one {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> //å¯¹å¤–æä¾›çš„æ¥å£æœåŠ¡ ,ä¸‹é¢æŒ‡å®šçš„æ¥å£ä»¥åŠæä¾›æœåŠ¡çš„implï¼Œå¦‚æœæœ‰å¤šä¸ªå®ç°ç±»ï¼Œç”¨ç”¨é€—å·éš”å¼€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> uses &lt;æ¥å£å&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> provides &lt;æ¥å£å&gt; with &lt;æ¥å£å®ç°ç±»&gt;,&lt;æ¥å£å®ç°ç±»&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><a href="https://www.zhihu.com/question/40413806/answer/135807272" target="_blank" rel="noopener noreferrer">ä¸ºä»€ä¹ˆ Java 9 æ¨¡å—åŒ–ä½¿ç”¨ Jigsaw è€Œä¸æ˜¯ OSGiï¼Ÿ</a></li><li><a href="http://www.cnblogs.com/chenjianjx/archive/2012/05/24/2516620.html" target="_blank" rel="noopener noreferrer">osgi å…¥é—¨</a> , <a href="https://www.cnblogs.com/zhangpan1244/p/11677705.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/zhangpan1244/p/11677705.html</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="122-jshell">12.2. jshell<a href="#122-jshell" class="hash-link" aria-label="Direct link to 12.2. jshell" title="Direct link to 12.2. jshell">â€‹</a></h2><p>some classes already import into the console</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="123-var-ç±»å‹æ¨æ–­">12.3. var ç±»å‹æ¨æ–­<a href="#123-var-ç±»å‹æ¨æ–­" class="hash-link" aria-label="Direct link to 12.3. var ç±»å‹æ¨æ–­" title="Direct link to 12.3. var ç±»å‹æ¨æ–­">â€‹</a></h2><p>å±€éƒ¨ç±»å‹å˜é‡æ¨æ–­ã€‚å®ƒä¼šæ ¹æ®åé¢çš„å€¼æ¥æ¨æ–­å˜é‡çš„ç±»å‹ï¼Œæ‰€ä»¥varå¿…é¡»è¦åˆå§‹åŒ–ã€‚</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var a = 1; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ç­‰äº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int a = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>varä¸èƒ½å†å“ªé‡Œä½¿ç”¨ï¼Ÿ</p><p>ç±»æˆå‘˜å˜é‡ç±»å‹ã€‚
æ–¹æ³•è¿”å›å€¼ç±»å‹ã€‚
Java10ä¸­Lambdaä¸èƒ½ä½¿ç”¨varï¼ŒJava11ä¸­å¯ä»¥ä½¿ç”¨ã€‚</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="124-jdk-api-enhencement">12.4. jdk api enhencement<a href="#124-jdk-api-enhencement" class="hash-link" aria-label="Direct link to 12.4. jdk api enhencement" title="Direct link to 12.4. jdk api enhencement">â€‹</a></h2><p>string å¢å¼º: åˆ¤æ–­æ˜¯å¦ç©ºç™½, å»é™¤ç©ºæ ¼...
é›†åˆå¢å¼º: of, copyOf, create immutable collection
stream å’Œ option å¢å¼º: å¯ä»¥ç›¸äº’è½¬æ¢, </p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot; &quot;.isBlank(); // true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å»é™¤é¦–å°¾ç©ºæ ¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot; Hello Java11 &quot;.strip(); // &quot;Hello Java11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å»é™¤å°¾éƒ¨ç©ºæ ¼ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot; Hello Java11 &quot;.stripTrailing(); // &quot; Hello Java11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å»é™¤é¦–éƒ¨ç©ºæ ¼ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot; Hello Java11 &quot;.stripLeading(); // &quot;Hello Java11 &quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¤åˆ¶å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Java11&quot;.repeat(3); // &quot;Java11Java11Java11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¡Œæ•°ç»Ÿè®¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;A\nB\nC&quot;.lines().count(); // 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//åˆ›å»ºä¸å¯å˜é›†åˆã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var list = List.of(&quot;Java&quot;, &quot;Python&quot;, &quot;C&quot;); //ä¸å¯å˜é›†åˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var copy = List.copyOf(list); //copyOfåˆ¤æ–­æ˜¯å¦æ˜¯ä¸å¯å˜é›†åˆç±»å‹ï¼Œå¦‚æœæ˜¯ç›´æ¥è¿”å›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> System.out.println(list == copy); // true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var list = new ArrayList&lt;String&gt;(); // è¿™é‡Œè¿”å›æ­£å¸¸çš„é›†åˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var copy = List.copyOf(list); // è¿™é‡Œè¿”å›ä¸€ä¸ªä¸å¯å˜é›†åˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> System.out.println(list == copy); // false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ä»¥å‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream.of(null); //æŠ¥é”™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ç°åœ¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream.ofNullable(null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// http client æ”¯æŒåŒæ­¥å¼‚æ­¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var request = HttpRequest.newBuilder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> .uri(URI.create(&quot;https://www.baidu.com/&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var client = HttpClient.newHttpClient();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // åŒæ­¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> System.out.println(response.body());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // å¼‚æ­¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> CompletableFuture&lt;HttpResponse&lt;String&gt;&gt; sendAsync = client.sendAsync(request, HttpResponse.BodyHandlers.ofString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> //è¿™é‡Œä¼šé˜»å¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> HttpResponse&lt;String&gt; response1 = sendAsync.get();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> System.out.println(response1.body());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="125-æ”¹è¿›-java-ç¨‹åºåœ¨-docker-ä¸­çš„è¡¨ç°">12.5. æ”¹è¿› java ç¨‹åºåœ¨ docker ä¸­çš„è¡¨ç°<a href="#125-æ”¹è¿›-java-ç¨‹åºåœ¨-docker-ä¸­çš„è¡¨ç°" class="hash-link" aria-label="Direct link to 12.5. æ”¹è¿› java ç¨‹åºåœ¨ docker ä¸­çš„è¡¨ç°" title="Direct link to 12.5. æ”¹è¿› java ç¨‹åºåœ¨ docker ä¸­çš„è¡¨ç°">â€‹</a></h2><p>JVMç°åœ¨å¯ä»¥è¯†åˆ«ç”±å®¹å™¨æ§åˆ¶ç»„ï¼ˆcgroupsï¼‰è®¾ç½®çš„çº¦æŸã€‚å¯ä»¥åœ¨å®¹å™¨ä¸­ä½¿ç”¨å†…å­˜å’ŒCPUçº¦æŸæ¥ç›´æ¥ç®¡ç†Javaåº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š</p><p>éµå®ˆå®¹å™¨ä¸­è®¾ç½®çš„å†…å­˜é™åˆ¶
åœ¨å®¹å™¨ä¸­è®¾ç½®å¯ç”¨çš„CPU
åœ¨å®¹å™¨ä¸­è®¾ç½®CPUçº¦æŸ</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="126-æ–°çš„åƒåœ¾å›æ”¶å™¨">12.6. æ–°çš„åƒåœ¾å›æ”¶å™¨<a href="#126-æ–°çš„åƒåœ¾å›æ”¶å™¨" class="hash-link" aria-label="Direct link to 12.6. æ–°çš„åƒåœ¾å›æ”¶å™¨" title="Direct link to 12.6. æ–°çš„åƒåœ¾å›æ”¶å™¨">â€‹</a></h2><h1>13. classloader ç±»åŠ è½½å™¨</h1><p><a href="https://www.cnblogs.com/doit8791/p/5820037.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/doit8791/p/5820037.html</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="131-classloader-çš„æ¦‚å¿µ">13.1. classloader çš„æ¦‚å¿µ<a href="#131-classloader-çš„æ¦‚å¿µ" class="hash-link" aria-label="Direct link to 13.1. classloader çš„æ¦‚å¿µ" title="Direct link to 13.1. classloader çš„æ¦‚å¿µ">â€‹</a></h2><p>ç±»åŠ è½½å™¨ï¼ˆclass loaderï¼‰ç”¨æ¥åŠ è½½ Java ç±»åˆ° Java è™šæ‹Ÿæœºä¸­ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒClassLoader è¿˜è´Ÿè´£åŠ è½½ Java åº”ç”¨æ‰€éœ€çš„èµ„æºï¼Œå¦‚å›¾åƒæ–‡ä»¶å’Œé…ç½®æ–‡ä»¶ç­‰</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="132-å±‚çº§ç»“æ„">13.2. å±‚çº§ç»“æ„<a href="#132-å±‚çº§ç»“æ„" class="hash-link" aria-label="Direct link to 13.2. å±‚çº§ç»“æ„" title="Direct link to 13.2. å±‚çº§ç»“æ„">â€‹</a></h2><p>æ ‘çŠ¶ç»“æ„:</p><p>åˆ†ç±». <!-- -->[çˆ¶ -&gt; å­ å…³ç³»]<!-- -->æ˜¯è¿™æ ·çš„: å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆbootstrap class loaderï¼‰-&gt; æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆextensions class loaderï¼‰ -&gt; ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆsystem class loaderï¼‰ -&gt; user-defined classloader</p><ul><li><p>ç³»ç»Ÿ(jvm) æä¾›çš„ classloader</p><ul><li><p>å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆbootstrap class loaderï¼‰ï¼šå®ƒç”¨æ¥åŠ è½½ Java çš„æ ¸å¿ƒåº“ (rt.jar ä¸­çš„æ‰€æœ‰ class)ï¼Œç”± C++ç¼–å†™çš„ï¼Œå®ƒæœ¬èº«æ˜¯è™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ª JAVA ç±»ï¼Œå¹¶ä¸ç»§æ‰¿è‡ª java.lang.ClassLoader, æ²¡æœ‰ parent</p></li><li><p>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆextensions class loaderï¼‰ï¼š <code>ExtClassLoader</code>, å®ƒç”¨æ¥åŠ è½½ Java çš„æ‰©å±•åº“(Java è™šæ‹Ÿæœºçš„å®ç°ä¼šæä¾›ä¸€ä¸ªæ‰©å±•åº“ç›®å½•, è¯¥ç±»åŠ è½½å™¨åœ¨æ­¤ç›®å½•é‡Œé¢æŸ¥æ‰¾å¹¶åŠ è½½ Java ç±»)ã€‚</p></li><li><p>ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆapp class loaderï¼‰ï¼š <code>AppClassLoader</code>, å®ƒæ ¹æ® Java åº”ç”¨çš„ç±»è·¯å¾„ï¼ˆCLASSPATHï¼‰æ¥åŠ è½½ Java ç±»ã€‚Java åº”ç”¨çš„ç±»éƒ½æ˜¯ç”±å®ƒæ¥å®ŒæˆåŠ è½½çš„ã€‚å¯ä»¥é€šè¿‡ <code>ClassLoader.getSystemClassLoader()</code>æ¥è·å–å®ƒã€‚</p></li><li><p>è‡ªå®šä¹‰çš„ classloader - é€šè¿‡ç»§æ‰¿ <code>java.lang.ClassLoader</code>æŠ½è±¡ç±»çš„æ–¹å¼å®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨, å¯ä»¥ç”¨æ¥<code>åŠ è½½ é classpath ä¸­çš„ jar å’Œ ç›®å½• (æ¯”å¦‚ä»ç½‘ç»œä¸‹è½½)</code>, <code>åœ¨åŠ è½½ class å‰ åšå…¶ä»–äº‹æƒ…, å¦‚è§£å¯†</code> , <code>å®ç°ç±»éš”ç¦»</code> (è¿è¡Œå¤šä¸ªä¸åŒç‰ˆæœ¬çš„ jar åŒ…, check <a href="https://blog.csdn.net/t894690230/article/details/73252331" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/t894690230/article/details/73252331</a>)</p><ul><li><p>loadClass æ–¹æ³• - åŠ è½½æŒ‡å®šåç§°çš„ç±», (å¦ä¸€ç§åŠ è½½ class çš„æ–¹æ³• <code>Class.forName</code> å¯åŠ¨è¿™ä¸ªåŠ è½½è¿‡ç¨‹æ˜¯é€šè¿‡è°ƒç”¨ <code>loadClass</code>æ¥å®ç°çš„, ç§°ä¸ºåˆå§‹åŠ è½½å™¨ï¼ˆinitiating loaderï¼‰)</p></li><li><p>findLoadedClass æ–¹æ³• - ä»å½“å‰ classloader å®ä¾‹çš„ç¼“å­˜ä¸­å¯»æ‰¾å·²ç»åŠ è½½çš„ç±»</p></li><li><p><code>findClassæ–¹æ³•</code> - åªéœ€è¦è¦†ç›–è¿™ä¸ªæ–¹æ³•, è‡ªå®šä¹‰åŠ è½½é€»è¾‘, å…¶ä»–æ–¹æ³•ä¸åŠ¨;</p></li><li><p>defineClass æ–¹æ³• - å°† class å­—èŠ‚ç è½¬æ¢ä¸º Class å¯¹è±¡ (çœŸæ­£å®Œæˆç±»çš„åŠ è½½å·¥ä½œæ˜¯é€šè¿‡è°ƒç”¨ <code>defineClass</code>æ¥å®ç°çš„, ç§°ä¸ºä¸€ä¸ªç±»çš„å®šä¹‰åŠ è½½å™¨ï¼ˆdefining loaderï¼‰)</p></li><li><p>defineClass() å’Œ loadClass() ä¸¤ç§åŠ è½½æ–¹å¼çš„å…³è”ä¹‹å¤„åœ¨äºï¼šä¸€ä¸ªç±»çš„å®šä¹‰åŠ è½½å™¨æ˜¯å®ƒå¼•ç”¨çš„å…¶å®ƒç±»çš„åˆå§‹åŠ è½½å™¨ã€‚å¦‚ç±» com.example.Outer å¼•ç”¨äº†ç±» com.example.Innerï¼Œåˆ™ç”±ç±» com.example.Outer çš„å®šä¹‰åŠ è½½å™¨è´Ÿè´£å¯åŠ¨ç±» com.example.Inner çš„åŠ è½½è¿‡ç¨‹ã€‚</p></li></ul></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="133-å·¥ä½œè¿‡ç¨‹-and-åŒäº²å§”æ´¾æ¨¡å¼">13.3. å·¥ä½œè¿‡ç¨‹ and åŒäº²å§”æ´¾æ¨¡å¼<a href="#133-å·¥ä½œè¿‡ç¨‹-and-åŒäº²å§”æ´¾æ¨¡å¼" class="hash-link" aria-label="Direct link to 13.3. å·¥ä½œè¿‡ç¨‹ and åŒäº²å§”æ´¾æ¨¡å¼" title="Direct link to 13.3. å·¥ä½œè¿‡ç¨‹ and åŒäº²å§”æ´¾æ¨¡å¼">â€‹</a></h2><ol><li><p>Java æºç¨‹åºï¼ˆ.java æ–‡ä»¶ï¼‰åœ¨ç»è¿‡ Java ç¼–è¯‘å™¨ç¼–è¯‘ä¹‹åå°±è¢«è½¬æ¢æˆ Java å­—èŠ‚ä»£ç ï¼ˆ.class æ–‡ä»¶ï¼‰ã€‚</p></li><li><p>ç±»åŠ è½½å™¨è´Ÿè´£è¯»å– Java å­—èŠ‚ä»£ç ï¼Œå¹¶è½¬æ¢æˆ java.lang.Class ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚æ¯ä¸ªè¿™æ ·çš„å®ä¾‹ç”¨æ¥è¡¨ç¤ºä¸€ä¸ª Java ç±»ã€‚é€šè¿‡æ­¤å®ä¾‹çš„<code>newInstance()</code>æ–¹æ³•å°±å¯ä»¥åˆ›å»ºå‡ºè¯¥ç±»çš„ä¸€ä¸ªå¯¹è±¡</p><ol><li><p>ç±»åŠ è½½å™¨åœ¨å°è¯• è‡ªå·±å»æŸ¥æ‰¾æŸä¸ªç±»çš„å­—èŠ‚ä»£ç å¹¶å®šä¹‰å®ƒ ä¹‹å‰, ä¼šå…ˆå°è¯•é€šè¿‡ parent classloader åŠ è½½ï¼Œå¦‚æœæ— æ³•åŠ è½½ï¼Œä¾æ¬¡ç±»æ¨ -- <code>classloaderçš„åŒäº²å§”æ´¾æ¨¡å¼</code> , ç”±äº <!-- -->[åŒäº²å§”æ´¾æ¨¡å¼]<!-- -->, çœŸæ­£å®Œæˆç±»çš„åŠ è½½å·¥ä½œçš„ç±»åŠ è½½å™¨å’Œå¯åŠ¨è¿™ä¸ªåŠ è½½è¿‡ç¨‹çš„ç±»åŠ è½½å™¨ï¼Œæœ‰å¯èƒ½ä¸æ˜¯åŒä¸€ä¸ª;</p></li><li><p>ä¸ºä»€ä¹ˆè¦æœ‰ classloader åŒäº²å§”æ´¾æ¨¡å¼çš„è®¾è®¡? ------- ä¸ºäº†ä¿è¯ Java æ ¸å¿ƒåº“çš„ç±»å‹å®‰å…¨ (ä¸¾ä¸ªä¾‹å­ ğŸŒ° -&gt; æ‰€æœ‰ Java åº”ç”¨éƒ½è‡³å°‘éœ€è¦å¼•ç”¨ java.lang.Object ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œjava.lang.Object è¿™ä¸ªç±»éœ€è¦è¢«åŠ è½½åˆ° Java è™šæ‹Ÿæœºä¸­ã€‚å¦‚æœè¿™ä¸ªåŠ è½½è¿‡ç¨‹ç”± Java åº”ç”¨è‡ªå·±çš„ç±»åŠ è½½å™¨æ¥å®Œæˆçš„è¯ï¼Œå¾ˆå¯èƒ½å°±å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„ java.lang.Object ç±»ï¼Œè€Œä¸”è¿™äº›ç±»ä¹‹é—´æ˜¯ä¸å…¼å®¹çš„ã€‚é€šè¿‡ä»£ç†æ¨¡å¼ï¼Œå¯¹äº Java æ ¸å¿ƒåº“çš„ç±»çš„åŠ è½½å·¥ä½œç”±å¼•å¯¼ç±»åŠ è½½å™¨æ¥ç»Ÿä¸€å®Œæˆï¼Œä¿è¯äº† Java åº”ç”¨æ‰€ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„ Java æ ¸å¿ƒåº“çš„ç±»ï¼Œæ˜¯äº’ç›¸å…¼å®¹çš„ã€‚)</p></li></ol></li><li><p>ç±»åŠ è½½å™¨åœ¨æˆåŠŸåŠ è½½æŸä¸ªç±»ä¹‹åï¼Œä¼šæŠŠå¾—åˆ°çš„ java.lang.Class ç±»çš„å®ä¾‹ç¼“å­˜èµ·æ¥ - å¯¹äºä¸€ä¸ªç±»åŠ è½½å™¨å®ä¾‹æ¥è¯´ï¼Œç›¸åŒå…¨åçš„ç±»åªåŠ è½½ä¸€æ¬¡ï¼Œå³ loadClass æ–¹æ³•ä¸ä¼šè¢«é‡å¤è°ƒç”¨ã€‚</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="134-çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„">13.4. çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„<a href="#134-çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„" class="hash-link" aria-label="Direct link to 13.4. çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„" title="Direct link to 13.4. çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„">â€‹</a></h2><p>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆcontext class loaderï¼‰åªæ˜¯ä¸€ä¸ªæ¦‚å¿µ , ç±» <code>java.lang.Thread</code>ä¸­çš„æ–¹æ³• <code>getContextClassLoader()</code>å’Œ <code>setContextClassLoader(ClassLoader cl)</code>ç”¨æ¥è·å–å’Œè®¾ç½®çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</p><p>ä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªåŒäº²å§”æ´¾æ¨¡å¼çš„ bug , ä¸¾ä¸ªä¾‹å­ ğŸŒ°: Java æä¾›äº†å¾ˆå¤šæœåŠ¡æä¾›è€…æ¥å£ï¼ˆService Provider Interfaceï¼ŒSPIï¼‰ï¼Œå…è®¸ç¬¬ä¸‰æ–¹ä¸ºè¿™äº›æ¥å£æä¾›å®ç°(å¸¸è§çš„ SPI æœ‰ JDBC, JAXP..., ) , è¿™äº›å®ç°ç”±<code>app class loader</code>æ¥åŠ è½½, è€Œè¿™äº› SPI çš„æ¥å£ç”± Java æ ¸å¿ƒåº“æ¥æä¾›, æ˜¯é€šè¿‡<code>å¼•å¯¼ç±»åŠ è½½å™¨ bootstrap class loader</code>æ¥åŠ è½½). å¼•å¯¼ç±»åŠ è½½å™¨æ˜¯æ— æ³•æ‰¾åˆ° SPI çš„å®ç°ç±»çš„ï¼Œå› ä¸ºå®ƒåªåŠ è½½ Java çš„æ ¸å¿ƒåº“ã€‚å®ƒä¹Ÿä¸èƒ½ä»£ç†ç»™ app class loader ï¼Œå› ä¸º bootstrap class loader åœ¨ app class loader çš„ä¸Šå±‚, ä¹Ÿå°±æ˜¯è¯´ï¼Œç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å¼æ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ­£å¥½è§£å†³äº†è¿™ä¸ªé—®é¢˜ <!-- -->[åœ¨ SPI æ¥å£çš„ä»£ç ä¸­ä½¿ç”¨çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Œå°±å¯ä»¥æˆåŠŸçš„åŠ è½½åˆ° SPI å®ç°çš„ç±»]</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="135-å€ŸåŠ©-classloader-å®ç°ç±»éš”ç¦»">13.5. å€ŸåŠ© classloader å®ç°ç±»éš”ç¦»<a href="#135-å€ŸåŠ©-classloader-å®ç°ç±»éš”ç¦»" class="hash-link" aria-label="Direct link to 13.5. å€ŸåŠ© classloader å®ç°ç±»éš”ç¦»" title="Direct link to 13.5. å€ŸåŠ© classloader å®ç°ç±»éš”ç¦»">â€‹</a></h2><p>ä¸åŒçš„ç±»åŠ è½½å™¨ä¸ºå„è‡ªåŠ è½½çš„ç±»åˆ›å»ºäº†é¢å¤–çš„åç§°ç©ºé—´, å³ä½¿å„è‡ªåŠ è½½çš„æ˜¯ç›¸åŒåç§°çš„ç±»ã€‚ç›¸åŒåç§°çš„ç±»å¯ä»¥å¹¶å­˜åœ¨ Java è™šæ‹Ÿæœºä¸­ï¼Œ<code>åªéœ€è¦ç”¨ä¸åŒçš„ç±»åŠ è½½å™¨æ¥åŠ è½½å®ƒä»¬å³å¯</code>ã€‚ä¸åŒç±»åŠ è½½å™¨åŠ è½½çš„ç±»ä¹‹é—´æ˜¯ä¸å…¼å®¹çš„ï¼Œè¿™å°±ç›¸å½“äºåœ¨ Java è™šæ‹Ÿæœºå†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ªä¸ª<code>ç›¸äº’éš”ç¦»çš„ Java ç±»ç©ºé—´</code>ã€‚è¿™ç§æŠ€æœ¯åœ¨è®¸å¤šæ¡†æ¶ä¸­éƒ½è¢«ç”¨åˆ°</p><p>å¯ä»¥è¿™ä¹ˆåšçš„åŸç†æ˜¯:</p><p>Java è™šæ‹Ÿæœºæ˜¯å¦‚ä½•åˆ¤å®šä¸¤ä¸ª Java ç±»æ˜¯ç›¸åŒçš„? ------- ğŸ“Œ ç±»çš„å…¨åæ˜¯å¦ç›¸åŒ ğŸ“Œ åŠ è½½æ­¤ç±»çš„ç±»åŠ è½½å™¨(å®ä¾‹å¯¹è±¡ id)æ˜¯å¦ä¸€æ ·</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="136-ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸">13.6. ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸<a href="#136-ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸" class="hash-link" aria-label="Direct link to 13.6. ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸" title="Direct link to 13.6. ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸">â€‹</a></h2><ul><li><p>classnotfoundException - åœ¨å½“å‰çš„ classloader ä¸­<code>åŠ è½½ class æ–‡ä»¶æ—¶æ²¡æœ‰æ‰¾åˆ°</code></p><p>å¯¹äº system class loader, åªè¦ class path ä¸­æ²¡æœ‰ç›¸åº”çš„ class æ–‡ä»¶, å°±æŠ›å¼‚å¸¸;
å¯¹äº user-defined class loader è¦åˆ°ä»£ç æ‰¾æ‰¾çœ‹, çœ‹å…·ä½“æ˜¯ä»ä»€ä¹ˆä½ç½®åŠ è½½ class</p></li><li><p>NoClassDefFoundException - åŠ è½½çš„ç±»å¼•ç”¨äº†å¦å¤–çš„ç±», è€Œè¿™ä¸ª&quot;å¦å¤–çš„&quot;<code>å¼•ç”¨ç±»ä¸å­˜åœ¨orå½“å‰class loaderæ— æ³•åŠ è½½å¼•ç”¨çš„ç±»</code></p><p>è§£å†³è¿™ä¸ªå¼‚å¸¸, éœ€è¦åˆ°å¼‚å¸¸ç±»ä¸­æ‰¾åˆ°å¼•ç”¨åˆ°äº†å“ªäº›å¦å¤–çš„ç±» , ç„¶åçœ‹çœ‹è¿™äº›å¦å¤–çš„ç±»æ˜¯ä¸æ˜¯å­˜åœ¨äºèƒ½å¤Ÿè¢«å½“å‰ class loader åŠ è½½åˆ°çš„ä½ç½®</p></li><li><p>LinkageError - åŠ è½½æŸä¸ª class æ—¶, è¿™ä¸ª class å·²ç»å­˜åœ¨äºå½“å‰çš„ class loader ä¸­äº† , ä¹Ÿå°±æ˜¯ <code>é‡å¤çš„åŠ è½½</code></p><p>è‡ªå®šä¹‰ class loader ä¸­ and å¹¶å‘ä¸‹å®¹æ˜“å‡ºç°</p><p>è¿™ä¸ªæœºåˆ¶ä¹Ÿé€ æˆ jvm æ— æ³•ç›´æ¥æ›´æ–°ä¸€ä¸ªå·²ç»åŠ è½½è¿‡çš„ class, åªèƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ class loader æ¥åŠ è½½æ›´æ–°åçš„ class, ç„¶åå°†æ–°è¯·æ±‚è½¬å…¥æ–° class loader æ¥è·å–æ›´æ–°åçš„ç±» -------- è¿™ä¹Ÿæ—¶åŠ¨æ€æ›´æ–°çš„åŸç†</p></li><li><p>ClassCastException - è½¬å‹å¼‚å¸¸</p><p>ä½¿ç”¨æ³›å‹å¯ä»¥è§„é¿</p><p>è¦æ³¨æ„ä¸¤ä¸ªåŒç±»å‹å¯¹è±¡ä½†æ˜¯é€šè¿‡ä¸åŒ class loader åŠ è½½çš„æƒ…å†µ, è¿™ç§æƒ…å†µä¹Ÿä¼šæŠ›å¼‚å¸¸</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="137-è‡ªå®šä¹‰-classloaderåŠ è½½ç½‘ç»œä¸Šçš„-class">13.7. è‡ªå®šä¹‰ classloader(åŠ è½½ç½‘ç»œä¸Šçš„ class)<a href="#137-è‡ªå®šä¹‰-classloaderåŠ è½½ç½‘ç»œä¸Šçš„-class" class="hash-link" aria-label="Direct link to 13.7. è‡ªå®šä¹‰ classloader(åŠ è½½ç½‘ç»œä¸Šçš„ class)" title="Direct link to 13.7. è‡ªå®šä¹‰ classloader(åŠ è½½ç½‘ç»œä¸Šçš„ class)">â€‹</a></h2><p>åœºæ™¯: åº”ç”¨é€šè¿‡ç½‘ç»œæ¥ä¼ è¾“ Java ç±»çš„å­—èŠ‚ä»£ç ï¼Œä¸ºäº†ä¿è¯å®‰å…¨æ€§ï¼Œè¿™äº›å­—èŠ‚ä»£ç ç»è¿‡äº†åŠ å¯†å¤„ç†ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦è‡ªå·±çš„ç±»åŠ è½½å™¨æ¥ä»æŸä¸ªç½‘ç»œåœ°å€ä¸Šè¯»å–åŠ å¯†åçš„å­—èŠ‚ä»£ç ï¼Œæ¥ç€è¿›è¡Œè§£å¯†å’ŒéªŒè¯ï¼Œæœ€åå®šä¹‰å‡ºè¦åœ¨ Java è™šæ‹Ÿæœºä¸­è¿è¡Œçš„ç±»æ¥</p><p>ç¼–å†™ä¸€ä¸ªç±»ç»§æ‰¿è‡ª ClassLoader æŠ½è±¡ç±»ã€‚
å¤å†™å®ƒçš„ findClass()æ–¹æ³•ã€‚
åœ¨ findClass()æ–¹æ³•ä¸­è°ƒç”¨ defineClass()ã€‚</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//æ–‡ä»¶ç³»ç»Ÿç±»åŠ è½½å™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class FileSystemClassLoader extends ClassLoader {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   private String rootDir;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   public FileSystemClassLoader(String rootDir) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       this.rootDir = rootDir;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   // è‡ªå®šä¹‰ classloader é‡å†™ findClass å³å¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - java.lang.ClassLoaderç±»çš„æ–¹æ³• loadClass()å°è£…äº†å‰é¢æåˆ°çš„ä»£ç†æ¨¡å¼çš„å®ç°ã€‚è¯¥æ–¹æ³•ä¼šé¦–å…ˆè°ƒç”¨ findLoadedClass()æ–¹æ³•æ¥æ£€æŸ¥è¯¥ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½è¿‡ï¼›å¦‚æœæ²¡æœ‰åŠ è½½è¿‡çš„è¯ï¼Œä¼šè°ƒç”¨çˆ¶ç±»åŠ è½½å™¨çš„ loadClass()æ–¹æ³•æ¥å°è¯•åŠ è½½è¯¥ç±»ï¼›å¦‚æœçˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½è¯¥ç±»çš„è¯ï¼Œå°±è°ƒç”¨ findClass()æ–¹æ³•æ¥æŸ¥æ‰¾è¯¥ç±»ã€‚å› æ­¤ï¼Œä¸ºäº†ä¿è¯ç±»åŠ è½½å™¨éƒ½æ­£ç¡®å®ç°ä»£ç†æ¨¡å¼ï¼Œåœ¨å¼€å‘è‡ªå·±çš„ç±»åŠ è½½å™¨æ—¶ï¼Œæœ€å¥½ä¸è¦è¦†å†™ loadClass()æ–¹æ³•ï¼Œè€Œæ˜¯è¦†å†™ findClass()æ–¹æ³•ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       byte[] classData = getClassData(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       if (classData == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           throw new ClassNotFoundException();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           return defineClass(name, classData, 0, classData.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   private byte[] getClassData(String className) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       String path = classNameToPath(className);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           InputStream ins = new FileInputStream(path);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           int bufferSize = 4096;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           byte[] buffer = new byte[bufferSize];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           int bytesNumRead = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           while ((bytesNumRead = ins.read(buffer)) != -1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               baos.write(buffer, 0, bytesNumRead);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           return baos.toByteArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   private String classNameToPath(String className) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       return rootDir + File.separatorChar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               + className.replace(&#x27;.&#x27;, File.separatorChar) + &quot;.class&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ç½‘ç»œç±»åŠ è½½å™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">é€šè¿‡ç½‘ç»œä¸‹è½½ Java ç±»å­—èŠ‚ä»£ç å¹¶å®šä¹‰å‡º Java ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class NetworkClassLoader extends ClassLoader {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String rootUrl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public NetworkClassLoader(String rootUrl) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.rootUrl = rootUrl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] classData = getClassData(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (classData == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new ClassNotFoundException();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return defineClass(name, classData, 0, classData.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private byte[] getClassData(String className) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String path = classNameToPath(className);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            URL url = new URL(path);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InputStream ins = url.openStream();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int bufferSize = 4096;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] buffer = new byte[bufferSize];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int bytesNumRead = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((bytesNumRead = ins.read(buffer)) != -1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                baos.write(buffer, 0, bytesNumRead);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return baos.toByteArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String classNameToPath(String className) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return rootUrl + &quot;/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                + className.replace(&#x27;.&#x27;, &#x27;/&#x27;) + &quot;.class&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">////////////////////////////////////////</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CalculatorTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String url = &quot;http://localhost:8080/ClassloaderTest/classes&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NetworkClassLoader ncl = new NetworkClassLoader(url);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String basicClassName = &quot;com.example.CalculatorBasic&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String advancedClassName = &quot;com.example.CalculatorAdvanced&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Class&lt;?&gt; clazz = ncl.loadClass(basicClassName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ICalculator calculator = (ICalculator) clazz.newInstance();// é€šè¿‡æ¥å£æ¥æ”¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(calculator.getVersion());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clazz = ncl.loadClass(advancedClassName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            calculator = (ICalculator) clazz.newInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(calculator.getVersion());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>14. è·¯å¾„é—®é¢˜</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="141-è·å–-classpath-å’Œ-ç³»ç»Ÿå±æ€§-ç¯å¢ƒå˜é‡">14.1. è·å– classpath å’Œ ç³»ç»Ÿå±æ€§ ç¯å¢ƒå˜é‡<a href="#141-è·å–-classpath-å’Œ-ç³»ç»Ÿå±æ€§-ç¯å¢ƒå˜é‡" class="hash-link" aria-label="Direct link to 14.1. è·å– classpath å’Œ ç³»ç»Ÿå±æ€§ ç¯å¢ƒå˜é‡" title="Direct link to 14.1. è·å– classpath å’Œ ç³»ç»Ÿå±æ€§ ç¯å¢ƒå˜é‡">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">String str = Thread.currentThread().getContextClassLoader().getResource(&quot;&quot;).getPath();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(&quot;-------&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(str); // æˆ‘æ˜¯åœ¨æµ‹è¯•ç›®å½•ä¸‹, æ‰€ä»¥ç»“æœæ˜¯: /D:/repo/eclipse/etc-learn/target/test-classes/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String str1 = Thread.currentThread().getContextClassLoader().getResource(&quot;./&quot;).getPath();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(str1);// æ— è®ºæ˜¯[.] è¿˜æ˜¯[./], ç»“æœåŒ str</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String str2 = Thread.currentThread().getContextClassLoader().getResource(&quot;demo.properties&quot;).getPath();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(str2);// /D:/repo/eclipse/etc-learn/target/classes/demo.properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¿™ç§é€šè¿‡ .class è·å–çš„è·¯å¾„, ä¸æ˜¯ root classpath, è€Œæ˜¯ è¯¥ç±»æ‰€åœ¨çš„è¯¦ç»†class pathè·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PathUtil.class.getResource(classpath).getPath()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   /D:/repo/repo_github/shared_already/springboot-demos/groovy-demo/target/classes/io/github/xiaoyu/groovydemo/util/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è·å–èµ„æºæ–‡ä»¶</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Properties props = new Properties();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">props.load(Thread.currentThread().getContextClassLoader()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// è¿™é‡Œå¿…é¡»æ˜¯ class path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .getResourceAsStream(&quot;com/xiaoyu/learn/etc/schedule/quartz/simple/demo/quartz.properties&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>é€šè¿‡ System.getProperty(&quot;user.dir&quot;)</p><p>è‹¥æ˜¯è®¾ç½®è‡ªå®šä¹‰å‚æ•°, å¯ä»¥åœ¨ jvm å‚æ•°ä¸­è®¾ç½®: <code>-Daaa=xxx</code>, åœ¨ Tomcat çš„  catalina.sh ä¸­ é…ç½® <code>JAVA_OPS=-Daaa=xxx</code></p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.version          Java è¿è¡Œæ—¶ç¯å¢ƒç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vendor         Java è¿è¡Œæ—¶ç¯å¢ƒä¾›åº”å•†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vendor.url         Java ä¾›åº”å•†çš„ URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vm.specification.version         Java è™šæ‹Ÿæœºè§„èŒƒç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vm.specification.vendor         Java è™šæ‹Ÿæœºè§„èŒƒä¾›åº”å•†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vm.specification.name         Java è™šæ‹Ÿæœºè§„èŒƒåç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vm.version         Java è™šæ‹Ÿæœºå®ç°ç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vm.vendor         Java è™šæ‹Ÿæœºå®ç°ä¾›åº”å•†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.vm.name         Java è™šæ‹Ÿæœºå®ç°åç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.specification.version         Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.specification.vendor         Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒä¾›åº”å•†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.specification.name         Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒåç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.name         æ“ä½œç³»ç»Ÿçš„åç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.arch         æ“ä½œç³»ç»Ÿçš„æ¶æ„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.version         æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.separator         æ–‡ä»¶åˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ / â€ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path.separator         è·¯å¾„åˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ : â€ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">line.separator         è¡Œåˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ /n â€ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.home         Java å®‰è£…ç›®å½•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.class.version         Java ç±»æ ¼å¼ç‰ˆæœ¬å·</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.class.path         Java ç±»è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.library.path          åŠ è½½åº“æ—¶æœç´¢çš„è·¯å¾„åˆ—è¡¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.io.tmpdir         é»˜è®¤çš„ä¸´æ—¶æ–‡ä»¶è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.compiler         è¦ä½¿ç”¨çš„ JIT ç¼–è¯‘å™¨çš„åç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.ext.dirs         ä¸€ä¸ªæˆ–å¤šä¸ªæ‰©å±•ç›®å½•çš„è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user.name         ç”¨æˆ·çš„è´¦æˆ·åç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user.home         ç”¨æˆ·çš„ä¸»ç›®å½•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user.dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>15. æ•°æ®ç±»å‹</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="151-å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´">15.1. å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´<a href="#151-å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´" class="hash-link" aria-label="Direct link to 15.1. å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´" title="Direct link to 15.1. å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´">â€‹</a></h2><p><a href="https://blog.csdn.net/qfikh/article/details/52832087" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qfikh/article/details/52832087</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="152-double-ç±»å‹çš„åŠ å‡ä¹˜é™¤">15.2. double ç±»å‹çš„åŠ å‡ä¹˜é™¤<a href="#152-double-ç±»å‹çš„åŠ å‡ä¹˜é™¤" class="hash-link" aria-label="Direct link to 15.2. double ç±»å‹çš„åŠ å‡ä¹˜é™¤" title="Direct link to 15.2. double ç±»å‹çš„åŠ å‡ä¹˜é™¤">â€‹</a></h2><p>float : å•ç²¾åº¦æµ®ç‚¹æ•°, å  4 å­—èŠ‚</p><p>double : åŒç²¾åº¦æµ®ç‚¹æ•° -- ç¼–è¯‘å™¨é»˜è®¤å°æ•°; å æ® 8 å­—èŠ‚</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//å¦‚æœä¸å£°æ˜ï¼Œé»˜è®¤å°æ•°ä¸ºdoubleç±»å‹ï¼Œæ‰€ä»¥å¦‚æœè¦ç”¨floatçš„è¯ï¼Œå¿…é¡»è¿›è¡Œå¼ºè½¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//ä¾‹å¦‚ï¼šfloat  a=1.3; ä¼šç¼–è¯‘æŠ¥é”™ï¼Œæ­£ç¡®çš„å†™æ³• float a = (float)1.3;æˆ–è€…float a = 1.3f;ï¼ˆfæˆ–Féƒ½å¯ä»¥ä¸åŒºåˆ†å¤§å°å†™ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DoubleArith {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final int DEF_DIV_SCALE = 10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¸¤ä¸ªDoubleæ•°ç›¸åŠ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Double add(Double v1,Double v2){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b1 = new BigDecimal(v1.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b2 = new BigDecimal(v2.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return b1.add(b2).doubleValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¸¤ä¸ªDoubleæ•°ç›¸å‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Double sub(Double v1,Double v2){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b1 = new BigDecimal(v1.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b2 = new BigDecimal(v2.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return b1.subtract(b2).doubleValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¸¤ä¸ªDoubleæ•°ç›¸ä¹˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Double mul(Double v1,Double v2){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b1 = new BigDecimal(v1.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b2 = new BigDecimal(v2.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return b1.multiply(b2).doubleValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¸¤ä¸ªDoubleæ•°ç›¸é™¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Double div(Double v1,Double v2){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b1 = new BigDecimal(v1.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b2 = new BigDecimal(v2.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return b1.divide(b2,DEF_DIV_SCALE,BigDecimal.ROUND_HALF_UP).doubleValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¸¤ä¸ªDoubleæ•°ç›¸é™¤ï¼Œå¹¶ä¿ç•™scaleä½å°æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param scale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Double div(Double v1,Double v2,int scale){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(scale&lt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new IllegalArgumentException(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;The scale must be a positive integer or zero&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b1 = new BigDecimal(v1.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BigDecimal b2 = new BigDecimal(v2.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return b1.divide(b2,scale,BigDecimal.ROUND_HALF_UP).doubleValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>16. æ§åˆ¶å°å‘½ä»¤</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="161-æ‰“-jar-åŒ…">16.1. æ‰“ jar åŒ…<a href="#161-æ‰“-jar-åŒ…" class="hash-link" aria-label="Direct link to 16.1. æ‰“ jar åŒ…" title="Direct link to 16.1. æ‰“ jar åŒ…">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jar cvf &lt;jaræ–‡ä»¶å&gt; &lt;classæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>jar åŒ…æ‰“å¥½åï¼Œè¦æŒ‡å®šå…¥å£ç±» å³æ›´æ”¹ manifest.mf æ–‡ä»¶ æ ¼å¼ï¼šMain-Class: åŒ…å.ç±»åï¼ˆä¸åŠ .class)</li><li>jar åŒ…åŒå‡»è¿è¡Œåªå¯¹å›¾å½¢ç•Œé¢èµ·ä½œç”¨</li><li>éå›¾å½¢ç•Œé¢è¦ç”¨ bat æ–‡ä»¶</li><li>å¦‚æœæ˜¯ä½¿ç”¨ä»–äººçš„ jar åŒ…ï¼Œè¦å…ˆè®¾ç½® classpath</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="162-ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£-javadoc">16.2. ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£ javadoc<a href="#162-ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£-javadoc" class="hash-link" aria-label="Direct link to 16.2. ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£ javadoc" title="Direct link to 16.2. ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£ javadoc">â€‹</a></h2><p><code>javadoc -d å­˜æ”¾æ–‡æ¡£çš„è·¯å¾„ javaçš„æºæ–‡ä»¶</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="163-ç¼–è¯‘å’Œåç¼–è¯‘">16.3. ç¼–è¯‘å’Œåç¼–è¯‘<a href="#163-ç¼–è¯‘å’Œåç¼–è¯‘" class="hash-link" aria-label="Direct link to 16.3. ç¼–è¯‘å’Œåç¼–è¯‘" title="Direct link to 16.3. ç¼–è¯‘å’Œåç¼–è¯‘">â€‹</a></h2><p>å¦‚æœ Java æ–‡ä»¶å«æœ‰åŒ…ã€packageã€‘ï¼Œåˆ™ <code>javac â€“d . Demo.java</code>-----ã€.ã€‘è¡¨ç¤ºå½“å‰è·¯å¾„ï¼Œå³ class æ–‡ä»¶è·¯å¾„
å¿…é¡»åŠ ã€-dã€‘ï¼Œå¦åˆ™ç¼–è¯‘å‡ºæ¥æ²¡æœ‰åŒ…æ–‡ä»¶å¤¹ã€‚</p><p>è¿è¡Œæ—¶ï¼š <code>java com.xiaoyu.Demo</code></p><p>åç¼–è¯‘: <code>javap -verbose classæ–‡ä»¶</code></p><h1>17. é‡è¦çš„å¯¹è±¡</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="171-object">17.1. Object<a href="#171-object" class="hash-link" aria-label="Direct link to 17.1. Object" title="Direct link to 17.1. Object">â€‹</a></h2><p><a href="http://www.javacoder.cn/?p=274" target="_blank" rel="noopener noreferrer">http://www.javacoder.cn/?p=274</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="172-string">17.2. String<a href="#172-string" class="hash-link" aria-label="Direct link to 17.2. String" title="Direct link to 17.2. String">â€‹</a></h2><h1>18. å­—èŠ‚ç ç¼–è¾‘æŠ€æœ¯</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="181-javassist">18.1. javassist<a href="#181-javassist" class="hash-link" aria-label="Direct link to 18.1. javassist" title="Direct link to 18.1. javassist">â€‹</a></h2><p><a href="https://github.com/jboss-javassist/javassist" target="_blank" rel="noopener noreferrer">https://github.com/jboss-javassist/javassist</a>
<a href="https://www.cnblogs.com/rickiyang/p/11336268.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/rickiyang/p/11336268.html</a></p><h1>19. å‰æ²¿</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="191-graalvm">19.1. graalvm<a href="#191-graalvm" class="hash-link" aria-label="Direct link to 19.1. graalvm" title="Direct link to 19.1. graalvm">â€‹</a></h2><p><a href="https://zhuanlan.zhihu.com/p/106555993" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/106555993</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="192-vertx">19.2. vertx<a href="#192-vertx" class="hash-link" aria-label="Direct link to 19.2. vertx" title="Direct link to 19.2. vertx">â€‹</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="193-micronaut">19.3. Micronaut<a href="#193-micronaut" class="hash-link" aria-label="Direct link to 19.3. Micronaut" title="Direct link to 19.3. Micronaut">â€‹</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="194-quarkus">19.4. Quarkus<a href="#194-quarkus" class="hash-link" aria-label="Direct link to 19.4. Quarkus" title="Direct link to 19.4. Quarkus">â€‹</a></h2><h1>20. æ‹¾é—</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="201-æ­£åˆ™è¡¨è¾¾å¼-regex">20.1. æ­£åˆ™è¡¨è¾¾å¼ regex<a href="#201-æ­£åˆ™è¡¨è¾¾å¼-regex" class="hash-link" aria-label="Direct link to 20.1. æ­£åˆ™è¡¨è¾¾å¼ regex" title="Direct link to 20.1. æ­£åˆ™è¡¨è¾¾å¼ regex">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private final static Pattern VERSION_PREFIX_PATTERN = Pattern.compile(&quot;v(\\d+)/&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Matcher m = VERSION_PREFIX_PATTERN.matcher(httpServletRequest.getRequestURI());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if(m.find()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Integer version = Integer.valueOf(m.group(1));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(version &gt;= this.apiVersion)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return this;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="202-é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š">20.2. é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š<a href="#202-é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š" class="hash-link" aria-label="Direct link to 20.2. é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š" title="Direct link to 20.2. é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š">â€‹</a></h2><p><a href="https://droidyue.com/blog/2014/12/28/static-biding-and-dynamic-binding-in-java/" target="_blank" rel="noopener noreferrer">https://droidyue.com/blog/2014/12/28/static-biding-and-dynamic-binding-in-java/</a></p><p>åŠ¨æ€ç»‘å®šæ˜¯æŒ‡ç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µä¸çŸ¥é“è¦è°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œç›´åˆ°è¿è¡Œæ—¶æ‰èƒ½ç¡®å®š</p><p>å¦‚æœç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå°±å®Œæˆç»‘å®šï¼Œå°±å«ä½œé™æ€ç»‘å®š</p><p>æ˜¯å¦æ˜¯é™æ€ç»‘å®šå¯ä»¥åç¼–è¯‘ class æ–‡ä»¶æŸ¥çœ‹ <code>javap -c &lt;class_name&gt;</code></p><ul><li>é™æ€ç»‘å®šå‘ç”Ÿåœ¨ç¼–è¯‘æ—¶æœŸï¼ŒåŠ¨æ€ç»‘å®šå‘ç”Ÿåœ¨è¿è¡Œæ—¶</li><li>é™æ€ç»‘å®šä½¿ç”¨ç±»ä¿¡æ¯æ¥å®Œæˆï¼Œè€ŒåŠ¨æ€ç»‘å®šåˆ™éœ€è¦ä½¿ç”¨å¯¹è±¡ä¿¡æ¯æ¥å®Œæˆã€‚</li><li>æ–¹æ³•é‡è½½æ˜¯é™æ€ç»‘å®šï¼Œ æ–¹æ³•é‡å†™æ˜¯åŠ¨æ€ç»‘å®š</li><li>ä½¿ç”¨ private æˆ– static æˆ– final ä¿®é¥°çš„å˜é‡æˆ–è€…æ–¹æ³•ï¼Œä½¿ç”¨é™æ€ç»‘å®šã€‚è€Œè™šæ–¹æ³•ï¼ˆå¯ä»¥è¢«å­ç±»é‡å†™çš„æ–¹æ³•ï¼‰åˆ™ä¼šæ ¹æ®è¿è¡Œæ—¶çš„å¯¹è±¡è¿›è¡ŒåŠ¨æ€ç»‘å®šã€‚</li><li>é‡è½½(Overload)çš„æ–¹æ³•ä½¿ç”¨é™æ€ç»‘å®šå®Œæˆï¼Œè€Œé‡å†™(Override)çš„æ–¹æ³•åˆ™ä½¿ç”¨åŠ¨æ€ç»‘å®šå®Œæˆã€‚</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="203-é‡è½½-and-é‡å†™">20.3. é‡è½½ and é‡å†™<a href="#203-é‡è½½-and-é‡å†™" class="hash-link" aria-label="Direct link to 20.3. é‡è½½ and é‡å†™" title="Direct link to 20.3. é‡è½½ and é‡å†™">â€‹</a></h2><p>æ–¹æ³•ç­¾å: æ–¹æ³•åç§°+æ–¹æ³•å‚æ•° (ä¸åŒ…æ‹¬è¿”å›å€¼)</p><ul><li>é‡è½½å¿…é¡»æ–¹æ³•ç­¾åä¸åŒ</li><li>é‡å†™å¿…é¡»æ–¹æ³•ç­¾åç›¸åŒ</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="204-java-å€¼ä¼ é€’-or-å¼•ç”¨ä¼ é€’">20.4. java å€¼ä¼ é€’ or å¼•ç”¨ä¼ é€’<a href="#204-java-å€¼ä¼ é€’-or-å¼•ç”¨ä¼ é€’" class="hash-link" aria-label="Direct link to 20.4. java å€¼ä¼ é€’ or å¼•ç”¨ä¼ é€’" title="Direct link to 20.4. java å€¼ä¼ é€’ or å¼•ç”¨ä¼ é€’">â€‹</a></h2><ul><li>åŸºæœ¬æ•°æ®ç±»å‹, æ˜¯å€¼ä¼ é€’ -- ç›¸å½“äºå°†å‚æ•°å¤åˆ¶äº†ä¸€ä»½, å¯¹å½¢å‚çš„ä¿®æ”¹ä¸ä¼šå½±å“å®å‚ï¼›</li><li>å¼•ç”¨ç±»å‹, æ˜¯å¼•ç”¨ä¼ é€’ -- ç›¸å½“äºä¼ é€’çš„æ˜¯å†…å­˜åœ°å€(è¿™æ˜¯ä¸ºäº†é¿å…å¤åˆ¶å¤æ‚ç±»å‹çš„å†…å­˜è€—è´¹), å½¢å‚å’Œå®å‚æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼ˆå³å¼•ç”¨ï¼‰ï¼Œæ‰€ä»¥å¯¹å‚æ•°çš„ä¿®æ”¹ä¼šå½±å“åˆ°å®é™…çš„å¯¹è±¡ã€‚</li><li>String, Integer, Double ç­‰ immutable çš„ç±»å‹ç‰¹æ®Šå¤„ç†ï¼Œå¯ä»¥ç†è§£ä¸ºä¼ å€¼ï¼Œæœ€åçš„æ“ä½œä¸ä¼šä¿®æ”¹å®å‚å¯¹è±¡ã€‚</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="205-è®¿é—®ä¿®é¥°ç¬¦-public-protect-default-private">20.5. è®¿é—®ä¿®é¥°ç¬¦ public-protect-default-private<a href="#205-è®¿é—®ä¿®é¥°ç¬¦-public-protect-default-private" class="hash-link" aria-label="Direct link to 20.5. è®¿é—®ä¿®é¥°ç¬¦ public-protect-default-private" title="Direct link to 20.5. è®¿é—®ä¿®é¥°ç¬¦ public-protect-default-private">â€‹</a></h2><p><a href="https://blog.csdn.net/u012418131/article/details/52822381" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/u012418131/article/details/52822381</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ä½œç”¨åŸŸæœ‰å››ä¸ªå¯è®¿é—®çº§åˆ«: å½“å‰ç±», åŒåŒ…, ç»§æ‰¿, ä¸åŒåŒ…</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. public           èŒƒå›´æœ€å¤§, éƒ½å…è®¸</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. protected        èŒƒå›´å°ä¸€ç‚¹, ä¸å¯è·¨åŒ…è®¿é—®, ä½†æ˜¯å¯ä»¥é€šè¿‡ç»§æ‰¿æ‰“ç ´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. default          èŒƒå›´å†å°ä¸€ç‚¹ (package scope),ä¸å¯è·¨åŒ…è®¿é—®, ä¹Ÿä¸å¯é€šè¿‡ç»§æ‰¿è®¿é—® , åªèƒ½åœ¨åŒåŒ…ä¸‹è®¿é—®;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. private          èŒƒå›´æœ€å°, åªèƒ½å†ç±»å†…éƒ¨è®¿é—®;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="206-getcontextclassloadergetclassloader-åŒºåˆ«">20.6. getcontextclassloader&amp;getclassloader åŒºåˆ«<a href="#206-getcontextclassloadergetclassloader-åŒºåˆ«" class="hash-link" aria-label="Direct link to 20.6. getcontextclassloader&amp;getclassloader åŒºåˆ«" title="Direct link to 20.6. getcontextclassloader&amp;getclassloader åŒºåˆ«">â€‹</a></h2><p>å¦‚æœä½ ä½¿ç”¨ Test.class.getClassLoader()ï¼Œå¯èƒ½ä¼šå¯¼è‡´å’Œå½“å‰çº¿ç¨‹æ‰€è¿è¡Œçš„ç±»åŠ è½½å™¨ä¸ä¸€è‡´, ä¸€èˆ¬åªèƒ½ç”¨åœ¨ getResource</p><p>æœ€å¥½ä½¿ç”¨ Thread.currentThread().getContextClassLoader()</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="207-getter-å’Œ-setter-å­˜åœ¨çš„æ„ä¹‰">20.7. getter å’Œ setter å­˜åœ¨çš„æ„ä¹‰<a href="#207-getter-å’Œ-setter-å­˜åœ¨çš„æ„ä¹‰" class="hash-link" aria-label="Direct link to 20.7. getter å’Œ setter å­˜åœ¨çš„æ„ä¹‰" title="Direct link to 20.7. getter å’Œ setter å­˜åœ¨çš„æ„ä¹‰">â€‹</a></h2><p><a href="https://stackoverflow.com/questions/1568091/why-use-getters-and-setters-accessors" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/1568091/why-use-getters-and-setters-accessors</a></p><p>æ›´å¥½çš„å°è£…æ€§, æ— æ³•ç›´æ¥ access æˆå‘˜å˜é‡</p><p>æ‹“å±•æ€§å¥½, å¯ä»¥åœ¨å‡½æ•°ä¸­æ·»åŠ å…¶ä»–åŠŸèƒ½</p><p>æ–¹ä¾¿æ‰“æ–­ç‚¹ debug</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="208-ä¸ºä»€ä¹ˆ-service-åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£">20.8. ä¸ºä»€ä¹ˆ service åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£<a href="#208-ä¸ºä»€ä¹ˆ-service-åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£" class="hash-link" aria-label="Direct link to 20.8. ä¸ºä»€ä¹ˆ service åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£" title="Direct link to 20.8. ä¸ºä»€ä¹ˆ service åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£">â€‹</a></h2><p>åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸€ä¸ª service æ¥å£åªæœ‰ä¸€ä¸ªå®ç°ç±», ä¸ºä»€ä¹ˆè¿˜è¦å•ç‹¬æŠ½å‡ºä¸€ä¸ªæ¥å£å‘¢? è¿™ä¸ªæ¥å£æ—¶å¤šä½™çš„å—?</p><ul><li><p>æ–¹ä¾¿ JAVA åº•å±‚çš„ç›¸å…³ç‰¹æ€§å®ç°ï¼Œä¾‹å¦‚åå°„, ç”Ÿæˆä»£ç†</p></li><li><p>é¢å‘æ¥å£å¼€å‘çš„å¥½å¤„, æ¯”å¦‚ å¯ä»¥æŠŠæ¥å£æ‰“è¿›è°ƒç”¨æ–¹å¼€å‘åŒ…æä¾›å‡ºå»ï¼Œè€Œä¸æ˜¯å®ç°ç±»ã€‚æ‰€ä»¥è°ƒç”¨å°±æ˜¯ç­¾åçš„è°ƒç”¨, æ¥å£æ˜¯å¦å®ç°ä¸å½±å“è°ƒç”¨</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="209-static-å…³é”®å­—">20.9. static å…³é”®å­—<a href="#209-static-å…³é”®å­—" class="hash-link" aria-label="Direct link to 20.9. static å…³é”®å­—" title="Direct link to 20.9. static å…³é”®å­—">â€‹</a></h2><p><a href="https://www.cnblogs.com/dotgua/p/6354151.html?utm_source=itdadao&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer">å››ä¸ªä½œç”¨</a>
sos ä¸Šçš„ä¸€ä¸ªé—®é¢˜: <a href="https://stackoverflow.com/questions/413898/what-does-the-static-keyword-do-in-a-class" target="_blank" rel="noopener noreferrer">What does the &#x27;static&#x27; keyword do in a class?</a></p><p><a href="https://www.cnblogs.com/hf-cherish/p/4970267.html" target="_blank" rel="noopener noreferrer">é™æ€å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ</a></p><p>static å…³é”®å­—çš„ä½œç”¨æ˜¯æŠŠç±»çš„æˆå‘˜å˜æˆç±»ç›¸å…³ï¼Œè€Œä¸æ˜¯å®ä¾‹ç›¸å…³</p><ul><li><p>ä¿®é¥°æˆå‘˜å˜é‡ - å†…å­˜ä½ç½®å˜åŒ–: heap(å±äºå¯¹è±¡, å¯¹è±¡ç‹¬æœ‰) --&gt; method area(å±äº class, å¯¹è±¡å…¬æœ‰)</p></li><li><p>ä¿®é¥°æˆå‘˜æ–¹æ³• - å†…å­˜å˜åŒ–: æ²¡æœ‰å¤šå¤§çš„å˜åŒ–, æ–¹æ³•æœ¬æ¥å°±æ˜¯å­˜æ”¾åœ¨ç±»çš„å®šä¹‰å½“ä¸­çš„</p><ul><li><p>æœ€å¤§çš„ä½œç”¨ï¼Œå°±æ˜¯å¯ä»¥ä½¿ç”¨&quot;ç±»å.æ–¹æ³•å&quot;çš„æ–¹å¼æ“ä½œæ–¹æ³•ï¼Œé¿å…äº†å…ˆè¦ new å‡ºå¯¹è±¡çš„ç¹çå’Œèµ„æºæ¶ˆè€—.</p></li><li><p>ä¸è¿‡å®ƒä¹Ÿæœ‰ä½¿ç”¨çš„å±€é™ï¼Œä¸€ä¸ª static ä¿®é¥°çš„æ–¹æ³•ä¸­ï¼Œä¸èƒ½ä½¿ç”¨é static ä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œå› ä¸º static ä¿®é¥°çš„æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œå¦‚æœå»ç›´æ¥ä½¿ç”¨å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œå®ƒä¼šä¸çŸ¥æ‰€æªï¼ˆä¸çŸ¥è¯¥ä½¿ç”¨å“ªä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼‰ã€‚</p></li></ul></li><li><p>é™æ€å— - åˆå§‹åŒ– static ä¿®é¥°çš„æˆå‘˜æ—¶ï¼Œå¯ä»¥å°†ä»–ä»¬ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªä»¥ static å¼€å§‹ï¼Œç”¨èŠ±æ‹¬å·åŒ…è£¹èµ·æ¥çš„å—çŠ¶è¯­å¥ä¸­. é™æ€å—å’Œé™æ€æˆå‘˜å˜é‡æ•ˆæœç­‰åŒ</p><ul><li><p>åŠ è½½é¡ºåº</p><p>1ã€ï¼ˆå¦‚æœç±»è¿˜æœªè¢«åŠ è½½ï¼‰å…ˆæ‰§è¡Œçˆ¶ç±»çš„é™æ€ä»£ç å—å’Œé™æ€å˜é‡åˆå§‹åŒ–ï¼Œå¹¶ä¸”é™æ€ä»£ç å—å’Œé™æ€å˜é‡çš„æ‰§è¡Œé¡ºåºåªè·Ÿä»£ç ä¸­å‡ºç°çš„é¡ºåºæœ‰å…³ã€‚
2ã€ï¼ˆå¦‚æœç±»è¿˜æœªè¢«åŠ è½½ï¼‰æ‰§è¡Œå­ç±»çš„é™æ€ä»£ç å—å’Œé™æ€å˜é‡åˆå§‹åŒ–ã€‚
3ã€æ‰§è¡Œçˆ¶ç±»çš„å®ä¾‹å˜é‡åˆå§‹åŒ–
4ã€æ‰§è¡Œçˆ¶ç±»çš„æ„é€ å‡½æ•°
5ã€æ‰§è¡Œå­ç±»çš„å®ä¾‹å˜é‡åˆå§‹åŒ–
6ã€æ‰§è¡Œå­ç±»çš„æ„é€ å‡½æ•°</p></li></ul></li><li><p>é™æ€å¯¼åŒ…</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2010-å†…éƒ¨ç±»-or-é™æ€å†…éƒ¨ç±»">20.10. å†…éƒ¨ç±» or é™æ€å†…éƒ¨ç±»<a href="#2010-å†…éƒ¨ç±»-or-é™æ€å†…éƒ¨ç±»" class="hash-link" aria-label="Direct link to 20.10. å†…éƒ¨ç±» or é™æ€å†…éƒ¨ç±»" title="Direct link to 20.10. å†…éƒ¨ç±» or é™æ€å†…éƒ¨ç±»">â€‹</a></h2><p><a href="https://www.cnblogs.com/Gaojiecai/p/4041663.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/Gaojiecai/p/4041663.html</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="20101-å†…éƒ¨ç±»">20.10.1. å†…éƒ¨ç±»<a href="#20101-å†…éƒ¨ç±»" class="hash-link" aria-label="Direct link to 20.10.1. å†…éƒ¨ç±»" title="Direct link to 20.10.1. å†…éƒ¨ç±»">â€‹</a></h3><ul><li><p>å†…éƒ¨ç±»ï¼šå®šä¹‰å†ç±»å†…éƒ¨çš„ç±»</p><p><code>éé™æ€å†…éƒ¨ç±»å¯¹è±¡æœ‰ç€æŒ‡å‘å…¶å¤–éƒ¨ç±»å¯¹è±¡çš„å¼•ç”¨</code>, æ‰€ä»¥ <code>åœ¨åˆ›å»ºéé™æ€å†…éƒ¨ç±»å¯¹è±¡æ—¶ï¼Œä¸€å®šè¦å…ˆåˆ›å»ºèµ·ç›¸åº”çš„å¤–éƒ¨ç±»å¯¹è±¡</code></p></li><li><p>ä½œç”¨ - å°è£…æ€§</p><ul><li><p><code>å†…éƒ¨ç±»æˆå‘˜å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æ•°æ®</code></p></li><li><p>å¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å†…éƒ¨ç±»çš„å®ç°ç»†èŠ‚ï¼Œä¾‹å¦‚å†…éƒ¨ç±»çš„æˆå‘˜å˜é‡</p></li></ul></li></ul><blockquote><p>ç†è§£: ä»€ä¹ˆæ˜¯å†…éƒ¨ï¼Ÿå†…éƒ¨å°±æ˜¯æˆ‘æ˜¯ä½ çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘äº†è§£ä½ ï¼Œæˆ‘çŸ¥é“ä½ çš„å…¨éƒ¨ï¼Œæ²¡æœ‰ä½ å°±æ²¡æœ‰æˆ‘ã€‚ï¼ˆæ‰€ä»¥å†…éƒ¨ç±»å¯¹è±¡æ˜¯ä»¥å¤–éƒ¨ç±»å¯¹è±¡å­˜åœ¨ä¸ºå‰æçš„ï¼‰</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="20102-é™æ€å†…éƒ¨ç±»">20.10.2. é™æ€å†…éƒ¨ç±»<a href="#20102-é™æ€å†…éƒ¨ç±»" class="hash-link" aria-label="Direct link to 20.10.2. é™æ€å†…éƒ¨ç±»" title="Direct link to 20.10.2. é™æ€å†…éƒ¨ç±»">â€‹</a></h3><p>é™æ€å†…éƒ¨ç±»(é™æ€åµŒå¥—ç±»)ï¼šä½¿ç”¨ static æ¥ä¿®é¥°ä¸€ä¸ªå†…éƒ¨ç±»</p><p><code>static InnerClass å’Œ OuterClass æ²¡å•¥å…³ç³»</code>, å°±æ˜¯ä¸ªç‹¬ç«‹çš„ class, è‡ªå·±å¯ä»¥å®Œå…¨ç‹¬ç«‹å­˜åœ¨, ä¹Ÿå°±æ²¡æœ‰äº†æŒ‡å‘å¤–éƒ¨ç±»çš„å¼•ç”¨, å› æ­¤ä¹Ÿå°±æ— æ³•è®¿é—®å¤–éƒ¨ç±»çš„æˆå‘˜</p><p>å¤–éƒ¨ç±»å¯ä»¥è®¿é—® static InnerClass çš„æˆå‘˜</p><blockquote><p>ç†è§£: æ¯”å¦‚æœ‰ Aï¼ŒB ä¸¤ä¸ªç±»ï¼ŒB æœ‰ç‚¹ç‰¹æ®Šï¼Œè™½ç„¶å¯ä»¥ç‹¬ç«‹å­˜åœ¨ï¼Œä½†åªè¢« A ä½¿ç”¨ã€‚è¿™æ—¶å€™æ€ä¹ˆåŠï¼Ÿå¦‚æœæŠŠ B å¹¶å…¥ A é‡Œï¼Œå¤æ‚åº¦æé«˜ï¼Œæå¾— A è¿åå•ä¸€èŒè´£ã€‚å¦‚æœ B ç‹¬ç«‹ï¼Œåˆå¯èƒ½è¢«å…¶ä»–ç±»ï¼ˆæ¯”å¦‚åŒä¸€ä¸ªåŒ…ä¸‹çš„ Cï¼‰ä¾èµ–ï¼Œä¸ç¬¦åˆè®¾è®¡çš„æœ¬æ„ã€‚æ‰€ä»¥ä¸å¦‚å°†å…¶å˜æˆ A.Bï¼Œç­‰äºæ·»åŠ ä¸ªæ³¨é‡Šï¼Œå‘Šè¯‰å…¶ä»–ç±»åˆ«ä½¿ç”¨ B äº†ï¼Œå®ƒåªè·Ÿ A ç©ã€‚</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2011-java-ç±»åˆå§‹åŒ–é¡ºåº">20.11. Java ç±»åˆå§‹åŒ–é¡ºåº<a href="#2011-java-ç±»åˆå§‹åŒ–é¡ºåº" class="hash-link" aria-label="Direct link to 20.11. Java ç±»åˆå§‹åŒ–é¡ºåº" title="Direct link to 20.11. Java ç±»åˆå§‹åŒ–é¡ºåº">â€‹</a></h2><p>å•ç‹¬çš„ç±»:</p><ol><li>é™æ€å±æ€§</li><li>é™æ€ä»£ç å—</li><li>æ™®é€šå±æ€§</li><li>æ™®é€šä»£ç å—</li><li>æ„é€ æ–¹æ³•</li></ol><p>ç»§æ‰¿å…³ç³»çš„çˆ¶å­ç±»:</p><ol><li>çˆ¶ç±»é™æ€å±æ€§</li><li>çˆ¶ç±»é™æ€ä»£ç å—</li><li>å­ç±»é™æ€å±æ€§</li><li>å­ç±»é™æ€ä»£ç å—</li><li>çˆ¶ç±»æ™®é€šå±æ€§</li><li>çˆ¶ç±»æ™®é€šä»£ç å—</li><li>çˆ¶ç±»æ„é€ æ–¹æ³•</li><li>å­ç±»æ™®é€šå˜é‡</li><li>å­ç±»æ™®é€šä»£ç å—</li><li>å­ç±»æ„é€ æ–¹æ³•</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2012-random-éšæœºæ•°">20.12. Random-éšæœºæ•°<a href="#2012-random-éšæœºæ•°" class="hash-link" aria-label="Direct link to 20.12. Random-éšæœºæ•°" title="Direct link to 20.12. Random-éšæœºæ•°">â€‹</a></h2><p><a href="https://www.cnblogs.com/yrrAwx/p/7806444.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/yrrAwx/p/7806444.html</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2013-ä½è¿ç®—">20.13. ä½è¿ç®—<a href="#2013-ä½è¿ç®—" class="hash-link" aria-label="Direct link to 20.13. ä½è¿ç®—" title="Direct link to 20.13. ä½è¿ç®—">â€‹</a></h2><p>å·¦ç§»: å·¦ç§» n ä½å°±æ˜¯æŠŠæœ€é«˜ä½ n ä½ç§»å‡ºï¼Œä½ä½æ·»åŠ  n ä¸ª 0 çš„æ“ä½œï¼Œå·¦ç§»æ“ä½œç›¸å½“äºå°†è¯¥æ•°ä¹˜ä»¥ 2^n æ¬¡æ–¹ã€‚</p><p>å³ç§»: å³ç§» n ä½å°±æ˜¯æŠŠä½ä½ n ä½ç§»å‡ºï¼Œé«˜ä½æ·»åŠ  n ä¸ª 0 çš„æ“ä½œï¼Œå³ç§»æ“ä½œç›¸å½“äºå°†è¯¥æ•°é™¤ä»¥ 2^n æ¬¡æ–¹ã€‚</p><p><a href="https://www.cnblogs.com/liaopeng/p/8436155.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/liaopeng/p/8436155.html</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2014-ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™">20.14. ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™<a href="#2014-ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™" class="hash-link" aria-label="Direct link to 20.14. ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™" title="Direct link to 20.14. ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™">â€‹</a></h2><p>å®é™…ä¸Š, java åŒ…åæ˜¯å¤§å°å†™æ•æ„Ÿçš„, é‚£ä¸ºä»€ä¹ˆè¿˜æ˜¯è¦æ±‚éƒ½è¦å°å†™å‘¢</p><p>æ˜¯ä¸ºäº†è·¨å¹³å°çš„è€ƒè™‘, Linux ä¸­çš„æ–‡ä»¶åæ˜¯å¤§å°å†™æ•æ„Ÿçš„, ä½†æ˜¯ windows ä¸­çš„æ–‡ä»¶åæ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„, é˜²æ­¢åœ¨ Windows å¹³å°å‡ºé”™, ç»Ÿä¸€è¦æ±‚å°å†™</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2015-å¤„ç†-unicode-ç¼–ç é—®é¢˜">20.15. å¤„ç† unicode ç¼–ç é—®é¢˜<a href="#2015-å¤„ç†-unicode-ç¼–ç é—®é¢˜" class="hash-link" aria-label="Direct link to 20.15. å¤„ç† unicode ç¼–ç é—®é¢˜" title="Direct link to 20.15. å¤„ç† unicode ç¼–ç é—®é¢˜">â€‹</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// æ–¹æ³•1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class UnicodeUtils {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * å­—ç¬¦ä¸²ç¼–ç æˆUnicodeç¼–ç </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encode(String src) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StringBuilder str = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int intAsc;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String strHex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; src.length(); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c = src.charAt(i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            intAsc = (int) c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            strHex = Integer.toHexString(intAsc);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (intAsc &gt; 128)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                str.append(&quot;\\u&quot; + strHex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                str.append(&quot;\\u00&quot; + strHex); // ä½ä½åœ¨å‰é¢è¡¥00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return str.toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Unicodeè§£ç æˆå­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decode(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int t =  src.length() / 6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StringBuilder str = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; t; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String s = src.substring(i * 6, (i + 1) * 6); // æ¯6ä½æè¿°ä¸€ä¸ªå­—èŠ‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // é«˜ä½éœ€è¦è¡¥ä¸Š00å†è½¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String s1 = s.substring(2, 4) + &quot;00&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ä½ä½ç›´æ¥è½¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String s2 = s.substring(4);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // å°†16è¿›åˆ¶çš„stringè½¬ä¸ºint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int n = Integer.valueOf(s1, 16) + Integer.valueOf(s2, 16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // å°†intè½¬æ¢ä¸ºå­—ç¬¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            char[] chars = Character.toChars(n);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            str.append(new String(chars));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return str.toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// æ–¹æ³•2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class T {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void te() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String te = &quot;\\u97e6\\u5c0f\\u5b9d&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final String result = unicodeDecode(te);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String unicodeDecode(String string) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Pattern pattern = Pattern.compile(&quot;(\\\\u(\\p{XDigit}{4}))&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Matcher matcher = pattern.matcher(string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char    ch;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (matcher.find()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ch = (char) Integer.parseInt(matcher.group(2), 16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            string = string.replace(matcher.group(1), ch + &quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return string;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String unicodeEncode(String string) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] utfBytes = string.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String unicodeBytes = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; utfBytes.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String hexB = Integer.toHexString(utfBytes[i]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (hexB.length() &lt;= 2) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                hexB = &quot;00&quot; + hexB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            unicodeBytes = unicodeBytes + &quot;\\u&quot; + hexB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return unicodeBytes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2016-ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡">20.16. ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡<a href="#2016-ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡" class="hash-link" aria-label="Direct link to 20.16. ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡" title="Direct link to 20.16. ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡">â€‹</a></h2><p><a href="https://www.oschina.net/question/2319418_2317139" target="_blank" rel="noopener noreferrer">https://www.oschina.net/question/2319418_2317139</a></p><p>å¤§ä½“æ¥è¯´ï¼Œè¿™æ ·å†™æ˜¯ä¸€ç§æç«¯çš„ä¼˜åŒ–ï¼Œåœ¨è¿è¡Œæ—¶ï¼Œå³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰å°†ä¼šæŠŠè¿™ç§ä»£ç ç¼–è¯‘æˆä¸æœ¬åœ°å¹³å°ç›¸å…³çš„æœºå™¨ç ï¼Œå¹¶è¿›è¡Œå„ç§å±‚æ¬¡çš„ä¼˜åŒ–ï¼Œä»¥æé«˜æ€§èƒ½ã€‚</p><p><a href="http://mail.openjdk.java.net/pipermail/core-libs-dev/2010-May/004165.html" target="_blank" rel="noopener noreferrer">http://mail.openjdk.java.net/pipermail/core-libs-dev/2010-May/004165.html</a>
<a href="https://stackoverflow.com/questions/2785964/in-arrayblockingqueue-why-copy-final-member-field-into-local-final-variable" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/2785964/in-arrayblockingqueue-why-copy-final-member-field-into-local-final-variable</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2017-ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼">20.17. ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼<a href="#2017-ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼" class="hash-link" aria-label="Direct link to 20.17. ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼" title="Direct link to 20.17. ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼">â€‹</a></h2><p>ä»»ä½•å˜é‡åœ¨Cè¯­è¨€ä¸­ä¸èµ‹å€¼çš„è¯ï¼Œä¼šæ˜¯ä¹±ç çš„å½¢å¼ï¼Œå¯èƒ½æœ‰å®‰å…¨é—®é¢˜ã€‚æ‰€ä»¥javaä¿®æ­£äº†è¿™ç‚¹ï¼Œå¯¹äºå±€éƒ¨å˜é‡å¼ºåˆ¶è®©ä½ èµ‹å€¼</p><p>ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡æœ‰è‡ªå·±çš„åˆå§‹å€¼ï¼Œè€Œä¸éœ€è¦å¼ºåˆ¶èµ‹å€¼ï¼Œé‚£æ˜¯å› ä¸ºnewå¯¹è±¡çš„æ—¶å€™ï¼Œæ„é€ å‡½æ•°å¸®ä½ åˆå§‹åŒ–é»˜è®¤å€¼äº†</p><h1>21. å¼€æºé¡¹ç›®</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="211-åšå®¢-cms-ç³»ç»Ÿ">21.1. åšå®¢ cms ç³»ç»Ÿ<a href="#211-åšå®¢-cms-ç³»ç»Ÿ" class="hash-link" aria-label="Direct link to 21.1. åšå®¢ cms ç³»ç»Ÿ" title="Direct link to 21.1. åšå®¢ cms ç³»ç»Ÿ">â€‹</a></h2><p><a href="https://github.com/halo-dev/halo" target="_blank" rel="noopener noreferrer">https://github.com/halo-dev/halo</a></p><p><a href="https://github.com/JPressProjects/jpress" target="_blank" rel="noopener noreferrer">https://github.com/JPressProjects/jpress</a> ç±»ä¼¼ WordPress</p><p><a href="https://github.com/gentics/mesh" target="_blank" rel="noopener noreferrer">https://github.com/gentics/mesh</a></p><h1>java agent</h1><p><a href="https://mp.weixin.qq.com/s/ArP0CtVZMB2oUYSdjr7RGw" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s/ArP0CtVZMB2oUYSdjr7RGw</a>
<a href="https://www.jianshu.com/p/d47e3aa1cb5c" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/d47e3aa1cb5c</a></p><p>åŸºæœ¬ä½¿ç”¨</p><p><a href="https://www.cnblogs.com/rickiyang/p/11368932.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/rickiyang/p/11368932.html</a>
<a href="https://www.jianshu.com/p/b72f66da679f" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/b72f66da679f</a>
<a href="https://www.cnblogs.com/aspirant/p/8796974.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/aspirant/p/8796974.html</a></p><p>btrace  <a href="https://github.com/btraceio/btrace" target="_blank" rel="noopener noreferrer">https://github.com/btraceio/btrace</a> çº¿ä¸Šè°ƒè¯•ä»£ç ä¸ç”¨é‡å¯é¡¹ç›®</p><p>jrebel  çƒ­åŠ è½½, åªé‡æ–°åŠ è½½ä¿®æ”¹çš„ ç±», mybatis xml ä¿®æ”¹ä¹Ÿå¯ä»¥å®ç°çƒ­åŠ è½½</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/java">java</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/xiaoyureed/xiaoyureed.github.io/tree/main/docs/java-note.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/java-memory-model-jmm-jvm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">JMM and GCğŸŒˆ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/jquery-note"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JQuery notes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#31-åå°„çš„-api" class="table-of-contents__link toc-highlight">3.1. åå°„çš„ api</a></li><li><a href="#32-å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶" class="table-of-contents__link toc-highlight">3.2. å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶</a></li><li><a href="#51-é›†åˆçš„ä½“ç³»" class="table-of-contents__link toc-highlight">5.1. é›†åˆçš„ä½“ç³»</a></li><li><a href="#52-è¯»æºç " class="table-of-contents__link toc-highlight">5.2. è¯»æºç </a><ul><li><a href="#521-æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«" class="table-of-contents__link toc-highlight">5.2.1. æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«</a></li><li><a href="#522-å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«" class="table-of-contents__link toc-highlight">5.2.2. å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«</a></li><li><a href="#523-hashmap" class="table-of-contents__link toc-highlight">5.2.3. HashMap</a></li><li><a href="#524-hashset" class="table-of-contents__link toc-highlight">5.2.4. HashSet</a></li><li><a href="#525-hashtable" class="table-of-contents__link toc-highlight">5.2.5. HashTable</a></li><li><a href="#526-linkedhashmap" class="table-of-contents__link toc-highlight">5.2.6. LinkedHashMap</a></li><li><a href="#527-treemap" class="table-of-contents__link toc-highlight">5.2.7. TreeMap</a></li><li><a href="#528-lindedhashset" class="table-of-contents__link toc-highlight">5.2.8. LindedHashSet</a></li><li><a href="#529-arraylist-å’Œ-vector" class="table-of-contents__link toc-highlight">5.2.9. ArrayList å’Œ Vector</a></li><li><a href="#5210-linkedlist" class="table-of-contents__link toc-highlight">5.2.10. LinkedList</a></li><li><a href="#5211-concurrenthashmap" class="table-of-contents__link toc-highlight">5.2.11. ConcurrentHashMap</a></li></ul></li><li><a href="#53-collections-å’Œ-arrays-å·¥å…·ç±»" class="table-of-contents__link toc-highlight">5.3. Collections å’Œ Arrays å·¥å…·ç±»</a></li><li><a href="#54-é›†åˆæ’åº" class="table-of-contents__link toc-highlight">5.4. é›†åˆæ’åº</a></li><li><a href="#61-æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£" class="table-of-contents__link toc-highlight">6.1. æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£</a></li><li><a href="#62-æ³›å‹åå°„" class="table-of-contents__link toc-highlight">6.2. æ³›å‹åå°„</a><ul><li><a href="#621-æ³›å‹åå°„-api" class="table-of-contents__link toc-highlight">6.2.1. æ³›å‹åå°„ api</a></li><li><a href="#622-æ¡ˆä¾‹-ä¼˜åŒ–-basedao" class="table-of-contents__link toc-highlight">6.2.2. æ¡ˆä¾‹-ä¼˜åŒ– BaseDao</a></li></ul></li><li><a href="#71-è¯­æ³•" class="table-of-contents__link toc-highlight">7.1. è¯­æ³•</a></li><li><a href="#72-å…ƒæ³¨è§£" class="table-of-contents__link toc-highlight">7.2. å…ƒæ³¨è§£</a></li><li><a href="#73-æ³¨è§£åå°„" class="table-of-contents__link toc-highlight">7.3. æ³¨è§£åå°„</a></li><li><a href="#74-çœ‹ä¸€ä¸ªä¾‹å­ä¼˜åŒ–-dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´" class="table-of-contents__link toc-highlight">7.4. çœ‹ä¸€ä¸ªä¾‹å­(ä¼˜åŒ– dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´)</a><ul><li><a href="#741-é€šè¿‡æ³¨è§£ä¼˜åŒ–-javabean" class="table-of-contents__link toc-highlight">7.4.1. é€šè¿‡æ³¨è§£ä¼˜åŒ– JavaBean</a></li><li><a href="#742-æ³›å‹åå°„ä¼˜åŒ–-basedao" class="table-of-contents__link toc-highlight">7.4.2. æ³›å‹åå°„ä¼˜åŒ– BaseDao</a></li><li><a href="#743-è‡ªå®šä¹‰ç»“æœé›†-handler" class="table-of-contents__link toc-highlight">7.4.3. è‡ªå®šä¹‰ç»“æœé›† handler</a></li></ul></li><li><a href="#81-ioæ€»ç»“" class="table-of-contents__link toc-highlight">8.1. ioæ€»ç»“</a></li><li><a href="#82-socket-ç½‘ç»œç¼–ç¨‹" class="table-of-contents__link toc-highlight">8.2. socket ç½‘ç»œç¼–ç¨‹</a></li><li><a href="#83-é˜»å¡-io" class="table-of-contents__link toc-highlight">8.3. é˜»å¡ io</a><ul><li><a href="#831-ä»€ä¹ˆæ˜¯é˜»å¡-io" class="table-of-contents__link toc-highlight">8.3.1. ä»€ä¹ˆæ˜¯é˜»å¡ io</a></li><li><a href="#832-io-ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ" class="table-of-contents__link toc-highlight">8.3.2. io ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ</a></li><li><a href="#833-paths-å’Œ-files-ç›¸å…³-api" class="table-of-contents__link toc-highlight">8.3.3. Paths å’Œ Files ç›¸å…³ api</a><ul><li><a href="#8331-paths-çš„è·å–è½¬åŒ–" class="table-of-contents__link toc-highlight">8.3.3.1. Paths çš„è·å–è½¬åŒ–</a></li><li><a href="#8332-é€šè¿‡-files-paths-è¯»å–å†™å…¥" class="table-of-contents__link toc-highlight">8.3.3.2. é€šè¿‡ Files Paths è¯»å–å†™å…¥</a></li><li><a href="#8333-éå†æ–‡ä»¶å¤¹" class="table-of-contents__link toc-highlight">8.3.3.3. éå†æ–‡ä»¶å¤¹</a></li><li><a href="#8334-é€šè¿‡-files-è·å–æ–‡ä»¶å±æ€§" class="table-of-contents__link toc-highlight">8.3.3.4. é€šè¿‡ files è·å–æ–‡ä»¶å±æ€§</a></li></ul></li><li><a href="#834-bio-tcp-å®ç°é€šä¿¡" class="table-of-contents__link toc-highlight">8.3.4. bio tcp å®ç°é€šä¿¡</a></li></ul></li><li><a href="#84-éé˜»å¡-io" class="table-of-contents__link toc-highlight">8.4. éé˜»å¡ io</a><ul><li><a href="#841-ä»€ä¹ˆæ˜¯éé˜»å¡-io" class="table-of-contents__link toc-highlight">8.4.1. ä»€ä¹ˆæ˜¯éé˜»å¡ io</a></li><li><a href="#842-åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡" class="table-of-contents__link toc-highlight">8.4.2. åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡</a><ul><li><a href="#8421-åŒæ­¥ä¸å¼‚æ­¥" class="table-of-contents__link toc-highlight">8.4.2.1. åŒæ­¥ä¸å¼‚æ­¥</a></li><li><a href="#8422-é˜»å¡ä¸éé˜»å¡" class="table-of-contents__link toc-highlight">8.4.2.2. é˜»å¡ä¸éé˜»å¡</a></li><li><a href="#8423-å››ç§ç»„åˆ" class="table-of-contents__link toc-highlight">8.4.2.3. å››ç§ç»„åˆ</a></li></ul></li></ul></li><li><a href="#85-å¤šè·¯å¤ç”¨-io-å³-java-nio" class="table-of-contents__link toc-highlight">8.5. å¤šè·¯å¤ç”¨ IO å³ java nio</a><ul><li><a href="#851-è§£é‡Šå¤šè·¯å¤ç”¨" class="table-of-contents__link toc-highlight">8.5.1. è§£é‡Šå¤šè·¯å¤ç”¨</a></li><li><a href="#852-nio-å’Œ-io-åŒºåˆ«" class="table-of-contents__link toc-highlight">8.5.2. nio å’Œ io åŒºåˆ«</a></li><li><a href="#853-linux-ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ" class="table-of-contents__link toc-highlight">8.5.3. Linux ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ</a></li><li><a href="#854-æ ¸å¿ƒç»„ä»¶" class="table-of-contents__link toc-highlight">8.5.4. æ ¸å¿ƒç»„ä»¶</a><ul><li><a href="#8541-ç†è§£" class="table-of-contents__link toc-highlight">8.5.4.1. ç†è§£</a></li><li><a href="#8542-channels" class="table-of-contents__link toc-highlight">8.5.4.2. Channels</a></li><li><a href="#8543-buffers" class="table-of-contents__link toc-highlight">8.5.4.3. Buffers</a></li><li><a href="#8544-selectors" class="table-of-contents__link toc-highlight">8.5.4.4. Selectors</a></li></ul></li><li><a href="#855-nio-å®ç°ç½‘ç»œé€šä¿¡" class="table-of-contents__link toc-highlight">8.5.5. nio å®ç°ç½‘ç»œé€šä¿¡</a></li></ul></li><li><a href="#86-java-aio" class="table-of-contents__link toc-highlight">8.6. java aio</a></li><li><a href="#87-æ–­ç‚¹ç»­ä¼ " class="table-of-contents__link toc-highlight">8.7. æ–­ç‚¹ç»­ä¼ </a></li><li><a href="#111-å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µfp" class="table-of-contents__link toc-highlight">11.1. å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ(FP)</a></li><li><a href="#112-java8-æ·»åŠ çš„æ–°ç‰¹æ€§" class="table-of-contents__link toc-highlight">11.2. Java8 æ·»åŠ çš„æ–°ç‰¹æ€§</a><ul><li><a href="#1121-æ¥å£é»˜è®¤æ–¹æ³•" class="table-of-contents__link toc-highlight">11.2.1. æ¥å£é»˜è®¤æ–¹æ³•</a></li><li><a href="#1122-functionalinterface-å‡½æ•°æ¥å£" class="table-of-contents__link toc-highlight">11.2.2. @FunctionalInterface-å‡½æ•°æ¥å£</a></li><li><a href="#1123-æ–¹æ³•çš„å¼•ç”¨" class="table-of-contents__link toc-highlight">11.2.3. æ–¹æ³•çš„å¼•ç”¨</a></li><li><a href="#1124-lambda-è¡¨è¾¾å¼" class="table-of-contents__link toc-highlight">11.2.4. Lambda è¡¨è¾¾å¼</a><ul><li><a href="#11241-lambda-ä»‹ç»" class="table-of-contents__link toc-highlight">11.2.4.1. lambda ä»‹ç»</a></li><li><a href="#11242-lambda-ä½œç”¨åŸŸé—®é¢˜" class="table-of-contents__link toc-highlight">11.2.4.2. Lambda ä½œç”¨åŸŸé—®é¢˜</a><ul><li><a href="#112421-è®¿é—®å±€éƒ¨å˜é‡" class="table-of-contents__link toc-highlight">11.2.4.2.1. è®¿é—®å±€éƒ¨å˜é‡</a></li><li><a href="#112422-è®¿é—®æˆå‘˜å˜é‡" class="table-of-contents__link toc-highlight">11.2.4.2.2. è®¿é—®æˆå‘˜å˜é‡</a></li><li><a href="#112423-è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•" class="table-of-contents__link toc-highlight">11.2.4.2.3. è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•</a></li></ul></li></ul></li></ul></li><li><a href="#113-java8-ä¸­çš„å¹¶è¡Œæµ" class="table-of-contents__link toc-highlight">11.3. java8 ä¸­çš„å¹¶è¡Œæµ</a><ul><li><a href="#1131-ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®" class="table-of-contents__link toc-highlight">11.3.1. ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®</a></li><li><a href="#1132-ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ" class="table-of-contents__link toc-highlight">11.3.2. ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ</a></li><li><a href="#1133-å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼" class="table-of-contents__link toc-highlight">11.3.3. å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼</a></li></ul></li><li><a href="#114-completablefuture-æ¥å£-å¢å¼ºçš„-future" class="table-of-contents__link toc-highlight">11.4. CompletableFuture æ¥å£-å¢å¼ºçš„ Future</a><ul><li><a href="#1141-java-å¼‚æ­¥ç¼–ç¨‹" class="table-of-contents__link toc-highlight">11.4.1. java å¼‚æ­¥ç¼–ç¨‹</a></li><li><a href="#1142-åŸç†ä»‹ç»" class="table-of-contents__link toc-highlight">11.4.2. åŸç†ä»‹ç»</a></li><li><a href="#1143-completablefuture-api" class="table-of-contents__link toc-highlight">11.4.3. completablefuture api</a></li><li><a href="#1144-å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ" class="table-of-contents__link toc-highlight">11.4.4. å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……ç»“æœ</a></li><li><a href="#1145-å¼‚æ­¥æ‰§è¡Œä»»åŠ¡" class="table-of-contents__link toc-highlight">11.4.5. å¼‚æ­¥æ‰§è¡Œä»»åŠ¡</a></li><li><a href="#1146-æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª-function-å’Œ-å¼‚å¸¸å¤„ç†" class="table-of-contents__link toc-highlight">11.4.6. æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª function å’Œ å¼‚å¸¸å¤„ç†</a></li><li><a href="#1147-ç»„åˆå¤šä¸ª-completablefuture" class="table-of-contents__link toc-highlight">11.4.7. ç»„åˆå¤šä¸ª CompletableFuture</a></li></ul></li><li><a href="#115-stampedlock-è¯»å†™é”çš„æ”¹è¿›" class="table-of-contents__link toc-highlight">11.5. StampedLock-è¯»å†™é”çš„æ”¹è¿›</a></li><li><a href="#116-longadder-åŸå­ç±»çš„å¢å¼º" class="table-of-contents__link toc-highlight">11.6. LongAdder-åŸå­ç±»çš„å¢å¼º</a></li><li><a href="#117-java8-å†…ç½®å‡½æ•°å¼æ¥å£" class="table-of-contents__link toc-highlight">11.7. java8 å†…ç½®å‡½æ•°å¼æ¥å£</a><ul><li><a href="#1171-predicatesè°“è¯-æ–­å®š" class="table-of-contents__link toc-highlight">11.7.1. Predicates(è°“è¯, æ–­å®š)</a></li><li><a href="#1172-functionså‡½æ•°" class="table-of-contents__link toc-highlight">11.7.2. Functions(å‡½æ•°)</a></li><li><a href="#1173-suppliersç”Ÿäº§è€…" class="table-of-contents__link toc-highlight">11.7.3. Suppliers(ç”Ÿäº§è€…)</a></li><li><a href="#1174-consumersæ¶ˆè´¹è€…" class="table-of-contents__link toc-highlight">11.7.4. Consumers(æ¶ˆè´¹è€…)</a></li><li><a href="#1175-comparatorsæ¯”è¾ƒå™¨" class="table-of-contents__link toc-highlight">11.7.5. Comparators(æ¯”è¾ƒå™¨)</a></li><li><a href="#1176-optional" class="table-of-contents__link toc-highlight">11.7.6. Optional</a></li></ul></li><li><a href="#118-streamsç®¡é“" class="table-of-contents__link toc-highlight">11.8. Streams(ç®¡é“)</a><ul><li><a href="#1181-stream-ä»‹ç»" class="table-of-contents__link toc-highlight">11.8.1. stream ä»‹ç»</a></li><li><a href="#1182-é‡å¤ä½¿ç”¨-stream" class="table-of-contents__link toc-highlight">11.8.2. é‡å¤ä½¿ç”¨ stream</a></li><li><a href="#1183-map-å’Œ-flatmap" class="table-of-contents__link toc-highlight">11.8.3. map å’Œ flatMap</a></li><li><a href="#1184-å»é‡" class="table-of-contents__link toc-highlight">11.8.4. å»é‡</a></li><li><a href="#1185-collectæ–¹æ³•-å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´ -åˆ†ç»„-å»é‡" class="table-of-contents__link toc-highlight">11.8.5. collectæ–¹æ³• å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´  åˆ†ç»„ å»é‡</a></li><li><a href="#1186-stream-ä¸­å¼‚å¸¸å¤„ç†" class="table-of-contents__link toc-highlight">11.8.6. stream ä¸­å¼‚å¸¸å¤„ç†</a></li></ul></li><li><a href="#119-date-æ—¶é—´æ—¥æœŸæ–°çš„-api" class="table-of-contents__link toc-highlight">11.9. date æ—¶é—´æ—¥æœŸæ–°çš„ api</a><ul><li><a href="#1191-ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨" class="table-of-contents__link toc-highlight">11.9.1. ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨</a></li><li><a href="#1192-ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ-api" class="table-of-contents__link toc-highlight">11.9.2. ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ api</a></li><li><a href="#1193-ç»Ÿè®¡ä»£ç è€—æ—¶" class="table-of-contents__link toc-highlight">11.9.3. ç»Ÿè®¡ä»£ç è€—æ—¶</a></li></ul></li><li><a href="#1110-å¯é‡å¤çš„-annotations" class="table-of-contents__link toc-highlight">11.10. å¯é‡å¤çš„ Annotations</a></li><li><a href="#1111-base64-ç¼–ç " class="table-of-contents__link toc-highlight">11.11. base64 ç¼–ç </a></li><li><a href="#1112-map-æ˜ å°„çš„æ–°æ–¹æ³•" class="table-of-contents__link toc-highlight">11.12. map æ˜ å°„çš„æ–°æ–¹æ³•</a></li><li><a href="#121-java-module" class="table-of-contents__link toc-highlight">12.1. java module</a></li><li><a href="#122-jshell" class="table-of-contents__link toc-highlight">12.2. jshell</a></li><li><a href="#123-var-ç±»å‹æ¨æ–­" class="table-of-contents__link toc-highlight">12.3. var ç±»å‹æ¨æ–­</a></li><li><a href="#124-jdk-api-enhencement" class="table-of-contents__link toc-highlight">12.4. jdk api enhencement</a></li><li><a href="#125-æ”¹è¿›-java-ç¨‹åºåœ¨-docker-ä¸­çš„è¡¨ç°" class="table-of-contents__link toc-highlight">12.5. æ”¹è¿› java ç¨‹åºåœ¨ docker ä¸­çš„è¡¨ç°</a></li><li><a href="#126-æ–°çš„åƒåœ¾å›æ”¶å™¨" class="table-of-contents__link toc-highlight">12.6. æ–°çš„åƒåœ¾å›æ”¶å™¨</a></li><li><a href="#131-classloader-çš„æ¦‚å¿µ" class="table-of-contents__link toc-highlight">13.1. classloader çš„æ¦‚å¿µ</a></li><li><a href="#132-å±‚çº§ç»“æ„" class="table-of-contents__link toc-highlight">13.2. å±‚çº§ç»“æ„</a></li><li><a href="#133-å·¥ä½œè¿‡ç¨‹-and-åŒäº²å§”æ´¾æ¨¡å¼" class="table-of-contents__link toc-highlight">13.3. å·¥ä½œè¿‡ç¨‹ and åŒäº²å§”æ´¾æ¨¡å¼</a></li><li><a href="#134-çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„" class="table-of-contents__link toc-highlight">13.4. çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„</a></li><li><a href="#135-å€ŸåŠ©-classloader-å®ç°ç±»éš”ç¦»" class="table-of-contents__link toc-highlight">13.5. å€ŸåŠ© classloader å®ç°ç±»éš”ç¦»</a></li><li><a href="#136-ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸" class="table-of-contents__link toc-highlight">13.6. ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸</a></li><li><a href="#137-è‡ªå®šä¹‰-classloaderåŠ è½½ç½‘ç»œä¸Šçš„-class" class="table-of-contents__link toc-highlight">13.7. è‡ªå®šä¹‰ classloader(åŠ è½½ç½‘ç»œä¸Šçš„ class)</a></li><li><a href="#141-è·å–-classpath-å’Œ-ç³»ç»Ÿå±æ€§-ç¯å¢ƒå˜é‡" class="table-of-contents__link toc-highlight">14.1. è·å– classpath å’Œ ç³»ç»Ÿå±æ€§ ç¯å¢ƒå˜é‡</a></li><li><a href="#151-å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´" class="table-of-contents__link toc-highlight">15.1. å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´</a></li><li><a href="#152-double-ç±»å‹çš„åŠ å‡ä¹˜é™¤" class="table-of-contents__link toc-highlight">15.2. double ç±»å‹çš„åŠ å‡ä¹˜é™¤</a></li><li><a href="#161-æ‰“-jar-åŒ…" class="table-of-contents__link toc-highlight">16.1. æ‰“ jar åŒ…</a></li><li><a href="#162-ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£-javadoc" class="table-of-contents__link toc-highlight">16.2. ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£ javadoc</a></li><li><a href="#163-ç¼–è¯‘å’Œåç¼–è¯‘" class="table-of-contents__link toc-highlight">16.3. ç¼–è¯‘å’Œåç¼–è¯‘</a></li><li><a href="#171-object" class="table-of-contents__link toc-highlight">17.1. Object</a></li><li><a href="#172-string" class="table-of-contents__link toc-highlight">17.2. String</a></li><li><a href="#181-javassist" class="table-of-contents__link toc-highlight">18.1. javassist</a></li><li><a href="#191-graalvm" class="table-of-contents__link toc-highlight">19.1. graalvm</a></li><li><a href="#192-vertx" class="table-of-contents__link toc-highlight">19.2. vertx</a></li><li><a href="#193-micronaut" class="table-of-contents__link toc-highlight">19.3. Micronaut</a></li><li><a href="#194-quarkus" class="table-of-contents__link toc-highlight">19.4. Quarkus</a></li><li><a href="#201-æ­£åˆ™è¡¨è¾¾å¼-regex" class="table-of-contents__link toc-highlight">20.1. æ­£åˆ™è¡¨è¾¾å¼ regex</a></li><li><a href="#202-é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š" class="table-of-contents__link toc-highlight">20.2. é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š</a></li><li><a href="#203-é‡è½½-and-é‡å†™" class="table-of-contents__link toc-highlight">20.3. é‡è½½ and é‡å†™</a></li><li><a href="#204-java-å€¼ä¼ é€’-or-å¼•ç”¨ä¼ é€’" class="table-of-contents__link toc-highlight">20.4. java å€¼ä¼ é€’ or å¼•ç”¨ä¼ é€’</a></li><li><a href="#205-è®¿é—®ä¿®é¥°ç¬¦-public-protect-default-private" class="table-of-contents__link toc-highlight">20.5. è®¿é—®ä¿®é¥°ç¬¦ public-protect-default-private</a></li><li><a href="#206-getcontextclassloadergetclassloader-åŒºåˆ«" class="table-of-contents__link toc-highlight">20.6. getcontextclassloader&amp;getclassloader åŒºåˆ«</a></li><li><a href="#207-getter-å’Œ-setter-å­˜åœ¨çš„æ„ä¹‰" class="table-of-contents__link toc-highlight">20.7. getter å’Œ setter å­˜åœ¨çš„æ„ä¹‰</a></li><li><a href="#208-ä¸ºä»€ä¹ˆ-service-åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£" class="table-of-contents__link toc-highlight">20.8. ä¸ºä»€ä¹ˆ service åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£</a></li><li><a href="#209-static-å…³é”®å­—" class="table-of-contents__link toc-highlight">20.9. static å…³é”®å­—</a></li><li><a href="#2010-å†…éƒ¨ç±»-or-é™æ€å†…éƒ¨ç±»" class="table-of-contents__link toc-highlight">20.10. å†…éƒ¨ç±» or é™æ€å†…éƒ¨ç±»</a><ul><li><a href="#20101-å†…éƒ¨ç±»" class="table-of-contents__link toc-highlight">20.10.1. å†…éƒ¨ç±»</a></li><li><a href="#20102-é™æ€å†…éƒ¨ç±»" class="table-of-contents__link toc-highlight">20.10.2. é™æ€å†…éƒ¨ç±»</a></li></ul></li><li><a href="#2011-java-ç±»åˆå§‹åŒ–é¡ºåº" class="table-of-contents__link toc-highlight">20.11. Java ç±»åˆå§‹åŒ–é¡ºåº</a></li><li><a href="#2012-random-éšæœºæ•°" class="table-of-contents__link toc-highlight">20.12. Random-éšæœºæ•°</a></li><li><a href="#2013-ä½è¿ç®—" class="table-of-contents__link toc-highlight">20.13. ä½è¿ç®—</a></li><li><a href="#2014-ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™" class="table-of-contents__link toc-highlight">20.14. ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™</a></li><li><a href="#2015-å¤„ç†-unicode-ç¼–ç é—®é¢˜" class="table-of-contents__link toc-highlight">20.15. å¤„ç† unicode ç¼–ç é—®é¢˜</a></li><li><a href="#2016-ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡" class="table-of-contents__link toc-highlight">20.16. ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡</a></li><li><a href="#2017-ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼" class="table-of-contents__link toc-highlight">20.17. ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼</a></li><li><a href="#211-åšå®¢-cms-ç³»ç»Ÿ" class="table-of-contents__link toc-highlight">21.1. åšå®¢ cms ç³»ç»Ÿ</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.b94328d8.js"></script>
<script src="/en/assets/js/main.fc98d8e0.js"></script>
</body>
</html>