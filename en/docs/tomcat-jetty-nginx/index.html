<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-tomcat-jetty-nginx">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Tomcat Jetty Nginx ç­‰ web å®¹å™¨ - Xiaoyureed çš„ç½‘ç»œ Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xiaoyureed.github.io/en/img/logo.webp"><meta data-rh="true" name="twitter:image" content="https://xiaoyureed.github.io/en/img/logo.webp"><meta data-rh="true" property="og:url" content="https://xiaoyureed.github.io/en/docs/tomcat-jetty-nginx"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="xiaoyureed"><meta data-rh="true" name="keywords" content="blog, java, spring, microservice, python, rust, typescript, react, web"><meta data-rh="true" name="keywords" content=" åŠè·¯è½¬è¡Œçš„ç¼–ç¨‹çˆ±å¥½è€…, å†™è¿‡ Python, Rust, ç°åœ¨ä¸»æ”» Java åˆ†å¸ƒå¼ç³»ç»Ÿ"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tomcat Jetty Nginx ç­‰ web å®¹å™¨ - Xiaoyureed çš„ç½‘ç»œ Wiki"><meta data-rh="true" name="description" content="caddy ä»£æ›¿ NGINX"><meta data-rh="true" property="og:description" content="caddy ä»£æ›¿ NGINX"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xiaoyureed.github.io/en/docs/tomcat-jetty-nginx"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/en/docs/tomcat-jetty-nginx" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/tomcat-jetty-nginx" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://xiaoyureed.github.io/docs/tomcat-jetty-nginx" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5SAMPKXTP9-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Xiaoyureed çš„ç½‘ç»œ Wiki" href="/en/opensearch.xml">


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f6da56a47f5085d1e0fedae39b8de00a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/en/rss.xml" title="xiaoyureed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/atom.xml" title="xiaoyureed Atom Feed">
<link rel="alternate" type="application/json" href="/en/feed.json" title="xiaoyureed JSON Feed">

<link rel="icon" href="/en/img/logo.webp">
<link rel="manifest" href="/en/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)">
<meta name="description" content="Xiaoyureed çš„ä¸ªäººåšå®¢"><link rel="stylesheet" href="/en/assets/css/styles.261d8673.css">
<link rel="preload" href="/en/assets/js/runtime~main.7df8c467.js" as="script">
<link rel="preload" href="/en/assets/js/main.82e41e7b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><a href="/docs/rust-note" target="_blank">Rust æŒ‡åŒ—, æ¬¢è¿æŸ¥çœ‹...</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">kuizuo</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">èœå•</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/archive">åšå®¢</a></li><li><a class="dropdown__link" href="/en/docs/intro">æ•™ç¨‹</a></li><li><a class="dropdown__link" href="/en/resource">Links</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/en/"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.webp" alt="xiaoyureed" class="themedImage_ToTc themedImage--dark_i4oU"><b>kuizuo</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/SpringBoot-note">Spring Boot å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/autohotkey">Autohotkey è„šæœ¬</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/blockchain">blockchainåŒºå—é“¾</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/c-sharp-and-dot-net">C# &amp; .NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/chatgpt">Chatgpt Usage Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cpp">CPP and C å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cross-gfw">Cross The GFW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/cs-note">Computer Science Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/css-pre-processor">å‡ ç§CSSé¢„å¤„ç†å™¨æ¯”è¾ƒé€‰å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/data-structure-and-algorithm">Data Structure and Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/design-pattern-note">Design Pattern ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/dev-resources">å¼€å‘è€…èµ„æº</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/distributed-system">Distributed System åˆ†å¸ƒå¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/docker-note-virtual-dev-env">Docker Note &amp; Other Virtual Develop Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/effective-java-reading-note">Effective Java é˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/elk-elastic-log">Distributed log collectionåˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/english-note">è‹±è¯­å­¦ä¹ ğŸ”¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/extjs-note">Extjs ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/git-note">Git å¤‡å¿˜ ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/golang-note">Golang ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/gps-gis-tracing">åŸºäºåœ°ç†ä½ç½®å¼€å‘æŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/gradle">Gradle note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/greasy-monkey">æ²¹çŒ´æ’ä»¶&amp;ç¼–å†™è„šæœ¬ğŸ’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/groovy-note">groovy note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/health">Health å…³çˆ±ç¨‹åºå‘˜å¥åº·ğŸ¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/how-to-test-java-app">How to Test Java App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/interview-system-design">ç³»ç»Ÿè®¾è®¡ System design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/iot">Iot ç‰©è”ç½‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-code-clean">Java Clean Code Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-concurrent">Java ConcurrentğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-memory-model-jmm-jvm">JMM and GCğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/java-note">Java Core ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/js-tutorial">JavaScript tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/kotlin">kotlin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/kubernetes-k8s">kubernetes-k8s â˜ï¸</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/linux-note">é¸Ÿå“¥çš„ Linux ç§æˆ¿èœé˜…è¯»ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/low-code-platform">å…³äºä½ä»£ç å¹³å°çš„è°ƒç ”</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mac">Mac å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/machine-learning-ml">machine-learning-ml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/marketing-seo">Marketing SEO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/maven-note">Maven NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/message-queue">Message QueueğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/money">Investment Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mongodb-note">MongoDB NotesğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/monitor-system-grafana-prometheus-influxdb-hbase-time-serials-database">monitor-system-grafana-prometheusç›‘æ§ğŸ–¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mvc-mvvm">MVC to MVVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/mybatis-note">MyBatis Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/netty-note">netty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/nlp-natural-language-processing">nlp-natural-language-processingğŸ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/nodejs-yarn-npm">Nodejs, Yarn, Npm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/oracle">Oracle å¤‡å¿˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-audio-video">Audio and Video development Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-big-data-introduce">å¤§æ•°æ®å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-cache">Cache ç¼“å­˜ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-computational-ad">è®¡ç®—å¹¿å‘Š Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-crawler-spider">ç½‘ç»œçˆ¬è™« Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-db-design-note">å…³ç³»å‹æ•°æ®åº“è¡¨è®¾è®¡ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-desktop-develop">æ¡Œé¢åº”ç”¨å¼€å‘ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-http-restful">HTTP protocol Intro &amp; RESTful</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-reactive-programming">å“åº”å¼ç¼–ç¨‹ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-rpc">RPC Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/outline-about-rule-engine-note">è§„åˆ™å¼•æ“ Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/php-note">PHP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/postgres-note">Postgres noteğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/process-workflow-bpm-engine">å·¥ä½œæµå¼•æ“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/protect-your-app-authentication-oauth2-jwt-https">Protect Your App å®‰å…¨ä¿æŠ¤è®¤è¯é‰´æƒğŸ”‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/psychology">psychology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/python-note">PythonğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/quant-money">é‡åŒ–äº¤æ˜“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/quarkus">Quarkus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/react-note">ReactğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/real-time-communication-protocol">å®æ—¶é€šä¿¡ Real-time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/redis-note">RedisğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/regex">Regular Expression æ­£åˆ™ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/rust-note">Rust ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/scala-akka-play-framework">Scala è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/serverless">Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/service-mesh">service mesh æœåŠ¡ç½‘æ ¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/servlet">Servlet Note</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/shell-bash-note">shell-bashè„šæœ¬æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/spring-note">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/springcloud-note">Spring Cloud ç¬”è®°ğŸŒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/springmvc-note">Spring MVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/task-schedule-note">Task Schedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/tcp-ip-note-p2p">TCP IP, p2p</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/en/docs/tomcat-jetty-nginx">Tomcat Jetty Nginx ç­‰ web å®¹å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/vertx">Vertx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/video-creator">æ‹æ‘„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/vue">Vue Brief Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/webassembly">webassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/webpack-esbuild-vite-rollup">å‰ç«¯æ‰“åŒ…æ„å»ºå·¥å…·</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tomcat Jetty Nginx ç­‰ web å®¹å™¨</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tomcat Jetty Nginx ç­‰ web å®¹å™¨</h1></header><div align="center">caddy ä»£æ›¿ NGINX<p>æ¯”è¾ƒTomcat, jetty, Nginx; ç¬”è®°
references: <a href="https://www.zhihu.com/question/32212996" target="_blank" rel="noopener noreferrer">1</a>, <a href="https://blog.csdn.net/zhongyanpingzzz/article/details/50353111" target="_blank" rel="noopener noreferrer">2</a>,</p></div><ul><li><a href="#%E6%AF%94%E8%BE%83">æ¯”è¾ƒ</a><ul><li><a href="#tomcat%E5%92%8Cjetty">Tomcatå’Œjetty</a></li><li><a href="#apache-http-server%E5%92%8Cnginx">Apache http serverå’ŒNginx</a></li></ul></li><li><a href="#nginx">nginx</a><ul><li><a href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">ä½¿ç”¨åœºæ™¯</a></li><li><a href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">å¸¸ç”¨å‘½ä»¤</a></li><li><a href="#nginx-%E6%97%A0%E6%B3%95%E5%81%9C%E6%AD%A2-%E6%97%A0%E6%B3%95%E9%87%8D%E5%90%AF">nginx æ— æ³•åœæ­¢ æ— æ³•é‡å¯</a></li><li><a href="#nginxconf-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">nginx.conf é…ç½®æ–‡ä»¶</a><ul><li><a href="#%E6%9C%80%E7%AE%80%E9%85%8D%E7%BD%AE">æœ€ç®€é…ç½®</a></li><li><a href="#%E9%85%8D%E7%BD%AE%E8%AF%AD%E6%B3%95">é…ç½®è¯­æ³•</a><ul><li><a href="#location">location</a></li><li><a href="#proxy_pass">proxy<!-- -->_<!-- -->pass</a></li></ul></li><li><a href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE">åå‘ä»£ç†é…ç½®</a></li><li><a href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%85%8D%E7%BD%AE">è´Ÿè½½å‡è¡¡é…ç½®</a></li><li><a href="#gzip-%E5%8E%8B%E7%BC%A9">gzip å‹ç¼©</a></li><li><a href="#websocket-%E9%85%8D%E7%BD%AE">websocket é…ç½®</a></li><li><a href="#%E6%90%AD%E5%BB%BA%E8%B0%B7%E6%AD%8C%E9%95%9C%E5%83%8F%E7%AB%99">æ­å»ºè°·æ­Œé•œåƒç«™</a></li><li><a href="#%E4%B8%8A-https">ä¸Š https</a></li><li><a href="#%E7%BB%84%E6%88%90%E5%85%83%E7%B4%A0">ç»„æˆå…ƒç´ </a></li></ul></li><li><a href="#%E6%90%AD%E9%85%8D-docker-%E4%BD%BF%E7%94%A8">æ­é… docker ä½¿ç”¨</a></li><li><a href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%85%8D%E7%BD%AEdemo">è´Ÿè½½å‡è¡¡é…ç½®demo</a></li><li><a href="#nginx%E5%92%8Clua%E8%84%9A%E6%9C%AC">nginxå’Œluaè„šæœ¬</a></li><li><a href="#tengine">tengine</a></li><li><a href="#nginx-%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91">nginx æ¨¡å—å¼€å‘</a></li><li><a href="#nginx-lua-%E5%BC%80%E5%8F%91%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9C%8D%E5%8A%A1">nginx-lua å¼€å‘é«˜å¹¶å‘æœåŠ¡</a></li><li><a href="#nginx%E9%9D%A2%E8%AF%95%E9%A2%98">nginxé¢è¯•é¢˜</a><ul><li><a href="#nginx%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%B9%B6%E5%8F%91%E7%9A%84">nginxæ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„</a></li><li><a href="#nginx-%E5%92%8C-apache-%E5%8C%BA%E5%88%AB">nginx å’Œ apache åŒºåˆ«</a></li><li><a href="#fastcgi-%E4%B8%8E-cgi-%E7%9A%84%E5%8C%BA%E5%88%AB">fastcgi ä¸ cgi çš„åŒºåˆ«</a></li></ul></li><li><a href="#nginx-%E9%85%8D%E7%BD%AE%E8%B0%83%E4%BC%98">NGINX é…ç½®è°ƒä¼˜</a></li></ul></li><li><a href="#jetty">jetty</a><ul><li><a href="#%E9%83%A8%E7%BD%B2-app-%E5%88%B0-jetty-%E5%86%85%E9%83%A8">éƒ¨ç½² app åˆ° jetty å†…éƒ¨</a></li><li><a href="#jetty%E6%94%AF%E6%8C%81servlet30%E6%B3%A8%E8%A7%A3">jettyæ”¯æŒservlet3.0æ³¨è§£</a></li><li><a href="#jetty%E7%9A%84%E6%95%B4%E4%B8%AA%E7%BB%93%E6%9E%84">jettyçš„æ•´ä¸ªç»“æ„</a></li><li><a href="#jetty%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B">Jettyçš„å·¥ä½œè¿‡ç¨‹</a><ul><li><a href="#%E5%90%AF%E5%8A%A8">å¯åŠ¨</a></li><li><a href="#%E6%8E%A5%E5%8F%97%E8%AF%B7%E6%B1%82">æ¥å—è¯·æ±‚</a></li><li><a href="#%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82">å¤„ç†è¯·æ±‚</a></li></ul></li></ul></li><li><a href="#tomcat">Tomcat</a><ul><li><a href="#tomcat-%E6%80%BB%E4%BD%93%E7%BB%93%E6%9E%84">Tomcat æ€»ä½“ç»“æ„</a><ul><li><a href="#connector">Connector</a></li><li><a href="#container">Container</a></li></ul></li><li><a href="#%E7%94%A8%E5%88%B0%E4%BA%86%E5%93%AA%E4%BA%9B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼</a><ul><li><a href="#facade">Facade</a></li><li><a href="#observer">Observer</a></li><li><a href="#command">Command</a></li><li><a href="#chain-of-responsibility">Chain of responsibility</a></li></ul></li><li><a href="#tomcat-%E4%BC%98%E5%8C%96">Tomcat ä¼˜åŒ–</a></li></ul></li></ul><h1>æ¯”è¾ƒ</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tomcatå’Œjetty">Tomcatå’Œjetty<a href="#tomcatå’Œjetty" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><ul><li><p>jettyå’ŒTomcatç±»ä¼¼, å‡ä¸ºservletå®¹å™¨ - ä»–ä»¬éƒ½æ”¯æŒæ ‡å‡†çš„servletè§„èŒƒå’ŒJavaEEçš„è§„èŒƒ</p></li><li><p>jettyæ¯”Tomcatè½»é‡çº§</p></li><li><p>Jettyæ¯”tomcatæ›´å®¹æ˜“æ‰©å±•</p><ul><li><p>jettyçš„æ¶æ„æ˜¯åŸºäºHandleræ¥å®ç°çš„ï¼Œä¸»è¦çš„æ‰©å±•åŠŸèƒ½éƒ½å¯ä»¥ç”¨Handleræ¥å®ç°ï¼Œæ‰©å±•ç®€å•. Tomcatçš„æ¶æ„æ˜¯åŸºäºå®¹å™¨è®¾è®¡çš„ï¼Œè¿›è¡Œæ‰©å±•æ˜¯éœ€è¦äº†è§£Tomcatçš„æ•´ä½“è®¾è®¡ç»“æ„ï¼Œä¸æ˜“æ‰©å±•ã€‚</p></li><li><p>jettyæ˜¯ä½¿ç”¨javaç¼–å†™çš„ï¼Œä»–çš„apiæ˜¯ä¸€ç»„ä»¥jaråŒ…çš„å½¢å¼å‘å¸ƒï¼Œå¼€å‘äººå‘˜å¯ä»¥å°†jettyå®¹å™¨å®ä¾‹åŒ–æˆä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥è¿…é€Ÿä¸ºä¸€äº›ç‹¬ç«‹ï¼ˆstand-aloneï¼‰çš„javaåº”ç”¨æä¾›ç½‘ç»œå’Œwebé“¾æ¥</p></li></ul></li><li><p>ä¸»æ”»æ–¹å‘ä¸åŒ:</p><ul><li>jettyå¯ä»¥åˆ©ç”¨ Continuation æœºåˆ¶æ¥å¤„ç†å¤§é‡çš„ç”¨æˆ·è¯·æ±‚ä»¥åŠæ—¶é—´æ¯”è¾ƒé•¿çš„è¿æ¥, é€‚åˆäºwebèŠå¤©åº”ç”¨ç­‰ç­‰,åƒæ·˜å®çš„ web æ—ºæ—ºå°±æ˜¯ç”¨ Jetty ä½œä¸º Servlet å¼•æ“; </li><li>Tomcaté€‚åˆå¤„ç†å°‘æ•°éå¸¸ç¹å¿™çš„é“¾æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´é“¾æ¥ç”Ÿå‘½å‘¨æœŸçŸ­çš„è¯ï¼ŒTomcatçš„æ€»ä½“æ€§èƒ½æ›´é«˜</li></ul></li><li><p>Tomcaté»˜è®¤é‡‡ç”¨BIOå¤„ç†I/Oè¯·æ±‚ï¼Œåœ¨å¤„ç†é™æ€èµ„æºæ—¶ï¼Œæ€§èƒ½è¾ƒå·®ã€‚Jettyé»˜è®¤é‡‡ç”¨NIOåœ¨å¤„ç†I/Oè¯·æ±‚ä¸Šæ›´å ä¼˜åŠ¿ï¼Œåœ¨å¤„ç†é™æ€èµ„æºæ—¶ï¼Œæ€§èƒ½è¾ƒé«˜</p></li><li><p>Jettyæ›´æ»¡è¶³å…¬æœ‰äº‘çš„åˆ†å¸ƒå¼ç¯å¢ƒçš„éœ€æ±‚ ,æ¯”å¦‚ Google app engine ï¼Œè€ŒTomcatæ›´ç¬¦åˆä¼ä¸šçº§ç¯å¢ƒ</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="apache-http-serverå’Œnginx">Apache http serverå’ŒNginx<a href="#apache-http-serverå’Œnginx" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><ul><li><p>Nginxç±»ä¼¼äºApache http server, ä¸åƒTomcatå¯ä»¥æ”¯æŒç”ŸæˆåŠ¨æ€é¡µé¢ï¼Œä½†å®ƒä»¬å¯ä»¥é€šè¿‡å…¶ä»–æ¨¡å—æ¥æ”¯æŒï¼ˆä¾‹å¦‚é€šè¿‡Shellã€PHPã€Pythonè„šæœ¬ç¨‹åºæ¥åŠ¨æ€ç”Ÿæˆå†…å®¹ï¼‰</p></li><li><p>Tomcaté€šå¸¸å’ŒNginxé…åˆä½¿ç”¨</p><ul><li><p>åŠ¨é™æ€èµ„æºåˆ†ç¦»â€”â€”è¿ç”¨Nginxçš„åå‘ä»£ç†åŠŸèƒ½åˆ†å‘è¯·æ±‚ï¼šæ‰€æœ‰åŠ¨æ€èµ„æºçš„è¯·æ±‚äº¤ç»™Tomcatï¼Œè€Œé™æ€èµ„æºçš„è¯·æ±‚ï¼ˆä¾‹å¦‚å›¾ç‰‡ã€è§†é¢‘ã€CSSã€JavaScriptæ–‡ä»¶ç­‰ï¼‰åˆ™ç›´æ¥ç”±Nginxè¿”å›åˆ°æµè§ˆå™¨ï¼Œè¿™æ ·èƒ½å¤§å¤§å‡è½»Tomcatçš„å‹åŠ›ã€‚</p></li><li><p>è´Ÿè½½å‡è¡¡ï¼Œå½“ä¸šåŠ¡å‹åŠ›å¢å¤§æ—¶ï¼Œå¯èƒ½ä¸€ä¸ªTomcatçš„å®ä¾‹ä¸è¶³ä»¥å¤„ç†ï¼Œé‚£ä¹ˆè¿™æ—¶å¯ä»¥å¯åŠ¨å¤šä¸ªTomcatå®ä¾‹è¿›è¡Œæ°´å¹³æ‰©å±•ï¼Œè€ŒNginxçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½å¯ä»¥æŠŠè¯·æ±‚é€šè¿‡ç®—æ³•åˆ†å‘åˆ°å„ä¸ªä¸åŒçš„å®ä¾‹è¿›è¡Œå¤„ç†</p></li></ul></li><li><p>Nginxç›¸å¯¹äºApacheçš„ä¼˜ç‚¹: è½»é‡çº§; æŠ—å¹¶å‘(nginx å¤„ç†è¯·æ±‚æ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼Œè€Œapache åˆ™æ˜¯é˜»å¡å‹çš„); é«˜åº¦æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œç¼–å†™æ¨¡å—ç›¸å¯¹ç®€å•; æä¾›è´Ÿè½½å‡è¡¡;</p></li><li><p>Apacheä¼˜ç‚¹: apacheçš„ rewrite æ¯”nginx çš„å¼ºå¤§; æ€§èƒ½ç¨³å®šï¼Œè€Œnginxç›¸å¯¹bugè¾ƒå¤š; Apache å¯¹ PHP æ”¯æŒæ¯”è¾ƒç®€å•ï¼ŒNginx éœ€è¦é…åˆå…¶ä»–åç«¯ç”¨</p><ul><li>apache rewrite -&gt; <a href="http://httpd.apache.org/docs/current/rewrite/" target="_blank" rel="noopener noreferrer">http://httpd.apache.org/docs/current/rewrite/</a>, ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯å®ç°URLçš„è·³è½¬</li></ul></li></ul><h1>nginx</h1><p><a href="https://www.zhihu.com/question/266535644?sort=created" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/266535644?sort=created</a>
<a href="http://openresty.org/en/" target="_blank" rel="noopener noreferrer">http://openresty.org/en/</a>   nginx å’Œ lua</p><p><a href="https://github.com/jaywcjlove/nginx-tutorial" target="_blank" rel="noopener noreferrer">https://github.com/jaywcjlove/nginx-tutorial</a></p><p><a href="https://docshome.gitbook.io/nginx-docs/" target="_blank" rel="noopener noreferrer">https://docshome.gitbook.io/nginx-docs/</a> ä¸­æ–‡æ–‡æ¡£</p><p><a href="https://github.com/dunwu/nginx-tutorial" target="_blank" rel="noopener noreferrer">https://github.com/dunwu/nginx-tutorial</a> å…¥é—¨</p><p><a href="https://github.com/caddyserver/caddy" target="_blank" rel="noopener noreferrer">https://github.com/caddyserver/caddy</a> æ›¿ä»£ nginx , è‡ªåŠ¨æ”¯æŒ https</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯<a href="#ä½¿ç”¨åœºæ™¯" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><ul><li><p>é™æ€webæœåŠ¡å™¨, </p></li><li><p>è´Ÿè½½å‡è¡¡, </p></li><li><p>åå‘ä»£ç†</p><p>  (ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å—internetä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™internetä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚)å›¾ç¤º:</p></li><li><p>http ç¼“å­˜</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤<a href="#å¸¸ç”¨å‘½ä»¤" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># -s å³signal, å‘ nginx å‘é€ start|reload|stop å‘½ä»¤çš„æ„æ€ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -s start;     # å¯åŠ¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">./sbin/nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -s stop       # å¿«é€Ÿå…³é—­Nginxï¼Œå¯èƒ½ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿…é€Ÿç»ˆæ­¢webæœåŠ¡ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -s quit       # å¹³ç¨³å…³é—­Nginxï¼Œä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å®‰æ’çš„ç»“æŸwebæœåŠ¡ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -s reload     # å› æ”¹å˜äº†Nginxç›¸å…³é…ç½®ï¼Œéœ€è¦é‡æ–°åŠ è½½é…ç½®è€Œé‡è½½ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -s reopen     # é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -c filename   # ä¸º Nginx æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥ä»£æ›¿ç¼ºçœçš„ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -t            # æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•çš„æ­£ç¡®æ€§ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    # ä¸è¿è¡Œï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nginx -v            # æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginx-æ— æ³•åœæ­¢-æ— æ³•é‡å¯">nginx æ— æ³•åœæ­¢ æ— æ³•é‡å¯<a href="#nginx-æ— æ³•åœæ­¢-æ— æ³•é‡å¯" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">netstat -tunlp |grep nginx # æ‰¾åˆ°æš´éœ²çš„ç«¯å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fuser -k 80/tcp # æ€æ­»è®¿é—®æŒ‡å®šæ–‡ä»¶/ç½‘ç»œsocketçš„æ‰€æœ‰è¿›ç¨‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fuser -k 8088/tcp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginxconf-é…ç½®æ–‡ä»¶">nginx.conf é…ç½®æ–‡ä»¶<a href="#nginxconf-é…ç½®æ–‡ä»¶" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æœ€ç®€é…ç½®">æœ€ç®€é…ç½®<a href="#æœ€ç®€é…ç½®" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  listen       80;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  server_name  localhost;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    root   /usr/share/nginx/html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    index  index.html index.htm;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    try_files $uri /index.html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é…ç½®è¯­æ³•">é…ç½®è¯­æ³•<a href="#é…ç½®è¯­æ³•" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p><a href="https://thinking.renzhansheng.cn/pages/nginx/" target="_blank" rel="noopener noreferrer">https://thinking.renzhansheng.cn/pages/nginx/</a></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="location">location<a href="#location" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">location [ = | ~ | ~* | ^~ | @ ] uri { ... }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">åŒ¹é…æ–¹å¼(ä¼˜å…ˆçº§ç”±é«˜åˆ°ä½)ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ç²¾ç¡®åŒ¹é…ï¼šä½¿ç”¨ä¿®é¥°ç¬¦=ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    å‰ç¼€åŒ¹é…ï¼šä½¿ç”¨ä¿®é¥°ç¬¦^~ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    æ­£åˆ™åŒ¹é…ï¼šä½¿ç”¨ä¿®é¥°ç¬¦~ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰å’Œ~*ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    æœ€é•¿åŒ¹é…ï¼šæ²¡æœ‰ä¿®é¥°ç¬¦ï¼Œä½¿ç”¨åŒ¹é…åˆ°çš„æœ€é•¿è®°å½•ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    nginxå†…éƒ¨è·³è½¬: @</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location /img/ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    error_page 404 @img_err;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#ä»¥ /img/ å¼€å¤´çš„è¯·æ±‚ï¼Œå¦‚æœé“¾æ¥çš„çŠ¶æ€ä¸º 404, åˆ™ä¼šåŒ¹é…åˆ° @img_err è¿™æ¡è§„åˆ™ä¸Šã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location @img_err {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # è§„åˆ™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ç²¾ç¡®åŒ¹é…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åªåŒ¹é…è¯·æ±‚/ , è¯·æ±‚/ç²¾å‡†åŒ¹é…Aï¼Œä¸å†å¾€ä¸‹æŸ¥æ‰¾</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location = / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ configuration A ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ­£åˆ™åŒ¹é…ï¼Œä¸åŒºåˆ†å¤§å°å†™</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># é€šè¿‡åç¼€åŒ¹é…å›¾ç‰‡, /images/.../1.jpg</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¯·æ±‚/index.htmlåŒ¹é…Bã€‚é¦–å…ˆæ‰¾åˆ°æœ€é•¿åŒ¹é…Bï¼Œæ¥ç€åˆæŒ‰ç…§é¡ºåºæŸ¥æ‰¾åŒ¹é…çš„æ­£åˆ™ã€‚ç»“æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå› æ­¤ä½¿ç”¨å…ˆå‰æ ‡è®°çš„æœ€é•¿åŒ¹é…ï¼Œå³é…ç½®Bã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¯·æ±‚/documents/about.htmlåŒ¹é…Bã€‚å› ä¸ºBè¡¨ç¤ºä»»ä½•ä»¥/å¼€å¤´çš„URLéƒ½åŒ¹é…ã€‚åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œåªæœ‰Bèƒ½æ»¡è¶³ï¼Œæ‰€ä»¥åŒ¹é…Bã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location ~* \.(gif|jpg|jpeg)$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ configuration B ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å‰ç¼€åŒ¹é…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åŒ¹é… /images/xxx/yyyy</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¯·æ±‚/user/index.htmlåŒ¹é…Cã€‚é¦–å…ˆæ‰¾åˆ°æœ€é•¿åŒ¹é…Cï¼Œç”±äºåé¢æ²¡æœ‰åŒ¹é…çš„æ­£åˆ™ï¼Œæ‰€ä»¥ä½¿ç”¨æœ€é•¿åŒ¹é…Cã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location ^~ /images/ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ configuration C ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å‰ç¼€åŒ¹é…</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># åŒ¹é… /img/xxx/yyyy, /imgx,/imgy/abc/1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¯·æ±‚/images/1.jpgåŒ¹é…Dã€‚é¦–å…ˆè¿›è¡Œå‰ç¼€å­—ç¬¦çš„æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æœ€é•¿åŒ¹é…Dã€‚ä½†æ˜¯ï¼Œç‰¹æ®Šçš„æ˜¯å®ƒä½¿ç”¨äº†^~ä¿®é¥°ç¬¦ï¼Œä¸å†è¿›è¡Œæ¥ä¸‹æ¥çš„æ­£åˆ™çš„åŒ¹é…æŸ¥æ‰¾ï¼Œå› æ­¤ä½¿ç”¨Dã€‚è¿™é‡Œï¼Œå¦‚æœæ²¡æœ‰å‰é¢çš„ä¿®é¥°ç¬¦ï¼Œå…¶å®æœ€ç»ˆçš„åŒ¹é…æ˜¯Eã€‚å¤§å®¶å¯ä»¥æƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location ^~ /img {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ configuration D ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è¯·æ±‚/user/1.jpgåŒ¹é…Eã€‚é¦–å…ˆæ‰¾åˆ°æœ€é•¿åŒ¹é…é¡¹Cï¼Œç»§ç»­è¿›è¡Œæ­£åˆ™æŸ¥æ‰¾ï¼Œæ‰¾åˆ°åŒ¹é…é¡¹Eã€‚å› æ­¤ä½¿ç”¨Eã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ configuration E ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location /user/ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ configuration F ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="proxy_pass">proxy_pass<a href="#proxy_pass" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">location [ = | ~ | ~* | ^~ ] uri {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_pass http://host:port[uri0]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># uri0å¯ä»¥æ˜¯ /, /www, /www/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä¸å­˜åœ¨uri0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">actualUrl = requestUrl</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å­˜åœ¨uri0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">actualUrl = uri0 + requestUrl.remove(uri)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä»¥è¯·æ±‚http://localhost:8080/api/values/cccä¸ºä¾‹ï¼š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åå‘ä»£ç†é…ç½®">åå‘ä»£ç†é…ç½®<a href="#åå‘ä»£ç†é…ç½®" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>nginxçš„åå‘ä»£ç†æ˜¯ä¾èµ–äºngx_http_proxy_moduleè¿™ä¸ªmoduleæ¥å®ç°çš„</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># åœºæ™¯: æˆ‘è¦æŠŠè¿™ä¸ªhttpsåè®®çš„å›¾ç‰‡è¯·æ±‚åå‘ä»£ç†åˆ°httpåè®®çš„çœŸå®å›¾ç‰‡ä¸Šã€‚httpsåè®® çš„è¿™å¼ å›¾ç‰‡æ˜¯ä¸å­˜åœ¨ï¼Œè€Œå®ƒæœ‰ä¸€ä¸ªåœ°å€å®é™…æŒ‡å‘çš„å†…å®¹æ˜¯httpåè®®ä¸­çš„å›¾ç‰‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># https</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ; æ²¡åŸŸååˆ™å¡« IPåœ°å€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  server_name www.example.com;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  listen       443;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  location /newchart/hollow/small/nsh000001.gif {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_pass http://image.sinajs.cn/newchart/hollow/small/nsh000001.gif;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  location /newchart/hollow/small/nsz399001.gif {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_pass http://image.sinajs.cn/newchart/hollow/small/nsz399001.gif;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å†çœ‹ä¸€ä¸ªä¾‹å­</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">upstream rails365 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #æŒ‡å®šäº†ä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™ä¸ªæœåŠ¡å™¨å’Œnginx æ˜¯åŒä¸€å°æœºå™¨çš„ï¼Œç”¨çš„æ˜¯unix socketæ¥è¿æ¥ï¼Œè¿æ¥çš„æ˜¯ä¸€ä¸ªunicornè¿›ç¨‹ (è¿›ç¨‹å†…è·‘çš„æ˜¯ ruby on rails ä»£ç )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server unix:///home/yinsigan/rails365/shared/tmp/sockets/unicorn.sock fail_timeout=0;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ; è‹¥å¸Œæœ›è´Ÿè½½å‡è¡¡, éƒ¨ç½²å¤šä¸€ä¸ªunicornè¿›ç¨‹ï¼Œç›‘å¬åœ¨å¦å¤–çš„unix socketä¸Šï¼Œå°±ç­‰äºå¤šäº†ä¸€å°æœåŠ¡å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #server unix:///home/yinsigan/rails365_cap/shared/tmp/sockets/unicorn.sock;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        listen 80 default_server;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        listen [::]:80 default_server ipv6only=on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        server_name www.rails365.net;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        root         /home/yinsigan/rails365/current/public;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #è¿™é‡Œè¡¨ç¤ºè‹¥è®¿é—® www.rails365.net, å…ˆæ‰¾ rootç›®å½• ä¸‹çš„ index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #è‹¥è®¿é—®çš„æ˜¯ www.rails365.net/about.htmlæˆ–è€…å…¶ä»–çš„é index é¡µé¢ , æ‰¾ root ä¸‹çš„ about.htmlæˆ–è€…å…¶ä»–å¯¹åº”çš„é index é¡µé¢, è‹¥æ²¡æ‰¾åˆ°, ä¼šæ‰§è¡Œ @rails365 å³ location @rails365 {...}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        try_files $uri/index.html $uri @rails365; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location @rails365 {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            proxy_set_header Host $http_host;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            proxy_redirect off;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            #åå‘ä»£ç†(è½¬å‘)åˆ° upstream rails365 æŒ‡å®šçš„å†…å®¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            proxy_pass http://rails365;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        } }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="è´Ÿè½½å‡è¡¡é…ç½®">è´Ÿè½½å‡è¡¡é…ç½®<a href="#è´Ÿè½½å‡è¡¡é…ç½®" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>åœ¨ç‰ˆæœ¬1.9ä¹‹å‰ï¼Œå®ƒåªèƒ½ä½œä¸ºhttp çš„è´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå°±æ˜¯åœ¨ç½‘ç»œæ¨¡å‹çš„ç¬¬ä¸ƒå±‚å‘æŒ¥ä½œç”¨ï¼Œ1.9ä¹‹åï¼Œå®ƒå¯ä»¥å¯¹tcpè¿›è¡Œè´Ÿ è½½å‡è¡¡ï¼Œæ¯”å¦‚redisï¼Œmysqlç­‰</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain"># load balance config è´Ÿè½½å‡è¡¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ä½äº server ä¸‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">; å°±æ˜¯åœ¨ åå‘ä»£ç†åŸºç¡€ä¸Š, åœ¨ upstream ä¸‹å¤šåŠ å‡ ä¸ª serverèŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># upstreamçš„è´Ÿè½½å‡è¡¡é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">upstream aaa {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸æŒ‡å®šæ–¹å¼ï¼Œå°±æ˜¯éšæœºè½®å¾ª(round-robin)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #è¿˜æœ‰ä¸­æ–¹å¼ least_conn;, (ä¼˜å…ˆå‘é€ç»™é‚£äº›æ¥å—è¯·æ±‚å°‘çš„èŠ‚ç‚¹)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    least_conn;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #ip_hash å¯ä»¥è®°å½•è¯·æ±‚æ¥æºçš„ipï¼Œå¦‚æœæ˜¯åŒä¸€ä¸ªipï¼Œä¸‹æ¬¡è®¿é—®çš„æ—¶å€™è¿˜æ˜¯ä¼šåˆ°ç›¸åŒ çš„ä¸»æœºï¼Œè¿™ä¸ªå¯ä»¥ç•¥å¾®è§£å†³é‚£ç§å¸¦cookieï¼Œsessionçš„è¯·æ±‚çš„ä¸€è‡´æ€§é—®é¢˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ip_hash;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #hashæ–¹å¼, æ§åˆ¶ç²’åº¦æ›´å°, å¯æ ¹æ®ä»»æ„å˜é‡æ¥æ§åˆ¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hash $request_uri consistent;   # é€šè¿‡è¯·æ±‚åœ°å€($request_uri)æ¥æ§åˆ¶, ç›¸åŒçš„è¯·æ±‚åœ°å€è·¯ç”±åˆ°ç›¸åŒçš„èŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #weightæ˜¯æƒé‡ï¼Œå¯ä»¥æ ¹æ®æœºå™¨é…ç½®å®šä¹‰æƒé‡ã€‚weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§ã€‚default to 1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server 192.168.80.121:80 weight=3;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server 192.168.80.122:80 weight=2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server 192.168.80.123:80 weight=3;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #down æš‚æ—¶ç§»å‡ºæŸä¸ªèŠ‚ç‚¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server xxx.xxx.xxx.xx down;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #backup å¤‡ç”¨èŠ‚ç‚¹, ç›¸å¯¹äºå¤‡ä»½çš„æœºå™¨æ¥è¯´ï¼Œå…¶ä»–çš„æœºå™¨å°±ç›¸å½“äºä¸»è¦æœåŠ¡å™¨ï¼Œåªè¦å½“ä¸»è¦æœåŠ¡å™¨ä¸å¯ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šç”¨åˆ°å¤‡ç”¨æœåŠ¡å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server xxx.xxx.xxx.xx backup;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #max_failså’Œfail_timeout</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #é»˜è®¤æƒ…å†µä¸‹ï¼Œmax_failsçš„å€¼ä¸º1ï¼Œè¡¨ç¤ºçš„æ˜¯è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°ï¼Œè¯·æ±‚1æ¬¡å¤±è´¥å°±æ¢åˆ°ä¸‹å°ä¸»æœº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #fail_timeoutï¼Œè¡¨ç¤ºçš„æ˜¯è¯·æ±‚å¤±è´¥çš„è¶…æ—¶æ—¶é—´ï¼Œåœ¨è®¾å®šçš„æ—¶é—´å†… æ²¡æœ‰æˆåŠŸï¼Œé‚£ä½œä¸ºå¤±è´¥å¤„ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server xxxxx max_fails=2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_pass http://aaa;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_set_header Host $host; # nginx è½¬å‘æ—¶ä¼šä¸¢å¤± Host header, è¿™é‡ŒåŠ ä¸Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gzip-å‹ç¼©">gzip å‹ç¼©<a href="#gzip-å‹ç¼©" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>éœ€è¦nginxå·²ç»æœ‰ç¼–è¯‘è¿‡ ngx_http_gzip_module è¿™ä¸ªæ¨¡å—, èƒ½å¯¹éœ€è¦çš„é™æ€æ–‡ä»¶å‹ç¼©å¤§å°ï¼Œæ¯”å¦‚å›¾ç‰‡ï¼Œcssï¼Œjavascriptï¼Œhtmlç­‰, å‹ç¼©æ˜¯ éœ€è¦æ¶ˆè€—CPUï¼Œä½†èƒ½æé«˜ä¼ ç¼©çš„é€Ÿåº¦ï¼Œå› ä¸ºä¼ ç¼©é‡å°‘äº†è®¸å¤šï¼Œä»è€ŒèŠ‚çœå¸¦å®½;</p><p>æµè§ˆå™¨ä¹Ÿè¦æ”¯ æŒè§£å‹åŠŸèƒ½ï¼Œåªè¦æµè§ˆå™¨çš„è¯·æ±‚å¤´å¸¦ä¸Š Accept-Encoding: gzip å³å¯</p><p>åˆ«å¯¹äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ¯”å¦‚å›¾ç‰‡åšgzå‹ç¼©ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•æ„ä¹‰</p><p><a href="https://blog.csdn.net/qq_36431213/article/details/78221189" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_36431213/article/details/78221189</a></p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">; http å…¨å±€å¼€å¯ gzip å‹ç¼©</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ; å¿…é¡»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">; å¯é€‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_disable &quot;msie6&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_vary on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_proxied any;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_comp_level 6;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_buffers 16 8k;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_http_version 1.1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ; åœ¨éœ€è¦å‹ç¼©çš„èµ„æºè¿™é‡Œé…ç½®ä¸‰è¡Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #assets ç›®å½•ä¸‹æœ‰å¾ˆå¤šé™æ€èµ„æºï¼Œæ¯”å¦‚jsï¼Œcssç­‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location ~ ^/assets/ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        gzip_static on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        expires max;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        add_header Cache-Control public;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="websocket-é…ç½®">websocket é…ç½®<a href="#websocket-é…ç½®" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">; å¯ä»¥åœ¨ æµè§ˆå™¨ console ä¸­æµ‹è¯• new WebSocket(&#x27;ws://www.example.com/wx&#x27;);</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">upstream ws {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  server unix:///home/eason/tt_deploy/shared/tmp/sockets/puma.sock fail_timeout=0;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  location /ws/ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_pass http://ws;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_http_version 1.1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_set_header Upgrade $http_upgrade;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    proxy_set_header Connection &quot;upgrade&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">} }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ­å»ºè°·æ­Œé•œåƒç«™">æ­å»ºè°·æ­Œé•œåƒç«™<a href="#æ­å»ºè°·æ­Œé•œåƒç«™" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>ngx_http_google_filter_module æ˜¯ä¸€ä¸ªnginxçš„æ’ä»¶ï¼Œç”¨ çš„åŸç†æ˜¯nginxçš„åå‘ä»£ç†, (ä¾èµ–äº ngx_http_substitutions_filter_module è¿™ä¸ªåº“)</p><p>è¦æœ‰ä¸€å°èƒ½è®¿é—®google.comçš„vpsæˆ–äº‘ä¸»æœº</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  # ... part of server configuration</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  resolver 8.8.8.8;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    google on; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># ... </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä¸Š-https">ä¸Š https<a href="#ä¸Š-https" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p><a href="https://ruby-china.org/topics/31983" target="_blank" rel="noopener noreferrer">https://ruby-china.org/topics/31983</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç»„æˆå…ƒç´ ">ç»„æˆå…ƒç´ <a href="#ç»„æˆå…ƒç´ " class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>åˆ†å·ç»“å°¾</p><p>åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†:</p><ul><li>å…¨å±€å—: configuring cmds that affect the global, eg: user group, worker number, log file path, pid path...</li><li>events: config the network connections, such as worker max connection num, even driven model...</li><li>http module: æ—¥å¿— , ä»£ç† ,ç¼“å­˜...è¶…æ—¶..., <ul><li>http global module, å¦‚ upstream, è¶…æ—¶, error page</li><li>include /etc/nginx/conf.d/<em>.conf åŒ…å«å…¶ä»–é…ç½®æ–‡ä»¶ (å³ http å—å„¿ä¸‹çš„é…ç½®å¯ä»¥æ”¾ç½®åˆ°å…¶ä»–é…ç½®æ–‡ä»¶)
æ‰€ä»¥ nginx.conf åŸºæœ¬ä¸ç”¨åŠ¨, æ·»åŠ æ–°çš„è·¯ç”±é…ç½®, åªéœ€è¦åˆ° /etc/nginx/conf.d/</em>.conf æ–°å»ºé…ç½®æ–‡ä»¶é‡å¯ nginxå³å¯</li><li>server module 1 é…ç½®è™šæ‹Ÿä¸»æœº<ul><li>location 1 é…ç½® route</li><li>location 2</li></ul></li><li>server module 2;</li></ul></li><li>mail</li></ul><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># å®šä¹‰Nginxè¿è¡Œçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">user www www;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#å·¥ä½œè¿›ç¨‹ä¸ªæ•° å»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">worker_processes  1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#å…¨å±€é”™è¯¯æ—¥å¿—å®šä¹‰ç±»å‹ï¼Œ[ debug | info | notice | warn | error | crit ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#error_log  logs/error.log;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#error_log  logs/error.log  notice;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#error_log  /usr/local/nginx/logs/error.log info;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#è¿›ç¨‹pidæ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">#pid        logs/nginx.pid;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># è‹¥ä¸ºç©º, éœ€è¦ä¿ç•™è¿™ä¸€ä¸ªæ®µè½</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # å•ä¸ªå·¥ä½œè¿›ç¨‹æœ€å¤§å¹¶å‘è¿æ¥æ•°, é»˜è®¤ 1024, ä¹Ÿä¸èƒ½è®¾ç½®å¤ªå¤§ï¼Œä¸èƒ½è®©ä½ çš„CPUè·‘æ»¡100%</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    worker_connections  1024;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # ä½¿ç”¨ä»€ä¹ˆäº‹ä»¶æ¨¡å‹ï¼Œ use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #epollæ¨¡å‹æ˜¯Linux 2.6ä»¥ä¸Šç‰ˆæœ¬å†…æ ¸ä¸­çš„é«˜æ€§èƒ½ç½‘ç»œI/Oæ¨¡å‹ï¼Œå¦‚æœè·‘åœ¨FreeBSDä¸Šé¢ï¼Œå°±ç”¨kqueueæ¨¡å‹ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #use epoll;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #è¿æ¥è¶…æ—¶æ—¶é—´ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #keepalive_timeout 60;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #client_header_buffer_size 4k;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # äº‹ä»¶é©±åŠ¨æ¨¡å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨ (æ”¯æŒçš„ mine ç±»å‹)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    include       /etc/nginx/mime.types;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #é»˜è®¤æ–‡ä»¶ç±»å‹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    default_type  application/octet-stream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #é»˜è®¤ç¼–ç </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #charset utf-8; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # server_names_hash_bucket_size 128; #æœåŠ¡å™¨åå­—çš„hashè¡¨å¤§å°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # client_header_buffer_size 32k; #ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # æ—¥å¿—æ ¼å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #æ—¥å¿—è·¯å¾„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #access_log  logs/access.log  main;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #sendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰ ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #æ³¨æ„ï¼šå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹æˆoff</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sendfile        on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #autoindex on; #å¼€å¯ç›®å½•åˆ—è¡¨è®¿é—®ï¼Œåˆé€‚ä¸‹è½½æœåŠ¡å™¨ï¼Œé»˜è®¤å…³é—­ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ##é˜²æ­¢ç½‘ç»œé˜»å¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #tcp_nopush     on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    tcp_nodelay on; #é˜²æ­¢ç½‘ç»œé˜»å¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    keepalive_timeout 120; #é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #FastCGIç›¸å…³å‚æ•°æ˜¯ä¸ºäº†æ”¹å–„ç½‘ç«™çš„æ€§èƒ½ï¼šå‡å°‘èµ„æºå ç”¨ï¼Œæé«˜è®¿é—®é€Ÿåº¦ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fastcgi_connect_timeout 300;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fastcgi_send_timeout 300;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fastcgi_read_timeout 300;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fastcgi_buffer_size 64k;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fastcgi_buffers 4 64k;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fastcgi_busy_buffers_size 128k;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fastcgi_temp_file_write_size 128k;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #gzipæ¨¡å—è®¾ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip on; #å¼€å¯gzipå‹ç¼©è¾“å‡º</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # ä¸æ˜¯å¿…é¡»</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_min_length 1k; #æœ€å°å‹ç¼©æ–‡ä»¶å¤§å°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_buffers 4 16k; #å‹ç¼©ç¼“å†²åŒº</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_http_version 1.0; #å‹ç¼©ç‰ˆæœ¬ï¼ˆé»˜è®¤1.1ï¼Œå‰ç«¯å¦‚æœæ˜¯squid2.5è¯·ä½¿ç”¨1.0ï¼‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_comp_level 2; #å‹ç¼©ç­‰çº§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #å‹ç¼©ç±»å‹ï¼Œé»˜è®¤å°±å·²ç»åŒ…å«text/htmlï¼Œæ‰€ä»¥ä¸‹é¢å°±ä¸ç”¨å†å†™äº†ï¼Œå†™ä¸Šå»ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªwarnã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_types text/plain application/x-javascript text/css application/xml;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    gzip_vary on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #limit_zone crawler $binary_remote_addr 10m; #å¼€å¯é™åˆ¶IPè¿æ¥æ•°çš„æ—¶å€™éœ€è¦ä½¿ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # è™šæ‹Ÿä¸»æœºçš„é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # å¯ä»¥æ”¾åˆ°å…¶ä»–é…ç½®æ–‡ä»¶, é€šè¿‡ http.include å¼•å…¥, å¦‚ (å¸¸ç”¨) -&gt; include /etc/nginx/conf.d/*.conf , æ¯ä¸ª .conf æ˜¯ä¸€ä¸ª server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # ç›‘å¬ç«¯å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        listen       8080;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # #åŸŸå, å½“å‰ server ä¸ºè¿™ä¸ªåŸŸåæœåŠ¡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # nginxä¼š æ¯”è¾ƒ è¯·æ±‚å¤´é‡Œçš„ Host è¯·å¤´, å’Œè¿™é‡Œæ¯”è¾ƒ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #å¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        server_name  localhost aa.cn;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #index index.html index.htm index.php;  # è®¾ç½®è®¿é—®ä¸»é¡µ (ä¹Ÿå¯ä»¥åœ¨ location.index è®¾ç½®)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #root /home/wwwroot/aa.cn/web$subdomain;# è®¿é—®åŸŸåè·Ÿç›®å½•  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     # ç»‘å®šç›®å½•ä¸ºäºŒçº§åŸŸå bbb.aa.com  æ ¹ç›®å½• /bbb  æ–‡ä»¶å¤¹</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        set $subdomain &#x27;&#x27;; # å®šä¹‰å˜é‡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        if ( $host ~* &quot;(?:(\w+\.){0,})(\b(?!www\b)\w+)\.\b(?!(com|org|gov|net|cn)\b)\w+\.[a-zA-Z]+&quot; ) { </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            set $subdomain &quot;/$2&quot;; </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        include rewrite/dedecms.conf; #rewrite end   #è½½å…¥å…¶ä»–é…ç½®æ–‡ä»¶</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #charset koi8-r;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #access_log  logs/host.access.log  main;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location / { # ä¸º / (æ ¹è·¯å¾„) é…ç½® è·¯å¾„æ˜ å°„, è‹¥ä¸º /articles, åˆ™æ˜¯ä¸º /articles é…ç½®è·¯å¾„æ˜ å°„</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            root   html; # é¡¹ç›®æ ¹ç›®å½•ä¸º html (å³ /usr/share/nginx/html)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            index  index.html index.htm; # æ¬¢è¿é¡µ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            proxy_pass http://baidu.com ;# ä»£ç†ç»™ç™¾åº¦</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            proxy_set_header Host $host; # nginx è½¬å‘ç»™ gateway, ä¼šä¸¢å¤± Host , è¿™é‡Œç»™è¡¥ä¸Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #å›¾ç‰‡ç¼“å­˜æ—¶é—´è®¾ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ã€€ã€€expires 10d;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #JSå’ŒCSSç¼“å­˜æ—¶é—´è®¾ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location ~ .*.(js|css)?$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ã€€ã€€expires 1h;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #error_page  404              /404.html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # redirect server error pages to the static page /50x.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        error_page   500 502 503 504  /50x.html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location = /50x.html {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            root   html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #location ~ \.php$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #    proxy_pass   http://127.0.0.1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #location ~ \.php$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #    root           html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #    fastcgi_pass   127.0.0.1:9000;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #    fastcgi_index  index.php;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #    include        fastcgi_params;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        # concurs with nginx&#x27;s one</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #location ~ /\.ht {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #    deny  all;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #åŠ¨æ€è·¯ç”±é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #å½“ç”¨æˆ·è®¿é—® http://example.org æ—¶å°±ä¼šå»è¯»å– /data/www/index.html, è‹¥æ²¡æœ‰, åˆ™ index.php, å°±ä¼šå°±ä¼šè½¬å‘åˆ° &quot;location ~ \.php$ {...}&quot; é‡Œé¢çš„é€»è¾‘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        listen 80;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        server_name xxx.org www.xxx.org;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        root   /data/www;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            index index.html index.php;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location ~* \.(gif|jpg|png)$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            expires 30d;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location ~ \.php$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fastcgi_pass  localhost:9000;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            fastcgi_param SCRIPT_FILENAME</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                $document_root$fastcgi_script_name;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            include       fastcgi_params;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #å¯¹ &quot;/&quot; å¯ç”¨åå‘ä»£ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_pass http://127.0.0.1:88;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_redirect off;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®ï¼Œå¯é€‰ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_set_header Host $host;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        client_max_body_size 10m; #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        client_body_buffer_size 128k; #ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_connect_timeout 90; #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_send_timeout 90; #åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_read_timeout 90; #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_buffer_size 4k; #è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_buffers 4 32k; #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è®¾ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_busy_buffers_size 64k; #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_temp_file_write_size 64k;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #è®¾å®šæŸ¥çœ‹NginxçŠ¶æ€çš„åœ°å€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location /NginxStatus {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        stub_status on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        access_log on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        auth_basic &quot;NginxStatus&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        auth_basic_user_file conf/htpasswd;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #htpasswdæ–‡ä»¶çš„å†…å®¹å¯ä»¥ç”¨apacheæä¾›çš„htpasswdå·¥å…·æ¥äº§ç”Ÿã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #æœ¬åœ°åŠ¨é™åˆ†ç¦»åå‘ä»£ç†é…ç½®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #æ‰€æœ‰jspçš„é¡µé¢å‡äº¤ç”±tomcatæˆ–resinå¤„ç†</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location ~ .(jsp|jspx|do)?$ {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_set_header Host $host;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        proxy_pass http://127.0.0.1:8080;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #æ‰€æœ‰é™æ€æ–‡ä»¶ç”±nginxç›´æ¥è¯»å–ä¸ç»è¿‡tomcatæˆ–resin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$ {ã€€ã€€ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        expires 15d;ã€€ã€€ </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location ~ .*.(js|css)?$ { ã€€ã€€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        expires 1h;ã€€ã€€</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    listen       8000;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    listen       somename:8080;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    server_name  somename  alias  another.alias;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #        root   html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #        index  index.html index.htm;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    # HTTPS server</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    listen       443 ssl;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    server_name  localhost;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    ssl_certificate      cert.pem;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    ssl_certificate_key  cert.key;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    ssl_session_cache    shared:SSL:1m;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    ssl_session_timeout  5m;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    ssl_prefer_server_ciphers  on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    location / {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #        root   html;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #        index  index.html index.htm;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mail {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ­é…-docker-ä½¿ç”¨">æ­é… docker ä½¿ç”¨<a href="#æ­é…-docker-ä½¿ç”¨" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="http://www.ruanyifeng.com/blog/2018/02/nginx-docker.html" target="_blank" rel="noopener noreferrer">http://www.ruanyifeng.com/blog/2018/02/nginx-docker.html</a></p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ docker container run \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -p 127.0.0.2:8080:80 \    # å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°127.0.0.2:8080</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --rm \                    # å®¹å™¨åœæ­¢è¿è¡Œåï¼Œè‡ªåŠ¨åˆ é™¤å®¹å™¨æ–‡ä»¶(ä¸æ˜¯image), å¦‚æœæ˜¯åå°è¿è¡Œ(-d), åˆ™æ— æ•ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --name mynginx \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  nginx                     # æœ¬åœ°æ²¡æœ‰è¿™ä¸ªimage, ä¼šè‡ªåŠ¨ä»è¿œç¨‹ pull æœ€æ–°ç‰ˆ</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># $PWDè¡¨ç¤ºå½“å‰ç›®å½•, æ¥stringéœ€è¦&quot;&quot;, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ docker container run \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -p 127.0.0.2:8080:80 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --rm \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --name mynginx \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  --volume $PWD/html:/usr/share/nginx/html \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  nginx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ ducker run -p 8080:80 --rm --name mynginx --privileged=true -v &quot;$PWD/html&quot;:/usr/share/nginx/html -v &quot;$PWD/conf&quot;:/etc/nginx nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="è´Ÿè½½å‡è¡¡é…ç½®demo">è´Ÿè½½å‡è¡¡é…ç½®demo<a href="#è´Ÿè½½å‡è¡¡é…ç½®demo" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #è®¾å®šmimeç±»å‹,ç±»å‹ç”±mime.typeæ–‡ä»¶å®šä¹‰</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    include       /etc/nginx/mime.types;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    default_type  application/octet-stream;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #è®¾å®šæ—¥å¿—æ ¼å¼</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    access_log    /var/log/nginx/access.log;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    #è®¾å®šè´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨åˆ—è¡¨, ç„¶ååœ¨locationä¸­å¯¹åº”ã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    upstream load_balance_server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        server 127.0.0.1        weight=2;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        server 127.0.0.1:8081   weight=1;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   #HTTPæœåŠ¡å™¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   server {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #ç›‘å¬80ç«¯å£</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        listen       8090;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #ä»¥ä»€ä¹ˆIPè¿›è¡Œè®¿é—®</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        server_name  localhost;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        #å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè´Ÿè½½å‡è¡¡è¯·æ±‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        location /blog {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            #è¯·æ±‚è½¬å‘load_balance_server å®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            proxy_pass  http://load_balance_server ;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å³ä¸Šé¢é…ç½®ä¸­çš„upstreamå¯é€‰çš„å››ç§è´Ÿè½½å‡è¡¡ç®—æ³•(<a href="https://zhuanlan.zhihu.com/p/25102281" target="_blank" rel="noopener noreferrer">ref</a>))</p><ul><li>æœåŠ¡å™¨è½®è¯¢ï¼ˆé»˜è®¤æ–¹å¼ï¼‰</li><li>ip_hash</li><li>fair</li><li>url_hash</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginxå’Œluaè„šæœ¬">nginxå’Œluaè„šæœ¬<a href="#nginxå’Œluaè„šæœ¬" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="http://wiki.jikexueyuan.com/project/nginx-lua/introduction.html" target="_blank" rel="noopener noreferrer">http://wiki.jikexueyuan.com/project/nginx-lua/introduction.html</a>
<a href="https://blog.csdn.net/cgj296645438/article/details/88560461" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/cgj296645438/article/details/88560461</a> ç°åº¦å‘å¸ƒ
<a href="https://www.cnblogs.com/wangxusummer/p/4309007.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/wangxusummer/p/4309007.html</a> ngx_lua æ¨¡å—
<a href="https://www.cnblogs.com/xd502djj/p/6097773.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/xd502djj/p/6097773.html</a>, <a href="https://www.cnblogs.com/digdeep/p/4859575.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/digdeep/p/4859575.html</a> Openrestryå…¥é—¨</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tengine">tengine<a href="#tengine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>1ã€tengineæ˜¯åœ¨nginxä¸Šé¢å¼€å‘çš„ï¼ŒåŒ…å«äº†nginxçš„æ€§èƒ½ã€‚</p><p>2ã€tengineæ›´é€‚åˆå¤§è®¿é—®é‡ç½‘ç«™çš„éœ€æ±‚ï¼Œç›¸æ¯”nginxæ›´åŠ çš„ç¨³å®šï¼Œæ€§èƒ½æ›´åŠ çš„å¼ºåŠ²ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginx-æ¨¡å—å¼€å‘">nginx æ¨¡å—å¼€å‘<a href="#nginx-æ¨¡å—å¼€å‘" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="http://blog.codinglabs.org/articles/intro-of-nginx-module-development.html" target="_blank" rel="noopener noreferrer">http://blog.codinglabs.org/articles/intro-of-nginx-module-development.html</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginx-lua-å¼€å‘é«˜å¹¶å‘æœåŠ¡">nginx-lua å¼€å‘é«˜å¹¶å‘æœåŠ¡<a href="#nginx-lua-å¼€å‘é«˜å¹¶å‘æœåŠ¡" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/openresty/lua-nginx-module" target="_blank" rel="noopener noreferrer">https://github.com/openresty/lua-nginx-module</a> ç« äº¦æ˜¥
<a href="http://openresty.org/cn/" target="_blank" rel="noopener noreferrer">http://openresty.org/cn/</a></p><p><a href="https://blog.csdn.net/enweitech/article/details/78519398" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/enweitech/article/details/78519398</a>  éšåTengineä¹ŸåŒ…å«äº†ngx_luaæ¨¡å—ã€‚è‡³äºäºŒè€…çš„åŒºåˆ«ï¼šOpenRestyæ˜¯Nginxçš„Bundleï¼›è€ŒTengineåˆ™æ˜¯Nginxçš„Forkã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒOpenRestyå’ŒTengineå‡æ˜¯å›½äººè‡ªå·±åˆ›å»ºçš„é¡¹ç›®ï¼Œå‰è€…ä¸»è¦ç”±æ˜¥å“¥å’Œæ™“å“²å¼€å‘ï¼Œåè€…ä¸»è¦ç”±æ·˜å®æ‰“ç†ã€‚</p><p><a href="https://www.cnblogs.com/chopper-poet/p/10744214.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/chopper-poet/p/10744214.html</a>  nginx+luaåœ¨æˆ‘å¸çš„å®è·µæ¡ˆä¾‹</p><p>openrestryå¼€å‘ç¯å¢ƒæ­å»º ã€Šè·Ÿæˆ‘å­¦Nginx+Luaå¼€å‘ã€‹ <a href="https://blog.csdn.net/xlxxcc/article/details/61927151" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/xlxxcc/article/details/61927151</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginxé¢è¯•é¢˜">nginxé¢è¯•é¢˜<a href="#nginxé¢è¯•é¢˜" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="https://www.cnblogs.com/mmdln/p/8952261.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/mmdln/p/8952261.html</a>
<a href="https://blog.csdn.net/xal0610/article/details/79531692" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/xal0610/article/details/79531692</a></p><p>TODO</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginxæ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„">nginxæ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„<a href="#nginxæ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>ä¸€ä¸ªä¸»è¿›ç¨‹ï¼Œå¤šä¸ªå·¥ä½œè¿›ç¨‹ï¼Œæ¯ä¸ªå·¥ä½œè¿›ç¨‹å¯ä»¥å¤„ç†å¤šä¸ªè¯·æ±‚</p><p>äº‹ä»¶é©±åŠ¨ï¼šæ¯è¿›æ¥ä¸€ä¸ªrequestï¼Œä¼šæœ‰ä¸€ä¸ªworkerè¿›ç¨‹å»å¤„ç†ã€‚ä½†ä¸æ˜¯å…¨ç¨‹çš„å¤„ç†ï¼Œå¤„ç†åˆ°å¯èƒ½å‘ç”Ÿé˜»å¡çš„åœ°æ–¹ï¼Œæ¯”å¦‚å‘ä¸Šæ¸¸ï¼ˆåç«¯ï¼‰æœåŠ¡å™¨è½¬å‘requestï¼Œå¹¶ç­‰å¾…è¯·æ±‚è¿”å›ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªå¤„ç†çš„workerç»§ç»­å¤„ç†å…¶ä»–è¯·æ±‚ï¼Œè€Œä¸€æ—¦ä¸Šæ¸¸æœåŠ¡å™¨è¿”å›äº†ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Œworkeræ‰ä¼šæ¥æ¥æ‰‹ï¼Œè¿™ä¸ªrequestæ‰ä¼šæ¥ç€å¾€ä¸‹èµ°ã€‚</p><p>ç”±äºweb serverçš„å·¥ä½œæ€§è´¨å†³å®šäº†æ¯ä¸ªrequestçš„å¤§éƒ¨ä»½ç”Ÿå‘½éƒ½æ˜¯åœ¨ç½‘ç»œä¼ è¾“ä¸­ï¼Œå®é™…ä¸ŠèŠ±è´¹åœ¨serveræœºå™¨ä¸Šçš„æ—¶é—´ç‰‡ä¸å¤šã€‚è¿™æ˜¯å‡ ä¸ªè¿›ç¨‹å°±è§£å†³é«˜å¹¶å‘çš„ç§˜å¯†æ‰€åœ¨</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginx-å’Œ-apache-åŒºåˆ«">nginx å’Œ apache åŒºåˆ«<a href="#nginx-å’Œ-apache-åŒºåˆ«" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>nginx æ¯” apache å ç”¨æ›´å°‘çš„èµ„æº</p><p>nginx å¤„ç†è¯·æ±‚æ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¿æ¥ï¼›apache æ˜¯é˜»å¡çš„ï¼Œ ä¸€ä¸ªè¿›ç¨‹åªèƒ½åŒæ—¶å¤„ç†ä¸€ä¸ªè¿æ¥</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fastcgi-ä¸-cgi-çš„åŒºåˆ«">fastcgi ä¸ cgi çš„åŒºåˆ«<a href="#fastcgi-ä¸-cgi-çš„åŒºåˆ«" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nginx-é…ç½®è°ƒä¼˜">NGINX é…ç½®è°ƒä¼˜<a href="#nginx-é…ç½®è°ƒä¼˜" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="https://www.v2ex.com/t/894781#reply19" target="_blank" rel="noopener noreferrer">https://www.v2ex.com/t/894781#reply19</a> -&gt; <a href="https://serverfault.com/questions/47876/handling-http-and-https-requests-using-a-single-port-with-nginx/930789#930789" target="_blank" rel="noopener noreferrer">https://serverfault.com/questions/47876/handling-http-and-https-requests-using-a-single-port-with-nginx/930789#930789</a> http, https ä½¿ç”¨åŒä¸€ä¸ªç«¯å£ (å››å±‚ä»£ç†)</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">#https://github.com/Kalasearch/high-performance-nginx-tls-tuning</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">listen 443 ssl http2; # å¼€å¯ HTTP/2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">; è°ƒæ•´ Cipher ä¼˜å…ˆçº§</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"># æ‰‹åŠ¨å¯ç”¨ cipher åˆ—è¡¨</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">; å°½é‡æŒ‘é€‰æ›´æ–°æ›´å¿«çš„ Cipherï¼Œæœ‰åŠ©äºå‡å°‘å»¶è¿Ÿ(https://stackoverflow.com/questions/36672261/how-to-reduce-ssl-time-of-website)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ssl_prefer_server_ciphers on;  # prefer a list of ciphers to prevent old and slow ciphers</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ssl_ciphers &#x27;EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH&#x27;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">; å¯ç”¨ OCSP Stapling</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ssl_stapling on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ssl_stapling_verify on;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ssl_trusted_certificate /path/to/full_chain.pem;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>jetty</h1><p>references: <a href="https://www.cnblogs.com/windlaughing/archive/2013/06/07/3125358.html" target="_blank" rel="noopener noreferrer">embed jetty into your app</a>, <a href="https://my.oschina.net/tryUcatchUfinallyU?tab=newest&amp;catalogId=300813" target="_blank" rel="noopener noreferrer">source code reading</a>, <a href="https://www.eclipse.org/jetty/documentation/9.4.12.v20180830/" target="_blank" rel="noopener noreferrer">official specifications</a></p><p>embed jetty into your app -&gt; <a href="https://github.com/xiaoyureed/samples/" target="_blank" rel="noopener noreferrer">https://github.com/xiaoyureed/samples/</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="éƒ¨ç½²-app-åˆ°-jetty-å†…éƒ¨">éƒ¨ç½² app åˆ° jetty å†…éƒ¨<a href="#éƒ¨ç½²-app-åˆ°-jetty-å†…éƒ¨" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>å¼€å‘å¥½çš„åº”ç”¨ç¨‹åºæ‰“æˆ WAR åŒ…æ”¾åˆ° Jetty çš„ Webapps ç›®å½•ä¸‹é¢ã€‚ç„¶åç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥å¯åŠ¨ Jetty æœåŠ¡å™¨ï¼šJava â€“jar start.jarï¼Œ åœ¨å¯åŠ¨æœåŠ¡å™¨åã€‚æˆ‘ä»¬å°±å¯ä»¥è®¿é—®æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºäº†ï¼ŒJetty çš„é»˜è®¤ç«¯å£æ˜¯ 8080ï¼ŒWAR çš„åå­—ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„ Root Contextã€‚ä¾‹å¦‚ä¸€ä¸ªå…¸å‹çš„ URL å°±æ˜¯ï¼š<code>http://127.0.0.1:8080/sample/index.html</code> ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jettyæ”¯æŒservlet30æ³¨è§£">jettyæ”¯æŒservlet3.0æ³¨è§£<a href="#jettyæ”¯æŒservlet30æ³¨è§£" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>Jetty Distribution - é»˜è®¤æ”¯æŒ</p><p>Jetty Maven Plugin - pre-enabled for the Maven plugin</p><p>embedded jetty éœ€è¦æ‰‹åŠ¨è®¾ç½®:  include the <code>jetty-annotations</code> jar, include the <code>org.eclipse.jetty.annotations.AnnotationConfiguration</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jettyçš„æ•´ä¸ªç»“æ„">jettyçš„æ•´ä¸ªç»“æ„<a href="#jettyçš„æ•´ä¸ªç»“æ„" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><ul><li><p>æ•´ä¸ª Jetty çš„æ‰€æœ‰ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†æ˜¯åŸºäºè§‚å¯Ÿè€…æ¨¡å¼è®¾è®¡</p></li><li><p>æ•´ä¸ª Jetty çš„æ ¸å¿ƒç»„ä»¶ç”± Server å’Œ Connector ä¸¤ä¸ªç»„ä»¶æ„æˆ</p><ul><li>æ•´ä¸ª Server ç»„ä»¶æ˜¯åŸºäº Handler å®¹å™¨å·¥ä½œçš„ï¼Œå®ƒç±»ä¼¼ä¸ Tomcat çš„ Container å®¹å™¨; serverç»„ä»¶ç”±<code>å¤šä¸ª server Handler</code> ç»„æˆ</li><li>Connectorï¼Œå®ƒè´Ÿè´£æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚åˆ†é…ç»™ä¸€ä¸ªå¤„ç†é˜Ÿåˆ—å»æ‰§è¡Œ</li></ul></li><li><p>Jetty ä¸­è¿˜æœ‰ä¸€äº›éå¿…é¡»çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®ƒä¸Šåšæ‰©å±•ã€‚å¦‚ JMXï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€äº› Mbean æŠŠå®ƒåŠ åˆ° Server ä¸­ï¼Œå½“ Server å¯åŠ¨çš„æ—¶å€™ï¼Œè¿™äº› Bean å°±ä¼šä¸€èµ·å·¥ä½œã€‚</p></li><li><p>Handler çš„ä½“ç³»ç»“æ„ - æä¾›äº†ä¸¤ç§ Handler ç±»å‹</p><ul><li><p>HandlerWrapper - å¯ä»¥å°†ä¸€ä¸ª Handler å§”æ‰˜ç»™å¦å¤–ä¸€ä¸ªç±»å»æ‰§è¡Œ</p></li><li><p>HandlerCollection - å°†å¤šä¸ª Handler ç»„è£…åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ª Handler é“¾, ScopeHandler å¯ä»¥å¸®åŠ©ä½ æ§åˆ¶è¿™ä¸ªé“¾çš„è®¿é—®é¡ºåº</p></li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jettyçš„å·¥ä½œè¿‡ç¨‹">Jettyçš„å·¥ä½œè¿‡ç¨‹<a href="#jettyçš„å·¥ä½œè¿‡ç¨‹" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¯åŠ¨">å¯åŠ¨<a href="#å¯åŠ¨" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Server çš„ start æ–¹æ³•è°ƒç”¨å°±ä¼šè°ƒç”¨æ‰€æœ‰å·²ç»æ³¨å†Œåˆ° Server çš„ç»„ä»¶ï¼ŒServer å¯åŠ¨å…¶å®ƒç»„ä»¶çš„é¡ºåºæ˜¯ï¼šé¦–å…ˆå¯åŠ¨è®¾ç½®åˆ° Server çš„ Handlerï¼Œé€šå¸¸è¿™ä¸ª Handler ä¼šæœ‰å¾ˆå¤šå­ Handlerï¼Œè¿™äº› Handler å°†ç»„æˆä¸€ä¸ª Handler é“¾ã€‚Server ä¼šä¾æ¬¡å¯åŠ¨è¿™ä¸ªé“¾ä¸Šçš„æ‰€æœ‰ Handlerã€‚æ¥ç€ä¼šå¯åŠ¨æ³¨å†Œåœ¨ Server ä¸Š JMX çš„ Mbeanï¼Œè®© Mbean ä¹Ÿä¸€èµ·å·¥ä½œèµ·æ¥ï¼Œæœ€åä¼šå¯åŠ¨ Connectorï¼Œæ‰“å¼€ç«¯å£ï¼Œæ¥å—å®¢æˆ·ç«¯è¯·æ±‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ¥å—è¯·æ±‚">æ¥å—è¯·æ±‚<a href="#æ¥å—è¯·æ±‚" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><ul><li><p>ä½¿ç”¨ä¸¤ç§åè®®: ä¸€ä¸ªæ˜¯ HTTPï¼Œä¸€ä¸ªæ˜¯ AJP åè®®</p></li><li><p>å¦‚æœå‰ç«¯æ²¡æœ‰å…¶å®ƒ web æœåŠ¡å™¨ï¼Œé‚£ä¹ˆ Jetty åº”è¯¥æ˜¯åŸºäº HTTP åè®®å·¥ä½œã€‚ä¹Ÿå°±æ˜¯å½“ Jetty æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå¿…é¡»è¦æŒ‰ç…§ HTTP åè®®è§£æè¯·æ±‚å’Œå°è£…è¿”å›çš„æ•°æ® - è®¾ç½® Jetty çš„ Connector å®ç°ç±»ä¸º <code>org.eclipse.jetty.server.bi.SocketConnector </code>è®© Jetty ä»¥ BIO çš„æ–¹å¼å·¥ä½œ</p></li><li><p>åœ¨åº”ç”¨æœåŠ¡å™¨ï¼Œå¦‚ Jboss çš„å‰é¢åœ¨åŠ ä¸€ä¸ª web æœåŠ¡å™¨ï¼Œå¦‚ Apache æˆ–è€… nginxï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯: åšæ—¥å¿—åˆ†æã€è´Ÿè½½å‡è¡¡ã€æƒé™æ§åˆ¶ã€é˜²æ­¢æ¶æ„è¯·æ±‚ä»¥åŠé™æ€èµ„æºé¢„åŠ è½½ç­‰ç­‰ã€‚æ­¤æ—¶ä½¿ç”¨ ajpåè®®  </p><ul><li><p>è¿™ç§æ¶æ„ä¸‹ servlet å¼•æ“å°±ä¸éœ€è¦è§£æå’Œå°è£…è¿”å›çš„ HTTP åè®®ï¼Œå› ä¸º HTTP åè®®çš„è§£æå·¥ä½œå·²ç»åœ¨ Apache æˆ– Nginx æœåŠ¡å™¨ä¸Šå®Œæˆäº†ï¼ŒJboss åªè¦åŸºäºæ›´åŠ ç®€å•çš„ AJP åè®®å·¥ä½œå°±è¡Œäº†ï¼Œè¿™æ ·èƒ½åŠ å¿«è¯·æ±‚çš„å“åº”é€Ÿåº¦ã€‚</p></li><li><p>è®© Jetty å·¥ä½œåœ¨ AJP åè®®ä¸‹ï¼Œéœ€è¦é…ç½® connector çš„å®ç°ç±»ä¸º <code>Ajp13SocketConnector</code></p></li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¤„ç†è¯·æ±‚">å¤„ç†è¯·æ±‚<a href="#å¤„ç†è¯·æ±‚" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Jetty è¦åšçš„å°±æ˜¯è°ƒç”¨ä½ æ³¨å†Œçš„ç¬¬ä¸€ä¸ª Handler çš„ <code>handle(String target, Request baseRequest, HttpServletRequest request, HttpServletResponse response) </code>æ–¹æ³•</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">Server</span><span class="token plain"> server </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">8080</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token class-name" style="color:rgb(38, 127, 153)">ContextHandler</span><span class="token plain"> context </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ContextHandler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setContextPath</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setResourceBase</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setClassLoader</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Thread</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">currentThread</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">getContextClassLoader</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setHandler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setHandler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">HelloHandler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Tomcat</h1><p>references: <a href="https://www.ibm.com/developerworks/cn/java/j-lo-tomcat1/" target="_blank" rel="noopener noreferrer">1</a>, <a href="https://www.ibm.com/developerworks/cn/java/j-lo-tomcat2/" target="_blank" rel="noopener noreferrer">2</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tomcat-æ€»ä½“ç»“æ„">Tomcat æ€»ä½“ç»“æ„<a href="#tomcat-æ€»ä½“ç»“æ„" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><ul><li><p>2ä¸ªæ ¸å¿ƒç»„ä»¶ - Connector å’Œ Container: </p><ul><li><p>connector æ¥æ”¶æµè§ˆå™¨çš„å‘è¿‡æ¥çš„ tcp è¿æ¥è¯·æ±‚: åˆ›å»º Request, response å¯¹è±¡, ä¼ é€’ç»™ containerçš„çº¿ç¨‹</p></li><li><p>container ä¸»è¦å¤„ç† Connector æ¥å—çš„è¯·æ±‚: äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†connectoräº§ç”Ÿçš„ Request å’Œ Response å¯¹è±¡</p></li></ul></li><li><p>å¤šä¸ª Connector å’Œä¸€ä¸ª Container å°±å½¢æˆäº†ä¸€ä¸ª Serviceå¯¹å¤–æä¾›æœåŠ¡ (service å°±æ˜¯ä¸€ä¸ªæ¥å£)</p></li><li><p>server å¯ä»¥åŒ…å«å¤šä¸ª service</p></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="connector">Connector<a href="#connector" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>ä¸»è¦ä»»åŠ¡æ˜¯è´Ÿè´£æ¥æ”¶æµè§ˆå™¨çš„å‘è¿‡æ¥çš„ tcp è¿æ¥è¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ª Request å’Œ Response å¯¹è±¡åˆ†åˆ«ç”¨äºå’Œè¯·æ±‚ç«¯äº¤æ¢æ•°æ®ï¼Œç„¶åä¼šäº§ç”Ÿä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚å¹¶æŠŠäº§ç”Ÿçš„ Request å’Œ Response å¯¹è±¡ä¼ ç»™å¤„ç†è¿™ä¸ªè¯·æ±‚çš„çº¿ç¨‹ï¼Œå¤„ç†è¿™ä¸ªè¯·æ±‚çš„çº¿ç¨‹å°±æ˜¯ Container ç»„ä»¶è¦åšçš„äº‹äº†</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="container">Container<a href="#container" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Container æ˜¯å®¹å™¨çš„çˆ¶æ¥å£ï¼Œæ‰€æœ‰å­å®¹å™¨éƒ½å¿…é¡»å®ç°è¿™ä¸ªæ¥å£ï¼ŒContainer å®¹å™¨çš„è®¾è®¡ç”¨çš„æ˜¯å…¸å‹çš„è´£ä»»é“¾çš„è®¾è®¡æ¨¡å¼</p><p>å®ƒæœ‰å››ä¸ªå­å®¹å™¨ç»„ä»¶æ„æˆ, æœ‰çˆ¶å­å…³ç³»ï¼Œåˆ†åˆ«æ˜¯ï¼šEngineã€Hostã€Contextã€Wrapper (éµä» &quot;parent -&gt; child&quot; é¡ºåº:)</p><p>ä¸€ä¸ª Servlet class å¯¹åº”ä¸€ä¸ª Wrapperï¼Œå¦‚æœæœ‰å¤šä¸ª Servlet å°±å¯ä»¥å®šä¹‰å¤šä¸ª Wrapper</p><p>çœŸæ­£ç®¡ç† Servlet çš„å®¹å™¨æ˜¯ Context å®¹å™¨ï¼Œä¸€ä¸ª Context å¯¹åº”ä¸€ä¸ª Web å·¥ç¨‹</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">Context</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">    </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">path</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">/library</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">    </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">docBase</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">D:\projects\library\deploy\target\library.war</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">    </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">reloadable</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">true</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">&lt;!-- </span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">- reloadable=&quot;true&quot; - war è¢«ä¿®æ”¹å Tomcat ä¼šè‡ªåŠ¨çš„é‡æ–°åŠ è½½è¿™ä¸ªåº”ç”¨</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Context è¿˜å¯ä»¥å®šä¹‰åœ¨çˆ¶å®¹å™¨ Host ä¸­ï¼ŒHost ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯è¦è¿è¡Œ war ç¨‹åºï¼Œå°±å¿…é¡»è¦ Hostï¼Œå› ä¸º war ä¸­å¿…æœ‰ web.xml æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„è§£æå°±éœ€è¦ Host äº†ï¼Œå¦‚æœè¦æœ‰å¤šä¸ª Host å°±è¦å®šä¹‰ä¸€ä¸ª top å®¹å™¨ Engine äº†ã€‚è€Œ Engine æ²¡æœ‰çˆ¶å®¹å™¨äº†ï¼Œä¸€ä¸ª Engine ä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„ Servlet å¼•æ“ã€‚</p><p>å››ä¸ªç»„ä»¶éƒ½ä¼šæœ‰è‡ªå·±çš„ä¸€å¥— Valve é›†åˆ, åœ¨ server.xml æ–‡ä»¶ä¸­å¯ä»¥æ·»åŠ Valve; StandardEngineValve å’Œ StandardHostValve æ˜¯ Engine å’Œ Host çš„é»˜è®¤çš„ Valveï¼Œå®ƒä»¬æ˜¯æœ€åä¸€ä¸ª Valve è´Ÿè´£å°†è¯·æ±‚ä¼ ç»™å®ƒä»¬çš„å­å®¹å™¨ï¼Œä»¥ç»§ç»­å¾€ä¸‹æ‰§è¡Œ</p><p>Wrapper çš„å®ç°ç±»æ˜¯ StandardWrapperï¼ŒStandardWrapper è¿˜å®ç°äº†æ‹¥æœ‰ä¸€ä¸ª Servlet åˆå§‹åŒ–ä¿¡æ¯çš„ ServletConfigï¼Œç”±æ­¤çœ‹å‡º StandardWrapper å°†ç›´æ¥å’Œ Servlet çš„å„ç§ä¿¡æ¯æ‰“äº¤é“</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼">ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼<a href="#ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="facade">Facade<a href="#facade" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>é—¨é¢æ¨¡å¼</p><p>HttpRequestFacade ç±»å°è£…äº† HttpRequest æ¥å£èƒ½å¤Ÿæä¾›æ•°æ®ï¼Œé€šè¿‡ HttpRequestFacade è®¿é—®åˆ°çš„æ•°æ®éƒ½è¢«ä»£ç†åˆ° HttpRequest ä¸­</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="observer">Observer<a href="#observer" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>è§‚å¯Ÿè€…æ¨¡å¼</p><p>æ§åˆ¶ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„ Lifecycle å°±æ˜¯è¿™ç§æ¨¡å¼çš„ä½“ç°</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="command">Command<a href="#command" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>å‘½ä»¤æ¨¡å¼</p><p>Connector ä¹Ÿæ˜¯é€šè¿‡å‘½ä»¤æ¨¡å¼è°ƒç”¨ Container</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chain-of-responsibility">Chain of responsibility<a href="#chain-of-responsibility" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>è´£ä»»é“¾æ¨¡å¼</p><p> Tomcat ä¸­ Container , æ•´ä¸ªå®¹å™¨çš„å°±æ˜¯é€šè¿‡ä¸€ä¸ªé“¾è¿æ¥åœ¨ä¸€èµ·ï¼Œè¿™ä¸ªé“¾ä¸€ç›´å°†è¯·æ±‚æ­£ç¡®çš„ä¼ é€’ç»™æœ€ç»ˆå¤„ç†è¯·æ±‚çš„é‚£ä¸ª Servlet</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tomcat-ä¼˜åŒ–">Tomcat ä¼˜åŒ–<a href="#tomcat-ä¼˜åŒ–" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><a href="https://mp.weixin.qq.com/s/3WQB3NGkPrSqmLaYIJ7koQ" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s/3WQB3NGkPrSqmLaYIJ7koQ</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/tomcat">tomcat</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/jetty">jetty</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/nginx">nginx</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/tcp-ip-note-p2p"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TCP IP, p2p</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/vertx"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Vertx</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tomcatå’Œjetty" class="table-of-contents__link toc-highlight">Tomcatå’Œjetty</a></li><li><a href="#apache-http-serverå’Œnginx" class="table-of-contents__link toc-highlight">Apache http serverå’ŒNginx</a></li><li><a href="#ä½¿ç”¨åœºæ™¯" class="table-of-contents__link toc-highlight">ä½¿ç”¨åœºæ™¯</a></li><li><a href="#å¸¸ç”¨å‘½ä»¤" class="table-of-contents__link toc-highlight">å¸¸ç”¨å‘½ä»¤</a></li><li><a href="#nginx-æ— æ³•åœæ­¢-æ— æ³•é‡å¯" class="table-of-contents__link toc-highlight">nginx æ— æ³•åœæ­¢ æ— æ³•é‡å¯</a></li><li><a href="#nginxconf-é…ç½®æ–‡ä»¶" class="table-of-contents__link toc-highlight">nginx.conf é…ç½®æ–‡ä»¶</a><ul><li><a href="#æœ€ç®€é…ç½®" class="table-of-contents__link toc-highlight">æœ€ç®€é…ç½®</a></li><li><a href="#é…ç½®è¯­æ³•" class="table-of-contents__link toc-highlight">é…ç½®è¯­æ³•</a><ul><li><a href="#location" class="table-of-contents__link toc-highlight">location</a></li><li><a href="#proxy_pass" class="table-of-contents__link toc-highlight">proxy_pass</a></li></ul></li><li><a href="#åå‘ä»£ç†é…ç½®" class="table-of-contents__link toc-highlight">åå‘ä»£ç†é…ç½®</a></li><li><a href="#è´Ÿè½½å‡è¡¡é…ç½®" class="table-of-contents__link toc-highlight">è´Ÿè½½å‡è¡¡é…ç½®</a></li><li><a href="#gzip-å‹ç¼©" class="table-of-contents__link toc-highlight">gzip å‹ç¼©</a></li><li><a href="#websocket-é…ç½®" class="table-of-contents__link toc-highlight">websocket é…ç½®</a></li><li><a href="#æ­å»ºè°·æ­Œé•œåƒç«™" class="table-of-contents__link toc-highlight">æ­å»ºè°·æ­Œé•œåƒç«™</a></li><li><a href="#ä¸Š-https" class="table-of-contents__link toc-highlight">ä¸Š https</a></li><li><a href="#ç»„æˆå…ƒç´ " class="table-of-contents__link toc-highlight">ç»„æˆå…ƒç´ </a></li></ul></li><li><a href="#æ­é…-docker-ä½¿ç”¨" class="table-of-contents__link toc-highlight">æ­é… docker ä½¿ç”¨</a></li><li><a href="#è´Ÿè½½å‡è¡¡é…ç½®demo" class="table-of-contents__link toc-highlight">è´Ÿè½½å‡è¡¡é…ç½®demo</a></li><li><a href="#nginxå’Œluaè„šæœ¬" class="table-of-contents__link toc-highlight">nginxå’Œluaè„šæœ¬</a></li><li><a href="#tengine" class="table-of-contents__link toc-highlight">tengine</a></li><li><a href="#nginx-æ¨¡å—å¼€å‘" class="table-of-contents__link toc-highlight">nginx æ¨¡å—å¼€å‘</a></li><li><a href="#nginx-lua-å¼€å‘é«˜å¹¶å‘æœåŠ¡" class="table-of-contents__link toc-highlight">nginx-lua å¼€å‘é«˜å¹¶å‘æœåŠ¡</a></li><li><a href="#nginxé¢è¯•é¢˜" class="table-of-contents__link toc-highlight">nginxé¢è¯•é¢˜</a><ul><li><a href="#nginxæ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„" class="table-of-contents__link toc-highlight">nginxæ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„</a></li><li><a href="#nginx-å’Œ-apache-åŒºåˆ«" class="table-of-contents__link toc-highlight">nginx å’Œ apache åŒºåˆ«</a></li><li><a href="#fastcgi-ä¸-cgi-çš„åŒºåˆ«" class="table-of-contents__link toc-highlight">fastcgi ä¸ cgi çš„åŒºåˆ«</a></li></ul></li><li><a href="#nginx-é…ç½®è°ƒä¼˜" class="table-of-contents__link toc-highlight">NGINX é…ç½®è°ƒä¼˜</a></li><li><a href="#éƒ¨ç½²-app-åˆ°-jetty-å†…éƒ¨" class="table-of-contents__link toc-highlight">éƒ¨ç½² app åˆ° jetty å†…éƒ¨</a></li><li><a href="#jettyæ”¯æŒservlet30æ³¨è§£" class="table-of-contents__link toc-highlight">jettyæ”¯æŒservlet3.0æ³¨è§£</a></li><li><a href="#jettyçš„æ•´ä¸ªç»“æ„" class="table-of-contents__link toc-highlight">jettyçš„æ•´ä¸ªç»“æ„</a></li><li><a href="#jettyçš„å·¥ä½œè¿‡ç¨‹" class="table-of-contents__link toc-highlight">Jettyçš„å·¥ä½œè¿‡ç¨‹</a><ul><li><a href="#å¯åŠ¨" class="table-of-contents__link toc-highlight">å¯åŠ¨</a></li><li><a href="#æ¥å—è¯·æ±‚" class="table-of-contents__link toc-highlight">æ¥å—è¯·æ±‚</a></li><li><a href="#å¤„ç†è¯·æ±‚" class="table-of-contents__link toc-highlight">å¤„ç†è¯·æ±‚</a></li></ul></li><li><a href="#tomcat-æ€»ä½“ç»“æ„" class="table-of-contents__link toc-highlight">Tomcat æ€»ä½“ç»“æ„</a><ul><li><a href="#connector" class="table-of-contents__link toc-highlight">Connector</a></li><li><a href="#container" class="table-of-contents__link toc-highlight">Container</a></li></ul></li><li><a href="#ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼" class="table-of-contents__link toc-highlight">ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼</a><ul><li><a href="#facade" class="table-of-contents__link toc-highlight">Facade</a></li><li><a href="#observer" class="table-of-contents__link toc-highlight">Observer</a></li><li><a href="#command" class="table-of-contents__link toc-highlight">Command</a></li><li><a href="#chain-of-responsibility" class="table-of-contents__link toc-highlight">Chain of responsibility</a></li></ul></li><li><a href="#tomcat-ä¼˜åŒ–" class="table-of-contents__link toc-highlight">Tomcat ä¼˜åŒ–</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">å†å²</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/en/archive">Archive</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social Media</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/about">About Me</a></li><li class="footer__item"><a href="https://github.com/xiaoyureed" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/xiaoyuhfq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/3fPgwd3naN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/en/friends">Friends</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/en/resource">Links</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p><a href="http://beian.miit.gov.cn/">é—½ICPå¤‡2020017848å·-2</a></p><p>Copyright Â© 2020 â€“ PRESENT kuizuo Built with Docusaurus.</p></div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.7df8c467.js"></script>
<script src="/en/assets/js/main.82e41e7b.js"></script>
</body>
</html>